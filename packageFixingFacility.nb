(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    182092,       4375]
NotebookOptionsPosition[    180508,       4322]
NotebookOutlinePosition[    180871,       4338]
CellTagsIndexPosition[    180828,       4335]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"SPECIFY", " ", "WHICH", " ", "EXAMPLE", " ", "IT", " ", "IS"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ii", "=", "28"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Below", " ", "this", " ", "you", " ", 
     RowBox[{"don", "'"}], "t", " ", "need", " ", "to", " ", "touch"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"formatrule", "=", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["XX_", 
        RowBox[{"z1_", ",", "z2_"}]], "\[Rule]", 
       RowBox[{"XX", "[", 
        RowBox[{"z1", ",", "z2"}], "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "ii"], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"a", "=", 
     RowBox[{"a", "/.", "formatrule"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"b", "=", 
     RowBox[{"b", "/.", "formatrule"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"c", "=", 
     RowBox[{"c", "/.", "formatrule"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"d", "=", 
     RowBox[{"d", "/.", "formatrule"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"topleft", "=", "a"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"topright", "=", "b"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"bottomleft", "=", "c"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"bottomright", "=", "d"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"viewGraph", "[", 
    RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.664710424836047*^9, 3.664710487527988*^9}, {
   3.664710525300151*^9, 3.664710530009367*^9}, {3.6647146452913413`*^9, 
   3.6647146565496025`*^9}, {3.664714706494831*^9, 3.664714706571877*^9}, {
   3.6647758619111233`*^9, 3.6647758622548914`*^9}, {3.6647825842236247`*^9, 
   3.664782584333006*^9}, {3.6647830524751463`*^9, 3.6647831028279376`*^9}, {
   3.664784341806113*^9, 3.6647843469572825`*^9}, 3.6647915924195547`*^9, 
   3.66479685196926*^9, 3.66479694890938*^9, {3.6647970866689763`*^9, 
   3.6647970916411033`*^9}, 3.6647971561343536`*^9, {3.6647974477206492`*^9, 
   3.6647974478657465`*^9}, {3.664797534135697*^9, 3.664797534231761*^9}, {
   3.6648006408075037`*^9, 3.6648006409045587`*^9}, {3.6648015820839577`*^9, 
   3.6648015822941027`*^9}, {3.6648020200472918`*^9, 3.6648020328983*^9}, {
   3.664802255461421*^9, 3.664802255620528*^9}, {3.664802675498439*^9, 
   3.664802677840618*^9}}],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{1, 10, 11, 12, 2, 14, 16, 3, 15, 18, 4, 13, 17, 5, 6, 7, 8, 9}, {
      Null, {{1, 2}, {1, 3}, {1, 4}, {5, 3}, {5, 6}, {5, 7}, {8, 2}, {8, 9}, {
       8, 10}, {11, 2}, {11, 12}, {11, 13}, {14, 4}, {14, 6}, {14, 9}, {15, 
       12}, {15, 6}, {15, 9}, {16, 3}, {17, 4}, {18, 12}}}, {
      EdgeShapeFunction -> {
         Function[{Private`edgepositions$, Private`edgename$}, 
          Private`edgeweightname$444 = Part[Private`tempedgelabels$444, 
             Part[
              Position[Private`tempedgelabels$444, 
               Sort[Private`edgename$]], 1, 1], 2]; 
          Private`tempedgelabels$444 = Delete[Private`tempedgelabels$444, 
             Part[
              Position[Private`tempedgelabels$444, 
               Sort[Private`edgename$]], 1, 1]]; {
            Text[
             Style[Private`edgeweightname$444, Medium, Bold, Blue], 
             Mean[Private`edgepositions$]], {Black, 
             Line[Private`edgepositions$]}}]}, ImagePadding -> 20, 
       VertexLabels -> {"Name"}, VertexLabelStyle -> {15}, 
       VertexSize -> {Medium}, 
       VertexStyle -> {
        18 -> GrayLevel[0], 6 -> GrayLevel[1], 15 -> GrayLevel[0], 1 -> 
         GrayLevel[1], 9 -> GrayLevel[1], 13 -> GrayLevel[0], 2 -> 
         GrayLevel[1], 8 -> GrayLevel[1], 3 -> GrayLevel[1], 4 -> 
         GrayLevel[1], 11 -> GrayLevel[0], 10 -> GrayLevel[0], 7 -> 
         GrayLevel[1], 16 -> GrayLevel[0], 17 -> GrayLevel[0], 14 -> 
         GrayLevel[0], 12 -> GrayLevel[0], 5 -> GrayLevel[1]}}]]}, 
    TagBox[GraphicsGroupBox[{
       {Hue[0.6, 0.7, 0.5], Opacity[0.7], {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"1", ",", "3"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           
           FontColor->RGBColor[
            0, 0, 1]], {2.657991243225584, 2.244499884976366}], 
         {GrayLevel[0], 
          LineBox[{{3.343901134906445, 2.2445613241086275`}, {
           1.972081351544723, 2.2444384458441053`}}]}}, {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"4", ",", "1"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           
           FontColor->RGBColor[
            0, 0, 1]], {3.8709143040160905`, 1.9218112603631317`}], 
         {GrayLevel[0], 
          LineBox[{{3.343901134906445, 2.2445613241086275`}, {
           4.397927473125736, 1.5990611966176358`}}]}}, {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"3", ",", "4"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           
           FontColor->RGBColor[
            0, 0, 1]], {3.52345781520406, 2.518201862457854}], 
         {GrayLevel[0], 
          LineBox[{{3.343901134906445, 2.2445613241086275`}, {
           3.703014495501675, 2.791842400807081}}]}}, {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"3", ",", "7"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           FontColor->RGBColor[
            0, 0, 1]], {1.793560086055081, 2.518498472652186}], 
         {GrayLevel[0], 
          LineBox[{{1.972081351544723, 2.2444384458441053`}, {
           1.615038820565439, 2.7925584994602666`}}]}}, {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"7", ",", "1"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           
           FontColor->RGBColor[
            0, 0, 1]], {1.4455582307199608`, 1.921796712521517}], 
         {GrayLevel[0], 
          LineBox[{{1.972081351544723, 2.2444384458441053`}, {
           0.9190351098951985, 1.5991549791989288`}}]}}, {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"1", ",", "5"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           
           FontColor->RGBColor[
            0, 0, 1]], {4.31931204669897, 1.1413120173042652`}], 
         {GrayLevel[0], 
          LineBox[{{4.397927473125736, 1.5990611966176358`}, {
           4.240696620272204, 0.6835628379908945}}]}}, {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"5", ",", "4"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           
           FontColor->RGBColor[
            0, 0, 1]], {4.857545316400097, 1.6214714469930174`}], 
         {GrayLevel[0], 
          LineBox[{{4.397927473125736, 1.5990611966176358`}, {
           5.317163159674459, 1.643881697368399}}]}}, {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"6", ",", "3"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           
           FontColor->RGBColor[
            0, 0, 1]], {3.4076196601051607`, 2.331899036154825}], 
         {GrayLevel[0], 
          LineBox[{{3.703014495501675, 2.791842400807081}, {
           3.1122248247086466`, 1.871955671502569}}]}}, {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"4", ",", "6"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           
           FontColor->RGBColor[
            0, 0, 1]], {3.9523986978856125`, 3.179922545567364}], 
         {GrayLevel[0], 
          LineBox[{{3.703014495501675, 2.791842400807081}, {4.20178290026955, 
           3.5680026903276474`}}]}}, {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"6", ",", "1"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           
           FontColor->RGBColor[
            0, 0, 1]], {3.721821960941866, 0.8132411061843658}], 
         {GrayLevel[0], 
          LineBox[{{4.240696620272204, 0.6835628379908945}, {
           3.2029473016115277`, 0.9429193743778373}}]}}, {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"5", ",", "6"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           
           FontColor->RGBColor[
            0, 0, 1]], {4.541650754005197, 0.3419397300368515}], 
         {GrayLevel[0], 
          LineBox[{{4.240696620272204, 0.6835628379908945}, {4.84260488773819,
            0.00031662208280858195`}}]}}, {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"2", ",", "6"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           
           FontColor->RGBColor[
            0, 0, 1]], {3.157586063160087, 1.4074375229402032`}], 
         {GrayLevel[0], 
          LineBox[{{3.2029473016115277`, 0.9429193743778373}, {
           3.1122248247086466`, 1.871955671502569}}]}}, {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"1", ",", "2"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           
           FontColor->RGBColor[
            0, 0, 1]], {2.6587322339835735`, 0.9429059329162923}], 
         {GrayLevel[0], 
          LineBox[{{3.2029473016115277`, 0.9429193743778373}, {
           2.1145171663556197`, 0.9428924914547473}}]}}, {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"9", ",", "3"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           
           FontColor->RGBColor[
            0, 0, 1]], {1.9104992476676537`, 2.3329435756980135`}], 
         {GrayLevel[0], 
          LineBox[{{1.615038820565439, 2.7925584994602666`}, {
           2.2059596747698684`, 1.8733286519357606`}}]}}, {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"7", ",", "9"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           
           FontColor->RGBColor[
            0, 0, 1]], {1.3659282969647908`, 3.18066029796089}], 
         {GrayLevel[0], 
          LineBox[{{1.615038820565439, 2.7925584994602666`}, {
           1.116817773364143, 3.568762096461513}}]}}, {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"3", ",", "2"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           
           FontColor->RGBColor[
            0, 0, 1]], {2.6590922497392575`, 1.8726421617191646`}], 
         {GrayLevel[0], 
          LineBox[{{2.2059596747698684`, 1.8733286519357606`}, {
           3.1122248247086466`, 1.871955671502569}}]}}, {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"2", ",", "9"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           
           FontColor->RGBColor[
            0, 0, 1]], {2.1602384205627443`, 1.408110571695254}], 
         {GrayLevel[0], 
          LineBox[{{2.2059596747698684`, 1.8733286519357606`}, {
           2.1145171663556197`, 0.9428924914547473}}]}}, {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"1", ",", "8"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           
           FontColor->RGBColor[
            0, 0, 1]], {0.9980502012189437, 1.1412844157027107`}], 
         {GrayLevel[0], 
          LineBox[{{0.9190351098951985, 1.5991549791989288`}, {
           1.077065292542689, 0.6834138522064925}}]}}, {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"8", ",", "7"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           
           FontColor->RGBColor[
            0, 0, 1]], {0.45951755494759927`, 1.621387601017001}], 
         {GrayLevel[0], 
          LineBox[{{0.9190351098951985, 1.5991549791989288`}, {0., 
           1.6436202228350731`}}]}}, {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"9", ",", "1"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           
           FontColor->RGBColor[
            0, 0, 1]], {1.5957912294491543`, 0.81315317183062}], 
         {GrayLevel[0], 
          LineBox[{{1.077065292542689, 0.6834138522064925}, {
           2.1145171663556197`, 0.9428924914547473}}]}}, {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"8", ",", "9"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           
           FontColor->RGBColor[
            0, 0, 1]], {0.7762155281590246, 0.34170692610324627`}], 
         {GrayLevel[0], 
          LineBox[{{1.077065292542689, 0.6834138522064925}, {
           0.47536576377536033`, 0.}}]}}}, 
       {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], {
         {GrayLevel[1], 
          DiskBox[{3.343901134906445, 2.2445613241086275`}, 
           0.04386588072856849]}, InsetBox[
          StyleBox["1",
           StripOnInput->False,
           FontSize->15], 
          Offset[{2, 2}, {3.3877670156350135`, 2.288427204837196}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {GrayLevel[0], 
          DiskBox[{1.972081351544723, 2.2444384458441053`}, 
           0.04386588072856849]}, InsetBox[
          StyleBox["10",
           StripOnInput->False,
           FontSize->15], 
          Offset[{2, 2}, {2.0159472322732914`, 2.288304326572674}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {GrayLevel[0], 
          DiskBox[{4.397927473125736, 1.5990611966176358`}, 
           0.04386588072856849]}, InsetBox[
          StyleBox["11",
           StripOnInput->False,
           FontSize->15], 
          Offset[{2, 2}, {4.441793353854305, 1.6429270773462044`}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {GrayLevel[0], 
          DiskBox[{3.703014495501675, 2.791842400807081}, 
           0.04386588072856849]}, InsetBox[
          StyleBox["12",
           StripOnInput->False,
           FontSize->15], 
          Offset[{2, 2}, {3.7468803762302434`, 2.8357082815356494`}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {GrayLevel[1], 
          DiskBox[{4.240696620272204, 0.6835628379908945}, 
           0.04386588072856849]}, InsetBox[
          StyleBox["2",
           StripOnInput->False,
           FontSize->15], 
          Offset[{2, 2}, {4.284562501000773, 0.7274287187194629}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {GrayLevel[0], 
          DiskBox[{3.2029473016115277`, 0.9429193743778373}, 
           0.04386588072856849]}, InsetBox[
          StyleBox["14",
           StripOnInput->False,
           FontSize->15], 
          Offset[{2, 2}, {3.2468131823400963`, 0.9867852551064058}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {GrayLevel[0], 
          DiskBox[{4.84260488773819, 0.00031662208280858195`}, 
           0.04386588072856849]}, InsetBox[
          StyleBox["16",
           StripOnInput->False,
           FontSize->15], 
          Offset[{2, 2}, {4.886470768466759, 0.044182502811377075`}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {GrayLevel[1], 
          DiskBox[{1.615038820565439, 2.7925584994602666`}, 
           0.04386588072856849]}, InsetBox[
          StyleBox["3",
           StripOnInput->False,
           FontSize->15], 
          Offset[{2, 2}, {1.6589047012940075`, 2.836424380188835}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {GrayLevel[0], 
          DiskBox[{2.2059596747698684`, 1.8733286519357606`}, 
           0.04386588072856849]}, InsetBox[
          StyleBox["15",
           StripOnInput->False,
           FontSize->15], 
          Offset[{2, 2}, {2.249825555498437, 1.9171945326643292`}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {GrayLevel[0], 
          DiskBox[{1.116817773364143, 3.568762096461513}, 
           0.04386588072856849]}, InsetBox[
          StyleBox["18",
           StripOnInput->False,
           FontSize->15], 
          Offset[{2, 2}, {1.1606836540927115`, 3.6126279771900816`}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {GrayLevel[1], 
          DiskBox[{0.9190351098951985, 1.5991549791989288`}, 
           0.04386588072856849]}, InsetBox[
          StyleBox["4",
           StripOnInput->False,
           FontSize->15], 
          Offset[{2, 2}, {0.962900990623767, 1.6430208599274974`}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {GrayLevel[0], 
          DiskBox[{1.077065292542689, 0.6834138522064925}, 
           0.04386588072856849]}, InsetBox[
          StyleBox["13",
           StripOnInput->False,
           FontSize->15], 
          Offset[{2, 2}, {1.1209311732712575`, 0.727279732935061}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {GrayLevel[0], 
          DiskBox[{0., 1.6436202228350731`}, 0.04386588072856849]}, InsetBox[
          StyleBox["17",
           StripOnInput->False,
           FontSize->15], 
          Offset[{2, 2}, {0.04386588072856849, 1.6874861035636417`}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {GrayLevel[1], 
          DiskBox[{3.1122248247086466`, 1.871955671502569}, 
           0.04386588072856849]}, InsetBox[
          StyleBox["5",
           StripOnInput->False,
           FontSize->15], 
          Offset[{2, 2}, {3.156090705437215, 1.9158215522311375`}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {GrayLevel[1], 
          DiskBox[{2.1145171663556197`, 0.9428924914547473}, 
           0.04386588072856849]}, InsetBox[
          StyleBox["6",
           StripOnInput->False,
           FontSize->15], 
          Offset[{2, 2}, {2.1583830470841883`, 0.9867583721833157}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {GrayLevel[1], 
          DiskBox[{5.317163159674459, 1.643881697368399}, 
           0.04386588072856849]}, InsetBox[
          StyleBox["7",
           StripOnInput->False,
           FontSize->15], 
          Offset[{2, 2}, {5.361029040403028, 1.6877475780969675`}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {GrayLevel[1], 
          DiskBox[{4.20178290026955, 3.5680026903276474`}, 
           0.04386588072856849]}, InsetBox[
          StyleBox["8",
           StripOnInput->False,
           FontSize->15], 
          Offset[{2, 2}, {4.245648780998119, 3.611868571056216}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {GrayLevel[1], 
          DiskBox[{0.47536576377536033`, 0.}, 0.04386588072856849]}, InsetBox[
          StyleBox["9",
           StripOnInput->False,
           FontSize->15], 
          Offset[{2, 2}, {0.5192316445039288, 0.04386588072856849}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FrameTicks->None,
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->20]], "Output",
 CellChangeTimes->{{3.6647105309910154`*^9, 3.664710539678635*^9}, 
   3.664712776075715*^9, {3.6647146462639875`*^9, 3.6647146569999*^9}, 
   3.6647147070652027`*^9, 3.6647758658943806`*^9, 3.6647782632882986`*^9, 
   3.664781569416767*^9, 3.6647825862966185`*^9, {3.664783053006422*^9, 
   3.6647831050701694`*^9}, 3.664783401957772*^9, {3.664784318897426*^9, 
   3.664784347629196*^9}, 3.6647915934343853`*^9, 3.664791650972996*^9, 
   3.6647941946439037`*^9, 3.664795675952279*^9, {3.66479685258467*^9, 
   3.664796857936727*^9}, 3.664796949299638*^9, {3.6647970618402567`*^9, 
   3.664797092926956*^9}, 3.664797156859828*^9, 3.6647974485892253`*^9, 
   3.6647975347711215`*^9, 3.664800606771449*^9, 3.664800642070337*^9, 
   3.6648008461019773`*^9, 3.664801582910545*^9, {3.6648020206737013`*^9, 
   3.6648020335493383`*^9}, 3.664802256145875*^9, {3.664802675830659*^9, 
   3.664802678294918*^9}, 3.6648031372239385`*^9, 3.6648686220984325`*^9, 
   3.665132768391432*^9, 3.6651388562564354`*^9, 3.6651402503085012`*^9, 
   3.665152781507707*^9, 
   3.6651548991102514`*^9},ImageCache->GraphicsData["CompressedBitmap", "\<\
eJztfXuQVtW150l/j+6mEYKixiulaAI+COEhIKBIFIgmvIUooPJWgSD4QBQ0
YAygYBLba4hmaBWNYoz4wCSQGO+NlyRqdIgZyjgSJqQsnJQ4CYkT7tzqujX1
zf6t11779OmmTepW3T8mprv5zrfPPmuvtfZ673Umzlux6Orr5q1YvGBe74tv
nHf9osULbur9ueU3hkulj2XZxxaFn3LvDP+uZZn+qoX/1xbjF678/3939O9z
6U9p1O7du2du27btkl27dmX/WnBtGA/nP5WvbN68+dCmTZtq4esPw79b1q5d
m/1VvluzZs2hE044AbT4sFu3bptuvvnmbCjfzn9Kpx04cOB/LFu2rIZPdfS7
9Kfm5uYxL730Eo34ixv3yU9+kshaR79LmBqQ0YhzkmlxmaBy0wJCLMJPS+ME
wjCCftsY/AxOpu1x+PDhtxYsWFA7cuSITvv+kiVLznjnnXf8tBj32z59+nho
D5x22mk27hyPw+rksNhfLV68+N1Vq1b9Nkz/7Lx584a/+uqrH/LXJxw6dOj7
EyZM+PWAAQPePeWUU97q16/f5Oeff36op1sVz+y/d+9ejK62trZuCJPheX/m
r5sCyPcFRONrP1SoeR4D7kdlf+JrfrJsJA8/n7/CsHtWrFiBCbM/8rU7AgMM
3rNnD32S4aMiETEcM2Yf8LUlgWeIrfCJocgu4K8wC2ajT+/ztWnbt2+fs3Xr
VvrEUGSj+SvMgtno0x8ifW8OfECfRnlgKuH3zuyaLP5v3G3bs//JtwE5eDIB
egxfy2r7m8N6RmbN++kTkBp+78+aR7pJRjZn+2u1Ph5L9XHUNTuZscJMvcPH
8Rteyg5G1ADJIEDWreCJdXpN5hrZvN+u7ecLeHL2qYRAhVO8/bXhWXbq+Oz5
QKR3IyHxeKJ7944evxMouybbWfMgAZE8Th5/If0p0xTDwn8jLlvVd9++Az0N
vbWwUN5h/xSvBXTztYbIjYAKyNFrybhKB5ASUgThKaS4bJAyNzTmuCFMtbM5
6xf+njMxIqZqfFkLnxmELnxt9fr1tYVbtvC1l4z5ao/Onl0zLggYwb0nv/de
axi/HvzdWHB7R6si9AupO1gVk78prko5z/HrmJW1hOvksWGb18ImTVaHlWyf
Nq0W9rmtriWIwSAq/ero3n+66CKW3l0iwezeoy5NYE3YLeVsFlil8IhaAJ2x
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
i4uwFxoKTnRL6DZRW5YhoZOlYEawCB7rt4O93XmGl38lL4019uY7/Ont2r4V
bIUnIwkSfMZlL44bd1Da+ic925hKjZpCU+ng24FbtHZ5Corveedbjqs0B0j4
HIsWq6qGRUHYgR+BAjO3uDe6qITRMBhBkeJFXxjlDTDlGRdArWjrYly7bd26
rTd84xvbBRUlb1f5Zn+WNXZVM3baann6fFdqefR3/bkzjIosO38iRQrJ6YVa
bL3My9bgVnKM6EG+lpyuW5gMT5rmP2iSLXofMpwdjtSL/i9mycR3OoiDu9BQ
EX30Fr6WHBSYnwxPIgAyPIk5yHDxKZL4wsMF1+bx8PkFM20teOLcZHgC59aC
9cjweQVYeKwAW3N4+NwCHD9eQIvZyfCEgo8XUFqGzzFNEpsictgqdZ65G6Ke
VkwO2j1ZcO0qr4Mrvkf3VY899hiFxp4yBqYnJ328Z3k5Xs03o0JIrOtf//rX
7/EMP5w3b96f161bp7X41BFqZl7yFTYusljKd+O4A9ddd12Ndiz9TsOIiUF5
9LDfk25cR2HEdNqjNjRhaDvuMDLDo7C4KezT8l1RK9OZnoBpv81nCq4JwWjV
i/+2fy9Qsdb5w5WPdfz11PYnzkeu4DbrNR822drJcVM68aiiwJkbt7WT4/4z
PaohQQxzvUbBaNqtnRvWwYM6Sp59p4Pvjkr8eN7Vv53UEXVr54ZN8VK9+Gxe
hzn2IrocZVz+kQW9M/6DHqno9CHX/xB0Gt3c8d8oDQoj7Y91/PXUv19E/T3/
zj72/wAfmh5+\
\>"]]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "This", " ", "is", " ", "to", " ", "fix", " ", "my", " ", "functional", " ",
    "tests"}], "*)"}]], "Input",
 CellChangeTimes->{{3.664868954158894*^9, 3.664868958902974*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"perfs", "=", 
   RowBox[{"perfectMatchings", "[", 
    RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cmatrix", "=", 
    RowBox[{"getGrassmannian", "[", 
     RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"Cmatrix", "=!=", "Null"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"sources", "=", 
      RowBox[{"findSources", "[", 
       RowBox[{"b", ",", "c", ",", 
        RowBox[{"perfs", "[", 
         RowBox[{"[", 
          RowBox[{"lowNumberLoopsPM", "[", 
           RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}], "]"}]}],
        "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sinks", "=", 
      RowBox[{"findSinks", "[", 
       RowBox[{"b", ",", "c", ",", 
        RowBox[{"perfs", "[", 
         RowBox[{"[", 
          RowBox[{"lowNumberLoopsPM", "[", 
           RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}], "]"}]}],
        "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Dimensions", "[", "Cmatrix", "]"}], "=!=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Length", "[", "sources", "]"}], ",", 
          RowBox[{"Length", "[", 
           RowBox[{"Join", "[", 
            RowBox[{"sources", ",", "sinks"}], "]"}], "]"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<ii=\>\"", ",", "ii", ",", 
          "\"\< : There's a problem with the Grassmannian matrix! Its size is \
not correct!\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"variablesmatrix", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Intersection", "[", 
          RowBox[{
           RowBox[{"Variables", "[", "#", "]"}], ",", 
           RowBox[{"Variables", "[", 
            RowBox[{"Join", "[", 
             RowBox[{"b", ",", "c"}], "]"}], "]"}]}], "]"}], "&"}], ",", 
        "Cmatrix", ",", 
        RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Sort", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"DeleteDuplicates", "[", 
                  RowBox[{"Join", "@@", "#"}], "]"}], "&"}], ",", 
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Intersection", "[", 
                    RowBox[{"#", ",", "sources"}], "]"}], "&"}], ",", 
                  "variablesmatrix", ",", 
                  RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], "]"}], "]"}], "===", 
            RowBox[{"Sort", "[", "sources", "]"}]}], ")"}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Sort", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"DeleteDuplicates", "[", 
                  RowBox[{"Join", "@@", "#"}], "]"}], "&"}], ",", 
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Intersection", "[", 
                    RowBox[{"#", ",", "sinks"}], "]"}], "&"}], ",", 
                  RowBox[{"Transpose", "[", "variablesmatrix", "]"}], ",", 
                  RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], "]"}], "]"}], "===", 
            RowBox[{"Sort", "[", "sinks", "]"}]}], ")"}]}], ")"}], "=!=", 
        "True"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<ii=\>\"", ",", "ii", ",", 
          "\"\< : There's a problem with the Grassmannian matrix! It doesn't \
seem to be going from sources to sinks\>\""}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"minors", "=", 
      RowBox[{"Expand", "[", 
       RowBox[{"Simplify", "[", 
        RowBox[{
         RowBox[{"Minors", "[", 
          RowBox[{"Cmatrix", ",", 
           RowBox[{"Length", "[", "Cmatrix", "]"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"minors", ",", 
          RowBox[{
           RowBox[{"Power", "[", 
            RowBox[{"___", ",", "2"}], "]"}], "|", 
           RowBox[{"Power", "[", 
            RowBox[{"___", ",", "3"}], "]"}], "|", 
           RowBox[{"Power", "[", 
            RowBox[{"___", ",", "4"}], "]"}], "|", 
           RowBox[{"Times", "[", 
            RowBox[{"2", ",", "___"}], "]"}], "|", 
           RowBox[{"Times", "[", 
            RowBox[{"3", ",", "___"}], "]"}], "|", 
           RowBox[{"Times", "[", 
            RowBox[{"4", ",", "___"}], "]"}]}]}], "]"}], "=!=", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<ii=\>\"", ",", "ii", ",", 
          "\"\< : There's a problem with the Grassmannian matrix! Its minors \
do not simplify\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}],
    "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellChangeTimes->{
  3.6648016006172333`*^9, {3.6648016325261955`*^9, 3.664801639530501*^9}, {
   3.664801669711437*^9, 3.664801670226776*^9}, {3.664801827444219*^9, 
   3.6648018320293627`*^9}, 3.664802090144421*^9, {3.6648021392416677`*^9, 
   3.664802140073226*^9}, 3.6648022780969315`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "28", 
   "\[InvisibleSpace]", "\<\" : There's a problem with the Grassmannian \
matrix! Its minors do not simplify\"\>"}],
  SequenceForm[
  "ii=", 28, 
   " : There's a problem with the Grassmannian matrix! Its minors do not \
simplify"],
  Editable->False]], "Print",
 CellChangeTimes->{3.6648022797580566`*^9, 3.664803139675248*^9, 
  3.664868633271824*^9, 3.6651327796515512`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Cmatrix", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.6648017163486605`*^9, 3.664801749977663*^9}, 
   3.664801841516792*^9, {3.6648022863478756`*^9, 3.66480228715187*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       FractionBox[
        RowBox[{"X", "[", 
         RowBox[{"1", ",", "8"}], "]"}], 
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"8", ",", "7"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"8", ",", "9"}], "]"}]}]], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"3", ",", "2"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"3", ",", "4"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"7", ",", "1"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"9", ",", "1"}], "]"}]}], 
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"1", ",", "3"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"2", ",", "9"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"6", ",", "3"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"8", ",", "7"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"8", ",", "9"}], "]"}]}]]}], "1", "0", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          RowBox[{"X", "[", 
           RowBox[{"2", ",", "6"}], "]"}], " ", 
          RowBox[{"X", "[", 
           RowBox[{"3", ",", "4"}], "]"}], " ", 
          RowBox[{"X", "[", 
           RowBox[{"5", ",", "6"}], "]"}], " ", 
          RowBox[{"X", "[", 
           RowBox[{"7", ",", "1"}], "]"}]}], 
         RowBox[{
          RowBox[{"X", "[", 
           RowBox[{"1", ",", "3"}], "]"}], " ", 
          RowBox[{"X", "[", 
           RowBox[{"6", ",", "1"}], "]"}], " ", 
          RowBox[{"X", "[", 
           RowBox[{"6", ",", "3"}], "]"}], " ", 
          RowBox[{"X", "[", 
           RowBox[{"8", ",", "7"}], "]"}]}]]}], "-", 
       FractionBox[
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"1", ",", "2"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"3", ",", "2"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"3", ",", "4"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"5", ",", "6"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"7", ",", "1"}], "]"}]}], 
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"1", ",", "3"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"2", ",", "9"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"6", ",", "1"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"6", ",", "3"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"8", ",", "7"}], "]"}]}]]}], 
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"4", ",", "1"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"7", ",", "1"}], "]"}]}], 
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"1", ",", "3"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"5", ",", "4"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"8", ",", "7"}], "]"}]}]], "-", 
       FractionBox[
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"1", ",", "5"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"2", ",", "6"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"3", ",", "4"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"7", ",", "1"}], "]"}]}], 
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"1", ",", "3"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"5", ",", "4"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"6", ",", "1"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"6", ",", "3"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"8", ",", "7"}], "]"}]}]], "-", 
       FractionBox[
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"1", ",", "2"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"1", ",", "5"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"3", ",", "2"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"3", ",", "4"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"7", ",", "1"}], "]"}]}], 
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"1", ",", "3"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"2", ",", "9"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"5", ",", "4"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"6", ",", "1"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"6", ",", "3"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"8", ",", "7"}], "]"}]}]]}], "0"},
     {
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          RowBox[{"X", "[", 
           RowBox[{"3", ",", "2"}], "]"}], " ", 
          RowBox[{"X", "[", 
           RowBox[{"3", ",", "4"}], "]"}], " ", 
          RowBox[{"X", "[", 
           RowBox[{"3", ",", "7"}], "]"}], " ", 
          RowBox[{"X", "[", 
           RowBox[{"9", ",", "1"}], "]"}]}], 
         RowBox[{
          RowBox[{"X", "[", 
           RowBox[{"1", ",", "3"}], "]"}], " ", 
          RowBox[{"X", "[", 
           RowBox[{"2", ",", "9"}], "]"}], " ", 
          RowBox[{"X", "[", 
           RowBox[{"6", ",", "3"}], "]"}], " ", 
          RowBox[{"X", "[", 
           RowBox[{"7", ",", "9"}], "]"}], " ", 
          RowBox[{"X", "[", 
           RowBox[{"8", ",", "9"}], "]"}]}]]}], "-", 
       FractionBox[
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"9", ",", "1"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"9", ",", "3"}], "]"}]}], 
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"2", ",", "9"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"7", ",", "9"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"8", ",", "9"}], "]"}]}]]}], "0", "1", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          RowBox[{"X", "[", 
           RowBox[{"2", ",", "6"}], "]"}], " ", 
          RowBox[{"X", "[", 
           RowBox[{"3", ",", "4"}], "]"}], " ", 
          RowBox[{"X", "[", 
           RowBox[{"3", ",", "7"}], "]"}], " ", 
          RowBox[{"X", "[", 
           RowBox[{"5", ",", "6"}], "]"}]}], 
         RowBox[{
          RowBox[{"X", "[", 
           RowBox[{"1", ",", "3"}], "]"}], " ", 
          RowBox[{"X", "[", 
           RowBox[{"6", ",", "1"}], "]"}], " ", 
          RowBox[{"X", "[", 
           RowBox[{"6", ",", "3"}], "]"}], " ", 
          RowBox[{"X", "[", 
           RowBox[{"7", ",", "9"}], "]"}]}]]}], "-", 
       FractionBox[
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"1", ",", "2"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"3", ",", "2"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"3", ",", "4"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"3", ",", "7"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"5", ",", "6"}], "]"}]}], 
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"1", ",", "3"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"2", ",", "9"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"6", ",", "1"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"6", ",", "3"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"7", ",", "9"}], "]"}]}]], "-", 
       FractionBox[
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"1", ",", "2"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"5", ",", "6"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"9", ",", "3"}], "]"}]}], 
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"2", ",", "9"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"6", ",", "1"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"7", ",", "9"}], "]"}]}]]}], 
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"3", ",", "7"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"4", ",", "1"}], "]"}]}], 
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"1", ",", "3"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"5", ",", "4"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"7", ",", "9"}], "]"}]}]], "-", 
       FractionBox[
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"1", ",", "5"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"2", ",", "6"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"3", ",", "4"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"3", ",", "7"}], "]"}]}], 
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"1", ",", "3"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"5", ",", "4"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"6", ",", "1"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"6", ",", "3"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"7", ",", "9"}], "]"}]}]], "-", 
       FractionBox[
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"1", ",", "2"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"1", ",", "5"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"3", ",", "2"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"3", ",", "4"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"3", ",", "7"}], "]"}]}], 
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"1", ",", "3"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"2", ",", "9"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"5", ",", "4"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"6", ",", "1"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"6", ",", "3"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"7", ",", "9"}], "]"}]}]], "-", 
       FractionBox[
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"1", ",", "2"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"1", ",", "5"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"9", ",", "3"}], "]"}]}], 
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"2", ",", "9"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"5", ",", "4"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"6", ",", "1"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"7", ",", "9"}], "]"}]}]]}], "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"3", ",", "2"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"4", ",", "6"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"9", ",", "1"}], "]"}]}], 
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"2", ",", "9"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"6", ",", "3"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"8", ",", "9"}], "]"}]}]]}], "0", "0", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          RowBox[{"X", "[", 
           RowBox[{"2", ",", "6"}], "]"}], " ", 
          RowBox[{"X", "[", 
           RowBox[{"4", ",", "6"}], "]"}], " ", 
          RowBox[{"X", "[", 
           RowBox[{"5", ",", "6"}], "]"}]}], 
         RowBox[{
          RowBox[{"X", "[", 
           RowBox[{"6", ",", "1"}], "]"}], " ", 
          RowBox[{"X", "[", 
           RowBox[{"6", ",", "3"}], "]"}]}]]}], "-", 
       FractionBox[
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"1", ",", "2"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"3", ",", "2"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"4", ",", "6"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"5", ",", "6"}], "]"}]}], 
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"2", ",", "9"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"6", ",", "1"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"6", ",", "3"}], "]"}]}]]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          RowBox[{"X", "[", 
           RowBox[{"1", ",", "5"}], "]"}], " ", 
          RowBox[{"X", "[", 
           RowBox[{"2", ",", "6"}], "]"}], " ", 
          RowBox[{"X", "[", 
           RowBox[{"4", ",", "6"}], "]"}]}], 
         RowBox[{
          RowBox[{"X", "[", 
           RowBox[{"5", ",", "4"}], "]"}], " ", 
          RowBox[{"X", "[", 
           RowBox[{"6", ",", "1"}], "]"}], " ", 
          RowBox[{"X", "[", 
           RowBox[{"6", ",", "3"}], "]"}]}]]}], "-", 
       FractionBox[
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"1", ",", "2"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"1", ",", "5"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"3", ",", "2"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"4", ",", "6"}], "]"}]}], 
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"2", ",", "9"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"5", ",", "4"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"6", ",", "1"}], "]"}], " ", 
         RowBox[{"X", "[", 
          RowBox[{"6", ",", "3"}], "]"}]}]]}], "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.6648017113912745`*^9, 3.6648017504569817`*^9}, 
   3.6648018419180555`*^9, 3.664802043383768*^9, 3.664802096121987*^9, 
   3.6648022876552057`*^9, 3.6648031423117485`*^9, 3.6648686360998044`*^9, 
   3.6651327825354548`*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.664801074061633*^9, 3.6648010748541913`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "This", " ", "is", " ", "to", " ", "fix", " ", "the", " ", 
   "makeAutomaticBoundariesAndCuts", " ", "function"}], "*)"}]], "Input",
 CellChangeTimes->{{3.6648691372826247`*^9, 3.664869147969286*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"adjacencymat", "=", 
   RowBox[{"getAdjacencyMatrix", "[", 
    RowBox[{
    "topleft", ",", "topright", ",", "bottomleft", ",", "bottomright"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"graph", "=", 
    RowBox[{"AdjacencyGraph", "[", "adjacencymat", "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "We", " ", "have", " ", "finished", " ", "making", " ", "the", " ", 
    "Mathematica", " ", 
    RowBox[{"graph", "!"}]}], "*)"}]}]}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"makeAutomaticBoundariesAndCuts", "[", 
  RowBox[{
  "graph", ",", "topleft", ",", "topright", ",", "bottomleft", ",", 
   "bottomright"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"X", "[", 
       RowBox[{"8", ",", "9"}], "]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"X", "[", 
       RowBox[{"8", ",", "7"}], "]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "9"}], "]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "6"}], "]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "6"}], "]"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"X", "[", 
          RowBox[{"8", ",", "9"}], "]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"X", "[", 
          RowBox[{"8", ",", "7"}], "]"}], "}"}]}], "}"}], "\[Rule]", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"X", "[", 
          RowBox[{"8", ",", "7"}], "]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"X", "[", 
          RowBox[{"7", ",", "9"}], "]"}], "}"}]}], "}"}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"7", ",", "1"}], "]"}], "\[Rule]", 
         RowBox[{"-", 
          RowBox[{"X", "[", 
           RowBox[{"7", ",", "1"}], "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"1", ",", "8"}], "]"}], "\[Rule]", 
         RowBox[{"-", 
          RowBox[{"X", "[", 
           RowBox[{"1", ",", "8"}], "]"}]}]}]}], "}"}]}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"X", "[", 
          RowBox[{"7", ",", "9"}], "]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"X", "[", 
          RowBox[{"5", ",", "6"}], "]"}], "}"}]}], "}"}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"9", ",", "3"}], "]"}], "\[Rule]", 
         RowBox[{"-", 
          RowBox[{"X", "[", 
           RowBox[{"9", ",", "3"}], "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"6", ",", "3"}], "]"}], "\[Rule]", 
         RowBox[{"-", 
          RowBox[{"X", "[", 
           RowBox[{"6", ",", "3"}], "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"5", ",", "4"}], "]"}], "\[Rule]", 
         RowBox[{"-", 
          RowBox[{"X", "[", 
           RowBox[{"5", ",", "4"}], "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"4", ",", "6"}], "]"}], "\[Rule]", 
         RowBox[{"-", 
          RowBox[{"X", "[", 
           RowBox[{"4", ",", "6"}], "]"}]}]}]}], "}"}]}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"X", "[", 
          RowBox[{"5", ",", "6"}], "]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"X", "[", 
          RowBox[{"5", ",", "4"}], "]"}], "}"}]}], "}"}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"X", "[", 
         RowBox[{"5", ",", "4"}], "]"}], "\[Rule]", 
        RowBox[{"-", 
         RowBox[{"X", "[", 
          RowBox[{"5", ",", "4"}], "]"}]}]}], "}"}]}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"X", "[", 
          RowBox[{"5", ",", "4"}], "]"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"X", "[", 
          RowBox[{"4", ",", "6"}], "]"}], "}"}]}], "}"}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"2", ",", "6"}], "]"}], "\[Rule]", 
         RowBox[{"-", 
          RowBox[{"X", "[", 
           RowBox[{"2", ",", "6"}], "]"}]}]}], ",", 
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"3", ",", "2"}], "]"}], "\[Rule]", 
         RowBox[{"-", 
          RowBox[{"X", "[", 
           RowBox[{"3", ",", "2"}], "]"}]}]}]}], "}"}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.6648691406051073`*^9, 3.665132840333671*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"planargraph", "=", 
   RowBox[{"Graph", "[", 
    RowBox[{"graph", ",", 
     RowBox[{"GraphLayout", "\[Rule]", "\"\<PlanarEmbedding\>\""}]}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"verticespos", "=", 
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"#1", ",", "#2"}], "}"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Range", "[", 
        RowBox[{"Length", "[", 
         RowBox[{"GraphEmbedding", "[", "planargraph", "]"}], "]"}], "]"}], 
       ",", 
       RowBox[{"GraphEmbedding", "[", "planargraph", "]"}]}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"edgepos", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"verticespos", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "2"}], "]"}], "]"}], ",", 
          RowBox[{"verticespos", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", "2"}], "]"}], "]"}]}], 
         "}"}], ",", "#"}], "}"}], "&"}], ",", 
     RowBox[{"EdgeList", "[", "planargraph", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"edgepos", "=", 
    RowBox[{"DeleteDuplicates", "[", "edgepos", "]"}]}], ";", 
   RowBox[{"(*", 
    RowBox[{"in", " ", "case", " ", "there", " ", "are", " ", "bubbles"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Now", " ", "we", " ", "have", " ", "the", " ", "vertices", " ", "and", 
     " ", "edges", " ", "for", " ", "an", " ", "embedding", " ", "with", " ", 
     "no", " ", "edge", " ", "crossings"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Each", " ", "external", " ", "vertex", " ", "will", " ", "be", " ", 
     "seen", " ", "as", " ", "having", " ", "its", " ", "own", " ", "tiny", 
     " ", "boundary", " ", "attached", " ", "to", " ", "it"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"boundaries", "=", 
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{"Flatten", "[", 
       RowBox[{"DeleteCases", "[", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{"bottomleft", ",", 
           RowBox[{"Transpose", "[", "topright", "]"}]}], "]"}], ",", "0", 
         ",", 
         RowBox[{"{", "2", "}"}]}], "]"}], "]"}], "}"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Now", " ", 
     RowBox[{"we", "'"}], "ll", " ", "construct", " ", "the", " ", 
     RowBox[{"cuts", ":", " ", 
      RowBox[{
      "they", " ", "will", " ", "run", " ", "directly", " ", "between", " ", 
       "the", " ", "external", " ", "vertices"}]}]}], ",", " ", 
    RowBox[{
    "since", " ", "the", " ", "boundaries", " ", "are", " ", "so", " ", 
     "tiny"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"externalnodenumbers", "=", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Range", "[", 
        RowBox[{"Length", "[", "bottomleft", "]"}], "]"}], "+", 
       RowBox[{"Length", "[", "topleft", "]"}]}], ",", 
      RowBox[{
       RowBox[{"Range", "[", 
        RowBox[{
         RowBox[{"Dimensions", "[", "topright", "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], "]"}], "+", 
       RowBox[{"Total", "[", 
        RowBox[{"Dimensions", "[", "topleft", "]"}], "]"}], "+", 
       RowBox[{"Length", "[", "bottomleft", "]"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Now", " ", "decrease", " ", "the", " ", "length", " ", "of", " ", "all", 
     " ", "external", " ", "edges", " ", "by", " ", "about", " ", "14", "%"}],
     ",", " ", 
    RowBox[{
    "since", " ", "PlanarEmbedding", " ", "tries", " ", "to", " ", "put", " ",
      "everything", " ", "as", " ", "collinear", " ", "as", " ", "possible"}],
     ",", " ", 
    RowBox[{
    "which", " ", "is", " ", "problematic", " ", "when", " ", "we", " ", 
     "make", " ", "cuts"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"verticestocoords", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Rule", "@@", "#"}], "&"}], ",", "verticespos"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"externalvertices", "=", 
   RowBox[{"externalnodenumbers", "/.", "verticestocoords"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"externaledges", "=", 
   RowBox[{"Cases", "[", 
    RowBox[{"edgepos", ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"___", ",", 
        RowBox[{"UndirectedEdge", "[", 
         RowBox[{
          RowBox[{"Alternatives", "@@", "externalnodenumbers"}], ",", "_"}], 
         "]"}]}], "}"}], "|", 
      RowBox[{"{", 
       RowBox[{"___", ",", 
        RowBox[{"UndirectedEdge", "[", 
         RowBox[{"_", ",", 
          RowBox[{"Alternatives", "@@", "externalnodenumbers"}]}], "]"}]}], 
       "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"decreaseExternalEdgeLength", "=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"inputedge", ",", "decreasequantity"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "This", " ", "function", " ", "needs", " ", "externalvertices", " ", 
       "to", " ", "be", " ", "accurate", " ", "in", " ", "order", " ", "to", 
       " ", "work"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "tosubtractcoords", ",", "externalnodepolarcoords", ",", 
         "newposition", ",", "newpositionrule"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tosubtractcoords", "=", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"inputedge", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"Except", "[", 
             RowBox[{"Alternatives", "@@", "externalvertices"}], "]"}]}], 
           "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"externalnodepolarcoords", "=", 
         RowBox[{"ToPolarCoordinates", "[", 
          RowBox[{
           RowBox[{"DeleteCases", "[", 
            RowBox[{
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "-", "tosubtractcoords"}], "&"}], ",", 
               RowBox[{"inputedge", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"0.", ",", "0."}], "}"}]}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"newposition", "=", 
         RowBox[{"tosubtractcoords", "+", 
          RowBox[{"FromPolarCoordinates", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1.", "-", "decreasequantity"}], ")"}], 
              RowBox[{"externalnodepolarcoords", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{"externalnodepolarcoords", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"newpositionrule", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"inputedge", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"Except", "[", "tosubtractcoords", "]"}]}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", "newposition"}]}], ";", 
        "\[IndentingNewLine]", "newpositionrule"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"shiftexternaledges", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"decreaseExternalEdgeLength", "[", 
       RowBox[{"#", ",", "0.14"}], "]"}], "&"}], ",", "externaledges"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"verticespos", "=", 
   RowBox[{"verticespos", "/.", "shiftexternaledges"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"edgepos", "=", 
   RowBox[{"edgepos", "/.", "shiftexternaledges"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"verticestocoords", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Rule", "@@", "#"}], "&"}], ",", "verticespos"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"externalvertices", "=", 
   RowBox[{"externalvertices", "/.", "shiftexternaledges"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"externaledges", "=", 
    RowBox[{"externaledges", "/.", "shiftexternaledges"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Now", " ", "we", " ", "have", " ", "the", " ", "vertices", " ", "and", 
    " ", "edges", " ", "for", " ", "an", " ", "embedding", " ", "with", " ", 
    "no", " ", "edge", " ", 
    RowBox[{"crossings", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Now", " ", 
     RowBox[{"we", "'"}], "ll", " ", "construct", " ", "the", " ", 
     RowBox[{"cuts", ":", " ", 
      RowBox[{
      "they", " ", "will", " ", "run", " ", "directly", " ", "between", " ", 
       "the", " ", "external", " ", "vertices"}]}]}], ",", " ", 
    RowBox[{
    "since", " ", "the", " ", "boundaries", " ", "are", " ", "so", " ", 
     "tiny"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"We", "'"}], "ll", " ", "make", " ", "a", " ", "sequence", " ", 
      "of", " ", "boundaries", " ", "connected", " ", "by", " ", 
      RowBox[{"cuts", ".", " ", 
       RowBox[{"We", "'"}]}], "ll", " ", "start", " ", "with", " ", "the", 
      " ", "external", " ", "node", " ", "with", " ", "the", " ", "highest", 
      " ", "y"}], "-", "coordinate"}], ",", " ", 
    RowBox[{
    "and", " ", "proceed", " ", "along", " ", "external", " ", "nodes", " ", 
     "as", " ", "we", " ", "spiral", " ", "in", " ", "to", " ", "the", " ", 
     RowBox[{"middle", ".", " ", "This"}], " ", "ensures", " ", "that", " ", 
     "the", " ", "cuts", " ", "never", " ", "cross", " ", "each", " ", 
     "other"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Before", " ", "we", " ", "start", " ", 
    RowBox[{"we", "'"}], "ll", " ", "make", " ", "a", " ", "rule", " ", 
    "that", " ", "translates", " ", "node", " ", "numbers", " ", "into", " ", 
    "edge", " ", 
    RowBox[{"labels", ".", " ", "This"}], " ", "will", " ", "be", " ", 
    "useful", " ", "to", " ", "us", " ", "at", " ", "the", " ", "very", " ", 
    "end"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nodenumberstoedges", "=", 
    RowBox[{"MapThread", "[", 
     RowBox[{"Rule", ",", 
      RowBox[{"{", 
       RowBox[{"externalnodenumbers", ",", 
        RowBox[{"Flatten", "[", "boundaries", "]"}]}], "}"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "This", " ", "function", " ", "takes", " ", "a", " ", "list", " ", "of", 
     " ", "vertices", " ", "and", " ", "orders", " ", "them", " ", 
     "according", " ", "to", " ", "the", " ", "spiralling"}], "-", 
    RowBox[{"in", " ", "order"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"spiralInList", "=", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", "vertexlist", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "remainingvertices", ",", "nextnode", ",", "finalvertexlist", ",", 
          "polardistances"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"remainingvertices", "=", "vertexlist"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "The", " ", "first", " ", "node", " ", "is", " ", "the", " ", 
            "one", " ", "with", " ", "the", " ", "largest", " ", "y"}], "-", 
           "coordinate"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"nextnode", "=", 
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{"remainingvertices", ",", 
             RowBox[{"{", 
              RowBox[{"_", ",", 
               RowBox[{"Max", "[", 
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "&"}], ",", 
                  "remainingvertices"}], "]"}], "]"}]}], "}"}]}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"finalvertexlist", "=", 
          RowBox[{"{", "nextnode", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"remainingvertices", "=", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{"remainingvertices", ",", "nextnode"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"While", "[", 
          RowBox[{
           RowBox[{"remainingvertices", "=!=", 
            RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"polardistances", "=", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"Mod", "[", 
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"2", "Pi"}]}], "]"}]}], "}"}], "&"}], ",", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"ToPolarCoordinates", "[", 
                   RowBox[{"#", "-", "nextnode"}], "]"}], "&"}], ",", 
                 "remainingvertices"}], "]"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
             "The", " ", "next", " ", "node", " ", "is", " ", "the", " ", 
              "first", " ", "one", " ", "reached", " ", "going", " ", 
              "radially", " ", "and", " ", "clockwise", " ", "from", " ", 
              "the", " ", "current", " ", "node"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"nextnode", "=", 
             RowBox[{"Cases", "[", 
              RowBox[{"polardistances", ",", 
               RowBox[{"{", 
                RowBox[{"_", ",", 
                 RowBox[{"Max", "[", 
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "&"}], ",", 
                    "polardistances"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";",
             "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{
              "If", " ", "there", " ", "are", " ", "multiple", " ", "ones", 
               " ", "with", " ", "the", " ", "same", " ", "angle"}], ",", " ", 
              RowBox[{"pick", " ", "the", " ", "nearest", " ", "one"}]}], 
             "*)"}], "\[IndentingNewLine]", 
            RowBox[{"nextnode", "=", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{"nextnode", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Min", "[", 
                   RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", "nextnode"}], 
                    "]"}], "]"}], ",", "_"}], "}"}]}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"nextnode", "=", 
             RowBox[{"remainingvertices", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"polardistances", ",", "nextnode"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"finalvertexlist", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"finalvertexlist", ",", "nextnode"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"remainingvertices", "=", 
             RowBox[{"DeleteCases", "[", 
              RowBox[{"remainingvertices", ",", "nextnode"}], "]"}]}], 
            ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]",
          "finalvertexlist"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Now", " ", 
    RowBox[{"we", "'"}], "ll", " ", "order", " ", "our", " ", "external", " ",
     "vertices", " ", "and", " ", "our", " ", "boundaries", " ", "in", " ", 
    "this", " ", "new", " ", "order"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"externalvertices", "=", 
   RowBox[{"spiralInList", "[", "externalvertices", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"boundaries", "=", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", "#", "}"}], "&"}], ",", 
       RowBox[{"externalvertices", "/.", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "\[Rule]", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "&"}], ",", 
          "verticestocoords"}], "]"}]}]}], "]"}], "/.", 
     "nodenumberstoedges"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"We", " ", "may", " ", "now", " ", "form", " ", "the", " ", 
     RowBox[{"cuts", ":", " ", 
      RowBox[{"they", " ", "are", " ", 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], " ", "sequential", " ", "pairs", " ", 
       "of", " ", 
       RowBox[{"externalvertices", ".", " ", "We"}], " ", "need", " ", "to", 
       " ", "see", " ", "if", " ", "any", " ", "of", " ", "the", " ", "cuts", 
       " ", "end", " ", "up", " ", "going", " ", "through", " ", "nodes", " ",
        "attached", " ", "to", " ", "external", " ", 
       RowBox[{"nodes", ".", " ", "If"}], " ", "they", " ", "do"}]}]}], ",", 
    " ", 
    RowBox[{"things", " ", "get", " ", "complicated", " ", "so", " ", 
     RowBox[{"it", "'"}], "s", " ", "better", " ", "to", " ", "rotate", " ", 
     "the", " ", "external", " ", "node", " ", "to", " ", "make", " ", "sure",
      " ", "to", " ", "cut", " ", 
     RowBox[{"doesn", "'"}], "t", " ", "do", " ", 
     RowBox[{"this", "."}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"cutcoordinates", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"externalvertices", "[", 
       RowBox[{"[", "iii", "]"}], "]"}], ",", 
      RowBox[{"externalvertices", "[", 
       RowBox[{"[", 
        RowBox[{"iii", "+", "1"}], "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"iii", ",", 
      RowBox[{
       RowBox[{"Length", "[", "externalvertices", "]"}], "-", "1"}]}], 
     "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.665133734381666*^9, 3.665133798251997*^9}, {
  3.6651360739679976`*^9, 3.6651363148627825`*^9}, {3.6651365365855427`*^9, 
  3.665136568700373*^9}, {3.6651367397285504`*^9, 3.665136744028371*^9}, {
  3.665138068326414*^9, 3.6651381137380643`*^9}, {3.66513820587717*^9, 
  3.665138229705703*^9}, {3.6651382712973676`*^9, 3.6651383028607535`*^9}, {
  3.6651384592318473`*^9, 3.665138468668524*^9}, {3.665138502368385*^9, 
  3.6651385935325775`*^9}, {3.665138678946639*^9, 3.665138741639718*^9}, {
  3.6651390088339596`*^9, 3.6651390156817536`*^9}, {3.66513904658555*^9, 
  3.6651391879680405`*^9}, {3.665139228087767*^9, 3.665139343641755*^9}, {
  3.665139477055296*^9, 3.6651394831679144`*^9}, {3.6651395167383685`*^9, 
  3.665139517019636*^9}, {3.6651395556374087`*^9, 3.6651396245936375`*^9}, {
  3.6651396856028643`*^9, 3.6651396986489325`*^9}, {3.6651403234152083`*^9, 
  3.6651404033494554`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5.265981236333619`*^-17", ",", "15.86`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"12.`", ",", "4.86`"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"12.`", ",", "4.86`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"11.72`", ",", "2.8600000000000003`"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"11.72`", ",", "2.8600000000000003`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.86`", ",", "4.`"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.86`", ",", "4.`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6.42`", ",", "3.58`"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"6.42`", ",", "3.58`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1.28`", ",", "4.720000000000001`"}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.6651396135230083`*^9, 3.6651396257501097`*^9}, {
   3.6651396863306427`*^9, 3.6651396989301863`*^9}, 3.6651402567097487`*^9, 
   3.665140318325569*^9, {3.665140373350638*^9, 3.6651404041776223`*^9}, 
   3.665150550997023*^9, 3.665153015515334*^9, 3.665153214190833*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"These", " ", "cells", " ", 
    RowBox[{"we", "'"}], "ll", " ", "need", " ", "to", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"delete", " ", "--"}], "--"}], "--"}], "--"}]}], ">", 
   "        ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", "--"}]}]}]}]}]}]}], ">", "       ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", "--"}]}]}]}]}]}]}], ">", "       ", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", "--"}]}]}]}]}]}]}], ">"}], " ", "*)"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.66514257869643*^9, 3.6651426102893887`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "We", " ", "shall", " ", "begin", " ", "by", " ", "drawing", " ", "out", 
    " ", "the", " ", "graph", " ", "such", " ", "that", " ", "no", " ", 
    "edges", " ", 
    RowBox[{"cross", ".", " ", "In"}], " ", "so", " ", "doing", " ", 
    RowBox[{"we", "'"}], "ll", " ", "be", " ", "able", " ", "to", " ", 
    "extract", " ", "the", " ", "vertex", " ", "coordinates", " ", "and", " ",
     "edge", " ", "positions", " ", "of", " ", "this", " ", "embedding"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"planargraph", "=", 
     RowBox[{"Graph", "[", 
      RowBox[{"graph", ",", 
       RowBox[{"GraphLayout", "\[Rule]", "\"\<PlanarEmbedding\>\""}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"verticespos", "=", 
     RowBox[{"MapThread", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"#1", ",", "#2"}], "}"}], "&"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{"Length", "[", 
           RowBox[{"GraphEmbedding", "[", "planargraph", "]"}], "]"}], "]"}], 
         ",", 
         RowBox[{"GraphEmbedding", "[", "planargraph", "]"}]}], "}"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"edgepos", "=", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"verticespos", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "2"}], "]"}], "]"}], ",", 
            RowBox[{"verticespos", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", "2"}], "]"}], "]"}]}], 
           "}"}], ",", "#"}], "}"}], "&"}], ",", 
       RowBox[{"EdgeList", "[", "planargraph", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"edgepos", "=", 
     RowBox[{"DeleteDuplicates", "[", "edgepos", "]"}]}], ";", 
    RowBox[{"(*", 
     RowBox[{"in", " ", "case", " ", "there", " ", "are", " ", "bubbles"}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "Now", " ", "we", " ", "have", " ", "the", " ", "vertices", " ", "and", 
      " ", "edges", " ", "for", " ", "an", " ", "embedding", " ", "with", " ",
       "no", " ", "edge", " ", "crossings"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "Each", " ", "external", " ", "vertex", " ", "will", " ", "be", " ", 
      "seen", " ", "as", " ", "having", " ", "its", " ", "own", " ", "tiny", 
      " ", "boundary", " ", "attached", " ", "to", " ", "it"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"boundaries", "=", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{"Flatten", "[", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{"bottomleft", ",", 
            RowBox[{"Transpose", "[", "topright", "]"}]}], "]"}], ",", "0", 
          ",", 
          RowBox[{"{", "2", "}"}]}], "]"}], "]"}], "}"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Now", " ", 
      RowBox[{"we", "'"}], "ll", " ", "construct", " ", "the", " ", 
      RowBox[{"cuts", ":", " ", 
       RowBox[{
       "they", " ", "will", " ", "run", " ", "directly", " ", "between", " ", 
        "the", " ", "external", " ", "vertices"}]}]}], ",", " ", 
     RowBox[{
     "since", " ", "the", " ", "boundaries", " ", "are", " ", "so", " ", 
      "tiny"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"externalnodenumbers", "=", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Range", "[", 
         RowBox[{"Length", "[", "bottomleft", "]"}], "]"}], "+", 
        RowBox[{"Length", "[", "topleft", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Range", "[", 
         RowBox[{
          RowBox[{"Dimensions", "[", "topright", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "]"}], "+", 
        RowBox[{"Total", "[", 
         RowBox[{"Dimensions", "[", "topleft", "]"}], "]"}], "+", 
        RowBox[{"Length", "[", "bottomleft", "]"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"externaledges", "=", 
     RowBox[{"Cases", "[", 
      RowBox[{"edgepos", ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"___", ",", 
          RowBox[{"UndirectedEdge", "[", 
           RowBox[{
            RowBox[{"Alternatives", "@@", "externalnodenumbers"}], ",", "_"}],
            "]"}]}], "}"}], "|", 
        RowBox[{"{", 
         RowBox[{"___", ",", 
          RowBox[{"UndirectedEdge", "[", 
           RowBox[{"_", ",", 
            RowBox[{"Alternatives", "@@", "externalnodenumbers"}]}], "]"}]}], 
         "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"verticestocoords", "=", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Rule", "@@", "#"}], "&"}], ",", "verticespos"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"externalvertices", "=", 
     RowBox[{"externalnodenumbers", "/.", "verticestocoords"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"Now", " ", 
       RowBox[{"we", "'"}], "ll", " ", "need", " ", "to", " ", "make", " ", 
       "a", " ", "sequence", " ", "of", " ", "boundaries", " ", "connected", 
       " ", "by", " ", 
       RowBox[{"cuts", ".", " ", 
        RowBox[{"We", "'"}]}], "ll", " ", "start", " ", "with", " ", "the", 
       " ", "external", " ", "node", " ", "with", " ", "the", " ", "highest", 
       " ", "y"}], "-", "coordinate"}], ",", " ", 
     RowBox[{
     "and", " ", "proceed", " ", "along", " ", "external", " ", "nodes", " ", 
      "as", " ", "we", " ", "spiral", " ", "in", " ", "to", " ", "the", " ", 
      RowBox[{"middle", ".", " ", "This"}], " ", "ensures", " ", "that", " ", 
      "the", " ", "cuts", " ", "never", " ", "cross", " ", "each", " ", 
      "other"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Before", " ", "we", " ", "start", " ", 
     RowBox[{"we", "'"}], "ll", " ", "make", " ", "a", " ", "rule", " ", 
     "that", " ", "translates", " ", "node", " ", "numbers", " ", "into", " ",
      "edge", " ", 
     RowBox[{"labels", ".", " ", "This"}], " ", "will", " ", "be", " ", 
     "useful", " ", "to", " ", "us", " ", "at", " ", "the", " ", "very", " ", 
     "end"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nodenumberstoedges", "=", 
     RowBox[{"MapThread", "[", 
      RowBox[{"Rule", ",", 
       RowBox[{"{", 
        RowBox[{"externalnodenumbers", ",", 
         RowBox[{"Flatten", "[", "boundaries", "]"}]}], "}"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "This", " ", "function", " ", "takes", " ", "a", " ", "list", " ", "of", 
      " ", "vertices", " ", "and", " ", "orders", " ", "them", " ", 
      "according", " ", "to", " ", "the", " ", "spiralling"}], "-", 
     RowBox[{"in", " ", "order"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"spiralInList", "=", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", "vertexlist", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "remainingvertices", ",", "nextnode", ",", "finalvertexlist", ",", 
           "polardistances"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"remainingvertices", "=", "vertexlist"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
            "The", " ", "first", " ", "node", " ", "is", " ", "the", " ", 
             "one", " ", "with", " ", "the", " ", "largest", " ", "y"}], "-", 
            "coordinate"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"nextnode", "=", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{"remainingvertices", ",", 
              RowBox[{"{", 
               RowBox[{"_", ",", 
                RowBox[{"Max", "[", 
                 RowBox[{"Map", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "&"}], ",", 
                   "remainingvertices"}], "]"}], "]"}]}], "}"}]}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"finalvertexlist", "=", 
           RowBox[{"{", "nextnode", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"remainingvertices", "=", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{"remainingvertices", ",", "nextnode"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{"remainingvertices", "=!=", 
             RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"polardistances", "=", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"2", "Pi"}]}], "]"}]}], "}"}], "&"}], ",", 
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"ToPolarCoordinates", "[", 
                    RowBox[{"#", "-", "nextnode"}], "]"}], "&"}], ",", 
                  "remainingvertices"}], "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "The", " ", "next", " ", "node", " ", "is", " ", "the", " ", 
               "first", " ", "one", " ", "reached", " ", "going", " ", 
               "radially", " ", "and", " ", "clockwise", " ", "from", " ", 
               "the", " ", "current", " ", "node"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"nextnode", "=", 
              RowBox[{"Cases", "[", 
               RowBox[{"polardistances", ",", 
                RowBox[{"{", 
                 RowBox[{"_", ",", 
                  RowBox[{"Max", "[", 
                   RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "&"}], ",", 
                    "polardistances"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";",
              "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{
               "If", " ", "there", " ", "are", " ", "multiple", " ", "ones", 
                " ", "with", " ", "the", " ", "same", " ", "angle"}], ",", 
               " ", 
               RowBox[{"pick", " ", "the", " ", "nearest", " ", "one"}]}], 
              "*)"}], "\[IndentingNewLine]", 
             RowBox[{"nextnode", "=", 
              RowBox[{
               RowBox[{"Cases", "[", 
                RowBox[{"nextnode", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Min", "[", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", "nextnode"}], 
                    "]"}], "]"}], ",", "_"}], "}"}]}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"nextnode", "=", 
              RowBox[{"remainingvertices", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"polardistances", ",", "nextnode"}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"finalvertexlist", "=", 
              RowBox[{"Append", "[", 
               RowBox[{"finalvertexlist", ",", "nextnode"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"remainingvertices", "=", 
              RowBox[{"DeleteCases", "[", 
               RowBox[{"remainingvertices", ",", "nextnode"}], "]"}]}], 
             ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", "finalvertexlist"}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Now", " ", 
     RowBox[{"we", "'"}], "ll", " ", "order", " ", "our", " ", "external", 
     " ", "vertices", " ", "and", " ", "our", " ", "boundaries", " ", "in", 
     " ", "this", " ", "new", " ", "order"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"externalvertices", "=", 
     RowBox[{"spiralInList", "[", "externalvertices", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"boundaries", "=", 
     RowBox[{
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", "#", "}"}], "&"}], ",", 
        RowBox[{"externalvertices", "/.", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "\[Rule]", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "&"}], ",", 
           "verticestocoords"}], "]"}]}]}], "]"}], "/.", 
      "nodenumberstoedges"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"We", " ", "may", " ", "now", " ", "form", " ", "the", " ", 
     RowBox[{"cuts", ":", " ", 
      RowBox[{"they", " ", "are", " ", 
       RowBox[{"(", 
        RowBox[{"n", "-", "1"}], ")"}], " ", "sequential", " ", "pairs", " ", 
       "of", " ", "externalvertices"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cutcoordinates", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"externalvertices", "[", 
          RowBox[{"[", "iii", "]"}], "]"}], ",", 
         RowBox[{"externalvertices", "[", 
          RowBox[{"[", 
           RowBox[{"iii", "+", "1"}], "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"iii", ",", 
         RowBox[{
          RowBox[{"Length", "[", "externalvertices", "]"}], "-", "1"}]}], 
        "}"}]}], "]"}]}], ";"}]}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.665142243906386*^9, 3.6651422441251483`*^9}, 
   3.6651426102893887`*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"rotateExternalVertices", "[", "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "Our", " ", "cuts", " ", "may", " ", "never", " ", "go", " ", 
        "through", " ", "the", " ", "\"\<critical nodes\>\""}], ",", " ", 
       RowBox[{
        RowBox[{"i", ".", "e", ".", "  ", "those"}], " ", "nodes", " ", 
        "attached", " ", "to", " ", "external", " ", "nodes"}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tocriticalnode", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Rule", "@@", "#"}], "&"}], ",", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", "externaledges"}], 
            "]"}], ",", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Reverse", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "&"}], ",", 
             "externaledges"}], "]"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "If", " ", "we", " ", "go", " ", "through", " ", "a", " ", "critical", 
        " ", "node", " ", "we", " ", "need", " ", "to", " ", "take", " ", 
        "the", " ", "external", " ", "edges", " ", "and", " ", "rotate", " ", 
        RowBox[{"them", ".", " ", "We"}], " ", "must", " ", "stay", " ", 
        "within", " ", "the", " ", "same", " ", "face", " ", "and", " ", 
        "also", " ", "not", " ", "cross", " ", "any", " ", "other", " ", 
        RowBox[{"edges", "."}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"badexternalnodes", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"cutcoordinates", "[", 
           RowBox[{"[", 
            RowBox[{"Sequence", "@@", "#"}], "]"}], "]"}], "&"}], ",", 
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Solve", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "+", 
                    RowBox[{"param", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "\[Equal]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "iii", "]"}], "]"}], "/.", 
                    "tocriticalnode"}], ")"}]}], ",", "param"}], "]"}], "===", 
                 RowBox[{"{", "}"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"iii", ",", "2"}], "}"}]}], "]"}], "&"}], ",", 
             "cutcoordinates"}], "]"}], ",", "False"}], "]"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "This", " ", "function", " ", "takes", " ", "an", " ", "external", 
         " ", "edge"}], ",", " ", 
        RowBox[{
        "finds", " ", "the", " ", "two", " ", "nearest", " ", "edges", " ", 
         "to", " ", "it", " ", 
         RowBox[{"(", 
          RowBox[{
          "coming", " ", "from", " ", "the", " ", "same", " ", "critical", 
           " ", "node"}], ")"}]}], ",", " ", 
        RowBox[{
        "determines", " ", "which", " ", "ones", " ", "has", " ", "the", " ", 
         "smallest", " ", "angle", " ", "to", " ", "our", " ", "external", 
         " ", "edge"}], ",", " ", 
        RowBox[{
        "and", " ", "rotates", " ", "the", " ", "external", " ", "edge", " ", 
         "95", "%", " ", 
         RowBox[{"(", 
          RowBox[{"to", " ", "the", " ", "power", " ", "\"\<iteration\>\""}], 
          ")"}], " ", "of", " ", "the", " ", "way", " ", "there"}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"rotateExternalEdge", "=", 
       RowBox[{"Function", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"inputexternaledge", ",", "iteration"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "This", " ", "function", " ", "needs", " ", "tocriticalnode"}], 
           ",", " ", "edgepos"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Block", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "criticalnode", ",", "externaledgenewcoordinates", ",", 
             "otheredgesnewcoordinates", ",", 
             "rotatedotheredgesnewcoordinates", ",", "anglesotheredges", ",", 
             "smallestangle", ",", "newexternaledgeposition"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"criticalnode", "=", 
             RowBox[{"inputexternaledge", "/.", "tocriticalnode"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"externaledgenewcoordinates", "=", 
             RowBox[{"ToPolarCoordinates", "[", 
              RowBox[{"inputexternaledge", "-", "criticalnode"}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"otheredgesnewcoordinates", "=", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"DeleteCases", "[", 
                  RowBox[{"#", ",", 
                   RowBox[{"{", 
                    RowBox[{"0.", ",", "0."}], "}"}]}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "-", "criticalnode"}], "&"}], ",", 
                 RowBox[{"DeleteCases", "[", 
                  RowBox[{
                   RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", 
                    RowBox[{"Cases", "[", 
                    RowBox[{"edgepos", ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"___", ",", "criticalnode"}], "}"}], ",", "___"}],
                     "}"}], "|", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"criticalnode", ",", "___"}], "}"}], ",", "___"}],
                     "}"}]}]}], "]"}]}], "]"}], ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"___", ",", "inputexternaledge"}], "}"}], "|", 
                    RowBox[{"{", 
                    RowBox[{"inputexternaledge", ",", "___"}], "}"}]}]}], 
                  "]"}], ",", 
                 RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"rotatedotheredgesnewcoordinates", "=", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ToPolarCoordinates", "[", 
                 RowBox[{
                  RowBox[{"RotationMatrix", "[", 
                   RowBox[{"-", 
                    RowBox[{"externaledgenewcoordinates", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ".", "#"}], 
                 "]"}], "&"}], ",", "otheredgesnewcoordinates"}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"anglesotheredges", "=", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Mod", "[", 
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"2", "Pi"}]}], "]"}], "&"}], ",", 
               "rotatedotheredgesnewcoordinates"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"anglesotheredges", "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Min", "[", "anglesotheredges", "]"}], ",", 
               RowBox[{
                RowBox[{"Max", "[", "anglesotheredges", "]"}], "-", 
                RowBox[{"2", "Pi"}]}]}], "}"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"smallestangle", "=", 
             RowBox[{"anglesotheredges", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"Ordering", "[", 
                 RowBox[{"Abs", "[", "anglesotheredges", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"newexternaledgeposition", "=", 
             RowBox[{"criticalnode", "+", 
              RowBox[{
               RowBox[{"RotationMatrix", "[", 
                RowBox[{
                 RowBox[{"Power", "[", 
                  RowBox[{"0.95", ",", "iteration"}], "]"}], 
                 "smallestangle"}], "]"}], ".", 
               RowBox[{"(", 
                RowBox[{"inputexternaledge", "-", "criticalnode"}], 
                ")"}]}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
            "inputexternaledge", "\[Rule]", "newexternaledgeposition"}]}]}], 
          "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "This", " ", "function", " ", "tells", " ", "you", " ", "whether", " ",
         "two", " ", "generic", " ", "segments", " ", "cross"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"edgesCrossQ", "=", 
       RowBox[{"Function", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"cutcoords", ",", "edgecoords"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Block", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "matrixtoinvert", ",", "crossdistance", ",", "newcutcoords", ",", 
             "crossq"}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"matrixtoinvert", "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"cutcoords", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "-", 
                  RowBox[{"cutcoords", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"edgecoords", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], "-", 
                  RowBox[{"edgecoords", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"cutcoords", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], "-", 
                  RowBox[{"cutcoords", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"edgecoords", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], "-", 
                  RowBox[{"edgecoords", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], "}"}]}], 
              "}"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Det", "[", "matrixtoinvert", "]"}], "=!=", "0."}], 
              ",", 
              RowBox[{"(*", 
               RowBox[{
               "if", " ", "the", " ", "matrix", " ", "is", " ", 
                "invertible"}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"crossdistance", "=", 
                RowBox[{
                 RowBox[{"Inverse", "[", "matrixtoinvert", "]"}], ".", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"cutcoords", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "-", 
                    RowBox[{"edgecoords", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
                   RowBox[{
                    RowBox[{"cutcoords", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], "-", 
                    RowBox[{"edgecoords", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], "}"}]}]}], ";",
                "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"crossdistance", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "1."}], "||", 
                  RowBox[{
                   RowBox[{"crossdistance", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0."}]}], ",", 
                 RowBox[{"(*", 
                  RowBox[{
                  "we", " ", "are", " ", "touching", " ", "the", " ", 
                   "endpoint", " ", "of", " ", "an", " ", "edge"}], "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{
                  "In", " ", "this", " ", "case", " ", "we", " ", "should", 
                   " ", "slightly", " ", "shift", " ", "the", " ", "cut", " ",
                    "downwards", " ", "and", " ", "so", " ", "that", " ", 
                   "it", " ", 
                   RowBox[{"doesn", "'"}], "t", " ", "go", " ", "right", " ", 
                   "through", " ", "the", " ", "node"}], "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"newcutcoords", "=", 
                   RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "-", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0.05"}], "}"}]}], "&"}], ",", 
                    "cutcoords"}], "]"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"matrixtoinvert", "=", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"newcutcoords", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "-", 
                    RowBox[{"newcutcoords", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"edgecoords", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], "-", 
                    RowBox[{"edgecoords", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"newcutcoords", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], "-", 
                    RowBox[{"newcutcoords", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"edgecoords", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], "-", 
                    RowBox[{"edgecoords", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], "}"}]}], 
                    "}"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Det", "[", "matrixtoinvert", "]"}], "=!=", 
                    "0."}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"crossdistance", "=", 
                    RowBox[{
                    RowBox[{"Inverse", "[", "matrixtoinvert", "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"newcutcoords", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "-", 
                    RowBox[{"edgecoords", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"newcutcoords", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], "-", 
                    RowBox[{"edgecoords", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], "}"}]}]}], 
                    ";"}], "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"crossq", "=", "False"}], ";"}]}], 
                   "\[IndentingNewLine]", "]"}], ";"}]}], 
                "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"crossq", "=", 
                RowBox[{"And", "@@", 
                 RowBox[{"Map", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#", "\[GreaterEqual]", "0"}], ")"}], "&&", 
                    RowBox[{"(", 
                    RowBox[{"#", "\[LessEqual]", "1"}], ")"}]}], "&"}], ",", 
                   "crossdistance"}], "]"}]}]}], ";"}], "\[IndentingNewLine]",
               ",", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"the", " ", "edges", " ", "are", " ", "parallel"}], 
                ",", " ", 
                RowBox[{"and", " ", "cannot", " ", "cross"}]}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"crossq", "=", "False"}], ";"}]}], 
             "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
            "crossq"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"badexternalnodes", "=!=", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{
         RowBox[{
         "Print", "[", "\"\<ROTATION MECHANISM HAS KICKED IN!\>\"", "]"}], 
         ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{"badexternalnodes", "=!=", 
         RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Now", " ", 
          RowBox[{"let", "'"}], "s", " ", "rotate", " ", "until", " ", "all", 
          " ", "badexternalnodes", " ", "nodes", " ", "have", " ", "been", 
          " ", "rotated", " ", "but", " ", "without", " ", "crossing", " ", 
          "any", " ", "other", " ", "edges"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"iterationvector", "=", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"1", ",", 
            RowBox[{"Length", "[", "badexternalnodes", "]"}]}], "]"}]}], ";", 
         RowBox[{"(*", 
          RowBox[{
          "iterationvector", " ", "keeps", " ", "track", " ", "of", " ", 
           "how", " ", "many", " ", "times", " ", 
           RowBox[{"we", "'"}], "ve", " ", "tried", " ", "to", " ", "rotate", 
           " ", "a", " ", "node", " ", "without", " ", "accidentally", " ", 
           "crossing", " ", "already", " ", "existing", " ", "edges"}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"accidentallycrossededges", "=", "True"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"While", "[", 
          RowBox[{
           RowBox[{"Or", "@@", "accidentallycrossededges"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"newexternaledgecoords", "=", 
             RowBox[{"MapThread", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"#1", "/.", "tocriticalnode"}], ",", 
                  RowBox[{
                   RowBox[{"rotateExternalEdge", "[", 
                    RowBox[{"#1", ",", "#2"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], ",", 
               RowBox[{"{", 
                RowBox[{"badexternalnodes", ",", "iterationvector"}], "}"}]}],
               "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"edgeswemightcrossnow", "=", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"DeleteCases", "[", 
                   RowBox[{"edgepos", ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"#", ",", "___"}], "}"}], ",", "___"}], "}"}], 
                    "|", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"___", ",", "#"}], "}"}], ",", "___"}], "}"}]}]}],
                    "]"}], "&"}], ",", 
                 RowBox[{"badexternalnodes", "/.", "tocriticalnode"}]}], 
                "]"}], ",", 
               RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"accidentallycrossededges", "=", 
             RowBox[{"MapThread", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Or", "@@", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"edgesCrossQ", "[", 
                    RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "iii", "]"}], "]"}], ",", "#2"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"iii", ",", 
                    RowBox[{"Length", "[", "#1", "]"}]}], "}"}]}], "]"}]}], 
                "&"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "edgeswemightcrossnow", ",", "newexternaledgecoords"}], 
                "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"iterationvector", "=", 
             RowBox[{
              RowBox[{"iterationvector", "+", "accidentallycrossededges"}], "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"False", "\[Rule]", "0"}], ",", 
                RowBox[{"True", "\[Rule]", "1"}]}], "}"}]}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"newexternalnodes", "=", 
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"rotateExternalEdge", "[", 
              RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{"badexternalnodes", ",", "iterationvector"}], "}"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"verticespos", "=", 
          RowBox[{"verticespos", "/.", "newexternalnodes"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"externalvertices", "=", 
          RowBox[{"spiralInList", "[", 
           RowBox[{"externalvertices", "/.", "newexternalnodes"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"cutcoordinates", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"externalvertices", "[", 
               RowBox[{"[", "iii", "]"}], "]"}], ",", 
              RowBox[{"externalvertices", "[", 
               RowBox[{"[", 
                RowBox[{"iii", "+", "1"}], "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"iii", ",", 
              RowBox[{
               RowBox[{"Length", "[", "externalvertices", "]"}], "-", "1"}]}],
              "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"tocriticalnode", "=", 
          RowBox[{"tocriticalnode", "/.", "newexternalnodes"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"badexternalnodes", "=", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"cutcoordinates", "[", 
              RowBox[{"[", 
               RowBox[{"Sequence", "@@", "#"}], "]"}], "]"}], "&"}], ",", 
            RowBox[{"Position", "[", 
             RowBox[{
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Solve", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "+", 
                    RowBox[{"param", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "\[Equal]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "iii", "]"}], "]"}], "/.", 
                    "tocriticalnode"}], ")"}]}], ",", "param"}], "]"}], "===", 
                    RowBox[{"{", "}"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"iii", ",", "2"}], "}"}]}], "]"}], "&"}], ",", 
                "cutcoordinates"}], "]"}], ",", "False"}], "]"}]}], "]"}]}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "verticespos"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.665140639222619*^9, 3.6651407533458114`*^9}, {
   3.665141221321232*^9, 3.665141252586986*^9}, {3.665141368702683*^9, 
   3.6651414024685745`*^9}, {3.665141439260955*^9, 3.6651414414915123`*^9}, {
   3.6651415022194757`*^9, 3.665141561117752*^9}, {3.6651416158133154`*^9, 
   3.6651416841003847`*^9}, {3.6651417250468855`*^9, 
   3.6651417253437696`*^9}, {3.6651418093015394`*^9, 3.665141852757272*^9}, {
   3.665141901379585*^9, 3.6651419114539633`*^9}, {3.665142013709179*^9, 
   3.6651420477415743`*^9}, {3.66514208519888*^9, 3.6651421090554695`*^9}, 
   3.665142170470294*^9, {3.665142356709807*^9, 3.6651423980415983`*^9}, 
   3.6651426197397156`*^9, {3.6651427522180853`*^9, 3.6651427560176167`*^9}, {
   3.665142802690713*^9, 3.665142804793432*^9}, {3.6651506872807684`*^9, 
   3.6651507499087934`*^9}, {3.6651508639014635`*^9, 3.665150876476062*^9}, {
   3.6651509211635437`*^9, 3.665150921913754*^9}, {3.665153319601572*^9, 
   3.665153371576437*^9}, {3.665153419823266*^9, 3.665153483253207*^9}, {
   3.665153519929203*^9, 3.6651535210164957`*^9}, {3.665153627687049*^9, 
   3.6651536285036583`*^9}, {3.665153663826297*^9, 3.665153702295255*^9}, {
   3.6651537583295527`*^9, 3.6651538251446123`*^9}, {3.665153918593842*^9, 
   3.6651539782058716`*^9}, {3.665154061159587*^9, 3.665154080421815*^9}, 
   3.6651542126274705`*^9, {3.6651544025874543`*^9, 3.665154441771047*^9}, {
   3.6651544761267004`*^9, 3.6651545320912647`*^9}, {3.66515467471987*^9, 
   3.665154682295927*^9}, {3.665154821677783*^9, 3.66515482249032*^9}, {
   3.6651548542076893`*^9, 3.6651548670612793`*^9}, {3.6651549166732965`*^9, 
   3.6651549281201744`*^9}, {3.665154959881012*^9, 3.6651549772791348`*^9}, {
   3.6651551088237247`*^9, 3.6651551293951383`*^9}}],

Cell[BoxData["\<\"ROTATION MECHANISM HAS KICKED IN!\"\>"], "Print",
 CellChangeTimes->{{3.6651540824313407`*^9, 3.6651540911398354`*^9}, 
   3.66515444334925*^9, {3.6651544964827642`*^9, 3.665154504409089*^9}, 
   3.665154539007381*^9, 3.6651546965164146`*^9, 3.665154827829824*^9, 
   3.665154871904496*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"{", 
      RowBox[{"0.`", ",", "0.`"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", 
     RowBox[{"{", 
      RowBox[{"0.`", ",", "4.`"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", 
     RowBox[{"{", 
      RowBox[{"10.`", ",", "2.`"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", 
     RowBox[{"{", 
      RowBox[{"12.`", ",", "4.`"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", 
     RowBox[{"{", 
      RowBox[{"4.`", ",", "4.`"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", 
     RowBox[{"{", 
      RowBox[{"0.`", ",", "12.`"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7", ",", 
     RowBox[{"{", 
      RowBox[{"1.`", ",", "5.`"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", 
     RowBox[{"{", 
      RowBox[{"6.`", ",", "4.`"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"9", ",", 
     RowBox[{"{", 
      RowBox[{"0.`", ",", "16.`"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"10", ",", 
     RowBox[{"{", 
      RowBox[{"17.`", ",", "0.`"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"11", ",", 
     RowBox[{"{", 
      RowBox[{"3.`", ",", "3.`"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"12", ",", 
     RowBox[{"{", 
      RowBox[{"9.`", ",", "1.`"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"13", ",", 
     RowBox[{"{", 
      RowBox[{"0.`", ",", "15.`"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"14", ",", 
     RowBox[{"{", 
      RowBox[{"0.`", ",", "8.`"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"15", ",", 
     RowBox[{"{", 
      RowBox[{"5.`", ",", "7.`"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"16", ",", 
     RowBox[{"{", 
      RowBox[{"1.`", ",", "4.`"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"17", ",", 
     RowBox[{"{", 
      RowBox[{"11.291474462668473`", ",", "4.7056851726861435`"}], "}"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"18", ",", 
     RowBox[{"{", 
      RowBox[{"12.`", ",", "3.`"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.665142170782813*^9, 3.665142247953986*^9, {3.665142357397329*^9, 
   3.665142399378626*^9}, {3.66514261684654*^9, 3.66514262030223*^9}, 
   3.665142805527836*^9, 3.6651505087789893`*^9, {3.665150552865244*^9, 
   3.6651505582900906`*^9}, 3.665150753685793*^9, 3.665150888663272*^9, {
   3.6651509230323935`*^9, 3.6651509321988773`*^9}, 3.665153022562423*^9, 
   3.6651531137621713`*^9, {3.665153217145963*^9, 3.665153235663618*^9}, 
   3.665153372409381*^9, {3.6651534203857813`*^9, 3.665153425532116*^9}, {
   3.66515346125482*^9, 3.665153487396872*^9}, 3.665153521782155*^9, {
   3.665153624138538*^9, 3.6651536358459196`*^9}, 3.665153710050825*^9, 
   3.6651538387715445`*^9, 3.6651539142134867`*^9, {3.665153979127791*^9, 
   3.665153992606331*^9}, {3.665154082384467*^9, 3.6651540911242104`*^9}, 
   3.665154443317998*^9, {3.665154496467136*^9, 3.665154504362213*^9}, 
   3.6651545389917603`*^9, 3.6651546964695363`*^9, 3.665154827814203*^9, 
   3.665154871951378*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6651488406918488`*^9, 3.6651488556882825`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"PlanarGraphQ", "[", "graph", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "We", " ", "shall", " ", "begin", " ", "by", " ", "drawing", " ", "out", 
      " ", "the", " ", "graph", " ", "such", " ", "that", " ", "no", " ", 
      "edges", " ", 
      RowBox[{"cross", ".", " ", "In"}], " ", "so", " ", "doing", " ", 
      RowBox[{"we", "'"}], "ll", " ", "be", " ", "able", " ", "to", " ", 
      "extract", " ", "the", " ", "vertex", " ", "coordinates", " ", "and", 
      " ", "edge", " ", "positions", " ", "of", " ", "this", " ", 
      "embedding"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"planargraph", "=", 
      RowBox[{"Graph", "[", 
       RowBox[{"graph", ",", 
        RowBox[{"GraphLayout", "\[Rule]", "\"\<PlanarEmbedding\>\""}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"verticespos", "=", 
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"#1", ",", "#2"}], "}"}], "&"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", 
            RowBox[{"GraphEmbedding", "[", "planargraph", "]"}], "]"}], "]"}],
           ",", 
          RowBox[{"GraphEmbedding", "[", "planargraph", "]"}]}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"edgepos", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"verticespos", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", "2"}], "]"}], "]"}], 
             ",", 
             RowBox[{"verticespos", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", "2"}], "]"}], "]"}]}], 
            "}"}], ",", "#"}], "}"}], "&"}], ",", 
        RowBox[{"EdgeList", "[", "planargraph", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"edgepos", "=", 
      RowBox[{"DeleteDuplicates", "[", "edgepos", "]"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{"in", " ", "case", " ", "there", " ", "are", " ", "bubbles"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Now", " ", "we", " ", "have", " ", "the", " ", "vertices", " ", "and", 
       " ", "edges", " ", "for", " ", "an", " ", "embedding", " ", "with", 
       " ", "no", " ", "edge", " ", "crossings"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Each", " ", "external", " ", "vertex", " ", "will", " ", "be", " ", 
       "seen", " ", "as", " ", "having", " ", "its", " ", "own", " ", "tiny", 
       " ", "boundary", " ", "attached", " ", "to", " ", "it"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"boundaries", "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{"Flatten", "[", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{"bottomleft", ",", 
             RowBox[{"Transpose", "[", "topright", "]"}]}], "]"}], ",", "0", 
           ",", 
           RowBox[{"{", "2", "}"}]}], "]"}], "]"}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Now", " ", 
        RowBox[{"we", "'"}], "ll", " ", "construct", " ", "the", " ", 
        RowBox[{"cuts", ":", " ", 
         RowBox[{
         "they", " ", "will", " ", "run", " ", "directly", " ", "between", 
          " ", "the", " ", "external", " ", "vertices"}]}]}], ",", " ", 
       RowBox[{
       "since", " ", "the", " ", "boundaries", " ", "are", " ", "so", " ", 
        "tiny"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"externalnodenumbers", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{"Length", "[", "bottomleft", "]"}], "]"}], "+", 
         RowBox[{"Length", "[", "topleft", "]"}]}], ",", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{
           RowBox[{"Dimensions", "[", "topright", "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}], "+", 
         RowBox[{"Total", "[", 
          RowBox[{"Dimensions", "[", "topleft", "]"}], "]"}], "+", 
         RowBox[{"Length", "[", "bottomleft", "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"verticestocoords", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Rule", "@@", "#"}], "&"}], ",", "verticespos"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"externalvertices", "=", 
      RowBox[{"externalnodenumbers", "/.", "verticestocoords"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"Now", " ", 
         RowBox[{"we", "'"}], "ll", " ", "need", " ", "to", " ", "make", " ", 
         "a", " ", "sequence", " ", "of", " ", "boundaries", " ", "connected",
          " ", "by", " ", 
         RowBox[{"cuts", ".", " ", 
          RowBox[{"We", "'"}]}], "ll", " ", "start", " ", "with", " ", "the", 
         " ", "external", " ", "node", " ", "with", " ", "the", " ", 
         "highest", " ", "y"}], "-", "coordinate"}], ",", " ", 
       RowBox[{
       "and", " ", "proceed", " ", "along", " ", "external", " ", "nodes", 
        " ", "as", " ", "we", " ", "spiral", " ", "in", " ", "to", " ", "the",
         " ", 
        RowBox[{"middle", ".", " ", "This"}], " ", "ensures", " ", "that", 
        " ", "the", " ", "cuts", " ", "never", " ", "cross", " ", "each", " ",
         "other"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Before", " ", "we", " ", "start", " ", 
       RowBox[{"we", "'"}], "ll", " ", "make", " ", "a", " ", "rule", " ", 
       "that", " ", "translates", " ", "node", " ", "numbers", " ", "into", 
       " ", "edge", " ", 
       RowBox[{"labels", ".", " ", "This"}], " ", "will", " ", "be", " ", 
       "useful", " ", "to", " ", "us", " ", "at", " ", "the", " ", "very", 
       " ", "end"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"nodenumberstoedges", "=", 
      RowBox[{"MapThread", "[", 
       RowBox[{"Rule", ",", 
        RowBox[{"{", 
         RowBox[{"externalnodenumbers", ",", 
          RowBox[{"Flatten", "[", "boundaries", "]"}]}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "This", " ", "function", " ", "takes", " ", "a", " ", "list", " ", 
        "of", " ", "vertices", " ", "and", " ", "orders", " ", "them", " ", 
        "according", " ", "to", " ", "the", " ", "spiralling"}], "-", 
       RowBox[{"in", " ", "order"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"spiralInList", "=", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", "vertexlist", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Block", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "remainingvertices", ",", "nextnode", ",", "finalvertexlist", ",", 
            "polardistances"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"remainingvertices", "=", "vertexlist"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{
             "The", " ", "first", " ", "node", " ", "is", " ", "the", " ", 
              "one", " ", "with", " ", "the", " ", "largest", " ", "y"}], "-",
              "coordinate"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"nextnode", "=", 
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{"remainingvertices", ",", 
               RowBox[{"{", 
                RowBox[{"_", ",", 
                 RowBox[{"Max", "[", 
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "&"}], ",", 
                    "remainingvertices"}], "]"}], "]"}]}], "}"}]}], "]"}], 
             "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"finalvertexlist", "=", 
            RowBox[{"{", "nextnode", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"remainingvertices", "=", 
            RowBox[{"DeleteCases", "[", 
             RowBox[{"remainingvertices", ",", "nextnode"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"While", "[", 
            RowBox[{
             RowBox[{"remainingvertices", "=!=", 
              RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"polardistances", "=", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"2", "Pi"}]}], "]"}]}], "}"}], "&"}], ",", 
                 RowBox[{"Map", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"ToPolarCoordinates", "[", 
                    RowBox[{"#", "-", "nextnode"}], "]"}], "&"}], ",", 
                   "remainingvertices"}], "]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
               "The", " ", "next", " ", "node", " ", "is", " ", "the", " ", 
                "first", " ", "one", " ", "reached", " ", "going", " ", 
                "radially", " ", "and", " ", "clockwise", " ", "from", " ", 
                "the", " ", "current", " ", "node"}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"nextnode", "=", 
               RowBox[{"Cases", "[", 
                RowBox[{"polardistances", ",", 
                 RowBox[{"{", 
                  RowBox[{"_", ",", 
                   RowBox[{"Max", "[", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "&"}], ",", 
                    "polardistances"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{
                "If", " ", "there", " ", "are", " ", "multiple", " ", "ones", 
                 " ", "with", " ", "the", " ", "same", " ", "angle"}], ",", 
                " ", 
                RowBox[{"pick", " ", "the", " ", "nearest", " ", "one"}]}], 
               "*)"}], "\[IndentingNewLine]", 
              RowBox[{"nextnode", "=", 
               RowBox[{
                RowBox[{"Cases", "[", 
                 RowBox[{"nextnode", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Min", "[", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", "nextnode"}], 
                    "]"}], "]"}], ",", "_"}], "}"}]}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"nextnode", "=", 
               RowBox[{"remainingvertices", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"Position", "[", 
                   RowBox[{"polardistances", ",", "nextnode"}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"finalvertexlist", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"finalvertexlist", ",", "nextnode"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"remainingvertices", "=", 
               RowBox[{"DeleteCases", "[", 
                RowBox[{"remainingvertices", ",", "nextnode"}], "]"}]}], 
              ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", "finalvertexlist"}]}], "]"}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Now", " ", 
       RowBox[{"we", "'"}], "ll", " ", "order", " ", "our", " ", "external", 
       " ", "vertices", " ", "and", " ", "our", " ", "boundaries", " ", "in", 
       " ", "this", " ", "new", " ", "order"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"externalvertices", "=", 
      RowBox[{"spiralInList", "[", "externalvertices", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"boundaries", "=", 
      RowBox[{
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", "#", "}"}], "&"}], ",", 
         RowBox[{"externalvertices", "/.", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "\[Rule]", 
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "&"}], ",", 
            "verticestocoords"}], "]"}]}]}], "]"}], "/.", 
       "nodenumberstoedges"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"We", " ", "may", " ", "now", " ", "form", " ", "the", " ", 
       RowBox[{"cuts", ":", " ", 
        RowBox[{"they", " ", "are", " ", 
         RowBox[{"(", 
          RowBox[{"n", "-", "1"}], ")"}], " ", "sequential", " ", "pairs", 
         " ", "of", " ", "externalvertices"}]}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"cutcoordinates", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"externalvertices", "[", 
           RowBox[{"[", "iii", "]"}], "]"}], ",", 
          RowBox[{"externalvertices", "[", 
           RowBox[{"[", 
            RowBox[{"iii", "+", "1"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"iii", ",", 
          RowBox[{
           RowBox[{"Length", "[", "externalvertices", "]"}], "-", "1"}]}], 
         "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"For", " ", "convenience", " ", 
       RowBox[{"we", "'"}], "ll", " ", "also", " ", "append", " ", "to", " ", 
       "each", " ", "of", " ", "these", " ", "pairs", " ", "the", " ", "two", 
       " ", "node", " ", "numbers", " ", "that", " ", "they", " ", 
       "represent"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"cutcoordinatesandnodes", "=", 
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"#1", ",", "#2"}], "}"}], "&"}], ",", 
        RowBox[{"{", 
         RowBox[{"cutcoordinates", ",", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Alternatives", "@@", "#"}], "&"}], ",", 
            RowBox[{"cutcoordinates", "/.", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "\[Rule]", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "&"}], ",", 
               "verticestocoords"}], "]"}]}]}], "]"}]}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Now", " ", "we", " ", "need", " ", "to", " ", "see", " ", "which", " ",
        "edges", " ", "are", " ", "crossed", " ", "by", " ", "each", " ", 
       "cut", " ", 
       RowBox[{"(", 
        RowBox[{
        "remember", " ", "that", " ", "in", " ", "each", " ", "cut", " ", 
         "we", " ", 
         RowBox[{"don", "'"}], "t", " ", "want", " ", "to", " ", "consider", 
         " ", "cutting", " ", "edges", " ", "that", " ", "pass", " ", 
         "through", " ", "the", " ", "two", " ", "external", " ", "nodes"}], 
        ")"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "This", " ", "function", " ", "tells", " ", "you", " ", "whether", " ", 
       "two", " ", "generic", " ", "segments", " ", "cross"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"edgesCrossQ", "=", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"cutcoords", ",", "edgecoords"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Block", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "matrixtoinvert", ",", "crossdistance", ",", "newcutcoords", ",", 
            "crossq"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"matrixtoinvert", "=", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"cutcoords", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "1"}], "]"}], "]"}], "-", 
                 RowBox[{"cutcoords", "[", 
                  RowBox[{"[", 
                   RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{"edgecoords", "[", 
                  RowBox[{"[", 
                   RowBox[{"2", ",", "1"}], "]"}], "]"}], "-", 
                 RowBox[{"edgecoords", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"cutcoords", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "2"}], "]"}], "]"}], "-", 
                 RowBox[{"cutcoords", "[", 
                  RowBox[{"[", 
                   RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{"edgecoords", "[", 
                  RowBox[{"[", 
                   RowBox[{"2", ",", "2"}], "]"}], "]"}], "-", 
                 RowBox[{"edgecoords", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], "}"}]}], 
             "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Det", "[", "matrixtoinvert", "]"}], "=!=", "0."}], ",", 
             RowBox[{"(*", 
              RowBox[{
              "if", " ", "the", " ", "matrix", " ", "is", " ", "invertible"}],
               "*)"}], "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"crossdistance", "=", 
               RowBox[{
                RowBox[{"Inverse", "[", "matrixtoinvert", "]"}], ".", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"cutcoords", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "-", 
                   RowBox[{"edgecoords", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"cutcoords", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], "-", 
                   RowBox[{"edgecoords", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], "}"}]}]}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"crossdistance", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "1."}], "||", 
                 RowBox[{
                  RowBox[{"crossdistance", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0."}]}], ",", 
                RowBox[{"(*", 
                 RowBox[{
                 "we", " ", "are", " ", "touching", " ", "the", " ", 
                  "endpoint", " ", "of", " ", "an", " ", "edge"}], "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                 "In", " ", "this", " ", "case", " ", "we", " ", "should", 
                  " ", "slightly", " ", "shift", " ", "the", " ", "cut", " ", 
                  "downwards", " ", "and", " ", "so", " ", "that", " ", "it", 
                  " ", 
                  RowBox[{"doesn", "'"}], "t", " ", "go", " ", "right", " ", 
                  "through", " ", "the", " ", "node"}], "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"newcutcoords", "=", 
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", "-", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0.05"}], "}"}]}], "&"}], ",", 
                    "cutcoords"}], "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"matrixtoinvert", "=", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"newcutcoords", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "-", 
                    RowBox[{"newcutcoords", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"edgecoords", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], "-", 
                    RowBox[{"edgecoords", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"newcutcoords", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], "-", 
                    RowBox[{"newcutcoords", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"edgecoords", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}], "-", 
                    RowBox[{"edgecoords", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], "}"}]}], 
                   "}"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Det", "[", "matrixtoinvert", "]"}], "=!=", 
                    "0."}], ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"crossdistance", "=", 
                    RowBox[{
                    RowBox[{"Inverse", "[", "matrixtoinvert", "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"newcutcoords", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "-", 
                    RowBox[{"edgecoords", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"newcutcoords", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], "-", 
                    RowBox[{"edgecoords", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], "}"}]}]}], 
                    ";"}], "\[IndentingNewLine]", ",", 
                   RowBox[{
                    RowBox[{"crossq", "=", "False"}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"crossq", "=", 
               RowBox[{"And", "@@", 
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#", "\[GreaterEqual]", "0"}], ")"}], "&&", 
                    RowBox[{"(", 
                    RowBox[{"#", "\[LessEqual]", "1"}], ")"}]}], "&"}], ",", 
                  "crossdistance"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
             ",", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"the", " ", "edges", " ", "are", " ", "parallel"}], 
               ",", " ", 
               RowBox[{"and", " ", "cannot", " ", "cross"}]}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"crossq", "=", "False"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           "crossq"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "This", " ", "function", " ", "takes", " ", "a", " ", "cut", " ", "and",
        " ", "tells", " ", "you", " ", "which", " ", "UndirectedEdges", " ", 
       "in", " ", "the", " ", "graph", " ", "it", " ", "crosses"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"crossedEdges", "=", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", "cutinfo", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "&"}], ",", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{"edgepos", ",", 
              RowBox[{"zz_", "/;", 
               RowBox[{"edgesCrossQ", "[", 
                RowBox[{
                 RowBox[{"cutinfo", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"zz", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "]"}], ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"___", ",", 
               RowBox[{"UndirectedEdge", "[", 
                RowBox[{"_", ",", 
                 RowBox[{"cutinfo", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "}"}], "|", 
             RowBox[{"{", 
              RowBox[{"___", ",", 
               RowBox[{"UndirectedEdge", "[", 
                RowBox[{
                 RowBox[{"cutinfo", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", "_"}], "]"}]}], 
              "}"}]}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Now", " ", 
       RowBox[{"we", "'"}], "re", " ", "able", " ", "to", " ", "determine", 
       " ", "which", " ", "edges", " ", "are", " ", "crossed", " ", "by", " ",
        "each", " ", "cut"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"cutsedgecrossings", "=", 
      RowBox[{"Map", "[", 
       RowBox[{"crossedEdges", ",", "cutcoordinatesandnodes"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "In", " ", "order", " ", "to", " ", "maintain", " ", "the", " ", 
        "ordering", " ", "of", " ", "nodes", " ", "we", " ", "determined", 
        " ", "with", " ", "our", " ", "cuts"}], ",", " ", 
       RowBox[{
       "sometimes", " ", "we", " ", "need", " ", "an", " ", "external", " ", 
        "edge", " ", "to", " ", "be", " ", "crossed", " ", "an", " ", 
        "additional", " ", "time", " ", "by", " ", "one", " ", "of", " ", 
        "the", " ", "two", " ", "cuts", " ", "in", " ", "order", " ", "to", 
        " ", "keep", " ", "its", " ", "position", " ", "in", " ", "the", " ", 
        "order", " ", "of", " ", "external", " ", "nodes"}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "This", " ", "function", " ", "takes", " ", "a", " ", "pair", " ", "of",
        " ", "cuts", " ", "and", " ", "returns", " ", "a", " ", "list", " ", 
       "containing", " ", "the", " ", "additional", " ", "edges", " ", "that",
        " ", "get", " ", 
       RowBox[{"crossed", ".", " ", "We"}], " ", "should", " ", "assume", " ",
        "that", " ", "it", " ", "is", " ", "the", " ", "first", " ", "of", 
       " ", "the", " ", "pair", " ", "of", " ", "cuts", " ", "that", " ", 
       "crosses", " ", "the", " ", "edge"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"extraCutEdges", "=", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", "pairofcutscoordinates", "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Block", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "pairofcuts", ",", "externaledgename", ",", "externaledge", ",", 
            "cutangles", ",", "edgeangle", ",", "rotatedcutangles", ",", 
            "rotatededgeangle", ",", "return"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"pairofcuts", "=", "pairofcutscoordinates"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"externaledgename", "=", 
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{"edgepos", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"___", ",", 
                   RowBox[{"pairofcuts", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", "___"}], 
                  "}"}], ",", "___"}], "}"}]}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"externaledge", "=", 
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{"edgepos", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"___", ",", 
                   RowBox[{"pairofcuts", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", "___"}], 
                  "}"}], ",", "___"}], "}"}]}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"externaledge", "=", 
            RowBox[{"DeleteCases", "[", 
             RowBox[{
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "-", 
                  RowBox[{"pairofcuts", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "&"}], ",", 
                "externaledge"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"0.", ",", "0."}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"pairofcuts", "=", 
            RowBox[{"DeleteCases", "[", 
             RowBox[{
              RowBox[{"Sequence", "@@@", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "-", 
                   RowBox[{"pairofcuts", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "&"}], ",", 
                 "pairofcuts", ",", 
                 RowBox[{"{", "2", "}"}]}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"0.", ",", "0."}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"cutangles", "=", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                 RowBox[{"2", "Pi"}]}], "]"}], "&"}], ",", 
              RowBox[{"Map", "[", 
               RowBox[{"ToPolarCoordinates", ",", "pairofcuts"}], "]"}]}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"edgeangle", "=", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Mod", "[", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                 RowBox[{"2", "Pi"}]}], "]"}], "&"}], ",", 
              RowBox[{"Map", "[", 
               RowBox[{"ToPolarCoordinates", ",", "externaledge"}], "]"}]}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"rotatedcutangles", "=", 
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{"cutangles", "-", 
               RowBox[{"cutangles", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ",", 
              RowBox[{"2", "Pi"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"rotatededgeangle", "=", 
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{"edgeangle", "-", 
               RowBox[{"cutangles", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ",", 
              RowBox[{"2", "Pi"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"rotatededgeangle", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "<", 
              RowBox[{"rotatedcutangles", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"return", "=", 
               RowBox[{"{", "externaledgename", "}"}]}], ";"}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{
              RowBox[{"return", "=", 
               RowBox[{"{", "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
           ";", "\[IndentingNewLine]", "return"}]}], "]"}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"For", " ", "each", " ", "pair", " ", "of", " ", "cuts"}], ",",
        " ", 
       RowBox[{
       "we", " ", "now", " ", "get", " ", "the", " ", "additional", " ", 
        "edges", " ", "that", " ", "get", " ", "crossed"}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"extracrossededges", "=", 
      RowBox[{"Map", "[", 
       RowBox[{"extraCutEdges", ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"cutcoordinates", "[", 
             RowBox[{"[", "iii", "]"}], "]"}], ",", 
            RowBox[{"cutcoordinates", "[", 
             RowBox[{"[", 
              RowBox[{"iii", "+", "1"}], "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"iii", ",", 
            RowBox[{
             RowBox[{"Length", "[", "cutcoordinates", "]"}], "-", "1"}]}], 
           "}"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"These", " ", "are", " ", "added", " ", "to", " ", 
        RowBox[{"cutsedgecrossings", ".", " ", "Since"}], " ", "the", " ", 
        "last", " ", "cut", " ", "never", " ", "crosses", " ", "an", " ", 
        "edge"}], ",", " ", 
       RowBox[{"add", " ", "an", " ", "empty", " ", "list"}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"extracrossededges", "=", 
      RowBox[{"Append", "[", 
       RowBox[{"extracrossededges", ",", 
        RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"cutsedgecrossings", "=", 
      RowBox[{"Map", "[", 
       RowBox[{"DeleteDuplicates", ",", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Join", ",", 
          RowBox[{"{", 
           RowBox[{"cutsedgecrossings", ",", "extracrossededges"}], "}"}]}], 
         "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "We", " ", "need", " ", "to", " ", "translate", " ", "this", " ", 
       "into", " ", "actual", " ", "edge", " ", "variable", " ", "names"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"kasteleyn", "=", 
      RowBox[{"joinupKasteleyn", "[", 
       RowBox[{
       "topleft", ",", "topright", ",", "bottomleft", ",", "bottomright"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"bigkasteleyn", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"kasteleyn", ",", 
        RowBox[{"Transpose", "[", "kasteleyn", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nameUndirectedEdges", "=", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", "undirectededge", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"undirectededge", "\[Rule]", 
         RowBox[{"Sequence", "@@", 
          RowBox[{"Intersection", "@@", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Variables", "[", 
               RowBox[{"bigkasteleyn", "[", 
                RowBox[{"[", "#", "]"}], "]"}], "]"}], "&"}], ",", 
             RowBox[{"List", "@@", "undirectededge"}]}], "]"}]}]}]}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"edgenamerule", "=", 
      RowBox[{"Map", "[", 
       RowBox[{"nameUndirectedEdges", ",", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"EdgeList", "[", "graph", "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"cutsedgecrossings", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "\[Rule]", 
          RowBox[{"-", "#"}]}], "&"}], ",", 
        RowBox[{"cutsedgecrossings", "/.", "edgenamerule"}], ",", 
        RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"boundarypaircuts", "=", 
      RowBox[{"MapThread", "[", 
       RowBox[{"Rule", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"boundaries", "[", 
               RowBox[{"[", "iii", "]"}], "]"}], ",", 
              RowBox[{"boundaries", "[", 
               RowBox[{"[", 
                RowBox[{"iii", "+", "1"}], "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"iii", ",", 
              RowBox[{
               RowBox[{"Length", "[", "boundaries", "]"}], "-", "1"}]}], 
             "}"}]}], "]"}], ",", "cutsedgecrossings"}], "}"}]}], "]"}]}], 
     ";"}], "\[IndentingNewLine]", ",", 
    RowBox[{
     RowBox[{
     "Print", "[", 
      "\"\<It must be possible to embed the graph on genus zero without any \
edges crossing.\>\"", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"boundaries", "=", "Null"}], ";", "\[IndentingNewLine]", 
     RowBox[{"boundarypaircuts", "=", "Null"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{"boundaries", ",", "boundarypaircuts"}], "}"}]}], "Input",
 CellChangeTimes->{{3.665133720460937*^9, 3.6651337210078325`*^9}, 
   3.665139042020548*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "This", " ", "is", " ", "to", " ", "fix", " ", "the", " ", 
   "getGrassmannian", " ", "function"}], "*)"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.6648013399262695`*^9}]
},
Evaluator->"Local2",
WindowSize->{1366, 685},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"10.2 for Microsoft Windows (64-bit) (July 7, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 2566, 58, 316, "Input"],
Cell[3149, 82, 41700, 867, 275, 21459, 536, "CachedBoxData", "BoxData", \
"Output"]
}, Open  ]],
Cell[44864, 952, 218, 5, 31, "Input"],
Cell[CellGroupData[{
Cell[45107, 961, 5929, 150, 432, "Input"],
Cell[51039, 1113, 465, 11, 23, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51541, 1129, 206, 3, 31, "Input"],
Cell[51750, 1134, 14223, 412, 107, "Output"]
}, Open  ]],
Cell[65988, 1549, 94, 1, 31, "Input"],
Cell[66085, 1552, 244, 5, 31, "Input"],
Cell[66332, 1559, 518, 15, 72, "Input"],
Cell[CellGroupData[{
Cell[66875, 1578, 179, 4, 31, "Input"],
Cell[67057, 1584, 4185, 133, 72, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[71279, 1722, 20494, 503, 1252, "Input"],
Cell[91776, 2227, 1309, 37, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[93122, 2269, 951, 32, 31, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[94076, 2303, 14907, 359, 872, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]],
Cell[CellGroupData[{
Cell[109020, 2667, 28378, 635, 1406, "Input"],
Cell[137401, 3304, 308, 4, 23, "Print"],
Cell[137712, 3310, 3192, 90, 52, "Output"]
}, Open  ]],
Cell[140919, 3403, 96, 1, 31, "Input"],
Cell[141018, 3406, 39225, 906, 2352, "Input"],
Cell[180246, 4314, 258, 6, 31, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}
]
*)

(* End of internal cache information *)
