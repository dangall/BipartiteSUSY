(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    998593,      23810]
NotebookOptionsPosition[    994256,      23687]
NotebookOutlinePosition[    994597,      23702]
CellTagsIndexPosition[    994554,      23699]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "bipartiteSUSY.m"}]}], "Input",
 CellChangeTimes->{{3.6616922986967053`*^9, 3.661692334211833*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"This", " ", "is", " ", "a", " ", "planar", " ", "example"}], 
  "*)"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.6617747389072857`*^9, {3.6617752199012136`*^9, 3.6617752384313593`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"formatrule", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["XX_", 
      RowBox[{"z1_", ",", "z2_"}]], "\[Rule]", 
     RowBox[{"XX", "[", 
      RowBox[{"z1", ",", "z2"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aa", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"1", ",", "7"}]], 
        RowBox[{"(*", 
         RowBox[{"+", 
          SubscriptBox["X", 
           RowBox[{"7", ",", "7"}]]}], "*)"}], ",", 
        SubscriptBox["X", 
         RowBox[{"2", ",", "1"}]], 
        RowBox[{"(*", 
         RowBox[{"+", 
          SubscriptBox["X", 
           RowBox[{"2", ",", "100"}]]}], "*)"}], ",", 
        SubscriptBox["X", 
         RowBox[{"3", ",", "2"}]], 
        RowBox[{"(*", 
         RowBox[{"+", 
          SubscriptBox["X", 
           RowBox[{"2", ",", "1"}]]}], "*)"}], 
        RowBox[{"(*", 
         RowBox[{"+", 
          SubscriptBox["Z", "30"]}], "*)"}], ",", 
        SubscriptBox["X", 
         RowBox[{"8", ",", "3"}]], 
        RowBox[{"(*", 
         RowBox[{"+", 
          SubscriptBox["X", 
           RowBox[{"8", ",", "3"}]]}], "*)"}], ",", "0", ",", "0", ",", "0"}],
        "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"13", ",", "1"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"1", ",", "4"}]], ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"4", ",", "13"}]], ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        SubscriptBox["X", 
         RowBox[{"4", ",", "2"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"2", ",", "5"}]], ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"5", ",", "4"}]], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"5", ",", "3"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"3", ",", "6"}]], ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"6", ",", "5"}]]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"12", ",", "4"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"4", ",", "11"}]], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"11", ",", "5"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"5", ",", "10"}]]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"6", ",", "9"}]], ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"10", ",", "6"}]]}], "}"}]}], "}"}], "/.", "formatrule"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bb", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"7", ",", "8"}]]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"11", ",", "12"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        SubscriptBox["X", 
         RowBox[{"10", ",", "11"}]], ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"9", ",", "10"}]], ",", "0"}], "}"}]}], "}"}], "/.", 
    "formatrule"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"7", ",", "13"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
        ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"9", ",", "8"}]], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"13", ",", "12"}]], ",", "0", ",", "0"}], "}"}]}], "}"}], "/.",
     "formatrule"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dd", "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], "/.", 
     "formatrule"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"topleft", "=", "aa"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"topright", "=", "bb"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bottomleft", "=", "cc"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bottomright", "=", "dd"}], ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.661768152279539*^9, 3.6617682070619636`*^9}, {
   3.661774734306241*^9, 3.6617747389077854`*^9}, {3.6617752199012136`*^9, 
   3.6617752384313593`*^9}, {3.6617792078461504`*^9, 3.6617792164162493`*^9}, 
   3.6618480142415557`*^9, 3.661848446017182*^9, {3.6618552249200983`*^9, 
   3.6618552265381966`*^9}, {3.661855261051271*^9, 3.6618553195379095`*^9}, {
   3.6618553565402327`*^9, 3.661855403134297*^9}, {3.66185591508606*^9, 
   3.6618559194691763`*^9}, 3.6618559759441557`*^9, 3.6618563248825703`*^9, 
   3.6618564442265024`*^9, {3.661856630895452*^9, 3.66185665717612*^9}, 
   3.6618567504434385`*^9, 3.661857125236326*^9, 3.661857243437956*^9, {
   3.6618573840060997`*^9, 3.6618573897571115`*^9}, {3.6618583582979946`*^9, 
   3.6618583709773593`*^9}, {3.661859440960431*^9, 3.661859442023737*^9}, {
   3.6618618165453277`*^9, 3.661861856700989*^9}, {3.6618619749549227`*^9, 
   3.6618619751086197`*^9}, {3.6618623835768223`*^9, 3.661862409858626*^9}, {
   3.6618625640333376`*^9, 3.6618625656505203`*^9}, {3.6618626495218782`*^9, 
   3.661862650808232*^9}, {3.6618629823303156`*^9, 3.6618630223085847`*^9}, {
   3.661863274557538*^9, 3.661863340611631*^9}, {3.6618658125815916`*^9, 
   3.661865928625715*^9}, 3.661866082529149*^9, {3.662099231769846*^9, 
   3.6620992328449216`*^9}, 3.662114969467435*^9, {3.6621150283796463`*^9, 
   3.662115043976282*^9}, 3.662115098818657*^9, 3.6621235783901234`*^9, {
   3.6621237205097446`*^9, 3.6621238138351326`*^9}, {3.6622035277936273`*^9, 
   3.6622036286946964`*^9}, 3.662275696648489*^9, 3.6622757658807836`*^9, {
   3.6622768051131735`*^9, 3.662276812093757*^9}, {3.6622777279171143`*^9, 
   3.6622777364208946`*^9}, 3.6622817983167496`*^9, 3.662285014252096*^9, 
   3.662387804407296*^9, 3.6623878535149612`*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"This", " ", "is", " ", "a", " ", "non"}], "-", 
   RowBox[{
   "planar", " ", "example", " ", "with", " ", "secret", " ", "poles"}]}], 
  "*)"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 CellChangeTimes->{
  3.6617747675998573`*^9, {3.6617752199012136`*^9, 3.6617752548205633`*^9}, {
   3.6617753549957905`*^9, 3.661775364335918*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"formatrule", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["XX_", 
      RowBox[{"z1_", ",", "z2_"}]], "\[Rule]", 
     RowBox[{"XX", "[", 
      RowBox[{"z1", ",", "z2"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aa", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"8", ",", "1"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"1", ",", "7"}]], 
        RowBox[{"(*", 
         RowBox[{"+", 
          SubscriptBox["X", 
           RowBox[{"1", ",", "700"}]]}], "*)"}], ",", "0", ",", "0", ",", "0",
         ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        SubscriptBox["X", 
         RowBox[{"2", ",", "1"}]], 
        RowBox[{"(*", 
         RowBox[{"+", 
          SubscriptBox["X", 
           RowBox[{"2", ",", "100"}]]}], "*)"}], ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"4", ",", "2"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"1", ",", "4"}]]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"1", ",", "9"}]], ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"9", ",", "3"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"3", ",", "6"}]], ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"6", ",", "1"}]]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        SubscriptBox["X", 
         RowBox[{"7", ",", "2"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"3", ",", "7"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"2", ",", "3"}]], ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"6", ",", "2"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"2", ",", "5"}]], ",", "0"}], "}"}]}], "}"}], "/.", 
    "formatrule"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bb", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"7", ",", "8"}]], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        SubscriptBox["X", 
         RowBox[{"5", ",", "6"}]]}], "}"}]}], "}"}], "/.", "formatrule"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"9", ",", "8"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
        ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"7", ",", "9"}]], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"4", ",", "6"}]]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"5", ",", "4"}]], ",", "0"}], "}"}]}], "}"}], "/.", 
    "formatrule"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dd", "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "}"}], "/.", "formatrule"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"topleft", "=", "aa"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"topright", "=", "bb"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bottomleft", "=", "cc"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bottomright", "=", "dd"}], ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 CellChangeTimes->{{3.661759206605352*^9, 3.661759358643527*^9}, {
   3.661759930919339*^9, 3.6617599612497854`*^9}, {3.6617747579587717`*^9, 
   3.6617747675998573`*^9}, 3.6617752548205633`*^9, {3.661775354996293*^9, 
   3.66177536433642*^9}, 3.6618475958631124`*^9, {3.66184780359737*^9, 
   3.661847859584677*^9}, {3.66209923804358*^9, 3.6620992382935896`*^9}, {
   3.6622777440979004`*^9, 3.6622777650781717`*^9}, {3.662277846139641*^9, 
   3.662277861116992*^9}, {3.662285045911174*^9, 3.6622850590586057`*^9}, 
   3.662288387431682*^9, {3.662288683649874*^9, 3.6622886921119223`*^9}, {
   3.6622898064182396`*^9, 3.66228982513911*^9}, {3.662290916561075*^9, 
   3.6622909190055537`*^9}, 3.662293117676606*^9, 3.662293242519805*^9, 
   3.66229335572449*^9, 3.6622934346331215`*^9, {3.6623014874567614`*^9, 
   3.662301512775009*^9}, {3.6623015510421534`*^9, 3.662301555246936*^9}, {
   3.662301595399434*^9, 3.662301599011793*^9}, 3.6623649216569767`*^9, 
   3.6623651815366383`*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"This", " ", "is", " ", "another", " ", "non"}], "-", 
   RowBox[{
   "planar", " ", "example", " ", "with", " ", "secret", " ", "poles"}]}], 
  "*)"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 CellChangeTimes->{{3.6617751562774353`*^9, 3.6617751755016255`*^9}, {
  3.661775354996293*^9, 3.661775376089506*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"formatrule", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["XX_", 
      RowBox[{"z1_", ",", "z2_"}]], "\[Rule]", 
     RowBox[{"XX", "[", 
      RowBox[{"z1", ",", "z2"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aa", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"3", ",", "9"}]], ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"6", ",", "3"}]], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"8", ",", "3"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"2", ",", "8"}]], ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"3", ",", "2"}]]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        SubscriptBox["X", 
         RowBox[{"7", ",", "1"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"1", ",", "6"}]], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        SubscriptBox["X", 
         RowBox[{"1", ",", "2"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"5", ",", "1"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"2", ",", "4"}]]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"3", ",", "5"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"4", ",", "3"}]]}], "}"}]}], "}"}], "/.", "formatrule"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bb", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"9", ",", "6"}]], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        SubscriptBox["X", 
         RowBox[{"6", ",", "7"}]], ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"4", ",", "5"}]]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"5", ",", "4"}]], ",", "0"}], "}"}]}], "}"}], "/.", 
    "formatrule"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"9", ",", "8"}]], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        SubscriptBox["X", 
         RowBox[{"8", ",", "7"}]], ",", "0", ",", "0"}], "}"}]}], "}"}], "/.",
     "formatrule"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dd", "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], "/.", 
     "formatrule"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"topleft", "=", "aa"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"topright", "=", "bb"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bottomleft", "=", "cc"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bottomright", "=", "dd"}], ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 CellChangeTimes->{{3.661775166051606*^9, 3.6617751755016255`*^9}, {
  3.661775354996293*^9, 3.661775376089506*^9}, {3.661847862533332*^9, 
  3.6618478943936143`*^9}, {3.6620992492607956`*^9, 3.662099249526434*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"This", " ", "is", " ", "a", " ", "non"}], "-", 
   RowBox[{
   "planar", " ", "example", " ", "without", " ", "secret", " ", "poles"}]}], 
  "*)"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6617750063834705`*^9, 3.6617750065439873`*^9}, 
   3.6617750660711355`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"aa", ",", "bb", ",", "cc", ",", "dd"}], "}"}], "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Z", "10"], ",", 
           SubscriptBox["Z", "1"], ",", "0", ",", 
           SubscriptBox["Z", "7"], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["Z", "12"], ",", 
           SubscriptBox["Z", "2"], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["Z", "14"], ",", 
           SubscriptBox["Z", "15"], ",", "0", ",", 
           SubscriptBox["Z", "4"]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["Z", "16"], ",", 
           SubscriptBox["Z", "3"], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Z", "9"], ",", 
           SubscriptBox["Z", "18"], ",", "0", ",", "0", ",", 
           SubscriptBox["Z", "19"]}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Z", "13"], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["Z", "17"], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["Z", "5"]}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Z", "21"], ",", "0", ",", "0", ",", "0", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["Z", "8"], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["Z", "6"]}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "}"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["XX_", "z1_"], "\[Rule]", 
       RowBox[{"XX", "[", "z1", "]"}]}], "}"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"topleft", "=", "aa"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"topright", "=", "bb"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bottomleft", "=", "cc"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bottomright", "=", "dd"}], ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6617749845034676`*^9, 3.6617749924638643`*^9}, {
  3.6617750568597474`*^9, 3.661775066071638*^9}, {3.661847902785837*^9, 
  3.661847919578432*^9}, {3.662099253065173*^9, 3.6620992533464346`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "This", " ", "is", " ", "the", " ", "planar", " ", "double", " ", "square", 
   " ", "box"}], "*)"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 CellChangeTimes->{{3.662301648989788*^9, 3.6623016629143643`*^9}, {
  3.662301706072893*^9, 3.6623017104741435`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"formatrule", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["XX_", 
      RowBox[{"z1_", ",", "z2_"}]], "\[Rule]", 
     RowBox[{"XX", "[", 
      RowBox[{"z1", ",", "z2"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aa", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"3", ",", "1"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"1", ",", "2"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"2", ",", "3"}]]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"1", ",", "4"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"5", ",", "1"}]], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        SubscriptBox["X", 
         RowBox[{"2", ",", "5"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"6", ",", "2"}]]}], "}"}]}], "}"}], "/.", "formatrule"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bb", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        SubscriptBox["X", 
         RowBox[{"4", ",", "5"}]]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"5", ",", "6"}]], ",", "0"}], "}"}]}], "}"}], "/.", 
    "formatrule"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"3", ",", "6"}]]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"4", ",", "3"}]], ",", "0", ",", "0"}], "}"}]}], "}"}], "/.",
     "formatrule"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dd", "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "}"}], "/.", "formatrule"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"topleft", "=", "aa"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"topright", "=", "bb"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bottomleft", "=", "cc"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bottomright", "=", "dd"}], ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 CellChangeTimes->{{3.6623016671663923`*^9, 3.6623017104741435`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Has", " ", "3", " ", "boundaries"}], ",", " ", 
   RowBox[{"but", " ", "is", " ", 
    RowBox[{"reducible", ".", " ", 
     RowBox[{"It", "'"}]}], "s", " ", "a", " ", "top", " ", "cell", " ", "of",
     " ", "Gr", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"3", ",", "5"}], ")"}], ".", " ", 
     RowBox[{"It", "'"}]}], "s", " ", 
    RowBox[{"a", " ", "'"}], 
    RowBox[{"reduction", "'"}], " ", "of", " ", "the", " ", "monster", " ", 
    "guy", " ", 
    RowBox[{"below", "."}]}]}], "*)"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10004.},
 CellChangeTimes->{3.662361848753731*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"formatrule", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["XX_", 
      RowBox[{"z1_", ",", "z2_"}]], "\[Rule]", 
     RowBox[{"XX", "[", 
      RowBox[{"z1", ",", "z2"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aa", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"7", ",", "1"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"1", ",", "6"}]], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"1", ",", "3"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"3", ",", "1"}]], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"3", ",", "7"}]], ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"4", ",", "3"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"7", ",", "4"}]], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        SubscriptBox["X", 
         RowBox[{"6", ",", "3"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"3", ",", "5"}]], ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"5", ",", "8"}]]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"4", ",", "2"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"2", ",", "5"}]]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"2", ",", "7"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"8", ",", "2"}]]}], "}"}]}], "}"}], "/.", "formatrule"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bb", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"6", ",", "7"}]], ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"3", ",", "3"}]], ",", "0", ",", "0", ",", "0", ",", "0"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"8", ",", "6"}]]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        SubscriptBox["Y", 
         RowBox[{"5", ",", "4"}]], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"7", ",", "8"}]], ",", "0"}], "}"}]}], "}"}], "/.", 
    "formatrule"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       SubscriptBox["X", 
        RowBox[{"5", ",", "4"}]], ",", "0", ",", "0"}], "}"}], "}"}], "/.", 
    "formatrule"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dd", "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], "}"}], "/.",
      "formatrule"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"topleft", "=", "aa"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"topright", "=", "bb"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bottomleft", "=", "cc"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bottomright", "=", "dd"}], ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10004.},
 CellChangeTimes->{{3.6623618187225723`*^9, 3.662361848753731*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Monster", " ", "guy", " ", "with", " ", "intrinsically", " ", "3", " ", 
   RowBox[{"boundaries", "."}]}], "*)"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 CellChangeTimes->{3.6623595961544695`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"formatrule", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["XX_", 
      RowBox[{"z1_", ",", "z2_"}]], "\[Rule]", 
     RowBox[{"XX", "[", 
      RowBox[{"z1", ",", "z2"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aa", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"2", ",", "1"}]], ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"1", ",", "7"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"11", ",", "2"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
        ",", 
        SubscriptBox["X", 
         RowBox[{"7", ",", "11"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
        ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"1", ",", "3"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"4", ",", "1"}]], ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"3", ",", "11"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"11", ",", "4"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
        ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        SubscriptBox["X", 
         RowBox[{"1", ",", "5"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"6", ",", "1"}]], ",", "0", ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"5", ",", "11"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"11", ",", "6"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
        ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"3", ",", "2"}]], ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"2", ",", "8"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"8", ",", "3"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
        ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        SubscriptBox["X", 
         RowBox[{"5", ",", "4"}]], ",", "0", ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"4", ",", "9"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"9", ",", "5"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
        ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"7", ",", "6"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
        ",", 
        SubscriptBox["X", 
         RowBox[{"6", ",", "10"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"10", ",", "7"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
        ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"8", ",", "11"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
        ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"12", ",", "8"}]], ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"11", ",", "12"}]], ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"11", ",", "8"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
        ",", 
        SubscriptBox["X", 
         RowBox[{"8", ",", "13"}]], ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"13", ",", "11"}]], ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"9", ",", "11"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
        ",", 
        SubscriptBox["X", 
         RowBox[{"14", ",", "9"}]], ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"11", ",", "14"}]], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"11", ",", "9"}]], ",", "0", ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"9", ",", "15"}]], ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"15", ",", "11"}]], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"10", ",", "11"}]], ",", "0", ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"16", ",", "10"}]], ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"11", ",", "16"}]]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", 
        SubscriptBox["X", 
         RowBox[{"11", ",", "10"}]], ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"10", ",", "17"}]], ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"17", ",", "11"}]]}], "}"}]}], "}"}], "/.", "formatrule"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bb", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "}"}], ",", 
      RowBox[{"{", "}"}], ",", 
      RowBox[{"{", "}"}], ",", 
      RowBox[{"{", "}"}], ",", 
      RowBox[{"{", "}"}], ",", 
      RowBox[{"{", "}"}], ",", 
      RowBox[{"{", "}"}], ",", 
      RowBox[{"{", "}"}], ",", 
      RowBox[{"{", "}"}], ",", 
      RowBox[{"{", "}"}], ",", 
      RowBox[{"{", "}"}], ",", 
      RowBox[{"{", "}"}]}], "}"}], "/.", "formatrule"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"13", ",", "12"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
        ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"12", ",", "13"}]], ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"15", ",", "14"}]], ",", "0", ",", "0", ",", "0", ",", "0"}],
        "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"14", ",", "15"}]], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"17", ",", "16"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"16", ",", "17"}]]}], "}"}]}], "}"}], "/.", "formatrule"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dd", "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", "}"}]}], "}"}], "/.", "formatrule"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"topleft", "=", "aa"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"topright", "=", "bb"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bottomleft", "=", "cc"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bottomright", "=", "dd"}], ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 CellChangeTimes->{{3.662359555768058*^9, 3.6623595961544695`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"This", " ", "is", " ", "a", " ", "dimer", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"no", " ", "boundaries"}], ",", " ", 
     RowBox[{"genus", " ", "1"}]}], ")"}]}], "*)"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10004.},
 CellChangeTimes->{{3.6624580361125507`*^9, 3.6624580509248238`*^9}, 
   3.662458099242345*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"formatrule", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["XX_", 
      RowBox[{"z1_", ",", "z2_"}]], "\[Rule]", 
     RowBox[{"XX", "[", 
      RowBox[{"z1", ",", "z2"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aa", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         SubscriptBox["X", 
          RowBox[{"3", ",", "4"}]], "+", 
         SubscriptBox["X", 
          RowBox[{"2", ",", "1"}]]}], ",", 
        RowBox[{
         SubscriptBox["X", 
          RowBox[{"1", ",", "3"}]], "+", 
         SubscriptBox["X", 
          RowBox[{"4", ",", "2"}]]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         SubscriptBox["Y", 
          RowBox[{"1", ",", "3"}]], "+", 
         SubscriptBox["Y", 
          RowBox[{"4", ",", "2"}]]}], ",", 
        RowBox[{
         SubscriptBox["Y", 
          RowBox[{"2", ",", "1"}]], "+", 
         SubscriptBox["Y", 
          RowBox[{"3", ",", "4"}]]}]}], "}"}]}], "}"}], "/.", 
    "formatrule"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bb", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dd", "=", 
    RowBox[{"{", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"topleft", "=", "aa"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"topright", "=", "bb"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bottomleft", "=", "cc"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bottomright", "=", "dd"}], ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10004.},
 CellChangeTimes->{{3.6624580938513813`*^9, 3.662458099242345*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"This", " ", "is", " ", "a", " ", "larger", " ", "dimer", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"no", " ", "boundaries"}], ",", " ", 
     RowBox[{"genus", " ", "1"}]}], ")"}]}], "*)"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6624580361125507`*^9, 3.6624580879321213`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"formatrule", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["XX_", 
      RowBox[{"z1_", ",", "z2_"}]], "\[Rule]", 
     RowBox[{"XX", "[", 
      RowBox[{"z1", ",", "z2"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aa", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"3", ",", "5"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"5", ",", "2"}]], ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"2", ",", "3"}]], ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        SubscriptBox["X", 
         RowBox[{"2", ",", "4"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"4", ",", "1"}]], ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"1", ",", "2"}]], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"6", ",", "3"}]], ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"1", ",", "6"}]], ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"3", ",", "1"}]]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"5", ",", "6"}]], ",", "0", ",", "0", ",", 
        SubscriptBox["Y", 
         RowBox[{"3", ",", "5"}]], ",", "0", ",", 
        SubscriptBox["Y", 
         RowBox[{"6", ",", "3"}]]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        SubscriptBox["X", 
         RowBox[{"4", ",", "5"}]], ",", "0", ",", 
        SubscriptBox["Y", 
         RowBox[{"5", ",", "2"}]], ",", 
        SubscriptBox["Y", 
         RowBox[{"2", ",", "4"}]], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"6", ",", "4"}]], ",", "0", ",", 
        SubscriptBox["Y", 
         RowBox[{"4", ",", "1"}]], ",", 
        SubscriptBox["Y", 
         RowBox[{"1", ",", "6"}]]}], "}"}]}], "}"}], "/.", "formatrule"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bb", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dd", "=", 
    RowBox[{"{", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"topleft", "=", "aa"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"topright", "=", "bb"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bottomleft", "=", "cc"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bottomright", "=", "dd"}], ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6624580795945396`*^9, 3.6624580879321213`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "This", " ", "is", " ", "a", " ", "random", " ", "large", " ", "and", " ", 
   "vaguely", " ", "\"\<Kasteleyn-like\>\"", " ", "matrix"}], "*)"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 CellChangeTimes->{{3.6617754963342223`*^9, 3.6617755411838408`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"multiplier", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aa", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"X", "[", 
      RowBox[{
       RowBox[{"RandomInteger", "[", "100000", "]"}], ",", 
       RowBox[{"RandomInteger", "[", "100000", "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"60", "multiplier"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", 
       RowBox[{"60", "multiplier"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bb", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Y", "[", 
      RowBox[{
       RowBox[{"RandomInteger", "[", "100000", "]"}], ",", 
       RowBox[{"RandomInteger", "[", "100000", "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"10", "multiplier"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", 
       RowBox[{"60", "multiplier"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Z", "[", 
      RowBox[{
       RowBox[{"RandomInteger", "[", "100000", "]"}], ",", 
       RowBox[{"RandomInteger", "[", "100000", "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"60", "multiplier"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", 
       RowBox[{"15", "multiplier"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dd", "=", 
    RowBox[{"Table", "[", 
     RowBox[{"0", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"10", "multiplier"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", 
        RowBox[{"15", "multiplier"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"topleft", "=", "aa"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"topright", "=", "bb"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bottomleft", "=", "cc"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bottomright", "=", "dd"}], ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 CellChangeTimes->{{3.661693348100015*^9, 3.66169340837926*^9}, {
   3.6616934927295403`*^9, 3.661693626719072*^9}, {3.6616937703262477`*^9, 
   3.661693889829563*^9}, {3.6616939336039877`*^9, 3.6616940513238783`*^9}, {
   3.661696926536392*^9, 3.6616970253141675`*^9}, {3.661697278440854*^9, 
   3.661697303520342*^9}, {3.6616973412705407`*^9, 3.6616973495555525`*^9}, 
   3.661697408415449*^9, {3.6617516480006285`*^9, 3.661751683088457*^9}, {
   3.661752734642175*^9, 3.661752785324402*^9}, 3.6617528598260384`*^9, 
   3.661759193383051*^9, 3.6617755024581594`*^9, 3.6617755411843414`*^9, {
   3.6620992442118053`*^9, 3.6620992444774437`*^9}}]
}, Closed]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.662284700602398*^9, 3.662458016607738*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"viewGraph", "[", 
  RowBox[{"topleft", ",", "topright", ",", "bottomleft", ",", "bottomright"}],
   "]"}]], "Input",
 CellChangeTimes->{{3.662459789135682*^9, 3.6624598079695234`*^9}}],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{1, 19, 21, 22, 27, 2, 20, 23, 24, 3, 25, 26, 4, 5, 6, 7, 28, 31, 
      8, 9, 29, 32, 10, 11, 30, 33, 12, 13, 14, 15, 16, 17, 18}, {
      Null, {{1, 2}, {1, 3}, {1, 4}, {1, 5}, {6, 2}, {6, 7}, {6, 8}, {6, 9}, {
       10, 7}, {10, 3}, {10, 11}, {10, 12}, {13, 2}, {13, 4}, {13, 8}, {14, 
       7}, {14, 9}, {14, 11}, {15, 3}, {15, 12}, {15, 5}, {16, 4}, {16, 17}, {
       16, 18}, {19, 8}, {19, 17}, {19, 18}, {20, 9}, {20, 21}, {20, 22}, {23,
        11}, {23, 21}, {23, 22}, {24, 12}, {24, 25}, {24, 26}, {27, 5}, {27, 
       25}, {27, 26}, {28, 17}, {29, 18}, {30, 21}, {31, 22}, {32, 25}, {33, 
       26}}}, {EdgeShapeFunction -> {
         Function[{Private`edgepositions$, Private`edgename$}, 
          Private`edgeweightname$581 = Part[Private`tempedgelabels$581, 
             Part[
              Position[Private`tempedgelabels$581, 
               Sort[Private`edgename$]], 1, 1], 2]; 
          Private`tempedgelabels$581 = Delete[Private`tempedgelabels$581, 
             Part[
              Position[Private`tempedgelabels$581, 
               Sort[Private`edgename$]], 1, 1]]; {
            Text[
             Style[Private`edgeweightname$581, Medium, Bold, Blue], 
             Mean[Private`edgepositions$]], {Black, 
             Line[Private`edgepositions$]}}]}, ImagePadding -> 20, 
       VertexLabels -> {"Name"}, VertexLabelStyle -> {15}, 
       VertexSize -> {Medium}, 
       VertexStyle -> {
        5 -> GrayLevel[1], 15 -> GrayLevel[1], 22 -> GrayLevel[0], 9 -> 
         GrayLevel[1], 14 -> GrayLevel[1], 19 -> GrayLevel[0], 6 -> 
         GrayLevel[1], 26 -> GrayLevel[0], 18 -> GrayLevel[1], 2 -> 
         GrayLevel[1], 12 -> GrayLevel[1], 17 -> GrayLevel[1], 31 -> 
         GrayLevel[0], 7 -> GrayLevel[1], 10 -> GrayLevel[1], 24 -> 
         GrayLevel[0], 30 -> GrayLevel[0], 8 -> GrayLevel[1], 33 -> 
         GrayLevel[0], 11 -> GrayLevel[1], 13 -> GrayLevel[1], 29 -> 
         GrayLevel[0], 1 -> GrayLevel[1], 3 -> GrayLevel[1], 21 -> 
         GrayLevel[0], 27 -> GrayLevel[0], 28 -> GrayLevel[0], 25 -> 
         GrayLevel[0], 4 -> GrayLevel[1], 32 -> GrayLevel[0], 16 -> 
         GrayLevel[1], 20 -> GrayLevel[0], 23 -> GrayLevel[0]}}]]}, 
    TagBox[GraphicsGroupBox[{
       {Hue[0.6, 0.7, 0.5], Opacity[0.7], {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"2", ",", "1"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           
           FontColor->RGBColor[
            0, 0, 1]], {3.948851191720686, 5.435019569836576}], 
         {GrayLevel[0], 
          LineBox[{{4.334143998849821, 5.779858403495108}, {3.563558384591551,
            5.090180736178043}}]}}, {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"1", ",", "7"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           
           FontColor->RGBColor[
            0, 0, 1]], {4.728766320410237, 5.442952694299157}], 
         {GrayLevel[0], 
          LineBox[{{4.334143998849821, 5.779858403495108}, {5.123388641970655,
            5.106046985103206}}]}}, {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"11", ",", "2"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           FontColor->RGBColor[
            0, 0, 1]], {3.679846695814613, 5.957202317707897}], 
         {GrayLevel[0], 
          LineBox[{{4.334143998849821, 5.779858403495108}, {
           3.0255493927794053`, 6.134546231920686}}]}}, {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"7", ",", "11"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           
           FontColor->RGBColor[
            0, 0, 1]], {4.979655638800058, 5.977947128111577}], 
         {GrayLevel[0], 
          LineBox[{{4.334143998849821, 5.779858403495108}, {5.625167278750296,
            6.176035852728045}}]}}, {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"1", ",", "3"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           
           FontColor->RGBColor[
            0, 0, 1]], {3.4674238249873435`, 4.580316535605371}], 
         {GrayLevel[0], 
          LineBox[{{3.563558384591551, 5.090180736178043}, {3.371289265383136,
            4.0704523350327}}]}}, {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"3", ",", "2"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           
           FontColor->RGBColor[
            0, 0, 1]], {3.225749864041119, 5.2754239633936395`}], 
         {GrayLevel[0], 
          LineBox[{{3.563558384591551, 5.090180736178043}, {
           2.8879413434906867`, 5.460667190609236}}]}}, {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"6", ",", "1"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           
           FontColor->RGBColor[
            0, 0, 1]], {5.232346017774788, 4.598311265018214}], 
         {GrayLevel[0], 
          LineBox[{{5.123388641970655, 5.106046985103206}, {
           5.3413033935789205`, 4.090575544933222}}]}}, {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"7", ",", "6"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           
           FontColor->RGBColor[
            0, 0, 1]], {5.4547630454778595`, 5.301801936791396}], 
         {GrayLevel[0], 
          LineBox[{{5.123388641970655, 5.106046985103206}, {5.786137448985064,
            5.4975568884795845`}}]}}, {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"2", ",", "8"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           
           FontColor->RGBColor[
            0, 0, 1]], {2.9567453681350457`, 5.797606711264961}], 
         {GrayLevel[0], 
          LineBox[{{3.0255493927794053`, 6.134546231920686}, {
           2.8879413434906867`, 5.460667190609236}}]}}, {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"8", ",", "11"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           
           FontColor->RGBColor[
            0, 0, 1]], {2.409054966707532, 6.3002519166359985`}], 
         {GrayLevel[0], 
          LineBox[{{3.0255493927794053`, 6.134546231920686}, {
           1.7925605406356588`, 6.465957601351311}}]}}, {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"10", ",", "7"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           
           FontColor->RGBColor[
            0, 0, 1]], {5.70565236386768, 5.836796370603815}], 
         {GrayLevel[0], 
          LineBox[{{5.625167278750296, 6.176035852728045}, {5.786137448985064,
            5.4975568884795845`}}]}}, {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"11", ",", "10"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           
           FontColor->RGBColor[
            0, 0, 1]], {6.232759700357164, 6.3645445977492034`}], 
         {GrayLevel[0], 
          LineBox[{{5.625167278750296, 6.176035852728045}, {6.840352121964031,
            6.553053342770362}}]}}, {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"4", ",", "1"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           
           FontColor->RGBColor[
            0, 0, 1]], {3.8656360261777176`, 3.9027260695327715`}], 
         {GrayLevel[0], 
          LineBox[{{3.371289265383136, 4.0704523350327}, {4.359982786972299, 
           3.734999804032843}}]}}, {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"3", ",", "11"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           
           FontColor->RGBColor[
            0, 0, 1]], {2.8758630535002907`, 4.529772203480562}], 
         {GrayLevel[0], 
          LineBox[{{3.371289265383136, 4.0704523350327}, {2.3804368416174455`,
            4.989092071928423}}]}}, {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"11", ",", "4"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           
           FontColor->RGBColor[
            0, 0, 1]], {3.541595986732979, 3.4196162216068253`}], 
         {GrayLevel[0], 
          LineBox[{{3.371289265383136, 4.0704523350327}, {3.7119027080828224`,
            2.768780108180951}}]}}, {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"1", ",", "5"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           
           FontColor->RGBColor[
            0, 0, 1]], {4.85064309027561, 3.9127876744830328`}], 
         {GrayLevel[0], 
          LineBox[{{4.359982786972299, 3.734999804032843}, {
           5.3413033935789205`, 4.090575544933222}}]}}, {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"5", ",", "4"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           
           FontColor->RGBColor[
            0, 0, 1]], {4.36468515020708, 3.354267397884634}], 
         {GrayLevel[0], 
          LineBox[{{4.359982786972299, 3.734999804032843}, {4.369387513441862,
            2.9735349917364244`}}]}}, {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"8", ",", "3"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           
           FontColor->RGBColor[
            0, 0, 1]], {2.634189092554066, 5.224879631268829}], 
         {GrayLevel[0], 
          LineBox[{{2.3804368416174455`, 4.989092071928423}, {
           2.8879413434906867`, 5.460667190609236}}]}}, {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"11", ",", "8"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           
           FontColor->RGBColor[
            0, 0, 1]], {1.911785071404729, 5.415395391038908}], 
         {GrayLevel[0], 
          LineBox[{{2.3804368416174455`, 4.989092071928423}, {
           1.4431333011920127`, 5.841698710149393}}]}}, {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"4", ",", "9"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           
           FontColor->RGBColor[
            0, 0, 1]], {4.040645110762342, 2.8711575499586877`}], 
         {GrayLevel[0], 
          LineBox[{{3.7119027080828224`, 2.768780108180951}, {
           4.369387513441862, 2.9735349917364244`}}]}}, {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"9", ",", "11"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           
           FontColor->RGBColor[
            0, 0, 1]], {3.8719054872176333`, 2.1568302190636315`}], 
         {GrayLevel[0], 
          LineBox[{{3.7119027080828224`, 2.768780108180951}, {
           4.031908266352444, 1.544880329946312}}]}}, {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"5", ",", "11"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           
           FontColor->RGBColor[
            0, 0, 1]], {5.1883034623990145`, 3.43498375029648}], 
         {GrayLevel[0], 
          LineBox[{{5.3413033935789205`, 4.090575544933222}, {
           5.035303531219108, 2.7793919556597375`}}]}}, {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"11", ",", "6"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           
           FontColor->RGBColor[
            0, 0, 1]], {5.8249117725047075`, 4.564506722918296}], 
         {GrayLevel[0], 
          LineBox[{{5.3413033935789205`, 4.090575544933222}, {
           6.308520151430494, 5.038437900903368}}]}}, {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"9", ",", "5"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           
           FontColor->RGBColor[
            0, 0, 1]], {4.702345522330485, 2.876463473698081}], 
         {GrayLevel[0], 
          LineBox[{{5.035303531219108, 2.7793919556597375`}, {
           4.369387513441862, 2.9735349917364244`}}]}}, {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"11", ",", "9"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           
           FontColor->RGBColor[
            0, 0, 1]], {4.893749857850769, 2.1649289428172134`}], 
         {GrayLevel[0], 
          LineBox[{{5.035303531219108, 2.7793919556597375`}, {
           4.75219618448243, 1.5504659299746892`}}]}}, {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"6", ",", "10"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           
           FontColor->RGBColor[
            0, 0, 1]], {6.047328800207779, 5.267997394691476}], 
         {GrayLevel[0], 
          LineBox[{{6.308520151430494, 5.038437900903368}, {5.786137448985064,
            5.4975568884795845`}}]}}, {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"10", ",", "11"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           
           FontColor->RGBColor[
            0, 0, 1]], {6.761588653949611, 5.484826324652383}], 
         {GrayLevel[0], 
          LineBox[{{6.308520151430494, 5.038437900903368}, {7.214657156468727,
            5.931214748401398}}]}}, {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"12", ",", "8"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           
           FontColor->RGBColor[
            0, 0, 1]], {1.4438721661769496`, 6.6009269774741055`}], 
         {GrayLevel[0], 
          LineBox[{{1.7925605406356588`, 6.465957601351311}, {
           1.0951837917182403`, 6.7358963535969}}]}}, {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"11", ",", "12"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           
           FontColor->RGBColor[
            0, 0, 1]], {1.3203843032469518`, 6.369702943857038}], 
         {GrayLevel[0], 
          LineBox[{{1.7925605406356588`, 6.465957601351311}, {
           0.8482080658582447, 6.273448286362765}}]}}, {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"8", ",", "13"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           
           FontColor->RGBColor[
            0, 0, 1]], {1.2691585464551265`, 6.288797531873146}], 
         {GrayLevel[0], 
          LineBox[{{1.0951837917182403`, 6.7358963535969}, {
           1.4431333011920127`, 5.841698710149393}}]}}, {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"13", ",", "12"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           
           FontColor->RGBColor[
            0, 0, 1]], {0.8042027759041288, 7.053063055886859}], 
         {GrayLevel[0], 
          LineBox[{{1.0951837917182403`, 6.7358963535969}, {
           0.5132217600900173, 7.3702297581768175`}}]}}, {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"13", ",", "11"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           
           FontColor->RGBColor[
            0, 0, 1]], {1.1456706835251287`, 6.057573498256079}], 
         {GrayLevel[0], 
          LineBox[{{0.8482080658582447, 6.273448286362765}, {
           1.4431333011920127`, 5.841698710149393}}]}}, {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"12", ",", "13"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           
           FontColor->RGBColor[
            0, 0, 1]], {0.42410403292912235`, 6.338135204885693}], 
         {GrayLevel[0], 
          LineBox[{{0.8482080658582447, 6.273448286362765}, {0., 
           6.402822123408621}}]}}, {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"14", ",", "9"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           
           FontColor->RGBColor[
            0, 0, 1]], {4.089071928913619, 1.1782905930311565`}], 
         {GrayLevel[0], 
          LineBox[{{4.031908266352444, 1.544880329946312}, {4.146235591474793,
            0.8117008561160008}}]}}, {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"11", ",", "14"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           
           FontColor->RGBColor[
            0, 0, 1]], {4.3468538998944855`, 1.1826445031620458`}], 
         {GrayLevel[0], 
          LineBox[{{4.031908266352444, 1.544880329946312}, {4.661799533436527,
            0.8204086763777796}}]}}, {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"9", ",", "15"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           
           FontColor->RGBColor[
            0, 0, 1]], {4.449215887978611, 1.181083393045345}], 
         {GrayLevel[0], 
          LineBox[{{4.146235591474793, 0.8117008561160008}, {4.75219618448243,
            1.5504659299746892`}}]}}, {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"15", ",", "14"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           
           FontColor->RGBColor[
            0, 0, 1]], {4.010857485867227, 0.4058504280580004}], 
         {GrayLevel[0], 
          LineBox[{{4.146235591474793, 0.8117008561160008}, {
           3.875479380259662, 0.}}]}}, {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"15", ",", "11"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           
           FontColor->RGBColor[
            0, 0, 1]], {4.706997858959479, 1.1854373031762344`}], 
         {GrayLevel[0], 
          LineBox[{{4.661799533436527, 0.8204086763777796}, {4.75219618448243,
            1.5504659299746892`}}]}}, {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"14", ",", "15"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           
           FontColor->RGBColor[
            0, 0, 1]], {4.8063929607342875`, 0.41825652905912114`}], 
         {GrayLevel[0], 
          LineBox[{{4.661799533436527, 0.8204086763777796}, {
           4.950986388032049, 0.016104381740462692`}}]}}, {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"16", ",", "10"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           
           FontColor->RGBColor[
            0, 0, 1]], {7.366739759127985, 6.38930231966182}], 
         {GrayLevel[0], 
          LineBox[{{7.214657156468727, 5.931214748401398}, {7.518822361787244,
            6.847389890922242}}]}}, {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"11", ",", "16"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           
           FontColor->RGBColor[
            0, 0, 1]], {7.503701390375977, 6.162196563187666}], 
         {GrayLevel[0], 
          LineBox[{{7.214657156468727, 5.931214748401398}, {7.792745624283228,
            6.393178377973934}}]}}, {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"10", ",", "17"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           
           FontColor->RGBColor[
            0, 0, 1]], {7.1795872418756375`, 6.700221616846302}], 
         {GrayLevel[0], 
          LineBox[{{7.518822361787244, 6.847389890922242}, {6.840352121964031,
            6.553053342770362}}]}}, {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"17", ",", "16"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           
           FontColor->RGBColor[
            0, 0, 1]], {7.786258066699018, 7.186263488056049}], 
         {GrayLevel[0], 
          LineBox[{{7.518822361787244, 6.847389890922242}, {8.053693771610792,
            7.525137085189856}}]}}, {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"17", ",", "11"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           
           FontColor->RGBColor[
            0, 0, 1]], {7.3165488731236294`, 6.473115860372148}], 
         {GrayLevel[0], 
          LineBox[{{7.792745624283228, 6.393178377973934}, {6.840352121964031,
            6.553053342770362}}]}}, {InsetBox[
          StyleBox[
           RowBox[{"X", "(", 
            RowBox[{"16", ",", "17"}], ")"}],
           StripOnInput->False,
           LineColor->RGBColor[0, 0, 1],
           FrontFaceColor->RGBColor[0, 0, 1],
           BackFaceColor->RGBColor[0, 0, 1],
           GraphicsColor->RGBColor[0, 0, 1],
           FontSize->Medium,
           FontWeight->Bold,
           
           FontColor->RGBColor[
            0, 0, 1]], {8.217370523011926, 6.472435753661672}], 
         {GrayLevel[0], 
          LineBox[{{7.792745624283228, 6.393178377973934}, {8.641995421740624,
            6.55169312934941}}]}}}, 
       {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], {
         {GrayLevel[1], 
          DiskBox[{4.334143998849821, 5.779858403495108}, 
           0.05156374737980496]}, InsetBox[
          StyleBox["1",
           StripOnInput->False,
           FontSize->15], 
          Offset[{2, 2}, {4.385707746229626, 5.831422150874913}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {GrayLevel[0], 
          DiskBox[{3.563558384591551, 5.090180736178043}, 
           0.05156374737980496]}, InsetBox[
          StyleBox["19",
           StripOnInput->False,
           FontSize->15], 
          Offset[{2, 2}, {3.615122131971356, 5.141744483557848}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {GrayLevel[0], 
          DiskBox[{5.123388641970655, 5.106046985103206}, 
           0.05156374737980496]}, InsetBox[
          StyleBox["21",
           StripOnInput->False,
           FontSize->15], 
          Offset[{2, 2}, {5.17495238935046, 5.157610732483011}], ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {GrayLevel[0], 
          DiskBox[{3.0255493927794053`, 6.134546231920686}, 
           0.05156374737980496]}, InsetBox[
          StyleBox["22",
           StripOnInput->False,
           FontSize->15], 
          Offset[{2, 2}, {3.0771131401592102`, 6.186109979300491}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {GrayLevel[0], 
          DiskBox[{5.625167278750296, 6.176035852728045}, 
           0.05156374737980496]}, InsetBox[
          StyleBox["27",
           StripOnInput->False,
           FontSize->15], 
          Offset[{2, 2}, {5.676731026130101, 6.22759960010785}], ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {GrayLevel[1], 
          DiskBox[{3.371289265383136, 4.0704523350327}, 0.05156374737980496]},
          InsetBox[
          StyleBox["2",
           StripOnInput->False,
           FontSize->15], 
          Offset[{2, 2}, {3.422853012762941, 4.122016082412505}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {GrayLevel[0], 
          DiskBox[{4.359982786972299, 3.734999804032843}, 
           0.05156374737980496]}, InsetBox[
          StyleBox["20",
           StripOnInput->False,
           FontSize->15], 
          Offset[{2, 2}, {4.411546534352104, 3.786563551412648}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {GrayLevel[0], 
          DiskBox[{2.3804368416174455`, 4.989092071928423}, 
           0.05156374737980496]}, InsetBox[
          StyleBox["23",
           StripOnInput->False,
           FontSize->15], 
          Offset[{2, 2}, {2.4320005889972505`, 5.040655819308228}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {GrayLevel[0], 
          DiskBox[{3.7119027080828224`, 2.768780108180951}, 
           0.05156374737980496]}, InsetBox[
          StyleBox["24",
           StripOnInput->False,
           FontSize->15], 
          Offset[{2, 2}, {3.7634664554626274`, 2.820343855560756}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {GrayLevel[1], 
          DiskBox[{5.3413033935789205`, 4.090575544933222}, 
           0.05156374737980496]}, InsetBox[
          StyleBox["3",
           StripOnInput->False,
           FontSize->15], 
          Offset[{2, 2}, {5.392867140958725, 4.142139292313027}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {GrayLevel[0], 
          DiskBox[{5.035303531219108, 2.7793919556597375`}, 
           0.05156374737980496]}, InsetBox[
          StyleBox["25",
           StripOnInput->False,
           FontSize->15], 
          Offset[{2, 2}, {5.086867278598913, 2.8309557030395425`}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {GrayLevel[0], 
          DiskBox[{6.308520151430494, 5.038437900903368}, 
           0.05156374737980496]}, InsetBox[
          StyleBox["26",
           StripOnInput->False,
           FontSize->15], 
          Offset[{2, 2}, {6.360083898810299, 5.090001648283173}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {GrayLevel[1], 
          DiskBox[{2.8879413434906867`, 5.460667190609236}, 
           0.05156374737980496]}, InsetBox[
          StyleBox["4",
           StripOnInput->False,
           FontSize->15], 
          Offset[{2, 2}, {2.9395050908704916`, 5.512230937989041}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {GrayLevel[1], 
          DiskBox[{4.369387513441862, 2.9735349917364244`}, 
           0.05156374737980496]}, InsetBox[
          StyleBox["5",
           StripOnInput->False,
           FontSize->15], 
          Offset[{2, 2}, {4.420951260821667, 3.0250987391162294`}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {GrayLevel[1], 
          DiskBox[{5.786137448985064, 5.4975568884795845`}, 
           0.05156374737980496]}, InsetBox[
          StyleBox["6",
           StripOnInput->False,
           FontSize->15], 
          Offset[{2, 2}, {5.837701196364869, 5.549120635859389}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {GrayLevel[1], 
          DiskBox[{1.7925605406356588`, 6.465957601351311}, 
           0.05156374737980496]}, InsetBox[
          StyleBox["7",
           StripOnInput->False,
           FontSize->15], 
          Offset[{2, 2}, {1.8441242880154638`, 6.517521348731116}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {GrayLevel[0], 
          DiskBox[{1.0951837917182403`, 6.7358963535969}, 
           0.05156374737980496]}, InsetBox[
          StyleBox["28",
           StripOnInput->False,
           FontSize->15], 
          Offset[{2, 2}, {1.1467475390980453`, 6.787460100976705}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {GrayLevel[0], 
          DiskBox[{0.8482080658582447, 6.273448286362765}, 
           0.05156374737980496]}, InsetBox[
          StyleBox["31",
           StripOnInput->False,
           FontSize->15], 
          Offset[{2, 2}, {0.8997718132380497, 6.32501203374257}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {GrayLevel[1], 
          DiskBox[{1.4431333011920127`, 5.841698710149393}, 
           0.05156374737980496]}, InsetBox[
          StyleBox["8",
           StripOnInput->False,
           FontSize->15], 
          Offset[{2, 2}, {1.4946970485718176`, 5.893262457529198}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {GrayLevel[1], 
          DiskBox[{4.031908266352444, 1.544880329946312}, 
           0.05156374737980496]}, InsetBox[
          StyleBox["9",
           StripOnInput->False,
           FontSize->15], 
          Offset[{2, 2}, {4.083472013732249, 1.596444077326117}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {GrayLevel[0], 
          DiskBox[{4.146235591474793, 0.8117008561160008}, 
           0.05156374737980496]}, InsetBox[
          StyleBox["29",
           StripOnInput->False,
           FontSize->15], 
          Offset[{2, 2}, {4.1977993388545976`, 0.8632646034958058}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {GrayLevel[0], 
          DiskBox[{4.661799533436527, 0.8204086763777796}, 
           0.05156374737980496]}, InsetBox[
          StyleBox["32",
           StripOnInput->False,
           FontSize->15], 
          Offset[{2, 2}, {4.713363280816332, 0.8719724237575845}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {GrayLevel[1], 
          DiskBox[{4.75219618448243, 1.5504659299746892`}, 
           0.05156374737980496]}, InsetBox[
          StyleBox["10",
           StripOnInput->False,
           FontSize->15], 
          Offset[{2, 2}, {4.803759931862235, 1.6020296773544942`}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {GrayLevel[1], 
          DiskBox[{7.214657156468727, 5.931214748401398}, 
           0.05156374737980496]}, InsetBox[
          StyleBox["11",
           StripOnInput->False,
           FontSize->15], 
          Offset[{2, 2}, {7.266220903848532, 5.982778495781203}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {GrayLevel[0], 
          DiskBox[{7.518822361787244, 6.847389890922242}, 
           0.05156374737980496]}, InsetBox[
          StyleBox["30",
           StripOnInput->False,
           FontSize->15], 
          Offset[{2, 2}, {7.570386109167049, 6.898953638302047}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {GrayLevel[0], 
          DiskBox[{7.792745624283228, 6.393178377973934}, 
           0.05156374737980496]}, InsetBox[
          StyleBox["33",
           StripOnInput->False,
           FontSize->15], 
          Offset[{2, 2}, {7.844309371663033, 6.444742125353739}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {GrayLevel[1], 
          DiskBox[{6.840352121964031, 6.553053342770362}, 
           0.05156374737980496]}, InsetBox[
          StyleBox["12",
           StripOnInput->False,
           FontSize->15], 
          Offset[{2, 2}, {6.891915869343836, 6.604617090150167}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {GrayLevel[1], 
          DiskBox[{0.5132217600900173, 7.3702297581768175`}, 
           0.05156374737980496]}, InsetBox[
          StyleBox["13",
           StripOnInput->False,
           FontSize->15], 
          Offset[{2, 2}, {0.5647855074698223, 7.421793505556622}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {GrayLevel[1], 
          DiskBox[{0., 6.402822123408621}, 0.05156374737980496]}, InsetBox[
          StyleBox["14",
           StripOnInput->False,
           FontSize->15], 
          Offset[{2, 2}, {0.05156374737980496, 6.454385870788426}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {GrayLevel[1], 
          DiskBox[{3.875479380259662, 0.}, 0.05156374737980496]}, InsetBox[
          StyleBox["15",
           StripOnInput->False,
           FontSize->15], 
          Offset[{2, 2}, {3.927043127639467, 0.05156374737980496}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {GrayLevel[1], 
          DiskBox[{4.950986388032049, 0.016104381740462692`}, 
           0.05156374737980496]}, InsetBox[
          StyleBox["16",
           StripOnInput->False,
           FontSize->15], 
          Offset[{2, 2}, {5.002550135411854, 0.06766812912026765}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {GrayLevel[1], 
          DiskBox[{8.053693771610792, 7.525137085189856}, 
           0.05156374737980496]}, InsetBox[
          StyleBox["17",
           StripOnInput->False,
           FontSize->15], 
          Offset[{2, 2}, {8.105257518990598, 7.576700832569661}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {GrayLevel[1], 
          DiskBox[{8.641995421740624, 6.55169312934941}, 
           0.05156374737980496]}, InsetBox[
          StyleBox["18",
           StripOnInput->False,
           FontSize->15], 
          Offset[{2, 2}, {8.69355916912043, 6.603256876729215}], ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FrameTicks->None,
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->20,
  ImageSize->{594., Automatic}]], "Output",
 CellChangeTimes->{
  3.662459808552912*^9, 3.662460482301175*^9, 3.662462840060614*^9, 
   3.662463867991734*^9, 3.662465288645248*^9, 3.6624660762743*^9, 
   3.662466269321703*^9, {3.6624669808224826`*^9, 
   3.662466986960226*^9}},ImageCache->GraphicsData["CompressedBitmap", "\<\
eJzsvXm4llW5B/ycvd/33QOzs+KA5ZTzDGKAiAgKmCDiTAoqokZqHBSHLBQV
c9hOSbJLM8LMoTADU0ozDatDnoNWGB2s8JR0OjTROdGp837rd6/1u9e9nne9
G+y6vn++6+ucLXuv53nWcK97Wve0Jlww+5KLPnLB7JnTLxg05qoLrrhk5vSP
DTrxo1e5ptZ/KoqWSe6nz6ACv9eLgv+pu//3/5mM/6D5/2/4/3RDX/m9dcDG
jRsPWr169Q4bNmzwD0aZl/rI79Wzli5d+ub06dN/MXfu3J+6fz/5wAMPFMOa
ddBiOujtXzppxYoVG26//fb65s2bixaZTuumJ5988upFixbJG0N7GEg6+qfG
TldOnTq17kb33fn/rjnzzDN7bdq0Sd4YspWD/5/pu5f/pubeXXPaaafJ2xX/
zbrZs2fvu2bNGtv3Fufw98Z5P+n6qbt+5O0wn7p7f5XrC+Oy7y3OobHvtj3X
rVv3bzNnzqyvXLkSX2CcdxwwR7388ssByFse//8aMWDX9evX3zd//vy3JkyY
8O+jRo06admyZcWxWzFm3fTVX7DjrCVLlnww9vqTkSNHrh03bhxmdfiqVasa
t7u/nzZe/rQbRv7yQ7cC8W5xQ8lf8nKr+XCAfwkf4WODaK0f7erqGuXwoocP
ZaJD41Y85rZVwCOvVBrHSSZ4jG8b5mDwzw734jj2w20yE/TU42aztstNdmjR
tVb+cm01999lxcWF+d/QrmJtvb6//+QTN954o4dg07FkTa2ZEXTU+tqia2hR
XLzMtC27mCMV+0Wi73b0KfDo6HHGvr/SjH/XCIQEejkgJNNxYFhm3xPA+PfC
FMcuX778UmEf7q/cFMtLHtq1VtvW+gZZ8kYz1209xicbJj+m37ZkTh6UYU6f
stTb45y2sMaGOcnG5qCWm82+vg0cG5sof3X2MJu1HiPSnTH9ZSCU7GYZQuk8
U8j7Nr/yfXVlvXqYnYAq7NWWZredR8t0/2Kf5c+HDh3qusT/WnU76nUFIIDn
xd4WALiMROuAmKOqzBSx6mLJnFEe8LHPVtMl4Ia/Av0Ds4Bh8ldPENP9dJ3k
lpeZjkBr5sxxhv0k07EoEqYD4gMRGmSv+lWnK8pC5E9mCh3Kc+pPOmnoIM7+
eulGeghLf3jP8aWAdqbPoPFcO39+/bQnn/TPd4r8HbsJvhZ2slritjnUbd62
sXH+Dh51J6vqER6C2kW7pewhToTqS4E+WrlFYR2GeeB1wARrZts9s2bVT1m6
1L8XVA6IhZuuv/5GJ460zcIs8Ou24qEzimL7o9Y69cV/b4krrOlvcTuc+K07
rOPnwEBpE/AHsKArTNGhgr6HNrwn0/ZtFXwz6amn1j83Zgy2lLSI3XZI7Xe9
mvm8qgxH2shw0J2T2B4S7f47rB5TkdV5xaYC4Tz6+echpAX4SjeG21YCQozb
v0GQFb+zQGnHqID/MxMm+AW7Vqceyd9ob43bhiY8IkwwebQ5rYSw6yTK42fN
vvvO/PrJJ6/nIh3uyPsATDXTRYCLU3SkjXABPNDdw+efr1uEbUN3diuBhE6h
qCs43H/xrfQtkPP9A5b4dp+33hINyU15M2CJNpH/5e/8mFVMG+0Y58JFi/ye
hPng2887vVrQ6A8ewF7XbQNEHKHKkrCd+BS/A6KcJiEjn/cAXYICfZ736KNL
Xh42bAmXjOkRkz0kq0kXrsUjrxBrb8wWz/AX2h291X9w5JH19bvu6jHXvY/9
53Atynak6cOPPEKAQqhEDhCAjC7Q/exPfWoFNFf+bYGcfBeAjCExNbA8EAMI
iUAmDgo+BSB7xR9qubxO1EM3nF6CTzngBlwEV35t8OCZ+D5wpm1zEMTfnHoZ
inhn/rXX1t/dccf6F88+W77Dc2w6x8Zctc9AqAko3I/8XpFZt/50773nzlmw
YLWnV/lvv/L7GBuIwHlCWuBrjEXkUAr/g+H0RQUkhCVzSgFqRNOmUPObUgPe
YFPBGDDK2r32mul2Yn1H00+qwB0ADgSkm9OqSkR91eGH158dN07aiX65GfiZ
9irDArRMFMUqlo8du/GHhx02VdCmI4N6ge+AOJUwDcwEZROYVcnl8NgJdM8K
/BQ7QKNoJzqgG7L/MvCwHWjjz3ePOWaJ2+olbZHjNPm0CkLE0ABgCYhV/A0A
AxJoFyKqNMW+zhw2gZqwcszB8YUnF8yZ80hnHvkwRfyNYYEOGA6fU6Vpjnw1
Yhk0DdIRPvOL7OBkuSWYNBbG1y0sKbSw7QDYAW++Kfp8gGX209aUBMimWyOS
gA8JM2kRALcJMoR1U2grP/QzqVCVIZxa4wwoBNbtueescxYvXhfoudknZGmk
BIHgFrlhG0GByaOFawY+EEewKGwYN9AvQBZZU8lnFohZtcjqW5+aNCmeRYKo
YRfEZINeKt2kcz/7du4sEQAMi2oIvpVZtoClBaBiDsB3gARzqagyVH9i8uT1
bw8aNBPfteffDjuK/mQ3o6QSRofXrej2cBS9W5WelrTNbLhshSJ8S9QgSnhW
4wL54/BxCRTq9swnlShv+VnougNDY1GUlXgHNAbkwUpAg4Rzom4H0sa3JLYA
RmzfK8ce+wgo3YCx/HZrCjJhAi2CGZFiRNThrxSWqnhHYS8KNNqptoRegAtU
QQhOVZ4FkFFg64m9PfOeX1w79X6iNKiIsMa/YTbUIfCDHffNbVieHr4CQQC1
ZPFBdfjKqadO/8aJJ26QneuIO6fvGS0af0fA+TlidpSIfzQMcmf/WXL43923
YVGCl+nio21xB98GQFILKBr6lvNc7vRrLLTJVBKY76cr3exmP9VbkNHWx3y4
S2YNwRrRaGps+FAmuJ+S3nwHwZU9vF6a4D6+DRP7PE3FxpXgfx+YmeDevi2x
yOU/lAmGcQB77EEPr5cmuJduUrRrycv9zIe7Zib4fiWVJx07eKSHD2WCe2W6
aDZOMsH3+bbEUCMv9zcf7pbpfU9lFYscjS3t4UOZYBgHuyQWjZ7GSSY4yLfB
XABrcvxwgPkw0Mxnp02bdsILL7wgFjDfWYXOoOtuvvlmmNeNgdcOWsUk3dlo
1//cbrvtnEa+9yc//vGPFwPjszcPOOCAX+62225/7NOnz83XXXdd0dBRAC/8
EBt22GEH8WK2yH9bN/Xq1evq2267Td7YaSvfawBPGGDlkCFD6nSTtvr/uqP4
vurg2XEr32tAkIGR3vGifFLxHzqFZk+1E++wle81w8An4UIqzcwdCg739BtX
sMX3mg0g/p+DDz7YwhYbd9FDDz1k9wDv/WrnnXe2770zcODA1A/TiKJiTF44
Y8YMdIpZHvvKK684cT1LMM93XgPdXvyZz3zmvssvv/x3/fv3//rJJ58MNG5A
HI+9bSkN1sHV16NPWa0HeS1lWPU6HSzyx7aNFJFw4KjNrASrlb+2i+SFNhkr
vNcoLxon3YpFgkn5vzJMa5sIabBPQb7ce80GSIRCUJqwomHiynN/9Y8sFgPI
DoT3sI0wTvQ4QMLVola2GVuBWRcev0TIYABpi+atkrMvMwDwQzG2GmeLAYQX
9omDYrXiMKvF91LB0ci6Un4ZVuDN3+F/lfBf+B484ogZmYb22FzP7r0/YdWc
OjVB3/M/4qZq4RjGGOxGr2V6/7/GySfY6CdfS+zWdVHoBOtbdDrBhRfM+/Ta
GBdhgltefap1W+eIcSu2cFRjmTcz8Fph48yTIfy+dgawq+MiFY9lt07VevWU
VP0pvJYqG9H7FoEQHUoB5HFktFQbp5xsay381xrdDUupcl1h1nOeXY1HgsnB
s5S4rKvKAuK8Um9TGAJtlca5JZ5Ij3J9FYtdZ6A/ZbENjpBlXcUR7v+Onz4b
74nJXPSOGmdl3JeJh4gQRFtr46wes5ETHo96hw9lOcI5Zs8+rZhWGHx0uHXL
UX5u5z22oXeGG7UozIw3OuBeNZmfgZoNYwl8FWdEPc57qInKA0UL5yCcbIxp
V49Ofql9xWJw76Q49ir5Y1eMiaPTgjlzNhdzJh9OOMG2geOnR4BO8j8c/KSr
urfhhPOUIgJ3wfpuwirxKf0SxV/MAkMIAz0kcvYOx1agiZOqN/Aw3KJ8UM7M
skjf1o9H92Lzjw1LkXmMKS5/cFHXRz9a/8l++80vbrryn92yhxbzXpPh5Ojl
V9mLTJgOnJHf+lb9hnnz6k9PnOjfs755JQPDwkIbrYryjV2qf17BUQ62FPzg
pBiWRQus9YXABEeAh7bd8Q4NaQJAN9wlDz74yuNTpnzH/ai1D2Aa8dJL9buu
vLJerLjlYuKYWow2ruoq9ndtF9xXL165wz8fP/v2L5x77hynUy4trj7d09K5
nxSThLFk4Jwrh1Hf1hfDvTRixAQ57Xdd31Xs7Lo6+3ax/oodwULO70rq9TZA
DDiEQ7Wu/H8MEP3zdhqcaBvDtHD0Tv0cYs/Ca3A64V9ZuH+2+78eckjdqfvq
skQXK0aNevPdHXf88/KxY+V9bAq6feGEE+o/e//768VJJwWOdN4yp+jVv/qh
Dznlqpf7u9ZV9OpTLwYOXFvs2AlBuaDo0392MWnSN4pBfYpiwP5rl510kkAj
TA0rBFzhX3AnETu1nUBYTpes/75fv/qfOzunf3v48A3Tu7vrxeG7gmyXfe6C
C+rF9OkhViA445VZ7rtMzbqWEutlu2Qr/VBCdBbIQRWgkQyGR9opsQL/+Y60
Zw9+7TU1L8GoBfg7dbv+/aOOUuMx9tJh1b3u6PMXdxyClUoIy62sftn999cX
XXhh3WGeX8WEglpLTTBw253r7kwm6FTsttsTaKU20nevVXDUuH0T9hLYQRm2
d19xhdAFJu+OMoBp/fnRo+tv7bPP3LcHDVrtdPx6MXbs2uLI7ePIR91CuEZ1
at90Ysvi4xJogThq1s2AFnABdeMdmoejg6SDRmYwA+AwLFB05cIp9cCllxJZ
dsGzn++xxxwHor+4U42AHngNmNDyh9nhbeu7BX9yixdXoTtubfxT795rnpg8
+e8YY8Izz6yBw2rGwoV/JR344bYpwxa7iFdAMo4J1Ek63xo5sssdE1e8OnSo
tGFou6zmXsecRzF1eFiABmEBKHUHwz/w1XfVkZjX696JQW+fm52lul0cHm92
wJ2GVdx0/fUCSPxOU6gFJD1zA995R9oAyL9Wq3/7W2vrHx2O/80BUvYV4zpc
f/lLZ5zx+S0AkuiAT478wQ/qrw0eXJ91zz11JwKX/Gb77Zd85dRT1ZH1/wYg
vcGzQjM1MBLdB4ykM0ICOere2XD1bbdJG7Bu3g03cIhBODu5Rc/+xe67ixsV
GAZAgm2VMZIbRK+D46r/8z/t7e+6FQs2A3UwFa7YqSpf+cGRR/4K1E7mAsih
b0KyRXa1N/gJsM91J1N0Xa74z+2263KndV0K9xHTeo+AJPsTiDRipHp2gI1F
i2gnx6o9PPwAFYle+7z1lkzzm8cfL6jn2KXaz3F8crrIfNC1Y1rCA8AyIZNA
gA4qClHKPLBf18dm1+d3/ruj469r99pLdgJ9AFp0L+KbNw488A23g78AJAFp
+G7RN5gkhROgjTF+tP/+dddfHfLzs9OmrX70vPPmcncwX7B6mUtwy8FbQ79G
5JBNmlvpS5WVN0K1zXpLCGH13fqd2Q64RGgAut895pg6pC+EDlaPPvA+j3ZX
3H23iARABwT64CWXyA44jVH68d3uCXEIpvqHvn1vdz8bNtdq9X854ggBEjYE
NI+p0bnoALH59UMP/a6Tb+uBwgCowz/pWiV+3bsNsKl/7NNHUN1pbRuemjRp
+q3XXON9vgFRvNvOQw8QY5SEAWq+GZYU7SkjjRRVRRXyq92ZG0FfLnVNIPKx
r7yi8RlgDPidXBX7es2tt96Jg+7ZX/xifeOAAYIy5MDQRwGB73zwgxxre/Th
iPrn7vvlQC3HSQVaIH5Es4AUsHmMDsP73zjxxL84te6Th77++iaM/9yYMbLR
JV2qE/Nyok10KezSX9raJkAHwJqx2ViPoX677CLXVoqgEVX8L40gZViYjQVi
lJo5uUjIy9BXX42qv3AY0a63BVWhHcsET8U8cCIBfhMU6B9td3zsY3rsw9n/
/ssu+9r5Dz+sUThFi2yA+ALBk51UkfGCgzFoR2K8w5KACSAdHJzwdzBHHPjG
G6JLYxPnLFgAHjD9qjvv9LaWFoBT9PMWfFrV38wJR5hhvXQGDAbpzCE8tVj2
UbV16YVMoQhuukafjbUXB6cST8x2gMRiGWyAif0kvNcYt58ZIHFfBERILJb9
FXk2hwP1Gj+AWDGkq/6N3Sbm4HBASuyU28T1wb4iQ4XhG42jmXkn9qtqnKPa
KbeLwMIAshs1FYMl42hmgCRDoJqB8vbKiKKZ0AR0xYjuJgMkHqdAtonlLvga
EkO2MQPDepsfYOfMS+HDxOwe3ssZshvdYX0bBwBsYfjyf0XYqjVulzgRNVqH
ARKjWrMBck4CwBYfC/bvGhEWE7E2/MQU32SAtgS2XlpEdNw9s6KWzJ406bxm
Z2DJxzsOGzwm/LvJdiJuZpZA0P2lW+a9l1WLmJGiyx15hKrR8fi18ePHY14k
Je/ZxTlvM77HKwe8+eabj0+ZMgXwaFhm8PwwD+2dOXPm/G7ChAlfcvNEl96T
XcOePOewcI3DqD9fdNFFTFWTLqwbPdBTLgPtr4899phmoO0V3/vtbU6db5ap
5jXLxgG2mIb2/q18TzrtNANsF9G9x1y0923lew0DhBVsMSltr618rwmIes5S
23sr3pHObBCHxxVJYnv2wgsvfHf48OGaxLZvfMa0uV8OGzYMnsvGYIsdMzzr
gExbkxmkISMHZrhusw8ToXFgpi3/oUjJg+LYaWZcZpxELTioGbPM4HXSu5d0
5bwM71EI+N0YIJHpNFlhCFctevJyBdxOpGIuiS6Ef8V0Hz+7vzVOISfpm6fq
BMthCALBLgMmTafB3LvU6qjL+9/G6Vg2nE1kChDotj69HlNhMm4p6xT6ayOH
SZbVpv9t9DyV5pRohFubnpObZ2ZOyY4Hk3eck/E/0ank+gnTyvif3muqX9Np
JdiT+txyfSdInOg3/+i8YOvOzCtx7ud8gbnxPOW2JaeOSID/OKx8fEbq02/b
Iqx832FOkfn2lLX2HtBq2wxuRFQPaFSiWMDay742w9N7yEx7D6S3bYaE2ptw
WcwjiMlURNTrmUyyWupsynOfbTNc5XA/RCpWpIvGfKxl6fxkKNv/NhkUOLJo
In3aGz9MtNkjM7TX7MNEah+Z4SXNPkyo4MgMY2z4cECGrI/OwNUYRZIPk1P8
0Rl8aPZhssajM4jd8KE5devWDs5Mv9mHCdoNyQDMW2LMh1Xdxxi1G8/5oVsY
jtXks09mcQ3dVnRHo98uRAOgDfYiajz9FcoxVH43hYOYTMV0FbhlJspF3tN8
zCCcYSeiz7X4fePUbD4Cp4Z+7rryys1PTZoksA9TYxKWTGO3OF1NwMsZGKJN
IMYAdCq1xTD/MDVv6xSXO+yStDkH9gSzqKZ8hah8+jnoYsdMsCCYCTEzm7sB
g5Y7961ywLzRev/Rp43+T9pyrv3+cZoAMJwSJpA+FxmAxastLbhobGRAmY3p
s1J2q7QF9RHTZFC9SdbCa7rlIevUW+/aaPZ3BC+YQjuyvB5iTxKDfr2uIfsw
YiaZGXU5bcMBtOiihx5aWk13VYzflUxbmCWAIT4W/OU5RTsTqgjnfJCAdme2
rEODBepe0li2XQokSLPZghTiUPTt4l+TXIzFKwUHmHpxU6OLFmBn5ibg4zvu
pJ+ME2M8Bn/HQFhvi+JJVLBz4OsBpJyJ8AAPUohHoSK+axMw+B0z8LzBOQ9P
K83K8MwkaaMMgJAQ8xMBFbNM6w8lPL2+USESMHjBT6hPOT2ZmU9AZXrG6DJR
QVj7xwAoqO8FLSw4mglEngKgtqYLkU+awM4KdH0W6hygK/QBOKmbtQQk2ZcU
SMQcEmYAUpLQ7FqIfKBpPuuOjlw/q38QSPLXtpERdgdnfpyOLkDYRRPgWKVF
n7VH2APe+OkOWVZ4Z4vwqZKxEUampkCfcogBwA7xSopUz5FF+6BJMgGeTnkB
TEsPzwLQNJ8xAq1KlsN5mhz/DrIoigdAgt6iEvlJzNQXzj1XNLgSBCuWmYuE
AghLqXKCugn4auRjWAr3NUZC9CH20XFqeTnlMfdYdcsAQaZ7ceUWgj08a03G
DLVGuAKmHmOqUV3ooMuP0yQfYgyBBSKe/eshh3Q5XrmijIbM4yRVYRpAGJOa
SKJKZUO7DcJCi82Xj7luvfCYGAgsYuSQfVXPJp5cK8z+JZxa881GJdF8RI9/
7cQ/cjSKAYwctZl2rF590XWfxkeyApTCwNfceuuKVYcf3sVmD7tOxlUB5twu
QoP7g/bfW7hJpmNJ0esPkmCUIXeC0o06O0bDc0yAOgqPGuFIn6TsVzJtJhtS
i6Nsm1KMcbu3EpmkHoRRUDSi1CgdaBPECjCDoF98zjmz2O5lQgfVVzIi6vTY
IFW2rS4f/KzJaSwk72EKzdzatpIGIFhO/sS3ehoK34JVH/Dmm5ukvTOSpkYw
5/rLzDU5cg5XQiqdpWzkd2+FbTyjj9A9KJmwMx8m59cRuik9VIXrnZnWCF1y
yZid+TA5ch7n2xrNCTZ6vJcCPh5yRypJlMwJmQ+TNYYPG80JmQ8Tf2/4sNGc
YD/szABilG9rTHf8p8YPE9CPyiBw/kM5j5/gX280ImTGSTwKoxQ5Sx5q+2FH
ZmWjMztab/wmgfXoZlidfpNs7OjMPma+SU4Jo5vhchrelmznic3QuCEkLq5n
TAag/9f4TRImMCazxsw3CTcYkxnbfmPiNJQRjM2sMfNNgjEnZbD1743fJEh5
UqYt802ynpMyY9tvcmn1J2faMt8keDIug6N/a/wmwcdxmTb7TbQ0iNP8K6ee
eir6Hp8Z3n4Wil0wQRe5m0i1lOTd8C0cnIsuvPBCAZP9NgiQLebhnhTH+NH+
++//587OzrV77bWXjPG/jf1tMe12zFaOu9n0/U+RjMoZt/+xyy67lPKmxA6o
AjyisapWFKhq7MNffXUMUW1EpwhuFCh4P/7AB4bYcZM1/aURDpnk3SpybRHo
wJgN+b6qrEYVaBOjFG1hYc7QgxidyjnTOliGgZ7/wrdOdr/x3x0dO9l1JBnL
mXVkcon7bBwwYODl9923AvNn9Mwrxx575pfOOGP++K99bTljeqhji/UhJDdi
Tarv1X2cM+YekoDwJ+0nxtTHA7LsVt+4e1KmBH/1oErh3KBtoX4X1Kijv/e9
TWAWmD2I+a4rr5z9X9tsM6SoesgkqdYWMr7f/mAa/3LEEUe8PWjQoK+NH3+a
I9pVPMBxZfj7wUsuWQlmjYAACJS7r7jiSdSN8yuu2aBv/NAAE85x1IWZ6WDq
bfQB3OwZn0H8WiWl3mjbK9cT4nus4xZq5Cja1et1e/4P1rZ93npr3VOTJj35
s/e/f7bjOmc6qu+a8vjjL5Miuj760XWOug8ODODdHXfcUfn45gZQ9korWKTn
N4xqK7WZBaxzYH/EMb6Z4N3uYLToMxdfvMbXHanxcy6EcacBDXG6Iuh4eI/x
nK3WVhEGbGNAL08cyTErpP6wjUcJpmPRVG1tDegDbQPfeWczhAKEFoDgFjXr
9UMPfWTmpz+9Bu9gJebUg8R6GIPXI7H+rX322ccdpw+55MEHH/zfBrimsj2c
wHlA4slHph8qZeH8iaUDtd3wS7G9jtFNfeGEE7qeHz16JQEaXJI4KGHFtjZV
YSCoaF1K/hFe1SL/remBJvwQYsHSRj8QXg4n0PUQh1CkwWKxOmAWWI6afEOE
Mwhfq0vWY5IPh6SmkAFcokiFUyTP7fgBNvkZ9mapIi4As1w4Y8bGMc89t+Kl
ESPmO/ZwGlgMRgOeVyMfpBWAdhggZA4Bg3Zgy6kB7AFESSm7QMnkFm6TV33/
qKMWOSKZDiLBuuT8EciAVRUJInwXTVe1MsSoC2YglqjKQS8hB+S53RyO+/Hw
bWfNYH4s/nMXXLAZsgUbBO4MdRg7InpMmB7R1TIpmFGijT86aAI7tQbd0pQ6
LfFimJuvu245kmOXjx17muMsNzpALn34/PM3tKU7iO5ovDOmILoyrHhKdEbL
B6OFP+rVYcbkfZQLxrCRWsVbIpoy7wDT8q9uA7USu4/tw15Bn3OfriN/5F6x
FhSzZYLTS28UaEnFEk32ZladDk/XgIE5VWcWhnPM6gH3zkpwd2v4DaXryD1Y
pFTyhqSrFpOqkajOGdAlUbz+mzauiXqVddBYeydAZR01LCwo/Mur8wOA24DZ
t4cPn+W47nSHew84ZFhtq49hO/D3hUuWNFya4IunCc/rT3OaA8ym+ddeqxoI
jBYrRo168oZ589aRYZGBkfsArTz77SA3Zo0xKjks8GuXlBwhMuBLTlrGlyoT
/vEdQwtTz0J95y3E07VdxdHF0OKoiQIyP71e2FeQy2uDBy9HzuS3Ro48E8Ng
p5BYf9sNN5RjcPsjtvbzV121CCu96KGH1sHi5HSJ2Q7iZzoe1nXF3XerjgF2
aOvDgQ699iJpaSpYPJp1MI2QP5T+rJxoOEElMQxpMY+mFURs6Y8NjbDtbgzS
66Avz+9ZjFhiu8i9YBmmXKM1Vt+/6TV5z2v37Wb7Va91gvu09aNGjUKIsQ/+
7fjdyJFjXh069Oz7L7tsFox5UP7LDnaqPHoQ8rxfngNeIi464rDEQIuFEEtA
2iBpUhNIXHCsm9HzPQcWruE4mI0ks3VA2tmPiQgzMS8/HzdunMAkhEX/+rLL
Ljvq+9//vrwRAssTK4zpu2Kn2MO9AJlpJwYKTrExYCtXwyYtJxPOQVsMwJYQ
muQ+AjtaezJrvwGZWSeZDh2lGcZNa0vuC7DIirGCs7zHqO5QPC9JGWrJjJe7
RyEz70Tkdib92DC9WlIw38zZu6c1bnyTOxRqTPl+GakdRE9avUS7bH61gp16
yTLdO8y9VLQgIRkz42C0eMbWK/qAcvSyklaOStZ7FnL3EKSTTGRK72RNFrTV
uE7zrIdZZpTvhppIvG5hYzKjREnoMba0ITq7EuIjh24ZjBWhg9unDSmSeh2N
cwwoFeb4f5HzaG5AmfjsfRR2XzjHGNq8pTmKwJk+fQy7JXk2IJHhsf+VTDQx
dHdwieULbzx25CLmc5PbP0rEYsOGx6SrJoUjerps4V0zUWFsBzYfK2Fc/52s
MGHu+2eESqXZqv1c9szQQRjh73GzVeodkBlB0wW2IP4GZfhCOlSyXT0OtQWR
tWeGcf45GSoh0NxQOZkSuk08YGm3CXd6T90KDgRw/C3DlA/sCRxbYMx7ZsD7
52SoxMrS41BbuMVmzwzSpEMlkA+hsbCqsPoEh8pgcXpDTXBSQEmG4idK326Z
bdiUDJ9osnvrbEV/limE4KO0bp9kEkYTLAVt2E2YHNQgvGtmmWEK/5tZWYAA
TgIaNdiqlFI/8I03fEnJwKChnmpwqKGuICkAiG6arHbN7G06k0SPC6naPKT7
zHJlD2U7YUdymUfdlzqgzealESNWPzF58lyKzzSSK2Cr5Yqj0hMtY5pEcd81
Qw1hGb+L+6co0KHLiKfBkPydRGUH3d9GPQKwZWNzsFPLmZh1s+v+4g2sFjO8
86qrVuN0SP+MBuQG0zAtVPwhNOxhV2NFdsug6Z+S1eL4rNa6jszrAsQW9NYr
IhewQuATihPaYEWuPxaA6sUIbtodeKjjGic884ysWeZci8jHo6kIsnDRAWGm
GBQyxHA00+2oZrYtJDDgyKYF5jxNh3uDlHLlcYBFrpgmtkpP0x2KUNGY7SFV
tVfBqFmkNTKakumlZmNX3NIEJOjPQ6SN3iN80rDzAdeJePLXthFRy7HygMpt
V1/dJRDdJtKJTjNAxnunO8qmfrSyfJ123aIcIpJba0qC9hYG8LMbP/GJRWxv
SfddAFFLuUhESG+MUaeMB3iFMVEsSRSs+GVys7e4vHDCCatXH3TQXKwg2N/s
fSVl6xjbxCrYrhxY9sMumEYAu+VJKH4wZbBWvSlYsm7hjBmzMDWswGRYKMFU
Mm1hCExbi9f/u9/Cdzz2WF8DzRvKJ6KVPwYc9rB1EADnLF68srR1eJXFCnn8
5Sz5Q+5g/BJCumr6DhylHBfPaTeRF/gdr2IFDqlW33f55XOZKMY0Floxc7JB
phPMiLaOGvWIJl7D1iQLJJiymKxAWzjjfWHvg4VT/n6PWQuYu7LpsLH/Efkx
Lc90IkXLmP9hoHql+Z5CGsIDzPa2dDJCfnJDkTHnK036TWuzcYq0z5ZqLnUk
tQTrPlScbgHVKUOJMXK8kichuX3Lv9pGgydJn8MbJaMvp0dRSU4FCNJVTPeJ
U5Pm3zBv3kpzedk/lA4R9upXfkH2ypTosWq1FbaydBc0H552kmc+XSy6wUu3
A6Ub5aHVrxyCS0WDXJFtDIQnGci/waYMtUwVlY50LEtiiT4bqJs38DCiuXTt
U+JmC5xSZXu9rpSMafKw+R6zCZJso3STKJqpt5ZuyGrKHMMmMSi0cZN8tDcv
9invU8IFo/Yhs5agBOPj4g1c9DgAkynhJBDdLxUIjBgUY56uUb0lV0I3GDrc
NmidupkED6onlFtUg6x7Vqn4PW5JkheQbEmVsCdbFsd6EAWkYiII4AMxy5XY
vVly1llzb77uutXJs8BseGhiFLuR2uo03UW3IJ50do1ShooFI9m3xHjsJVSm
uqwedltj19zZEnXln5Uo3zIiLzTaqLxxpsmVkC2pCKbWDkzBe57+qywzjYm6
ljPvv+yyzeQN9kYpqkmEq7wReANJTfjKwObAJQDpsxLRH/afIrh8Zx82LXWf
lgxcJv4D/RInLHSzz3KpNQl0teiwvVquuyGdRdhcKaimk8oDV2PNLPZZZwQg
3ff2fK0HtBxQfVtbWQiQqxqRWUu07LpPQcE0fJG4qt5I5AW5r84UsBZYxy7L
cO3hmSbcCEGsM3BtgWZrrBkMi7MfalJGYIy8/JMT9RfaVijb+MifH/RyQytn
xIXXFIjtSWqGpwblIPGyqWqSiV2vBwT2hGTv1lPzStA5eKKxvDNpM4cu7KM9
u/0lg/OHNl1JK3P1zFlOwZeWIJfr68jL8G9rIzaUUyHxiV7KFczISVtgi9iC
t/38fU52aqo5LDP/w5RRRzNdktadGq166CIJIU+7SCxwPXSRtKVdJBM8TIEe
CzgcprIxWvRCF/+dgcXhitBH+KdJ+bjfJR8m02r4MHETpR8mJpSGDxNLf/ph
d0PNDPthYrcPH/45s/wj9MNQayK5PWVj8mHjGn2lwzkLFiyYsXDhQparSAgi
7SLxjfjt0GBy3AT165122kkCveO80sknToJAbFuM7A77nljUw7w2ZcAVXt9i
YPmhGZxJu02271Dlopt/vscee9iY6N9sv/32Q1999dWm5PZfSbcJOh3sKR6L
Y9Dvjz/wgQ/4mOIqYoU/d8EFF6A30IKg7yEZkgsj/ClOUj0C3sOAA8IajgAw
sjsGbHsQddj7nPCIn2DS2HrTZco30hkkmxVLnMTcs5DsSJsehmK4GUzwnF3M
TtX4VaC4eITClSuYBRATswR+C+7mvHN2hoKbA5QIouXOlJ1lqDOPBpjjnVdd
JcGRiIZheKFfSo1xNFg2xoTAx7yDfgexpFZRY3rUUXI5Kr9NgJpQZn/Fgqhm
mVzKEJZLG6FcwYU1w1gLbJr01FNLvzZ+/AZR/8IVXBgWKgrfSTehlQFUdijI
JA2q74yrUmGby9YJq/pjBlnN3R6ZQiOAIasXlAsIGxVAjHn6nkdkUfmMrluz
AFl1+OEz777iiiVoM9nDqnn4c01HU3qoex+FACIcTTlzvx5lNeVLP3X6oiC1
ZfhOCqwkzCVsLaM6aUqyh5fySdzUkuiX5OnX68m9ykAFTANoAAgBUoAOjer2
DKWKm3c19LV3A+TSCkY//7wS7Lwbbuj69vDhq4BH0RfZoL8lUw08wSrI2FyL
FIC+JkfXMkIihWrCSkO4Lk+H6MoeWIL6npzG6/7eCu97k/JaCQBB0hhC5EFY
pQLS4AJXKXTrKy/2nEUQDkXgPDfMm7fCcccbn5g8eSrGYuqchaYxyp4Vbrch
NdjK5Zg+kwhK1kw5KrdlZPl/JvBMhF8oeWC3C5gZ7rwpW054WzYLJOG68oUz
Zix/4NJLZ1s41rYMRkGW4I1sdsEbzf7FmH2Di729KD7MuoCJ4W/Hd9/diB1t
EX9X63mPProUkxM0NSGsVmNnAYRyRoEsti2jDQQw/kH5RVRNghmmFm4PQDfx
fo5e5epAodjFxmtuvXU5rDrrd9116s3XXfeApG51NIcd+xEUJOwa7xWqFfNO
crAaIM7kYulSrQ5X8lKZw5Iw3CvvumsRpuKAciPEgYR4q/BJXD1ABFPNoRF0
IsJ/mwAsUUhCJRfaP/hjSo508tnIb31LRfdLI0ZM/ZcjjnjATXU1sSh4vsBY
aXgoM8Lk3uz+CdL5gA2/UaDqZcWFrnWv4dFUY0Ns6rG0E8+QZSOWW+Iq5jng
XwiFSkrHtBzjd3OpWY6OE1UtRcDkwOfhuQ2tLJCl3cZog6dUgX542GHzHQzP
VHWs7k2gLBRTgimaabqyMMUnalsMylom8nUPQdD9XNuBo3TRxQMPJBf+leuR
sWwFGQDtGsBILAFCFgLK8lJWkMGenRVuj7FzLethiWaTQjbR8sJFeZwiHXcY
7vEpUzavGDXqZfhbuN2Oq6zs1kyNCo3mBGx7bLZALZkUBQ7blphjjCZrLzYv
9Tg5aqqW8ygmTFhWjC7MLZBV67Sl2kkrpzUV0d8JdRJMFDwUP/gdaqgY0UpW
s0Q1CjwrqdPwGw/S36veEHV9/3ofIus+b721mRkfz40Zc+aP9t//dte+kgo5
1RMTSZKKkY4IPc2iNEqp+lp9EGPvhnDepTd6aN64VB1HxaxZyxzuFsVBV6w1
kqscL0DdQ6DpEasXEBKIufqgg6bDx/TdY45ZAdcpFdYkpCFXzyCFXGIZCIcd
QgtIx2M/8PiIwP9tXOjyeX5xS5l/Wyk2bFhWjHKNo68zabltNBgSK/AI4DMg
lto8cxYsWO3m3/XysGFTP3PxxbeDrzM/oDPD6sNywq0F5Tus25Q1riTXtCs6
OqwoicYt3z2aBhGGIvP4Gr1gHuAVYJfQTWLMSxTfYYr+DFpleXpk/Pxh/Pjx
dyATKbBwcHPOk+mK6OpITqQhPrkcSawTTSJDg3wJ9wAASGDtVPBx7gMFBdaV
3A0ewri9rM3Vwm9njXtrxgAH5dwHl4AY45Ybw9Sb1J3dLWoROFmD0iG1OEJr
BOyvTz311A1XXnklU6kY/hvmnymhX/nDiBEjrNnhWMI1H74cBsvWr/WRt+2A
BDN0gW3APgu53OUA3psXJEW2Ev8vrrrqKmV/l/tZWCz87dChQ7E2vp9cDfAf
CRi2mAby0TiNn06cONFOI7kQIOm2DZczbMDruVyNK7dy6AQQiF2Q25+P+e53
v4ucip+dfPLJb48cOVKMQFf5d3IpIn+87LLLTnvmmWeKX/vuPAlKyBowR6R6
4PXJWSZ0iefLHBn82uEGZgxy0Atowgw9Zeh9LqagWmqs+ZjvMq054/NjtcsA
R4+sctDX+3SqGRbuu0yN2rH6QezWxzcFGCjblG5NsJuy/6sywjQ6pTfojSk+
8i3AQbrQ64XaIlD0vH1VhmvHSq8b9QaeX/puQ+wOFlsSTKmF+8oMYHIX+/zC
d+thAcVkidpXvDypJEfWJvdxz8jsbFtmtJ/70TyIxPQlbjX8FTxp6WXxkXnP
yqyxqqsydx/jfwNPKF5cty54g34RqZXZ4+Gep7a0alE9vfv68sxm9ZRjt+np
aRyZjrSfx6FpFWOuGZiERFQb7Ew0+Mt8W+Ln0eEbEg8qwpBxd/RhU+aCQoJf
+e10E4QxmHvoGy5bsPrupXGX1EDZqfPw7H/a05v0Cqef+SHXpcgr3DAcUZLK
RemQftE+WjZ3aUPNLpoAxbA+Cj/40VNKzJUstyH8FEwzMgCJteIb79WOBsp4
f9VP/TR+lmF74SyR1HzTrEejnsyI/E0NmXpjhdGxWjPDv+WHXxuRC7AX9ucV
72pkMFvI4pJpiAmht92hJH8qHdxLuwCClD97w2fV3IvWc3rWjMyW1TKTbMlM
rZJOTajtJ35qHjytVAaEg/iraSpGwKWpyCadJMwqkYVBd/az1/sy9BKJWobr
/NhPZk2UDHgkk/F+hjSn5/KMwMmipR8xm3Lwph9ypYI1xjO36XZFPh7D6Jao
dDHFz3HmFDNT74x0uTzCWMsH7JiZ0ht+St9VSokWnWgdkHOktSJgKJUVvVXc
RDNdr8zwl2emuVNmSl5gFS/4RzhVl+LkNJ7O+Ek6cGbTKJy6P7piyjjy6gWK
PgsimhlqGDiWRfRRZxixqlgRgx5NXI5a0HrphGJ6QVhnYgLwlFdLKnjVJchT
1t0r7qruvinmpXFYyy1o2lmVlcXG0coIMDzzkOmPxzblAhCxEXIYgROiFYZk
i8kZy1E304gqmbYWZXfRHhF9GtHAHEz5ifJQ92YkPO8VqUM9dmdF+lVDVbjy
KSkwZqo+6K52xK1sVnRMVh9g63FQq6BgdXQ4YUomfcea41h/mztFM7DQs6mC
oqw0B8AegEpzmGQFxEp8cV8DUNP6oN58COtaAGqSGzIpDqc4HkryUM2qhdKs
wajPKmazP/UpH0Io5GTiuZLKaCbG66GLLlo0Y+HCJVxi4topxT7ZeZDQyQDi
wSHGG4Z9+6bnxYyq4o/N5kg2LdzHxffp70x0s2rTTerFNiZLEILsH/2WwrD0
Km5rvcOcPnfBBQ+c//DDy202Q3e4YsFCAsICP/Ee19SrPDECUjc5BB9Qt6a1
VQBfukr92XHj5L7jFj8/9d4ZNGTlFoNyFVLKnAULlkAm5MySkS690dtgLEuB
MTuEkf+xyEhEci/Xi2/5R/TUCddvHpDczrsEbP6Q1UxrTXe5k20AM43ULOdN
m23kChr6bNOFsH6UinH08oAFozqJSp5NDEevNL71NIaJ+EKtemtIGszXyvLx
NsYcU1aTbzCYk4ZD7LqIH4YxSHVCv3L1G3hgyRbhBvDPXHxxUrbOCAeVvlkM
MHU6cqjBTCuLGtxgLI2ILlGrmTET1NBL7YnDATsSSRgt/bog8JPE7GKqN+I3
ooOfX+9yc+AfMqlvjRwp11PjbnHyodZIBSUiEixxn6x5fMqU2cY8Uq69XWOp
91q4q4d+mJZM16GwLw3zvtae74zwsUpVknEasnyI64xNfvG44+TISIkoZOYx
Rm5msDGw2LVXhw6VO+6/fvLJtiBfq61wVuYjxAIT42sfhaL6XAEVFxbSM7ih
xLzMSgglNKzNhvgGyW71SBaoonDAoE9NmhQPk6GYPkbCM/wb8aOhOfiisK9A
DwJGXIcmhUjnbXDD8ebNLw8bdhoVTpKD90dluKuv0Fwjk8Ji7W0CIaOB+2ir
ZVrX3mX337/pF7vvfibRjYmKJqpBtzGYPqCz4d71l0aMMOUEt4JBxD1PH4QN
7w4+XNZqYgTQFje8zbIrmxRokv06qbhgxoxcx3dAjOVjx652q5EjdLjiCl0R
tGbDmzRjwNUHHaSQNntdFqbcEPcjhBYULyAhVggsN8Ixt+NWVFGuRkbdq0xl
TImg/nLlXXetQnyOTQfLbHP1nMWLZZvB4zCcYVIdyd1Mda8c18JFNSW+L07U
8x59dMmdoTqa3XLAjcl8xMropZOTkU4rbHko9JZcnNES5aZNLQzy0J7CWa4A
kV7f+eAHbxz09tubYjl3eSQ4Vsm0hQMlRnEIU//GiScqGgDpQiRHuZAqls8k
LLTDi4hDc9h3aqcsQmCC/hTZfeFp1eLwOrhC0GDKt9WwR4Ydfm38+CVuvks6
m2/14nPOqf9q550Vq8xtXx0MS7BlDqiylbeazxZdeOFSFL0zW13F1qryX68n
yfBJsnbQ9ldG4W3TFRgRYQ6I8s6COXNUTUZXirGB/KmZkw8CU3mzVsA8sRYG
MxOGpEwgAZkqu1iIHl3HphoJaxiXInuoajGuibB25DXfdbUyRKGEEp560vBh
DH6dmIBTNEVLQ7dkRKZ6reaCkdrRH5DfR0K0W583H4VZSJmB9hSn8NgWGSY4
yHLCXvnCc6mTxJui2myNTLRwQItiSb59wGDGkVzy4IPeOuvh02mz4am7ED8s
ix+bsgnpvkVYVh+LTlQsqDMS21l4Qk2QbVGyY2oMXzLb045lrDr8cGWMlk+j
PxPYpvE5pdAKE1VaYZv711xPI3mEfKSANVxDLSVhb77nHyWepp3i62piLAkc
w1fVpmATjsjmTv3KV8TSbNDXxlfabtC1bvPYVHJT9WCipUko7rRF4one+O6E
F17YgAh42ndCuUxaGSyjY3EDVh6wjEeLVnpsbEsLVsZvzVm9atvUadknQku/
D5vwmn8Ex5IaVcMt9BiasoLAZcIuXap9Mq/GSzDKgO5rCw1wJklcURCE+PuV
Y499+V+OOAIiqW5ymWk9tCY/AE/2JViZE2+tTzmhlRncGY/EsxhuaU9s7VPi
UApbY2HSjGVzdlTTaWhDBKeaAIPTCu9Z8sY3aNs5zlhdAK/4Gb8aZ0xzaEiF
adVESfx1sW9LzG8htyNxc3zHd/uKIlg0Nh2iWxZdzxfF4Ut5MuLY0W59plPo
XbuVmRyqMIoW6tBt4kw9KNPtt323vndxfagvMCRmJU6YCyOjV2ZycKbbl3y3
346z0CiAIzJwvFAZRPQRHJLp9kXf7UuZbnN3KoduEy/ooWm3sjJvUgi9yyPM
Th4dpTw7eoWnxz1IU/xKvjh/OKEtK0GSozPbMz12oe7II9KVSrcePKH3FKUH
R2SC7T12K6euozKdeT8DlWogu1L0Mb4t8Q1PU8ER3YW5bp/33UrvLSAjH8aU
pu1NyyDY0ZnOvuE7ez4iiRLlsRl8vCDicjfdeEPSbsVP+5zv9rkM/Q/LbMUF
cRvV33VM7FYNBoHjL0+7FWgNzyDOBRm8HRpXoPgdTj/PyD9ttq45WtDlp1jc
NVwklsTjnJ+humMzw3zdDxPyT5hR+Yvdd9/9p3vvvfcdH/vYxzS2ZGQGFz6c
4WbDMsM864f5qn+Uy7v8a7VadTr9HHljpOLw+RnCGZ4Z4GvJAFvMwDwuw5k/
nMGtER4uHIpcJdmOp/3QX4mgKN/8k9xcc1wGXT+c4YfHxaGxi3hmt0aSXZ9K
Vp25yCe9GmZkhgCnZnhmeG/i008/jUuUmqbHPpEMf87ixYuRhmtf/32/fv2U
oo7379115ZVXTnrqqacEeOdlSOT4rdzEL1vAd9CnnkvYBEcSPcyvTDKHcR0T
0mcVmOf4YbG3Ux5//HEJHjp+Kzc1TMWjQqr2xap50eU/vDkdJAA+M063IdH5
+K3c9DC1J+NKwM5EUYt+1ChShm0l8Kds5RICus+74YYbfrnbbrvZ9/7Yp08f
II3FpSciPmiMiYk8UIF67FZuzJStXI5fdif6Y/RwGZFwPxmZYZjtl+NsVenr
E2WJSrQw25dGjBjR416dvpWr+mBEVZUCJvhQ28LePx5Zjkr3EKSGLl844YS5
x7344kbWg9Ejh9CVLiee5Xz1V8kcR3+3XnPNNbhwrTVu6+X33XefvHRGcyzF
J7ryACHAXMPL2lORKivySym+lBHEPvVJPDvLx45dh0uy0G7qx+J8JKcMc00p
Dj5yRtpD2pAKsw4YoGKvLqarBBMGv/baa5gRiGhKnOQN8+bNW7/rrruGBVZA
F18+/fTTQfbYqqER5Drpzswa/eKKx/wjJkmJaA/eKx5jefQ09lAtPGgugzjr
c+vkkIRsuVuOihFYR3cVn3jAW46qCn+x9xjbr1gN1OXoC65IogOWhe3HnDsi
49MQPK+O9gZCAqAAVjaZvu6NfEwF2FeRNRbi7Rs5gNJUyBax71koeugVS6Kg
xySMaUedzcagsm3iRWM83ILViT194DvvbHBUO7cYNerF4sABRbHHkBjOs/rT
F0ty4t3qrJYSrPZKDxyrjXkoCT7qVDg2ZOdbEwV9C1gOhAMUCcDQeGPLYWhU
9YXiJkaGAEyUkOIYOrAJW4jtQPtecXQAR+xkZkZazrmiq1mqsiQUH2Q8gEl5
isjuN6j4YhRFyuP9jKQaEv0FWBUtIKZycT8NLB6SWnyRmlRMHHqwezapOG12
9Fdt2rSsmOxaz3uMwNREVl4bQlMVAU9TodiO4vWuMQrKFGYs+U8qTDzDZtW0
fpjGAAm6tWdA8KHIMkBqoqGFkqr0auNdkKNxLSqqbJtpC/wwqURtNhTUEKNZ
WqAJh2Du5BbD8jb6/SsWZ5SdTCXi7uDViC70vsUt43xs9pxnpXfaGw984w0Z
xUF0pUlo1mhdP/U2mjEpu47+3vfEX2nq0bUm7DHH3IyXvlQsoR39YgziOxgK
qM6Ba5FTDDZWNLCjlDzaHtUBNTJMyLAzz+Jq7JeIgm0C4NvjTpavC8LUsAQM
+9BFFymfAh5rAJtf7gDgpU7N72GdV6uH+7PUa4xhbW4qdkGOrC2Rf5aiiaoE
E/rDMxsr5QOajvJBtdUgmmKSg8Tb5u4p8iex4gtRxJTiVCu2ihsgERL8BY1H
HagB96wOASBM7+7e/G8HHzz/gUsvDZdLx+j3qhKYeo1ifKlstJNf9e988IPe
0eLnlYu/oH4hbi7f1odldvFjC3jSXYjy0kAUQBv8WRiuVHcoBWzZDEsej0Wl
GBcZvnJirxtJwhYrj3xt/PhVtlgyK5cYrNVwVFDS41Om1Hv/6U9Jsd2cO8+3
9aavgRVU2bUN56LeDKQP9IhtLHsrAVoa8kvuLx/HM2FUV3F4csFJwpsYyz20
i9muSVh7wK/P655FS7ZXkhNPX2RZejFp8flLNcNCBLs0VoupU9cWJ++mAeQy
WC1Om4FuUYFrBzIgZu/h889XlcOKOz9wP/q9yve3slwuC7fi2aGvv74elUZd
m7ceB8CxPiH13xbDwJLCnTE8PR4exqawEpWvI3IojTQzdMAISnpd4MxBVIJT
02+k4UFjsytxHqX40V4sVW1Dc/EvPPS/2H33pMg9JXtS8LUes+npBEwqqphM
NrWeBc97gpz16H9kYW/GcwS85eOAHzadqEoELVaI3Gt+x0nAzkcixNVq2U9F
hvq+Ggty91YXmDC4I6VuBm9PA6KI9Fu0aJYkTTsuWY2cHK/QOWSIrh2/U6Ej
38W/eE+qDqomU44YSPzRECCoY3LZ/fcvAkcCGwi8l4wHlBdjLbSWkDDNDnIq
VdPjwdePkOSb2HQ6Y5jlaT/gebt14nJfbeWbgL74FSDAaCALkABCq4TsTDSQ
xvKE3SDPICrpauo+0gIo/JP99ivF+PRLFm4onvpYuW4HBYIJedymjL1Jqd16
LE9NFYqcWp6bzDmTnVVcP3FQUYy7RXPNbBpVwNyHI6x1e7w4SsK4qH2XqpLL
nbHdEhjjtvlIX2kDqybuqTZz93l7F8WgiSaJqmYrbDBfId66KgotFRje46yx
AxXV0SIOh+RrDH38N7+J6L0lrw0eLJUkeHwqI67xqJcQt7fNt4rsYMXnmXbu
9yncouIAaszeemjrHQWwAAnajj/1d+CTJERv84/vKPZ1/3fgqJlwAptwMA3L
xcqotJjQS6g6QEzBnqBclXkqiZ2xKJgO62BZ5dcLwG3LyGjj/ywy0glcHi5T
OCQkujkU+Lwj51zxhICRn0sBKRKtfyr5jHd9W0agFHOnaGIfw0KK1c/6PTxj
vldDBvjLRZXNyTQPuLS4Ppy8QwSMvYkAG2TotnyTgWofKV/XxC6TMVW54u67
l7uNmo4QMNfFps6o2qm8a0kR25xm28vXwsmMu66fKGhjClJY7SmYIpMTqj/L
SOxMceY4DxRHtlG0+6L4bQbDhxb//MxG1EZxq7fWv96ADgiT51fGcIX5SRQm
cJPc0EOiD1VSHmBsXBCAj38xP6h5Gl4WhA/ZPnHUL7sXu2jGLwlRcwJorMai
dRuGXqyeHnO/U8DQOyPX0HN7H932deqK6ozvqdE2MK5MpMW2sterVy8rPlwo
hxEF+t5JqqHK+w+dYThQzLlMTBPePhDV4U5gGaNNLMhtUlqU5R3YSIovSH5o
ADjcwRKtoi1E5yVx8/VY0clEU5WPRJmLE9sgpNWrb3EP7xyrdBEP5cGkLHDz
B8mLi0cZAN0r4a6mKxDsZ6dNE3qA/cRUPOhDdQmrY0wZ1XjQx0/33lsiyG0c
GWuG2RB7qrDEVUDouptvfmTWPfc8ECKaWYgL/0Y0rtnLitDCC1oCLEEYpRsv
0pI7evvosotzqbwBg+/w3yexbzGqac3nLrhg7j5vvbWhMKmBakvoHUZtUgIl
aNBFLkW3RRledL70alQ2qC7pveomOQI7h28fvOSS+c+PHr0e5E4lWDSDgJO2
8jxj0DWDzh9kdUU94KSs8iRdxJCia1l8J3gMgLd6lPep/loFshiyh9fMFqiC
0pv0UEZMioxQzXEpDE1ggML3WkSB6E19i6TJOLK1e+1Vv+bWWxOdP1bM17se
aEAiVl3y4IObVw4Z0uVw+knqSDam/ha9N73KvAqShY3bsxGulKGptDI3UNZj
Fm7xWY+On/IfJsGyfVRjE1xxB+VNorVFTUAl8a4Rc0v+h5zG0Mk4VZ4voWnc
es01t7vzLmq5aFE6cwe4BrGFZC17DKHTgMo/72jB1DozmNVCaR5rAbhPVxaH
HfaR4rIDCqpNsQhKDLXrzJDtDlGg6PVsxm0FxJT4nJiRX76lL7nQQGBPq9yF
mpjUl0pK4noJYpMZPCFpZROYOLgrNiSckIhwFBFyO4CbMoZD5P73jzpKp09l
X0svB4gB4DaO2g276YeHHXbjZy6+eAWAXkocuEVv9pG6aILz3SFSnuIYqxLC
8kXteqid1Vj3C5rXAe7/jBngE/4RTbtGoZPynCxcbBILErC2xjYtUlwqXHzO
4sUab8+4bBsFCxhiCGyJTYXmsUFgvFvUVdQs2a7yVdDDJFT2wjjnP/zwJkR4
Qg2ADLZJWoy+lb9NYr1q2Wat6pDqkTJiiQ6mAxVzJh9WogwMASoQ6si5jHfI
CK8QF42dkfsrgolTAhkCCFjXV8k0c1uFPPdUYnCiA6jkBbdb1UD36IRL6qz/
WDKN9qNznO5nq5Nh98ilqLMlqfPG6qdFh3ZW7luuMVK+mlsvvc6dzAIqf9KD
K7HX1VNbC/E1yT7KGZcqse0HRx75JBIbekpQtvyZ2qnJRU8uFtotBYQcTXor
OYBEnoQYhTgV8eyLsA3oFe7nKJbMcUuftkzR8GNflXaP2tHnoDkJ6168odje
be2kG9YVlVhZHDhIk6e5h1P1bZMQoMfq7ZQK40nPlOi868or15OJmooKJadg
xfLuyFc6ZbKie7xPd52FWS12tnouqXcfxslWrdcfLf6KI+mgah2NzNojUvII
JHsxUKVmD/Xy2nL18tTK/1CCkPR0U/tOLhfMFc7oASGRAvf6oYc+Uk6Bo2zl
KRWrzSWC7Z5BvlA1DMDrDrX+wWTe7/FO4IxiqYfF1cIgEf3vgfXd8KI5zErb
ecXAvVGDeHW4/qZCMcr3eih8TUlhhH57Q2aW4T8mwx5dlYk7sf6EIZ6aNAn3
gSaV7gBH9d6WSkIIaXhLREdZn/Arnrys2Pzj2B4S9GwARCxvrJd6ssO6OWbI
lPaKUyrV3sjGA9K27rctykZVu67zWDnP04pVu1VOmNTrHrHR+ByA9DfMm7dU
nwWstGURyDBM4fYkiXkPTyhJ1Fu9FBQbDFI0j1MG+WuwB5ABF9OGeAyldchT
fDjXHeBrfK9e7f8+esHaRRdeuOnHH/jAjVMef3wlV8pYKMHuHlA0MXiFyJTk
Eux6LLVjlSXQq0qD1vQ76s0gRofDmNcmc8VxtA6YagUlyd+aqReWwdeEu/l2
EwcChY1xIH0UAVZowkPAzeSuKwGVxFibCDnVCgdELGW8EjHyJj+urW5uUqAz
rLGznKFsvViZQgAgCxouuDvGlp6MEGqeMl70hjvvvJPVbVmEFVyzRYKQWzWv
AT8eF2vUm4Vr7um5pZFzAvpxifBYS4H8uQsukCACVHrp1RzzkhswzC26VD1s
2ZEARXrOrdZikQ4MitFcJqAHj2VzQzfd1kGi+LaFEnGtti3gWjgrl6NTYtGl
GFu2s7LRnmqa2HJCib4VDvfgBmrrr4tvbAmSylmEx2T6t9paJ/ZWM/2+kmkz
jE2v67jWIrhaWHj8Fm7tp9c/uWUgyDXGi3Cr6fFye7Wq/CxgOr1FvLGQ95eb
dHgFjA+6bZ3w3HPPbfrEJz5haiC3bn7sscdePeWUU4QTHxDhz7II8baGVC4E
Js3wmXD3wCMmcbwZE5XPw2XqdiRlns3xuIK/Ufzikx//uBgOAl7SoimsxuCv
yvcOFZ9ZTU8rPhrnuRf/FRv2YmJNEoEV8aFLI1jDTYLcbJteaa2JBg3Lorm7
MZylA86Z7x5zzBKad2yGphpma5nvm/epZYrE7HCt1RwS2wu3r5ulqPzn/cnL
yaDLt3qOeOkldZWVn0V07rQX5dLMzPM4Qx2BgO/zk86Uw07LRvt0y+QCVwVY
zgsWzBQsC+E0xsiWTFgDzQqK4K0ZIIbQMtILx600VQoQD7cJJfFdNy/zqJJc
RdoalQANpfdCCMXnNkB+QUzJ9VCmSjvk2M333nuvRirsnsoDEEhjIRg1/Jjz
SN/ukteV7+AGqkAgyg0zxWG2FhuToRNsbLBzsHgFDwmBRsoVApjLvWLUqHVO
CfTeLxOQR1XBICPlIcMb9QxXr+u5TrRdP+dapub5usbc3xoXwBiYNCasN3rl
xBkKxVEZEmfdaAZlaZcpoyXaVEQF0wPZT2LFDKIzubM8DHvB5z63/tvDh89C
QSprzqJjw4pTS6nFBzyMIVm+evrpp/9h3rx5pob8Xx3O3OuEkbzkjwVVGnR4
dZQ9N2fOyA1BVXwnVDVb8qUzzliCfjrfGw4mAQMBBz+p4kAAxPOO8XzpYaCU
Bm/jWM9ZvHgN6BxMMRsm0h7ZVjNrKfZPVZHADrdYm95jYHvZIEN3AOMDQuAM
MI9oQILENDBVugbDsxiZXIkkxbOQucGFpwEhXo+JbZbzlGdCicd3eN5FRaKf
7Lff7G+ceOIGPUYFNx360Sv8AjooGoX8+++dd955PQqO3eNGUzOJBXTUZWOw
sFcZCynzKRHdlJasOvzwJTKNjn8MFYXIAip2KaeMjkofSpG9UEDvMTggFVWm
sltf4qBGUAUmDmjSxQx2S4hgg43VMzHWm9qLWmHPqICknIAE7VYbQosNb43K
fztvKmTQBYoxUbBjKJNAQZlLWxTthySm/beSa+++RRWig8PRO0TBh991O0PI
GIUKnwMwQAscTYLOVu3h+/yzwBzZt/DygCZ3K9+MRZB8HJi/mNRJkV+ecMIJ
q6n8D45sXX167QrVGMDbnnmvV2T/pUrM6rSx5R1B7E9MnrxIAioMpvPAZ+4n
0INgSAKoMJYDu4nxDthKDrhHKoMZhMn6X3627d2mwCg3F0ydYegBG8kUyYcZ
vcvklWoqmm0P3M7sM+O0UDEctvMu/ygpuzBStyJW8xiloIsxk3tEjNdMjOO3
gmPs0bPUAPyi1BD9zBZ6Y/00rDLCroO90SVhC7FqmZhqFCa2i9aemlvDDiRg
C+FQiKXRs1kAUZLLPioFkSjLuylWS6qsVC44IVLQN88555x3Ro4c+STBPKgp
g2239VzJYAkIUyuMTNMgg94yT1XX1rpJyupUMn3k2oymjeFlOsE+F2MdNmvV
7FA4NCnJc0L6nnhhBkZZoKGRJ6rKEuuCSMWaFhPrnRTi6Wy+sOS9cO1UsyI+
1/v13J7Z1TCnpGCPadMgr51SMSuy7cRIXFpy4LjMjH0IU7Egvq7W7liLKZaP
GKNcfLnGyO0Q2zT7NPftyMzwfhuL2yL31gJAY2Nbd+mmnMRyPDIOpcNvF2lJ
oTQ2tmlNkuMzU/I7UdwaOZZ6pU7OkGNrZkrHq6BYrRsSbc2Rs4X+1PdsyDuZ
kt+d4pYUb20eVILzuSmNit/qcvpFCCvXODlOU2udjI5T0gAtv2PF/Ih6ql6P
F7LxFVEz98KmSQoj050XMPRJ1ylzHZeC1NOU/rd0c4+38Ya4sqSigt/V4ua4
In3k8xU7IsoK9GLMn4Xm6EgugLxALoZUrcSsJRghgkKvH4lpWtnrR4ZGgOrM
/L4Hi63WI5RHJ/k2yLnSxYYd5rYUjWf0atDasjuwVQ3L9TgFYqotooGxSwBL
sbf53UKpzfLYzDI9LgUbinA4rVATsBJCRQ0mQQ8yBYE8ZE+9q17Mv0qX2KFY
EL1C4QySJPLXS769eF5+QKdxSob+q3YTQzRxLiz/g5kVezQMJ/a0BtQIxfeG
q1AzJfqrtCvbcqlSu9xBCIlxN8ybt9KbYN3mH4RrRycqhIKqwjgyaOjG4JuE
PPkCIh1U7c576qmnrAHvVtfGKgiUvEBNDVdqj5SthY5IGdY7Ew4iCQD9BsWV
H5MBqCeR4saIwWpP9Iym3SZoE+Mb/fXVxEpar4ci5GhpwUnI2yXl1esnun0f
MDQNa0uu4eCRDADOBd+EYjRz77jjjrLP46+PPfaYmp6i4ifd2mtbk3JOwZOG
KavvXSND9ArpJJjUuGJULc3B19Nm8fHI/lRb8LNrs1nK0NtoKLO2Oxxtu+nb
rEefAHS+wa+95quTBbtnsX792mLOoeqkC/DlNeb4KxNfkozAYj9bMsQfrwxc
urNGEADgnMWLV9ZMSXsgtmLBFuLFw7RorZJucpzec4LCi7eGemiJeuRFUNVe
Q6F2veYXsqipf/611256fMqUM3O6QoCx/ZxcwNjJkpizwN16/+lPf/r5uHHj
BLq5OzX90b3dFpqls6kx/zDrWEiGNTmoKPeOQhi8D4FisDuxeaUB1JpmU4nc
lohbFlGCJp4Qi2v8/pT9F3ffeuutqlyF8tY8f5cCCJIAqNZ0a3542GFyd3UI
wcdXPBEBGEAgw0qSyCJPs8jZXgceDUJCBZofn3zyyTgue6yvwtrwXyNGjLj/
sssug24i8/U702Zt8zz2lQ3cNjuph23ZZuGMGevX7LvvTBpa7Q1Sqes7DQQR
Zjt7ejlUGJ8SQaw4VdOiZ/vF1f5R5h5dMeXfdPfd3uDkd6hKek8Ova2RYMvh
BhCtP9lvv/mX33ffSpu6wxXS1W2M7uBWise+suT22GFq1FAomF9LLb4ncwee
YePwDc5GUFLkO18vNBt3gaWEFZBZmv3rlexfIHiUz35i8uQuS52iYIQ7iBj/
ir+kv+F7IbkjCbBI/OsfjOJfN+3jyaZtkUmH2wJoiy0zkhDPQkLmgRvKC6U9
XkP87BfPPpt10W1qFV265o4Gm8RVHOY5GNh1uDZbormxDVCJcNrAZINdjfbL
tyZMmKDWl4qKyg08NNtLs2Wtfpgk7EDJ5z1sIxATNesdu5c0POt3oik3DRsd
0FV8eWUyhm7fsMz23eC3b46SaM+Wai+1En8KWpJcktbIuKmMWEMV2hDA6cAx
l/XT+RzLo7OVqjALcIODxRNvVI128V3YkvyYLvgnznHgnzywYzf9jXgSF2jv
cKfaK7LaV/nVWxAwOmZh4uNK7LNh3zA75LjOWLhwg903k1ot4r1c1SfhkSMy
+3V9Qm5fdxKgR1u0J7cG1wfN2hgKqwyyFrMjluKHvmCrcDB3oBbKMNGVZhOh
klyDvnFlWkrGtOmxtSNSFULVHNbPf2rSpDNDcNIjgoK7qUhdBZ4JogUPpRA8
IB1KDNu+vH5N0SX8UDUJahVWEm6mktWGA8ygt9/egG3kYhLPSixrE9tyzrRQ
IzXZxnrptHq1JcN2yJWHLrroojXTpk3LyY8T4zoxkg0EtUX37EU+5czbpJRq
78x7YYuSClz9oq5QDlvDqsBPvaMFG+PP3ovPOWclSk4U74+qTVn04Ttzt6Dy
xOCb0SpX+Okfga4O2LBZlsk0qdpfSw4HgTFJjq7ZdLAFFJ+nxCcVmNjdXhbM
+KGuTfAlJ4WRKQKc/+Uvf7kc/hl2vvA3QaNa1iZII/zg9xEvvfTSD50SmIih
sz0okurV3kopPmXmjcT8R83IstaIpNiWCeZQ+g3SLmmrl4pv+f57g0YXzJnz
yGuDB8/+0f77n+nY/PwvnXHG8q6PfnQDIW4rQ+3tgUlBCjYNds2rckkppDCx
fpkqcOBgour7K54rtvabKBPCADqpspIH21B/Ot+BByXPiLDz0AYtgQHpRUiI
tMkftCKR7q1TmJTCYYIZ4PzFixf/2Qkdq95ucjLrapoBPCrwHnvW4xRbiAkD
1Pz8c31bYknwcGnnGRM/vBOphwJZTUMDfVuf7lIUAgCGHOTbrr5atxBT/ci9
9z6JUB4PDPmiSiwgoIS294xIS9uYcfbhlfMefXTz9O7ul7FiSGuQ0RfOPXep
Y5IbzOz1vt5KBo9zV+tWMm2BU9jIFF4HGi/QkU/KzmY8LsWidtAASGDRQZVc
mxid3yUndItn7TyOyGvBzLFFTdsjTnGVfx3qkFZkiMpGdBKcpxgcDfTbqriV
zaIeTa2hFN0oiN4cb0QhdHghahc2Euyf9RREBAglKMFFhbJ0x6aM48OREm8n
cYsxnzFsBF701asOP3zRdz74QRkSCgV2gUeQnLbc/BLW7E25nIns2LZRKKr3
7owI9B5V7LBvZ6cy3uyH1LWFvopV1GKdzuQ6iFxCkKkCrBcxhHvhqdgk5xSj
PvS4v0FuAnUwJae5zQL3JxsXBactqg7l0EFbbI++0MSkEOLQKd8hl3nKiybf
DprQQymE9cB4UJubztSnJ04UFLNLUo3wPW60HYcbnfhJ/XZvOU5kdrLRWJ0G
UHrlS45Zts41xD4zvjjt5PKE0KY1cM2uJ57x7SJ/pEQsU5mJcBfKve/yy9dD
uNAmBSYBELszwTrBhF7pDpuYBAWZ6P65HfaqdJXHSJ45rGKbYGHIcJp1zz0b
V4watdyJ5vk85wHjxJ/U9t62NcHCsK2J595vazaM5Q8f+chH7rzmmmuKf/Zb
Gq8NF54pUzZ18AI73ww5TZd3VXlpg2clSXmekhH9frYN4WOmQlg/m9MF6Dgt
DZarrrV77TXVMcaZmAqwCtPirfVK4yGIElhiQ3YZyidqWW5XOyO0y1iWEFFI
wCJNA0Q0z2Cd8BACy3mCf49XmCcZD9vqe9Hn6Xernaaen44fP/6Xw4YNQ/10
DMkzW+DLp8RNwWimmqjmpolxoBRMbK2SVMPNwUQMRQA8jQKiGIXDaYggW08g
hHBs241GRbQ0HUIAIfljpxax4KBNh5+onCiqkNumvBf/WsNBcOI6BX/Vc2PG
LALqYru+f9RRXU4lXOFe26hhU14db9VLvASp/NbzCMUsE4p/inSgMvTnnZti
WXL1crxWV92f9hbgJP88SA+wUNoC8YPfJz79tLBVxaqYL1q37aVcBnMkyalY
NXtg4+0EoPurLIJJKJzN8EYrlS+zviSOvmT1NtHNnTSR0nHBaEQ8XXLWWSsg
tDGJYPdkFwPfeeev0NOEo7Y07d67yvcRL18+Xy/gFo8x8leEkTHXCJfrg5Uj
jeL6m24SL4gbb4LblhsdYi098gc/ECnGMs60H3N7yu0h1YK1ZLtDzSP8TvMb
pwDA5nCsIzJvai/dwUmKNo/eGKuibJxJFGTjbeAvIC2kh7ufqa8ce2yX68Cq
vRWyXN7uaiIG1AizjcrDqKh7zGpLroGqx9vmBduu9Ojli7VXbKo2GLknzpqe
MsIPq3mF1Jxk6+vRjkjRQhYOiw8mkmZ/Vvj5ScuW/QtkdXN8jREop802bWZL
JkYCU2XWg6aDVWJwC6Rx0Ux9bfDgWV859dRHTnjhhVXWVKnnM+OSK5k/0jaP
UR3YZSbuYIsIFaAECwEVzdEpKfZFq4PSZcAIa7CSDB5/OGTxZGMSkeo+Tkvb
CLfPD448cj74DjWiA958cyPPRYaVifVHTzwCPol2mprhXubQCICKhLjC49Sp
nmnY8qQ5Q0K5CEKy7yYOF0aDr37oQ7OAtu0p5rj53g49ZWswZ8z0POZM8m2J
QtxPmW7iFYIso1cILHB4prtweM9d/ZwPXxb1nNeJ+6rpXr1VwgvltaiEdftE
hkQhchJ3tmOQT0IvMFq24kRQdJK4wrCricEwZhWqolN47TNQmHrAWTfZ1HMo
CdF0O0KWDpQhx+qefGnEiNkwp3fEV5ePHftXd3y4nDiS2U1fHww3YxQHs9Ij
gwUlPCNsJs69ErWEv4K+Si861lX2AgWjfNUjy8XLkh0NsEsueTaeJ7VHh1MI
ZNpH7r33ESdGxY0I5Dn2lVdWy7fhpJW5zaxCbg1UgISPBx1VCehjSC47MiZw
AFe4zCl2y5KkcE20MYl3NnaelQMT4LeqkNjoCHGuY5xI5A+StGo/cYeHd2Ys
XPi0KZfTrLuaDHtxY6CnZ96tk5944ombr7vuOlOIS32sZS+7KO8ncA8zdScO
jt8Tt/E9ibkW7xtIz1wf9ivHczf9Wc+OG/d37Hc8HEeBaizRIAaxJ2wTuZ0a
FCdYJtnGZCee0a33u5yKRoFC5Y2eZEMgNYQxOKEm1+AQ6JhKcNPZT3+x++7/
uv+PfvSf3Kseum0v1q1bK/cGFQel9bLCngVMg7DAPUm4TkvvqAuHAusSoosd
v9NHHmJfkxIOhymQNlFyk3SBBqKG9oksS48pcieZ3A7g73AhdvOOe5ME8MTk
yc+5bf21kfi+yB0uZ7j2G3Ur4Cg+1r3Y5aZmo6uEWZVty3ua+9nJE3lZlSEE
sW5q1ZUUPXjy4Uko8awbJzFQyN5kYVPAJRnarQLAdiud70gYxYI0mBHfB7mK
z749fPjv3R6uiWWbK+XeCIcld3cV26dwSDinX0Tuvr123LeHmzqBMSAhaie8
cWuCAi1GGftQmxqRCHIPhAqmjk9ipU5xpM6/9tpr8ao3kWhBBBujxmAaVdqL
VidEf7P0lFO+adChVUuDDTldUSSRkHMv6Sp2TIKbtmg6DjRHo0lipCmZkP1B
3aPFh6IsYsV2YpGNDGIXmWvcNbgCl2wAfIA4z0jdIQsNmBvMNQ+ff/7TTmD/
lxHimmiU6FlTJyIUeYvIkLvV8L+22Wab8x9++GExXPoUFvEMs6QVxWgsbaXX
S+JqUXAb3OcXbOpaGR7/WkiZ0iFg5E4FuRV0kdvlEDdM4VvMPPsG7rB16peM
xv2SLa7HgySlLr2d5EmJJTRs8fm6dcu1OHk/3faNgEUtXlTWHjWgoVnOfIqq
DJuO/+Y3vwk6LKqZ6xl9EF07JWQ5ign3quLb1sx1mf4GyCRMjTIkUlaFFtvP
XHzx4+gxB/aK7tCG4uiDjy8GFAcC5J156NLTRL6bWFzqMY/S15fz0A3KFmsv
gY8Amv0zQqQXhUE+H2W8f8yrWrFXBNjLw4YNq2auyrw3Dk5t77fbbrttNXO3
5+n6qp7LAdMAIK78irvvXo1ecrBkJsOci+5wMnKP4oz5i4omgCTgoLdgRHAh
e4tcYjMNgAwOQuAPS9RQ3UmOUt6c2haqsCyl9Qb/gnHLey1R8/q3gw8+2N63
+s7AgQPVsv2ACryGq0ZxT2vpAtWKvbAg+mo76Ng+79FH/5fHWW9ZbGAAbXpv
GVn8hQsj26+pwEnsf0FCEN9ptYO6G4OrWq15mzA9V3WJJZpzZGpDKScPVS6x
phDjKFa0gMTAE43H2TsKglKIXAer1drQVcpUcluGd2UvwVzo+87ck1rBJcWf
u+CCC9APmOhkZeqKaI2FSNqZR0GmIzi6aH5XsbPfFZMrLTQ/a6rKXXtMCrYD
vsYa3aXcGuwF7w4pp7MLfw6bcnrkveVsIiboSnKc0f/B8sVIa9SqcIGDHEvD
RiWenFy5u9Al9lk3tGSaWDBnziIEZTtgT7emiceaklQHSarHw1DQP0lC2CQG
UZUqZbQzaMqJl+8Ut6M64oRlog0MsLvWUbz8KSeV9lkmV45QltZLVsnA3xh5
SPtUoEaWG8MW0tKtJsoWyXrzezZZdb4l5fvHHa9e+cIJJ8x0+sYao0BDMpt7
CzqomNkQSbRhWCjPBgCyvQtnzFDbmEk/0MICAfnQDf066EposuSZEo6wV9QZ
VY/MnTBDMQuwALINnpAmPfXU0q+ffLJcBvBED2QcIrpyhyz1no5XdFI/e5h2
n1wJDxLBmOee+9/izDOHFxea87jRrwqo9+eVzuo5y2Ipnbw72iw7GPtHTk/z
LTU/OQUGvDg4EpniTt+4W3pUDNm9i885Z9nv+/WzB5eOzbVazR0SxqCsp3XG
JMn3fmp9y1WNbLWe7uB1sdJj2UknrYhVHHIGMPW80ftKM5yJbVd82dGjpzU7
lipGq1c9h4LB+sDyK6wSRSAldZH8jDut1xy4xjA+UMYDl146G8l2V915Z6h/
38o78eQvb6yrNXPznhRnqJVTTcQRq34x+oR5imrdpFnBHelVNXr0nIh15i5g
FfDmzF4+xzOSxnpUk9sGUoxjFRmPF5Gtq0gPGPej/fcvn46qUHVs1Rlfk0nw
qm/OQdP10Y+qrNfaCyUtLmayxGiR5mbXmo2co15j7hHFCBqsYlBJNQ5vQm0r
h2cltyIHmiFa8VubR8boY5K4vRMg1ETCvqGYHbIkXjzuuCSiDM+SuI6wl9gY
lbnP+xXnHMBoq2T0qVCNDeimF2Dv5xmcccFFO4ZmVTe2JdZef1ZhqS2GCEYp
1WKi7qhO2hqlAAujJ/22VH0pG1qT8K9UCsu8H0QuAxuAAW5r1kFiOMX5Uafg
8RxZeXfHHXec8Mwzz9DNGSJiTXFkFRZOTUG2jpIJ8J/4Wb4eSKvLmJscGGdZ
8hPp8m38RS76g7GvQrbbNbJUnl/NFVEcjnyPvmSSHj4DfwxZVOXzICqGwgUn
qR+loCqLhIlNxZufOugjBpmCHxKREyXRyC/1XA7IyLn9olhVJ15/nU9Uwc6z
WNduD/XcmEzhxuSC31Ksi42JZVeCIR5PKpRXCliPKvz86O99bxPIArLkhnnz
lqCM3eqDDprplLoJ6/bccxbiAKD64NAdMLINCp/TjOfgpOmE+H3u/bdfGzx4
w4iXXvoZ45ZxN7BjrclV6eXrp7jnGk9jUBEU4eaT9XAB6KwTleORAUL2MseA
jRVafMkXfa876IV+gaB4UgHToaOVWUg9nrXr6XXGPWAkh7AOxKYFQNheNW2k
fW9OkfxnKgQO8Kc9O25cjOsPWIwVq6jtH0WtVvCLpZEEyKK8BK9Y4sg0Uki1
ul6RAlSxNCZ4TXvw5oOQotJmTTAsdl9OoU0S1Jujv6pivGnTa/TbQLCAroHG
mNmSs86a65jqhOVjx0psO+j+oYsuWnLnVVetBk+wJby44f+xyy4He4Whr/t1
4GenTVtB0Tjz059+B9jvqOXtX++003dWDhkyEeQOAGADXjn22N/+8LDDeGcg
60fiBk3HufRyHsCtOwT/qEIQzjUnf/3rOAIh4KBMEO1PT5woNxkR0wFETA23
ILqTWLhYUXMBElbi0/NaqfrY+G+m49mijWQhKNLohl1x3c03N5o0zE05ivI9
kAEpT+ZHMrCG7Wqm7TN+v20Yx0HxruqM6t0RrNKbZ3/qU0lew5mPPbYcy2k6
zZYMuuWWGI5cBFvG0Zgm6O8aKUN19Fh9JQYWGclK+2HwybUlyrRhPLLuQGX+
oKv1jzk1G6CXCPIcdfm2AfYe24HvvCPmGkwB4hjTAPKCH/KqepAbloLr68ug
Y0FZ45Bpu/ETn1jvaCg5PZOiixbIk2IHYKqTRPVf7bxz/barrxbbHObgTj1d
7wwceM8f+vb93l1XXjkPc3Ik/bZb86ZuU1UkXEip4ePdyX2e1atvu026xs3h
JeSv8iYpfPLVD30oyFhfAR63iTmOgtg+15YSXFL5OCQAUMRzSwwG6c3kwfy4
edJTT6109L3I8YqZ7mQ8Hao3snOM+bJK5ZU6nsHc/LMcY90ukUG+HEc10+aJ
r6187s2cNrQGrqFEGG5XOzg/gExPB2dNJ81FhptUH3LbLPGFrmk/Ycpk6ThG
2hQaCvd4Uinn9ectceIEmnUEY8HGBKF5ULZ2PtrO+NKXNrsNO9N1v9lQMEjH
kkHm814s24Mft/errbkf3zsOFi2l3hIXjkjVcgkUf5T1xwU9OhmmkpGr/Szl
oy9QMAUnruh05DEBSR5O/5sLng/NR8c0WV+K8pWoeHWHC6BLBTlKU9gZmASJ
hjt8Gf6cXMRd96cZx8+RCocLJd/GNL50xhnL/v197/uho8Sb1++6K8Lyfj76
+ed/YK+AJ8Fzsyy/jr53LVvvzrh1J9uTawRhAHDdw8FR1u/k3BXOPVRkeHUJ
FZwwwoFvvLEGt4UvO+kkMSl+4dxz5yPeFn5jvMG7RaOHQMN2yxSefRYQtNve
ORrEfRIDUs203dNUG22D5imoNGHC2uKo7Yti5+FrS9XGU9UhHPMIoVn33NOQ
keyODas5784UoJa6qSkwSozYVJLQ5q6adtrXqbrTaJleXKbZLvZ0nxHuHVQs
nOp2O+5L5xF8i8pBOJ4zGgkzZ0zpkT/4gR4OHX0t2ThgQGJQL3y8VihCWitX
0UE6s7A4T+XdJjMvjDrARJdvAKU6YDzpfhZBDXZ4PPWlESMmQH6Dwimz8R5X
JUjdFoVg+eISUjhzOBkmZ7SxUsrzLnj8rZEjhYxAxQDEju++q9TOpHL8fsXd
d6vWhKWBKNbutdff//WQQ35z/U03vXTT9ddf7/7eixqdI9klDpCrwAybB65K
CgimBSaDqZhS7JLd8MCll+r+5VDCq6rblmtz4J0nJk9e71AE8QVimsX23vGx
jy35yqmnrrFYyKsVFJDBn8ViEOnwDc3G00k+E2zSkXJxTqxm2roySnXwt8p2
D8Etfnssw6pydsscQIIWxxhCxyXnOo3sTIcR0e3V3vQ7PZgzCk8u/csp3560
2+imoeWE31vpnJwtms+5k5uIbzFXhw+305jAmDbgS3PS7uBpHrtB5TZUhZJT
3X93dPQpctEdPrSPpZwzZZi2QZ76qtGjFzG5DV0vPuec1cd/85simaHLuvPo
bBxpHepNBxG4g+IjkCYPn3/+aqdkbYynoxqARZsQffX4O1C4vX2jdL6WnDGa
FjkT6hXsCs9rUb3gOYimHZuKxpLfVEdUNgvzEq+vBHOAGYGqHU3d2CJFOiuw
ueAFiPWY0NdwcQTdCLYCCyZoPArK4TxBbwM8Qt60O3Jr3rSD9sznxox54MFL
LlnpNn8TuwY1UhoxDBffm/gugAUj23TepM3opmrRZXqfp9hUTtu2rqTNa+cs
EHn6kKFSnuiqWOEu0cZz5BAsCmhDcTiUQcrFhDYng0r5FjxLxYkJ1sey9LLW
H54tqWfRCOUUXn/Yan48rzFXK2z25tUHHTTd0cLmjqaftNNbyKmuHDIEq+bv
Q3JhQwG4LLFtDcTsxsvciNBazfN9CaFnCgr0+suQIWOXnnKK2KJXHX74BJhi
nX4rQhmHVhx21dNlnONM4DVEzn0ANtpLfdt7+qrTZryB/q0DlZ9EPtiQAivz
ymUC+u53OisUI7VUCvKCyMg9A66BwLF+BszhfRoX5ixYsLr3n/60md/4aWku
n9XZ7f0eQYDkIss0gX6E1YpD5F8109Zl2xJXZ9VHHg3x2TFDktuL9X4JIgem
BW5JP4vV7nt41svG6lpvbg/f1BJBHtToWJsprZAYSiBY61GMsaoy+mcrxaxe
kcmbb97aZ59HXh06dL1sUnPVoL3MVJ6aNKn+9qBB0Bg3u38HVWMsmztVvWEp
ldOTv/pGbUIrig2I7FcpOlDq7orJ5RISbf997rmXTXz66Wd4h7YlNxtfXKoy
nb2ClRGBNFNJH509v4/xQF1ak8d4QXS5Hl/V/0ZXIwVeOO8n6bn1usZ/0EcD
MpESs5lnAco7gWRoYP/R/vvPdZtymlPJZ0KPon3A9bOZBZLwVS7p2AYcWVtG
yODr0fEyKqPR5kzH5bMttOGQMSOnjNNO8yEzh01RVhhMu/YCMqCi5BT4c1fV
Fp0pPWu1z5itYf3fTkeb6dSbRazeE3X7GiU2/uWpAagbtlvRBX+FRA06Ko0e
vAvcB987+mgxltBcBzRCd0ALew8u2mcsXFg/4YUXEk8W+6U0YTU6J2Vfc33/
G/r08O7frAuqicFLvdoNvQIo405yc3/Xv/90yLyf7Lfffp6ee/16p512enri
xIlg+V88++z5TqddgoLHtG5t0SdvAtJpUDMBOqRPQyu5z9NyRSXuJjw+Fexb
LETSHvdJw0v2zLRVojSzl7TYVOJYbKxfudQaj7fUv633rvws+B16sx3lpb5w
7rkv07D/tfHjQc6zkEPtjnVL3YFidTS8tDOVG3/lzBOmgGfTONjjCd2Gi49r
ab3b+DyXBOEjwHsnSnI99ah7UT1tmQ2hNwpqmWPzDGP9Q0mb384BjCVA4iWM
Kg7HfQ2cel31GrJPa8Sy9TaDgBpkj7Y23M7Rh1hMLnnwQXmGvk5atiwhXRqo
gaFuLkL2lE7oixJl2mc/G4nH9X/VnXf+xfX9Q7cbf/XEMMB2cdvVV69GmAVo
ECjh6HH67/v1m+BodO51N9/cBTIGWrgj2oZwidi6DTvscHA48vb5n/b2gVfc
fbfEmbspb3DvrcQtfmDhoG8oYMh9dGzhESCJRE01F5od9MnTmGcLLGh10Frm
e1PIQbWcSuSmGty3pyXqnm9TOjJij1hFL9yPBT8qRXFkVzFxqgZih9lLueb9
In5yw++68sqYgGK8Dpr925lp8ytCStq6By69dAUkiTur4uAgnrhbr7nmAVTt
gb3ZWhc8a+qAceHahQsXNqvOKxrOaOV95Wuia4k2bJ6TOu3j+wJ1mjb6WTzb
CsR902sZl4yURLRXAvEAbk/WSZsHlhQkvOn66zdec+utSc3Dcc8+u+L8hx/e
hKGAOjKMxHx519Ae5ciEWffcI85B8UTWY+gcnIU4ONq0N+wMhcQnP/7xxNFH
L9VxL75YZ3kW9P+VU08FrX362FdeeT2AV3Iu6IGBRQ1OM6c2T4CWBUcg6BFa
0v4/+tEGt8vCIgAoWnHu+NjHVCyArTtpLf5VN9/THJasouc8ibrwY2+PU69D
h9VIfAc6AJueCf5dh2ldKAsNBxVPx2SLACaPfzT8gl59vmhzmiQ8ZQ7GN625
m4EmvSU8Xyz6KMVUn1QE7U4FhSln35oRHiY5X5OUfC6HhCuy4BuWv3Hw4ME4
vfvjQOVPw4cPByfj8etkSq78tdQtPT++v/ncdF2gQA8OGEI3s8gfbeCYiKhJ
wRdlAyWAIuv23NOc+/cGVjpswoFMsZjRhg6zEh3QCiUGizLQERqs+/flO6+6
6lpHFWPBTIgx9C7A2cOAi3J/pJi7r7hCNWtgEDxt+Av/il025g+qC1rlu2BO
i9ZB8nVSZ3/qUyteP/TQR3BRMM0Irw0efCMipsH6ACxGlXU0R1GSruh9ufCJ
gKJnJ+pM7mIfe/DIbnWS5bWbsrfNP3Uascc6r1sm1QzfbapGpWNUMu/5SBFx
zwP9u0vVnkPVV3obaMMNPfE0J38FvxOAtc9bbyU7jM+Hvvqq8DTIf6f637hw
xowES5Cq6lTO8bL6cCNw+RgREqsSrDGuElokDnjzTWEnJu+FxipTXIN3RRgN
v2+y+36QDY5BrwLCPPLhD89/dty46U4YnAYnGsAF7oBt6IG/UQ2Uwiw9IM+H
txJRov8nFnnyiCJ3M4Mf/GKE09/0Kov0HLKhqVDfstnLX1GeLS+NocMRJwlH
CFYxnmKpvxqbUf/EQBw29tDXX0eAz8uAu/vuxjJLuez++5c4AbXKvRNK1XUk
VVhCN5DlGdNSNfsspyMGk6e9/oKBezTqlWt9sPhvRn/dhhkft4RbyJ36vRll
U8G4KWSwTECWnNOh2GoHrk22v9L1xQaa4sSEQskdGFTCLsOaesCupNRLZE3x
RNwnIreauv2semP/YZ8BavBmKccQ3lozbVpWk/5P+ay9mVz0cF12cS0TA7uv
l4V0PtJanOTcBaGRO6KGZ9uQjdEQbt0RoDOn7ggmuq0TTHRHIgTDzHbHodvR
7oTVKlM0kTEvtiJMclVh3dvVecFpGTuzz8wmqBUzYCe1uEzd1w5iDYkLfXWH
egQl7JTEITWNhKKBoHVqojip/fv73nfm9486aiqcFHMWLBApiqWHeA8gtnr9
697msGrYsKXrJ09OIO8PWCE1t1okyeCB2VQ4jfTemyTS3sSbaQGAYO7F7wCU
SbqSvBHgCOwQsHIIhwr4gUW8MXr0/HeHD496pYzoQ/w7mpVLOf2rX/1qyXe7
va0xTtb32WnTRP5Bd3ca141Oj05YmoMudH1BJBaqJMu0hnwma5StcjEPGzlN
U5ke30NX1R6epbaukIVBfkNxTN+qnV6SqVuPBQS9XtdhS3CxO0zBxu0F3BvA
T+HJxmUmwDdAHSQIoyHwEQYXh8/L8ZxDzr3jjhV/ue6625tWfffikqW6MhJX
sm+lEMvhEfOcgrICYQ3xfun0dpGASOmlTV5n8ZbiFsHPXtgsJ7/W04ODzQe2
0WCJTnm/oC2EEx1baDvIs1y6gn5z7LHHxqNJ56/GjRuHUi0vHnfcTAQILD7n
HFXFgWQ4FAJ5TCRU6RyouoxFikyiSavqMfW65SRRFuf6qzQfA2dYTekIvr3y
xVj09VEdNZa8UmGWVpKIYXSCo2y3Ir2j6Scd+Bs45k4Py1cfdNAD4H9OBKBe
5sw/HHnkKMCeunlSIX5XK3/7JNeYBsFWFJOWFaeN6XKntqHFJ74j7Q69Z7vj
0hq7ITxci7816FXdpcgHiQby1e76ILsRtvafvf/9s5GbrbWdAlUCoExw0Tqd
xkoe9WC0HayTKLvFKr9xMEAlE3fGExekCVzi1R0mMIwmS7tJVq9nQkkiMVsz
74U7o5O2ute/ALZqhJoWlQkOb5E3C442mkbcEVnx5s0ij7R+76FdxepNiSuA
Nnnt0AwlqzO3eP5q9Ojksr/k7BbwY/+MLlbLtO2VafOr6t2IW6WSbUNOr5/5
2GPr3x40aKZJMkuqRDevPK/uWLAmzJ7pxPg35nD2IuaQBSZe4no8tnlmjRZ/
EVTOg1LByeW37jBzxpe+9CVQ1G4q26OM09qfDbafWukqQ32eMw3t2nQW6flp
t/e2X3uHmXi1e1myL0O71lbsY/fJgaPqsFesHDLkSQCsNbLnrdii2o7vvrvx
8SlTnsQOu3/lHpOaVobtldwhUY+VjkmN6Wk7bk2vZnbw05555hnoUcyilKpK
u2ZEwE4W4IlhJJrDRK+Pz3N2E991z2b53f+R/SlpoH5vqF4XzCgeP3szDLEo
/5otsR6MFnZnmNMDCE3v7n7EnczW07DcFoURDyB0/5Ruyknp5VA/rawhNCh2
2HSw++fGjJmJ8Dl5ZlJa1dsYjV6R11YjgunRbvvMblQzbbv1MLc9mu8MN3tL
F6F7IVRxuL0St0um5p9UQAb3AQ+s7qi24Wvjxz9ChUucokawUsMIfLuKPuxJ
XcBv8lJUOKpNzdxZLiOGKouc1CUPPriKbi9sjTCTIOpsbKapRhp5nCldoeqW
bomhqdzN4iO3BHYesfK3uHtsk6rcAPncW25ZaTUvAb0UifE1dDDdl4cNg9V1
tjsrTn9q0qQnqXSAWBgEhL+T2N9wTz2DaHnEoHJi9GBNY0xMVOSt+G8oz4Q5
4wNz020r02xsVZqkPpHngxvAzlzb1IcuumgRKurSvIK+WIzb5CEDFLoz5p4q
DGUq1QhXvPy++9ZaTp7cbbdNjh8l3ov8s+Ob73IIc0kuXzfP/Qa3LZwxY+PP
99hjKutkd4dKKibOSC4CglZ6xd13y8nFIUPXZy6+eA0jCgJLx+eM6iTK4vdA
WvwTYAeJmbI3ae52EvtKKR73t71cXt3ilKnej/7VmRTsFPAAIlAaDm2wg5AK
r0wYKGei4xJ7bfM6MsJHnx037lUZLryn4ZD4SzNdt8BHt2I7rb5jngcWCZo7
Z/Hi1Y4OP/vgJZc8ElJR6EDHz6Gvvy6Z4zjC4DI5h5vLeWyphSvbjKu5yltV
WA1HvLKhSjuwxD5jFQ8o59hjoQGVv4Y7yVverlyx3n1xU+XL5XcHY3pQOO0+
gKvDEfavhxwyy7WJ8kOfqCByR/O9w9LdCe/epydO/Dv3REGAv5JEyZKV3LYF
hrsfkSVT/LrCZ2S85pk/2CelOP/Qt29flHUNOyExrNQqqHdpIe2BUW/QWiq1
DIr5/fGD8fzPA3G5qLwKp+aZNbXlY8euW3rKKRI5D0sNrDZgczmQxyy1RSiM
K1sTHXj9m4qqWsoL4vOWrdiHTAHrUNMufDaUvR3oe8tU2K0hiQOpR1B7u4OB
G1hHSm2QRR7CFXv3V3RNbblifxDRNPKBrAFcxBrBFiXOsvbmEB7z3HPfcnzu
x/bG+wSp+we4NjmftPT8uMSmGhMMK0ZYWdDm6tX+vl+/fmd/8YtfFKvsgQmv
CDY4g7G2oIfeNRmMd5HhBwSZ86zWiS1GHTjUexJqxeRPy+fX3HrrCjhcmI5X
iTTBr0pglfSU50ePvg0Fb3fQis4pq++fk9bhZJGV5OHZfj3y/JKLxKN6v5K0
MBWQcmeeeINvQ8HPpHit7oGJPjD8umarAHM/oiV6N6J8sWm1H3vi9SILxLiH
coVHRtsqc+Lwe3KNs5cha8DtQG7wK1FGsQ4cD02mOkZr8ARtEDwPzIF6lnCb
E5vymC27Rv1Bqpimm14u1JnWpz2oGSp7NaahGjljNM0xpsYYv2LF5/187/ix
Dxj2VvXitZs0FciWzKO/0VAHtLMN9tDuwLI+dqUJLV5rFZJpm3/ttW84dv5a
2a4j8nlMT5DMBUKY91JIHvDmm2+W+G1aqfaQzGbIZN7vHyQFvEOmzP9T3tWE
WF1F8X/Nm/fmw9IJa9PCXUEFfQpmOjl+ZI7OxiTBFuJAVtRCQpoUJJoYTAsm
iAgGF+0mCYJAJ7LMRgpXbQZxE7hp5UYI3BSZvd/5uPec+7/3P/OgXcI8ef/3
vx/n3HPPvfd8/K6Nqoym4tWEugSkU+NacucR1WWnloKvDMraRDMN6ikbGygI
3PSJE7+mjmyxknfOj4//jUBLaAxNegk3df8HLDzEsoQuwUWCpasGSel1avmU
TZ+PRfZVS+dCe7msUkbL7NeUAXfCFWX64dTU1Mtnz56F8EGyyCnyYpFs4ww+
nL2RxFGNHf6MRt1y71/LVN12Xedn7MYe1hMf5gTCOjTWHJswpJrcHBkZCZnZ
uzJ164ZuwWpnkVDRzoJA7i4VpL6+nqmvU1Q7/YLF9w3YjD/AvGdTTMtStSy8
ubCXnBaUkWk6mt/RdjKNRfTFR1IF6dLrtjfUmxP5hmkgLj0XzOf7ntkF+qlW
biMiZzWvm01XpvRIj+CB++gBfL5pBaTH9WtkhQvXC8U2VipAAr0NzYA5yjXj
2VuZrUpxk8NT/r6witfgzHFVwatzc3Ne7LNVZ0HnZYa+wiUxjjhEWgtdxjLZ
MjqTOpy77ZE++VK4TgoTvOXSpUvYc5Ky4SVQIwj1FnuaIqsy4pHaDEpDTe2/
k6GLNadeoqpQhWSpu9eRzCuPjxwsr0bU3lRGaFn7aUh5W7ChySm0JizeNwM7
eETI2lbN7Q/i19dLN97lH1wo00HXDQXhpW9MdgvbJliHwCkMg2zjsZklC9C1
j+PCt8LFyvYGzEfVpCykN9sjUzTspzKAKGm+PKr4ZePG93D9lczlsD+kPaRZ
4PSgkVuXeLMZmY8zEAmAIKQ+y1Vbq4zmWpA7t26dUd+fiZBwritxv2LU7U2i
GALdMyHYb3F0lIIh+otV9OmOzgQijFg/uEMf8bkKjXrLMQVGQWxo2vFe0S5X
aS7bEGScKzI41SE41qJ35tih7ynSmB6jMHe6v/2gNuQGduhRiySUN+2rbAyK
WtH5u50odRNKbR4da1aeciT2InZ4QSCqnuNalS7uYN6up9vsVonOu0O+Bmft
dE/gfHP0QKaEieZMIkyGw0J/4HSMXi5wZTn1srpydlhi9enq8kcTZQkzp2kB
+dnELLSgVBCklichqPyUVAlzVoAeJGgACGSw+OpaxxWzhFXV2EJoqodpYxgy
7M277BGqjh59qbvWKJOiETJ3ytnrmGIjhyNy66CbXKKR8H/OVQ5qkcX21b59
n6h/L/u+pE4rd/RATj3eoAt82xJn1X1x/T8hE+jGjfnuGax73P36VnbiGb44
HgRjlypNiylgdS6egBBYFFUlWAnZceHClS4vZ/R9wX7JFpGVQ6vVBcY6a5yS
pc/3+QdoxADZriEOPMR7qwNIKm/288tWT61vNFabrT7p2JO+PeGT/k0iEVXI
MT8of5VtJlY/orMIJ585fnxm68WLfwaHu4Fhs0uOVd9qrsGKpZ4vCzymkkQP
pqnMPQ6fwO8YwpwizfbF22PJRqcVOLVu4jf0K14PFKOzN1lmDaQGJpvhluTB
nkmQvTW5yxDcHl1cvI5ENGDFqE430XOZIkM2fQR/ATruDturtAorRCrY5MQI
wcDWgdF9MnNwfYVr/XL82T9H0imR6hiasOKYUMNgHrM8MxjwAxqWqXmJqm0w
YyKi4ZBuaZUsbGOxo0IUHkiEOIHxJlYsvG4C5rBQ4s8EzGH4IowjPmVDr/E7
ucA9C8epF2OYBSREczmPya2lU92N54PVjjd+T5n58E7Gtc0sSSanwu7qLCiG
c3ELoyfCuMBKe4xNLnjGiXAdlSPFXtAod2OHX2vxua1KzVIHUp7oknL/Q0eD
6UEV0SQDL5fJG9JnEOsUtAyDpcupULcnqLBwkmDqPovKSTWKapAIuzaEr8Hp
Fhbbwwv0bGKi5p/59FCXzjVHqiPTM5XZYAwU6WmDlWpx1ygmE3bksqJZj1S7
g+jGIwy98DlLQIrqZDI62zWC3KLZ5rCZuKaSoGxYl11T5SZuR5TRtSrpFlC3
aqBqPFIFG0WM+xe0aXVHaDCEbCqc6PVl+Cxrrt7FAI7hQMFasj/tPYen0pOW
YuUncJVhUtU7Xzcqcuf7FRBJzyqMW8wqwOFS3+FDgl7GhLYk/E3nLm4MgEKj
iSqggWkRs/LqgEMhQa5MsIxLp5T5IkZVd1g3hITUA2hhRaQ+o4lk0mx6oy/e
DTdnCGQyiAZfH7169TqsDSa8qqXvqwaTWBENDYN4o2lV/PhV704BxUIJWbWj
0ZRtkKtcpvWdeNOATTXSTEFzn52FYFIhVsFmfw1/yk3nbG9pZ8rKblFZp+AJ
Nqge2oDkS7ZaYkjTBOg4JGxnC6FUZKSRGaDJKTatCG2qErfoVil4jsDptDRF
RK+HaEeyQ5FkbQ7pEqIHMEQYLqFEDJkOYJ3e/TbOfRz0MT/ljjY1EdVNl98F
6qPFhC+QlfvOOykeM5R/kDWq43uuw1nk5Gqj57mONF1t9uTJk6iDVy68w7eZ
eFO3XK43yj9lUCX7/pqfn/9gdnY28uDHjArZ4+rJgNb5HAfbH7c6SD2b409J
7oCPhbf90f0TNbLb9WfZGG2q56cgNkvoD30bt/U0xxFTHZczPN5lxykf6Upl
f+ayzjfFHi/+nT4GI2fCtbS1l3jL2LYcsSK2PX1/OKjDK19OTk6mWY/b8u+T
uPwxPT1dTJsaKxRcVj62OB3fGM2WGJeomXMrFJ+GZuIpsxkgwra3rJiNraC9
ZZAATHvN4ri13FanVO/5BhHdtoL60jC92+UyIaAtE5pKZf8ply0Gp0mZnVp3
g9uxFiJ6OynboyuuVJ/237rEVIQLMVJZ8mu+qXwsEJVdLE4bH3W+Pp2eDxQH
ysepPdNLQcuZngpaceqtoJGLFRXMxYU/3UtB6wiuFVzbII7RLRdtvOUKMjLZ
zvTgqVLXrRDmAgaeLNJsxM9rKv6XCwp5PK1s3//gQXXXvyYQYDk=\
\>"]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"These", " ", "functions", " ", "are", " ", 
   RowBox[{"NEW", ":", "           ", 
    RowBox[{
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", "--"}]}]}], ">", "     ", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", "--"}]}]}], ">", "     ", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", "--"}]}]}], ">", "     ", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", "--"}]}]}], ">", "     ", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", "--"}]}]}], ">", "     ", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", "--"}]}]}], ">"}]}]}], "  ", "*)"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.662277791653617*^9, 3.6622778116713*^9}, 
   3.6622901088542557`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Returns", " ", "the", " ", "next", " ", "edge", " ", "in", " ", "the", 
     " ", "zig"}], "-", 
    RowBox[{"zag", " ", "path", " ", "and", " ", "its", " ", 
     RowBox[{"position", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"nextStepBlackToWhite", "[", 
     RowBox[{
     "topleftbottomleft_", ",", "currentedge_", ",", "currentposition_"}], 
     "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"nextedges", ",", "nextedge", ",", "nextedgepos"}], "}"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"nextedges", "=", 
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{"Variables", "[", 
           RowBox[{"topleftbottomleft", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", 
              RowBox[{"currentposition", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "]"}], ",", 
          RowBox[{"_", "[", 
           RowBox[{
            RowBox[{"currentedge", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", "_"}], "]"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "In", " ", "case", " ", "there", " ", "is", " ", "an", " ", "edge", 
          " ", 
          RowBox[{"X", "[", 
           RowBox[{"i", ",", "i"}], "]"}]}], ",", " ", 
         RowBox[{
         "there", " ", "is", " ", "an", " ", "apparent", " ", "ambiguity", 
          " ", "on", " ", "which", " ", "edge", " ", "to", " ", "proceed", 
          " ", 
          RowBox[{"on", ".", " ", "We"}], " ", "should", " ", "go", " ", 
          "along", " ", 
          RowBox[{"X", "[", 
           RowBox[{"i", ",", "i"}], "]"}]}], ",", " ", 
         RowBox[{"so", " ", 
          RowBox[{"let", "'"}], "s", " ", "place", " ", "it", " ", "first", 
          " ", "in", " ", "the", " ", 
          RowBox[{"list", ".", " ", "However"}]}], ",", " ", 
         RowBox[{"if", " ", "we", " ", "came", " ", "from", " ", 
          RowBox[{"X", "[", 
           RowBox[{"i", ",", "i"}], "]"}]}], ",", " ", 
         RowBox[{
          RowBox[{"we", " ", 
           RowBox[{"don", "'"}], "t", " ", "want", " ", "to", " ", "go", " ", 
           "back", " ", "along", " ", 
           RowBox[{"it", ".", " ", "So"}], " ", "if", " ", "currentedge"}], 
          "\[Equal]", 
          RowBox[{"X", "[", 
           RowBox[{"i", ",", "i"}], "]"}]}], ",", " ", 
         RowBox[{"place", " ", "it", " ", 
          RowBox[{"last", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"nextedges", "=", 
        RowBox[{"SortBy", "[", 
         RowBox[{"nextedges", ",", 
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"currentedge", "\[Equal]", 
          RowBox[{"nextedges", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"nextedges", "=", 
           RowBox[{"RotateLeft", "[", 
            RowBox[{"nextedges", ",", "1"}], "]"}]}], ";"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"nextedge", "=", 
        RowBox[{"nextedges", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"nextedgepos", "=", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"topleftbottomleft", ",", "nextedge"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"nextedge", ",", "nextedgepos"}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6624576020409913`*^9, 3.6624576813806524`*^9}, {
   3.6624579050099525`*^9, 3.6624579507588882`*^9}, 3.6624580076228666`*^9, {
   3.6624651080858264`*^9, 3.6624651319050007`*^9}, {3.662465868908635*^9, 
   3.662465878736853*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Returns", " ", "the", " ", "next", " ", "edge", " ", "in", " ", "the", 
     " ", "zig"}], "-", 
    RowBox[{"zag", " ", "path", " ", "and", " ", "its", " ", 
     RowBox[{"position", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"nextStepWhiteToBlack", "[", 
     RowBox[{
     "toplefttopright_", ",", "currentedge_", ",", "currentposition_"}], 
     "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"nextedges", ",", "nextedge", ",", "nextedgepos"}], "}"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"nextedges", "=", 
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{"Variables", "[", 
           RowBox[{"toplefttopright", "[", 
            RowBox[{"[", 
             RowBox[{"currentposition", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{"_", "[", 
           RowBox[{
            RowBox[{"currentedge", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", "_"}], "]"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "In", " ", "case", " ", "there", " ", "is", " ", "an", " ", "edge", 
          " ", 
          RowBox[{"X", "[", 
           RowBox[{"i", ",", "i"}], "]"}]}], ",", " ", 
         RowBox[{
         "there", " ", "is", " ", "an", " ", "apparent", " ", "ambiguity", 
          " ", "on", " ", "which", " ", "edge", " ", "to", " ", "proceed", 
          " ", 
          RowBox[{"on", ".", " ", "We"}], " ", "should", " ", "go", " ", 
          "along", " ", 
          RowBox[{"X", "[", 
           RowBox[{"i", ",", "i"}], "]"}]}], ",", " ", 
         RowBox[{"so", " ", 
          RowBox[{"let", "'"}], "s", " ", "place", " ", "it", " ", "first", 
          " ", "in", " ", "the", " ", 
          RowBox[{"list", ".", " ", "However"}]}], ",", " ", 
         RowBox[{"if", " ", "we", " ", "came", " ", "from", " ", 
          RowBox[{"X", "[", 
           RowBox[{"i", ",", "i"}], "]"}]}], ",", " ", 
         RowBox[{
          RowBox[{"we", " ", 
           RowBox[{"don", "'"}], "t", " ", "want", " ", "to", " ", "go", " ", 
           "back", " ", "along", " ", 
           RowBox[{"it", ".", " ", "So"}], " ", "if", " ", "currentedge"}], 
          "\[Equal]", 
          RowBox[{"X", "[", 
           RowBox[{"i", ",", "i"}], "]"}]}], ",", " ", 
         RowBox[{"place", " ", "it", " ", 
          RowBox[{"last", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"nextedges", "=", 
        RowBox[{"SortBy", "[", 
         RowBox[{"nextedges", ",", 
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"currentedge", "\[Equal]", 
          RowBox[{"nextedges", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"nextedges", "=", 
           RowBox[{"RotateLeft", "[", 
            RowBox[{"nextedges", ",", "1"}], "]"}]}], ";"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"nextedge", "=", 
        RowBox[{"nextedges", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"nextedgepos", "=", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"toplefttopright", ",", "nextedge"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"nextedge", ",", "nextedgepos"}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.662457815650985*^9, 3.662457844890075*^9}, {
   3.662457953573552*^9, 3.6624579543881006`*^9}, 3.6624580076228666`*^9, {
   3.6624645826249495`*^9, 3.662464602022482*^9}, {3.662464941974472*^9, 
   3.662465103094617*^9}, {3.662465440582826*^9, 3.662465456970776*^9}, {
   3.662465567106516*^9, 3.662465595988062*^9}, {3.6624657728253694`*^9, 
   3.662465829171506*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
     "Returns", " ", "a", " ", "list", " ", "where", " ", "the", " ", "first",
       " ", "element", " ", "is", " ", "a", " ", "list", " ", "of", " ", 
      "edges", " ", "in", " ", "the", " ", "numerator", " ", "of", " ", "a", 
      " ", "zig"}], "-", 
     RowBox[{"zag", " ", "path"}]}], ",", " ", 
    RowBox[{
     RowBox[{
     "and", " ", "the", " ", "second", " ", "element", " ", "is", " ", "a", 
      " ", "list", " ", "of", " ", "edges", " ", "in", " ", "the", " ", 
      "denominator", " ", "of", " ", "the", " ", "zig"}], "-", 
     RowBox[{"zag", " ", 
      RowBox[{"path", ".", " ", "The"}], " ", "zig"}], "-", 
     RowBox[{
     "zag", " ", "path", " ", "starts", " ", "from", " ", "an", " ", 
      "edge"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"internalZigZagNumeratorDenominator", "[", 
     RowBox[{"topleft_", ",", "startingedge_", ",", 
      RowBox[{"numeratorstart_:", "True"}]}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "numeratoredges", ",", "denominatoredges", ",", "currentedge", ",", 
        "currentposition"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{"numeratorstart", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"numeratoredges", "=", 
           RowBox[{"{", "startingedge", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"denominatoredges", "=", 
           RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{
          RowBox[{"numeratoredges", "=", 
           RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"denominatoredges", "=", 
           RowBox[{"{", "startingedge", "}"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"currentedge", "=", "startingedge"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"currentposition", "=", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"topleft", ",", "currentedge"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"numeratorstart", ",", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "We", " ", "will", " ", "first", " ", "need", " ", "to", " ", "go",
             " ", "from", " ", "a", " ", "black", " ", "vertex", " ", "to", 
            " ", "a", " ", "white", " ", "vertex"}], ",", " ", 
           RowBox[{
           "then", " ", "from", " ", "black", " ", "to", " ", "white"}], ",", 
           " ", 
           RowBox[{"and", " ", "so", " ", "on"}], ",", " ", 
           RowBox[{
           "until", " ", "reaching", " ", "the", " ", "starting", " ", 
            "point"}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"While", "[", 
           RowBox[{"True", ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
             "Now", " ", "run", " ", "along", " ", "the", " ", "column", " ", 
              "to", " ", "find", " ", "another", " ", "edge", " ", "whose", 
              " ", "first", " ", "index", " ", "is", " ", "our", " ", 
              RowBox[{"currentedge", "'"}], "s", " ", "second", " ", 
              "index"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"currentedge", ",", "currentposition"}], "}"}], "=", 
              RowBox[{"nextStepBlackToWhite", "[", 
               RowBox[{
               "topleft", ",", "currentedge", ",", "currentposition"}], 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{
               "This", " ", "new", " ", "edge", " ", "should", " ", "be", " ",
                 "placed", " ", "in", " ", "the", " ", "denominator", " ", 
                "in", " ", "the", " ", "zig"}], "-", 
               RowBox[{"zag", " ", "expression"}]}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"denominatoredges", "=", 
              RowBox[{"Append", "[", 
               RowBox[{"denominatoredges", ",", "currentedge"}], "]"}]}], ";",
              "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "Now", " ", "run", " ", "along", " ", "the", " ", "row", " ", 
               "to", " ", "find", " ", "another", " ", "edge", " ", "whose", 
               " ", "first", " ", "index", " ", "is", " ", "our", " ", 
               RowBox[{"currentedge", "'"}], "s", " ", "second", " ", 
               "index"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"currentedge", ",", "currentposition"}], "}"}], "=", 
              RowBox[{"nextStepWhiteToBlack", "[", 
               RowBox[{
               "topleft", ",", "currentedge", ",", "currentposition"}], 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"currentedge", "===", "startingedge"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Break", "[", "]"}], ";"}]}], "\[IndentingNewLine]", 
              "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{
               "This", " ", "new", " ", "edge", " ", "should", " ", "be", " ",
                 "placed", " ", "in", " ", "the", " ", "numerator", " ", "in",
                 " ", "the", " ", "zig"}], "-", 
               RowBox[{"zag", " ", "expression"}]}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"numeratoredges", "=", 
              RowBox[{"Append", "[", 
               RowBox[{"numeratoredges", ",", "currentedge"}], "]"}]}], 
             ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "We", " ", "will", " ", "first", " ", "need", " ", "to", " ", "go",
             " ", "from", " ", "a", " ", "white", " ", "vertex", " ", "to", 
            " ", "a", " ", "black", " ", "vertex"}], ",", " ", 
           RowBox[{
           "then", " ", "from", " ", "white", " ", "to", " ", "black"}], ",", 
           " ", 
           RowBox[{"and", " ", "so", " ", "on"}], ",", " ", 
           RowBox[{
           "until", " ", "reaching", " ", "the", " ", "starting", " ", 
            "point"}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"While", "[", 
           RowBox[{"True", ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
             "Now", " ", "run", " ", "along", " ", "the", " ", "row", " ", 
              "to", " ", "find", " ", "another", " ", "edge", " ", "whose", 
              " ", "first", " ", "index", " ", "is", " ", "our", " ", 
              RowBox[{"currentedge", "'"}], "s", " ", "second", " ", 
              "index"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"currentedge", ",", "currentposition"}], "}"}], "=", 
              RowBox[{"nextStepWhiteToBlack", "[", 
               RowBox[{
               "topleft", ",", "currentedge", ",", "currentposition"}], 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{
               "This", " ", "new", " ", "edge", " ", "should", " ", "be", " ",
                 "placed", " ", "in", " ", "the", " ", "denominator", " ", 
                "in", " ", "the", " ", "zig"}], "-", 
               RowBox[{"zag", " ", "expression"}]}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"numeratoredges", "=", 
              RowBox[{"Append", "[", 
               RowBox[{"numeratoredges", ",", "currentedge"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "Now", " ", "run", " ", "along", " ", "the", " ", "column", " ",
                "to", " ", "find", " ", "another", " ", "edge", " ", "whose", 
               " ", "first", " ", "index", " ", "is", " ", "our", " ", 
               RowBox[{"currentedge", "'"}], "s", " ", "second", " ", 
               "index"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"currentedge", ",", "currentposition"}], "}"}], "=", 
              RowBox[{"nextStepBlackToWhite", "[", 
               RowBox[{
               "topleft", ",", "currentedge", ",", "currentposition"}], 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"currentedge", "===", "startingedge"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Break", "[", "]"}], ";"}]}], "\[IndentingNewLine]", 
              "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{
               "This", " ", "new", " ", "edge", " ", "should", " ", "be", " ",
                 "placed", " ", "in", " ", "the", " ", "numerator", " ", "in",
                 " ", "the", " ", "zig"}], "-", 
               RowBox[{"zag", " ", "expression"}]}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"denominatoredges", "=", 
              RowBox[{"Append", "[", 
               RowBox[{"denominatoredges", ",", "currentedge"}], "]"}]}], 
             ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"numeratoredges", ",", "denominatoredges"}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.66245567819843*^9, 3.662455752889821*^9}, {
   3.6624572465209255`*^9, 3.662457319313676*^9}, {3.662457354721411*^9, 
   3.6624573785962453`*^9}, {3.6624574775980625`*^9, 
   3.6624574956204343`*^9}, {3.6624577187429028`*^9, 3.662457738730031*^9}, {
   3.6624577739180965`*^9, 3.6624578033262196`*^9}, {3.6624578645323696`*^9, 
   3.662457891029151*^9}, 3.6624580076228666`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
     "Returns", " ", "a", " ", "list", " ", "where", " ", "each", " ", 
      "element", " ", "corresponds", " ", "to", " ", "a", " ", "zig"}], "-", 
     RowBox[{"zag", " ", 
      RowBox[{"path", ".", " ", "The"}], " ", "information", " ", "is", " ", 
      "given", " ", "as", " ", "a", " ", "list", " ", "of", " ", "two", " ", 
      "elements"}]}], ",", " ", 
    RowBox[{
    "where", " ", "the", " ", "first", " ", "element", " ", "contains", " ", 
     "all", " ", "variables", " ", "in", " ", "the", " ", "numerator", " ", 
     "of", " ", "the", " ", "expression"}], ",", " ", 
    RowBox[{
    "and", " ", "the", " ", "second", " ", "element", " ", "contains", " ", 
     "the", " ", "variables", " ", "in", " ", "the", " ", 
     RowBox[{"denominator", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"allZigZagNumeratorsDenominators", "[", 
     RowBox[{
     "topleft_", ",", "topright_", ",", "bottomleft_", ",", "bottomright_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "kasteleyn", ",", "bottomleftvars", ",", "toprightvars", ",", 
        "blacktowhitematrix", ",", "whitetoblackmatrix", ",", 
        "zigZagFromExternalWhiteNode", ",", "zigZagFromExternalBlackNode", 
        ",", "bottomleftzigzags", ",", "toprightzigzags", ",", 
        "allnumeratoredges", ",", "alldenominatoredges", ",", 
        "internalzigzagedges", ",", "internalzigzags", ",", "internalzigzag", 
        ",", "allzigzags"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"kasteleyn", "=", 
        RowBox[{"joinupKasteleyn", "[", 
         RowBox[{
         "topleft", ",", "topright", ",", "bottomleft", ",", "bottomright"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"bottomleftvars", "=", 
        RowBox[{"Variables", "[", "bottomleft", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"toprightvars", "=", 
        RowBox[{"Variables", "[", "topright", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"blacktowhitematrix", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"topleft", ",", "bottomleft"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"whitetoblackmatrix", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"topleft", ",", "topright", ",", "2"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"zigZagFromExternalWhiteNode", "=", 
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", "startingedge", "}"}], ",", 
          RowBox[{"Block", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "currentedge", ",", "currentposition", ",", "denominatoredges", 
              ",", "numeratoredges"}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"numeratoredges", "=", 
              RowBox[{"{", "startingedge", "}"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"denominatoredges", "=", 
              RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"currentedge", "=", "startingedge"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"currentposition", "=", 
              RowBox[{
               RowBox[{"Position", "[", 
                RowBox[{"kasteleyn", ",", "currentedge"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"While", "[", 
              RowBox[{"True", ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"currentedge", ",", "currentposition"}], "}"}], "=", 
                 RowBox[{"nextStepBlackToWhite", "[", 
                  RowBox[{
                  "blacktowhitematrix", ",", "currentedge", ",", 
                   "currentposition"}], "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"denominatoredges", "=", 
                 RowBox[{"Append", "[", 
                  RowBox[{"denominatoredges", ",", "currentedge"}], "]"}]}], 
                ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"MemberQ", "[", 
                   RowBox[{
                    RowBox[{"Join", "[", 
                    RowBox[{"bottomleftvars", ",", "toprightvars"}], "]"}], 
                    ",", "currentedge"}], "]"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Break", "[", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"currentedge", ",", "currentposition"}], "}"}], "=", 
                 RowBox[{"nextStepWhiteToBlack", "[", 
                  RowBox[{
                  "whitetoblackmatrix", ",", "currentedge", ",", 
                   "currentposition"}], "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"numeratoredges", "=", 
                 RowBox[{"Append", "[", 
                  RowBox[{"numeratoredges", ",", "currentedge"}], "]"}]}], 
                ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"MemberQ", "[", 
                   RowBox[{
                    RowBox[{"Join", "[", 
                    RowBox[{"bottomleftvars", ",", "toprightvars"}], "]"}], 
                    ",", "currentedge"}], "]"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Break", "[", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"numeratoredges", ",", "denominatoredges"}], "}"}]}]}], 
           "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"zigZagFromExternalBlackNode", "=", 
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", "startingedge", "}"}], ",", 
          RowBox[{"Block", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "currentedge", ",", "currentposition", ",", "denominatoredges", 
              ",", "numeratoredges"}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"numeratoredges", "=", 
              RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"denominatoredges", "=", 
              RowBox[{"{", "startingedge", "}"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"currentedge", "=", "startingedge"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"currentposition", "=", 
              RowBox[{
               RowBox[{"Position", "[", 
                RowBox[{"kasteleyn", ",", "currentedge"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"While", "[", 
              RowBox[{"True", ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"currentedge", ",", "currentposition"}], "}"}], "=", 
                 RowBox[{"nextStepWhiteToBlack", "[", 
                  RowBox[{
                  "whitetoblackmatrix", ",", "currentedge", ",", 
                   "currentposition"}], "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"numeratoredges", "=", 
                 RowBox[{"Append", "[", 
                  RowBox[{"numeratoredges", ",", "currentedge"}], "]"}]}], 
                ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"MemberQ", "[", 
                   RowBox[{
                    RowBox[{"Join", "[", 
                    RowBox[{"bottomleftvars", ",", "toprightvars"}], "]"}], 
                    ",", "currentedge"}], "]"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Break", "[", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"currentedge", ",", "currentposition"}], "}"}], "=", 
                 RowBox[{"nextStepBlackToWhite", "[", 
                  RowBox[{
                  "blacktowhitematrix", ",", "currentedge", ",", 
                   "currentposition"}], "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"denominatoredges", "=", 
                 RowBox[{"Append", "[", 
                  RowBox[{"denominatoredges", ",", "currentedge"}], "]"}]}], 
                ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"MemberQ", "[", 
                   RowBox[{
                    RowBox[{"Join", "[", 
                    RowBox[{"bottomleftvars", ",", "toprightvars"}], "]"}], 
                    ",", "currentedge"}], "]"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Break", "[", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"numeratoredges", ",", "denominatoredges"}], "}"}]}]}], 
           "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"bottomleftzigzags", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"zigZagFromExternalWhiteNode", "[", "#", "]"}], "&"}], ",",
           "bottomleftvars"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"toprightzigzags", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"zigZagFromExternalBlackNode", "[", "#", "]"}], "&"}], ",",
           "toprightvars"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"allnumeratoredges", "=", 
        RowBox[{"Sort", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", 
            RowBox[{"Join", "[", 
             RowBox[{"bottomleftzigzags", ",", "toprightzigzags"}], "]"}]}], 
           "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"alldenominatoredges", "=", 
        RowBox[{"Sort", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "&"}], ",", 
            RowBox[{"Join", "[", 
             RowBox[{"bottomleftzigzags", ",", "toprightzigzags"}], "]"}]}], 
           "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "If", " ", "there", " ", "are", " ", "any", " ", "edges", " ", 
          "that", " ", "do", " ", "not", " ", "appear", " ", "in", " ", "any",
           " ", "of", " ", "the", " ", "numerators"}], ",", " ", 
         RowBox[{
          RowBox[{"we", " ", "must", " ", "have", " ", "a", " ", "zig"}], "-", 
          RowBox[{
          "zag", " ", "path", " ", "which", " ", "is", " ", "purely", " ", 
           "internal"}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"internalzigzagedges", "=", 
        RowBox[{"Complement", "[", 
         RowBox[{
          RowBox[{"Variables", "[", "kasteleyn", "]"}], ",", 
          "allnumeratoredges"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"internalzigzags", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{"internalzigzagedges", "=!=", 
          RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"internalzigzag", "=", 
           RowBox[{"internalZigZagNumeratorDenominator", "[", 
            RowBox[{"topleft", ",", 
             RowBox[{"internalzigzagedges", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"internalzigzags", "=", 
           RowBox[{"Append", "[", 
            RowBox[{"internalzigzags", ",", "internalzigzag"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"allnumeratoredges", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"allnumeratoredges", ",", 
             RowBox[{"internalzigzag", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"alldenominatoredges", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"alldenominatoredges", ",", 
             RowBox[{"internalzigzag", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"internalzigzagedges", "=", 
           RowBox[{"Complement", "[", 
            RowBox[{
             RowBox[{"Variables", "[", "kasteleyn", "]"}], ",", 
             "allnumeratoredges"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"internalzigzagedges", "=", 
        RowBox[{"Complement", "[", 
         RowBox[{
          RowBox[{"Variables", "[", "kasteleyn", "]"}], ",", 
          "alldenominatoredges"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{"internalzigzagedges", "=!=", 
          RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"internalzigzag", "=", 
           RowBox[{"internalZigZagNumeratorDenominator", "[", 
            RowBox[{"topleft", ",", 
             RowBox[{"internalzigzagedges", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "False"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"internalzigzags", "=", 
           RowBox[{"Append", "[", 
            RowBox[{"internalzigzags", ",", "internalzigzag"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"allnumeratoredges", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"allnumeratoredges", ",", 
             RowBox[{"internalzigzag", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"alldenominatoredges", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"alldenominatoredges", ",", 
             RowBox[{"internalzigzag", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"internalzigzagedges", "=", 
           RowBox[{"Complement", "[", 
            RowBox[{
             RowBox[{"Variables", "[", "kasteleyn", "]"}], ",", 
             "alldenominatoredges"}], "]"}]}], ";"}]}], "\[IndentingNewLine]",
         "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "Now", " ", "all", " ", "edges", " ", "have", " ", "appeared", " ", 
          "in", " ", "the", " ", "numerator", " ", "of", " ", "some", " ", 
          "zig"}], "-", 
         RowBox[{
         "zag", " ", "and", " ", "the", " ", "denominator", " ", "of", " ", 
          "some", " ", 
          RowBox[{"(", 
           RowBox[{"possibly", " ", "the", " ", "same"}], ")"}], " ", "zig"}],
          "-", "zag"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"allzigzags", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
         "bottomleftzigzags", ",", "toprightzigzags", ",", 
          "internalzigzags"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{
          "If", " ", "there", " ", "are", " ", "any", " ", "edges", " ", 
           "that", " ", "do", " ", "not", " ", "appear", " ", "in", " ", 
           "the", " ", "actual", " ", "expressions", " ", "for", " ", "the", 
           " ", "zig"}], "-", "zags"}], ",", " ", 
         RowBox[{
          RowBox[{
          "it", " ", "means", " ", "we", " ", "have", " ", "a", " ", "self"}],
           "-", 
          RowBox[{"intersecting", " ", "zig"}], "-", "zag"}]}], "*)"}], 
       "\[IndentingNewLine]", "allzigzags"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6624625583950324`*^9, 3.662462596688583*^9}, {
   3.6624628261894846`*^9, 3.662462962736776*^9}, 3.662463004826274*^9, {
   3.662466835684181*^9, 3.662466930717038*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Returns", " ", "a", " ", "list", " ", "of", " ", "zig"}], "-", 
     RowBox[{"zag", " ", 
      RowBox[{"paths", ".", " ", "Edges"}], " ", "in", " ", "the", " ", 
      "numerator", " ", "are", " ", "directed", " ", "from", " ", "white", 
      " ", "to", " ", "black", " ", "nodes"}]}], ",", " ", 
    RowBox[{
     RowBox[{
     "edges", " ", "in", " ", "the", " ", "denominator", " ", "are", " ", 
      "directed", " ", "from", " ", "black", " ", "to", " ", "white", " ", 
      RowBox[{"nodes", ".", " ", "The"}], " ", "standard", " ", "rule", " ", 
      "is", " ", "to", " ", "turn", " ", "left", " ", "at", " ", "white", " ",
       "nodes", " ", "and", " ", "right", " ", "at", " ", "black", " ", 
      "nodes"}], ";", " ", 
     RowBox[{
      RowBox[{"it", "'"}], "s", " ", "possible", " ", "to", " ", "choose", 
      " ", "the", " ", "opposite", " ", "option", " ", "by", " ", "setting", 
      " ", "the", " ", 
      RowBox[{"(", "optional", ")"}], " ", "final", " ", "argument", " ", 
      "to", " ", 
      RowBox[{"True", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"makeZigZags", "[", 
     RowBox[{
     "topleft_", ",", "topright_", ",", "bottomleft_", ",", "bottomright_", 
      ",", 
      RowBox[{"invertedrule_:", "False"}]}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"graphOK", ",", "allzigzags", ",", "zigzagexpressions"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"graphOK", "=", 
        RowBox[{"checkKasteleynQ", "[", 
         RowBox[{
         "topleft", ",", "topright", ",", "bottomleft", ",", "bottomright", 
          ",", "True"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"graphOK", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"allzigzags", "=", 
           RowBox[{"allZigZagNumeratorsDenominators", "[", 
            RowBox[{
            "topleft", ",", "topright", ",", "bottomleft", ",", 
             "bottomright"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"zigzagexpressions", "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"Times", "@@", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{"Times", "@@", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}], "&"}], ",", 
             "allzigzags"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
            "If", " ", "we", " ", "want", " ", "to", " ", "turn", " ", 
             "right", " ", "at", " ", "white", " ", "nodes", " ", "and", " ", 
             "left", " ", "at", " ", "black", " ", "nodes"}], ",", " ", 
            RowBox[{
             RowBox[{"all", " ", "the", " ", "zig"}], "-", 
             RowBox[{"zags", " ", "are", " ", "inverted"}]}]}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{"invertedrule", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"zigzagexpressions", "=", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"1", "/", "#"}], "&"}], ",", "zigzagexpressions"}], 
               "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{
          RowBox[{
          "Print", "[", 
           "\"\<The graph must be of BFT type for this function to work: \
edges must be of the form _[_Integer,_Integer] and be labeled according the \
numbering of faces.\>\"", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"zigzagexpressions", "=", "Null"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "zigzagexpressions"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.662445857859374*^9, 3.662445898603388*^9}, {
   3.6624462204280815`*^9, 3.662446385319795*^9}, {3.6624469314979324`*^9, 
   3.662446993178527*^9}, {3.662467001301428*^9, 3.6624670035944414`*^9}, {
   3.6624674791664176`*^9, 3.6624675112676425`*^9}, {3.662467745687738*^9, 
   3.66246774708368*^9}, {3.6624678727178135`*^9, 3.6624679322842207`*^9}, {
   3.6624679766561236`*^9, 3.662468087803434*^9}, 3.662468885723651*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Tells", " ", "you", " ", "whether", " ", "the", " ", "graph", " ", "has",
      " ", "self"}], "-", 
    RowBox[{"intersecting", " ", "zig"}], "-", 
    RowBox[{"zag", " ", 
     RowBox[{"paths", ".", " ", "Returns"}], " ", "True", " ", "or", " ", 
     RowBox[{"False", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"selfIntersectingZigZagsQ", "[", 
     RowBox[{
     "topleft_", ",", "topright_", ",", "bottomleft_", ",", "bottomright_"}], 
     "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "graphOK", ",", "allzigzags", ",", "selfintersectingzigzags", ",", 
        "selfintersections"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"graphOK", "=", 
        RowBox[{"checkKasteleynQ", "[", 
         RowBox[{
         "topleft", ",", "topright", ",", "bottomleft", ",", "bottomright", 
          ",", "True"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"graphOK", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"allzigzags", "=", 
           RowBox[{"allZigZagNumeratorsDenominators", "[", 
            RowBox[{
            "topleft", ",", "topright", ",", "bottomleft", ",", 
             "bottomright"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"selfintersectingzigzags", "=", 
           RowBox[{"Cases", "[", 
            RowBox[{"allzigzags", ",", 
             RowBox[{"zz_", "/;", 
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"Intersection", "[", 
                 RowBox[{
                  RowBox[{"zz", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"zz", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], ">", 
               "0"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "selfintersectingzigzags", "]"}], "=!=", 
             "0"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"selfintersections", "=", "True"}], ";"}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{
             RowBox[{"selfintersections", "=", "False"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{
          RowBox[{
          "Print", "[", 
           "\"\<The graph must be of BFT type for this function to work: \
edges must be of the form _[_Integer,_Integer] and be labeled according the \
numbering of faces.\>\"", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"selfintersections", "=", "Null"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "selfintersections"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.662462993354229*^9, 3.662463017870747*^9}, {
   3.6624670531059513`*^9, 3.6624672082764177`*^9}, {3.662467249602076*^9, 
   3.6624673015449114`*^9}, {3.662468306372083*^9, 3.662468400575667*^9}, {
   3.6624688248673573`*^9, 3.6624688527112103`*^9}, 3.6624688857246523`*^9}]
}, Closed]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.662290243390891*^9, 3.6622902442414293`*^9}, {
  3.6623006647902784`*^9, 3.662300665588108*^9}, {3.6623663758873444`*^9, 
  3.66236637618431*^9}, {3.662446391940854*^9, 3.6624463925580764`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"selfIntersectingZigZagsQ", "[", 
  RowBox[{"topleft", ",", "topright", ",", "bottomleft", ",", "bottomright"}],
   "]"}]], "Input",
 CellChangeTimes->{{3.662468225869001*^9, 3.66246827045686*^9}, {
  3.6624686236644716`*^9, 3.6624686264959517`*^9}}],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{{3.662468222704373*^9, 3.6624682764959135`*^9}, {
   3.6624686269722657`*^9, 3.6624686707018037`*^9}, {3.662468774356163*^9, 
   3.6624688049464407`*^9}, 3.66246888954679*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6624653265218368`*^9, 3.6624653269025793`*^9}, {
   3.6624660154584384`*^9, 3.662466016037818*^9}, 3.6624670080582604`*^9, {
   3.6624670465479403`*^9, 3.6624670501727486`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "These", " ", "functions", " ", "are", " ", "OLD", " ", "superceded", " ", 
   RowBox[{"functions", ":", "           ", 
    RowBox[{
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", "--"}]}]}], ">", "     ", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", "--"}]}]}], ">", "     ", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", "--"}]}]}], ">", "     ", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", "--"}]}]}], ">", "     ", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", "--"}]}]}], ">", "     ", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", "--"}]}]}], ">"}]}]}], "  ", "*)"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.662363489640792*^9, 3.662363523430889*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"OLDmakeZigzags", "[", 
   RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "K0full", ",", "bvar", ",", "cvar", ",", "ci", ",", "field", ",", 
      "rowpos", ",", "colpos", ",", "column", ",", "row", ",", "j"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "Print", "[", 
      "\"\<zig-zags are stored under \!\(\*SubscriptBox[\(zig\), \(i\)]\)=... \
 and zigzag={list of all \!\(\*SubscriptBox[\(zig\), \(i\)]\)}\>\"", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"K0full", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{"a", ",", "c"}], "]"}], ",", 
        RowBox[{"Join", "[", 
         RowBox[{"b", ",", "d"}], "]"}], ",", "2"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"bvar", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", "b", "]"}], ",", "0"}], "]"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{"Variables", " ", "in", " ", "b"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"cvar", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", "c", "]"}], ",", "0"}], "]"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{"Variables", " ", "in", " ", "c"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"zigzag", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"First", " ", "go", " ", "throgh", " ", "the", " ", "zig"}], 
       "-", 
       RowBox[{
       "zags", " ", "starting", " ", "from", " ", "white", " ", "nodes", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"i", ".", "e", ".", " ", "starting"}], " ", "from", " ", 
          "fields", " ", "in", " ", "the", "  ", "matrix", " ", "c"}]}]}]}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"ci", "=", "1"}], ",", 
       RowBox[{"ci", "<", 
        RowBox[{
         RowBox[{"Length", "[", "c", "]"}], "+", "1"}]}], ",", 
       RowBox[{"ci", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"field", "=", 
         RowBox[{
          RowBox[{"DeleteCases", "[", 
           RowBox[{
            RowBox[{"c", "[", 
             RowBox[{"[", "ci", "]"}], "]"}], ",", "0"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         SubscriptBox["zig", "ci"], "=", "field"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"rowpos", "=", 
         RowBox[{
          RowBox[{"Length", "[", "a", "]"}], "+", "ci"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{"True", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"colpos", "=", 
            RowBox[{
             RowBox[{"Position", "[", 
              RowBox[{
               RowBox[{"K0full", "[", 
                RowBox[{"[", "rowpos", "]"}], "]"}], ",", "field"}], "]"}], 
             "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
           RowBox[{"(*", 
            RowBox[{
            "colpos", " ", "is", " ", "the", " ", "column", " ", "number", 
             " ", "this", " ", "field", " ", "is", " ", "in"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "Now", " ", "look", " ", "for", " ", "its", " ", "partner", " ", 
             "in", " ", "the", " ", "column"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"column", "=", 
            RowBox[{"DeleteCases", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Transpose", "[", "K0full", "]"}], "[", 
               RowBox[{"[", "colpos", "]"}], "]"}], ",", "0"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "1"}], ",", 
             RowBox[{"j", "<", 
              RowBox[{
               RowBox[{"Length", "[", "column", "]"}], "+", "1"}]}], ",", 
             RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"sub1", "[", 
                  RowBox[{"column", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "]"}], "\[Equal]", 
                 RowBox[{"sub2", "[", "field", "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  SubscriptBox["zig", "ci"], "=", 
                  RowBox[{
                   SubscriptBox["zig", "ci"], "/", 
                   RowBox[{"column", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"field", "=", 
                  RowBox[{"column", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", 
               "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"If", " ", 
              RowBox[{"we", "'"}], "ve", " ", "ended", " ", "up", " ", 
              "inside", " ", "c"}], ",", " ", 
             RowBox[{
              RowBox[{
              "this", " ", "is", " ", "the", " ", "end", " ", "of", " ", 
               "the", " ", "zig"}], "-", "zag"}]}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{"cvar", ",", "field"}], "]"}], ",", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
                RowBox[{"Subscript", "[", 
                 RowBox[{"\"\<zig\>\"", ",", "ci"}], "]"}], ",", 
                "\"\< = \>\"", ",", 
                SubscriptBox["zig", "ci"]}], "]"}], ";", 
              RowBox[{"zigzag", "=", 
               RowBox[{"Join", "[", 
                RowBox[{"zigzag", ",", 
                 RowBox[{"{", 
                  SubscriptBox["zig", "ci"], "}"}]}], "]"}]}], ";", 
              RowBox[{"Break", "[", "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "Find", " ", "which", " ", "row", " ", "number", " ", "this", " ",
              "new", " ", "field", " ", "has"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"rowpos", "=", 
            RowBox[{
             RowBox[{"Position", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Transpose", "[", "K0full", "]"}], "[", 
                RowBox[{"[", "colpos", "]"}], "]"}], ",", "field"}], "]"}], 
             "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "Now", " ", "look", " ", "for", " ", "its", " ", "partner", " ", 
             "in", " ", "the", " ", "row"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"row", "=", 
            RowBox[{"DeleteCases", "[", 
             RowBox[{
              RowBox[{"K0full", "[", 
               RowBox[{"[", "rowpos", "]"}], "]"}], ",", "0"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "1"}], ",", 
             RowBox[{"j", "<", 
              RowBox[{
               RowBox[{"Length", "[", "row", "]"}], "+", "1"}]}], ",", 
             RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"sub1", "[", 
                  RowBox[{"row", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "]"}], "\[Equal]", 
                 RowBox[{"sub2", "[", "field", "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  SubscriptBox["zig", "ci"], "=", 
                  RowBox[{
                   SubscriptBox["zig", "ci"], 
                   RowBox[{"row", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"field", "=", 
                  RowBox[{"row", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", 
               "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"If", " ", 
              RowBox[{"we", "'"}], "ve", " ", "ended", " ", "up", " ", 
              "inside", " ", "b"}], ",", " ", 
             RowBox[{
              RowBox[{
              "this", " ", "is", " ", "the", " ", "end", " ", "of", " ", 
               "the", " ", "zig"}], "-", "zag"}]}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{"bvar", ",", "field"}], "]"}], ",", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
                RowBox[{"Subscript", "[", 
                 RowBox[{"\"\<zig\>\"", ",", "ci"}], "]"}], ",", 
                "\"\< = \>\"", ",", 
                SubscriptBox["zig", "ci"]}], "]"}], ";", 
              RowBox[{"zigzag", "=", 
               RowBox[{"Join", "[", 
                RowBox[{"zigzag", ",", 
                 RowBox[{"{", 
                  SubscriptBox["zig", "ci"], "}"}]}], "]"}]}], ";", 
              RowBox[{"Break", "[", "]"}]}]}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Now", " ", "go", " ", "throgh", " ", "the", " ", "zig"}], "-", 
       RowBox[{
       "zags", " ", "starting", " ", "from", " ", "black", " ", "nodes", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"i", ".", "e", ".", " ", "starting"}], " ", "from", " ", 
          "fields", " ", "in", " ", "the", "  ", "matrix", " ", "b"}]}]}]}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"bi", "=", "1"}], ",", 
       RowBox[{"bi", "<", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"Transpose", "[", "b", "]"}], "]"}], "+", "1"}]}], ",", 
       RowBox[{"bi", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"field", "=", 
         RowBox[{
          RowBox[{"DeleteCases", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Transpose", "[", "b", "]"}], "[", 
             RowBox[{"[", "bi", "]"}], "]"}], ",", "0"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         SubscriptBox["zig", 
          RowBox[{
           RowBox[{"Length", "[", "c", "]"}], "+", "bi"}]], "=", 
         RowBox[{"1", "/", "field"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"colpos", "=", 
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"Transpose", "[", "a", "]"}], "]"}], "+", "bi"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{"True", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"rowpos", "=", 
            RowBox[{
             RowBox[{"Position", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Transpose", "[", "K0full", "]"}], "[", 
                RowBox[{"[", "colpos", "]"}], "]"}], ",", "field"}], "]"}], 
             "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "Now", " ", "look", " ", "for", " ", "its", " ", "partner", " ", 
             "in", " ", "the", " ", "row"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"row", "=", 
            RowBox[{"DeleteCases", "[", 
             RowBox[{
              RowBox[{"K0full", "[", 
               RowBox[{"[", "rowpos", "]"}], "]"}], ",", "0"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "1"}], ",", 
             RowBox[{"j", "<", 
              RowBox[{
               RowBox[{"Length", "[", "row", "]"}], "+", "1"}]}], ",", 
             RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"sub1", "[", 
                  RowBox[{"row", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "]"}], "\[Equal]", 
                 RowBox[{"sub2", "[", "field", "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  SubscriptBox["zig", 
                   RowBox[{
                    RowBox[{"Length", "[", "c", "]"}], "+", "bi"}]], "=", 
                  RowBox[{
                   SubscriptBox["zig", 
                    RowBox[{
                    RowBox[{"Length", "[", "c", "]"}], "+", "bi"}]], 
                   RowBox[{"row", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"field", "=", 
                  RowBox[{"row", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", 
               "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"If", " ", 
              RowBox[{"we", "'"}], "ve", " ", "ended", " ", "up", " ", 
              "inside", " ", "b"}], ",", " ", 
             RowBox[{
              RowBox[{
              "this", " ", "is", " ", "the", " ", "end", " ", "of", " ", 
               "the", " ", "zig"}], "-", "zag"}]}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{"bvar", ",", "field"}], "]"}], ",", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
                RowBox[{"Subscript", "[", 
                 RowBox[{"\"\<zig\>\"", ",", 
                  RowBox[{
                   RowBox[{"Length", "[", "c", "]"}], "+", "bi"}]}], "]"}], 
                ",", "\"\< = \>\"", ",", 
                SubscriptBox["zig", 
                 RowBox[{
                  RowBox[{"Length", "[", "c", "]"}], "+", "bi"}]]}], "]"}], 
              ";", 
              RowBox[{"zigzag", "=", 
               RowBox[{"Join", "[", 
                RowBox[{"zigzag", ",", 
                 RowBox[{"{", 
                  SubscriptBox["zig", 
                   RowBox[{
                    RowBox[{"Length", "[", "c", "]"}], "+", "bi"}]], "}"}]}], 
                "]"}]}], ";", 
              RowBox[{"Break", "[", "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "Find", " ", "out", " ", "which", " ", "column", " ", "number", 
             " ", "this", " ", "new", " ", "field", " ", "has"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"colpos", "=", 
            RowBox[{
             RowBox[{"Position", "[", 
              RowBox[{
               RowBox[{"K0full", "[", 
                RowBox[{"[", "rowpos", "]"}], "]"}], ",", "field"}], "]"}], 
             "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "Now", " ", "look", " ", "for", " ", "its", " ", "partner", " ", 
             "in", " ", "the", " ", "column"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"column", "=", 
            RowBox[{"DeleteCases", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Transpose", "[", "K0full", "]"}], "[", 
               RowBox[{"[", "colpos", "]"}], "]"}], ",", "0"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"j", "=", "1"}], ",", 
             RowBox[{"j", "<", 
              RowBox[{
               RowBox[{"Length", "[", "column", "]"}], "+", "1"}]}], ",", 
             RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"sub1", "[", 
                  RowBox[{"column", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "]"}], "\[Equal]", 
                 RowBox[{"sub2", "[", "field", "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  SubscriptBox["zig", 
                   RowBox[{
                    RowBox[{"Length", "[", "c", "]"}], "+", "bi"}]], "=", 
                  RowBox[{
                   SubscriptBox["zig", 
                    RowBox[{
                    RowBox[{"Length", "[", "c", "]"}], "+", "bi"}]], "/", 
                   RowBox[{"column", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"field", "=", 
                  RowBox[{"column", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", 
               "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"If", " ", 
              RowBox[{"we", "'"}], "ve", " ", "ended", " ", "up", " ", 
              "inside", " ", "c"}], ",", " ", 
             RowBox[{
              RowBox[{
              "this", " ", "is", " ", "the", " ", "end", " ", "of", " ", 
               "the", " ", "zig"}], "-", "zag"}]}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{"cvar", ",", "field"}], "]"}], ",", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
                RowBox[{"Subscript", "[", 
                 RowBox[{"\"\<zig\>\"", ",", 
                  RowBox[{
                   RowBox[{"Length", "[", "c", "]"}], "+", "bi"}]}], "]"}], 
                ",", "\"\< = \>\"", ",", 
                SubscriptBox["zig", 
                 RowBox[{
                  RowBox[{"Length", "[", "c", "]"}], "+", "bi"}]]}], "]"}], 
              ";", 
              RowBox[{"zigzag", "=", 
               RowBox[{"Join", "[", 
                RowBox[{"zigzag", ",", 
                 RowBox[{"{", 
                  SubscriptBox["zig", 
                   RowBox[{
                    RowBox[{"Length", "[", "c", "]"}], "+", "bi"}]], "}"}]}], 
                "]"}]}], ";", 
              RowBox[{"Break", "[", "]"}]}]}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6624458414613523`*^9, 3.6624458483489103`*^9}}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6623634909379416`*^9, 3.662363491244109*^9}, {
  3.6623663703598423`*^9, 3.662366370837639*^9}, {3.662371430955336*^9, 
  3.662371432702133*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"removableEdges", "[", 
   RowBox[{
   "topleft", ",", "topright", ",", "bottomleft", ",", "bottomright", ",", 
    "True", ",", "True", ",", "2"}], "]"}], "//", "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.6623638282983027`*^9, 3.6623638584783545`*^9}, {
   3.662363891109058*^9, 3.662363894305376*^9}, {3.6623641206677036`*^9, 
   3.662364173618044*^9}, {3.662364413986817*^9, 3.6623644178064938`*^9}, {
   3.662364539049565*^9, 3.6623645395895324`*^9}, {3.6623649396934333`*^9, 
   3.662364941483932*^9}, {3.662366314562131*^9, 3.6623663234741087`*^9}, 
   3.6623715507138863`*^9, {3.6623799635128965`*^9, 3.6623799911355085`*^9}, {
   3.6623804264878674`*^9, 3.6623804270852222`*^9}, 3.6623872437405415`*^9, 
   3.662441863180255*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.6111711068588255`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"X", "[", 
       RowBox[{"1", ",", "7"}], "]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"X", "[", 
       RowBox[{"3", ",", "2"}], "]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"X", "[", 
       RowBox[{"3", ",", "6"}], "]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"X", "[", 
       RowBox[{"6", ",", "9"}], "]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"X", "[", 
       RowBox[{"8", ",", "3"}], "]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"X", "[", 
       RowBox[{"12", ",", "4"}], "]"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6623638438982735`*^9, 3.662363895533452*^9}, {
   3.6623639936500316`*^9, 3.662363998777014*^9}, 3.66236412845333*^9, 
   3.662364193010928*^9, 3.662364419221098*^9, {3.662364534218148*^9, 
   3.6623645544652095`*^9}, {3.6623649326298857`*^9, 3.6623649441645575`*^9}, 
   3.6623650448679943`*^9, {3.662365173172307*^9, 3.662365186844942*^9}, {
   3.6623652179928493`*^9, 3.6623652231356897`*^9}, 3.6623657606191196`*^9, {
   3.662365930776641*^9, 3.6623659603957667`*^9}, {3.6623662984413214`*^9, 
   3.662366325796025*^9}, 3.6623720458114567`*^9, {3.662379971319309*^9, 
   3.662379997975154*^9}, {3.6623804241751614`*^9, 3.662380429857545*^9}, 
   3.6623845097045193`*^9, {3.6623872258833656`*^9, 3.6623872534018784`*^9}, {
   3.6624418238858356`*^9, 3.6624418273088837`*^9}, 3.662441867807579*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"OLDremovableEdges", "[", 
   RowBox[{
   "topleft", ",", "topright", ",", "bottomleft", ",", "bottomright", ",", 
    "True", ",", "True", ",", "2"}], "]"}], "//", "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.662364542693554*^9, 3.662364548860528*^9}, {
   3.66236653015969*^9, 3.6623665519013767`*^9}, {3.6623666643563104`*^9, 
   3.6623666794348917`*^9}, {3.662371444601447*^9, 3.6623714452829933`*^9}, {
   3.662371555487186*^9, 3.662371560315343*^9}, {3.662379261772619*^9, 
   3.6623792623569107`*^9}, {3.6623793666001205`*^9, 3.662379367193643*^9}, 
   3.662379789521763*^9, 3.662441831238229*^9, 3.662441864954756*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.7767814175620413`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"X", "[", 
       RowBox[{"1", ",", "7"}], "]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"X", "[", 
       RowBox[{"3", ",", "2"}], "]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"X", "[", 
       RowBox[{"3", ",", "6"}], "]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"X", "[", 
       RowBox[{"6", ",", "9"}], "]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"X", "[", 
       RowBox[{"8", ",", "3"}], "]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"X", "[", 
       RowBox[{"12", ",", "4"}], "]"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.662364210549591*^9, {3.662364549807155*^9, 3.662364551722001*^9}, {
   3.6623665404553394`*^9, 3.662366571363897*^9}, {3.6623666655953913`*^9, 
   3.662366679706189*^9}, {3.6623714385348043`*^9, 3.662371447054167*^9}, {
   3.662371558816727*^9, 3.6623715953947563`*^9}, {3.662372051432028*^9, 
   3.6623720558873053`*^9}, 3.66237928147289*^9, {3.662379339242131*^9, 
   3.66237937124415*^9}, {3.6623794538416395`*^9, 3.6623794593798327`*^9}, {
   3.662379780271655*^9, 3.6623797872677927`*^9}, 3.6624418371083384`*^9, 
   3.662441869675748*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.662190126744543*^9, 3.6621901279559746`*^9}}],

Cell[CellGroupData[{

Cell["Here is all of the code in allBFTfunctions", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6383446299830313`*^9, 3.6383446727849455`*^9}, 
   3.638344710554902*^9, {3.64224303461718*^9, 3.642243068687608*^9}, {
   3.6422454702081013`*^9, 3.6422455111219*^9}, {3.64224555395127*^9, 
   3.6422455767021837`*^9}, {3.642245629828741*^9, 3.642245680063313*^9}, 
   3.6506921124964247`*^9, {3.661686864705759*^9, 3.6616868958526716`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "To", " ", "calculate", " ", "the", " ", "dimension", " ", "of", " ", "a", 
    " ", "polytope"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"BFTdim", "[", "mat_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"newsp", ",", "gi", ",", "dim"}], "}"}], ",", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", "mat", "]"}], ",", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0", ",", 
             RowBox[{"Length", "[", "mat", "]"}]}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"dim", "=", 
           RowBox[{"MatrixRank", "[", "mat", "]"}]}], ";"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{
          RowBox[{"newsp", "=", "mat"}], ";", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"gi", "=", "1"}], ",", 
            RowBox[{"gi", "<", 
             RowBox[{
              RowBox[{
               RowBox[{"Dimensions", "[", "mat", "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "1"}]}], ",", 
            RowBox[{"gi", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"newsp", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "gi"}], "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{"newsp", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "gi"}], "]"}], "]"}], "-", 
               RowBox[{"mat", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"dim", "=", 
           RowBox[{"MatrixRank", "[", "newsp", "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "dim"}]}], "]"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"DONE", ",", " ", 
    RowBox[{"NOW", " ", "CALLED", " ", "polytopeDim"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "To", " ", "obtain", " ", "the", " ", "coordinates", " ", "of", " ", "a", 
     " ", "polytope"}], ",", " ", 
    RowBox[{
    "with", " ", "the", " ", "shift", " ", "such", " ", "that", " ", "one", 
     " ", "vertex", " ", "is", " ", "at", " ", "the", " ", 
     RowBox[{"origin", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"polytope", "[", "mat_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"newsp", ",", "gi"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"newsp", "=", "mat"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"FreeQ", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", "mat", "]"}], ",", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0", ",", 
             RowBox[{"Length", "[", "mat", "]"}]}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"gi", "=", "1"}], ",", 
            RowBox[{"gi", "<", 
             RowBox[{
              RowBox[{
               RowBox[{"Dimensions", "[", "mat", "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "1"}]}], ",", 
            RowBox[{"gi", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"newsp", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "gi"}], "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{"newsp", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "gi"}], "]"}], "]"}], "-", 
               RowBox[{"mat", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"newsp", "=", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{
          RowBox[{"RowReduce", "[", "newsp", "]"}], ",", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", 
            RowBox[{
             RowBox[{"Dimensions", "[", "mat", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "newsp"}]}], "]"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", "SKIPPED", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Calculates", " ", "the", " ", "contour", " ", "integral", " ", "circled", 
    " ", "at", " ", "infinity", " ", 
    RowBox[{"(", 
     RowBox[{"takes", " ", "into", " ", "account", " ", "all", " ", "poles"}],
      ")"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"contourint", "[", 
     RowBox[{"func_", ",", "var_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"sols", ",", "tot", ",", "i"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sols", "=", 
        RowBox[{"Solve", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Denominator", "[", "func", "]"}], "\[Equal]", "0"}], ",", 
          "var"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"sols", "=", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"Sequence", "@@@", 
          RowBox[{"(", 
           RowBox[{"sols", "/.", 
            RowBox[{"{", 
             RowBox[{"Rule", "\[Rule]", "List"}], "}"}]}], ")"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"tot", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", "sols", "]"}], "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tot", "=", 
           RowBox[{"tot", "+", 
            RowBox[{"2", "Pi", " ", "I", " ", 
             RowBox[{"Residue", "[", 
              RowBox[{"func", ",", 
               RowBox[{"sols", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}]}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "tot"}]}], 
     "\[IndentingNewLine]", "]"}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "SKIPPED", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Gives", " ", "you", " ", "the", " ", "total", " ", "number", " ", "of", 
    " ", 
    RowBox[{"faces", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"totFaces", "[", 
     RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "K0full", ",", "K0flatX", ",", "facelist", ",", "i", ",", "nf"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"K0full", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{"a", ",", "c"}], "]"}], ",", 
          RowBox[{"Join", "[", 
           RowBox[{"b", ",", "d"}], "]"}], ",", "2"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"K0flatX", "=", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", "K0full", "]"}], ",", "0"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"K0flatX", "=", 
        RowBox[{"Sequence", "@@@", 
         RowBox[{"(", 
          RowBox[{"MapThread", "[", 
           RowBox[{"MonomialList", ",", 
            RowBox[{"{", "K0flatX", "}"}]}], "]"}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"facelist", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", "K0flatX", "]"}], "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"facelist", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"facelist", ",", 
             RowBox[{"{", 
              RowBox[{"sub1", "[", 
               RowBox[{"K0flatX", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"facelist", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"facelist", ",", 
             RowBox[{"{", 
              RowBox[{"sub2", "[", 
               RowBox[{"K0flatX", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], "}"}]}], "]"}]}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"facelist", "=", 
        RowBox[{"DeleteDuplicates", "[", "facelist", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"nf", "=", 
        RowBox[{"Length", "[", "facelist", "]"}]}], ";", 
       "\[IndentingNewLine]", "nf"}]}], "\[IndentingNewLine]", "]"}]}], 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"DONE", ",", " ", 
    RowBox[{"SAME", " ", "NAME"}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Gives", " ", "you", " ", "the", " ", "number", " ", "of", " ", "external",
     " ", 
    RowBox[{"faces", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"externalFaces", "[", 
     RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"flatext", ",", "extfacelist", ",", "i", ",", "extn"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"flatext", "=", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", "b", "]"}], ",", 
            RowBox[{"Flatten", "[", "c", "]"}]}], "]"}], ",", "0"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"flatext", "=", 
        RowBox[{"Sequence", "@@@", 
         RowBox[{"(", 
          RowBox[{"MapThread", "[", 
           RowBox[{"MonomialList", ",", 
            RowBox[{"{", "flatext", "}"}]}], "]"}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"extfacelist", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", "flatext", "]"}], "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"extfacelist", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"extfacelist", ",", 
             RowBox[{"{", 
              RowBox[{"sub1", "[", 
               RowBox[{"flatext", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"extfacelist", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"extfacelist", ",", 
             RowBox[{"{", 
              RowBox[{"sub2", "[", 
               RowBox[{"flatext", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], "}"}]}], "]"}]}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"extfacelist", "=", 
        RowBox[{"DeleteDuplicates", "[", "extfacelist", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"extn", "=", 
        RowBox[{"Length", "[", "extfacelist", "]"}]}], ";", 
       "\[IndentingNewLine]", "extn"}]}], "\[IndentingNewLine]", "]"}]}], 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"DONE", ",", " ", 
    RowBox[{"SAME", " ", "NAME"}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Gives", " ", "you", " ", "the", " ", "number", " ", "of", " ", "internal",
     " ", 
    RowBox[{"faces", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"internalFaces", "[", 
     RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "intn", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"intn", "=", 
        RowBox[{
         RowBox[{"totFaces", "[", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "-", 
         RowBox[{"externalFaces", "[", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", "intn"}]}], "\[IndentingNewLine]", "]"}]}], 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"DONE", ",", " ", 
    RowBox[{"SAME", " ", "NAME"}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Gives", " ", "True", " ", "if", " ", "\"\<fullspace\>\"", " ", "is", " ",
      "reducible"}], ",", " ", 
    RowBox[{"or", " ", "False", " ", "if", " ", "it", " ", 
     RowBox[{"isn", "'"}], 
     RowBox[{"t", ".", " ", "Fullspace"}], " ", "is", " ", "in", " ", "the", 
     " ", "form", " ", "of", " ", "the", " ", "perfect", " ", "matching", " ",
      "matrix", " ", 
     RowBox[{"P", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"reducibility", "[", 
     RowBox[{"fullspace_", ",", "moduli_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "coordi", ",", "red", ",", "columnlist", ",", "po", ",", "ps", ",", 
        "Pshort"}], "}"}], ",", 
      RowBox[{"(*", 
       RowBox[{
       "First", " ", "need", " ", "to", " ", "find", " ", "out", " ", "which",
         " ", "columns", " ", "are", " ", "the", " ", "same", " ", "point", 
        " ", "in", " ", "the", " ", "moduli", " ", "space"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"coordi", "=", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"Transpose", "[", "moduli", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"columnlist", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"po", "=", "1"}], ",", 
         RowBox[{"po", "<", 
          RowBox[{
           RowBox[{"Length", "[", "coordi", "]"}], "+", "1"}]}], ",", 
         RowBox[{"po", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"columnlist", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"columnlist", ",", 
             RowBox[{"Transpose", "[", 
              RowBox[{"Position", "[", 
               RowBox[{
                RowBox[{"Transpose", "[", "moduli", "]"}], ",", 
                RowBox[{"coordi", "[", 
                 RowBox[{"[", "po", "]"}], "]"}]}], "]"}], "]"}]}], "]"}]}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "Now", " ", "we", " ", "know", " ", "which", " ", "columns", " ", 
         "represent", " ", "the", " ", "same", " ", "point", " ", "in", " ", 
         "the", " ", "toric", " ", 
         RowBox[{"diagram", "!"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Pshort", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{"Length", "[", "fullspace", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", 
            RowBox[{"Length", "[", "columnlist", "]"}]}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"ps", "=", "1"}], ",", 
         RowBox[{"ps", "<", 
          RowBox[{
           RowBox[{"Length", "[", "columnlist", "]"}], "+", "1"}]}], ",", 
         RowBox[{"ps", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Pshort", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "ps"}], "]"}], "]"}], "=", 
           RowBox[{"Product", "[", 
            RowBox[{
             RowBox[{"fullspace", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", 
                RowBox[{"columnlist", "[", 
                 RowBox[{"[", 
                  RowBox[{"ps", ",", "i"}], "]"}], "]"}]}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "[", 
                RowBox[{"columnlist", "[", 
                 RowBox[{"[", "ps", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"Pshort", ",", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0", ",", 
             RowBox[{
              RowBox[{"Dimensions", "[", "Pshort", "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
         RowBox[{"red", "=", "True"}], ",", 
         RowBox[{"red", "=", "False"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "red"}]}], "\[IndentingNewLine]", "]"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"DONE", "!"}], " ", "NOW", " ", "CALLED", " ", 
    "reducibilityBFTQ"}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Draws", " ", "the", " ", "graph", " ", "in", " ", "a", " ", "way", " ", 
     "that", " ", "is", " ", "as", " ", "planar", " ", "as", " ", "possible", 
     " ", "to", " ", "help", " ", "you", " ", "to", " ", "work", " ", "out", 
     " ", "how", " ", "many", " ", "boundaries", " ", "it", " ", "must", " ", 
     "have"}], ",", " ", 
    RowBox[{
    "and", " ", "whether", " ", "it", " ", "can", " ", "be", " ", "drawn", 
     " ", "on", " ", "a", " ", "genus", " ", "zero", " ", 
     RowBox[{"surface", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"planarity", "[", 
     RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "kasta", ",", "bigamat", ",", "multiguys", ",", "newbigamat", ",", 
        "nu", ",", "tofix", ",", "coltoadd", ",", "rowtoadd", ",", "du", ",", 
        "graph"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"kasta", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{"a", ",", "c"}], "]"}], ",", 
          RowBox[{"Join", "[", 
           RowBox[{"b", ",", "d"}], "]"}], ",", "2"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Now", " ", "make", " ", "the", " ", "weighted", " ", "adjacency", 
         " ", "matrix"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"bigamat", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{"0", ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", 
                RowBox[{"Length", "[", "kasta", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", 
                RowBox[{"Length", "[", "kasta", "]"}]}], "}"}]}], "]"}], ",", 
            RowBox[{"Transpose", "[", "kasta", "]"}]}], "]"}], ",", 
          RowBox[{"Join", "[", 
           RowBox[{"kasta", ",", 
            RowBox[{"Table", "[", 
             RowBox[{"0", ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", 
                RowBox[{
                 RowBox[{"Dimensions", "[", "kasta", "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", 
                RowBox[{
                 RowBox[{"Dimensions", "[", "kasta", "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], "]"}], 
          ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"multiguys", "=", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Sort", ",", 
           RowBox[{"{", 
            RowBox[{"Position", "[", 
             RowBox[{
              RowBox[{"MapThread", "[", 
               RowBox[{"Length", ",", 
                RowBox[{"{", 
                 RowBox[{"MonomialList", "[", "bigamat", "]"}], "}"}], ",", 
                "2"}], "]"}], ",", 
              RowBox[{"x_", "/;", 
               RowBox[{"x", ">", "1"}]}]}], "]"}], "}"}]}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"newbigamat", "=", "bigamat"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"nu", "=", "1"}], ",", 
         RowBox[{"nu", "<", 
          RowBox[{
           RowBox[{"Length", "[", "multiguys", "]"}], "+", "1"}]}], ",", 
         RowBox[{"nu", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tofix", "=", 
           RowBox[{"MonomialList", "[", 
            RowBox[{"bigamat", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{
                RowBox[{"multiguys", "[", 
                 RowBox[{"[", "nu", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"multiguys", "[", 
                 RowBox[{"[", "nu", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
             RowBox[{"we", "'"}], "ll", " ", "now", " ", "need", " ", "to", 
             " ", "add", " ", "a", " ", "certain", " ", "number", " ", "of", 
             " ", "columns", " ", "and", " ", "rows"}], ",", " ", 
            RowBox[{
            "so", " ", "that", " ", "multiedges", " ", "get", " ", "their", 
             " ", "own", " ", "node", " ", "at", " ", "the", " ", "midway", 
             " ", "point"}], ",", " ", 
            RowBox[{"and", " ", "hence", " ", 
             RowBox[{"don", "'"}], "t", " ", 
             RowBox[{"overlap", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"coltoadd", "=", 
           RowBox[{"Table", "[", 
            RowBox[{"0", ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", 
               RowBox[{"Length", "[", "newbigamat", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"y", ",", 
               RowBox[{
                RowBox[{"Length", "[", "tofix", "]"}], "-", "1"}]}], "}"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"du", "=", "2"}], ",", 
            RowBox[{"du", "<", 
             RowBox[{
              RowBox[{"Length", "[", "tofix", "]"}], "+", "1"}]}], ",", 
            RowBox[{"du", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"coltoadd", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"multiguys", "[", 
                   RowBox[{"[", "nu", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"du", "-", "1"}]}], "]"}], "]"}], "=", 
              RowBox[{"tofix", "[", 
               RowBox[{"[", "du", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"coltoadd", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"multiguys", "[", 
                   RowBox[{"[", "nu", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                 RowBox[{"du", "-", "1"}]}], "]"}], "]"}], "=", 
              RowBox[{"tofix", "[", 
               RowBox[{"[", "du", "]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"rowtoadd", "=", 
           RowBox[{"Table", "[", 
            RowBox[{"0", ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", 
               RowBox[{
                RowBox[{"Length", "[", "tofix", "]"}], "-", "1"}]}], "}"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"y", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Dimensions", "[", "newbigamat", "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "+", 
                RowBox[{"Length", "[", "tofix", "]"}], "-", "1"}]}], "}"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"du", "=", "2"}], ",", 
            RowBox[{"du", "<", 
             RowBox[{
              RowBox[{"Length", "[", "tofix", "]"}], "+", "1"}]}], ",", 
            RowBox[{"du", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"rowtoadd", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"du", "-", "1"}], ",", 
                 RowBox[{
                  RowBox[{"multiguys", "[", 
                   RowBox[{"[", "nu", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "=", 
              RowBox[{"tofix", "[", 
               RowBox[{"[", "du", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"rowtoadd", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"du", "-", "1"}], ",", 
                 RowBox[{
                  RowBox[{"multiguys", "[", 
                   RowBox[{"[", "nu", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "=", 
              RowBox[{"tofix", "[", 
               RowBox[{"[", "du", "]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"newbigamat", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"newbigamat", ",", "coltoadd", ",", "2"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"newbigamat", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"newbigamat", ",", "rowtoadd"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"newbigamat", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{
               RowBox[{"multiguys", "[", 
                RowBox[{"[", "nu", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"multiguys", "[", 
                RowBox[{"[", "nu", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "=", 
           RowBox[{"tofix", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"newbigamat", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{
               RowBox[{"multiguys", "[", 
                RowBox[{"[", "nu", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"multiguys", "[", 
                RowBox[{"[", "nu", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "=", 
           RowBox[{"tofix", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"newbigamat", "=", 
        RowBox[{"newbigamat", "/.", 
         RowBox[{"{", 
          RowBox[{"0", "\[Rule]", "\[Infinity]"}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"graph", "=", 
        RowBox[{"WeightedAdjacencyGraph", "[", "newbigamat", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"PlanarGraphQ", "[", "graph", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "Print", "[", 
           "\"\<The graph can be written in a genus 0 surface, i.e. the plane \
with a certain number of boundaries.\>\"", "]"}], ";"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{
         "Print", "[", 
          "\"\<The graph CANNOT be written in a genus 0 surface! You have \
genus > 0 .\>\"", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", 
        "\"\<This is the graph as Mathematica preferes to draw it (usually \
Mathematica preferes to draw it without crossings, so the presence of \
crossings is usually an indicator for nonplanarity):\>\"", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"WeightedAdjacencyGraph", "[", 
         RowBox[{"newbigamat", ",", 
          RowBox[{"VertexLabels", "\[Rule]", "\"\<Name\>\""}]}], "]"}], "]"}],
        ";", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", 
        "\"\<This is the graph when Mathematica has been explicitly told to \
avoid edge crossings (Mathematica will usually try and do it with the \
smallest number of boundaries):\>\"", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"WeightedAdjacencyGraph", "[", 
         RowBox[{"newbigamat", ",", 
          RowBox[{"GraphLayout", "\[Rule]", "\"\<PlanarEmbedding\>\""}], ",", 
          RowBox[{"VertexLabels", "\[Rule]", "\"\<Name\>\""}], ",", 
          RowBox[{"ImagePadding", "\[Rule]", "20"}]}], "]"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"DONE", ",", " ", 
    RowBox[{"NOW", " ", "CALLED", " ", "planarityQ"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Draws", " ", "the", " ", "bipartite", " ", "graph", " ", "associated", 
    " ", "to", " ", "the", " ", "Kasteleyn", " ", "matrix"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"drawBFT", "[", 
     RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "kasta", ",", "bigamat", ",", "multiguys", ",", "newbigamat", ",", 
        "nu", ",", "tofix", ",", "coltoadd", ",", "rowtoadd", ",", "du", ",", 
        "edgelabs", ",", "colors", ",", "ai", ",", "aj"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"kasta", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{"a", ",", "c"}], "]"}], ",", 
          RowBox[{"Join", "[", 
           RowBox[{"b", ",", "d"}], "]"}], ",", "2"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Now", " ", "make", " ", "the", " ", "weighted", " ", "adjacency", 
         " ", "matrix"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"bigamat", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{"0", ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", 
                RowBox[{"Length", "[", "kasta", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", 
                RowBox[{"Length", "[", "kasta", "]"}]}], "}"}]}], "]"}], ",", 
            RowBox[{"Transpose", "[", "kasta", "]"}]}], "]"}], ",", 
          RowBox[{"Join", "[", 
           RowBox[{"kasta", ",", 
            RowBox[{"Table", "[", 
             RowBox[{"0", ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", 
                RowBox[{
                 RowBox[{"Dimensions", "[", "kasta", "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", 
                RowBox[{
                 RowBox[{"Dimensions", "[", "kasta", "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], "]"}], 
          ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"multiguys", "=", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Sort", ",", 
           RowBox[{"{", 
            RowBox[{"Position", "[", 
             RowBox[{
              RowBox[{"MapThread", "[", 
               RowBox[{"Length", ",", 
                RowBox[{"{", 
                 RowBox[{"MonomialList", "[", "bigamat", "]"}], "}"}], ",", 
                "2"}], "]"}], ",", 
              RowBox[{"x_", "/;", 
               RowBox[{"x", ">", "1"}]}]}], "]"}], "}"}]}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"newbigamat", "=", "bigamat"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"nu", "=", "1"}], ",", 
         RowBox[{"nu", "<", 
          RowBox[{
           RowBox[{"Length", "[", "multiguys", "]"}], "+", "1"}]}], ",", 
         RowBox[{"nu", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tofix", "=", 
           RowBox[{"MonomialList", "[", 
            RowBox[{"bigamat", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{
                RowBox[{"multiguys", "[", 
                 RowBox[{"[", "nu", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"multiguys", "[", 
                 RowBox[{"[", "nu", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
             RowBox[{"we", "'"}], "ll", " ", "now", " ", "need", " ", "to", 
             " ", "add", " ", "a", " ", "certain", " ", "number", " ", "of", 
             " ", "columns", " ", "and", " ", "rows"}], ",", " ", 
            RowBox[{
            "so", " ", "that", " ", "multiedges", " ", "get", " ", "their", 
             " ", "own", " ", "node", " ", "at", " ", "the", " ", "midway", 
             " ", "point"}], ",", " ", 
            RowBox[{"and", " ", "hence", " ", 
             RowBox[{"don", "'"}], "t", " ", 
             RowBox[{"overlap", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"coltoadd", "=", 
           RowBox[{"Table", "[", 
            RowBox[{"0", ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", 
               RowBox[{"Length", "[", "newbigamat", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"y", ",", 
               RowBox[{
                RowBox[{"Length", "[", "tofix", "]"}], "-", "1"}]}], "}"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"du", "=", "2"}], ",", 
            RowBox[{"du", "<", 
             RowBox[{
              RowBox[{"Length", "[", "tofix", "]"}], "+", "1"}]}], ",", 
            RowBox[{"du", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"coltoadd", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"multiguys", "[", 
                   RowBox[{"[", "nu", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"du", "-", "1"}]}], "]"}], "]"}], "=", 
              RowBox[{"tofix", "[", 
               RowBox[{"[", "du", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"coltoadd", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"multiguys", "[", 
                   RowBox[{"[", "nu", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                 RowBox[{"du", "-", "1"}]}], "]"}], "]"}], "=", 
              RowBox[{"tofix", "[", 
               RowBox[{"[", "du", "]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"rowtoadd", "=", 
           RowBox[{"Table", "[", 
            RowBox[{"0", ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", 
               RowBox[{
                RowBox[{"Length", "[", "tofix", "]"}], "-", "1"}]}], "}"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"y", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Dimensions", "[", "newbigamat", "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "+", 
                RowBox[{"Length", "[", "tofix", "]"}], "-", "1"}]}], "}"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"du", "=", "2"}], ",", 
            RowBox[{"du", "<", 
             RowBox[{
              RowBox[{"Length", "[", "tofix", "]"}], "+", "1"}]}], ",", 
            RowBox[{"du", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"rowtoadd", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"du", "-", "1"}], ",", 
                 RowBox[{
                  RowBox[{"multiguys", "[", 
                   RowBox[{"[", "nu", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "=", 
              RowBox[{"tofix", "[", 
               RowBox[{"[", "du", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"rowtoadd", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"du", "-", "1"}], ",", 
                 RowBox[{
                  RowBox[{"multiguys", "[", 
                   RowBox[{"[", "nu", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "=", 
              RowBox[{"tofix", "[", 
               RowBox[{"[", "du", "]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"newbigamat", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"newbigamat", ",", "coltoadd", ",", "2"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"newbigamat", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"newbigamat", ",", "rowtoadd"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"newbigamat", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{
               RowBox[{"multiguys", "[", 
                RowBox[{"[", "nu", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"multiguys", "[", 
                RowBox[{"[", "nu", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "=", 
           RowBox[{"tofix", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"newbigamat", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{
               RowBox[{"multiguys", "[", 
                RowBox[{"[", "nu", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"multiguys", "[", 
                RowBox[{"[", "nu", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "=", 
           RowBox[{"tofix", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"colors", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"MapThread", "[", 
           RowBox[{"Rule", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Range", "[", 
               RowBox[{"Length", "[", 
                RowBox[{"Join", "[", 
                 RowBox[{"a", ",", "c"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"ConstantArray", "[", 
               RowBox[{"White", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"Join", "[", 
                  RowBox[{"a", ",", "c"}], "]"}], "]"}]}], "]"}]}], "}"}]}], 
           "]"}], ",", 
          RowBox[{"MapThread", "[", 
           RowBox[{"Rule", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Range", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", 
                  RowBox[{"Join", "[", 
                   RowBox[{"a", ",", "c"}], "]"}], "]"}], "+", "1"}], ",", 
                RowBox[{
                 RowBox[{"Length", "[", 
                  RowBox[{"Join", "[", 
                   RowBox[{"a", ",", "c"}], "]"}], "]"}], "+", 
                 RowBox[{
                  RowBox[{"Dimensions", "[", 
                   RowBox[{"Join", "[", 
                    RowBox[{"a", ",", "b", ",", "2"}], "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], ",", 
              RowBox[{"ConstantArray", "[", 
               RowBox[{"Black", ",", 
                RowBox[{
                 RowBox[{"Dimensions", "[", 
                  RowBox[{"Join", "[", 
                   RowBox[{"a", ",", "b", ",", "2"}], "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "}"}]}], "]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"edgelabs", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"ai", "=", "1"}], ",", 
         RowBox[{"ai", "<", 
          RowBox[{
           RowBox[{"Length", "[", "newbigamat", "]"}], "+", "1"}]}], ",", 
         RowBox[{"ai", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"aj", "=", "ai"}], ",", 
            RowBox[{"aj", "<", 
             RowBox[{
              RowBox[{
               RowBox[{"Dimensions", "[", "newbigamat", "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "1"}]}], ",", 
            RowBox[{"aj", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"newbigamat", "[", 
                 RowBox[{"[", 
                  RowBox[{"ai", ",", "aj"}], "]"}], "]"}], "\[Equal]", "0"}], 
               ",", "True", ",", "True", ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"edgelabs", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{"edgelabs", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ai", "\[UndirectedEdge]", "aj"}], "\[Rule]", 
                    RowBox[{"newbigamat", "[", 
                    RowBox[{"[", 
                    RowBox[{"ai", ",", "aj"}], "]"}], "]"}]}], "}"}]}], 
                  "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"newbigamat", "=", 
        RowBox[{"newbigamat", "/.", 
         RowBox[{"{", 
          RowBox[{"0", "\[Rule]", "\[Infinity]"}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"WeightedAdjacencyGraph", "[", 
         RowBox[{"newbigamat", ",", 
          RowBox[{"EdgeLabels", "\[Rule]", "edgelabs"}], ",", 
          RowBox[{"VertexLabels", "\[Rule]", "\"\<Name\>\""}], ",", 
          RowBox[{"VertexLabelStyle", "\[Rule]", "15"}], ",", 
          RowBox[{"VertexSize", "\[Rule]", "Medium"}], ",", 
          RowBox[{"VertexStyle", "\[Rule]", "colors"}], ",", 
          RowBox[{"ImagePadding", "\[Rule]", "20"}]}], "]"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"DONE", ",", " ", 
    RowBox[{"NOW", " ", "CALLED", " ", "viewGraph"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Swaps", " ", "the", " ", "columns", " ", "\"\<col1\>\"", " ", "and", " ", 
    "\"\<col2\>\"", "of", " ", "\"\<matrix\>\""}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"columnswap", "[", 
     RowBox[{"matrix_", ",", "col1_", ",", "col2_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"newmat", ",", "rule", ",", "rightorder", ",", "ii"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"newmat", "=", 
        RowBox[{"Transpose", "[", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             RowBox[{"Length", "[", "matrix", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"y", ",", 
             RowBox[{
              RowBox[{"Dimensions", "[", "matrix", "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"rule", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"col1", "\[Rule]", "col2"}], ",", 
          RowBox[{"col2", "\[Rule]", "col1"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"rightorder", "=", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{
           RowBox[{"Dimensions", "[", "matrix", "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}], "/.", "rule"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"ii", "=", "1"}], ",", 
         RowBox[{"ii", "<", 
          RowBox[{
           RowBox[{"Length", "[", "rightorder", "]"}], "+", "1"}]}], ",", 
         RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"newmat", "[", 
            RowBox[{"[", "ii", "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{"Transpose", "[", "matrix", "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"rightorder", "[", 
              RowBox[{"[", "ii", "]"}], "]"}], "]"}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"newmat", "=", 
        RowBox[{"Transpose", "[", "newmat", "]"}]}], ";", 
       "\[IndentingNewLine]", "newmat"}]}], "\[IndentingNewLine]", "]"}]}], 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"SKIPPED", ",", " ", 
    RowBox[{"CAN", " ", "BE", " ", "DONE", " ", 
     RowBox[{"WITH", " ", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", 
        RowBox[{"{", 
         RowBox[{"...", ",", "col2", ",", "...", ",", "col1", ",", "..."}], 
         "}"}]}], "]"}], "]"}]}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Swaps", " ", "the", " ", "rows", " ", "\"\<row1\>\"", " ", "and", " ", 
    "\"\<row2\>\"", "of", " ", "\"\<matrix\>\""}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"rowswap", "[", 
     RowBox[{"matrix_", ",", "row1_", ",", "row2_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"newmat", ",", "rule", ",", "rightorder", ",", "ii"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"newmat", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{"Length", "[", "matrix", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", 
            RowBox[{
             RowBox[{"Dimensions", "[", "matrix", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"rule", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"row1", "\[Rule]", "row2"}], ",", 
          RowBox[{"row2", "\[Rule]", "row1"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"rightorder", "=", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{"Length", "[", "matrix", "]"}], "]"}], "/.", "rule"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"ii", "=", "1"}], ",", 
         RowBox[{"ii", "<", 
          RowBox[{
           RowBox[{"Length", "[", "rightorder", "]"}], "+", "1"}]}], ",", 
         RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"newmat", "[", 
            RowBox[{"[", "ii", "]"}], "]"}], "=", 
           RowBox[{"matrix", "[", 
            RowBox[{"[", 
             RowBox[{"rightorder", "[", 
              RowBox[{"[", "ii", "]"}], "]"}], "]"}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "newmat"}]}], "\[IndentingNewLine]", "]"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"SKIPPED", ",", " ", 
    RowBox[{"CAN", " ", "BE", " ", "DONE", " ", 
     RowBox[{"WITH", " ", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", 
        RowBox[{"{", 
         RowBox[{"...", ",", "col2", ",", "...", ",", "col1", ",", "..."}], 
         "}"}]}], "]"}], "]"}]}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Calculates", " ", "all", " ", "perfect", " ", "matchings"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"kasteleyn", "[", 
     RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "K0full", ",", "K0flatX", ",", "dupl", ",", "dupllist", ",", "bnset", 
        ",", "bnlength", ",", "cnset", ",", "cnlength", ",", "cnsub", ",", 
        "bnsub", ",", "i", ",", "j", ",", "totrow", ",", "totcol", ",", 
        "colsurplus", ",", "rowsurplus", ",", "num", ",", "contr", ",", 
        "bnew", ",", "cnew", ",", "dnew", ",", "part1", ",", "part2", ",", 
        "added", ",", "kk", ",", "finalcontr", ",", "finaladd", ",", "p", ",",
         "X", ",", "BigP", ",", "Pext", ",", "Pint", ",", "ai", ",", "ji", 
        ",", "jir", ",", "signs", ",", "ii", ",", "rowguys", ",", "relguy", 
        ",", "found", ",", "jj"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"K0full", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{"a", ",", "c"}], "]"}], ",", 
          RowBox[{"Join", "[", 
           RowBox[{"b", ",", "d"}], "]"}], ",", "2"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<\!\(\*SubscriptBox[\(K\), \(0\)]\) = \>\"", ",", 
         RowBox[{"K0full", "//", "MatrixForm"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Check", " ", "that", " ", "a", " ", "field", " ", 
         RowBox[{"hasn", "'"}], "t", " ", "been", " ", "entered", " ", "in", 
         " ", 
         RowBox[{"twice", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"K0flatX", "=", 
        RowBox[{"Sort", "[", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", "K0full", "]"}], ",", "0"}], "]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"K0flatX", "=", 
        RowBox[{"Sequence", "@@@", 
         RowBox[{"(", 
          RowBox[{"MapThread", "[", 
           RowBox[{"MonomialList", ",", 
            RowBox[{"{", "K0flatX", "}"}]}], "]"}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Made", " ", "a", " ", "list", " ", "with", " ", "all", " ", 
         "variables", " ", "in", " ", 
         SubscriptBox["K", "0"], " ", "excluding", " ", "zeroes"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"dupl", "=", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Split", "[", 
           RowBox[{"Sort", "[", "K0flatX", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "#", "]"}], "\[GreaterEqual]", "2"}], 
           "&"}]}], "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{"These", " ", "are", " ", "the", " ", 
         RowBox[{"duplicates", "!"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"dupllist", "=", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"Flatten", "[", "dupl", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "dupl", "]"}], "\[NotEqual]", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "Print", "[", 
           "\"\<In \!\(\*SubscriptBox[\(K\), \(0\)]\) there are several \
fields with the same name!!! ERROR\>\"", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<The duplicated fields are \>\"", ",", "dupllist"}], 
           "]"}], ";"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "Print", "[", "\"\<Matrix is OK, there are no doubles.\>\"", "]"}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Consistency", " ", 
         RowBox[{"check", ":", " ", 
          RowBox[{
          "see", " ", "whether", " ", "the", " ", "rows", " ", "have", " ", 
           "cyclic", " ", 
           RowBox[{"indices", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"ii", "=", "1"}], ",", 
         RowBox[{"ii", "<", 
          RowBox[{
           RowBox[{"Length", "[", "K0full", "]"}], "+", "1"}]}], ",", 
         RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"rowguys", "=", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{
             RowBox[{"K0full", "[", 
              RowBox[{"[", "ii", "]"}], "]"}], ",", "0"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"rowguys", "=", 
           RowBox[{"Sequence", "@@@", 
            RowBox[{"(", 
             RowBox[{"MapThread", "[", 
              RowBox[{"MonomialList", ",", 
               RowBox[{"{", "rowguys", "}"}]}], "]"}], ")"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"relguy", "=", 
           RowBox[{"rowguys", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"rowguys", "=", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{"rowguys", ",", "relguy"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{"rowguys", "\[NotEqual]", 
             RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"found", "=", "0"}], ";", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"jj", "=", "1"}], ",", 
               RowBox[{"jj", "<", 
                RowBox[{
                 RowBox[{"Length", "[", "rowguys", "]"}], "+", "1"}]}], ",", 
               RowBox[{"jj", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"sub1", "[", 
                    RowBox[{"rowguys", "[", 
                    RowBox[{"[", "jj", "]"}], "]"}], "]"}], "\[Equal]", 
                   RowBox[{"sub2", "[", "relguy", "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"found", "=", "1"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"relguy", "=", 
                    RowBox[{"rowguys", "[", 
                    RowBox[{"[", "jj", "]"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"rowguys", "=", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{"rowguys", ",", 
                    RowBox[{"rowguys", "[", 
                    RowBox[{"[", "jj", "]"}], "]"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", 
                 "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"If", " ", "the", " ", "guy", " ", 
                RowBox[{"we", "'"}], "re", " ", "looking", " ", "for", " ", 
                RowBox[{"doesn", "'"}], "t", " ", "exist"}], ",", " ", 
               RowBox[{"say", " ", "so"}]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"found", "\[Equal]", "0"}], ",", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{
                 "\"\<Mistake in row \>\"", ",", "ii", ",", 
                  "\"\< of Kasteleyn! Someone has a wrong name, or there's an \
extra field.\>\""}], "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}],
              ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Consistency", " ", 
         RowBox[{"check", ":", " ", 
          RowBox[{
          "now", " ", "check", " ", "the", " ", "indices", " ", "of", " ", 
           "the", " ", 
           RowBox[{"columns", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"ii", "=", "1"}], ",", 
         RowBox[{"ii", "<", 
          RowBox[{
           RowBox[{
            RowBox[{"Dimensions", "[", "K0full", "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", "1"}]}], ",", 
         RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"rowguys", "=", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Transpose", "[", "K0full", "]"}], "[", 
              RowBox[{"[", "ii", "]"}], "]"}], ",", "0"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"rowguys", "=", 
           RowBox[{"Sequence", "@@@", 
            RowBox[{"(", 
             RowBox[{"MapThread", "[", 
              RowBox[{"MonomialList", ",", 
               RowBox[{"{", "rowguys", "}"}]}], "]"}], ")"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"relguy", "=", 
           RowBox[{"rowguys", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"rowguys", "=", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{"rowguys", ",", "relguy"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{"rowguys", "\[NotEqual]", 
             RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"found", "=", "0"}], ";", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"jj", "=", "1"}], ",", 
               RowBox[{"jj", "<", 
                RowBox[{
                 RowBox[{"Length", "[", "rowguys", "]"}], "+", "1"}]}], ",", 
               RowBox[{"jj", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"sub1", "[", 
                    RowBox[{"rowguys", "[", 
                    RowBox[{"[", "jj", "]"}], "]"}], "]"}], "\[Equal]", 
                   RowBox[{"sub2", "[", "relguy", "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"found", "=", "1"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"relguy", "=", 
                    RowBox[{"rowguys", "[", 
                    RowBox[{"[", "jj", "]"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"rowguys", "=", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{"rowguys", ",", 
                    RowBox[{"rowguys", "[", 
                    RowBox[{"[", "jj", "]"}], "]"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", 
                 "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"If", " ", "the", " ", "guy", " ", 
                RowBox[{"we", "'"}], "re", " ", "looking", " ", "for", " ", 
                RowBox[{"doesn", "'"}], "t", " ", "exist"}], ",", " ", 
               RowBox[{"say", " ", "so"}]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"found", "\[Equal]", "0"}], ",", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{
                 "\"\<Mistake in column \>\"", ",", "ii", ",", 
                  "\"\< of Kasteleyn! Someone has a wrong name, or there's an \
extra field.\>\""}], "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}],
              ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Makes", " ", "the", " ", "sets", " ", "that", " ", "will", " ", 
         "number", " ", "the", " ", "rows", " ", "and", " ", "columns"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"bnset", "=", 
        RowBox[{"Range", "[", 
         RowBox[{
          RowBox[{"Dimensions", "[", "b", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Makes", " ", "a", " ", "list", " ", "1"}], ",", "2", ",", 
         RowBox[{
         "..", " ", "up", " ", "to", " ", "the", " ", "number", " ", "of", 
          " ", "external", " ", "nodes"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"bnlength", "=", 
        RowBox[{"Length", "[", "bnset", "]"}]}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{"gives", " ", "the", " ", "last", " ", "element"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"cnset", "=", 
        RowBox[{"Range", "[", 
         RowBox[{
          RowBox[{"Dimensions", "[", "c", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"cnlength", "=", 
        RowBox[{"Length", "[", "cnset", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Take", " ", "all", " ", "possible", " ", "subsets", " ", "and", " ", 
         "number", " ", "them"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{"cnlength", "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           SubscriptBox["cnsub", "i"], "=", 
           RowBox[{"Subsets", "[", 
            RowBox[{"cnset", ",", 
             RowBox[{"{", "i", "}"}]}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{"bnlength", "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           SubscriptBox["bnsub", "i"], "=", 
           RowBox[{"Subsets", "[", 
            RowBox[{"bnset", ",", 
             RowBox[{"{", "i", "}"}]}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Give", " ", "the", " ", "ith", " ", "row", " ", "and", " ", "the", 
         " ", "jth", " ", "column", " ", "a", " ", "name"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{"cnlength", "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           SubscriptBox["c", "i"], "=", 
           RowBox[{"Take", "[", 
            RowBox[{"c", ",", 
             RowBox[{"{", "i", "}"}]}], "]"}]}], ";"}]}], " ", 
        RowBox[{"(*", 
         RowBox[{"Is", " ", "the", " ", 
          SubscriptBox["c", "i"], " ", "th", " ", "row"}], "*)"}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "<", 
          RowBox[{"bnlength", "+", "1"}]}], ",", 
         RowBox[{"j", "++"}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           SubscriptBox["b", "j"], "=", 
           RowBox[{"Take", "[", 
            RowBox[{"b", ",", "All", ",", 
             RowBox[{"{", "j", "}"}]}], "]"}]}], ";"}]}], " ", 
        RowBox[{"(*", 
         RowBox[{"Is", " ", "the", " ", 
          SubscriptBox["b", "j"], " ", "th", " ", "column"}], "*)"}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"If", " ", "the", " ", "Kasteleyn", " ", "matrix", " ", 
          RowBox[{"isn", "'"}], "t", " ", "square"}], ",", " ", 
         RowBox[{
          RowBox[{"we", "'"}], "ll", " ", "need", " ", "to", " ", "remove", 
          " ", "more", " ", "columns", " ", "than", " ", "rows", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"or", " ", "vice"}], "-", "versa"}], ")"}], "."}]}]}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"totrow", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Dimensions", "[", "a", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", 
         RowBox[{
          RowBox[{"Dimensions", "[", "c", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"totcol", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Dimensions", "[", "a", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "+", 
         RowBox[{
          RowBox[{"Dimensions", "[", "b", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"totcol", "-", "totrow"}], "\[GreaterEqual]", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"colsurplus", "=", 
           RowBox[{"totcol", "-", "totrow"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"rowsurplus", "=", "0"}], ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{
          RowBox[{"rowsurplus", "=", 
           RowBox[{"totrow", "-", "totcol"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"colsurplus", "=", "0"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"num", "=", "1"}], ",", 
         RowBox[{"num", "<", 
          RowBox[{
           RowBox[{"Min", "[", 
            RowBox[{"bnlength", ",", "cnlength"}], "]"}], "+", "1"}]}], ",", 
         RowBox[{"num", "++"}], ",", " ", 
         RowBox[{"(*", 
          RowBox[{
          "num", " ", "is", " ", "the", " ", "number", " ", "of", " ", "rows",
            " ", "or", " ", "columns", " ", "that", " ", "are", " ", 
           "removed", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"can", "'"}], "t", " ", "remove", " ", "more", " ", 
              "than", " ", "all", " ", "external", " ", "rows", " ", "or", 
              " ", 
              RowBox[{"columns", ":", " ", 
               RowBox[{
               "this", " ", "sets", " ", "when", " ", "to", " ", "stop", " ", 
                "num"}]}]}], ")"}], "."}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           SubscriptBox["contr", "num"], "=", "0"}], ";", " ", 
          RowBox[{"(*", 
           RowBox[{
           "The", " ", "contribution", " ", "to", " ", "perf", " ", "with", 
            " ", "num", " ", "rows", " ", "and", " ", "columns", " ", 
            RowBox[{"removed", "."}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"i", "=", "1"}], ",", 
            RowBox[{"i", "<", 
             RowBox[{
              RowBox[{
               RowBox[{"Dimensions", "[", 
                SubscriptBox["cnsub", 
                 RowBox[{"num", "+", "rowsurplus"}]], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], ",", 
            RowBox[{"i", "++"}], ",", " ", 
            RowBox[{"(*", 
             RowBox[{"Counts", " ", "row", " ", "scenarios"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"j", "=", "1"}], ",", 
               RowBox[{"j", "<", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Dimensions", "[", 
                   SubscriptBox["bnsub", 
                    RowBox[{"num", "+", "colsurplus"}]], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], ",", 
               RowBox[{"j", "++"}], ",", " ", 
               RowBox[{"(*", 
                RowBox[{"Counts", " ", "column", " ", "scenarios"}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"bnew", "=", "b"}], ";", "\[IndentingNewLine]", 
                RowBox[{"cnew", "=", "c"}], ";", "\[IndentingNewLine]", 
                RowBox[{"dnew", "=", "d"}], ";", "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"kk", "=", "1"}], ",", 
                  RowBox[{"kk", " ", "<", " ", 
                   RowBox[{"(", 
                    RowBox[{"num", "+", "colsurplus", "+", "1"}], ")"}]}], 
                  ",", " ", 
                  RowBox[{"kk", "++"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"bnew", "=", 
                    RowBox[{"Drop", "[", 
                    RowBox[{"bnew", ",", "None", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["bnsub", 
                    RowBox[{"num", "+", "colsurplus"}]], "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "kk"}], "]"}], "]"}], "-", "kk", "+", 
                    "1"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                   RowBox[{"dnew", "=", 
                    RowBox[{"Drop", "[", 
                    RowBox[{"dnew", ",", "None", ",", 
                    RowBox[{"{", "1", "}"}]}], "]"}]}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"kk", "=", "1"}], ",", 
                  RowBox[{"kk", " ", "<", " ", 
                   RowBox[{"(", 
                    RowBox[{"num", "+", "rowsurplus", "+", "1"}], ")"}]}], 
                  ",", " ", 
                  RowBox[{"kk", "++"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"cnew", "=", 
                    RowBox[{"Drop", "[", 
                    RowBox[{"cnew", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["cnsub", 
                    RowBox[{"num", "+", "rowsurplus"}]], "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "kk"}], "]"}], "]"}], "-", "kk", "+", 
                    "1"}], "}"}], ",", "None"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"dnew", "=", 
                    RowBox[{"Drop", "[", 
                    RowBox[{"dnew", ",", 
                    RowBox[{"{", "1", "}"}], ",", "None"}], "]"}]}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Dimensions", "[", "cnew", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[NotEqual]", " ", "0"}],
                   ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"part1", "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{"a", ",", "cnew"}], "]"}]}], ";"}], ",", 
                  RowBox[{
                   RowBox[{"part1", "=", "a"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Dimensions", "[", "bnew", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "\[NotEqual]", " ", "0"}],
                   ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"part2", "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{"bnew", ",", "dnew"}], "]"}]}], ";"}], ",", 
                  RowBox[{
                   RowBox[{"part2", "=", 
                    RowBox[{"{", 
                    RowBox[{"{", "}"}], "}"}]}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Dimensions", "[", "part2", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[NotEqual]", "0"}], ",",
                   "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["added", "num"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{"part1", ",", "part2", ",", "2"}], "]"}]}], ";"}],
                   " ", ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["added", "num"], "=", "part1"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{"This", " ", "is", " ", "the", " ", "correct", " ", 
                  RowBox[{"matrix", "!"}]}], "*)"}], "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{
                 SubscriptBox["contr", "num"], "=", 
                 RowBox[{
                  SubscriptBox["contr", "num"], "+", 
                  RowBox[{"Det", "[", 
                   SubscriptBox["added", "num"], "]"}]}]}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Now", " ", "have", " ", "added", " ", "all", " ", "the", " ", 
         "contributions", " ", "when", " ", "we", " ", "removed", " ", "rows",
          " ", "and", " ", 
         RowBox[{"columns", ".", " ", "Have"}], " ", "to", " ", "still", " ", 
         "consider", " ", "the", " ", "contribution", " ", "where", " ", "we",
          " ", "remove", " ", "zero", " ", "rows", " ", 
         RowBox[{"or", "/", "and"}], " ", "zero", " ", 
         RowBox[{"columns", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"totcol", "-", "totrow"}], "\[Equal]", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "If", " ", "we", " ", "have", " ", "the", " ", "same", " ", 
            "number", " ", "of", " ", "rows", " ", "and", " ", "columns"}], 
           ",", " ", 
           RowBox[{
           "K0", " ", "is", " ", "already", " ", "a", " ", "square", " ", 
            "matrix"}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"finalcontr", "=", 
           RowBox[{"Det", "[", "K0full", "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"totcol", "-", "totrow"}], ">", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"finalcontr", "=", "0"}], ";", " ", 
          RowBox[{"(*", 
           RowBox[{
           "The", " ", "contribution", " ", "to", " ", "perf", " ", "with", 
            " ", "num", " ", "rows", " ", "and", " ", "columns", " ", 
            RowBox[{"removed", "."}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "<", 
             RowBox[{
              RowBox[{
               RowBox[{"Dimensions", "[", 
                SubscriptBox["bnsub", "colsurplus"], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], ",", 
            RowBox[{"j", "++"}], ",", " ", 
            RowBox[{"(*", 
             RowBox[{"Counts", " ", "column", " ", "scenarios"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"bnew", "=", "b"}], ";", "\[IndentingNewLine]", 
             RowBox[{"cnew", "=", "c"}], ";", "\[IndentingNewLine]", 
             RowBox[{"dnew", "=", "d"}], ";", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"kk", "=", "1"}], ",", 
               RowBox[{"kk", " ", "<", " ", 
                RowBox[{"(", 
                 RowBox[{"colsurplus", "+", "1"}], ")"}]}], ",", " ", 
               RowBox[{"kk", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"bnew", "=", 
                 RowBox[{"Drop", "[", 
                  RowBox[{"bnew", ",", "None", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["bnsub", "colsurplus"], "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "kk"}], "]"}], "]"}], "-", "kk", "+", 
                    "1"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"dnew", "=", 
                 RowBox[{"Drop", "[", 
                  RowBox[{"dnew", ",", "None", ",", 
                   RowBox[{"{", "1", "}"}]}], "]"}]}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Dimensions", "[", "cnew", "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "\[NotEqual]", " ", "0"}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"part1", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{"a", ",", "cnew"}], "]"}]}], ";"}], ",", 
               RowBox[{
                RowBox[{"part1", "=", "a"}], ";"}]}], "\[IndentingNewLine]", 
              "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Dimensions", "[", "bnew", "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "\[NotEqual]", " ", "0"}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"part2", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{"bnew", ",", "dnew"}], "]"}]}], ";"}], ",", 
               RowBox[{
                RowBox[{"part2", "=", 
                 RowBox[{"{", 
                  RowBox[{"{", "}"}], "}"}]}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Dimensions", "[", "part2", "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "\[NotEqual]", "0"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"finaladd", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{"part1", ",", "part2", ",", "2"}], "]"}]}], ";"}], 
               " ", ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"finaladd", "=", "part1"}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"This", " ", "is", " ", "the", " ", "correct", " ", 
               RowBox[{"matrix", "!"}]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"finalcontr", "=", 
              RowBox[{"finalcontr", "+", 
               RowBox[{"Det", "[", "finaladd", "]"}]}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"totrow", "-", "totcol"}], ">", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"finalcontr", "=", "0"}], ";", " ", 
          RowBox[{"(*", 
           RowBox[{
           "The", " ", "contribution", " ", "to", " ", "perf", " ", "with", 
            " ", "num", " ", "rows", " ", "and", " ", "columns", " ", 
            RowBox[{"removed", "."}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"i", "=", "1"}], ",", 
            RowBox[{"i", "<", 
             RowBox[{
              RowBox[{
               RowBox[{"Dimensions", "[", 
                SubscriptBox["cnsub", "rowsurplus"], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], ",", 
            RowBox[{"i", "++"}], ",", " ", 
            RowBox[{"(*", 
             RowBox[{"Counts", " ", "row", " ", "scenarios"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"bnew", "=", "b"}], ";", "\[IndentingNewLine]", 
             RowBox[{"cnew", "=", "c"}], ";", "\[IndentingNewLine]", 
             RowBox[{"dnew", "=", "d"}], ";", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"kk", "=", "1"}], ",", 
               RowBox[{"kk", " ", "<", " ", 
                RowBox[{"(", 
                 RowBox[{"rowsurplus", "+", "1"}], ")"}]}], ",", " ", 
               RowBox[{"kk", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"cnew", "=", 
                 RowBox[{"Drop", "[", 
                  RowBox[{"cnew", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["cnsub", "rowsurplus"], "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "kk"}], "]"}], "]"}], "-", "kk", "+", 
                    "1"}], "}"}], ",", "None"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"dnew", "=", 
                 RowBox[{"Drop", "[", 
                  RowBox[{"dnew", ",", 
                   RowBox[{"{", "1", "}"}], ",", "None"}], "]"}]}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Dimensions", "[", "cnew", "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "\[NotEqual]", " ", "0"}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"part1", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{"a", ",", "cnew"}], "]"}]}], ";"}], ",", 
               RowBox[{
                RowBox[{"part1", "=", "a"}], ";"}]}], "\[IndentingNewLine]", 
              "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Dimensions", "[", "bnew", "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "\[NotEqual]", " ", "0"}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"part2", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{"bnew", ",", "dnew"}], "]"}]}], ";"}], ",", 
               RowBox[{
                RowBox[{"part2", "=", 
                 RowBox[{"{", 
                  RowBox[{"{", "}"}], "}"}]}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Dimensions", "[", "part2", "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "\[NotEqual]", "0"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"finaladd", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{"part1", ",", "part2", ",", "2"}], "]"}]}], ";"}], 
               " ", ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"finaladd", "=", "part1"}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"This", " ", "is", " ", "the", " ", "correct", " ", 
               RowBox[{"matrix", "!"}]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"finalcontr", "=", 
              RowBox[{"finalcontr", "+", 
               RowBox[{"Det", "[", "finaladd", "]"}]}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"perf", "=", 
        RowBox[{"finalcontr", "+", 
         RowBox[{"Sum", "[", 
          RowBox[{
           SubscriptBox["contr", "i"], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Min", "[", 
              RowBox[{"bnlength", ",", "cnlength"}], "]"}]}], "}"}]}], 
          "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<There are \>\"", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"MonomialList", "[", "perf", "]"}], "]"}], ",", 
         "\"\< perfect matchings.\>\""}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"plist", "=", 
        RowBox[{"MonomialList", "[", "perf", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Xlist", "=", 
        RowBox[{"Variables", "[", "perf", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "<", 
          RowBox[{
           RowBox[{"Length", "[", "plist", "]"}], "+", "1"}]}], ",", 
         RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           SubscriptBox["p", "j"], "=", 
           RowBox[{"plist", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", "Xlist", "]"}], "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           SubscriptBox["X", "i"], "=", 
           RowBox[{"Xlist", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", "Xlist", "]"}], "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "<", 
             RowBox[{
              RowBox[{"Length", "[", "plist", "]"}], "+", "1"}]}], ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"D", "[", 
                RowBox[{
                 SubscriptBox["p", "j"], ",", 
                 SubscriptBox["X", "i"]}], "]"}], "\[Equal]", "0"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                SubscriptBox["BigP", 
                 RowBox[{"i", ",", "j"}]], "=", "0"}], ";"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                SubscriptBox["BigP", 
                 RowBox[{"i", ",", "j"}]], "=", "1"}], ";"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                SubscriptBox["BigP", 
                 RowBox[{"i", ",", "j"}]], "=", "1"}], ";"}]}], 
             "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"P", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          SubscriptBox["BigP", 
           RowBox[{"i", ",", "j"}]], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "Xlist", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"Length", "[", "plist", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Now", " ", 
         RowBox[{"we", "'"}], "ll", " ", "rearrange", " ", "P", " ", "in", 
         " ", "a", " ", "nice", " ", "way"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"xb", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"DeleteCases", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", "b", "]"}], ",", "0"}], "]"}], ",", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", "c", "]"}], ",", "0"}], "]"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Pext", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Pint", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"ai", "=", "1"}], ",", 
         RowBox[{"ai", "<", 
          RowBox[{
           RowBox[{"Length", "[", "Xlist", "]"}], "+", "1"}]}], ",", 
         RowBox[{"ai", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"xb", ",", 
              RowBox[{"Xlist", "[", 
               RowBox[{"[", "ai", "]"}], "]"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Pext", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"Pext", ",", 
                RowBox[{"{", "ai", "}"}]}], "]"}]}], ";"}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{
             RowBox[{"Pint", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"Pint", ",", 
                RowBox[{"{", "ai", "}"}]}], "]"}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Now", " ", "we", " ", "know", " ", "which", " ", "rows", " ", "we", 
         " ", "need", " ", "to", " ", "select", " ", "from", " ", "P"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"moduliP", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Xmoduli", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"ji", "=", "1"}], ",", 
         RowBox[{"ji", "<", 
          RowBox[{
           RowBox[{"Length", "[", "Pext", "]"}], "+", "1"}]}], ",", 
         RowBox[{"ji", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"moduliP", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"moduliP", ",", 
             RowBox[{"Take", "[", 
              RowBox[{"P", ",", 
               RowBox[{"{", 
                RowBox[{"Pext", "[", 
                 RowBox[{"[", "ji", "]"}], "]"}], "}"}]}], "]"}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"Xmoduli", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"Xmoduli", ",", 
             RowBox[{"Take", "[", 
              RowBox[{"Xlist", ",", 
               RowBox[{"{", 
                RowBox[{"Pext", "[", 
                 RowBox[{"[", "ji", "]"}], "]"}], "}"}]}], "]"}]}], "]"}]}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"moduliP", "\[Equal]", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{
          RowBox[{"moduliP", "=", 
           RowBox[{"{", 
            RowBox[{"{", "}"}], "}"}]}], ";"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"remainingP", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Xremain", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"jir", "=", "1"}], ",", 
         RowBox[{"jir", "<", 
          RowBox[{
           RowBox[{"Length", "[", "Pint", "]"}], "+", "1"}]}], ",", 
         RowBox[{"jir", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"remainingP", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"remainingP", ",", 
             RowBox[{"Take", "[", 
              RowBox[{"P", ",", 
               RowBox[{"{", 
                RowBox[{"Pint", "[", 
                 RowBox[{"[", "jir", "]"}], "]"}], "}"}]}], "]"}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"Xremain", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"Xremain", ",", 
             RowBox[{"Take", "[", 
              RowBox[{"Xlist", ",", 
               RowBox[{"{", 
                RowBox[{"Pint", "[", 
                 RowBox[{"[", "jir", "]"}], "]"}], "}"}]}], "]"}]}], "]"}]}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"remainingP", "\[Equal]", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{
          RowBox[{"remainingP", "=", 
           RowBox[{"{", 
            RowBox[{"{", "}"}], "}"}]}], ";"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"P", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"remainingP", ",", "moduliP"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Xlist", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"Xremain", ",", "Xmoduli"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", "\"\<-------------------------------------\>\"", "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Now", " ", "make", " ", "the", " ", "perfect", " ", "matchings", " ",
          "in", " ", "plist", " ", "manifestly", " ", "positive"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"signs", "=", 
        RowBox[{"plist", "/.", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Xlist", "[", 
             RowBox[{"[", "ii", "]"}], "]"}], "\[Rule]", "1"}], ",", 
           RowBox[{"{", 
            RowBox[{"ii", ",", 
             RowBox[{"Length", "[", "Xlist", "]"}]}], "}"}]}], "]"}]}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"plist", "=", 
        RowBox[{"plist", "*", "signs"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", 
        "\"\<Variables are 'perf'=determinant of Kasteleyn matrix; \
'plist'=list of perfect matchings; 'P'=perfect matching matrix; \
'Xlist'=fields corresponding to the rows of P; 'moduliP'=P but only with rows \
corresponding to external \!\(\*SubscriptBox[\(X\), \(i, j\)]\)'s; \
'remainingP'=P but only with rows corresponding to internal \
\!\(\*SubscriptBox[\(X\), \(i, j\)]\)'s; similarly for Xremain and Xmoduli; \
'xb'=list of external fields;\>\"", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", "\"\<-------------------------------------\>\"", "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "In", " ", "case", " ", "we", " ", "had", " ", "zero", " ", 
         "boundaries"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"moduliP", "\[Equal]", 
          RowBox[{"{", 
           RowBox[{"{", "}"}], "}"}]}], ",", 
         RowBox[{
          RowBox[{"moduliP", "=", 
           RowBox[{"{", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"0", ",", 
              RowBox[{
               RowBox[{"Dimensions", "[", "remainingP", "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "}"}]}], ";", 
          RowBox[{"P", "=", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{"P", ",", 
             RowBox[{"{", "}"}]}], "]"}]}], ";"}]}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"DONE", ",", " ", 
    RowBox[{"NOW", " ", "CALLED", " ", 
     RowBox[{"perfectMatchings", ".", " ", "SOME"}], " ", "FUNCTIONALITY", 
     " ", "IS", " ", "IN", " ", "getPmatrix", " ", "AND", " ", 
     RowBox[{"matroidPolytope", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Calculates", " ", "the", " ", "moduli", " ", "space", " ", "using", " ", 
    "Gauging", " ", "2", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"using", " ", "the", " ", "superslick", " ", "method"}], ")"}], 
     "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"moduliGauging2", "[", 
     RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"kasteleyn", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Gmaster", "=", 
       RowBox[{"DeleteCases", "[", 
        RowBox[{
         RowBox[{"RowReduce", "[", "P", "]"}], ",", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", 
           RowBox[{
            RowBox[{"Dimensions", "[", "P", "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<The Master space is \>\"", ",", 
        RowBox[{"BFTdim", "[", "Gmaster", "]"}], ",", 
        "\"\<-dimensional. (NB This is the dimension of its toric \
diagram!).\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Gmoduli", "=", "moduliP"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<G = \>\"", ",", 
        RowBox[{"Gmoduli", "//", "MatrixForm"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<The moduli space is \>\"", ",", 
        RowBox[{"BFTdim", "[", "Gmoduli", "]"}], ",", 
        "\"\<-dimensional. (NB This is the dimension of its toric \
diagram!).\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Now", " ", "group", " ", "the", " ", "multiplicities", " ", "of", " ",
         "G", " ", 
        RowBox[{"together", "."}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Gshort", "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"Transpose", "[", "Gmoduli", "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Multmatrix", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Dimensions", "[", 
           RowBox[{
            RowBox[{"Gather", "[", 
             RowBox[{"Transpose", "[", "Gmoduli", "]"}], "]"}], "[", 
            RowBox[{"[", "y", "]"}], "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"y", ",", 
           RowBox[{
            RowBox[{"Dimensions", "[", 
             RowBox[{"Gather", "[", 
              RowBox[{"Transpose", "[", "Gmoduli", "]"}], "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
      "Print", "[", "\"\<-------------------------------------\>\"", "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
      "Print", "[", 
       "\"\<Variables are 'Gmaster'=master space; 'Gmoduli'=moduli space; \
'Gshort'=moduli space where doubles have been removed; \
'Multmatrix'=moultiplicity of each point in Gshort;\>\"", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
      "Print", "[", "\"\<-------------------------------------\>\"", "]"}], 
      ";"}], "\[IndentingNewLine]", ")"}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"DONE", " ", 
     RowBox[{"(", 
      RowBox[{"SIMILAR", " ", "BUT", " ", "DIFFERENT"}], ")"}]}], ",", " ", 
    RowBox[{"NOW", " ", "CALLED", " ", 
     RowBox[{"matroidPolytope", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Compares", " ", "Gauging", " ", "2", " ", "calculated", " ", "using", " ",
     "the", " ", "superslick", " ", "method", " ", "with", " ", "the", " ", 
    "old", " ", "method", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"using", " ", "charge", " ", "matrices"}], ")"}], "."}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"compareGauging2", "[", 
     RowBox[{"addgauge_", ",", "zed_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "IF", ",", "NF", ",", "i", ",", "j", ",", "k", ",", "mem", ",", "memz",
         ",", "Delta", ",", "QDT", ",", "QDTlist", ",", "solution", ",", 
        "newQDTlist", ",", "Q", ",", "subtract", ",", "transGmoduliold", ",", 
        "multold", ",", "temp"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"QF", "=", 
        RowBox[{"NullSpace", "[", "P", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"NF", "=", 
        RowBox[{"totFaces", "[", 
         RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"IF", "=", 
        RowBox[{"internalFaces", "[", 
         RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<\!\(\*SubscriptBox[\(Q\), \(F\)]\) = \>\"", ",", 
          RowBox[{"QF", "//", "MatrixForm"}]}], "]"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"First", " ", "make", " ", "Delta"}], ",", " ", 
         RowBox[{
          RowBox[{"then", " ", "plug", " ", "in", " ", "the", " ", "non"}], 
          "-", 
          RowBox[{"zero", " ", 
           RowBox[{"numbers", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Delta", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{"Length", "[", "Xlist", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", 
            RowBox[{"IF", "+", 
             RowBox[{"Length", "[", "addgauge", "]"}], "+", 
             RowBox[{"Length", "[", "zed", "]"}]}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Now", " ", "fill", " ", "in", " ", "the", " ", "non"}], "=", 
         RowBox[{"zero", " ", "numbers"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{"NF", "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "<", 
             RowBox[{"NF", "+", "1"}]}], ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"Take", " ", "a", " ", "specific", " ", 
              SubscriptBox["X", 
               RowBox[{"i", ",", "j"}]], " ", "or", " ", 
              SubscriptBox["Y", 
               RowBox[{"i", ",", "j"}]], " ", 
              RowBox[{"etc", ".", " ", "and"}], " ", "check", " ", "if", " ", 
              RowBox[{"it", "'"}], "s", " ", "in", " ", 
              RowBox[{"Xlist", "."}]}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"i", "\[NotEqual]", "j"}], ",", " ", 
               RowBox[{"(*", 
                RowBox[{
                 SubscriptBox["X", 
                  RowBox[{"i", ",", "i"}]], " ", 
                 RowBox[{"shouldn", "'"}], "t", " ", "be", " ", "nonzero"}], 
                "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"k", "=", "1"}], ",", 
                  RowBox[{"k", "<", 
                   RowBox[{
                    RowBox[{"Length", "[", "Xlist", "]"}], "+", "1"}]}], ",", 
                  RowBox[{"k", "++"}], ",", " ", 
                  RowBox[{"(*", 
                   RowBox[{
                   "Run", " ", "through", " ", "the", " ", "whole", " ", 
                    "Xlist"}], "*)"}], "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["X", 
                    RowBox[{"i", ",", "j"}]], "\[Equal]", 
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "&&", 
                    RowBox[{"i", "\[NotEqual]", "j"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i"}], "]"}], "]"}], "=", "1"}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"j", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{"-", "1"}]}], ";"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Check", " ", "whether", " ", "i", " ", "is", " ", "in", 
                    " ", "any", " ", "of", " ", "the", " ", "additional", " ",
                     "gaugings"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"mem", "=", "1"}], ",", 
                    RowBox[{"mem", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "1"}]}], 
                    ",", 
                    RowBox[{"mem", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"addgauge", "[", 
                    RowBox[{"[", "mem", "]"}], "]"}], ",", "i"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "+", "1"}]}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"addgauge", "[", 
                    RowBox[{"[", "mem", "]"}], "]"}], ",", "j"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "-", "1"}]}], 
                    ";"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Now", " ", "sort", " ", "out", " ", "the", " ", "zed", 
                    " ", "gaugings"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"memz", "=", "1"}], ",", 
                    RowBox[{"memz", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", "zed", "]"}], "+", "1"}]}], ",", 
                    RowBox[{"memz", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}], "]"}], ",", 
                    SubscriptBox["X", 
                    RowBox[{"i", ",", "j"}]]}], "]"}], ",", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{
                    "if", " ", "the", " ", "field", " ", "is", " ", "in", " ",
                     "the", " ", "zigzag"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"it", "'"}], "s"}], " ", "-", 
                    RowBox[{
                    "1", " ", "if", " ", "it", " ", "appears", " ", "on", " ",
                     "top", " ", "and"}], " ", "+", 
                    RowBox[{
                    "1", " ", "if", " ", "it", " ", "appears", " ", "on", " ",
                     "the", " ", "bottom"}]}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}], ",", 
                    SubscriptBox["X", 
                    RowBox[{"i", ",", "j"}]]}], "]"}], 
                    SubscriptBox["X", 
                    RowBox[{"i", ",", "j"}]]}], "\[Equal]", 
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}]}], ",", 
                    RowBox[{"(*", 
                    RowBox[{"appears", " ", "on", " ", "top"}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "-", "1"}]}], ";"}], ",", "True", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "+", "1"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["Y", 
                    RowBox[{"i", ",", "j"}]], "\[Equal]", 
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "&&", 
                    RowBox[{"i", "\[NotEqual]", "j"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i"}], "]"}], "]"}], "=", "1"}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"j", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{"-", "1"}]}], ";"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Check", " ", "whether", " ", "i", " ", "is", " ", "in", 
                    " ", "any", " ", "of", " ", "the", " ", "additional", " ",
                     "gaugings"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"mem", "=", "1"}], ",", 
                    RowBox[{"mem", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "1"}]}], 
                    ",", 
                    RowBox[{"mem", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"addgauge", "[", 
                    RowBox[{"[", "mem", "]"}], "]"}], ",", "i"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "+", "1"}]}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"addgauge", "[", 
                    RowBox[{"[", "mem", "]"}], "]"}], ",", "j"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "-", "1"}]}], 
                    ";"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Now", " ", "sort", " ", "out", " ", "the", " ", "zed", 
                    " ", "gaugings"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"memz", "=", "1"}], ",", 
                    RowBox[{"memz", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", "zed", "]"}], "+", "1"}]}], ",", 
                    RowBox[{"memz", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}], "]"}], ",", 
                    SubscriptBox["Y", 
                    RowBox[{"i", ",", "j"}]]}], "]"}], ",", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{
                    "if", " ", "the", " ", "field", " ", "is", " ", "in", " ",
                     "the", " ", "zigzag"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"it", "'"}], "s"}], " ", "-", 
                    RowBox[{
                    "1", " ", "if", " ", "it", " ", "appears", " ", "on", " ",
                     "top", " ", "and"}], " ", "+", 
                    RowBox[{"1", " ", "if", " ", "it", " ", "appears", " ", 
                    "on", " ", "the", " ", "bottom"}]}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}], ",", 
                    SubscriptBox["Y", 
                    RowBox[{"i", ",", "j"}]]}], "]"}], 
                    SubscriptBox["Y", 
                    RowBox[{"i", ",", "j"}]]}], "\[Equal]", 
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}]}], ",", 
                    RowBox[{"(*", 
                    RowBox[{"appears", " ", "on", " ", "top"}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "-", "1"}]}], ";"}], ",", "True", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "+", "1"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["Z", 
                    RowBox[{"i", ",", "j"}]], "\[Equal]", 
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "&&", 
                    RowBox[{"i", "\[NotEqual]", "j"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i"}], "]"}], "]"}], "=", "1"}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"j", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{"-", "1"}]}], ";"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Check", " ", "whether", " ", "i", " ", "is", " ", "in", 
                    " ", "any", " ", "of", " ", "the", " ", "additional", " ",
                     "gaugings"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"mem", "=", "1"}], ",", 
                    RowBox[{"mem", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "1"}]}], 
                    ",", 
                    RowBox[{"mem", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"addgauge", "[", 
                    RowBox[{"[", "mem", "]"}], "]"}], ",", "i"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "+", "1"}]}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"addgauge", "[", 
                    RowBox[{"[", "mem", "]"}], "]"}], ",", "j"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "-", "1"}]}], 
                    ";"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Now", " ", "sort", " ", "out", " ", "the", " ", "zed", 
                    " ", "gaugings"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"memz", "=", "1"}], ",", 
                    RowBox[{"memz", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", "zed", "]"}], "+", "1"}]}], ",", 
                    RowBox[{"memz", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}], "]"}], ",", 
                    SubscriptBox["Z", 
                    RowBox[{"i", ",", "j"}]]}], "]"}], ",", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{
                    "if", " ", "the", " ", "field", " ", "is", " ", "in", " ",
                     "the", " ", "zigzag"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"it", "'"}], "s"}], " ", "-", 
                    RowBox[{
                    "1", " ", "if", " ", "it", " ", "appears", " ", "on", " ",
                     "top", " ", "and"}], " ", "+", 
                    RowBox[{
                    "1", " ", "if", " ", "it", " ", "appears", " ", "on", " ",
                     "the", " ", "bottom"}]}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}], ",", 
                    SubscriptBox["Z", 
                    RowBox[{"i", ",", "j"}]]}], "]"}], 
                    SubscriptBox["Z", 
                    RowBox[{"i", ",", "j"}]]}], "\[Equal]", 
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}]}], ",", 
                    RowBox[{"(*", 
                    RowBox[{"appears", " ", "on", " ", "top"}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "-", "1"}]}], ";"}], ",", "True", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "+", "1"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["W", 
                    RowBox[{"i", ",", "j"}]], "\[Equal]", 
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "&&", 
                    RowBox[{"i", "\[NotEqual]", "j"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i"}], "]"}], "]"}], "=", "1"}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"j", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{"-", "1"}]}], ";"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Check", " ", "whether", " ", "i", " ", "is", " ", "in", 
                    " ", "any", " ", "of", " ", "the", " ", "additional", " ",
                     "gaugings"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"mem", "=", "1"}], ",", 
                    RowBox[{"mem", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "1"}]}], 
                    ",", 
                    RowBox[{"mem", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"addgauge", "[", 
                    RowBox[{"[", "mem", "]"}], "]"}], ",", "i"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "+", "1"}]}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"addgauge", "[", 
                    RowBox[{"[", "mem", "]"}], "]"}], ",", "j"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "-", "1"}]}], 
                    ";"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Now", " ", "sort", " ", "out", " ", "the", " ", "zed", 
                    " ", "gaugings"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"memz", "=", "1"}], ",", 
                    RowBox[{"memz", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", "zed", "]"}], "+", "1"}]}], ",", 
                    RowBox[{"memz", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}], "]"}], ",", 
                    SubscriptBox["W", 
                    RowBox[{"i", ",", "j"}]]}], "]"}], ",", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{
                    "if", " ", "the", " ", "field", " ", "is", " ", "in", " ",
                     "the", " ", "zigzag"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"it", "'"}], "s"}], " ", "-", 
                    RowBox[{
                    "1", " ", "if", " ", "it", " ", "appears", " ", "on", " ",
                     "top", " ", "and"}], " ", "+", 
                    RowBox[{
                    "1", " ", "if", " ", "it", " ", "appears", " ", "on", " ",
                     "the", " ", "bottom"}]}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}], ",", 
                    SubscriptBox["W", 
                    RowBox[{"i", ",", "j"}]]}], "]"}], 
                    SubscriptBox["W", 
                    RowBox[{"i", ",", "j"}]]}], "\[Equal]", 
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}]}], ",", 
                    RowBox[{"(*", 
                    RowBox[{"appears", " ", "on", " ", "top"}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "-", "1"}]}], ";"}], ",", "True", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "+", "1"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["V", 
                    RowBox[{"i", ",", "j"}]], "\[Equal]", 
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "&&", 
                    RowBox[{"i", "\[NotEqual]", "j"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i"}], "]"}], "]"}], "=", "1"}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"j", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{"-", "1"}]}], ";"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Check", " ", "whether", " ", "i", " ", "is", " ", "in", 
                    " ", "any", " ", "of", " ", "the", " ", "additional", " ",
                     "gaugings"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"mem", "=", "1"}], ",", 
                    RowBox[{"mem", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "1"}]}], 
                    ",", 
                    RowBox[{"mem", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"addgauge", "[", 
                    RowBox[{"[", "mem", "]"}], "]"}], ",", "i"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "+", "1"}]}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"addgauge", "[", 
                    RowBox[{"[", "mem", "]"}], "]"}], ",", "j"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "-", "1"}]}], 
                    ";"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Now", " ", "sort", " ", "out", " ", "the", " ", "zed", 
                    " ", "gaugings"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"memz", "=", "1"}], ",", 
                    RowBox[{"memz", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", "zed", "]"}], "+", "1"}]}], ",", 
                    RowBox[{"memz", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}], "]"}], ",", 
                    SubscriptBox["V", 
                    RowBox[{"i", ",", "j"}]]}], "]"}], ",", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{
                    "if", " ", "the", " ", "field", " ", "is", " ", "in", " ",
                     "the", " ", "zigzag"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"it", "'"}], "s"}], " ", "-", 
                    RowBox[{
                    "1", " ", "if", " ", "it", " ", "appears", " ", "on", " ",
                     "top", " ", "and"}], " ", "+", 
                    RowBox[{
                    "1", " ", "if", " ", "it", " ", "appears", " ", "on", " ",
                     "the", " ", "bottom"}]}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}], ",", 
                    SubscriptBox["V", 
                    RowBox[{"i", ",", "j"}]]}], "]"}], 
                    SubscriptBox["V", 
                    RowBox[{"i", ",", "j"}]]}], "\[Equal]", 
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}]}], ",", 
                    RowBox[{"(*", 
                    RowBox[{"appears", " ", "on", " ", "top"}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "-", "1"}]}], ";"}], ",", "True", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "+", "1"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["UU", 
                    RowBox[{"i", ",", "j"}]], "\[Equal]", 
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "&&", 
                    RowBox[{"i", "\[NotEqual]", "j"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i"}], "]"}], "]"}], "=", "1"}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"j", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{"-", "1"}]}], ";"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Check", " ", "whether", " ", "i", " ", "is", " ", "in", 
                    " ", "any", " ", "of", " ", "the", " ", "additional", " ",
                     "gaugings"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"mem", "=", "1"}], ",", 
                    RowBox[{"mem", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "1"}]}], 
                    ",", 
                    RowBox[{"mem", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"addgauge", "[", 
                    RowBox[{"[", "mem", "]"}], "]"}], ",", "i"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "+", "1"}]}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"addgauge", "[", 
                    RowBox[{"[", "mem", "]"}], "]"}], ",", "j"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "-", "1"}]}], 
                    ";"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Now", " ", "sort", " ", "out", " ", "the", " ", "zed", 
                    " ", "gaugings"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"memz", "=", "1"}], ",", 
                    RowBox[{"memz", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", "zed", "]"}], "+", "1"}]}], ",", 
                    RowBox[{"memz", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}], "]"}], ",", 
                    SubscriptBox["UU", 
                    RowBox[{"i", ",", "j"}]]}], "]"}], ",", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{
                    "if", " ", "the", " ", "field", " ", "is", " ", "in", " ",
                     "the", " ", "zigzag"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"it", "'"}], "s"}], " ", "-", 
                    RowBox[{
                    "1", " ", "if", " ", "it", " ", "appears", " ", "on", " ",
                     "top", " ", "and"}], " ", "+", 
                    RowBox[{
                    "1", " ", "if", " ", "it", " ", "appears", " ", "on", " ",
                     "the", " ", "bottom"}]}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}], ",", 
                    SubscriptBox["UU", 
                    RowBox[{"i", ",", "j"}]]}], "]"}], 
                    SubscriptBox["UU", 
                    RowBox[{"i", ",", "j"}]]}], "\[Equal]", 
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}]}], ",", 
                    RowBox[{"(*", 
                    RowBox[{"appears", " ", "on", " ", "top"}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "-", "1"}]}], ";"}], ",", "True", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "+", "1"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["XX", 
                    RowBox[{"i", ",", "j"}]], "\[Equal]", 
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "&&", 
                    RowBox[{"i", "\[NotEqual]", "j"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i"}], "]"}], "]"}], "=", "1"}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"j", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{"-", "1"}]}], ";"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Check", " ", "whether", " ", "i", " ", "is", " ", "in", 
                    " ", "any", " ", "of", " ", "the", " ", "additional", " ",
                     "gaugings"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"mem", "=", "1"}], ",", 
                    RowBox[{"mem", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "1"}]}], 
                    ",", 
                    RowBox[{"mem", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"addgauge", "[", 
                    RowBox[{"[", "mem", "]"}], "]"}], ",", "i"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "+", "1"}]}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"addgauge", "[", 
                    RowBox[{"[", "mem", "]"}], "]"}], ",", "j"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "-", "1"}]}], 
                    ";"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Now", " ", "sort", " ", "out", " ", "the", " ", "zed", 
                    " ", "gaugings"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"memz", "=", "1"}], ",", 
                    RowBox[{"memz", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", "zed", "]"}], "+", "1"}]}], ",", 
                    RowBox[{"memz", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}], "]"}], ",", 
                    SubscriptBox["XX", 
                    RowBox[{"i", ",", "j"}]]}], "]"}], ",", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{
                    "if", " ", "the", " ", "field", " ", "is", " ", "in", " ",
                     "the", " ", "zigzag"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"it", "'"}], "s"}], " ", "-", 
                    RowBox[{
                    "1", " ", "if", " ", "it", " ", "appears", " ", "on", " ",
                     "top", " ", "and"}], " ", "+", 
                    RowBox[{
                    "1", " ", "if", " ", "it", " ", "appears", " ", "on", " ",
                     "the", " ", "bottom"}]}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}], ",", 
                    SubscriptBox["XX", 
                    RowBox[{"i", ",", "j"}]]}], "]"}], 
                    SubscriptBox["XX", 
                    RowBox[{"i", ",", "j"}]]}], "\[Equal]", 
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}]}], ",", 
                    RowBox[{"(*", 
                    RowBox[{"appears", " ", "on", " ", "top"}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "-", "1"}]}], ";"}], ",", "True", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "+", "1"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["YY", 
                    RowBox[{"i", ",", "j"}]], "\[Equal]", 
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "&&", 
                    RowBox[{"i", "\[NotEqual]", "j"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i"}], "]"}], "]"}], "=", "1"}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"j", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{"-", "1"}]}], ";"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Check", " ", "whether", " ", "i", " ", "is", " ", "in", 
                    " ", "any", " ", "of", " ", "the", " ", "additional", " ",
                     "gaugings"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"mem", "=", "1"}], ",", 
                    RowBox[{"mem", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "1"}]}], 
                    ",", 
                    RowBox[{"mem", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"addgauge", "[", 
                    RowBox[{"[", "mem", "]"}], "]"}], ",", "i"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "+", "1"}]}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"addgauge", "[", 
                    RowBox[{"[", "mem", "]"}], "]"}], ",", "j"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "-", "1"}]}], 
                    ";"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Now", " ", "sort", " ", "out", " ", "the", " ", "zed", 
                    " ", "gaugings"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"memz", "=", "1"}], ",", 
                    RowBox[{"memz", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", "zed", "]"}], "+", "1"}]}], ",", 
                    RowBox[{"memz", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}], "]"}], ",", 
                    SubscriptBox["YY", 
                    RowBox[{"i", ",", "j"}]]}], "]"}], ",", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{
                    "if", " ", "the", " ", "field", " ", "is", " ", "in", " ",
                     "the", " ", "zigzag"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"it", "'"}], "s"}], " ", "-", 
                    RowBox[{
                    "1", " ", "if", " ", "it", " ", "appears", " ", "on", " ",
                     "top", " ", "and"}], " ", "+", 
                    RowBox[{
                    "1", " ", "if", " ", "it", " ", "appears", " ", "on", " ",
                     "the", " ", "bottom"}]}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}], ",", 
                    SubscriptBox["YY", 
                    RowBox[{"i", ",", "j"}]]}], "]"}], 
                    SubscriptBox["YY", 
                    RowBox[{"i", ",", "j"}]]}], "\[Equal]", 
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}]}], ",", 
                    RowBox[{"(*", 
                    RowBox[{"appears", " ", "on", " ", "top"}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "-", "1"}]}], ";"}], ",", "True", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "+", "1"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<\[CapitalDelta] = \>\"", ",", 
           RowBox[{"Delta", "//", "MatrixForm"}]}], "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Make", " ", "the", " ", "variables", " ", "that", " ", "go", " ", 
         "into", " ", "QDT"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"QDT", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          SubscriptBox["y", 
           RowBox[{"m", ",", "n"}]], ",", 
          RowBox[{"{", 
           RowBox[{"m", ",", 
            RowBox[{"Length", "[", "plist", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", 
            RowBox[{"IF", "+", 
             RowBox[{"Length", "[", "addgauge", "]"}], "+", 
             RowBox[{"Length", "[", "zed", "]"}]}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Put", " ", "all", " ", "the", " ", "elements", " ", 
          SubscriptBox["y", 
           RowBox[{"m", ",", "n"}]], " ", "in", " ", "a", " ", "long", " ", 
          "list"}], ",", " ", 
         RowBox[{
         "so", " ", "that", " ", "we", " ", "can", " ", "solve", " ", "for", 
          " ", "the", " ", 
          RowBox[{"list", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"QDTlist", "=", 
        RowBox[{"Flatten", "[", "QDT", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"solution", "=", 
        RowBox[{"Solve", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"P", ".", "QDT"}], "\[Equal]", "Delta"}], ",", "QDTlist"}],
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"newQDTlist", "=", 
        RowBox[{"QDTlist", "/.", "solution"}]}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{
        "Plug", " ", "in", " ", "solution", " ", "into", " ", "a", " ", 
         "matrix"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Now", " ", "need", " ", "to", " ", "put", " ", "the", " ", 
         "elements", " ", "back", " ", "into", " ", "QDT"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"temp", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", "plist", "]"}], "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "<", 
             RowBox[{"IF", "+", 
              RowBox[{"Length", "[", "addgauge", "]"}], "+", 
              RowBox[{"Length", "[", "zed", "]"}], "+", "1"}]}], ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"QDT", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
              RowBox[{"newQDTlist", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "temp"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"temp", "=", 
              RowBox[{"temp", "+", "1"}]}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"QD", "=", 
        RowBox[{"Transpose", "[", "QDT", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<\!\(\*SubscriptBox[\(Q\), \(D\)]\)= \>\"", ",", 
           RowBox[{"QD", "//", "MatrixForm"}]}], "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Q", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"QF", ",", "QD"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Gmoduliold", "=", 
        RowBox[{"NullSpace", "[", "Q", "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"RowReduce", "[", "Gmoduli", "]"}], "\[Equal]", 
          RowBox[{"RowReduce", "[", "Gmoduliold", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "Print", "[", "\"\<The two MATRICES ARE THE SAME!\>\"", "]"}], 
          ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{
          RowBox[{
          "Print", "[", 
           "\"\<The two matrices are different... Maybe they are the same \
space after a translation...\>\"", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"subtract", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Transpose", "[", "Gmoduliold", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "-", 
            RowBox[{
             RowBox[{"Transpose", "[", "Gmoduli", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"transGmoduliold", "=", 
           RowBox[{"RowReduce", "[", 
            RowBox[{"Gmoduliold", "-", 
             RowBox[{"Transpose", "[", 
              RowBox[{"Table", "[", 
               RowBox[{"subtract", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Dimensions", "[", "Gmoduliold", "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "}"}]}], "]"}], "]"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"RowReduce", "[", "Gmoduli", "]"}], "\[Equal]", 
             RowBox[{"RowReduce", "[", "transGmoduliold", "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
             "Print", "[", 
              "\"\<After a translation, the two matrices are INDEED THE SAME!\
\>\"", "]"}], ";"}], "\[IndentingNewLine]", ",", 
            RowBox[{
             RowBox[{
             "Print", "[", 
              "\"\<The two MATRICES ARE DIFFERENT even after the translation. \
Look at the multiplicities.\>\"", "]"}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"multold", "=", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Dimensions", "[", 
                  RowBox[{
                   RowBox[{"Gather", "[", 
                    RowBox[{"Transpose", "[", "Gmoduliold", "]"}], "]"}], "[", 
                   RowBox[{"[", "y", "]"}], "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "1"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"y", ",", 
                  RowBox[{
                   RowBox[{"Dimensions", "[", 
                    RowBox[{"Gather", "[", 
                    RowBox[{"Transpose", "[", "Gmoduliold", "]"}], "]"}], 
                    "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Print", "[", 
              RowBox[{"\"\<multiplicity = \>\"", ",", 
               RowBox[{"multold", "//", "MatrixForm"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Print", "[", 
              RowBox[{"\"\<Multmatrix = \>\"", ",", 
               RowBox[{"Multmatrix", "//", "MatrixForm"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"multold", "\[Equal]", "Multmatrix"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                "Print", "[", 
                 "\"\<The multiplicities of each point are EXACTLY the same! \
Indication that the spaces are actually the same.\>\"", "]"}], ";"}], 
               "\[IndentingNewLine]", ",", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"Sort", "[", 
                    RowBox[{
                    RowBox[{"multold", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "Greater"}], "]"}], 
                    "}"}], "\[Equal]", 
                   RowBox[{"{", 
                    RowBox[{"Sort", "[", 
                    RowBox[{
                    RowBox[{"Multmatrix", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "Greater"}], "]"}], 
                    "}"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                   "Print", "[", 
                    "\"\<The multiplicity matrices are the same, only after \
reordering the columns.\>\"", "]"}], ";"}], "\[IndentingNewLine]", ",", 
                  RowBox[{
                   RowBox[{
                   "Print", "[", 
                    "\"\<The multiplicites are actually different... At best, \
the two moduli spaces are different phases of the same CY. But they naively \
seem DIFFERENT.\>\"", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", "\"\<-------------------------------------\>\"", "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", 
        "\"\<Variables are 'QF'=redundancies (F-term charge matrix); \
'QD'=D-term charge matrix; 'Gmoduliold'=moduli space using the old \
method;\>\"", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", "\"\<-------------------------------------\>\"", "]"}], 
       ";"}]}], "\[IndentingNewLine]", "]"}]}], "*)"}], "\[IndentingNewLine]",
   "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"SKIPPED", ",", " ", 
    RowBox[{"NO", " ", "NEED", " ", "FOR", " ", 
     RowBox[{"IT", "!"}]}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Finds", " ", "all", " ", "reductions", " ", "to", " ", "a", " ", 
      RowBox[{"graph", ".", " ", "It"}], " ", "needs", " ", "the", " ", 
      "moduli", " ", "space", " ", "and", " ", "the", " ", "perfect", " ", 
      "matching", " ", "matrix", " ", 
      RowBox[{"P", ".", " ", "Give"}], " ", "it", " ", "num"}], "=", 
     RowBox[{
     "1", " ", "if", " ", "you", " ", "are", " ", "considering", " ", 
      "Xlist"}]}], ",", " ", 
    RowBox[{
     RowBox[{"and", " ", "num"}], "=", 
     RowBox[{"2", " ", "if", " ", "you", " ", "are", " ", "considering", " ", 
      RowBox[{"Xlisthiggs", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"whichnum", "[", 
      RowBox[{"gi_", ",", "lev_"}], "]"}], ":=", 
     RowBox[{
      SubscriptBox["kills", "lev"], "[", 
      RowBox[{"[", "gi", "]"}], "]"}]}], ";", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
      "whichnum", " ", "and", " ", "Xs", " ", "are", " ", "auxiliary", " ", 
       "functions"}], ",", " ", 
      RowBox[{"useful", " ", "later"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "whichnum", " ", "translates", " ", "a", " ", "try", " ", "number", " ", 
      "to", " ", "which", " ", "pms", " ", "are", " ", "actually", " ", 
      "killed"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Xs", "[", "numb_", "]"}], ":=", 
     RowBox[{"Xlist", "[", 
      RowBox[{"[", "numb", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Xshigg", "[", "numb_", "]"}], ":=", 
     RowBox[{"Xlisthiggs", "[", 
      RowBox[{"[", "numb", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"reduction", "[", 
      RowBox[{"P_", ",", "Gmoduli_", ",", "num_"}], "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "level", ",", "try", ",", "die", ",", "hig", ",", "kil", ",", "el", 
         ",", "Gnew", ",", "dum", ",", "Gshorta", ",", "newGshort", ",", 
         "remSets", ",", "Xlista", ",", "Gnewtrans"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"num", "\[Equal]", "1"}], ",", 
          RowBox[{
           RowBox[{"Xlista", "=", "Xlist"}], ";"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"num", "\[Equal]", "2"}], ",", 
          RowBox[{
           RowBox[{"Xlista", "=", "Xlisthiggs"}], ";"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"level", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Gshorta", "=", 
         RowBox[{"Transpose", "[", 
          RowBox[{"DeleteDuplicates", "[", 
           RowBox[{"Transpose", "[", "Gmoduli", "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{"True", ",", 
          RowBox[{"(*", 
           RowBox[{"keep", " ", "going", " ", "until", " ", 
            RowBox[{"we", "'"}], "re", " ", "finished", " ", "Higgsing"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"level", "=", 
            RowBox[{"level", "+", "1"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            SubscriptBox["higgs", "level"], "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"level", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               SubscriptBox["kills", "level"], "=", 
               RowBox[{"Transpose", "[", 
                RowBox[{"{", 
                 RowBox[{"Range", "[", 
                  RowBox[{"Length", "[", "Xlista", "]"}], "]"}], "}"}], 
                "]"}]}], ";"}], 
             RowBox[{"(*", 
              RowBox[{"Higgs", " ", "for", " ", "level", " ", "1"}], "*)"}], 
             "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               SubscriptBox["kills", "level"], "=", 
               RowBox[{"Subsets", "[", 
                RowBox[{
                 SubscriptBox["higgs", "1"], ",", 
                 RowBox[{"{", "level", "}"}]}], "]"}]}], ";"}]}], 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{
              "These", " ", "are", " ", "the", " ", "sets", " ", "of", " ", 
               "fields", " ", "we", " ", "are", " ", "going", " ", "to", " ", 
               "try", " ", "and", " ", 
               RowBox[{"kill", ".", " ", "For"}], " ", 
               SubscriptBox["higgs", "1"]}], ",", 
              RowBox[{
               RowBox[{"Xlist", "[", 
                RowBox[{"[", 
                 RowBox[{
                  SubscriptBox["higgs", "1"], "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], " ", "makes", 
               " ", "sense"}], ",", " ", 
              RowBox[{
               SubscriptBox["higgs", "1"], " ", "happens", " ", "to", " ", 
               "actually", " ", "refer", " ", "to", " ", "the", " ", 
               "\"\<try\>\"", " ", "number", " ", "as", " ", "well", " ", 
               "as", " ", "the", " ", "number", " ", "of", " ", "the", " ", 
               "higgsed", " ", 
               RowBox[{"leg", "."}]}]}], "*)"}], "\[IndentingNewLine]", "]"}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<Level is \>\"", ",", "level", ",", 
             "\"\< and we have to check \>\"", ",", 
             RowBox[{"Length", "[", 
              SubscriptBox["kills", "level"], "]"}], ",", "\"\< guys.\>\""}], 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"try", "=", "1"}], ",", 
             RowBox[{"try", "<", 
              RowBox[{
               RowBox[{"Length", "[", 
                SubscriptBox["kills", "level"], "]"}], "+", "1"}]}], ",", 
             RowBox[{"try", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"die", "=", 
               RowBox[{"{", "}"}]}], ";", 
              RowBox[{"(*", 
               RowBox[{
               "Will", " ", "contains", " ", "the", " ", "list", " ", "of", 
                " ", "which", " ", "columns", " ", "die"}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"hig", "=", "1"}], ",", 
                RowBox[{"hig", "<", 
                 RowBox[{"level", "+", "1"}]}], ",", 
                RowBox[{"hig", "++"}], ",", 
                RowBox[{"(*", 
                 RowBox[{
                 "We", " ", "are", " ", "higgsing", " ", "\"\<level\>\"", " ",
                   "number", " ", "of", " ", "fields"}], "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"kil", "=", 
                  RowBox[{
                   SubscriptBox["kills", "level"], "[", 
                   RowBox[{"[", 
                    RowBox[{"try", ",", "hig"}], "]"}], "]"}]}], ";", 
                 RowBox[{"(*", 
                  RowBox[{"We", " ", "now", " ", "kill", " ", 
                   RowBox[{"Xlista", "[", 
                    RowBox[{"[", "kil", "]"}], "]"}]}], "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{"For", "[", 
                  RowBox[{
                   RowBox[{"el", "=", "1"}], ",", 
                   RowBox[{"el", "<", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Dimensions", "[", "P", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "+", "1"}]}], ",", 
                   RowBox[{"el", "++"}], ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"kil", ",", "el"}], "]"}], "]"}], "\[Equal]", 
                    "1"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"die", "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{"die", ",", 
                    RowBox[{"{", "el", "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"die", "=", 
               RowBox[{"DeleteDuplicates", "[", "die", "]"}]}], ";", 
              RowBox[{"(*", 
               RowBox[{
               "These", " ", "are", " ", "the", " ", "columns", " ", "that", 
                " ", "must", " ", "be", " ", "removed", " ", "from", " ", 
                "Gmoduli"}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"Gnewtrans", "=", 
               RowBox[{"Delete", "[", 
                RowBox[{
                 RowBox[{"Transpose", "[", "Gmoduli", "]"}], ",", 
                 RowBox[{"Transpose", "[", 
                  RowBox[{"{", "die", "}"}], "]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{"Finished", " ", "killing", " ", "perfect", " ", 
                RowBox[{"matchings", "!"}]}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
               "Now", " ", "check", " ", "if", " ", "Gshorta", " ", "has", 
                " ", "same", " ", "number", " ", "of", " ", "points", " ", 
                "as", " ", 
                RowBox[{"before", "."}]}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"Gnewtrans", "\[Equal]", 
                 RowBox[{"{", "}"}]}], ",", 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{
                  "if", " ", "Gnew", " ", "has", " ", "been", " ", "killed", 
                   " ", "completely"}], ",", 
                  RowBox[{
                   RowBox[{"i", ".", "e", ".", " ", "we"}], " ", "killed", 
                   " ", "all", " ", 
                   RowBox[{"pm", "'"}], "s"}], ",", " ", 
                  RowBox[{
                   RowBox[{"say", " ", "newGshort"}], "=", "Gnew"}]}], "*)"}],
                 "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"newGshort", "=", 
                  RowBox[{"Table", "[", 
                   RowBox[{"0", ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", 
                    RowBox[{
                    RowBox[{"Dimensions", "[", "Gshorta", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", "0"}], "}"}]}], "]"}]}], ";"}], 
                "\[IndentingNewLine]", ",", 
                RowBox[{
                 RowBox[{"Gnew", "=", 
                  RowBox[{"Transpose", "[", "Gnewtrans", "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"newGshort", "=", 
                  RowBox[{"Transpose", "[", 
                   RowBox[{"DeleteDuplicates", "[", "Gnewtrans", "]"}], 
                   "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Dimensions", "[", "newGshort", "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "==", 
                 RowBox[{
                  RowBox[{"Dimensions", "[", "Gshorta", "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  SubscriptBox["higgs", "level"], "=", 
                  RowBox[{"Join", "[", 
                   RowBox[{
                    SubscriptBox["higgs", "level"], ",", 
                    RowBox[{"{", "try", "}"}]}], "]"}]}], ";"}]}], 
               RowBox[{"(*", 
                RowBox[{
                "remebers", " ", "which", " ", "of", " ", "the", " ", 
                 "subsets", " ", "was", " ", "good", " ", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"doesn", "'"}], "t", " ", "know", " ", "what", 
                    " ", "the", " ", "subset", " ", "looks", " ", 
                    RowBox[{"like", ".", " ", 
                    RowBox[{"That", "'"}]}], "s", " ", "what", " ", 
                    "whichnum", " ", "is", " ", "for"}], ")"}], "."}]}], 
                "*)"}], "\[IndentingNewLine]", "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", 
           RowBox[{"(*", 
            RowBox[{"Close", " ", "for", " ", "try"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               SubscriptBox["higgs", "level"], "\[Equal]", 
               RowBox[{"{", "}"}]}], "||", 
              RowBox[{"level", "\[Equal]", 
               RowBox[{"Length", "[", "Xlista", "]"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"level", "\[Equal]", "1"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Print", "[", "\"\<No reductions!\>\"", "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", 
               "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"remSets", "=", 
               RowBox[{"MapThread", "[", 
                RowBox[{"whichnum", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   SubscriptBox["higgs", 
                    RowBox[{"level", "-", "1"}]], ",", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"level", "-", "1"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["higgs", 
                    RowBox[{"level", "-", "1"}]], "]"}], "}"}]}], "]"}]}], 
                  "}"}]}], "]"}]}], ";", " ", 
              RowBox[{"(*", 
               RowBox[{"evaluates", " ", 
                RowBox[{"whichnum", "[", 
                 RowBox[{"x", ",", 
                  RowBox[{"level", "-", "1"}]}], "]"}], " ", "for", " ", 
                "all", " ", "elements", " ", "in", " ", 
                SubscriptBox["higgs", 
                 RowBox[{"level", "-", "1"}]]}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"num", "\[Equal]", "1"}], ",", 
                RowBox[{
                 RowBox[{"higgslist", "=", 
                  RowBox[{"MapThread", "[", 
                   RowBox[{"Xs", ",", 
                    RowBox[{"{", "remSets", "}"}], ",", "2"}], "]"}]}], 
                 ";"}]}], "]"}], ";", " ", 
              RowBox[{"(*", 
               RowBox[{"turns", " ", "numbers", " ", "into", " ", 
                SubscriptBox["X", 
                 RowBox[{"i", ",", "j"}]], " ", "fields"}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"num", "\[Equal]", "2"}], ",", 
                RowBox[{
                 RowBox[{"higgslist", "=", 
                  RowBox[{"MapThread", "[", 
                   RowBox[{"Xshigg", ",", 
                    RowBox[{"{", "remSets", "}"}], ",", "2"}], "]"}]}], 
                 ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"higgslist", "=", 
               RowBox[{"DeleteDuplicates", "[", 
                RowBox[{"Map", "[", 
                 RowBox[{"Sort", ",", "higgslist"}], "]"}], "]"}]}], ";", 
              RowBox[{"(*", 
               RowBox[{
               "Make", " ", "sure", " ", "there", " ", "are", " ", "no", " ", 
                "Higgsings", " ", "that", " ", "are", " ", "actually", " ", 
                "the", " ", "same"}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"Print", "[", 
               RowBox[{"\"\<Can remove \>\"", ",", 
                RowBox[{"level", "-", "1"}], ",", "\"\< legs in \>\"", ",", 
                RowBox[{"Length", "[", "higgslist", "]"}], ",", 
                "\"\< different ways.\>\""}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<Sets of legs that can be Higgsed are 'higgslist'= \>\"", 
                ",", "higgslist"}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
      RowBox[{"(*", 
       RowBox[{"Close", " ", "while"}], "*)"}], "\[IndentingNewLine]", 
      "]"}]}]}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"DONE", ",", " ", 
    RowBox[{"NOW", " ", "CALLED", " ", "reductionGraphBFT"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Higgses", " ", "a", " ", "field"}], ",", " ", 
    RowBox[{
    "giving", " ", "the", " ", "new", " ", "P", " ", "matrix", " ", "and", 
     " ", "the", " ", "higgsed", " ", "moduli", " ", 
     RowBox[{"space", ".", " ", "Assumes"}], " ", "that", " ", "P", " ", 
     "and", " ", "Xlist", " ", "are", " ", "already", " ", 
     RowBox[{"known", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"higgs", "[", 
     RowBox[{"field_", ",", "Xlist_", ",", "P_", ",", "Gmoduli_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"num", ",", "killist", ",", "rowhiggs"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"num", "=", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"Xlist", ",", "field"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"killist", "=", 
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"P", "[", 
           RowBox[{"[", "num", "]"}], "]"}], ",", "1"}], "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "These", " ", "are", " ", "the", " ", "perfect", " ", "matchings", 
         " ", "that", " ", "die"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "We", " ", "also", " ", "have", " ", "to", " ", "higgs", " ", "any", 
         " ", "row", " ", "that", " ", "is", " ", "identical", " ", "to", " ",
          "the", " ", "one", " ", "we", " ", "removed"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"rowhiggs", "=", 
        RowBox[{"Position", "[", 
         RowBox[{"P", ",", 
          RowBox[{"P", "[", 
           RowBox[{"[", "num", "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Phiggs", "=", 
        RowBox[{"Delete", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"Delete", "[", 
            RowBox[{
             RowBox[{"Transpose", "[", "P", "]"}], ",", "killist"}], "]"}], 
           "]"}], ",", "rowhiggs"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "We", " ", "have", " ", "to", " ", "also", " ", "change", " ", "the", 
         " ", "moduli", " ", "space"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Gmodulihiggs", "=", 
        RowBox[{"Transpose", "[", 
         RowBox[{"Delete", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", "Gmoduli", "]"}], ",", "killist"}], 
          "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Gmodulihiggs", "=", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{"Gmodulihiggs", ",", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", 
            RowBox[{
             RowBox[{"Dimensions", "[", "Gmodulihiggs", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "This", " ", "is", " ", "the", " ", "space", " ", "we", " ", "get", 
         " ", "after", " ", "having", " ", "killed", " ", "the", " ", 
         RowBox[{"field", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Gmodulihiggs", "\[Equal]", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{
          RowBox[{"Gmodulihiggs", "=", 
           RowBox[{"{", 
            RowBox[{"{", "0", "}"}], "}"}]}], ";"}]}], "]"}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{
        "In", " ", "case", " ", "we", " ", "accidentally", " ", "killed", " ",
          "too", " ", "much"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Xlisthiggs", "=", 
        RowBox[{"Delete", "[", 
         RowBox[{"Xlist", ",", "rowhiggs"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<After killing \>\"", ",", "field", ",", 
         "\"\< the Master space has dimension \>\"", ",", 
         RowBox[{"BFTdim", "[", "Phiggs", "]"}], ",", 
         "\"\< and the moduli space has dimension \>\"", ",", 
         RowBox[{
          RowBox[{"BFTdim", "[", "Gmodulihiggs", "]"}], "\"\<.\>\""}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", 
        "\"\<The new P matrix is saved under 'Phiggs'. New moduli space under \
'Gmodulihiggs'. New Xlist under 'Xlisthiggs'.\>\"", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"reducibility", "[", 
          RowBox[{"Phiggs", ",", "Gmodulihiggs"}], "]"}], ",", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<The space is now reducible!\>\"", "]"}], 
          ";"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"SKIPPED", ",", " ", 
    RowBox[{
    "THIS", " ", "IS", " ", "DONE", " ", "IN", " ", "THREE", " ", "LINES", 
     " ", "IN", " ", "removableEdges"}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Does", " ", "the", " ", "exact", " ", "same", " ", "as", " ", 
     RowBox[{"higgs", "[", 
      RowBox[{"field", ",", "Xlist", ",", "P", ",", "Gmoduli"}], "]"}]}], ",",
     " ", 
    RowBox[{"but", " ", 
     RowBox[{"doesn", "'"}], "t", " ", "print", " ", "out", " ", "lots", " ", 
     "of", " ", 
     RowBox[{"text", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"higgsquiet", "[", 
     RowBox[{"field_", ",", "Xlist_", ",", "P_", ",", "Gmoduli_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"num", ",", "killist", ",", "rowhiggs"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"num", "=", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"Xlist", ",", "field"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"killist", "=", 
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"P", "[", 
           RowBox[{"[", "num", "]"}], "]"}], ",", "1"}], "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "These", " ", "are", " ", "the", " ", "perfect", " ", "matchings", 
         " ", "that", " ", "die"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "We", " ", "also", " ", "have", " ", "to", " ", "higgs", " ", "any", 
         " ", "row", " ", "that", " ", "is", " ", "identical", " ", "to", " ",
          "the", " ", "one", " ", "we", " ", "removed"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"rowhiggs", "=", 
        RowBox[{"Position", "[", 
         RowBox[{"P", ",", 
          RowBox[{"P", "[", 
           RowBox[{"[", "num", "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Phiggs", "=", 
        RowBox[{"Delete", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"Delete", "[", 
            RowBox[{
             RowBox[{"Transpose", "[", "P", "]"}], ",", "killist"}], "]"}], 
           "]"}], ",", "rowhiggs"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "We", " ", "have", " ", "to", " ", "also", " ", "change", " ", "the", 
         " ", "moduli", " ", "space"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Gmodulihiggs", "=", 
        RowBox[{"Transpose", "[", 
         RowBox[{"Delete", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", "Gmoduli", "]"}], ",", "killist"}], 
          "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Gmodulihiggs", "=", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{"Gmodulihiggs", ",", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", 
            RowBox[{
             RowBox[{"Dimensions", "[", "Gmodulihiggs", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "This", " ", "is", " ", "the", " ", "space", " ", "we", " ", "get", 
         " ", "after", " ", "having", " ", "killed", " ", "the", " ", 
         RowBox[{"field", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Gmodulihiggs", "\[Equal]", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{
          RowBox[{"Gmodulihiggs", "=", 
           RowBox[{"{", 
            RowBox[{"{", "0", "}"}], "}"}]}], ";"}]}], "]"}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{
        "In", " ", "case", " ", "we", " ", "accidentally", " ", "killed", " ",
          "too", " ", "much"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Xlisthiggs", "=", 
        RowBox[{"Delete", "[", 
         RowBox[{"Xlist", ",", "rowhiggs"}], "]"}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"SKIPPED", ",", " ", 
    RowBox[{"NOT", " ", "NEEDED"}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Gives", " ", "a", " ", "list", " ", "of", " ", "the", " ", "removable", 
    " ", 
    RowBox[{"legs", ".", " ", "Assumes"}], " ", "that", " ", "P", " ", "and", 
    " ", "Xlist", " ", "are", " ", "already", " ", 
    RowBox[{"known", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"removable", "[", 
     RowBox[{"Xlist_", ",", "P_", ",", "Gmoduli_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "la", ",", "field", ",", "killist", ",", "Ptry", ",", "Gmodulitry", 
        ",", "rowhiggs", ",", "skip"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Now", " ", "calculate", " ", "dimension", " ", "of", " ", "master", 
        " ", "space", " ", "after", " ", "killing", " ", "an", " ", 
        SubscriptBox["X", 
         RowBox[{"i", ",", "j"}]]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"remlegs", "=", 
        RowBox[{"{", "}"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{"lists", " ", "the", " ", "removable", " ", "edges"}], "*)"}],
        "\[IndentingNewLine]", 
       RowBox[{"skip", "=", 
        RowBox[{"{", "}"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "We", " ", "will", " ", "need", " ", "to", " ", "skip", " ", "rows", 
         " ", "that", " ", "are", " ", "identical", " ", "to", " ", "rows", 
         " ", 
         RowBox[{"we", "'"}], "ve", " ", "already", " ", "considered"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"la", "=", "1"}], ",", 
         RowBox[{"la", "<", 
          RowBox[{
           RowBox[{"Length", "[", "P", "]"}], "+", "1"}]}], ",", 
         RowBox[{"la", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"FreeQ", "[", 
             RowBox[{"skip", ",", "la"}], "]"}], ",", 
            RowBox[{"(*", 
             RowBox[{
             "If", " ", "the", " ", "row", " ", "we", " ", "consider", " ", 
              "is", " ", "not", " ", "one", " ", 
              RowBox[{"we", "'"}], "ve", " ", "already", " ", "considered", 
              " ", 
              RowBox[{"(", 
               RowBox[{
               "and", " ", "hence", " ", "been", " ", "told", " ", "to", " ", 
                "skip"}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"field", "=", 
              RowBox[{"Xlist", "[", 
               RowBox[{"[", "la", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"killist", "=", 
              RowBox[{"Position", "[", 
               RowBox[{
                RowBox[{"P", "[", 
                 RowBox[{"[", "la", "]"}], "]"}], ",", "1"}], "]"}]}], ";", 
             RowBox[{"(*", 
              RowBox[{
              "These", " ", "are", " ", "the", " ", "perfect", " ", 
               "matchings", " ", "that", " ", "die"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"rowhiggs", "=", 
              RowBox[{"Position", "[", 
               RowBox[{"P", ",", 
                RowBox[{"P", "[", 
                 RowBox[{"[", "la", "]"}], "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", "rowhiggs", "]"}], ">", "1"}], ",", 
               RowBox[{"skip", "=", 
                RowBox[{"Join", "[", 
                 RowBox[{"skip", ",", 
                  RowBox[{
                   RowBox[{"Transpose", "[", 
                    RowBox[{"Delete", "[", 
                    RowBox[{"rowhiggs", ",", "1"}], "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", "killist", "]"}], "<", 
                RowBox[{
                 RowBox[{"Dimensions", "[", "P", "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", 
               RowBox[{"(*", 
                RowBox[{
                "Only", " ", "kill", " ", "if", " ", "there", " ", "will", 
                 " ", "be", " ", "some", " ", "survivors"}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Ptry", "=", 
                 RowBox[{"Delete", "[", 
                  RowBox[{
                   RowBox[{"Transpose", "[", 
                    RowBox[{"Delete", "[", 
                    RowBox[{
                    RowBox[{"Transpose", "[", "P", "]"}], ",", "killist"}], 
                    "]"}], "]"}], ",", "rowhiggs"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"Gmodulitry", "=", 
                 RowBox[{"Transpose", "[", 
                  RowBox[{"Delete", "[", 
                   RowBox[{
                    RowBox[{"Transpose", "[", "Gmoduli", "]"}], ",", 
                    "killist"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"Gmodulitry", "=", 
                 RowBox[{"DeleteCases", "[", 
                  RowBox[{"Gmodulitry", ",", 
                   RowBox[{"ConstantArray", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{
                    RowBox[{"Dimensions", "[", "Gmodulitry", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"Gmodulitry", "\[Equal]", 
                   RowBox[{"{", "}"}]}], ",", 
                  RowBox[{
                   RowBox[{"Gmodulitry", "=", 
                    RowBox[{"{", 
                    RowBox[{"{", "0", "}"}], "}"}]}], ";"}]}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"!", 
                   RowBox[{"reducibility", "[", 
                    RowBox[{"Ptry", ",", "Gmodulitry"}], "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"remlegs", "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{"remlegs", ",", 
                    RowBox[{"{", "field", "}"}]}], "]"}]}], ";"}]}], "]"}], 
                ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "remlegs", "]"}], "\[NotEqual]", "0"}], ",", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<The removable legs are 'remlegs'=\>\"", ",", "remlegs"}], 
           "]"}], ";"}], ",", 
         RowBox[{
         "Print", "[", "\"\<There are no removable legs!\>\"", "]"}]}], "]"}],
        ";"}]}], "\[IndentingNewLine]", "]"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"DONE", ",", " ", 
    RowBox[{
    "THIS", " ", "IS", " ", "NOW", " ", "PART", " ", "OF", " ", 
     "removableEdges"}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Same", " ", "as", " ", 
     RowBox[{"removable", "[", 
      RowBox[{"Xlist", ",", "P", ",", "Gmoduli"}], "]"}]}], ",", " ", 
    RowBox[{"but", " ", 
     RowBox[{"doesn", "'"}], "t", " ", "print", " ", "any", " ", 
     RowBox[{"text", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"removablequiet", "[", 
     RowBox[{"Xlist_", ",", "P_", ",", "Gmoduli_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "la", ",", "field", ",", "killist", ",", "Ptry", ",", "Gmodulitry", 
        ",", "rowhiggs", ",", "skip"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Now", " ", "calculate", " ", "dimension", " ", "of", " ", "master", 
        " ", "space", " ", "after", " ", "killing", " ", "an", " ", 
        SubscriptBox["X", 
         RowBox[{"i", ",", "j"}]]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"remlegs", "=", 
        RowBox[{"{", "}"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{"lists", " ", "the", " ", "removable", " ", "edges"}], "*)"}],
        "\[IndentingNewLine]", 
       RowBox[{"skip", "=", 
        RowBox[{"{", "}"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "We", " ", "will", " ", "need", " ", "to", " ", "skip", " ", "rows", 
         " ", "that", " ", "are", " ", "identical", " ", "to", " ", "rows", 
         " ", 
         RowBox[{"we", "'"}], "ve", " ", "already", " ", "considered"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"la", "=", "1"}], ",", 
         RowBox[{"la", "<", 
          RowBox[{
           RowBox[{"Length", "[", "P", "]"}], "+", "1"}]}], ",", 
         RowBox[{"la", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"FreeQ", "[", 
             RowBox[{"skip", ",", "la"}], "]"}], ",", 
            RowBox[{"(*", 
             RowBox[{
             "If", " ", "the", " ", "row", " ", "we", " ", "consider", " ", 
              "is", " ", "not", " ", "one", " ", 
              RowBox[{"we", "'"}], "ve", " ", "already", " ", "considered", 
              " ", 
              RowBox[{"(", 
               RowBox[{
               "and", " ", "hence", " ", "been", " ", "told", " ", "to", " ", 
                "skip"}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"field", "=", 
              RowBox[{"Xlist", "[", 
               RowBox[{"[", "la", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"killist", "=", 
              RowBox[{"Position", "[", 
               RowBox[{
                RowBox[{"P", "[", 
                 RowBox[{"[", "la", "]"}], "]"}], ",", "1"}], "]"}]}], ";", 
             RowBox[{"(*", 
              RowBox[{
              "These", " ", "are", " ", "the", " ", "perfect", " ", 
               "matchings", " ", "that", " ", "die"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"rowhiggs", "=", 
              RowBox[{"Position", "[", 
               RowBox[{"P", ",", 
                RowBox[{"P", "[", 
                 RowBox[{"[", "la", "]"}], "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", "rowhiggs", "]"}], ">", "1"}], ",", 
               RowBox[{"skip", "=", 
                RowBox[{"Join", "[", 
                 RowBox[{"skip", ",", 
                  RowBox[{
                   RowBox[{"Transpose", "[", 
                    RowBox[{"Delete", "[", 
                    RowBox[{"rowhiggs", ",", "1"}], "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", "killist", "]"}], "<", 
                RowBox[{
                 RowBox[{"Dimensions", "[", "P", "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", 
               RowBox[{"(*", 
                RowBox[{
                "Only", " ", "kill", " ", "if", " ", "there", " ", "will", 
                 " ", "be", " ", "some", " ", "survivors"}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Ptry", "=", 
                 RowBox[{"Delete", "[", 
                  RowBox[{
                   RowBox[{"Transpose", "[", 
                    RowBox[{"Delete", "[", 
                    RowBox[{
                    RowBox[{"Transpose", "[", "P", "]"}], ",", "killist"}], 
                    "]"}], "]"}], ",", "rowhiggs"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"Gmodulitry", "=", 
                 RowBox[{"Transpose", "[", 
                  RowBox[{"Delete", "[", 
                   RowBox[{
                    RowBox[{"Transpose", "[", "Gmoduli", "]"}], ",", 
                    "killist"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"Gmodulitry", "=", 
                 RowBox[{"DeleteCases", "[", 
                  RowBox[{"Gmodulitry", ",", 
                   RowBox[{"ConstantArray", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{
                    RowBox[{"Dimensions", "[", "Gmodulitry", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"Gmodulitry", "\[Equal]", 
                   RowBox[{"{", "}"}]}], ",", 
                  RowBox[{
                   RowBox[{"Gmodulitry", "=", 
                    RowBox[{"{", 
                    RowBox[{"{", "0", "}"}], "}"}]}], ";"}]}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"!", 
                   RowBox[{"reducibility", "[", 
                    RowBox[{"Ptry", ",", "Gmodulitry"}], "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"remlegs", "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{"remlegs", ",", 
                    RowBox[{"{", "field", "}"}]}], "]"}]}], ";"}]}], "]"}], 
                ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"SKIPPED", ",", " ", 
    RowBox[{"THIS", " ", "IS", " ", "DONE", " ", "ALREADY"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Checks", " ", "whether", " ", "the", " ", "points", " ", "that", " ", 
     "survive", " ", "after", " ", "killist", " ", "has", " ", "killed", " ", 
     "the", " ", "corresponding", " ", "columns", " ", "are", " ", "indeed", 
     " ", "a", " ", "boundary", " ", "of", " ", "the", " ", 
     RowBox[{"space", ".", " ", "It"}], " ", "checks", " ", "by", " ", 
     "spanning", " ", "a", " ", "hyperplane", " ", "with", " ", "the", " ", 
     "surviving", " ", "points"}], ",", " ", 
    RowBox[{
    "and", " ", "checks", " ", "whether", " ", "the", " ", "dead", " ", 
     "points", " ", "were", " ", "all", " ", "on", " ", "one", " ", "side", 
     " ", "of", " ", "the", " ", "plane", " ", "or", " ", "on", " ", "both", 
     " ", 
     RowBox[{"sides", ".", " ", "Returns"}], " ", "True", " ", "or", " ", 
     RowBox[{"False", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"checkBoundary", "[", 
     RowBox[{"P_", ",", "killist_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "newmat", ",", "gi", ",", "allpoints", ",", "compl", ",", "face", ",", 
        "points", ",", "otherpoints", ",", "co", ",", "plane", ",", "rep", 
        ",", "equ1", ",", "equ2", ",", "equ3", ",", "aa", ",", "bb", ",", 
        "xx", ",", "i", ",", "cor", ",", "try", ",", "below", ",", "on", ",", 
        "above", ",", "check"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", "P", "]"}], ",", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0", ",", 
             RowBox[{"Length", "[", "P", "]"}]}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"newmat", "=", "P"}], ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{
          RowBox[{"newmat", "=", "P"}], ";", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"gi", "=", "1"}], ",", 
            RowBox[{"gi", "<", 
             RowBox[{
              RowBox[{
               RowBox[{"Dimensions", "[", "P", "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "1"}]}], ",", 
            RowBox[{"gi", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"newmat", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "gi"}], "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{"newmat", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "gi"}], "]"}], "]"}], "-", 
               RowBox[{"P", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"allpoints", "=", 
        RowBox[{"Transpose", "[", "newmat", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"compl", "=", 
        RowBox[{
         RowBox[{"Transpose", "[", "killist", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{"These", " ", "are", " ", "the", " ", 
         RowBox[{"pm", "'"}], "s", " ", "that", " ", "die"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"face", "=", 
        RowBox[{"Complement", "[", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{
            RowBox[{"Dimensions", "[", "newmat", "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", "compl"}], "]"}]}], 
       ";", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "These", " ", "are", " ", "the", " ", "ones", " ", "that", " ", 
          "live"}], ",", " ", 
         RowBox[{"and", " ", "span", " ", "a", " ", "hyperplane"}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"points", "=", 
        RowBox[{"{", "}"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "Now", " ", "make", " ", "a", " ", "list", " ", "with", " ", "all", 
         " ", "the", " ", "surviving", " ", "coordinates"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"fa", "=", "1"}], ",", 
         RowBox[{"fa", "<", 
          RowBox[{
           RowBox[{"Length", "[", "face", "]"}], "+", "1"}]}], ",", 
         RowBox[{"fa", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"points", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"points", ",", 
             RowBox[{"{", 
              RowBox[{"allpoints", "[", 
               RowBox[{"[", 
                RowBox[{"face", "[", 
                 RowBox[{"[", "fa", "]"}], "]"}], "]"}], "]"}], "}"}]}], 
            "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"otherpoints", "=", 
        RowBox[{"{", "}"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "These", " ", "are", " ", "the", " ", "dead", " ", "coordinates"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"co", "=", "1"}], ",", 
         RowBox[{"co", "<", 
          RowBox[{
           RowBox[{"Length", "[", "compl", "]"}], "+", "1"}]}], ",", 
         RowBox[{"co", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"otherpoints", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"otherpoints", ",", 
             RowBox[{"{", 
              RowBox[{"allpoints", "[", 
               RowBox[{"[", 
                RowBox[{"compl", "[", 
                 RowBox[{"[", "co", "]"}], "]"}], "]"}], "]"}], "}"}]}], 
            "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"plane", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          SubscriptBox["aa", 
           RowBox[{"i", ",", "j"}]], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"Length", "[", "newmat", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"rep", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"FindInstance", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"plane", ".", 
               RowBox[{"Transpose", "[", "points", "]"}]}], "]"}], "\[Equal]", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{"bb", ",", 
               RowBox[{"Length", "[", "face", "]"}]}], "]"}]}], ",", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"Flatten", "[", "plane", "]"}], ",", 
              RowBox[{"{", "bb", "}"}]}], "]"}], ",", "Reals", ",", "2"}], 
           "]"}], ")"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"equ1", "=", 
        RowBox[{"Simplify", "[", 
         RowBox[{"equ1", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"plane", ".", 
                RowBox[{"Transpose", "[", 
                 RowBox[{"{", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    SubscriptBox["xx", "i"], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "newmat", "]"}]}], "}"}]}], "]"}], 
                  "}"}], "]"}]}], ")"}], "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}], "<", "bb"}], ")"}], "/.",
            "rep"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"equ2", "=", 
        RowBox[{"Simplify", "[", 
         RowBox[{"equ2", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"plane", ".", 
                RowBox[{"Transpose", "[", 
                 RowBox[{"{", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    SubscriptBox["xx", "i"], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "newmat", "]"}]}], "}"}]}], "]"}], 
                  "}"}], "]"}]}], ")"}], "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}], "\[Equal]", "bb"}], 
            ")"}], "/.", "rep"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"equ3", "=", 
        RowBox[{"Simplify", "[", 
         RowBox[{"equ3", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"plane", ".", 
                RowBox[{"Transpose", "[", 
                 RowBox[{"{", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    SubscriptBox["xx", "i"], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "newmat", "]"}]}], "}"}]}], "]"}], 
                  "}"}], "]"}]}], ")"}], "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}], ">", "bb"}], ")"}], "/.",
            "rep"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "We", " ", "have", " ", "the", " ", "equation", " ", "of", " ", "the",
          " ", 
         RowBox[{"hyperplane", "!"}]}], "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"below", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"on", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"above", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", "compl", "]"}], "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", 
         RowBox[{"(*", 
          RowBox[{
          "Now", " ", "try", " ", "each", " ", "of", " ", "the", " ", 
           "points", " ", "that", " ", "died", "  ", "and", " ", "see", " ", 
           "if", " ", "they", " ", "live", " ", "above", " ", "or", " ", 
           "below", " ", "the", " ", "plane"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           SubscriptBox["try", "i"], "=", 
           RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"cor", "=", "1"}], ",", 
            RowBox[{"cor", "<", 
             RowBox[{
              RowBox[{"Length", "[", "newmat", "]"}], "+", "1"}]}], ",", 
            RowBox[{"cor", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              SubscriptBox["try", "i"], "=", 
              RowBox[{"Join", "[", 
               RowBox[{
                SubscriptBox["try", "i"], ",", 
                RowBox[{"{", 
                 RowBox[{
                  SubscriptBox["xx", "cor"], "\[Rule]", 
                  RowBox[{"otherpoints", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "cor"}], "]"}], "]"}]}], "}"}]}], 
               "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"equ1", "/.", 
             SubscriptBox["try", "i"]}], ",", 
            RowBox[{
             RowBox[{"below", "=", 
              RowBox[{"below", "+", "1"}]}], ";"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"equ2", "/.", 
             SubscriptBox["try", "i"]}], ",", 
            RowBox[{
             RowBox[{"on", "=", 
              RowBox[{"on", "+", "1"}]}], ";"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"equ3", "/.", 
             SubscriptBox["try", "i"]}], ",", 
            RowBox[{
             RowBox[{"above", "=", 
              RowBox[{"above", "+", "1"}]}], ";"}]}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"below", "\[Equal]", "0"}], "||", 
          RowBox[{"above", "\[Equal]", "0"}]}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"on", "\[Equal]", "0"}], ",", 
           RowBox[{
            RowBox[{"check", "=", "True"}], ";"}], "\[IndentingNewLine]", ",", 
           RowBox[{
            RowBox[{"check", "=", "True"}], ";", "\[IndentingNewLine]", 
            RowBox[{
            "Print", "[", 
             "\"\<This COULD be a true boundary. Some points that were \
Higgsed were on the boundary. If they were internal in the boundary, then we \
have only Higgsed away perfect matchings that takes us to a true boundary. If \
they were external in the boundary, what we have now is not the actual \
boundary.\>\"", "]"}], ";"}]}], "]"}], "\[IndentingNewLine]", ",", 
         RowBox[{
          RowBox[{"check", "=", "False"}], ";"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "check"}]}], "\[IndentingNewLine]", "]"}]}], 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"SKIPPED", ",", " ", 
    RowBox[{"NO", " ", "NEED", " ", "FOR", " ", 
     RowBox[{"IT", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Calculates", " ", "the", " ", "moduli", " ", "space", " ", "using", " ", 
    "Gauging", " ", "1", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"using", " ", "charge", " ", "matrices"}], ")"}], "."}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"moduliGauging1", "[", 
     RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "IF", ",", "NF", ",", "Delta", ",", "i", ",", "j", ",", "k", ",", 
        "QDT", ",", "QDTlist", ",", "solution", ",", "newQDTlist", ",", 
        "temp", ",", "Q"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"kasteleyn", "[", 
        RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"IF", "=", 
        RowBox[{"internalFaces", "[", 
         RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"NF", "=", 
        RowBox[{"totFaces", "[", 
         RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Gmaster", "=", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{
          RowBox[{"RowReduce", "[", "P", "]"}], ",", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", 
            RowBox[{
             RowBox[{"Dimensions", "[", "P", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<The Master space is \>\"", ",", 
         RowBox[{"BFTdim", "[", "Gmaster", "]"}], ",", 
         "\"\<-dimensional. (NB This is the dimension of its toric diagram!).\
\>\""}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"QF", "=", 
        RowBox[{"NullSpace", "[", "P", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<\!\(\*SubscriptBox[\(Q\), \(F\)]\) = \>\"", ",", 
          RowBox[{"QF", "//", "MatrixForm"}]}], "]"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"First", " ", "make", " ", "Delta"}], ",", " ", 
         RowBox[{
          RowBox[{"then", " ", "plug", " ", "in", " ", "the", " ", "non"}], 
          "-", 
          RowBox[{"zero", " ", 
           RowBox[{"numbers", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Delta", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{"Length", "[", "Xlist", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", "IF"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Now", " ", "fill", " ", "in", " ", "the", " ", "non"}], "=", 
         RowBox[{"zero", " ", "numbers"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{"NF", "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "<", 
             RowBox[{"NF", "+", "1"}]}], ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"Take", " ", "a", " ", "specific", " ", 
              SubscriptBox["X", 
               RowBox[{"i", ",", "j"}]], " ", "or", " ", 
              SubscriptBox["Y", 
               RowBox[{"i", ",", "j"}]], " ", 
              RowBox[{"etc", ".", " ", "and"}], " ", "check", " ", "if", " ", 
              RowBox[{"it", "'"}], "s", " ", "in", " ", 
              RowBox[{"Xlist", "."}]}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"i", "\[NotEqual]", "j"}], ",", " ", 
               RowBox[{"(*", 
                RowBox[{
                 SubscriptBox["X", 
                  RowBox[{"i", ",", "i"}]], " ", 
                 RowBox[{"shouldn", "'"}], "t", " ", "be", " ", "nonzero"}], 
                "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"k", "=", "1"}], ",", 
                  RowBox[{"k", "<", 
                   RowBox[{
                    RowBox[{"Length", "[", "Xlist", "]"}], "+", "1"}]}], ",", 
                  RowBox[{"k", "++"}], ",", " ", 
                  RowBox[{"(*", 
                   RowBox[{
                   "Run", " ", "through", " ", "the", " ", "whole", " ", 
                    "Xlist"}], "*)"}], "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["X", 
                    RowBox[{"i", ",", "j"}]], "\[Equal]", 
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "&&", 
                    RowBox[{"i", "\[NotEqual]", "j"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i"}], "]"}], "]"}], "=", "1"}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"j", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{"-", "1"}]}], ";"}]}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["Y", 
                    RowBox[{"i", ",", "j"}]], "\[Equal]", 
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "&&", 
                    RowBox[{"i", "\[NotEqual]", "j"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i"}], "]"}], "]"}], "=", "1"}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"j", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{"-", "1"}]}], ";"}]}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["Z", 
                    RowBox[{"i", ",", "j"}]], "\[Equal]", 
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "&&", 
                    RowBox[{"i", "\[NotEqual]", "j"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i"}], "]"}], "]"}], "=", "1"}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"j", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{"-", "1"}]}], ";"}]}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["W", 
                    RowBox[{"i", ",", "j"}]], "\[Equal]", 
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "&&", 
                    RowBox[{"i", "\[NotEqual]", "j"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i"}], "]"}], "]"}], "=", "1"}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"j", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{"-", "1"}]}], ";"}]}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["V", 
                    RowBox[{"i", ",", "j"}]], "\[Equal]", 
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "&&", 
                    RowBox[{"i", "\[NotEqual]", "j"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i"}], "]"}], "]"}], "=", "1"}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"j", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{"-", "1"}]}], ";"}]}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["UU", 
                    RowBox[{"i", ",", "j"}]], "\[Equal]", 
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "&&", 
                    RowBox[{"i", "\[NotEqual]", "j"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i"}], "]"}], "]"}], "=", "1"}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"j", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{"-", "1"}]}], ";"}]}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["XX", 
                    RowBox[{"i", ",", "j"}]], "\[Equal]", 
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "&&", 
                    RowBox[{"i", "\[NotEqual]", "j"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i"}], "]"}], "]"}], "=", "1"}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"j", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{"-", "1"}]}], ";"}]}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["YY", 
                    RowBox[{"i", ",", "j"}]], "\[Equal]", 
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "&&", 
                    RowBox[{"i", "\[NotEqual]", "j"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i"}], "]"}], "]"}], "=", "1"}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"j", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{"-", "1"}]}], ";"}]}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<\[CapitalDelta] = \>\"", ",", 
           RowBox[{"Delta", "//", "MatrixForm"}]}], "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Make", " ", "the", " ", "variables", " ", "that", " ", "go", " ", 
         "into", " ", "QDT"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"QDT", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          SubscriptBox["y", 
           RowBox[{"m", ",", "n"}]], ",", 
          RowBox[{"{", 
           RowBox[{"m", ",", 
            RowBox[{"Length", "[", "plist", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "IF"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Put", " ", "all", " ", "the", " ", "elements", " ", 
          SubscriptBox["y", 
           RowBox[{"m", ",", "n"}]], " ", "in", " ", "a", " ", "long", " ", 
          "list"}], ",", " ", 
         RowBox[{
         "so", " ", "that", " ", "we", " ", "can", " ", "solve", " ", "for", 
          " ", "the", " ", 
          RowBox[{"list", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"QDTlist", "=", 
        RowBox[{"Flatten", "[", "QDT", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"solution", "=", 
        RowBox[{"Solve", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"P", ".", "QDT"}], "==", "Delta"}], ",", "QDTlist"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"newQDTlist", "=", 
        RowBox[{"QDTlist", "/.", "solution"}]}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{
        "Plug", " ", "in", " ", "solution", " ", "into", " ", "a", " ", 
         "matrix"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Now", " ", "need", " ", "to", " ", "put", " ", "the", " ", 
         "elements", " ", "back", " ", "into", " ", "QDT"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"temp", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", "plist", "]"}], "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "<", 
             RowBox[{"IF", "+", "1"}]}], ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"QDT", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
              RowBox[{"newQDTlist", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "temp"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"temp", "=", 
              RowBox[{"temp", "+", "1"}]}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"QD", "=", 
        RowBox[{"Transpose", "[", "QDT", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<\!\(\*SubscriptBox[\(Q\), \(D\)]\)= \>\"", ",", 
           RowBox[{"QD", "//", "MatrixForm"}]}], "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Q", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"QF", ",", "QD"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Q = \>\"", ",", 
           RowBox[{"Q", "//", "MatrixForm"}]}], "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Gmoduli", "=", 
        RowBox[{"NullSpace", "[", "Q", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<G = \>\"", ",", 
         RowBox[{"Gmoduli", "//", "MatrixForm"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<The moduli space is \>\"", ",", 
         RowBox[{"BFTdim", "[", "Gmoduli", "]"}], ",", 
         "\"\<-dimensional. (NB This is the dimension of its toric diagram!).\
\>\""}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Gshort", "=", 
        RowBox[{"Transpose", "[", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Transpose", "[", "Gmoduli", "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Multmatrix", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Dimensions", "[", 
            RowBox[{
             RowBox[{"Gather", "[", 
              RowBox[{"Transpose", "[", "Gmoduli", "]"}], "]"}], "[", 
             RowBox[{"[", "y", "]"}], "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", 
            RowBox[{
             RowBox[{"Dimensions", "[", 
              RowBox[{"Gather", "[", 
               RowBox[{"Transpose", "[", "Gmoduli", "]"}], "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", "\"\<-------------------------------------\>\"", "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", 
        "\"\<Variables are 'Gmaster'=master space; 'Gmoduli'=moduli space; \
'Gshort'=moduli space where doubles have been removed; \
'Multmatrix'=moultiplicity of each point in Gshort; 'QF'=redundancies (F-term \
charge matrix); 'QD'=D-term charge matrix;\>\"", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", "\"\<-------------------------------------\>\"", "]"}], 
       ";"}]}], "\[IndentingNewLine]", "]"}]}], "*)"}], "\[IndentingNewLine]",
   "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"DONE", ",", " ", 
    RowBox[{"NOW", " ", "CALLED", " ", "moduliSpaceBFT"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Finds", " ", "the", " ", "zig"}], "-", 
    RowBox[{
    "zag", " ", "paths", " ", "expressed", " ", "as", " ", "a", " ", 
     "product", " ", "and", " ", "division", " ", "of", " ", "fields", " ", 
     SubscriptBox["X", 
      RowBox[{"i", ",", "j"}]], " ", 
     RowBox[{"etc", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"sub1", "[", "field_", "]"}], ":=", 
     RowBox[{"field", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"sub2", "[", "field_", "]"}], ":=", 
     RowBox[{"field", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"makeZigzags", "[", 
     RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "K0full", ",", "bvar", ",", "cvar", ",", "ci", ",", "field", ",", 
        "rowpos", ",", "colpos", ",", "column", ",", "row", ",", "j"}], "}"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "Print", "[", 
        "\"\<zig-zags are stored under \!\(\*SubscriptBox[\(zig\), \
\(i\)]\)=...  and zigzag={list of all \!\(\*SubscriptBox[\(zig\), \(i\)]\)}\>\
\"", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"K0full", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{"a", ",", "c"}], "]"}], ",", 
          RowBox[{"Join", "[", 
           RowBox[{"b", ",", "d"}], "]"}], ",", "2"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"bvar", "=", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", "b", "]"}], ",", "0"}], "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{"Variables", " ", "in", " ", "b"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"cvar", "=", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", "c", "]"}], ",", "0"}], "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{"Variables", " ", "in", " ", "c"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"zigzag", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"First", " ", "go", " ", "throgh", " ", "the", " ", "zig"}], 
         "-", 
         RowBox[{
         "zags", " ", "starting", " ", "from", " ", "white", " ", "nodes", 
          " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"i", ".", "e", ".", " ", "starting"}], " ", "from", " ", 
            "fields", " ", "in", " ", "the", "  ", "matrix", " ", "c"}]}]}]}],
         "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"ci", "=", "1"}], ",", 
         RowBox[{"ci", "<", 
          RowBox[{
           RowBox[{"Length", "[", "c", "]"}], "+", "1"}]}], ",", 
         RowBox[{"ci", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"field", "=", 
           RowBox[{
            RowBox[{"DeleteCases", "[", 
             RowBox[{
              RowBox[{"c", "[", 
               RowBox[{"[", "ci", "]"}], "]"}], ",", "0"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           SubscriptBox["zig", "ci"], "=", "field"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"rowpos", "=", 
           RowBox[{
            RowBox[{"Length", "[", "a", "]"}], "+", "ci"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{"True", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"colpos", "=", 
              RowBox[{
               RowBox[{"Position", "[", 
                RowBox[{
                 RowBox[{"K0full", "[", 
                  RowBox[{"[", "rowpos", "]"}], "]"}], ",", "field"}], "]"}], 
               "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
             RowBox[{"(*", 
              RowBox[{
              "colpos", " ", "is", " ", "the", " ", "column", " ", "number", 
               " ", "this", " ", "field", " ", "is", " ", "in"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "Now", " ", "look", " ", "for", " ", "its", " ", "partner", " ",
                "in", " ", "the", " ", "column"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"column", "=", 
              RowBox[{"DeleteCases", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Transpose", "[", "K0full", "]"}], "[", 
                 RowBox[{"[", "colpos", "]"}], "]"}], ",", "0"}], "]"}]}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"j", "=", "1"}], ",", 
               RowBox[{"j", "<", 
                RowBox[{
                 RowBox[{"Length", "[", "column", "]"}], "+", "1"}]}], ",", 
               RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"sub1", "[", 
                    RowBox[{"column", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}], "\[Equal]", 
                   RowBox[{"sub2", "[", "field", "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["zig", "ci"], "=", 
                    RowBox[{
                    SubscriptBox["zig", "ci"], "/", 
                    RowBox[{"column", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"field", "=", 
                    RowBox[{"column", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", 
                 "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"If", " ", 
                RowBox[{"we", "'"}], "ve", " ", "ended", " ", "up", " ", 
                "inside", " ", "c"}], ",", " ", 
               RowBox[{
                RowBox[{
                "this", " ", "is", " ", "the", " ", "end", " ", "of", " ", 
                 "the", " ", "zig"}], "-", "zag"}]}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"MemberQ", "[", 
                RowBox[{"cvar", ",", "field"}], "]"}], ",", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{
                  RowBox[{"Subscript", "[", 
                   RowBox[{"\"\<zig\>\"", ",", "ci"}], "]"}], ",", 
                  "\"\< = \>\"", ",", 
                  SubscriptBox["zig", "ci"]}], "]"}], ";", 
                RowBox[{"zigzag", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{"zigzag", ",", 
                   RowBox[{"{", 
                    SubscriptBox["zig", "ci"], "}"}]}], "]"}]}], ";", 
                RowBox[{"Break", "[", "]"}]}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "Find", " ", "which", " ", "row", " ", "number", " ", "this", 
               " ", "new", " ", "field", " ", "has"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"rowpos", "=", 
              RowBox[{
               RowBox[{"Position", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Transpose", "[", "K0full", "]"}], "[", 
                  RowBox[{"[", "colpos", "]"}], "]"}], ",", "field"}], "]"}], 
               "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "Now", " ", "look", " ", "for", " ", "its", " ", "partner", " ",
                "in", " ", "the", " ", "row"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"row", "=", 
              RowBox[{"DeleteCases", "[", 
               RowBox[{
                RowBox[{"K0full", "[", 
                 RowBox[{"[", "rowpos", "]"}], "]"}], ",", "0"}], "]"}]}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"j", "=", "1"}], ",", 
               RowBox[{"j", "<", 
                RowBox[{
                 RowBox[{"Length", "[", "row", "]"}], "+", "1"}]}], ",", 
               RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"sub1", "[", 
                    RowBox[{"row", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}], "\[Equal]", 
                   RowBox[{"sub2", "[", "field", "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["zig", "ci"], "=", 
                    RowBox[{
                    SubscriptBox["zig", "ci"], 
                    RowBox[{"row", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"field", "=", 
                    RowBox[{"row", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", 
                 "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"If", " ", 
                RowBox[{"we", "'"}], "ve", " ", "ended", " ", "up", " ", 
                "inside", " ", "b"}], ",", " ", 
               RowBox[{
                RowBox[{
                "this", " ", "is", " ", "the", " ", "end", " ", "of", " ", 
                 "the", " ", "zig"}], "-", "zag"}]}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"MemberQ", "[", 
                RowBox[{"bvar", ",", "field"}], "]"}], ",", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{
                  RowBox[{"Subscript", "[", 
                   RowBox[{"\"\<zig\>\"", ",", "ci"}], "]"}], ",", 
                  "\"\< = \>\"", ",", 
                  SubscriptBox["zig", "ci"]}], "]"}], ";", 
                RowBox[{"zigzag", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{"zigzag", ",", 
                   RowBox[{"{", 
                    SubscriptBox["zig", "ci"], "}"}]}], "]"}]}], ";", 
                RowBox[{"Break", "[", "]"}]}]}], "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Now", " ", "go", " ", "throgh", " ", "the", " ", "zig"}], 
         "-", 
         RowBox[{
         "zags", " ", "starting", " ", "from", " ", "black", " ", "nodes", 
          " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"i", ".", "e", ".", " ", "starting"}], " ", "from", " ", 
            "fields", " ", "in", " ", "the", "  ", "matrix", " ", "b"}]}]}]}],
         "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"bi", "=", "1"}], ",", 
         RowBox[{"bi", "<", 
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"Transpose", "[", "b", "]"}], "]"}], "+", "1"}]}], ",", 
         RowBox[{"bi", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"field", "=", 
           RowBox[{
            RowBox[{"DeleteCases", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Transpose", "[", "b", "]"}], "[", 
               RowBox[{"[", "bi", "]"}], "]"}], ",", "0"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           SubscriptBox["zig", 
            RowBox[{
             RowBox[{"Length", "[", "c", "]"}], "+", "bi"}]], "=", 
           RowBox[{"1", "/", "field"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"colpos", "=", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Transpose", "[", "a", "]"}], "]"}], "+", "bi"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{"True", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"rowpos", "=", 
              RowBox[{
               RowBox[{"Position", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Transpose", "[", "K0full", "]"}], "[", 
                  RowBox[{"[", "colpos", "]"}], "]"}], ",", "field"}], "]"}], 
               "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "Now", " ", "look", " ", "for", " ", "its", " ", "partner", " ",
                "in", " ", "the", " ", "row"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"row", "=", 
              RowBox[{"DeleteCases", "[", 
               RowBox[{
                RowBox[{"K0full", "[", 
                 RowBox[{"[", "rowpos", "]"}], "]"}], ",", "0"}], "]"}]}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"j", "=", "1"}], ",", 
               RowBox[{"j", "<", 
                RowBox[{
                 RowBox[{"Length", "[", "row", "]"}], "+", "1"}]}], ",", 
               RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"sub1", "[", 
                    RowBox[{"row", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}], "\[Equal]", 
                   RowBox[{"sub2", "[", "field", "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["zig", 
                    RowBox[{
                    RowBox[{"Length", "[", "c", "]"}], "+", "bi"}]], "=", 
                    RowBox[{
                    SubscriptBox["zig", 
                    RowBox[{
                    RowBox[{"Length", "[", "c", "]"}], "+", "bi"}]], 
                    RowBox[{"row", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"field", "=", 
                    RowBox[{"row", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", 
                 "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"If", " ", 
                RowBox[{"we", "'"}], "ve", " ", "ended", " ", "up", " ", 
                "inside", " ", "b"}], ",", " ", 
               RowBox[{
                RowBox[{
                "this", " ", "is", " ", "the", " ", "end", " ", "of", " ", 
                 "the", " ", "zig"}], "-", "zag"}]}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"MemberQ", "[", 
                RowBox[{"bvar", ",", "field"}], "]"}], ",", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{
                  RowBox[{"Subscript", "[", 
                   RowBox[{"\"\<zig\>\"", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "c", "]"}], "+", "bi"}]}], "]"}], 
                  ",", "\"\< = \>\"", ",", 
                  SubscriptBox["zig", 
                   RowBox[{
                    RowBox[{"Length", "[", "c", "]"}], "+", "bi"}]]}], "]"}], 
                ";", 
                RowBox[{"zigzag", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{"zigzag", ",", 
                   RowBox[{"{", 
                    SubscriptBox["zig", 
                    RowBox[{
                    RowBox[{"Length", "[", "c", "]"}], "+", "bi"}]], "}"}]}], 
                  "]"}]}], ";", 
                RowBox[{"Break", "[", "]"}]}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "Find", " ", "out", " ", "which", " ", "column", " ", "number", 
               " ", "this", " ", "new", " ", "field", " ", "has"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"colpos", "=", 
              RowBox[{
               RowBox[{"Position", "[", 
                RowBox[{
                 RowBox[{"K0full", "[", 
                  RowBox[{"[", "rowpos", "]"}], "]"}], ",", "field"}], "]"}], 
               "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "Now", " ", "look", " ", "for", " ", "its", " ", "partner", " ",
                "in", " ", "the", " ", "column"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"column", "=", 
              RowBox[{"DeleteCases", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Transpose", "[", "K0full", "]"}], "[", 
                 RowBox[{"[", "colpos", "]"}], "]"}], ",", "0"}], "]"}]}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"j", "=", "1"}], ",", 
               RowBox[{"j", "<", 
                RowBox[{
                 RowBox[{"Length", "[", "column", "]"}], "+", "1"}]}], ",", 
               RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"sub1", "[", 
                    RowBox[{"column", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}], "\[Equal]", 
                   RowBox[{"sub2", "[", "field", "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["zig", 
                    RowBox[{
                    RowBox[{"Length", "[", "c", "]"}], "+", "bi"}]], "=", 
                    RowBox[{
                    SubscriptBox["zig", 
                    RowBox[{
                    RowBox[{"Length", "[", "c", "]"}], "+", "bi"}]], "/", 
                    RowBox[{"column", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"field", "=", 
                    RowBox[{"column", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", 
                 "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"If", " ", 
                RowBox[{"we", "'"}], "ve", " ", "ended", " ", "up", " ", 
                "inside", " ", "c"}], ",", " ", 
               RowBox[{
                RowBox[{
                "this", " ", "is", " ", "the", " ", "end", " ", "of", " ", 
                 "the", " ", "zig"}], "-", "zag"}]}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"MemberQ", "[", 
                RowBox[{"cvar", ",", "field"}], "]"}], ",", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{
                  RowBox[{"Subscript", "[", 
                   RowBox[{"\"\<zig\>\"", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "c", "]"}], "+", "bi"}]}], "]"}], 
                  ",", "\"\< = \>\"", ",", 
                  SubscriptBox["zig", 
                   RowBox[{
                    RowBox[{"Length", "[", "c", "]"}], "+", "bi"}]]}], "]"}], 
                ";", 
                RowBox[{"zigzag", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{"zigzag", ",", 
                   RowBox[{"{", 
                    SubscriptBox["zig", 
                    RowBox[{
                    RowBox[{"Length", "[", "c", "]"}], "+", "bi"}]], "}"}]}], 
                  "]"}]}], ";", 
                RowBox[{"Break", "[", "]"}]}]}], "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Tells", " ", "you", " ", "which", " ", "two", " ", "perfect", " ", 
     "matchings", " ", "produce", " ", "a", " ", "given", " ", 
     RowBox[{"zigzag", ".", " ", "'"}], 
     RowBox[{"zigzag", "'"}], " ", "should", " ", "be", " ", "given", " ", 
     "as", " ", "the", " ", "product", " ", "and", " ", "division", " ", "of",
      " ", 
     RowBox[{
      SubscriptBox["X", 
       RowBox[{"i", ",", "j"}]], "'"}], 
     RowBox[{"s", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"zigzagPerfMatchings", "[", "zigzag_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "i", ",", "ja", ",", "ia", ",", "ib", ",", "signs", ",", 
        "positiveplist"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"signs", "=", 
        RowBox[{"plist", "/.", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Xlist", "[", 
             RowBox[{"[", "ii", "]"}], "]"}], "\[Rule]", "1"}], ",", 
           RowBox[{"{", 
            RowBox[{"ii", ",", 
             RowBox[{"Length", "[", "Xlist", "]"}]}], "}"}]}], "]"}]}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"positiveplist", "=", 
        RowBox[{"plist", "*", "signs"}]}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{
        "Make", " ", "a", " ", "list", " ", "of", " ", "perfect", " ", 
         "matchings", " ", "all", " ", "with", " ", "positive", " ", "signs", 
         " ", 
         RowBox[{"(", 
          RowBox[{
          "Kasteleyn", " ", "sometimes", " ", "gives", " ", "negative", " ", 
           "signs"}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"ja", "=", "1"}], ",", 
         RowBox[{"ja", "<", 
          RowBox[{
           RowBox[{"Length", "[", "zigzag", "]"}], "+", "1"}]}], ",", 
         RowBox[{"ja", "++"}], ",", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Go", " ", "through", " ", "the", " ", "zig"}], "-", 
           "zags"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"ia", "=", "1"}], ",", 
            RowBox[{"ia", "<", 
             RowBox[{
              RowBox[{"Length", "[", "positiveplist", "]"}], "+", "1"}]}], 
            ",", 
            RowBox[{"ia", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"ib", "=", "1"}], ",", 
               RowBox[{"ib", "<", 
                RowBox[{
                 RowBox[{"Length", "[", "positiveplist", "]"}], "+", "1"}]}], 
               ",", 
               RowBox[{"ib", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"zigzag", "[", 
                    RowBox[{"[", "ja", "]"}], "]"}], "\[Equal]", 
                   RowBox[{
                    RowBox[{"positiveplist", "[", 
                    RowBox[{"[", "ia", "]"}], "]"}], "/", 
                    RowBox[{"positiveplist", "[", 
                    RowBox[{"[", "ib", "]"}], "]"}]}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<zig-zag \>\"", ",", "ja", ",", "\"\< = pm[[\>\"", 
                    ",", "ia", ",", "\"\<]]/pm[[\>\"", ",", "ib", ",", 
                    "\"\<]]\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", 
                 "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Checks", " ", "whether", " ", "the", " ", "inputed", " ", 
      "\"\<matroida\>\""}], "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a", ",", "b", ",", "c", ",", ".."}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"d", ",", "e", ",", "f", ",", ".."}], "}"}], ",", "..."}], 
       "}"}], "is", " ", "indeed", " ", "a", " ", 
      RowBox[{"matroid", ".", " ", "Returns"}], " ", "True", " ", "or", " ", 
      "False"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"matroidcheck", "[", "matroida_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "matroid", ",", "win", ",", "i", ",", "j", ",", "pairscore", ",", "k", 
        ",", "el", ",", "trial", ",", "success", ",", "matr"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"matroid", "=", 
        RowBox[{"Map", "[", 
         RowBox[{"Sort", ",", "matroida"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"win", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", "matroid", "]"}], "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "<", 
             RowBox[{
              RowBox[{"Length", "[", "matroid", "]"}], "+", "1"}]}], ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"i", "\[NotEqual]", "j"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"pairscore", "=", "1"}], ";", "\[IndentingNewLine]", 
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"k", "=", "1"}], ",", 
                  RowBox[{"k", "<", 
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"matroid", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "+", "1"}]}], ",", 
                  RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"el", "=", "1"}], ",", 
                    RowBox[{"el", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"matroid", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}], "+", "1"}]}], ",", 
                    RowBox[{"el", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"trial", "=", 
                    RowBox[{"Sort", "[", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"Delete", "[", 
                    RowBox[{
                    RowBox[{"matroid", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "k"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"matroid", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "el"}], "]"}], "]"}], "}"}]}], "]"}], 
                    "]"}]}], ";", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Try", " ", "exchanging", " ", "with", " ", "each", " ", 
                    "element", " ", "of", " ", 
                    RowBox[{"J", "."}]}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"matroid", ",", "trial"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"success", "=", "1"}], ";", 
                    RowBox[{"Break", "[", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"success", "=", "0"}], ";"}]}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"success", "\[Equal]", "0"}], ",", 
                    RowBox[{
                    RowBox[{"pairscore", "=", "0"}], ";"}]}], "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"pairscore", "\[Equal]", "0"}], ",", 
               RowBox[{
                RowBox[{"win", "=", "0"}], ";"}]}], "]"}]}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"win", "\[Equal]", "1"}], ",", 
         RowBox[{"matr", "=", "True"}], ",", 
         RowBox[{"matr", "=", "False"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "matr"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Does", " ", "the", " ", "same", " ", "as", " ", "matroidcheck"}], ",", 
     " ", 
     RowBox[{
     "but", " ", "instead", " ", "or", " ", "returning", " ", "True", " ", 
      "or", " ", "False"}], ",", " ", 
     RowBox[{
     "it", " ", "prints", " ", "out", " ", "all", " ", "the", " ", 
      "failures"}], ",", " ", 
     RowBox[{"or", " ", "whether", " ", "you", " ", "have", " ", "a", " ", 
      RowBox[{"success", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"matroidcheckwrite", "[", "matroida_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "matroid", ",", "win", ",", "i", ",", "j", ",", "pairscore", ",", "k", 
        ",", "el", ",", "trial", ",", "success"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"matroid", "=", 
        RowBox[{"Map", "[", 
         RowBox[{"Sort", ",", "matroida"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"win", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", "matroid", "]"}], "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "<", 
             RowBox[{
              RowBox[{"Length", "[", "matroid", "]"}], "+", "1"}]}], ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"i", "\[NotEqual]", "j"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"pairscore", "=", "1"}], ";", "\[IndentingNewLine]", 
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"k", "=", "1"}], ",", 
                  RowBox[{"k", "<", 
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"matroid", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "+", "1"}]}], ",", 
                  RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"el", "=", "1"}], ",", 
                    RowBox[{"el", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"matroid", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}], "+", "1"}]}], ",", 
                    RowBox[{"el", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"trial", "=", 
                    RowBox[{"Sort", "[", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"Delete", "[", 
                    RowBox[{
                    RowBox[{"matroid", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "k"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"matroid", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "el"}], "]"}], "]"}], "}"}]}], "]"}], 
                    "]"}]}], ";", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Try", " ", "exchanging", " ", "with", " ", "each", " ", 
                    "element", " ", "of", " ", 
                    RowBox[{"J", "."}]}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"matroid", ",", "trial"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"success", "=", "1"}], ";", 
                    RowBox[{"Break", "[", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"success", "=", "0"}], ";"}]}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"success", "\[Equal]", "0"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"pairscore", "=", "0"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Print", "[", 
                    RowBox[{"\"\<Failed! This is I=\>\"", ",", 
                    RowBox[{"matroid", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\"\< and J=\>\"", 
                    ",", 
                    RowBox[{"matroid", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", "\"\< where \>\"", 
                    ",", 
                    RowBox[{"matroid", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "k"}], "]"}], "]"}], ",", 
                    "\"\<\[Element]I cannot be exchanged with anyone in \
J\>\""}], "]"}], ";"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
                ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"pairscore", "\[Equal]", "0"}], ",", 
               RowBox[{
                RowBox[{"win", "=", "0"}], ";"}]}], "]"}]}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"win", "\[Equal]", "1"}], ",", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<It is a matroid!\>\"", "]"}], ";"}]}], 
        "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Finds", " ", "all", " ", "Plucker", " ", "relations", " ", "for", " ", 
     "the", " ", "Pluckers", " ", "of", " ", "Gr", 
     RowBox[{"(", 
      RowBox[{"k", ",", "n"}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pluckerRelations", "[", 
     RowBox[{"k_", ",", "n_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "aa", ",", "bb", ",", "conditions", ",", "\[CapitalDelta]", ",", "i", 
        ",", "j", ",", "relations", ",", "todel", ",", "ii", ",", "jj"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"bb", "=", 
        RowBox[{"Subsets", "[", 
         RowBox[{
          RowBox[{"Range", "[", "n", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", "-", "1"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"aa", "=", 
        RowBox[{"Subsets", "[", 
         RowBox[{
          RowBox[{"Range", "[", "n", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", "+", "1"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"relations", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"conditions", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Rule", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"MapThread", "[", 
             RowBox[{"Subscript", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"ConstantArray", "[", 
                 RowBox[{"\[CapitalDelta]", ",", 
                  RowBox[{"Length", "[", "bb", "]"}]}], "]"}], ",", "bb"}], 
               "}"}]}], "]"}], ",", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"0", ",", 
              RowBox[{"Length", "[", "bb", "]"}]}], "]"}]}], "}"}]}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", "bb", "]"}], "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "<", 
             RowBox[{
              RowBox[{"Length", "[", "aa", "]"}], "+", "1"}]}], ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"relations", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"relations", ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], 
                    RowBox[{"dum", "-", "1"}]], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], 
                    RowBox[{
                    RowBox[{"PermutationOrder", "[", 
                    RowBox[{"Ordering", "[", 
                    RowBox[{"DeleteDuplicates", "[", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"bb", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"aa", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "dum"}], "]"}], "]"}], "}"}]}], "]"}], 
                    "]"}], "]"}], "]"}], "-", "1"}]], 
                    SubscriptBox["\[CapitalDelta]", 
                    RowBox[{"Union", "[", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"bb", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"aa", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "dum"}], "]"}], "]"}], "}"}]}], "]"}], 
                    "]"}]], 
                    SubscriptBox["\[CapitalDelta]", 
                    RowBox[{"Complement", "[", 
                    RowBox[{
                    RowBox[{"aa", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"aa", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "dum"}], "]"}], "]"}], "}"}]}], 
                    "]"}]]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"dum", ",", 
                    RowBox[{"k", "+", "1"}]}], "}"}]}], "]"}], "\[Equal]", 
                   "0"}], "}"}], "/.", "conditions"}]}], "]"}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"relations", "=", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{"relations", ",", "True"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<We have \>\"", ",", 
           RowBox[{"Length", "[", "relations", "]"}], ",", 
           "\"\< Plucker relations:\>\""}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"relations", "//", "MatrixForm"}], "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Remove", " ", "the", " ", "ones", " ", "that", " ", "are", " ", 
         "duplicate", " ", "up", " ", "to", " ", "a", " ", "minus", " ", 
         "sign"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"todel", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"ii", "=", "1"}], ",", 
         RowBox[{"ii", "<", 
          RowBox[{
           RowBox[{"Length", "[", "relations", "]"}], "+", "1"}]}], ",", 
         RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"jj", "=", 
             RowBox[{"ii", "+", "1"}]}], ",", 
            RowBox[{"jj", "<", 
             RowBox[{
              RowBox[{"Length", "[", "relations", "]"}], "+", "1"}]}], ",", 
            RowBox[{"jj", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"relations", "[", 
                  RowBox[{"[", "ii", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
                RowBox[{"-", 
                 RowBox[{
                  RowBox[{"relations", "[", 
                   RowBox[{"[", "jj", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"todel", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{"todel", ",", 
                   RowBox[{"{", 
                    RowBox[{"{", "ii", "}"}], "}"}]}], "]"}]}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"relations", "=", 
        RowBox[{"Delete", "[", 
         RowBox[{"relations", ",", "todel"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "relations"}]}], "\[IndentingNewLine]", "]"}]}],
    "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Gives", " ", "you", " ", "the", " ", "replacement", " ", "list", " ", 
     "for", " ", "perfect", " ", "matching", " ", "going", " ", "to", " ", 
     "their", " ", "source", " ", 
     RowBox[{"set", ".", " ", "You"}], " ", "need", " ", "to", " ", "run", 
     " ", "moduliGaugingX", " ", 
     RowBox[{"first", ".", " ", "The"}], " ", "ordering", " ", "is", " ", 
     "given", " ", "in", " ", "the", " ", "form", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         SubscriptBox["X", 
          RowBox[{"2", ",", "3"}]], "\[Rule]", "1"}], ",", 
        RowBox[{
         SubscriptBox["X", 
          RowBox[{"4", ",", "5"}]], "\[Rule]", "3"}], ",", 
        RowBox[{
         SubscriptBox["X", 
          RowBox[{"2", ",", "5"}]], "\[Rule]", "4"}], ",", 
        RowBox[{
         SubscriptBox["X", 
          RowBox[{"4", ",", "3"}]], "\[Rule]", "2"}]}], "}"}], "."}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pmsourcesOrderingByHand", "[", 
     RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_", ",", "ordering_"}], "]"}],
     ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "flatb", ",", "flatc", ",", "toplu", ",", "pflow", ",", "k", ",", "j", 
        ",", "guys", ",", "i"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"ordering", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Rule", ",", 
           RowBox[{"{", 
            RowBox[{"xb", ",", 
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", "xb", "]"}], "]"}]}], "}"}]}], "]"}]}], 
        ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"ordering", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"2", ",", "3"}]], "\[Rule]", "1"}], ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"4", ",", "5"}]], "\[Rule]", "3"}], ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"2", ",", "5"}]], "\[Rule]", "4"}], ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"4", ",", "3"}]], "\[Rule]", "2"}]}], "}"}]}], ";"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"flatb", "=", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", "b", "]"}], ",", "0"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"flatc", "=", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", "c", "]"}], ",", "0"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"toplu", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "<", 
          RowBox[{
           RowBox[{"Length", "[", "plist", "]"}], "+", "1"}]}], ",", 
         RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           SubscriptBox["pflow", "j"], "=", 
           RowBox[{"{", "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"k", "=", "1"}], ",", 
         RowBox[{"k", "<", 
          RowBox[{
           RowBox[{"Length", "[", "xb", "]"}], "+", "1"}]}], ",", 
         RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"flatb", ",", 
              RowBox[{"xb", "[", 
               RowBox[{"[", "k", "]"}], "]"}]}], "]"}], ",", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Gli", " ", "Uni", " ", "sono", " ", "sorgent"}], ",", 
              " ", 
              RowBox[{
              "se", " ", "no", " ", "gli", " ", "zero", " ", "sono", " ", 
               "sorgenti"}]}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"guys", "=", 
              RowBox[{
               RowBox[{"Transpose", "[", 
                RowBox[{"Position", "[", 
                 RowBox[{
                  RowBox[{"P", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{"Xlist", ",", 
                    RowBox[{"xb", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "]"}], ",", 
                  "1"}], "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"i", "=", "1"}], ",", 
               RowBox[{"i", "<", 
                RowBox[{
                 RowBox[{"Length", "[", "guys", "]"}], "+", "1"}]}], ",", 
               RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 SubscriptBox["pflow", 
                  RowBox[{"guys", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]], "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{
                   SubscriptBox["pflow", 
                    RowBox[{"guys", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]], ",", 
                   RowBox[{"{", 
                    RowBox[{"xb", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "}"}]}], "]"}]}], ";"}]}],
               "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"flatc", ",", 
              RowBox[{"xb", "[", 
               RowBox[{"[", "k", "]"}], "]"}]}], "]"}], ",", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Gli", " ", "Uni", " ", "sono", " ", "sorgent"}], ",", 
              " ", 
              RowBox[{
              "se", " ", "no", " ", "gli", " ", "zero", " ", "sono", " ", 
               "sorgenti"}]}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"guys", "=", 
              RowBox[{
               RowBox[{"Transpose", "[", 
                RowBox[{"Position", "[", 
                 RowBox[{
                  RowBox[{"P", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{"Xlist", ",", 
                    RowBox[{"xb", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "]"}], ",", 
                  "0"}], "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"i", "=", "1"}], ",", 
               RowBox[{"i", "<", 
                RowBox[{
                 RowBox[{"Length", "[", "guys", "]"}], "+", "1"}]}], ",", 
               RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 SubscriptBox["pflow", 
                  RowBox[{"guys", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]], "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{
                   SubscriptBox["pflow", 
                    RowBox[{"guys", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]], ",", 
                   RowBox[{"{", 
                    RowBox[{"xb", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "}"}]}], "]"}]}], ";"}]}],
               "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "<", 
          RowBox[{
           RowBox[{"Length", "[", "plist", "]"}], "+", "1"}]}], ",", 
         RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           SubscriptBox["pflow", "j"], "=", 
           RowBox[{"Sort", "[", 
            RowBox[{
             SubscriptBox["pflow", "j"], "/.", "ordering"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"toplu", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"toplu", ",", 
             RowBox[{"{", 
              RowBox[{"j", "\[Rule]", 
               SubscriptBox["pflow", "j"]}], "}"}]}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "toplu"}]}],
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Gives", " ", "you", " ", "the", " ", "path", " ", "matrix", " ", "of", 
     " ", "a", " ", 
     RowBox[{"BFT", ".", " ", "You"}], " ", "have", " ", "to", " ", "first", 
     " ", "run", " ", 
     RowBox[{"moduliGaugingX", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"pathmatrix", "[", 
      RowBox[{
      "a_", ",", "b_", ",", "c_", ",", "d_", ",", "pmref_", ",", "order_"}], 
      "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "kast", ",", "sources", ",", "cond", ",", "i", ",", "j", ",", 
         "kastduo", ",", "cond3", ",", "kasttrio", ",", "bigguy", ",", 
         "inv"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"kast", "=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{"a", ",", "c"}], "]"}], ",", 
           RowBox[{"Join", "[", 
            RowBox[{"b", ",", "d"}], "]"}], ",", "2"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"sources", "=", 
         RowBox[{"findSources", "[", 
          RowBox[{
          "a", ",", "b", ",", "c", ",", "d", ",", "order", ",", "pmref"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"cond", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "<", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Variables", "[", "pmref", "]"}], "]"}], "+", "1"}]}], 
          ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"cond", "=", 
            RowBox[{"Join", "[", 
             RowBox[{"cond", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"Variables", "[", "pmref", "]"}], "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", "0"}], "}"}]}], 
             "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"kastduo", "=", 
         RowBox[{"kast", "/.", "cond"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"cond3", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "<", 
           RowBox[{
            RowBox[{"Length", "[", "Xlist", "]"}], "+", "1"}]}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"FreeQ", "[", 
              RowBox[{
               RowBox[{"Variables", "[", "pmref", "]"}], ",", 
               RowBox[{"Xlist", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"cond3", "=", 
               RowBox[{"Join", "[", 
                RowBox[{"cond3", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Xlist", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", "0"}], "}"}]}],
                 "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
             RowBox[{
              RowBox[{"cond3", "=", 
               RowBox[{"Join", "[", 
                RowBox[{"cond3", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Xlist", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
                   RowBox[{"1", "/", 
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}]}], "]"}]}], 
              ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"kasttrio", "=", 
         RowBox[{"kast", "/.", "cond3"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"bigguy", "=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"IdentityMatrix", "[", 
              RowBox[{
               RowBox[{"Length", "[", "a", "]"}], "+", 
               RowBox[{"Length", "[", "c", "]"}]}], "]"}], ",", 
             RowBox[{"-", 
              RowBox[{"Transpose", "[", "kasttrio", "]"}]}]}], "]"}], ",", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"-", "kastduo"}], ",", 
             RowBox[{"IdentityMatrix", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Dimensions", "[", "a", "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], "+", 
               RowBox[{
                RowBox[{"Dimensions", "[", "b", "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}], ",", "2"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"bigguy", "//", "MatrixForm"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"inv", "=", 
         RowBox[{"Inverse", "[", "bigguy", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"inv", "//", "MatrixForm"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"pathmat", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             RowBox[{"Length", "[", "sources", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"y", ",", 
             RowBox[{"Length", "[", "order", "]"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "<", 
           RowBox[{
            RowBox[{"Length", "[", "sources", "]"}], "+", "1"}]}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "<", 
             RowBox[{
              RowBox[{"Length", "[", "order", "]"}], "+", "1"}]}], ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"pathmat", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
              RowBox[{"inv", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"sources", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", 
                 RowBox[{"order", "[", 
                  RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "]"}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"pathmat", "=", 
         RowBox[{"Expand", "[", 
          RowBox[{"Simplify", "[", "pathmat", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"fullmatrix", "=", "inv"}], ";", "\[IndentingNewLine]", 
        RowBox[{"loops", "=", 
         RowBox[{"Expand", "[", 
          RowBox[{"Det", "[", "bigguy", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
        "Print", "[", 
         "\"\<The full path matrix is 'fullmatrix', the part that goes from \
sources to sinks is 'pathmat', the loop denominator is 'loops'.\>\"", 
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"DONE", ",", " ", 
     RowBox[{"NOW", " ", "CALLED", " ", "pathMatrix"}]}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Order", " ", "should", " ", "be", " ", 
      RowBox[{"e", ".", "g", ".", " ", 
       RowBox[{"{", 
        RowBox[{"7", ",", "12", ",", "6", ",", "4", ",", "5"}], "}"}], ".", 
       " ", "The"}], " ", "function", " ", "will", " ", "return", " ", "the", 
      " ", "sources"}], ",", " ", 
     RowBox[{"e", ".", "g", ".", " ", 
      RowBox[{"{", 
       RowBox[{"12", ",", "6", ",", "5"}], "}"}], "."}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"findSources", "[", 
      RowBox[{
      "a_", ",", "b_", ",", "c_", ",", "d_", ",", "order_", ",", "pmref_"}], 
      "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "darul", ",", "invrul", ",", "btra", ",", "xtonode", ",", "i", ",", 
         "sources"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"darul", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Rule", ",", 
           RowBox[{"{", 
            RowBox[{"order", ",", 
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", "order", "]"}], "]"}]}], "}"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"invrul", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Rule", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", "order", "]"}], "]"}], ",", "order"}], 
            "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Now", " ", "translate", " ", "fields", " ", "into", " ", "node", 
          " ", "numbers"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"btra", "=", 
         RowBox[{"Transpose", "[", "b", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"xtonode", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "<", 
           RowBox[{
            RowBox[{"Length", "[", "c", "]"}], "+", "1"}]}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"xtonode", "=", 
            RowBox[{"Join", "[", 
             RowBox[{"xtonode", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"DeleteCases", "[", 
                  RowBox[{
                   RowBox[{"c", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "0"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"i", "+", 
                  RowBox[{"Length", "[", "a", "]"}]}], ")"}]}], "}"}]}], 
             "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j", "=", "1"}], ",", 
          RowBox[{"j", "<", 
           RowBox[{
            RowBox[{"Length", "[", "btra", "]"}], "+", "1"}]}], ",", 
          RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"xtonode", "=", 
            RowBox[{"Join", "[", 
             RowBox[{"xtonode", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"DeleteCases", "[", 
                  RowBox[{
                   RowBox[{"btra", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", "0"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"j", "+", 
                  RowBox[{"Length", "[", "a", "]"}], "+", 
                  RowBox[{"Length", "[", "c", "]"}], "+", 
                  RowBox[{
                   RowBox[{"Dimensions", "[", "a", "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}], "}"}]}], 
             "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"sources", "=", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"Complement", "[", 
             RowBox[{
              RowBox[{"DeleteCases", "[", 
               RowBox[{
                RowBox[{"Flatten", "[", "c", "]"}], ",", "0"}], "]"}], ",", 
              RowBox[{"Intersection", "[", 
               RowBox[{
                RowBox[{"DeleteCases", "[", 
                 RowBox[{
                  RowBox[{"Flatten", "[", "c", "]"}], ",", "0"}], "]"}], ",", 
                RowBox[{"Variables", "[", "pmref", "]"}]}], "]"}]}], "]"}], 
            ",", 
            RowBox[{"Intersection", "[", 
             RowBox[{
              RowBox[{"DeleteCases", "[", 
               RowBox[{
                RowBox[{"Flatten", "[", "b", "]"}], ",", "0"}], "]"}], ",", 
              RowBox[{"Variables", "[", "pmref", "]"}]}], "]"}]}], "]"}], "/.",
           "xtonode"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"sources", "=", 
         RowBox[{
          RowBox[{"Sort", "[", 
           RowBox[{"sources", "/.", "darul"}], "]"}], "/.", "invrul"}]}], ";",
         "\[IndentingNewLine]", "sources"}]}], "\[IndentingNewLine]", "]"}]}],
     "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"DONE", ",", " ", 
     RowBox[{
     "SAME", " ", "NAME", " ", "BUT", " ", "USES", " ", "DIFFERENT", " ", 
      "INPUT", " ", "AND", " ", "OUTPUT"}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Order", " ", "should", " ", "be", " ", 
      RowBox[{"e", ".", "g", ".", " ", 
       RowBox[{"{", 
        RowBox[{"7", ",", "12", ",", "6", ",", "4", ",", "5"}], "}"}], ".", 
       " ", "The"}], " ", "function", " ", "will", " ", "return", " ", "the", 
      " ", "sinks"}], ",", " ", 
     RowBox[{"e", ".", "g", ".", " ", 
      RowBox[{"{", 
       RowBox[{"7", ",", "4"}], "}"}], "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"findSinks", "[", 
      RowBox[{
      "a_", ",", "b_", ",", "c_", ",", "d_", ",", "order_", ",", "pmref_"}], 
      "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "darul", ",", "invrul", ",", "btra", ",", "xtonode", ",", "i", ",", 
         "sinks"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"darul", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Rule", ",", 
           RowBox[{"{", 
            RowBox[{"order", ",", 
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", "order", "]"}], "]"}]}], "}"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"invrul", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Rule", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", "order", "]"}], "]"}], ",", "order"}], 
            "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Now", " ", "translate", " ", "fields", " ", "into", " ", "node", 
          " ", "numbers"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"btra", "=", 
         RowBox[{"Transpose", "[", "b", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"xtonode", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "<", 
           RowBox[{
            RowBox[{"Length", "[", "c", "]"}], "+", "1"}]}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"xtonode", "=", 
            RowBox[{"Join", "[", 
             RowBox[{"xtonode", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"DeleteCases", "[", 
                  RowBox[{
                   RowBox[{"c", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "0"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"i", "+", 
                  RowBox[{"Length", "[", "a", "]"}]}], ")"}]}], "}"}]}], 
             "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j", "=", "1"}], ",", 
          RowBox[{"j", "<", 
           RowBox[{
            RowBox[{"Length", "[", "btra", "]"}], "+", "1"}]}], ",", 
          RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"xtonode", "=", 
            RowBox[{"Join", "[", 
             RowBox[{"xtonode", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"DeleteCases", "[", 
                  RowBox[{
                   RowBox[{"btra", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", "0"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"j", "+", 
                  RowBox[{"Length", "[", "a", "]"}], "+", 
                  RowBox[{"Length", "[", "c", "]"}], "+", 
                  RowBox[{
                   RowBox[{"Dimensions", "[", "a", "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}], "}"}]}], 
             "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"sinks", "=", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"Intersection", "[", 
             RowBox[{
              RowBox[{"DeleteCases", "[", 
               RowBox[{
                RowBox[{"Flatten", "[", "c", "]"}], ",", "0"}], "]"}], ",", 
              RowBox[{"Variables", "[", "pmref", "]"}]}], "]"}], ",", 
            RowBox[{"Complement", "[", 
             RowBox[{
              RowBox[{"DeleteCases", "[", 
               RowBox[{
                RowBox[{"Flatten", "[", "b", "]"}], ",", "0"}], "]"}], ",", 
              RowBox[{"Intersection", "[", 
               RowBox[{
                RowBox[{"DeleteCases", "[", 
                 RowBox[{
                  RowBox[{"Flatten", "[", "b", "]"}], ",", "0"}], "]"}], ",", 
                RowBox[{"Variables", "[", "pmref", "]"}]}], "]"}]}], "]"}]}], 
           "]"}], "/.", "xtonode"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"sinks", "=", 
         RowBox[{
          RowBox[{"Sort", "[", 
           RowBox[{"sinks", "/.", "darul"}], "]"}], "/.", "invrul"}]}], ";", 
        "\[IndentingNewLine]", "sinks"}]}], "\[IndentingNewLine]", "]"}]}], 
    "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"DONE", ",", " ", 
     RowBox[{
     "SAME", " ", "NAME", " ", "BUT", " ", "USES", " ", "DIFFERENT", " ", 
      "INPUT", " ", "AND", " ", "OUTPUT"}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"Need", " ", "to", " ", "first", " ", "run", " ", 
       RowBox[{
        RowBox[{"moduliGaugingX", "[", 
         RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], ".", " ", "It"}],
        " ", "works", " ", "only", " ", "GENUS", " ", "0", " ", 
       RowBox[{"embeddings", "!"}], " ", 
       RowBox[{"E", ".", "g", ".", " ", "pmref"}]}], "=", 
      RowBox[{"plist", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
     RowBox[{"order", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "9", ",", "10", ",", "7", ",", "8", ",", "11", ",", "19", ",", "6"}], 
        "}"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
         "assumes", " ", "you", " ", "first", " ", "label", " ", "all", " ", 
          "the", " ", "internal", " ", "white", " ", "nodes"}], ",", " ", 
         RowBox[{
         "then", " ", "all", " ", "external", " ", "white", " ", "nodes"}], 
         ",", " ", 
         RowBox[{"then", " ", "internal", " ", "black", " ", "nodes"}], ",", 
         " ", 
         RowBox[{"then", " ", "external", " ", "black", " ", "nodes"}]}], 
        ")"}]}]}], ",", " ", 
     RowBox[{"cuts", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"7", ",", "2"}]], "\[Rule]", 
           RowBox[{"-", 
            SubscriptBox["X", 
             RowBox[{"7", ",", "2"}]]}]}], ",", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "9"}]], "\[Rule]", 
           RowBox[{"-", 
            SubscriptBox["X", 
             RowBox[{"2", ",", "9"}]]}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["X", 
           RowBox[{"4", ",", "10"}]], "\[Rule]", 
          RowBox[{"-", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "10"}]]}]}], "}"}]}], "}"}]}], ",", " ", 
     RowBox[{"boundaries", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"9", ",", "10", ",", "11"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"7", ",", "8"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"19", ",", "6"}], "}"}]}], "}"}]}], ",", " ", 
     RowBox[{"boundarycuts", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}], "\[Rule]", 
         RowBox[{"cuts", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"2", ",", "3"}], "}"}], "\[Rule]", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"cuts", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"cuts", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "3"}], "}"}], "\[Rule]", 
         RowBox[{"cuts", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"kastToGrass", "[", 
     RowBox[{
     "a_", ",", "b_", ",", "c_", ",", "d_", ",", "pmref_", ",", "order_", ",",
       "boundaries_", ",", "boundarycuts_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "sources", ",", "sinks", ",", "therule", ",", "inverserule", ",", 
        "repl", ",", "newnumberrule", ",", "newsource", ",", "looprep", ",", 
        "invlooprep", ",", "loopflip", ",", "looplist", ",", "dummy", ",", 
        "i", ",", "l", ",", "loop", ",", "j", ",", "count", ",", "k", ",", 
        "terms", ",", "postnikovpathloop", ",", "numtoorder", ",", 
        "postgekhtmatrixloop", ",", "bguys", ",", "tempmat", ",", "pmloops", 
        ",", "kmat", ",", "btra", ",", "xtonum", ",", "xorder", ",", 
        "ordering", ",", "subs", ",", "compare", ",", "guys", ",", "compa", 
        ",", "change"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"pathmatrix", "[", 
         RowBox[{
         "a", ",", "b", ",", "c", ",", "d", ",", "pmref", ",", "order"}], 
         "]"}], "\[IndentingNewLine]", 
        RowBox[{
        "Print", "[", "\"\<This is the path matrix 'pathmat':\>\"", "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"pathmat", "//", "MatrixForm"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"sources", "=", 
        RowBox[{"findSources", "[", 
         RowBox[{
         "a", ",", "b", ",", "c", ",", "d", ",", "order", ",", "pmref"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"sinks", "=", 
        RowBox[{"findSinks", "[", 
         RowBox[{
         "a", ",", "b", ",", "c", ",", "d", ",", "order", ",", "pmref"}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Now", " ", "make", " ", "it", " ", "nicer", " ", "and", " ", "plug", 
         " ", "in", " ", 
         RowBox[{"Postnikov", "'"}], "s", " ", "signs"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"First", " ", "make", " ", "the", " ", "replacement", " ", 
         RowBox[{"lists", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"therule", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Rule", ",", 
          RowBox[{"{", 
           RowBox[{"plist", ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              SubscriptBox["pp", "i"], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Length", "[", "plist", "]"}]}], "}"}]}], "]"}]}], 
           "}"}]}], "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "To", " ", "recognize", " ", "stuff", " ", "as", " ", "perfect", " ", 
         "matchings"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"inverserule", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Rule", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              SubscriptBox["pp", "i"], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Length", "[", "plist", "]"}]}], "}"}]}], "]"}], ",", 
            RowBox[{"plist", "/", "pmref"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"repl", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Rule", ",", 
          RowBox[{"{", 
           RowBox[{"Xlist", ",", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"1", ",", 
              RowBox[{"Length", "[", "Xlist", "]"}]}], "]"}]}], "}"}]}], 
         "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "This", " ", "is", " ", "needed", " ", "to", " ", "get", " ", "the", 
         " ", "signs", " ", "right"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"This", " ", "is", " ", "for", " ", 
         RowBox[{"Postnikov", "'"}], "s", " ", "signs"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"newnumberrule", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Rule", ",", 
          RowBox[{"{", 
           RowBox[{"order", ",", 
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "order", "]"}], "]"}]}], "}"}]}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"newsource", "=", 
        RowBox[{"sources", "/.", "newnumberrule"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Make", " ", "the", " ", "rule", " ", "for", " ", "the", " ", 
         "replacement", " ", "of", " ", "loops", " ", "with", " ", 
         "variables", " ", 
         SubscriptBox["loop", "i"]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"looprep", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"invlooprep", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"loopflip", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"looplist", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Times", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"MonomialList", "[", 
                RowBox[{"Expand", "[", 
                 RowBox[{"loops", " ", "pmref"}], "]"}], "]"}], "/", 
               "pmref"}], ")"}], "/.", "repl"}], ",", 
            RowBox[{
             RowBox[{"MonomialList", "[", 
              RowBox[{"Expand", "[", 
               RowBox[{"loops", " ", "pmref"}], "]"}], "]"}], "/", 
             "pmref"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dummy", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", "looplist", "]"}], "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"looplist", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "1"}], ",", "True", 
            ",", "True", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              SubscriptBox["l", "dummy"], "=", 
              RowBox[{"looplist", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"looprep", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"looprep", ",", 
                RowBox[{"{", 
                 RowBox[{
                  SubscriptBox["l", "dummy"], "\[Rule]", 
                  SubscriptBox["loop", "dummy"]}], "}"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"invlooprep", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"invlooprep", ",", 
                RowBox[{"{", 
                 RowBox[{
                  SubscriptBox["loop", "dummy"], "\[Rule]", 
                  SubscriptBox["l", "dummy"]}], "}"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"loopflip", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"loopflip", ",", 
                RowBox[{"{", 
                 RowBox[{
                  SubscriptBox["loop", "dummy"], "\[Rule]", 
                  RowBox[{"-", 
                   SubscriptBox["loop", "dummy"]}]}], "}"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"dummy", "=", 
              RowBox[{"dummy", "+", "1"}]}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"postnikovpath", "=", "pathmat"}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "this", " ", "will", " ", "be", " ", "the", " ", "path", " ", 
         "matrix", " ", "with", " ", 
         RowBox[{"postnikov", "'"}], "s", " ", "signs", " ", "incorporated"}],
         "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", "sources", "]"}], "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", 
         RowBox[{"(*", 
          RowBox[{"Rows", " ", "of", " ", "the", " ", "sign", " ", "matrix"}],
           "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "<", 
             RowBox[{
              RowBox[{"Length", "[", "order", "]"}], "+", "1"}]}], ",", 
            RowBox[{"j", "++"}], ",", 
            RowBox[{"(*", 
             RowBox[{
             "Columns", " ", "of", " ", "the", " ", "sign", " ", "matrix"}], 
             "*)"}], "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"This", " ", "is", " ", "to", " ", "get", " ", 
              RowBox[{"Postnikov", "'"}], "s", " ", "signs"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"count", "=", "0"}], ";", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"k", "=", "1"}], ",", 
               RowBox[{"k", "<", 
                RowBox[{
                 RowBox[{"Length", "[", "sources", "]"}], "+", "1"}]}], ",", 
               RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"newsource", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "j"}], "]"}], "<", 
                    RowBox[{"newsource", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "&&", 
                   RowBox[{
                    RowBox[{"newsource", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "<", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"newsource", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "j"}], "]"}]}]}], 
                  ",", 
                  RowBox[{
                   RowBox[{"count", "=", 
                    RowBox[{"count", "+", "1"}]}], ";"}]}], "]"}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{
               "This", " ", "is", " ", "to", " ", "make", " ", "it", " ", 
                "look", " ", "nice"}], ",", " ", 
               RowBox[{
               "and", " ", "plug", " ", "in", " ", "the", " ", "overall", " ", 
                RowBox[{"signs", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"pathmat", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j"}], "]"}], "]"}], "\[Equal]", "1"}], "||", 
                RowBox[{
                 RowBox[{"pathmat", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j"}], "]"}], "]"}], "\[Equal]", "0"}]}],
                ",", "True", ",", "True", ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Denominator", "[", 
                    RowBox[{"pathmat", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], "\[Equal]", 
                   "1"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{"we", " ", "have", " ", "multiple", " ", "terms"}],
                    "*)"}], "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"terms", "=", 
                    RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
                   RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"k", "=", "1"}], ",", 
                    RowBox[{"k", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"pathmat", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], "+", 
                    "1"}]}], ",", 
                    RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"MonomialList", "[", 
                    RowBox[{"Denominator", "[", 
                    RowBox[{
                    RowBox[{"pathmat", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "]"}], "]"}], "]"}], ">", 
                    "1"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"If", " ", "we", " ", "have", " ", "loops"}], 
                    "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"terms", "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{"terms", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Expand", "[", 
                    RowBox[{"Simplify", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"pathmat", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "loops"}], "]"}], "]"}], 
                    "/", "loops"}], "}"}]}], "]"}]}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"terms", "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{"terms", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"pathmat", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "}"}]}], "]"}]}], ";"}]}], 
                    RowBox[{"(*", 
                    RowBox[{"If", " ", "we", " ", 
                    RowBox[{"don", "'"}], "t", " ", "have", " ", "loops"}], 
                    "*)"}], "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"postnikovpath", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Total", "[", "terms", "]"}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], "count"]}]}], ";"}], 
                  "\[IndentingNewLine]", ",", "True", ",", 
                  RowBox[{"(*", 
                   RowBox[{
                   "we", " ", "have", " ", "only", " ", "one", " ", "term"}], 
                   "*)"}], "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"MonomialList", "[", 
                    RowBox[{"Denominator", "[", 
                    RowBox[{"pathmat", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], "]"}], 
                    "]"}], ">", "1"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "If", " ", "the", " ", "term", " ", "has", " ", "loops"}],
                     "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"postnikovpath", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], "count"], 
                    RowBox[{
                    RowBox[{"Expand", "[", 
                    RowBox[{"Simplify", "[", 
                    RowBox[{
                    RowBox[{"pathmat", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "loops"}], "]"}], 
                    "]"}], "/", "loops"}]}]}], ";"}], "\[IndentingNewLine]", 
                    ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"postnikovpath", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], "count"], 
                    RowBox[{"pathmat", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";"}]}], "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Done", " ", "looking", " ", "nice"}], ",", " ", 
             RowBox[{"and", " ", "overall", " ", 
              RowBox[{"signs", "!"}]}]}], "*)"}], "\[IndentingNewLine]", 
           "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"postnikovpathloop", "=", "postnikovpath"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Now", " ", "replace", " ", "loops", " ", "in", " ", 
         "postnikovpathloop", " ", "with", " ", 
         SubscriptBox["loop", "i"], " ", "variables"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"change", "=", "1"}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "Keeps", " ", "track", " ", "of", " ", "whether", " ", 
         "postnikovpathloop", " ", "changed", " ", "when", " ", "we", " ", 
         "gave", " ", "it", " ", "loopreplacements"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"compa", "=", "postnikovpathloop"}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "This", " ", "is", " ", "what", " ", "we", " ", "compare", " ", 
         "with"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{"change", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"postnikovpathloop", "=", 
           RowBox[{"postnikovpathloop", "/.", "looprep"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"compa", "\[Equal]", "postnikovpathloop"}], ",", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{
              "if", " ", "putting", " ", "in", " ", "loop", " ", 
               "replacement", " ", "changed", " ", "nothing"}], ",", " ", 
              RowBox[{
               RowBox[{"we", "'"}], "ve", " ", "replaced", " ", "all", " ", 
               "the", " ", "loops", " ", "that", " ", "can", " ", "be", " ", 
               "replaced"}]}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"change", "=", "0"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"compa", "=", "postnikovpathloop"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"postnikovpathloop", "=", 
        RowBox[{"postnikovpathloop", "/.", "loopflip"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"postnikovpath", "=", 
        RowBox[{"postnikovpathloop", "/.", "invlooprep"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", 
        "\"\<Path matrix with Postnikov's overall signs, and signs for loops \
'postnikovpath':\>\"", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"postnikovpath", "//", "MatrixForm"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"postnikovpathloop", "//", "MatrixForm"}], "]"}], ";"}], 
        "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Now", " ", "plug", "  ", "in", " ", 
         RowBox[{"Gekhtman", "'"}], "s", " ", "signs"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"numtoorder", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Rule", ",", 
          RowBox[{"{", 
           RowBox[{"order", ",", 
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "order", "]"}], "]"}]}], "}"}]}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"postgekhtmatrixloop", "=", "postnikovpathloop"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", "sources", "]"}], "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", 
         RowBox[{"(*", 
          RowBox[{"Rows", " ", "of", " ", "the", " ", "matrix"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "<", 
             RowBox[{
              RowBox[{"Length", "[", "order", "]"}], "+", "1"}]}], ",", 
            RowBox[{"j", "++"}], ",", 
            RowBox[{"(*", 
             RowBox[{"Columns", " ", "of", " ", "the", " ", "matrix"}], 
             "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"postnikovpathloop", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j"}], "]"}], "]"}], "\[Equal]", "1"}], "||", 
                RowBox[{
                 RowBox[{"postnikovpathloop", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j"}], "]"}], "]"}], "\[Equal]", "0"}]}],
                ",", "True", ",", "True", ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"bguys", "=", 
                 RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                 "Now", " ", "find", " ", "out", " ", "which", " ", 
                  "boundaries", " ", "this", " ", "entries", " ", "goes", " ", 
                  RowBox[{"between", "."}]}], "*)"}], "\[IndentingNewLine]", 
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"k", "=", "1"}], ",", 
                  RowBox[{"k", "<", 
                   RowBox[{
                    RowBox[{"Length", "[", "boundaries", "]"}], "+", "1"}]}], 
                  ",", 
                  RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"boundaries", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], ",", 
                    RowBox[{"sources", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "||", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"boundaries", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], ",", 
                    RowBox[{"order", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"bguys", "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{"bguys", ",", 
                    RowBox[{"{", "k", "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"bguys", "=", 
                 RowBox[{"Sort", "[", "bguys", "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"i", "\[Equal]", "1"}], "&&", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"j", "\[Equal]", "5"}], "||", 
                    RowBox[{"j", "\[Equal]", "4"}]}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{"\"\<bguys=\>\"", ",", "bguys"}], "]"}], ";"}]}], 
                   "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "[", "bguys", "]"}], "\[Equal]", "2"}], 
                  ",", 
                  RowBox[{"(*", 
                   RowBox[{
                   "Only", " ", "do", " ", "it", " ", "if", " ", "we", " ", 
                    "re", " ", "going", " ", "between", " ", "different", " ",
                     "boundaries"}], "*)"}], "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"postgekhtmatrixloop", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"postnikovpathloop", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "/.", 
                    RowBox[{"(", 
                    RowBox[{"bguys", "/.", "boundarycuts"}], ")"}]}]}], 
                   ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"postgekhtmatrix", "=", 
        RowBox[{"postgekhtmatrixloop", "/.", "invlooprep"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", 
        "\"\<This is the matrix with also include Gekhtmans's signs \
'postgekhtmatrix':\>\"", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"postgekhtmatrix", "//", "MatrixForm"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Now", " ", "write", " ", "it", " ", "up", " ", "nicely", " ", "in", 
         " ", "terms", " ", "of", " ", 
         RowBox[{"pms", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"tempmat", "=", 
        RowBox[{"Expand", "[", 
         RowBox[{"Simplify", "[", "postgekhtmatrix", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pmpostgekhtmatrix", "=", "postgekhtmatrix"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pmloops", "=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Total", "[", 
             RowBox[{"looplist", " ", "pmref"}], "]"}], "/.", "therule"}], 
           ")"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["pp", 
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{"plist", ",", "pmref"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}]], "\[Rule]", "1"}], 
           "}"}]}], ")"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", "sources", "]"}], "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", 
         RowBox[{"(*", 
          RowBox[{"Rows", " ", "of", " ", "the", " ", "sign", " ", "matrix"}],
           "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "<", 
             RowBox[{
              RowBox[{"Length", "[", "order", "]"}], "+", "1"}]}], ",", 
            RowBox[{"j", "++"}], ",", 
            RowBox[{"(*", 
             RowBox[{
             "Columns", " ", "of", " ", "the", " ", "sign", " ", "matrix"}], 
             "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"tempmat", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j"}], "]"}], "]"}], "\[Equal]", "1"}], "||", 
                RowBox[{
                 RowBox[{"tempmat", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j"}], "]"}], "]"}], "\[Equal]", "0"}]}],
                ",", "True", ",", "True", ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Denominator", "[", 
                    RowBox[{"tempmat", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], "\[Equal]", 
                   "1"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{"we", " ", "have", " ", "multiple", " ", "terms"}],
                    "*)"}], "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"terms", "=", 
                    RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
                   RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"k", "=", "1"}], ",", 
                    RowBox[{"k", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"tempmat", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], "+", 
                    "1"}]}], ",", 
                    RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"MonomialList", "[", 
                    RowBox[{"Denominator", "[", 
                    RowBox[{
                    RowBox[{"tempmat", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "]"}], "]"}], "]"}], ">", 
                    "1"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"If", " ", "we", " ", "have", " ", "loops"}], 
                    "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"terms", "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{"terms", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Expand", "[", 
                    RowBox[{"Simplify", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"tempmat", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "k", "]"}], "]"}], 
                    RowBox[{"Total", "[", "looplist", "]"}]}], "]"}], "]"}], 
                    "pmref"}], ")"}], "/.", "therule"}], ")"}], "/", 
                    "pmloops"}], "}"}]}], "]"}]}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"terms", "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{"terms", ",", 
                    RowBox[{"{", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"tempmat", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "pmref"}], ")"}], "/.", 
                    "therule"}], ")"}], "}"}]}], "]"}]}], ";"}]}], 
                    RowBox[{"(*", 
                    RowBox[{"If", " ", "we", " ", 
                    RowBox[{"don", "'"}], "t", " ", "have", " ", "loops"}], 
                    "*)"}], "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"pmpostgekhtmatrix", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{"Total", "[", "terms", "]"}]}], ";"}], 
                  "\[IndentingNewLine]", ",", "True", ",", 
                  RowBox[{"(*", 
                   RowBox[{
                   "we", " ", "have", " ", "only", " ", "one", " ", "term"}], 
                   "*)"}], "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"MonomialList", "[", 
                    RowBox[{"Denominator", "[", 
                    RowBox[{"tempmat", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], "]"}], 
                    "]"}], ">", "1"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "If", " ", "the", " ", "term", " ", "has", " ", "loops"}],
                     "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"pmpostgekhtmatrix", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Expand", "[", 
                    RowBox[{"Simplify", "[", 
                    RowBox[{
                    RowBox[{"tempmat", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], 
                    RowBox[{"Total", "[", "looplist", "]"}]}], "]"}], "]"}], 
                    " ", "pmref"}], ")"}], "/.", "therule"}], ")"}], "/", 
                    "pmloops"}]}], ";"}], "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"pmpostgekhtmatrix", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"tempmat", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], " ", "pmref"}], 
                    ")"}], "/.", "therule"}], ")"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";"}]}], "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Done", " ", "looking", " ", "nice"}], ",", " ", 
             RowBox[{"and", " ", "overall", " ", 
              RowBox[{"signs", "!"}]}]}], "*)"}], "\[IndentingNewLine]", 
           "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", 
        "\"\<The Grassmannian matrix in terms of perfect matchings is \
'pmpostgekhtmatrix':\>\"", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"pmpostgekhtmatrix", "//", "MatrixForm"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Now", " ", "calculate", " ", "the", " ", 
         RowBox[{"Pluckers", "!"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"plucker", "=", 
        RowBox[{"Expand", "[", 
         RowBox[{"Simplify", "[", 
          RowBox[{
           RowBox[{"Minors", "[", 
            RowBox[{"postgekhtmatrix", ",", 
             RowBox[{"Length", "[", "sources", "]"}]}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", "\"\<These are the Pluckers 'plucker':\>\"", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"plucker", "//", "MatrixForm"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Now", " ", "make", " ", "the", " ", "Pluckers", " ", "look", " ", 
         "nice"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"niceplucker", "=", "plucker"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", "plucker", "]"}], "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", 
         RowBox[{"(*", 
          RowBox[{"Rows", " ", "of", " ", "the", " ", "sign", " ", "matrix"}],
           "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"plucker", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "1"}], ",", "True", 
            ",", "True", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Denominator", "[", 
                 RowBox[{"plucker", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}], "\[Equal]", "1"}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{"we", " ", "have", " ", "multiple", " ", "terms"}], 
                "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"terms", "=", 
                 RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"k", "=", "1"}], ",", 
                  RowBox[{"k", "<", 
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"plucker", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "+", "1"}]}], ",", 
                  RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"MonomialList", "[", 
                    RowBox[{"Denominator", "[", 
                    RowBox[{
                    RowBox[{"plucker", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "]"}], "]"}], "]"}], ">", 
                    "1"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"If", " ", "we", " ", "have", " ", "loops"}], 
                    "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"terms", "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{"terms", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Expand", "[", 
                    RowBox[{"Simplify", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"plucker", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "k", "]"}], "]"}], 
                    RowBox[{"Total", "[", "looplist", "]"}]}], "]"}], "]"}], 
                    "pmref"}], ")"}], "/.", "therule"}], ")"}], "/", 
                    "pmloops"}], "}"}]}], "]"}]}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"terms", "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{"terms", ",", 
                    RowBox[{"{", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"plucker", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "pmref"}], ")"}], "/.", 
                    "therule"}], ")"}], "}"}]}], "]"}]}], ";"}]}], 
                    RowBox[{"(*", 
                    RowBox[{"If", " ", "we", " ", 
                    RowBox[{"don", "'"}], "t", " ", "have", " ", "loops"}], 
                    "*)"}], "\[IndentingNewLine]", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"niceplucker", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "=", 
                 RowBox[{"Total", "[", "terms", "]"}]}], ";"}], 
               "\[IndentingNewLine]", ",", "True", ",", 
               RowBox[{"(*", 
                RowBox[{
                "we", " ", "have", " ", "only", " ", "one", " ", "term"}], 
                "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "[", 
                    RowBox[{"MonomialList", "[", 
                    RowBox[{"Denominator", "[", 
                    RowBox[{"plucker", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "]"}], ">", 
                   "1"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{
                   "If", " ", "the", " ", "term", " ", "has", " ", "loops"}], 
                   "*)"}], "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"niceplucker", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Expand", "[", 
                    RowBox[{"Simplify", "[", 
                    RowBox[{
                    RowBox[{"plucker", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], 
                    RowBox[{"Total", "[", "looplist", "]"}]}], "]"}], "]"}], 
                    " ", "pmref"}], ")"}], "/.", "therule"}], ")"}], "/", 
                    "pmloops"}]}], ";"}], "\[IndentingNewLine]", ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"niceplucker", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "=", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"plucker", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], " ", "pmref"}], ")"}], "/.",
                     "therule"}], ")"}]}], ";"}]}], "\[IndentingNewLine]", 
                 "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Done", " ", "looking", " ", "nice"}], ",", " ", 
          RowBox[{"and", " ", "overall", " ", 
           RowBox[{"signs", "!"}]}]}], "*)"}], "\[IndentingNewLine]", "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", 
        "\"\<Pluckers written in terms of perfect matchings \
'niceplucker':\>\"", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"niceplucker", "//", "MatrixForm"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"realplucker", "=", 
        RowBox[{
         RowBox[{"Expand", "[", 
          RowBox[{"Simplify", "[", 
           RowBox[{"plucker", " ", 
            RowBox[{"Total", "[", "looplist", "]"}], "pmref"}], "]"}], "]"}], 
         "/.", "therule"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", 
        "\"\<Real map between Pluckers and perfect matchings 'realplucker':\>\
\"", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"realplucker", "//", "MatrixForm"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "Now", " ", "check", " ", "that", " ", "the", " ", "Pluckers", " ", 
          "are", " ", "correct"}], ",", " ", 
         RowBox[{
          RowBox[{"i", ".", "e", ".", " ", "that"}], " ", "they", " ", "all", 
          " ", "have", " ", "the", " ", "correct", " ", "source", " ", 
          RowBox[{"set", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"kmat", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{"a", ",", "c"}], "]"}], ",", 
          RowBox[{"Join", "[", 
           RowBox[{"b", ",", "d"}], "]"}], ",", "2"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"btra", "=", 
        RowBox[{"Transpose", "[", "b", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"xtonum", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", "c", "]"}], "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"xtonum", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"xtonum", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"i", "+", 
                 RowBox[{"Length", "[", "a", "]"}]}], ")"}], "\[Rule]", 
               RowBox[{
                RowBox[{"DeleteCases", "[", 
                 RowBox[{
                  RowBox[{"c", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", "0"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "<", 
          RowBox[{
           RowBox[{"Length", "[", "btra", "]"}], "+", "1"}]}], ",", 
         RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"xtonum", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"xtonum", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"j", "+", 
                 RowBox[{"Length", "[", "a", "]"}], "+", 
                 RowBox[{"Length", "[", "c", "]"}], "+", 
                 RowBox[{
                  RowBox[{"Dimensions", "[", "a", "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "\[Rule]", 
               RowBox[{
                RowBox[{"DeleteCases", "[", 
                 RowBox[{
                  RowBox[{"btra", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], ",", "0"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"xorder", "=", 
        RowBox[{"order", "/.", "xtonum"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ordering", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Rule", ",", 
          RowBox[{"{", 
           RowBox[{"xorder", ",", 
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "order", "]"}], "]"}]}], "}"}]}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Done", " ", "with", " ", "the", " ", "first", " ", 
          RowBox[{"part", "!"}], " ", "Now", " ", "check", " ", "source", " ",
           "sets"}], "..."}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"subs", "=", 
        RowBox[{"Subsets", "[", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "order", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"Length", "[", "sources", "]"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"compare", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", "realplucker", "]"}], "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"guys", "=", 
           RowBox[{"MapThread", "[", 
            RowBox[{"Times", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"MonomialList", "[", 
                 RowBox[{"realplucker", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}], "/.", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{
                   SubscriptBox["pp", "x"], "\[Rule]", "1"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"x", ",", 
                    RowBox[{"Length", "[", "plist", "]"}]}], "}"}]}], "]"}]}],
                ",", 
               RowBox[{"MonomialList", "[", 
                RowBox[{"realplucker", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "<", 
             RowBox[{
              RowBox[{"Length", "[", "guys", "]"}], "+", "1"}]}], ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"compare", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"compare", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"guys", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "\[Rule]", 
                  RowBox[{"subs", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "]"}]}], 
             ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"compare", "=", 
        RowBox[{"Sort", "[", "compare", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"compare", "\[Equal]", 
          RowBox[{"pmsourcesOrderingByHand", "[", 
           RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "ordering"}], 
           "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "Print", "[", 
           "\"\<Checked that the source set for these perfect matchings is \
indeed the Plucker coordiate in question, OK!\>\"", "]"}], ";"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{
          RowBox[{
          "Print", "[", 
           "\"\<It seems like the source set of some of these perfect \
matchings is NOT the correct Plucker coordinate...CHECK IT!\>\"", "]"}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
      "Gives", " ", "the", " ", "master", " ", "and", " ", "moduli", " ", 
       "spaces", " ", "in", " ", "terms", " ", "of", " ", "loop", " ", 
       RowBox[{"variables", ".", " ", "You"}], " ", "need", " ", "to", " ", 
       "give", " ", "it", " ", "the", " ", "high"}], "-", 
      RowBox[{"genus", " ", "information", " ", "\"\<genusedges\>\""}]}], ",",
      " ", 
     RowBox[{
      RowBox[{
       RowBox[{"e", ".", "g", ".", " ", "zeds"}], "=", 
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"9", ",", "6"}]], 
           SubscriptBox["X", 
            RowBox[{"5", ",", "8"}]]}], 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"8", ",", "9"}]], 
           SubscriptBox["Y", 
            RowBox[{"6", ",", "5"}]], " "}]], ",", 
         FractionBox[
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"6", ",", "8"}]], 
           SubscriptBox["X", 
            RowBox[{"5", ",", "8"}]], 
           SubscriptBox["X", 
            RowBox[{"5", ",", "14"}]]}], 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"8", ",", "9"}]], 
           SubscriptBox["Y", 
            RowBox[{"6", ",", "5"}]], " ", 
           SubscriptBox["X", 
            RowBox[{"14", ",", "6"}]]}]], ",", 
         FractionBox[
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"14", ",", "14"}]], 
           SubscriptBox["X", 
            RowBox[{"8", ",", "14"}]]}], 
          RowBox[{" ", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"14", ",", "6"}]], 
            SubscriptBox["X", 
             RowBox[{"15", ",", "8"}]]}]}]], ",", 
         FractionBox[
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"16", ",", "14"}]], 
           SubscriptBox["X", 
            RowBox[{"1", ",", "14"}]], 
           SubscriptBox["X", 
            RowBox[{"10", ",", "9"}]]}], 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"15", ",", "16"}]], 
           SubscriptBox["X", 
            RowBox[{"14", ",", "2"}]], " ", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "1"}]]}]]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"genusedges", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             SubscriptBox["X", 
              RowBox[{"9", ",", "6"}]], ",", "\"\<b\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             SubscriptBox["X", 
              RowBox[{"9", ",", "5"}]], ",", "\"\<w\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             SubscriptBox["X", 
              RowBox[{"6", ",", "5"}]], ",", "\"\<b\>\""}], "}"}]}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             SubscriptBox["X", 
              RowBox[{"7", ",", "6"}]], ",", "\"\<b\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             SubscriptBox["X", 
              RowBox[{"8", ",", "7"}]], ",", "\"\<b\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             SubscriptBox["X", 
              RowBox[{"6", ",", "8"}]], ",", "\"\<b\>\""}], "}"}]}], "}"}]}], 
        "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
      "where", " ", "the", " ", "list", " ", "contains", " ", "the", " ", 
       "edges", " ", "going", " ", "through", " ", "each", " ", "of", " ", 
       "the", " ", "nontrivial", " ", "directions", " ", "in", " ", "the", 
       " ", 
       RowBox[{"graph", ".", " ", "The"}], " ", "letter", " ", "after", " ", 
       "each", " ", "edge", " ", "refers", " ", "to", " ", "the", " ", 
       "color", " ", "of", " ", "the", " ", "node", " ", "next", " ", "to", 
       " ", "the", " ", "border", " ", "of", " ", "the", " ", "unit", " ", 
       RowBox[{"cell", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"newLoopVarModuli", "[", 
      RowBox[{
      "a_", ",", "b_", ",", "c_", ",", "d_", ",", "zeds_", ",", "genusedges_",
        ",", "refpm_", ",", "gauging_"}], "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "xbindices", ",", "boundaryindices", ",", "tempbs", ",", 
         "boundarygroups", ",", "edgevectors", ",", "bgs", ",", "inedges", 
         ",", "outedges", ",", "tovecin", ",", "tovecout", ",", "boundinout", 
         ",", "splitintonumdenom", ",", "numerators", ",", "denominators", 
         ",", "extzsinout", ",", "genusflowvecs", ",", "zis", ",", "inout", 
         ",", "intzsinout", ",", "IF", ",", "NF", ",", "NZ", ",", "fa", ",", 
         "li", ",", "fb", ",", "aia", ",", "fail", ",", "allexpressions", ",",
          "pmnumber", ",", "extZdirection", ",", "intZdirection", ",", 
         "intZcontrib", ",", "extZcontrib", ",", "zeroguessexpr", ",", 
         "zeroguess", ",", "nextface", ",", "dafacevars", ",", "time", ",", 
         "deletelist", ",", "tulplists", ",", "bo", ",", "boundinds", ",", 
         "alsodelete", ",", "numb"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"kasteleyn", "[", 
         RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "First", " ", "find", " ", "the", " ", "contributions", " ", "of", 
          " ", "the", " ", 
          RowBox[{
           SubscriptBox["z", "i"], "'"}], "s", " ", "that", " ", "stretch", 
          " ", "between", " ", "different", " ", 
          RowBox[{"boundaries", ".", " ", "For"}], " ", "this", " ", 
          RowBox[{"we", "'"}], "ll", " ", "now", " ", "find", " ", "whether", 
          " ", "each", " ", "edge", " ", "goes", " ", "in", " ", "or", " ", 
          "out", " ", "of", " ", "each", " ", "respective", " ", "boundary"}],
          "*)"}], "\[IndentingNewLine]", 
        RowBox[{
        "Print", "[", 
         "\"\<We're now going to look for which edges belong to which \
boundaries.\>\"", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"xbindices", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"sub1", "[", "#", "]"}], ",", 
              RowBox[{"sub2", "[", "#", "]"}]}], "}"}], "&"}], ",", "xb"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"boundaryindices", "=", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Sort", "[", 
              RowBox[{"Cases", "[", 
               RowBox[{"xbindices", ",", 
                RowBox[{"zz_", "/;", 
                 RowBox[{
                  RowBox[{"Intersection", "[", 
                   RowBox[{"zz", ",", "#"}], "]"}], "\[NotEqual]", 
                  RowBox[{"{", "}"}]}]}]}], "]"}], "]"}], "&"}], ",", 
            "xbindices"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{"True", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"tempbs", "=", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"DeleteDuplicates", "[", 
                 RowBox[{"Join", "@@", 
                  RowBox[{"Cases", "[", 
                   RowBox[{"boundaryindices", ",", 
                    RowBox[{"zz_", "/;", 
                    RowBox[{
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"Union", "@@", "zz"}], ",", 
                    RowBox[{"Union", "@@", "#"}]}], "]"}], "\[NotEqual]", 
                    RowBox[{"{", "}"}]}]}]}], "]"}]}], "]"}], "&"}], ",", 
               "boundaryindices"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"tempbs", "\[NotEqual]", "boundaryindices"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"boundaryindices", "=", "tempbs"}], ";"}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{
              RowBox[{"Break", "[", "]"}], ";"}]}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"boundaryindices", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Union", "[", 
             RowBox[{"Flatten", "[", "#", "]"}], "]"}], "&"}], ",", 
           "boundaryindices"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"boundarygroups", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{"xb", ",", 
              RowBox[{"zz_", "/;", 
               RowBox[{
                RowBox[{"Intersection", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"sub1", "[", "zz", "]"}], ",", 
                    RowBox[{"sub2", "[", "zz", "]"}]}], "}"}], ",", "#"}], 
                 "]"}], "\[NotEqual]", 
                RowBox[{"{", "}"}]}]}]}], "]"}], "&"}], ",", 
           "boundaryindices"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Done, the boundaries are \>\"", ",", "boundarygroups"}],
          "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"edgevectors", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"bgs", "=", "1"}], ",", 
          RowBox[{"bgs", "<", 
           RowBox[{
            RowBox[{"Length", "[", "boundarygroups", "]"}], "+", "1"}]}], ",", 
          RowBox[{"bgs", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"inedges", "=", 
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"boundarygroups", "[", 
               RowBox[{"[", "bgs", "]"}], "]"}], ",", 
              RowBox[{"zz_", "/;", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"MemberQ", "[", 
                   RowBox[{
                    RowBox[{"Variables", "[", "b", "]"}], ",", "zz"}], "]"}], 
                  "&&", 
                  RowBox[{"FreeQ", "[", 
                   RowBox[{
                    RowBox[{"Variables", "[", 
                    RowBox[{"plist", "[", 
                    RowBox[{"[", "refpm", "]"}], "]"}], "]"}], ",", "zz"}], 
                   "]"}]}], ")"}], "||", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"MemberQ", "[", 
                   RowBox[{
                    RowBox[{"Variables", "[", "c", "]"}], ",", "zz"}], "]"}], 
                  "&&", 
                  RowBox[{"MemberQ", "[", 
                   RowBox[{
                    RowBox[{"Variables", "[", 
                    RowBox[{"plist", "[", 
                    RowBox[{"[", "refpm", "]"}], "]"}], "]"}], ",", "zz"}], 
                   "]"}]}], ")"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"outedges", "=", 
            RowBox[{"Complement", "[", 
             RowBox[{
              RowBox[{"boundarygroups", "[", 
               RowBox[{"[", "bgs", "]"}], "]"}], ",", "inedges"}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"tovecin", "=", 
            RowBox[{"-", 
             RowBox[{"UnitVector", "[", 
              RowBox[{
               RowBox[{"Length", "[", "boundarygroups", "]"}], ",", "bgs"}], 
              "]"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"tovecout", "=", 
            RowBox[{"UnitVector", "[", 
             RowBox[{
              RowBox[{"Length", "[", "boundarygroups", "]"}], ",", "bgs"}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"edgevectors", "=", 
            RowBox[{"Join", "[", 
             RowBox[{"edgevectors", ",", 
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "\[Rule]", "tovecin"}], "&"}], ",", 
                  "inedges"}], "]"}], ",", 
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "\[Rule]", "tovecout"}], "&"}], ",", 
                  "outedges"}], "]"}]}], "]"}]}], "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Now", " ", "we", " ", "know", " ", "which", " ", "edges", " ", 
          "flow", " ", "in", " ", "or", " ", "out", " ", "of", " ", "each", 
          " ", "boundary", " ", "ACCORDING", " ", "TO", " ", "THE", " ", 
          "PERFECT", " ", 
          RowBox[{"ORIENTATION", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Now", " ", "need", " ", "to", " ", "find", " ", "out", " ", "if", 
           " ", "the", " ", 
           RowBox[{
            SubscriptBox["z", "i"], "'"}], "s", " ", "flow", " ", "in", " ", 
           "or", " ", "out", " ", "each", " ", "boundary"}], ",", " ", 
          RowBox[{"ACCORDING", " ", "TO", " ", "HOW", " ", 
           RowBox[{"THEY", "'"}], "VE", " ", "BEEN", " ", 
           RowBox[{"DEFINED", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"boundinout", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"MapThread", "[", 
           RowBox[{"Rule", ",", 
            RowBox[{"{", 
             RowBox[{"boundarygroups", ",", 
              RowBox[{"MapThread", "[", 
               RowBox[{"ReplaceAll", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"Variables", "[", "c", "]"}], ",", "#"}], "]"}], 
                    "&"}], ",", "boundarygroups", ",", 
                    RowBox[{"{", "2", "}"}]}], "]"}], ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"True", "\[Rule]", "#"}], ",", 
                    RowBox[{"False", "\[Rule]", 
                    RowBox[{"-", "#"}]}]}], "}"}], "&"}], ",", 
                    RowBox[{"IdentityMatrix", "[", 
                    RowBox[{"Length", "[", "boundarygroups", "]"}], "]"}]}], 
                   "]"}]}], "}"}]}], "]"}]}], "}"}], ",", "2"}], "]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"splitintonumdenom", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Intersection", "[", 
             RowBox[{"xb", ",", "#"}], "]"}], "&"}], ",", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Variables", "[", 
                 RowBox[{"Numerator", "[", "#", "]"}], "]"}], ",", 
                RowBox[{"Variables", "[", 
                 RowBox[{"Denominator", "[", "#", "]"}], "]"}]}], "}"}], 
              "&"}], ",", 
             RowBox[{"zeds", "[", 
              RowBox[{"[", 
               RowBox[{"Range", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", "genusedges", "]"}], "+", "1"}], ",", 
                 RowBox[{"Length", "[", "zeds", "]"}]}], "]"}], "]"}], 
              "]"}]}], "]"}], ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"numerators", "=", 
         RowBox[{
          RowBox[{"Transpose", "[", "splitintonumdenom", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"denominators", "=", 
         RowBox[{
          RowBox[{"Transpose", "[", "splitintonumdenom", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"extzsinout", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Plus", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Map", "[", 
              RowBox[{"Total", ",", 
               RowBox[{"(", 
                RowBox[{"numerators", "/.", "boundinout"}], ")"}]}], "]"}], 
             ",", 
             RowBox[{"Map", "[", 
              RowBox[{"Total", ",", 
               RowBox[{"-", 
                RowBox[{"(", 
                 RowBox[{"denominators", "/.", "boundinout"}], ")"}]}]}], 
              "]"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Done", "!"}], " ", "Now", " ", "we", " ", "know", " ", 
          "which", " ", "way", " ", "each", " ", "external", " ", 
          SubscriptBox["z", "i"], " ", "is", " ", 
          RowBox[{"going", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Now", " ", "find", " ", "the", " ", "contributions", " ", "of", 
           " ", "the", " ", 
           RowBox[{
            SubscriptBox["z", "i"], "'"}], "s", " ", "that", " ", "go", " ", 
           "around", " ", "nontrivial", " ", 
           RowBox[{"loops", ".", " ", "For"}], " ", "this", " ", 
           RowBox[{"we", "'"}], "ll", " ", "now", " ", "find", " ", "whether",
            " ", "each", " ", "edge", " ", "goes", " ", "in", " ", "or", " ", 
           "out", " ", "of", " ", "the", " ", "graph"}], ",", " ", 
          RowBox[{
          "as", " ", "seen", " ", "from", " ", "a", " ", "given", " ", 
           "border", " ", "of", " ", "the", " ", "unit", " ", 
           RowBox[{"cell", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "These", " ", "are", " ", "the", " ", "edges", " ", "whose", " ", 
          "perfect", " ", "orientation", " ", "flows", " ", "into", " ", 
          "the", " ", "graph"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"inedges", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"DeleteCases", "[", 
               RowBox[{
                RowBox[{"Cases", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{"{", 
                   RowBox[{"___", ",", "\"\<b\>\""}], "}"}]}], "]"}], ",", 
                RowBox[{"zz_", "/;", 
                 RowBox[{"MemberQ", "[", 
                  RowBox[{
                   RowBox[{"Variables", "[", 
                    RowBox[{"plist", "[", 
                    RowBox[{"[", "refpm", "]"}], "]"}], "]"}], ",", 
                   RowBox[{"zz", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "]"}], "&"}],
              ",", "genusedges"}], "]"}], ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"outedges", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Complement", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", "genusedges", 
               ",", 
               RowBox[{"{", "2", "}"}]}], "]"}], ",", "inedges"}], "}"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"genusflowvecs", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"zis", "=", "1"}], ",", 
          RowBox[{"zis", "<", 
           RowBox[{
            RowBox[{"Length", "[", "genusedges", "]"}], "+", "1"}]}], ",", 
          RowBox[{"zis", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"genusflowvecs", "=", 
            RowBox[{"Join", "[", 
             RowBox[{"genusflowvecs", ",", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "\[Rule]", 
                  RowBox[{"UnitVector", "[", 
                   RowBox[{
                    RowBox[{"Length", "[", "genusedges", "]"}], ",", "zis"}], 
                   "]"}]}], "&"}], ",", 
                RowBox[{"inedges", "[", 
                 RowBox[{"[", "zis", "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "\[Rule]", 
                  RowBox[{"-", 
                   RowBox[{"UnitVector", "[", 
                    RowBox[{
                    RowBox[{"Length", "[", "genusedges", "]"}], ",", "zis"}], 
                    "]"}]}]}], "&"}], ",", 
                RowBox[{"outedges", "[", 
                 RowBox[{"[", "zis", "]"}], "]"}]}], "]"}]}], "]"}]}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Now", " ", "we", " ", "know", " ", "which", " ", "edges", " ", 
          "flow", " ", "in", " ", "or", " ", "out", " ", "of", " ", "the", 
          " ", "graph", " ", "ACCORDING", " ", "TO", " ", "THE", " ", 
          "PERFECT", " ", 
          RowBox[{"ORIENTATION", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Now", " ", "need", " ", "to", " ", "find", " ", "out", " ", "if", 
           " ", "the", " ", 
           RowBox[{
            SubscriptBox["z", "i"], "'"}], "s", " ", "flow", " ", "in", " ", 
           "or", " ", "out", " ", "of", " ", "the", " ", "graph"}], ",", " ", 
          RowBox[{"ACCORDING", " ", "TO", " ", "HOW", " ", 
           RowBox[{"THEY", "'"}], "VE", " ", "BEEN", " ", 
           RowBox[{"DEFINED", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"splitintonumdenom", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Intersection", "[", 
             RowBox[{
              RowBox[{"DeleteCases", "[", 
               RowBox[{
                RowBox[{"Flatten", "[", "genusedges", "]"}], ",", 
                RowBox[{"\"\<b\>\"", "|", "\"\<w\>\""}]}], "]"}], ",", "#"}], 
             "]"}], "&"}], ",", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Variables", "[", 
                 RowBox[{"Numerator", "[", "#", "]"}], "]"}], ",", 
                RowBox[{"Variables", "[", 
                 RowBox[{"Denominator", "[", "#", "]"}], "]"}]}], "}"}], 
              "&"}], ",", 
             RowBox[{"zeds", "[", 
              RowBox[{"[", 
               RowBox[{"Range", "[", 
                RowBox[{"Length", "[", "genusedges", "]"}], "]"}], "]"}], 
              "]"}]}], "]"}], ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"numerators", "=", 
         RowBox[{
          RowBox[{"Transpose", "[", "splitintonumdenom", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"denominators", "=", 
         RowBox[{
          RowBox[{"Transpose", "[", "splitintonumdenom", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"inout", "=", 
         RowBox[{"Join", "@@", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"genusedges", "[", 
               RowBox[{"[", "#", "]"}], "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"zz_", ",", "\"\<b\>\""}], "}"}], "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{"zz", "\[Rule]", 
                   RowBox[{"UnitVector", "[", 
                    RowBox[{
                    RowBox[{"Length", "[", "genusedges", "]"}], ",", "#"}], 
                    "]"}]}], ")"}]}], ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"zzz_", ",", "\"\<w\>\""}], "}"}], "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{"zzz", "\[Rule]", 
                   RowBox[{"-", 
                    RowBox[{"UnitVector", "[", 
                    RowBox[{
                    RowBox[{"Length", "[", "genusedges", "]"}], ",", "#"}], 
                    "]"}]}]}], ")"}]}]}], "}"}]}], "&"}], ",", 
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "genusedges", "]"}], "]"}]}], "]"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"intzsinout", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Plus", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Map", "[", 
              RowBox[{"Total", ",", 
               RowBox[{"(", 
                RowBox[{"numerators", "/.", "inout"}], ")"}]}], "]"}], ",", 
             RowBox[{"Map", "[", 
              RowBox[{"Total", ",", 
               RowBox[{"-", 
                RowBox[{"(", 
                 RowBox[{"denominators", "/.", "inout"}], ")"}]}]}], "]"}]}], 
            "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Done", "!"}], " ", "Now", " ", "we", " ", "know", " ", 
          "which", " ", "way", " ", "each", " ", 
          SubscriptBox["z", "i"], " ", "is", " ", 
          RowBox[{"going", ".", " ", "This"}], " ", "even", " ", "allows", 
          " ", "for", " ", "the", " ", "possibility", " ", "of", " ", "a", 
          " ", 
          SubscriptBox["z", "i"], " ", "looping", " ", "around", " ", "both", 
          " ", "nontrivial", " ", 
          RowBox[{"directions", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Here", " ", "is", " ", "old", " ", "code", " ", "that", " ", 
           "creates", " ", "the", " ", "faces", " ", 
           SubscriptBox["w", "i"], "and", " ", 
           SubscriptBox["z", "j"], " ", "paths"}], ",", " ", 
          RowBox[{"but", " ", "now", " ", "we", " ", "also", " ", "form", " ", 
           RowBox[{
            SubscriptBox["w", "NF"], "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"IF", "=", 
         RowBox[{"internalFaces", "[", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"NF", "=", 
         RowBox[{
          RowBox[{"externalFaces", "[", 
           RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "+", "IF"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"First", " ", "make", " ", "the", " ", 
          SubscriptBox["w", "i"], " ", "variables"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"NZ", "=", 
         RowBox[{"Length", "[", "zeds", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"fa", "=", "1"}], ",", 
          RowBox[{"fa", "<", 
           RowBox[{"NF", "+", "1"}]}], ",", 
          RowBox[{"fa", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            SubscriptBox["w", "fa"], "=", "1"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"li", "=", "1"}], ",", 
          RowBox[{"li", "<", 
           RowBox[{
            RowBox[{"Length", "[", "Xlist", "]"}], "+", "1"}]}], ",", 
          RowBox[{"li", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"fa", "=", "1"}], ",", 
             RowBox[{"fa", "<", 
              RowBox[{"NF", "+", "1"}]}], ",", 
             RowBox[{"fa", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"fb", "=", "1"}], ",", 
                RowBox[{"fb", "<", 
                 RowBox[{"NF", "+", "1"}]}], ",", 
                RowBox[{"fb", "++"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}], "\[Equal]", 
                    SubscriptBox["X", 
                    RowBox[{"fa", ",", "fb"}]]}], "||", 
                    RowBox[{
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}], "\[Equal]", 
                    SubscriptBox["Y", 
                    RowBox[{"fa", ",", "fb"}]]}], "||", 
                    RowBox[{
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}], "\[Equal]", 
                    SubscriptBox["Z", 
                    RowBox[{"fa", ",", "fb"}]]}], "||", 
                    RowBox[{
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}], "\[Equal]", 
                    SubscriptBox["W", 
                    RowBox[{"fa", ",", "fb"}]]}], "||", 
                    RowBox[{
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}], "\[Equal]", 
                    SubscriptBox["V", 
                    RowBox[{"fa", ",", "fb"}]]}], "||", 
                    RowBox[{
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}], "\[Equal]", 
                    SubscriptBox["UU", 
                    RowBox[{"fa", ",", "fb"}]]}], "||", 
                    RowBox[{
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}], "\[Equal]", 
                    SubscriptBox["XX", 
                    RowBox[{"fa", ",", "fb"}]]}], "||", 
                    RowBox[{
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}], "\[Equal]", 
                    SubscriptBox["YY", 
                    RowBox[{"fa", ",", "fb"}]]}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["w", "fa"], "=", 
                    RowBox[{
                    SubscriptBox["w", "fa"], "/", 
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["w", "fb"], "=", 
                    RowBox[{
                    SubscriptBox["w", "fb"], 
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}]}]}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Now", " ", "label", " ", "the", " ", 
          RowBox[{"z", "'"}], "s"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"aia", "=", "1"}], ",", 
          RowBox[{"aia", "<", 
           RowBox[{
            RowBox[{"Length", "[", "zeds", "]"}], "+", "1"}]}], ",", 
          RowBox[{"aia", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            SubscriptBox["z", "aia"], "=", 
            RowBox[{"zeds", "[", 
             RowBox[{"[", "aia", "]"}], "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", 
                    "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "This", " ", "finds", " ", "the", " ", "contribution", " ", "from", 
          " ", "all", " ", 
          RowBox[{"z", "'"}], "s", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
            "both", " ", "those", " ", "between", " ", "boundaries", " ", 
             "and", " ", "those", " ", "around", " ", "nontrivial", " ", 
             "loops"}], ")"}], "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"fail", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"allexpressions", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"pmnumber", "=", "1"}], ",", 
          RowBox[{"pmnumber", "<", 
           RowBox[{
            RowBox[{"Length", "[", "plist", "]"}], "+", "1"}]}], ",", 
          RowBox[{"pmnumber", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"\"\<pmnumber = \>\"", ",", "pmnumber"}], "]"}], ";"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"extZdirection", "=", 
            RowBox[{"Total", "[", 
             RowBox[{
              RowBox[{"Intersection", "[", 
               RowBox[{"xb", ",", 
                RowBox[{"Variables", "[", 
                 RowBox[{
                  RowBox[{"plist", "[", 
                   RowBox[{"[", "pmnumber", "]"}], "]"}], "/", 
                  RowBox[{"plist", "[", 
                   RowBox[{"[", "refpm", "]"}], "]"}]}], "]"}]}], "]"}], "/.",
               "edgevectors"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"intZdirection", "=", 
            RowBox[{"Total", "[", 
             RowBox[{
              RowBox[{"Intersection", "[", 
               RowBox[{
                RowBox[{"DeleteCases", "[", 
                 RowBox[{
                  RowBox[{"Flatten", "[", "genusedges", "]"}], ",", 
                  RowBox[{"\"\<b\>\"", "|", "\"\<w\>\""}]}], "]"}], ",", 
                RowBox[{"Variables", "[", 
                 RowBox[{
                  RowBox[{"plist", "[", 
                   RowBox[{"[", "pmnumber", "]"}], "]"}], "/", 
                  RowBox[{"plist", "[", 
                   RowBox[{"[", "refpm", "]"}], "]"}]}], "]"}]}], "]"}], "/.",
               "genusflowvecs"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"intZcontrib", "=", 
            RowBox[{"Times", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Solve", "[", 
                 RowBox[{
                  RowBox[{"Total", "[", 
                   RowBox[{"MapThread", "[", 
                    RowBox[{"Times", ",", 
                    RowBox[{"{", 
                    RowBox[{"intzsinout", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    SubscriptBox["zz", "iii"], ",", 
                    RowBox[{"{", 
                    RowBox[{"iii", ",", 
                    RowBox[{"Length", "[", "genusedges", "]"}]}], "}"}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}], "\[Equal]", 
                  "intZdirection"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "/.", 
               RowBox[{"Rule", "\[Rule]", "Power"}]}], ")"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"extZcontrib", "=", 
            RowBox[{"Times", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Solve", "[", 
                 RowBox[{
                  RowBox[{"Total", "[", 
                   RowBox[{"MapThread", "[", 
                    RowBox[{"Times", ",", 
                    RowBox[{"{", 
                    RowBox[{"extzsinout", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    SubscriptBox["zz", "iii"], ",", 
                    RowBox[{"{", 
                    RowBox[{"iii", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "genusedges", "]"}], "+", "1"}], 
                    ",", 
                    RowBox[{"Length", "[", "zeds", "]"}]}], "}"}]}], "]"}]}], 
                    "}"}]}], "]"}], "]"}], "\[Equal]", "extZdirection"}], 
                 "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "/.", 
               RowBox[{"Rule", "\[Rule]", "Power"}]}], ")"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"zeroguessexpr", "=", 
            RowBox[{"intZcontrib", " ", "extZcontrib"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"zeroguess", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"plist", "[", 
                RowBox[{"[", "pmnumber", "]"}], "]"}], "/", 
               RowBox[{"plist", "[", 
                RowBox[{"[", "refpm", "]"}], "]"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{"zeroguessexpr", "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"zz", "\[Rule]", "z"}], ",", 
                 RowBox[{"ww", "\[Rule]", "w"}]}], "}"}]}], ")"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"Found", " ", "the", " ", "correct", " ", 
             RowBox[{"expression", ".", " ", "What"}], " ", "remains", " ", 
             "in", " ", "\"\<zeroguess\>\"", " ", "is", " ", "guaranteed", 
             " ", "to", " ", "be", " ", "equal", " ", "to", " ", "some", " ", 
             "product", " ", "of", " ", 
             RowBox[{"faces", "."}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"Now", " ", 
             RowBox[{"we", "'"}], "ll", " ", "find", " ", "the", " ", 
             "expression", " ", "for", " ", "the", " ", "faces"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"TimeConstrained", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"While", "[", 
               RowBox[{
                RowBox[{"zeroguess", "=!=", "1"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"nextface", "=", 
                  RowBox[{"sub2", "[", 
                   RowBox[{
                    RowBox[{"Variables", "[", 
                    RowBox[{"Numerator", "[", "zeroguess", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"zeroguess", "=", 
                  RowBox[{"zeroguess", "/", 
                   SubscriptBox["w", "nextface"]}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"zeroguessexpr", "=", 
                  RowBox[{"zeroguessexpr", " ", 
                   SubscriptBox["ww", "nextface"]}]}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"zeroguessexpr", "=", 
               RowBox[{"zeroguessexpr", "/.", 
                RowBox[{
                 SubscriptBox["ww", "NF"], "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{"1", "/", 
                   RowBox[{"Times", "@@", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    SubscriptBox["ww", "iii"], ",", 
                    RowBox[{"{", 
                    RowBox[{"iii", ",", 
                    RowBox[{"NF", "-", "1"}]}], "}"}]}], "]"}]}]}], 
                  ")"}]}]}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"allexpressions", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"allexpressions", ",", "zeroguessexpr"}], "]"}]}], 
              ";"}], "\[IndentingNewLine]", ",", "20", ",", 
             RowBox[{
              RowBox[{"fail", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"fail", ",", "pmnumber"}], "]"}]}], ";", 
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<Number \>\"", ",", "pmnumber", ",", "\"\< failed!\>\""}], 
               "]"}], ";"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Done", "!"}], " ", 
          RowBox[{"We", "'"}], "ve", " ", "found", " ", "all", " ", 
          RowBox[{"expressions", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Now", " ", 
          RowBox[{"we", "'"}], "ll", " ", "make", " ", "Gmaster"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"dafacevars", "=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"MapThread", "[", 
            RowBox[{"Subscript", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"ConstantArray", "[", 
                RowBox[{"zz", ",", 
                 RowBox[{"Length", "[", "zeds", "]"}]}], "]"}], ",", 
               RowBox[{"Range", "[", 
                RowBox[{"Length", "[", "zeds", "]"}], "]"}]}], "}"}]}], "]"}],
            ",", 
           RowBox[{"MapThread", "[", 
            RowBox[{"Subscript", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"ConstantArray", "[", 
                RowBox[{"ww", ",", 
                 RowBox[{"NF", "-", "1"}]}], "]"}], ",", 
               RowBox[{"Range", "[", 
                RowBox[{"NF", "-", "1"}], "]"}]}], "}"}]}], "]"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Gmaster", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"allexpressions", "/.", 
              RowBox[{"Times", "\[Rule]", "Plus"}]}], ")"}], "/.", 
            RowBox[{"Power", "\[Rule]", "Times"}]}], ")"}], "/.", 
          RowBox[{"MapThread", "[", 
           RowBox[{"Rule", ",", 
            RowBox[{"{", 
             RowBox[{"dafacevars", ",", 
              RowBox[{"IdentityMatrix", "[", 
               RowBox[{"Length", "[", "dafacevars", "]"}], "]"}]}], "}"}]}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"Position", "[", 
             RowBox[{
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "===", "1"}], "&"}], ",", "allexpressions"}], 
               "]"}], ",", "True"}], "]"}], "]"}], "===", 
           RowBox[{"{", "refpm", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Gmaster", "[", 
             RowBox[{"[", "refpm", "]"}], "]"}], "=", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"0", ",", 
              RowBox[{"Length", "[", "dafacevars", "]"}]}], "]"}]}], ";"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{
           RowBox[{
           "Print", "[", 
            "\"\<There is some problem! It seems like multiple expressions \
are identically equal to 1!!!!\>\"", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Gmaster", "=", 
         RowBox[{"Transpose", "[", "Gmaster", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "This", " ", "is", " ", "old", " ", "code", " ", "that", " ", 
          "makes", " ", "the", " ", "moduli", " ", "space", " ", 
          RowBox[{"etc", ".", " ", "and"}], " ", "all", " ", "the", " ", 
          "printouts"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
        "Print", "[", "\"\<---------------------------------------------\>\"",
          "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Failed \>\"", ",", 
          RowBox[{"Length", "[", "fail", "]"}], ",", "\"\< times: \>\"", ",", 
          "fail"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Computation time: \>\"", ",", 
          RowBox[{
           RowBox[{"TimeUsed", "[", "]"}], "-", "time"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"time", "=", 
         RowBox[{"TimeUsed", "[", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Gmaster = \>\"", ",", 
          RowBox[{"Gmaster", "//", "MatrixForm"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mastermult", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Dimensions", "[", 
             RowBox[{
              RowBox[{"Gather", "[", 
               RowBox[{"Transpose", "[", "Gmaster", "]"}], "]"}], "[", 
              RowBox[{"[", "y", "]"}], "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"y", ",", 
             RowBox[{
              RowBox[{"Dimensions", "[", 
               RowBox[{"Gather", "[", 
                RowBox[{"Transpose", "[", "Gmaster", "]"}], "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"mastermult", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ">", "1"}], ",", 
          RowBox[{
           RowBox[{
           "Print", "[", 
            "\"\<ERROR!!! THERE ARE SEVERAL PERFECT MATCHINGS WITH THE SAME \
EXPRESSION!\>\"", "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{
        "Print", "[", 
         "\"\<The order of the coordinates for Gmaster is: \
\!\(\*SubscriptBox[\(z\), \(i\)]\)'s, then faces (starting from face 1 to \
face NF-1).\>\"", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"gauging", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Gmoduli", "=", 
           RowBox[{"Delete", "[", 
            RowBox[{"Gmaster", ",", 
             RowBox[{"Transpose", "[", 
              RowBox[{"{", 
               RowBox[{"Table", "[", 
                RowBox[{"i", ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", 
                   RowBox[{"NZ", "+", "1"}], ",", 
                   RowBox[{"NZ", "+", "IF"}]}], "}"}]}], "]"}], "}"}], 
              "]"}]}], "]"}]}], "\[IndentingNewLine]", ",", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"gauging", "\[Equal]", "2"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"deletelist", "=", 
               RowBox[{"Range", "[", 
                RowBox[{"Length", "[", "genusedges", "]"}], "]"}]}], ";", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{
                 RowBox[{
                 "Here", " ", "we", " ", "also", " ", "dauge", " ", "the", 
                  " ", "internal", " ", "zig"}], "-", "zags"}], ",", " ", 
                RowBox[{
                "as", " ", "well", " ", "as", " ", "delete", " ", "all", " ", 
                 "internal", " ", "faces"}]}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"Gmoduli", "=", "Gmaster"}], ";", "\[IndentingNewLine]", 
              RowBox[{"tulplists", "=", 
               RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"bo", "=", "1"}], ",", 
                RowBox[{"bo", "<", 
                 RowBox[{
                  RowBox[{"Length", "[", "boundarygroups", "]"}], "+", 
                  "1"}]}], ",", 
                RowBox[{"bo", "++"}], ",", 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{
                  "Each", " ", "time", " ", "we", " ", "have", " ", 
                   "external", " ", "guys", " ", "going", " ", "around", " ", 
                   "a", " ", "boundary", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    "hence", " ", "are", " ", "completely", " ", "internal"}],
                     ")"}]}], ",", " ", 
                  RowBox[{
                  "we", " ", "have", " ", "to", " ", "subtract", " ", "the", 
                   " ", "value", " ", "of", " ", "one", " ", "row", " ", 
                   "from", " ", "all", " ", "the", " ", "others"}], ",", " ", 
                  RowBox[{
                  "and", " ", "then", " ", "gauge", " ", "this", " ", 
                   "row"}]}], "*)"}], "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"boundinds", "=", 
                  RowBox[{"Union", "@@", 
                   RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"sub1", "[", "#", "]"}], ",", 
                    RowBox[{"sub2", "[", "#", "]"}]}], "}"}], "&"}], ",", 
                    RowBox[{"boundarygroups", "[", 
                    RowBox[{"[", "bo", "]"}], "]"}]}], "]"}]}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"MemberQ", "[", 
                    RowBox[{"boundinds", ",", "NF"}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"boundinds", "=", 
                    RowBox[{"Complement", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", "NF", "]"}], ",", "boundinds"}], 
                    "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"tulplists", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"tulplists", ",", "boundinds"}], "]"}]}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"alsodelete", "=", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "+", 
                   RowBox[{"Length", "[", "zeds", "]"}]}], "&"}], ",", 
                 RowBox[{
                  RowBox[{"Cases", "[", 
                   RowBox[{
                    RowBox[{"Tuples", "[", "tulplists", "]"}], ",", 
                    RowBox[{"zz_", "/;", 
                    RowBox[{
                    RowBox[{"Union", "[", "zz", "]"}], "\[Equal]", 
                    RowBox[{"Sort", "[", "zz", "]"}]}]}]}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"bo", "=", "1"}], ",", 
                RowBox[{"bo", "<", 
                 RowBox[{
                  RowBox[{"Length", "[", "tulplists", "]"}], "+", "1"}]}], 
                ",", 
                RowBox[{"bo", "++"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"For", "[", 
                  RowBox[{
                   RowBox[{"numb", "=", "1"}], ",", 
                   RowBox[{"numb", "<", 
                    RowBox[{"Length", "[", 
                    RowBox[{"tulplists", "[", 
                    RowBox[{"[", "bo", "]"}], "]"}], "]"}]}], ",", 
                   RowBox[{"numb", "++"}], ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Gmoduli", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Length", "[", "zeds", "]"}], "+", 
                    RowBox[{"tulplists", "[", 
                    RowBox[{"[", 
                    RowBox[{"bo", ",", "numb"}], "]"}], "]"}]}], "]"}], "]"}],
                     "=", 
                    RowBox[{
                    RowBox[{"Gmoduli", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Length", "[", "zeds", "]"}], "+", 
                    RowBox[{"tulplists", "[", 
                    RowBox[{"[", 
                    RowBox[{"bo", ",", "numb"}], "]"}], "]"}]}], "]"}], "]"}],
                     "-", 
                    RowBox[{"Gmoduli", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Length", "[", "zeds", "]"}], "+", 
                    RowBox[{"alsodelete", "[", 
                    RowBox[{"[", "bo", "]"}], "]"}]}], "]"}], "]"}]}]}], 
                    ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"deletelist", "=", 
               RowBox[{"Sort", "[", 
                RowBox[{"Join", "[", 
                 RowBox[{"deletelist", ",", "alsodelete"}], "]"}], "]"}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"Gmoduli", "=", 
               RowBox[{"Delete", "[", 
                RowBox[{"Gmoduli", ",", 
                 RowBox[{"Transpose", "[", 
                  RowBox[{"{", "deletelist", "}"}], "]"}]}], "]"}]}], ";"}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{
              RowBox[{
              "Print", "[", 
               "\"\<Invalid value for 'gauging'. Need to specify either \
'gauging'=1 or 'gauging'=2.\>\"", "]"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Now", " ", "group", " ", "the", " ", "multiplicities", " ", "of", 
          " ", "G", " ", 
          RowBox[{"together", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Gshort", "=", 
         RowBox[{"Transpose", "[", 
          RowBox[{"DeleteDuplicates", "[", 
           RowBox[{"Transpose", "[", "Gmoduli", "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Multmatrix", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Dimensions", "[", 
             RowBox[{
              RowBox[{"Gather", "[", 
               RowBox[{"Transpose", "[", "Gmoduli", "]"}], "]"}], "[", 
              RowBox[{"[", "y", "]"}], "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"y", ",", 
             RowBox[{
              RowBox[{"Dimensions", "[", 
               RowBox[{"Gather", "[", 
                RowBox[{"Transpose", "[", "Gmoduli", "]"}], "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Gshort = \>\"", ",", 
          RowBox[{"Gshort", "//", "MatrixForm"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Multipl = \>\"", ",", 
          RowBox[{"Multmatrix", "//", "MatrixForm"}]}], "]"}], ";"}]}], " ", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Gives", " ", "the", " ", "toric", " ", "diagram", " ", "of", " ", "the", 
     " ", "moduli", " ", "space", " ", "using", " ", "the", " ", 
     SubscriptBox["w", "i"], " ", 
     RowBox[{"variables", ".", " ", "You"}], " ", "need", " ", "to", " ", 
     "specify", " ", "whether", " ", "you", " ", "want", " ", "gauging", " ", 
     "1", " ", "or", " ", "gauging", " ", "2."}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"loopVariableModuli", "[", 
     RowBox[{
     "a_", ",", "b_", ",", "c_", ",", "d_", ",", "zeds_", ",", "patience_", 
      ",", "gauging_", ",", "referencenum_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "IF", ",", "NF", ",", "fa", ",", "li", ",", "fb", ",", "NZ", ",", 
        "NZI", ",", "temp", ",", "kk", ",", "check", ",", "jj", ",", "jk", 
        ",", "wext", ",", "allint", ",", "zext", ",", "ref", ",", "allext", 
        ",", "extsubs", ",", "intsubs", ",", "newint", ",", "numm", ",", 
        "tryshift", ",", "wpower", ",", "wpow", ",", 
        RowBox[{"(*", 
         RowBox[{"wshift", ","}], "*)"}], "ki", ",", "wtrya", ",", "el", ",", 
        "masterspace", ",", "fail", ",", "guess", ",", "k", ",", "darn", ",", 
        "retry", ",", "consider", ",", "expression", ",", "zexpression", ",", 
        "considervar", ",", "j", ",", "count", ",", "done", ",", "wextcont", 
        ",", "ranw", ",", "ranz", ",", "i", ",", "ii", ",", "save", ",", "jz",
         ",", "zextcont", ",", "save2", ",", "ij", ",", "ji", ",", 
        "senttointernal", ",", "sentexpression", ",", "zsentexpression", ",", 
        "zintcont", ",", "jsh", ",", "wshiftcont", ",", "save3", ",", 
        "wintcont", ",", "powers", ",", "tem", ",", "score", ",", "bore", ",",
         "cha", ",", "pow", ",", "inw", ",", "ad", ",", "powarray", ",", "om",
         ",", "show", ",", "wfa", ",", "mastercoords", ",", "ei", ",", "ai", 
        ",", "nice", ",", "compare", ",", "mastermult", ",", "bonudaries", 
        ",", "deletelist", ",", "bo", ",", "numb", ",", "intz", ",", "aia", 
        ",", "boundaries"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"kasteleyn", "[", 
        RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"IF", "=", 
        RowBox[{"internalFaces", "[", 
         RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"NF", "=", 
        RowBox[{
         RowBox[{"externalFaces", "[", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "+", "IF"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"First", " ", "make", " ", "the", " ", 
         SubscriptBox["w", "i"], " ", "variables"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"NZ", "=", 
        RowBox[{"Length", "[", "zeds", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"fa", "=", "1"}], ",", 
         RowBox[{"fa", "<", "NF"}], ",", 
         RowBox[{"fa", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           SubscriptBox["w", "fa"], "=", "1"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"li", "=", "1"}], ",", 
         RowBox[{"li", "<", 
          RowBox[{
           RowBox[{"Length", "[", "Xlist", "]"}], "+", "1"}]}], ",", 
         RowBox[{"li", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"fa", "=", "1"}], ",", 
            RowBox[{"fa", "<", 
             RowBox[{"NF", "+", "1"}]}], ",", 
            RowBox[{"fa", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"fb", "=", "1"}], ",", 
               RowBox[{"fb", "<", 
                RowBox[{"NF", "+", "1"}]}], ",", 
               RowBox[{"fb", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}], "\[Equal]", 
                    SubscriptBox["X", 
                    RowBox[{"fa", ",", "fb"}]]}], "||", 
                   RowBox[{
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}], "\[Equal]", 
                    SubscriptBox["Y", 
                    RowBox[{"fa", ",", "fb"}]]}], "||", 
                   RowBox[{
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}], "\[Equal]", 
                    SubscriptBox["Z", 
                    RowBox[{"fa", ",", "fb"}]]}], "||", 
                   RowBox[{
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}], "\[Equal]", 
                    SubscriptBox["W", 
                    RowBox[{"fa", ",", "fb"}]]}], "||", 
                   RowBox[{
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}], "\[Equal]", 
                    SubscriptBox["V", 
                    RowBox[{"fa", ",", "fb"}]]}], "||", 
                   RowBox[{
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}], "\[Equal]", 
                    SubscriptBox["UU", 
                    RowBox[{"fa", ",", "fb"}]]}], "||", 
                   RowBox[{
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}], "\[Equal]", 
                    SubscriptBox["XX", 
                    RowBox[{"fa", ",", "fb"}]]}], "||", 
                   RowBox[{
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}], "\[Equal]", 
                    SubscriptBox["YY", 
                    RowBox[{"fa", ",", "fb"}]]}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"fa", "\[NotEqual]", "NF"}], ",", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["w", "fa"], "=", 
                    RowBox[{
                    SubscriptBox["w", "fa"], "/", 
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}]}]}], ";"}]}], "]"}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"fb", "\[NotEqual]", "NF"}], ",", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["w", "fb"], "=", 
                    RowBox[{
                    SubscriptBox["w", "fb"], 
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}]}]}], ";"}]}], "]"}], 
                   ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Now", " ", "label", " ", "the", " ", 
         RowBox[{"z", "'"}], "s"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"aia", "=", "1"}], ",", 
         RowBox[{"aia", "<", 
          RowBox[{
           RowBox[{"Length", "[", "zeds", "]"}], "+", "1"}]}], ",", 
         RowBox[{"aia", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           SubscriptBox["z", "aia"], "=", 
           RowBox[{"zeds", "[", 
            RowBox[{"[", "aia", "]"}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Make", " ", "the", " ", 
          SubscriptBox["wext", "i"], " ", "and", " ", 
          SubscriptBox["zext", "i"]}], ",", " ", 
         RowBox[{
          RowBox[{"i", ".", "e", ".", " ", "removing"}], " ", "all", " ", 
          "internal", " ", 
          RowBox[{"edges", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"NZI", "=", "0"}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "Number", " ", "of", " ", "z", " ", "lines", " ", "that", " ", "only",
          " ", "have", " ", "internal", " ", 
         RowBox[{"edges", ".", " ", "We"}], " ", "will", " ", "now", " ", 
         "count", " ", 
         RowBox[{"them", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"temp", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"First", " ", "do", " ", "the", " ", 
         SubscriptBox["wext", "i"]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"kk", "=", "1"}], ",", 
         RowBox[{"kk", "<", "NF"}], ",", 
         RowBox[{"kk", "++"}], ",", 
         RowBox[{"(*", 
          RowBox[{"kk", " ", "is", " ", "the", " ", "the", " ", "face"}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           SubscriptBox["wext", "kk"], "=", 
           SubscriptBox["w", "kk"]}], ";", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"jj", "=", "1"}], ",", 
            RowBox[{"jj", "<", 
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"Variables", "[", 
                SubscriptBox["w", "kk"], "]"}], "]"}], "+", "1"}]}], ",", 
            RowBox[{"jj", "++"}], ",", 
            RowBox[{"(*", 
             RowBox[{
             "jj", " ", "is", " ", "the", " ", "variable", " ", "of", " ", 
              "the", " ", "the", " ", "face"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"check", "=", "0"}], ";", " ", 
             RowBox[{"(*", 
              RowBox[{
              "Check", " ", "whether", " ", "this", " ", "variable", " ", 
               "is", " ", "an", " ", "external", " ", "one"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"jk", "=", "1"}], ",", 
               RowBox[{"jk", "<", 
                RowBox[{
                 RowBox[{"Length", "[", "xb", "]"}], "+", "1"}]}], ",", 
               RowBox[{"jk", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["w", "kk"], "]"}], "[", 
                    RowBox[{"[", "jj", "]"}], "]"}], "\[Equal]", 
                   RowBox[{"xb", "[", 
                    RowBox[{"[", "jk", "]"}], "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"check", "=", "1"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"check", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"If", " ", 
                  RowBox[{"it", "'"}], "s", " ", "an", " ", "internal", " ", 
                  "one"}], ",", " ", 
                 RowBox[{"find", " ", "out", " ", "if", " ", 
                  RowBox[{"it", "'"}], "s", " ", "in", " ", "the", " ", "top",
                   " ", "or", " ", 
                  RowBox[{"bottom", ".", " ", "Then"}], " ", "remove", " ", 
                  RowBox[{"it", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["w", "kk"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["w", "kk"], "]"}], "[", 
                    RowBox[{"[", "jj", "]"}], "]"}]}], "]"}], "\[Equal]", 
                   "0"}], ",", " ", "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{
                    RowBox[{
                    "If", " ", "the", " ", "variable", " ", "is", " ", "in", 
                    " ", "the", " ", "denomianator", " ", 
                    RowBox[{"(", 
                    RowBox[{"ie", " ", "\[Equal]", "0"}], ")"}]}], ",", " ", 
                    RowBox[{"multiply", " ", "it", " ", 
                    RowBox[{"in", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["wext", "kk"], "=", 
                    RowBox[{
                    SubscriptBox["wext", "kk"], " ", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["w", "kk"], "]"}], "[", 
                    RowBox[{"[", "jj", "]"}], "]"}]}]}], ";"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["wext", "kk"], "=", 
                    RowBox[{
                    SubscriptBox["wext", "kk"], "/", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["w", "kk"], "]"}], "[", 
                    RowBox[{"[", "jj", "]"}], "]"}]}]}], ";"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["wext", "kk"], "=", 
                    RowBox[{
                    SubscriptBox["wext", "kk"], "/", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["w", "kk"], "]"}], "[", 
                    RowBox[{"[", "jj", "]"}], "]"}]}]}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"temp", "=", 
                 RowBox[{"temp", " ", 
                  RowBox[{
                   RowBox[{"Variables", "[", 
                    SubscriptBox["w", "kk"], "]"}], "[", 
                   RowBox[{"[", "jj", "]"}], "]"}]}]}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"allint", "=", 
        RowBox[{"Variables", "[", "temp", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Now", " ", "do", " ", "the", " ", 
         SubscriptBox["zext", "i"]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"intz", "=", 
        RowBox[{"{", "}"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{"Remembers", " ", "which", " ", 
         RowBox[{"z", "'"}], "s", " ", "are", " ", "internal"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"kk", "=", "1"}], ",", 
         RowBox[{"kk", "<", 
          RowBox[{"NZ", "+", "1"}]}], ",", 
         RowBox[{"kk", "++"}], ",", 
         RowBox[{"(*", 
          RowBox[{"kk", " ", "is", " ", "the", " ", "the", " ", 
           SubscriptBox["z", "k"], " ", "path"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           SubscriptBox["zext", "kk"], "=", 
           SubscriptBox["z", "kk"]}], ";", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"jj", "=", "1"}], ",", 
            RowBox[{"jj", "<", 
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"Variables", "[", 
                SubscriptBox["z", "kk"], "]"}], "]"}], "+", "1"}]}], ",", 
            RowBox[{"jj", "++"}], ",", 
            RowBox[{"(*", 
             RowBox[{
             "jj", " ", "is", " ", "the", " ", "variable", " ", "of", " ", 
              "the", " ", "the", " ", "path"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"check", "=", "0"}], ";", " ", 
             RowBox[{"(*", 
              RowBox[{
              "Check", " ", "whether", " ", "this", " ", "variable", " ", 
               "is", " ", "an", " ", "external", " ", "one"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"jk", "=", "1"}], ",", 
               RowBox[{"jk", "<", 
                RowBox[{
                 RowBox[{"Length", "[", "xb", "]"}], "+", "1"}]}], ",", 
               RowBox[{"jk", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["z", "kk"], "]"}], "[", 
                    RowBox[{"[", "jj", "]"}], "]"}], "\[Equal]", 
                   RowBox[{"xb", "[", 
                    RowBox[{"[", "jk", "]"}], "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"check", "=", "1"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"check", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"If", " ", 
                  RowBox[{"it", "'"}], "s", " ", "an", " ", "internal", " ", 
                  "one"}], ",", " ", 
                 RowBox[{"find", " ", "out", " ", "if", " ", 
                  RowBox[{"it", "'"}], "s", " ", "in", " ", "the", " ", "top",
                   " ", "or", " ", 
                  RowBox[{"bottom", ".", " ", "Then"}], " ", "remove", " ", 
                  RowBox[{"it", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["z", "kk"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["z", "kk"], "]"}], "[", 
                    RowBox[{"[", "jj", "]"}], "]"}]}], "]"}], "\[Equal]", 
                   "0"}], ",", " ", "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{
                    RowBox[{
                    "If", " ", "the", " ", "variable", " ", "is", " ", "in", 
                    " ", "the", " ", "denomianator", " ", 
                    RowBox[{"(", 
                    RowBox[{"ie", " ", "\[Equal]", "0"}], ")"}]}], ",", " ", 
                    RowBox[{"multiply", " ", "it", " ", 
                    RowBox[{"in", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["zext", "kk"], "=", 
                    RowBox[{
                    SubscriptBox["zext", "kk"], " ", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["z", "kk"], "]"}], "[", 
                    RowBox[{"[", "jj", "]"}], "]"}]}]}], ";"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["zext", "kk"], "=", 
                    RowBox[{
                    SubscriptBox["zext", "kk"], "/", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["z", "kk"], "]"}], "[", 
                    RowBox[{"[", "jj", "]"}], "]"}]}]}], ";"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["zext", "kk"], "=", 
                    RowBox[{
                    SubscriptBox["zext", "kk"], "/", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["z", "kk"], "]"}], "[", 
                    RowBox[{"[", "jj", "]"}], "]"}]}]}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             SubscriptBox["zext", "kk"], "\[Equal]", "1"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"NZI", "=", 
              RowBox[{"NZI", "+", "1"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"intz", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"intz", ",", "kk"}], "]"}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Now", " ", "we", " ", "have", " ", "the", " ", 
          SubscriptBox["wext", "i"]}], ",", " ", 
         RowBox[{
          SubscriptBox["zext", "i"], " ", "and", " ", "the", " ", "internal", 
          " ", 
          RowBox[{"lines", "!"}]}]}], "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"ref", "=", 
        RowBox[{
         RowBox[{"MonomialList", "[", "perf", "]"}], "[", 
         RowBox[{"[", "referencenum", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Make", " ", "a", " ", "list", " ", "with", " ", "all", " ", 
         "external", " ", "variables"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"allext", "=", "xb"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Create", " ", "\"\<shift operators\>\""}], ",", 
         RowBox[{
          RowBox[{"i", ".", "e", ".", " ", "products"}], " ", "of", " ", 
          "external", " ", 
          RowBox[{"w", "'"}], "s", " ", "that", " ", "end", " ", "up", " ", 
          "being", " ", "internal"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"extsubs", "=", 
        RowBox[{"Subsets", "[", 
         RowBox[{"Range", "[", 
          RowBox[{
           RowBox[{"IF", "+", "1"}], ",", 
           RowBox[{"NF", "-", "1"}]}], "]"}], "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "All", " ", "the", " ", "subsets", " ", "of", " ", "the", " ", 
         "external", " ", "faces"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"intsubs", "=", 
        RowBox[{"Subsets", "[", 
         RowBox[{"Range", "[", 
          RowBox[{"1", ",", "IF"}], "]"}], "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "All", " ", "the", " ", "subsets", " ", "of", " ", "the", " ", 
         "external", " ", "faces"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"newint", "=", "0"}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "The", " ", "label", " ", "of", " ", "the", " ", "new", " ", 
         "internal", " ", "variables"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"boundaries", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"numm", "=", "1"}], ",", 
         RowBox[{"numm", "<", 
          RowBox[{
           RowBox[{
            RowBox[{"Dimensions", "[", "extsubs", "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], ",", 
         RowBox[{"numm", "++"}], ",", 
         RowBox[{"(*", 
          RowBox[{
          "Go", " ", "through", " ", "all", " ", "the", " ", "subsets"}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Multiply", " ", "together", " ", "the", " ", "variables", " ", 
           "belonging", " ", "to", " ", "a", " ", "specific", " ", "subset"}],
           "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tryshift", "=", 
           RowBox[{"Product", "[", 
            RowBox[{
             SubscriptBox["w", 
              RowBox[{"extsubs", "[", 
               RowBox[{"[", 
                RowBox[{"numm", ",", "demax"}], "]"}], "]"}]], ",", 
             RowBox[{"{", 
              RowBox[{"demax", ",", 
               RowBox[{"Length", "[", 
                RowBox[{"extsubs", "[", 
                 RowBox[{"[", "numm", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"wpower", "=", 
           RowBox[{"extsubs", "[", 
            RowBox[{"[", "numm", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"check", "=", "0"}], ";", " ", 
          RowBox[{"(*", 
           RowBox[{
           "Check", " ", "whether", " ", "this", " ", "variable", " ", "is", 
            " ", "an", " ", "external", " ", "one"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"jj", "=", "1"}], ",", 
            RowBox[{"jj", "<", 
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"Variables", "[", "tryshift", "]"}], "]"}], "+", 
              "1"}]}], ",", 
            RowBox[{"jj", "++"}], ",", 
            RowBox[{"(*", 
             RowBox[{
             "go", " ", "through", " ", "the", " ", "tryshift", " ", 
              "variables"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"jk", "=", "1"}], ",", 
               RowBox[{"jk", "<", 
                RowBox[{
                 RowBox[{"Length", "[", "xb", "]"}], "+", "1"}]}], ",", 
               RowBox[{"jk", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Variables", "[", "tryshift", "]"}], "[", 
                    RowBox[{"[", "jj", "]"}], "]"}], "\[Equal]", 
                   RowBox[{"xb", "[", 
                    RowBox[{"[", "jk", "]"}], "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"check", "=", "1"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"check", "\[Equal]", "0"}], ",", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"If", " ", 
               RowBox[{"it", "'"}], "s", " ", "purely", " ", "internal"}], 
              ",", " ", 
              RowBox[{
              "record", " ", "a", " ", "\"\<new internal variable\>\""}], ",",
               " ", 
              RowBox[{"and", " ", "its", " ", 
               RowBox[{"powers", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              SubscriptBox["wshift", "newint"], "=", "tryshift"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              SubscriptBox["wpow", "newint"], "=", "wpower"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"boundaries", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"boundaries", ",", 
                RowBox[{"{", "wpower", "}"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"newint", "=", 
              RowBox[{"newint", "+", "1"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "Now", " ", "have", " ", "to", " ", "check", " ", "whether", 
               " ", "taking", " ", "this", " ", "internal", " ", "path", " ", 
               "made", " ", "up", " ", "of", " ", "external", " ", "faces", 
               " ", "can", " ", "be", " ", "shifted", " ", "without", " ", 
               "making", " ", "it", " ", 
               RowBox[{"longer", ".", " ", "Then"}], " ", "we", " ", "have", 
               " ", "a", " ", "new", " ", 
               RowBox[{"wshift", "."}]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"ki", "=", "2"}], ",", 
               RowBox[{"ki", "<", 
                RowBox[{
                 RowBox[{"Length", "[", "intsubs", "]"}], "+", "1"}]}], ",", 
               RowBox[{"ki", "++"}], ",", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{
                 "The", " ", "first", " ", "subset", " ", "is", " ", "the", 
                  " ", "zero", " ", "subset"}], ",", " ", 
                 RowBox[{"so", " ", "ignore", " ", "it"}]}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"wtrya", "=", "tryshift"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"el", "=", "1"}], ",", 
                  RowBox[{"el", "<", 
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"intsubs", "[", 
                    RowBox[{"[", "ki", "]"}], "]"}], "]"}], "+", "1"}]}], ",", 
                  RowBox[{"el", "++"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"wtrya", "=", 
                    RowBox[{"wtrya", " ", 
                    SubscriptBox["w", 
                    RowBox[{"intsubs", "[", 
                    RowBox[{"[", 
                    RowBox[{"ki", ",", "el"}], "]"}], "]"}]]}]}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                 "Now", " ", "we", " ", "have", " ", "a", " ", "trial", " ", 
                  RowBox[{"wshift", ".", " ", 
                   RowBox[{"Let", "'"}]}], "s", " ", "check", " ", "that", 
                  " ", "it", " ", "does", " ", "indeed", " ", "act", " ", 
                  "as", " ", "a", " ", "shift", " ", 
                  RowBox[{"operator", "."}]}], "*)"}], "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", "wtrya", "]"}], "]"}], 
                   "\[LessEqual]", 
                   RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", "tryshift", "]"}], "]"}]}], ",",
                   "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["wshift", "newint"], "=", "wtrya"}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    SubscriptBox["wpow", "newint"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{"wpower", ",", 
                    RowBox[{"intsubs", "[", 
                    RowBox[{"[", "ki", "]"}], "]"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"newint", "=", 
                    RowBox[{"newint", "+", "1"}]}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";"}]}], 
           RowBox[{"(*", 
            RowBox[{"Close", " ", "for", " ", "ki"}], "*)"}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Close", " ", "if", " ", "check"}], "\[Equal]", "0"}], 
         "*)"}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"masterspace", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{"NZ", "+", "NF", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", "0"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"fail", "=", "0"}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "The", " ", "number", " ", "of", " ", "cases", " ", "that", " ", 
         "fail"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"guess", "=", "0"}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{
        "The", " ", "number", " ", "of", " ", "times", " ", "we", " ", "had", 
         " ", "to", " ", "guess"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"k", "=", "1"}], ",", 
         RowBox[{"k", "<", 
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"MonomialList", "[", "perf", "]"}], "]"}], "+", "1"}]}], 
         ",", 
         RowBox[{"k", "++"}], ",", " ", 
         RowBox[{"(*", 
          RowBox[{
          "Go", " ", "through", " ", "all", " ", "perfect", " ", 
           "matchings"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"darn", "=", "0"}], ";", 
          RowBox[{"(*", 
           RowBox[{
           "Tells", " ", "you", " ", "whether", " ", "you", " ", "were", " ", 
            "successful", " ", "or", " ", "not"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"retry", "=", "0"}], ";", " ", 
          RowBox[{"(*", 
           RowBox[{
           "Keeps", " ", "track", " ", "of", " ", "whether", " ", "this", " ",
             "is", " ", "the", " ", "first", " ", "time", " ", "or", " ", 
            "not", " ", 
            RowBox[{
             RowBox[{"(", "Goto", ")"}], "."}]}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           SubscriptBox["consider", "k"], "=", 
           RowBox[{
            RowBox[{
             RowBox[{"MonomialList", "[", "perf", "]"}], "[", 
             RowBox[{"[", "k", "]"}], "]"}], "/", "ref"}]}], ";", " ", 
          RowBox[{"(*", 
           RowBox[{"The", " ", "term", " ", "under", " ", "consideration"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{
          "Print", "[", 
           "\"\<---------------------------------------------\>\"", "]"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<k = \>\"", ",", "k", ",", "\"\< , considering \>\"", ",", 
            SubscriptBox["consider", "k"]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Label", "[", "beginext", "]"}], ";", " ", 
          RowBox[{"(*", 
           RowBox[{"For", " ", "the", " ", "Goto", " ", "command"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"Label", "[", "beginagain", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           SubscriptBox["expression", "k"], "=", 
           RowBox[{"{", "}"}]}], ";", " ", 
          RowBox[{"(*", 
           RowBox[{
           "Will", " ", "keep", " ", "track", " ", "of", " ", "which", " ", 
            RowBox[{"w", "'"}], "s", " ", "go", " ", "into", " ", "the", " ", 
            "expression"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           SubscriptBox["zexpression", "k"], "=", 
           RowBox[{"{", "}"}]}], ";", " ", 
          RowBox[{"(*", 
           RowBox[{
           "Will", " ", "keep", " ", "track", " ", "of", " ", "which", " ", 
            RowBox[{"z", "'"}], "s", " ", "go", " ", "into", " ", "the", " ", 
            "expression"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           SubscriptBox["consider", "k"], "=", 
           RowBox[{
            RowBox[{
             RowBox[{"MonomialList", "[", "perf", "]"}], "[", 
             RowBox[{"[", "k", "]"}], "]"}], "/", "ref"}]}], ";", " ", 
          RowBox[{"(*", 
           RowBox[{
           "must", " ", "repeat", " ", "this", " ", "becuase", " ", "of", " ",
             "the", " ", "Labels"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           SubscriptBox["considervar", "k"], "=", 
           RowBox[{"Variables", "[", 
            SubscriptBox["consider", "k"], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "Now", " ", "find", " ", "out", " ", "what", " ", "the", " ", 
            "external", " ", "faces", " ", "and", " ", "external", " ", 
            RowBox[{
             SubscriptBox["z", "i"], "'"}], "s", " ", "are"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<Start external!\>\"", "]"}], ";"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"count", "=", "0"}], ";", " ", 
          RowBox[{"(*", 
           RowBox[{
           "Counter", " ", "needed", " ", "in", " ", "the", " ", "while", " ",
             "loop"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"done", "=", "0"}], ";", " ", 
          RowBox[{"(*", 
           RowBox[{
           "Tells", " ", "you", " ", "when", " ", "to", " ", "quit", " ", 
            "the", " ", "while", " ", "loop"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"done", "==", "0"}], " ", "&&", " ", 
             RowBox[{"IF", "\[NotEqual]", "NF"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"j", "=", 
              RowBox[{
               RowBox[{"Mod", "[", 
                RowBox[{"count", ",", 
                 RowBox[{"NF", "-", "IF", "-", "1"}]}], "]"}], "+", "IF", "+",
                "1"}]}], ";", 
             RowBox[{"(*", 
              RowBox[{"j", " ", "is", " ", "the", " ", 
               SubscriptBox["w", "j"], " ", "under", " ", "consideration"}], 
              "*)"}], "\[IndentingNewLine]", 
             RowBox[{
              SubscriptBox["wextcont", "j"], "=", "0"}], ";", " ", 
             RowBox[{"(*", 
              RowBox[{"Keeps", " ", "track", " ", "of", " ", "whether", " ", 
               SubscriptBox["w", "j"], " ", "is", " ", "included", " ", "or", 
               " ", "not"}], "*)"}], "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 SubscriptBox["consider", "k"], "==", "1"}], " ", "||", 
                RowBox[{
                 SubscriptBox["consider", "k"], "\[Equal]", 
                 RowBox[{"-", "1"}]}]}], " ", ",", " ", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"If", " ", "the", " ", "term", " ", "is", " ", "1"}],
                  ",", " ", 
                 RowBox[{"we", " ", "are", " ", "done"}]}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"darn", "=", "0"}], ";", "\[IndentingNewLine]", 
                RowBox[{"Break", "[", "]"}], ";"}]}], " ", 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"retry", "\[GreaterEqual]", 
                RowBox[{"(", 
                 RowBox[{"6", "patience"}], ")"}]}], ",", 
               RowBox[{"(*", 
                RowBox[{"give", " ", "up"}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"darn", "=", "1"}], ";", "\[IndentingNewLine]", 
                RowBox[{"Break", "[", "]"}], ";"}]}], "\[IndentingNewLine]", 
              "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"retry", ">", "0"}], ",", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"If", " ", 
                  RowBox[{"it", "'"}], "s", " ", "not", " ", "the", " ", 
                  "first", " ", "try", " ", "at", " ", "the", " ", "external",
                   " ", "guys"}], ",", " ", 
                 RowBox[{"mix", " ", "things", " ", "up", " ", "a", " ", 
                  RowBox[{"little", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"EvenQ", "[", "retry", "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", "/", 
                    RowBox[{"Product", "[", 
                    RowBox[{
                    SubscriptBox["w", "oio"], ",", 
                    RowBox[{"{", 
                    RowBox[{"oio", ",", 
                    RowBox[{"NF", "-", "1"}]}], "}"}]}], "]"}]}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"Range", "[", 
                    RowBox[{"NF", "-", "1"}], "]"}]}], "]"}]}], ";"}], 
                  "\[IndentingNewLine]", ",", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    RowBox[{"Product", "[", 
                    RowBox[{
                    SubscriptBox["w", "oio"], ",", 
                    RowBox[{"{", 
                    RowBox[{"oio", ",", 
                    RowBox[{"NF", "-", "1"}]}], "}"}]}], "]"}]}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"-", 
                    RowBox[{"Range", "[", 
                    RowBox[{"NF", "-", "1"}], "]"}]}]}], "]"}]}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                 "Pick", " ", "a", " ", "random", " ", "z", " ", "and", " ", 
                  "a", " ", "random", " ", "w", " ", "and", " ", "plug", " ", 
                  "it", " ", 
                  RowBox[{"in", "."}]}], "*)"}], "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"retry", ">", "2"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"ranw", "=", 
                    RowBox[{"RandomInteger", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"IF", "+", "1"}], ",", 
                    RowBox[{"NF", "-", "1"}]}], "}"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["w", "ranw"]}]}], ";", "\[IndentingNewLine]", 
                   RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "ranw"}], "}"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"NZ", "-", "NZI"}], ">", "0"}], ",", 
                    RowBox[{
                    RowBox[{"ranz", "=", 
                    RowBox[{"RandomInteger", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"NZI", "+", "1"}], ",", "NZ"}], "}"}], "]"}]}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["z", "ranz"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "ranz"}], "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{
                    SubscriptBox["considervar", "k"], "=", 
                    RowBox[{"Variables", "[", 
                    SubscriptBox["consider", "k"], "]"}]}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"count", "\[Equal]", "0"}], ",", 
                  RowBox[{
                   RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<Retried \>\"", ",", "retry", ",", 
                    "\"\< times.\>\""}], "]"}], ";"}]}], "]"}], ";"}], "*)"}],
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"count", "\[Equal]", "300"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{
                 "Print", "[", 
                  "\"\<Start over - even external faces failed.\>\"", "]"}], 
                 ";"}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"retry", "=", 
                 RowBox[{"retry", "+", "1"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"Goto", "[", "beginagain", "]"}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{
               "Check", " ", "if", " ", "wext", " ", "fits", " ", "into", " ", 
                SubscriptBox["consider", "k"]}], ",", " ", 
               RowBox[{
               "by", " ", "checking", " ", "whether", " ", "any", " ", "of", 
                " ", "the", " ", "variables", " ", "in", " ", "wext", " ", 
                "is", " ", "in", " ", 
                RowBox[{
                 SubscriptBox["consider", "k"], "."}]}]}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"i", "=", "1"}], ",", 
               RowBox[{"i", "<", 
                RowBox[{
                 RowBox[{"Length", "[", 
                  SubscriptBox["considervar", "k"], "]"}], "+", "1"}]}], ",", 
               RowBox[{"i", "++"}], ",", 
               RowBox[{"(*", 
                RowBox[{
                "Go", " ", "through", " ", "all", " ", "the", " ", 
                 "variables", " ", "of", " ", 
                 SubscriptBox["consider", "k"]}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"ii", "=", "1"}], ",", 
                  RowBox[{"ii", "<", 
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    SubscriptBox["wext", "j"], "]"}], "]"}], "+", "1"}]}], 
                  ",", 
                  RowBox[{"ii", "++"}], ",", " ", 
                  RowBox[{"(*", 
                   RowBox[{
                   "Go", " ", "through", " ", "all", " ", "the", " ", 
                    "variables", " ", "of", " ", "wext"}], "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["wext", "j"], "]"}], "[", 
                    RowBox[{"[", "ii", "]"}], "]"}], "==", 
                    RowBox[{
                    SubscriptBox["considervar", "k"], "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["wextcont", "j"], "=", "1"}], ";", " ", 
                    RowBox[{"(*", 
                    RowBox[{"It", " ", "is", " ", 
                    RowBox[{"contained", "!"}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"save", "=", "ii"}], ";"}]}], " ", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Remember", " ", "which", " ", "variable", " ", "was", 
                    " ", "contained"}], "*)"}], "\[IndentingNewLine]", "]"}], 
                   ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                SubscriptBox["wextcont", "j"], "==", "1"}], ",", " ", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"Now", " ", "remove", " ", "the", " ", 
                  SubscriptBox["w", "j"], " ", "from", " ", 
                  SubscriptBox["consider", "k"]}], ",", " ", 
                 RowBox[{"and", " ", "record", " ", "this", " ", "into", " ", 
                  SubscriptBox["expression", "k"]}]}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                "Decide", " ", "whether", " ", "to", " ", "divide", " ", "or",
                  " ", 
                 RowBox[{"multiply", "."}]}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["wext", "j"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["wext", "j"], "]"}], "[", 
                    RowBox[{"[", "save", "]"}], "]"}]}], "]"}], "\[Equal]", 
                   "0"}], ",", " ", "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{
                    RowBox[{
                    "If", " ", "the", " ", "variable", " ", "is", " ", "in", 
                    " ", "the", " ", "denomianator", " ", 
                    RowBox[{"(", 
                    RowBox[{"ie", " ", "\[Equal]", "0"}], ")"}]}], ",", " ", 
                    RowBox[{"do", " ", 
                    RowBox[{"\"\<the opposite\>\"", ".", " ", "Otherwise"}]}],
                     ",", " ", 
                    RowBox[{"act", " ", 
                    RowBox[{"\"\<as normal\>\"", "."}]}]}], "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["wext", "j"], "]"}], "[", 
                    RowBox[{"[", "save", "]"}], "]"}]}], "]"}], "\[Equal]", 
                    "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"Here", " ", "is", " ", "the", " ", 
                    RowBox[{"opposite", "!"}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["w", "j"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"{", "j", "}"}]}], "]"}]}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["w", "j"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "j"}], "}"}]}], "]"}]}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["w", "j"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "j"}], "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["wext", "j"], "]"}], "[", 
                    RowBox[{"[", "save", "]"}], "]"}]}], "]"}], "\[Equal]", 
                    "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"Here", " ", "is", " ", "the", " ", 
                    RowBox[{"normal", "!"}]}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["w", "j"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "j"}], "}"}]}], "]"}]}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["w", "j"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"{", "j", "}"}]}], "]"}]}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["w", "j"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"{", "j", "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["wext", "j"], "]"}], "[", 
                    RowBox[{"[", "save", "]"}], "]"}]}], "]"}], "\[Equal]", 
                    "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"Here", " ", "is", " ", "the", " ", 
                    RowBox[{"normal", "!"}]}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["w", "j"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "j"}], "}"}]}], "]"}]}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["w", "j"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"{", "j", "}"}]}], "]"}]}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["w", "j"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"{", "j", "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{
                 SubscriptBox["considervar", "k"], "=", 
                 RowBox[{"Variables", "[", 
                  SubscriptBox["consider", "k"], "]"}]}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";", " ", 
             RowBox[{"(*", 
              RowBox[{"Close", " ", "If"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"Finished", " ", "recording", " ", "the", " ", 
               RowBox[{"operation", "!"}]}], "*)"}], "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"NZ", "-", "NZI"}], ">", "0"}], ",", " ", 
               RowBox[{"(*", 
                RowBox[{
                "If", " ", "we", " ", "have", " ", "external", " ", "z", " ", 
                 "paths"}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"jz", "=", 
                 RowBox[{
                  RowBox[{"Mod", "[", 
                   RowBox[{"count", ",", "NZ"}], "]"}], "+", "1"}]}], ";", 
                RowBox[{"(*", 
                 RowBox[{"jz", " ", "is", " ", "the", " ", 
                  SubscriptBox["z", "jz"], " ", "under", " ", 
                  "consideration"}], "*)"}], "\[IndentingNewLine]", 
                RowBox[{
                 SubscriptBox["zextcont", "jz"], "=", "0"}], ";", " ", 
                RowBox[{"(*", 
                 RowBox[{
                 "Keeps", " ", "track", " ", "of", " ", "whether", " ", 
                  SubscriptBox["z", "j"], " ", "is", " ", "included", " ", 
                  "or", " ", "not"}], "*)"}], "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                 "Now", " ", "check", " ", "if", " ", "zext", " ", "fits", 
                  " ", "into", " ", 
                  RowBox[{
                   SubscriptBox["consider", "k"], "."}]}], "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"i", "=", "1"}], ",", 
                  RowBox[{"i", "<", 
                   RowBox[{
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}], "+", "1"}]}], 
                  ",", 
                  RowBox[{"i", "++"}], ",", 
                  RowBox[{"(*", 
                   RowBox[{
                   "Go", " ", "through", " ", "all", " ", "the", " ", 
                    "variables", " ", "of", " ", 
                    SubscriptBox["consider", "k"]}], "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"ii", "=", "1"}], ",", 
                    RowBox[{"ii", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    SubscriptBox["zext", "jz"], "]"}], "]"}], "+", "1"}]}], 
                    ",", 
                    RowBox[{"ii", "++"}], ",", " ", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Go", " ", "through", " ", "all", " ", "the", " ", 
                    "variables", " ", "of", " ", "zext"}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["zext", "jz"], "]"}], "[", 
                    RowBox[{"[", "ii", "]"}], "]"}], "==", 
                    RowBox[{
                    SubscriptBox["considervar", "k"], "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["zextcont", "jz"], "=", "1"}], ";", " ", 
                    RowBox[{"(*", 
                    RowBox[{"It", " ", "is", " ", 
                    RowBox[{"contained", "!"}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"save2", "=", "ii"}], ";"}]}], " ", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Remember", " ", "which", " ", "variable", " ", "was", 
                    " ", "contained"}], "*)"}], "\[IndentingNewLine]", "]"}], 
                    ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", 
                RowBox[{"a", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["zextcont", "jz"], "==", "1"}], ",", " ", 
                   RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"Now", " ", "remove", " ", "the", " ", 
                    SubscriptBox["z", "jz"], " ", "from", " ", 
                    SubscriptBox["consider", "k"]}], ",", " ", 
                    RowBox[{
                    "and", " ", "record", " ", "this", " ", "into", " ", 
                    SubscriptBox["zexpression", "k"]}]}], "*)"}], 
                   "\[IndentingNewLine]", 
                   RowBox[{"(*", 
                    RowBox[{
                    "Decide", " ", "whether", " ", "to", " ", "divide", " ", 
                    "or", " ", 
                    RowBox[{"multiply", "."}]}], "*)"}], 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["zext", "jz"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["zext", "jz"], "]"}], "[", 
                    RowBox[{"[", "save2", "]"}], "]"}]}], "]"}], "\[Equal]", 
                    "0"}], ",", " ", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{
                    "If", " ", "the", " ", "variable", " ", "is", " ", "in", 
                    " ", "the", " ", "denomianator", " ", 
                    RowBox[{"(", 
                    RowBox[{"ie", " ", "\[Equal]", "0"}], ")"}]}], ",", " ", 
                    RowBox[{"do", " ", 
                    RowBox[{"\"\<the opposite\>\"", ".", " ", "Otherwise"}]}],
                     ",", " ", 
                    RowBox[{"act", " ", 
                    RowBox[{"\"\<as normal\>\"", "."}]}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["zext", "jz"], "]"}], "[", 
                    RowBox[{"[", "save2", "]"}], "]"}]}], "]"}], "\[Equal]", 
                    "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"Here", " ", "is", " ", "the", " ", 
                    RowBox[{"opposite", "!"}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["z", "jz"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], ",", 
                    RowBox[{"{", "jz", "}"}]}], "]"}]}], ";"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["z", "jz"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "jz"}], "}"}]}], "]"}]}], ";"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["z", "jz"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "jz"}], "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["zext", "jz"], "]"}], "[", 
                    RowBox[{"[", "save2", "]"}], "]"}]}], "]"}], "\[Equal]", 
                    "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"Here", " ", "is", " ", "the", " ", 
                    RowBox[{"normal", "!"}]}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["z", "jz"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "jz"}], "}"}]}], "]"}]}], ";"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["z", "jz"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], ",", 
                    RowBox[{"{", "jz", "}"}]}], "]"}]}], ";"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["z", "jz"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], ",", 
                    RowBox[{"{", "jz", "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["zext", "jz"], "]"}], "[", 
                    RowBox[{"[", "save2", "]"}], "]"}]}], "]"}], "\[Equal]", 
                    "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"Here", " ", "is", " ", "the", " ", 
                    RowBox[{"normal", "!"}]}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["z", "jz"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "jz"}], "}"}]}], "]"}]}], ";"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["z", "jz"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], ",", 
                    RowBox[{"{", "jz", "}"}]}], "]"}]}], ";"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["z", "jz"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], ",", 
                    RowBox[{"{", "jz", "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["considervar", "k"], "=", 
                    RowBox[{"Variables", "[", 
                    SubscriptBox["consider", "k"], "]"}]}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}]}], ";"}]}], " ", 
              RowBox[{"(*", 
               RowBox[{"Close", " ", "If"}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{"Finished", " ", "recording", " ", "the", " ", 
                RowBox[{"operation", "!"}]}], "*)"}], "\[IndentingNewLine]", 
              "]"}], ";", " ", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{
                RowBox[{"Close", " ", "if", " ", "NZ"}], "-", "NZI"}], ">", 
               "0"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{
               "If", " ", "there", " ", "are", " ", "no", " ", "more", " ", 
                "wext", " ", "to", " ", "fit", " ", "in"}], ",", " ", 
               RowBox[{"we", " ", "are", " ", 
                RowBox[{"done", ".", " ", "Check"}], " ", 
                RowBox[{"this", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"done", "=", "1"}], ";", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"ij", "=", "1"}], ",", 
               RowBox[{"ij", "<", 
                RowBox[{
                 RowBox[{"Length", "[", "allext", "]"}], "+", "1"}]}], ",", 
               RowBox[{"ij", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"ji", "=", "1"}], ",", 
                  RowBox[{"ji", "<", 
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    SubscriptBox["consider", "k"], "]"}], "]"}], "+", "1"}]}],
                   ",", 
                  RowBox[{"ji", "++"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"allext", "[", 
                    RowBox[{"[", "ij", "]"}], "]"}], "\[Equal]", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["consider", "k"], "]"}], "[", 
                    RowBox[{"[", "ji", "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"done", "=", "0"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "Now", " ", "we", " ", "know", " ", "if", " ", "we", " ", "are",
                " ", "done", " ", "or", " ", "not"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"count", "=", 
              RowBox[{"count", "+", "1"}]}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";", " ", 
          RowBox[{"(*", 
           RowBox[{"Close", " ", "while", " ", "loop"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "Now", " ", "we", " ", "have", " ", "the", " ", "external", " ", 
            RowBox[{"faces", "!"}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"senttointernal", "=", 
           SubscriptBox["consider", "k"]}], ";", 
          RowBox[{"(*", 
           RowBox[{
           "Record", " ", "what", " ", "we", " ", "sent", " ", "to", " ", 
            "the", " ", "internal", " ", 
            RowBox[{"faces", "."}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"sentexpression", "=", 
           SubscriptBox["expression", "k"]}], ";", "\[IndentingNewLine]", 
          RowBox[{"zsentexpression", "=", 
           SubscriptBox["zexpression", "k"]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "Now", " ", "find", " ", "out", " ", "what", " ", "the", " ", 
            "internal", " ", "faces", " ", "and", " ", "internal", " ", 
            RowBox[{
             SubscriptBox["z", "i"], "'"}], "s", " ", "are"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<Start internal!\>\"", "]"}], ";"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"count", "=", "0"}], ";", " ", 
          RowBox[{"(*", 
           RowBox[{
           "Counter", " ", "needed", " ", "in", " ", "the", " ", "while", " ",
             "loop"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"IF", ">", "0"}], "||", 
             RowBox[{"NZI", ">", "0"}], "||", 
             RowBox[{"newint", ">", "1"}]}], ",", 
            RowBox[{"(*", 
             RowBox[{
             "Keeps", " ", "going", " ", "until", " ", "we", " ", "get", " ", 
              "1."}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 SubscriptBox["consider", "k"], "==", "1"}], " ", "||", 
                RowBox[{
                 SubscriptBox["consider", "k"], "\[Equal]", 
                 RowBox[{"-", "1"}]}]}], " ", ",", " ", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"If", " ", "the", " ", "term", " ", "is", " ", "1"}],
                  ",", " ", 
                 RowBox[{"we", " ", "are", " ", "done"}]}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"count", "\[NotEqual]", "300"}], ",", 
                  RowBox[{
                   RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<Found after \>\"", ",", "count", ",", 
                    "\"\< operations.\>\""}], "]"}], ";"}]}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"darn", "=", "0"}], ";", "\[IndentingNewLine]", 
                RowBox[{"Break", "[", "]"}], ";"}]}], " ", 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "Now", " ", "check", " ", "if", " ", "z", " ", "fits", " ", 
               "into", " ", 
               RowBox[{
                SubscriptBox["consider", "k"], "."}]}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"NZI", ">", "0"}], ",", 
               RowBox[{"(*", 
                RowBox[{"Check", " ", "internal", " ", 
                 RowBox[{
                  SubscriptBox["z", "i"], "'"}], "s"}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"jz", "=", 
                 RowBox[{
                  RowBox[{"Mod", "[", 
                   RowBox[{"count", ",", "NZI"}], "]"}], "+", "1"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 SubscriptBox["zintcont", "jz"], "=", "0"}], ";", " ", 
                RowBox[{"(*", 
                 RowBox[{
                 "Keeps", " ", "track", " ", "of", " ", "whether", " ", 
                  SubscriptBox["z", "j"], " ", "is", " ", "included", " ", 
                  "or", " ", "not"}], "*)"}], "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    SubscriptBox["consider", "k"], "==", "1"}], " ", "||", 
                   RowBox[{
                    SubscriptBox["consider", "k"], "\[Equal]", 
                    RowBox[{"-", "1"}]}]}], " ", ",", " ", 
                  RowBox[{"(*", 
                   RowBox[{
                    RowBox[{
                    "If", " ", "the", " ", "term", " ", "is", " ", "1"}], ",",
                     " ", 
                    RowBox[{"we", " ", "are", " ", "done"}]}], "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"darn", "=", "0"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"Break", "[", "]"}], ";"}]}], " ", 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"ii", "=", "1"}], ",", 
                  RowBox[{"ii", "<", 
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    SubscriptBox["z", "jz"], "]"}], "]"}], "+", "1"}]}], ",", 
                  RowBox[{"ii", "++"}], ",", " ", 
                  RowBox[{"(*", 
                   RowBox[{
                   "Go", " ", "through", " ", "all", " ", "the", " ", 
                    "variables", " ", "of", " ", 
                    SubscriptBox["z", "j"]}], "*)"}], "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"i", "=", "1"}], ",", 
                    RowBox[{"i", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}], "+", "1"}]}], 
                    ",", 
                    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Go", " ", "through", " ", "all", " ", "the", " ", 
                    "variables", " ", "of", " ", 
                    SubscriptBox["consider", "k"]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["z", "jz"], "]"}], "[", 
                    RowBox[{"[", "ii", "]"}], "]"}], "==", 
                    RowBox[{
                    SubscriptBox["considervar", "k"], "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["zintcont", "jz"], "=", "1"}], ";", " ", 
                    RowBox[{"(*", 
                    RowBox[{"It", " ", "is", " ", 
                    RowBox[{"contained", "!"}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"save2", "=", "ii"}], ";"}]}], " ", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Remember", " ", "which", " ", "variable", " ", "was", 
                    " ", "contained"}], "*)"}], "\[IndentingNewLine]", "]"}], 
                    ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   SubscriptBox["zintcont", "jz"], "==", "1"}], ",", " ", 
                  RowBox[{"(*", 
                   RowBox[{
                    RowBox[{"Now", " ", "remove", " ", "the", " ", 
                    SubscriptBox["z", "jz"], " ", "from", " ", 
                    SubscriptBox["consider", "k"]}], ",", " ", 
                    RowBox[{
                    "and", " ", "record", " ", "this", " ", "into", " ", 
                    SubscriptBox["expression", "k"]}]}], "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{
                   "Decide", " ", "whether", " ", "to", " ", "divide", " ", 
                    "or", " ", 
                    RowBox[{"multiply", "."}]}], "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["z", "jz"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["z", "jz"], "]"}], "[", 
                    RowBox[{"[", "save2", "]"}], "]"}]}], "]"}], "\[Equal]", 
                    "0"}], ",", " ", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{
                    "If", " ", "the", " ", "variable", " ", "is", " ", "in", 
                    " ", "the", " ", "denomianator", " ", 
                    RowBox[{"(", 
                    RowBox[{"ie", " ", "\[Equal]", "0"}], ")"}]}], ",", " ", 
                    RowBox[{"do", " ", 
                    RowBox[{"\"\<the opposite\>\"", ".", " ", "Otherwise"}]}],
                     ",", " ", 
                    RowBox[{"act", " ", 
                    RowBox[{"\"\<as normal\>\"", "."}]}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["z", "jz"], "]"}], "[", 
                    RowBox[{"[", "save2", "]"}], "]"}]}], "]"}], "\[Equal]", 
                    "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"Here", " ", "is", " ", "the", " ", 
                    RowBox[{"opposite", "!"}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["z", "jz"]}], "]"}], "]"}], "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["z", "jz"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], ",", 
                    RowBox[{"{", "jz", "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["z", "jz"]}], "]"}], "]"}], "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["z", "jz"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "jz"}], "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["z", "jz"]}], "]"}], "]"}], "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["z", "jz"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "jz"}], "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["z", "jz"], "]"}], "[", 
                    RowBox[{"[", "save2", "]"}], "]"}]}], "]"}], "\[Equal]", 
                    "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"Here", " ", "is", " ", "the", " ", 
                    RowBox[{"normal", "!"}]}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["z", "jz"]}], "]"}], "]"}], "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["z", "jz"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "jz"}], "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["z", "jz"]}], "]"}], "]"}], "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["z", "jz"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], ",", 
                    RowBox[{"{", "jz", "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["z", "jz"]}], "]"}], "]"}], "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["z", "jz"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], ",", 
                    RowBox[{"{", "jz", "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["z", "jz"], "]"}], "[", 
                    RowBox[{"[", "save2", "]"}], "]"}]}], "]"}], "\[Equal]", 
                    "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"Here", " ", "is", " ", "the", " ", 
                    RowBox[{"normal", "!"}]}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["z", "jz"]}], "]"}], "]"}], "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["z", "jz"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "jz"}], "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["z", "jz"]}], "]"}], "]"}], "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["z", "jz"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], ",", 
                    RowBox[{"{", "jz", "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["z", "jz"]}], "]"}], "]"}], "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["z", "jz"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], ",", 
                    RowBox[{"{", "jz", "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{
                    SubscriptBox["considervar", "k"], "=", 
                    RowBox[{"Variables", "[", 
                    SubscriptBox["consider", "k"], "]"}]}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], " ", 
              RowBox[{"(*", 
               RowBox[{"Close", " ", "If"}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{"Finished", " ", "recording", " ", "the", " ", 
                RowBox[{"operation", "!"}]}], "*)"}], "\[IndentingNewLine]", 
              "]"}], ";", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"Close", " ", "if", " ", "NZI"}], ">", "0"}], "*)"}], 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 SubscriptBox["consider", "k"], "==", "1"}], " ", "||", 
                RowBox[{
                 SubscriptBox["consider", "k"], "\[Equal]", 
                 RowBox[{"-", "1"}]}]}], " ", ",", " ", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"If", " ", "the", " ", "term", " ", "is", " ", "1"}],
                  ",", " ", 
                 RowBox[{"we", " ", "are", " ", "done"}]}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{
                 "\"\<Found after \>\"", ",", "count", ",", 
                  "\"\< operations.\>\""}], "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"darn", "=", "0"}], ";", "\[IndentingNewLine]", 
                RowBox[{"Break", "[", "]"}], ";"}]}], " ", 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "Now", " ", "check", " ", "if", " ", "wshift", " ", "fits", " ",
                "into", " ", 
               RowBox[{
                SubscriptBox["consider", "k"], "."}]}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"newint", ">", "1"}], ",", 
               RowBox[{"(*", 
                RowBox[{
                "If", " ", "we", " ", "have", " ", "any", " ", "wshift", " ", 
                 "to", " ", "consider"}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"jsh", "=", 
                 RowBox[{
                  RowBox[{"Mod", "[", 
                   RowBox[{"count", ",", 
                    RowBox[{"newint", "-", "1"}]}], "]"}], "+", "1"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 SubscriptBox["wshiftcont", "jsh"], "=", "0"}], ";", " ", 
                RowBox[{"(*", 
                 RowBox[{
                 "Keeps", " ", "track", " ", "of", " ", "whether", " ", 
                  SubscriptBox["wshift", "j"], " ", "is", " ", "included", 
                  " ", "or", " ", "not"}], "*)"}], "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    SubscriptBox["consider", "k"], "==", "1"}], " ", "||", 
                   RowBox[{
                    SubscriptBox["consider", "k"], "\[Equal]", 
                    RowBox[{"-", "1"}]}]}], " ", ",", " ", 
                  RowBox[{"(*", 
                   RowBox[{
                    RowBox[{
                    "If", " ", "the", " ", "term", " ", "is", " ", "1"}], ",",
                     " ", 
                    RowBox[{"we", " ", "are", " ", "done"}]}], "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"darn", "=", "0"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"Break", "[", "]"}], ";"}]}], " ", 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"ii", "=", "1"}], ",", 
                  RowBox[{"ii", "<", 
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    SubscriptBox["wshift", "jsh"], "]"}], "]"}], "+", "1"}]}],
                   ",", 
                  RowBox[{"ii", "++"}], ",", " ", 
                  RowBox[{"(*", 
                   RowBox[{
                   "Go", " ", "through", " ", "all", " ", "the", " ", 
                    "variables", " ", "of", " ", 
                    SubscriptBox["wshift", "j"]}], "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"i", "=", "1"}], ",", 
                    RowBox[{"i", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}], "+", "1"}]}], 
                    ",", 
                    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Go", " ", "through", " ", "all", " ", "the", " ", 
                    "variables", " ", "of", " ", 
                    SubscriptBox["consider", "k"]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["wshift", "jsh"], "]"}], "[", 
                    RowBox[{"[", "ii", "]"}], "]"}], "==", 
                    RowBox[{
                    SubscriptBox["considervar", "k"], "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["wshiftcont", "jsh"], "=", "1"}], ";", " ", 
                    RowBox[{"(*", 
                    RowBox[{"It", " ", "is", " ", 
                    RowBox[{"contained", "!"}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"save3", "=", "ii"}], ";"}]}], " ", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Remember", " ", "which", " ", "variable", " ", "was", 
                    " ", "contained"}], "*)"}], "\[IndentingNewLine]", "]"}], 
                    ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   SubscriptBox["wshiftcont", "jsh"], "==", "1"}], ",", " ", 
                  RowBox[{"(*", 
                   RowBox[{
                    RowBox[{"Now", " ", "remove", " ", "the", " ", 
                    SubscriptBox["wshift", "jz"], " ", "from", " ", 
                    SubscriptBox["consider", "k"]}], ",", " ", 
                    RowBox[{
                    "and", " ", "record", " ", "this", " ", "into", " ", 
                    SubscriptBox["expression", "k"]}]}], "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{
                   "Decide", " ", "whether", " ", "to", " ", "divide", " ", 
                    "or", " ", 
                    RowBox[{"multiply", "."}]}], "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["wshift", "jsh"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["wshift", "jsh"], "]"}], "[", 
                    RowBox[{"[", "save3", "]"}], "]"}]}], "]"}], "\[Equal]", 
                    "0"}], ",", " ", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{
                    "If", " ", "the", " ", "variable", " ", "is", " ", "in", 
                    " ", "the", " ", "denomianator", " ", 
                    RowBox[{"(", 
                    RowBox[{"ie", " ", "\[Equal]", "0"}], ")"}]}], ",", " ", 
                    RowBox[{"do", " ", 
                    RowBox[{"\"\<the opposite\>\"", ".", " ", "Otherwise"}]}],
                     ",", " ", 
                    RowBox[{"act", " ", 
                    RowBox[{"\"\<as normal\>\"", "."}]}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["wshift", "jsh"], "]"}], "[", 
                    RowBox[{"[", "save3", "]"}], "]"}]}], "]"}], "\[Equal]", 
                    "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"Here", " ", "is", " ", "the", " ", 
                    RowBox[{"opposite", "!"}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["wshift", "jsh"]}], "]"}], "]"}], 
                    "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["wshift", "jsh"]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    SubscriptBox["wpow", "jsh"]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["wshift", "jsh"]}], "]"}], "]"}], 
                    "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["wshift", "jsh"]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"-", 
                    SubscriptBox["wpow", "jsh"]}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["wshift", "jsh"]}], "]"}], "]"}], 
                    "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["wshift", "jsh"]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"-", 
                    SubscriptBox["wpow", "jsh"]}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["wshift", "jz"], "]"}], "[", 
                    RowBox[{"[", "save3", "]"}], "]"}]}], "]"}], "\[Equal]", 
                    "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"Here", " ", "is", " ", "the", " ", 
                    RowBox[{"normal", "!"}]}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["wshift", "jsh"]}], "]"}], "]"}], 
                    "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["wshift", "jsh"]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"-", 
                    SubscriptBox["wpow", "jsh"]}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["wshift", "jsh"]}], "]"}], "]"}], 
                    "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["wshift", "jsh"]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    SubscriptBox["wpow", "jsh"]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["wshift", "jsh"]}], "]"}], "]"}], 
                    "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["wshift", "jsh"]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    SubscriptBox["wpow", "jsh"]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["wshift", "jsh"], "]"}], "[", 
                    RowBox[{"[", "save3", "]"}], "]"}]}], "]"}], "\[Equal]", 
                    "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"Here", " ", "is", " ", "the", " ", 
                    RowBox[{"normal", "!"}]}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["wshift", "jsh"]}], "]"}], "]"}], 
                    "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["wshift", "jsh"]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"-", 
                    SubscriptBox["wpow", "jsh"]}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["wshift", "jsh"]}], "]"}], "]"}], 
                    "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["wshift", "jsh"]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    SubscriptBox["wpow", "jsh"]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["wshift", "jsh"]}], "]"}], "]"}], 
                    "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["wshift", "jsh"]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    SubscriptBox["wpow", "jsh"]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
                    "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{
                    SubscriptBox["considervar", "k"], "=", 
                    RowBox[{"Variables", "[", 
                    SubscriptBox["consider", "k"], "]"}]}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], " ", 
              RowBox[{"(*", 
               RowBox[{"Close", " ", "If"}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{"Finished", " ", "recording", " ", "the", " ", 
                RowBox[{"operation", "!"}]}], "*)"}], "\[IndentingNewLine]", 
              "]"}], ";", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"Close", " ", "if", " ", "newint"}], ">", "0"}], 
              "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 SubscriptBox["consider", "k"], "==", "1"}], " ", "||", 
                RowBox[{
                 SubscriptBox["consider", "k"], "\[Equal]", 
                 RowBox[{"-", "1"}]}]}], " ", ",", " ", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"If", " ", "the", " ", "term", " ", "is", " ", "1"}],
                  ",", " ", 
                 RowBox[{"we", " ", "are", " ", "done"}]}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{
                 "\"\<Found after \>\"", ",", "count", ",", 
                  "\"\< operations.\>\""}], "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"darn", "=", "0"}], ";", "\[IndentingNewLine]", 
                RowBox[{"Break", "[", "]"}], ";"}]}], " ", 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"IF", ">", "0"}], ",", " ", 
               RowBox[{"(*", 
                RowBox[{"Check", " ", "internal", " ", "faces"}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"j", "=", 
                 RowBox[{
                  RowBox[{"Mod", "[", 
                   RowBox[{"count", ",", "IF"}], "]"}], "+", "1"}]}], ";", 
                RowBox[{"(*", 
                 RowBox[{"j", " ", "is", " ", "the", " ", 
                  SubscriptBox["w", "j"], " ", "under", " ", 
                  "consideration"}], "*)"}], "\[IndentingNewLine]", 
                RowBox[{
                 SubscriptBox["wintcont", "j"], "=", "0"}], ";", " ", 
                RowBox[{"(*", 
                 RowBox[{
                 "Keeps", " ", "track", " ", "of", " ", "whether", " ", 
                  SubscriptBox["w", "j"], " ", "is", " ", "included", " ", 
                  "or", " ", "not"}], "*)"}], "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{
                  "Check", " ", "if", " ", "w", " ", "fits", " ", "into", " ", 
                   SubscriptBox["consider", "k"]}], ",", " ", 
                  RowBox[{
                  "by", " ", "checking", " ", "whether", " ", "any", " ", 
                   "of", " ", "the", " ", "variables", " ", "in", " ", 
                   SubscriptBox["w", "j"], " ", "is", " ", "in", " ", 
                   RowBox[{
                    SubscriptBox["consider", "k"], "."}]}]}], "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"i", "=", "1"}], ",", 
                  RowBox[{"i", "<", 
                   RowBox[{
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}], "+", "1"}]}], 
                  ",", 
                  RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"ii", "=", "1"}], ",", 
                    RowBox[{"ii", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    SubscriptBox["w", "j"], "]"}], "]"}], "+", "1"}]}], ",", 
                    RowBox[{"ii", "++"}], ",", " ", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Go", " ", "through", " ", "all", " ", "the", " ", 
                    "variables", " ", "of", " ", 
                    SubscriptBox["w", "j"]}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Go", " ", "through", " ", "all", " ", "the", " ", 
                    "variables", " ", "of", " ", 
                    SubscriptBox["consider", "k"]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["w", "j"], "]"}], "[", 
                    RowBox[{"[", "ii", "]"}], "]"}], "==", 
                    RowBox[{
                    SubscriptBox["considervar", "k"], "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["wintcont", "j"], "=", "1"}], ";", " ", 
                    RowBox[{"(*", 
                    RowBox[{"It", " ", "is", " ", 
                    RowBox[{"contained", "!"}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"save", "=", "ii"}], ";"}]}], " ", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Remember", " ", "which", " ", "variable", " ", "was", 
                    " ", "contained"}], "*)"}], "\[IndentingNewLine]", "]"}], 
                    ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   SubscriptBox["wintcont", "j"], "==", "1"}], ",", " ", 
                  RowBox[{"(*", 
                   RowBox[{
                    RowBox[{"Now", " ", "remove", " ", "the", " ", 
                    SubscriptBox["w", "j"], " ", "from", " ", 
                    SubscriptBox["consider", "k"]}], ",", " ", 
                    RowBox[{
                    "and", " ", "record", " ", "this", " ", "into", " ", 
                    SubscriptBox["expression", "k"]}]}], "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{
                   "Decide", " ", "whether", " ", "to", " ", "divide", " ", 
                    "or", " ", 
                    RowBox[{"multiply", "."}]}], "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["w", "j"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["w", "j"], "]"}], "[", 
                    RowBox[{"[", "save", "]"}], "]"}]}], "]"}], "\[Equal]", 
                    "0"}], ",", " ", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{
                    "If", " ", "the", " ", "variable", " ", "is", " ", "in", 
                    " ", "the", " ", "denomianator", " ", 
                    RowBox[{"(", 
                    RowBox[{"ie", " ", "\[Equal]", "0"}], ")"}]}], ",", " ", 
                    RowBox[{"do", " ", 
                    RowBox[{"\"\<the opposite\>\"", ".", " ", "Otherwise"}]}],
                     ",", " ", 
                    RowBox[{"act", " ", 
                    RowBox[{"\"\<as normal\>\"", "."}]}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["w", "j"], "]"}], "[", 
                    RowBox[{"[", "save", "]"}], "]"}]}], "]"}], "\[Equal]", 
                    "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"Here", " ", "is", " ", "the", " ", 
                    RowBox[{"opposite", "!"}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["w", "j"]}], "]"}], "]"}], "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["w", "j"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"{", "j", "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["w", "j"]}], "]"}], "]"}], "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["w", "j"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "j"}], "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["w", "j"]}], "]"}], "]"}], "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["w", "j"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "j"}], "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["w", "j"], "]"}], "[", 
                    RowBox[{"[", "save", "]"}], "]"}]}], "]"}], "\[Equal]", 
                    "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"Here", " ", "is", " ", "the", " ", 
                    RowBox[{"normal", "!"}]}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["w", "j"]}], "]"}], "]"}], "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["w", "j"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "j"}], "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["w", "j"]}], "]"}], "]"}], "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["w", "j"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"{", "j", "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["w", "j"]}], "]"}], "]"}], "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["w", "j"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"{", "j", "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["w", "j"], "]"}], "[", 
                    RowBox[{"[", "save", "]"}], "]"}]}], "]"}], "\[Equal]", 
                    "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"Here", " ", "is", " ", "the", " ", 
                    RowBox[{"normal", "!"}]}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["w", "j"]}], "]"}], "]"}], "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["w", "j"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "j"}], "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["w", "j"]}], "]"}], "]"}], "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["w", "j"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"{", "j", "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["w", "j"]}], "]"}], "]"}], "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["w", "j"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"{", "j", "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{
                    SubscriptBox["considervar", "k"], "=", 
                    RowBox[{"Variables", "[", 
                    SubscriptBox["consider", "k"], "]"}]}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], " ", 
              RowBox[{"(*", 
               RowBox[{"Close", " ", "If"}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{"Finished", " ", "recording", " ", "the", " ", 
                RowBox[{"operation", "!"}]}], "*)"}], "\[IndentingNewLine]", 
              "]"}], ";", " ", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"Close", " ", "if", " ", "IF"}], ">", "0"}], "*)"}], 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"count", "=", 
              RowBox[{"count", "+", "1"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"count", "\[Equal]", "300"}], "&&", 
                RowBox[{"retry", "<", 
                 RowBox[{"(", 
                  RowBox[{"6", "patience"}], ")"}]}]}], ",", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{
                 "If", " ", "it", " ", "failed", " ", "but", " ", "it", " ", 
                  "could", " ", "be", " ", "our", " ", "fault"}], ",", " ", 
                 RowBox[{"try", " ", "to", " ", "guess", " ", "it", " ", 
                  RowBox[{"randomly", "."}]}]}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"powers", "=", 
                 RowBox[{"Array", "[", 
                  RowBox[{"tem", ",", 
                   RowBox[{"IF", "+", "NZI"}]}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                 "The", " ", "list", " ", "that", " ", "contains", " ", "all",
                   " ", "the", " ", "powers"}], "*)"}], "\[IndentingNewLine]", 
                RowBox[{"score", "=", "0"}], ";", "\[IndentingNewLine]", 
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"bore", "=", "1"}], ",", 
                  RowBox[{"bore", "<", 
                   RowBox[{
                    SuperscriptBox["10", 
                    RowBox[{"(", 
                    RowBox[{"patience", "+", "1"}], ")"}]], "+", "1"}]}], ",", 
                  RowBox[{"bore", "++"}], ",", 
                  RowBox[{"(*", 
                   RowBox[{"Try", " ", "lots", " ", "of", " ", "times"}], 
                   "*)"}], "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["consider", "k"], "=", "senttointernal"}], 
                   ";", 
                   RowBox[{"(*", 
                    RowBox[{
                    "Each", " ", "time", " ", "start", " ", "again", " ", 
                    "with", " ", "what", " ", "we", " ", "were", " ", 
                    "given"}], "*)"}], "\[IndentingNewLine]", 
                   RowBox[{
                    SubscriptBox["expression", "k"], "=", "sentexpression"}], 
                   ";", "\[IndentingNewLine]", 
                   RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    "zsentexpression"}], ";", "\[IndentingNewLine]", 
                   "\[IndentingNewLine]", 
                   RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"cha", "=", "1"}], ",", 
                    RowBox[{"cha", "<", 
                    RowBox[{"IF", "+", "NZI", "+", "1"}]}], ",", 
                    RowBox[{"cha", "++"}], ",", 
                    RowBox[{"(*", 
                    RowBox[{"Assign", " ", "random", " ", "powers"}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"powers", "[", 
                    RowBox[{"[", "cha", "]"}], "]"}], "=", 
                    RowBox[{"RandomInteger", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "2"}], ",", "2"}], "}"}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"pow", "=", "1"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"(*", 
                    RowBox[{
                    "Use", " ", "the", " ", "powers", " ", "for", " ", "the", 
                    " ", 
                    RowBox[{"w", "'"}], "s"}], "*)"}], "\[IndentingNewLine]", 
                   RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"inw", "=", "1"}], ",", 
                    RowBox[{"inw", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{"inw", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SuperscriptBox[
                    SubscriptBox["w", "inw"], 
                    RowBox[{"powers", "[", 
                    RowBox[{"[", "pow", "]"}], "]"}]]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"ad", "=", "1"}], ",", 
                    RowBox[{"ad", "<", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"powers", "[", 
                    RowBox[{"[", "pow", "]"}], "]"}], "]"}], "+", "1"}]}], 
                    ",", 
                    RowBox[{"ad", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "inw"}], " ", 
                    RowBox[{"Sign", "[", 
                    RowBox[{"powers", "[", 
                    RowBox[{"[", "pow", "]"}], "]"}], "]"}]}], "}"}]}], 
                    "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"pow", "=", 
                    RowBox[{"pow", "+", "1"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"(*", 
                    RowBox[{
                    "Use", " ", "the", " ", "powers", " ", "for", " ", "the", 
                    " ", 
                    RowBox[{"z", "'"}], "s"}], "*)"}], "\[IndentingNewLine]", 
                   RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"inw", "=", "1"}], ",", 
                    RowBox[{"inw", "<", 
                    RowBox[{"NZI", "+", "1"}]}], ",", 
                    RowBox[{"inw", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SuperscriptBox[
                    SubscriptBox["z", "inw"], 
                    RowBox[{"powers", "[", 
                    RowBox[{"[", "pow", "]"}], "]"}]]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"ad", "=", "1"}], ",", 
                    RowBox[{"ad", "<", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"powers", "[", 
                    RowBox[{"[", "pow", "]"}], "]"}], "]"}], "+", "1"}]}], 
                    ",", 
                    RowBox[{"ad", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "inw"}], " ", 
                    RowBox[{"Sign", "[", 
                    RowBox[{"powers", "[", 
                    RowBox[{"[", "pow", "]"}], "]"}], "]"}]}], "}"}]}], 
                    "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"pow", "=", 
                    RowBox[{"pow", "+", "1"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "==", "1"}], " ", "||", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "\[Equal]", 
                    RowBox[{"-", "1"}]}]}], " ", ",", " ", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{
                    "If", " ", "the", " ", "term", " ", "is", " ", "1"}], ",",
                     " ", 
                    RowBox[{"we", " ", "are", " ", "done"}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<Guessed it! Attempted \>\"", ",", "bore", ",", 
                    "\"\< times.\>\""}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"darn", "=", "0"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"guess", "=", 
                    RowBox[{"guess", "+", "1"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"score", "=", "1"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"Break", "[", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"score", "\[Equal]", "0"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"retry", "=", 
                    RowBox[{"retry", "+", "1"}]}], ";", "\[IndentingNewLine]", 
                   RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"Print", "[", "\"\<Sent it away!\>\"", "]"}], 
                    ";"}], "*)"}], "\[IndentingNewLine]", 
                   RowBox[{"Goto", "[", "beginext", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"count", "\[Equal]", "300"}], "&&", 
                RowBox[{"retry", "\[GreaterEqual]", 
                 RowBox[{"(", 
                  RowBox[{"6", "patience"}], ")"}]}]}], ",", 
               RowBox[{"(*", 
                RowBox[{
                "If", " ", "it", " ", "really", " ", "fails", " ", "just", 
                 " ", "give", " ", "up"}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                "Print", "[", 
                 "\"\<Failed methodically, failed to guess it.\>\"", "]"}], 
                ";", "\[IndentingNewLine]", 
                RowBox[{"darn", "=", "1"}], ";", "\[IndentingNewLine]", 
                RowBox[{"Break", "[", "]"}], ";"}]}], "\[IndentingNewLine]", 
              "]"}], ";"}]}], " ", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", "]"}], ";", " ", 
          RowBox[{"(*", 
           RowBox[{"Close", " ", "while", " ", "loop"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "Now", " ", "we", " ", "have", " ", "the", " ", "internal", " ", 
            "faces", " ", "and", " ", 
            RowBox[{
             SubscriptBox["z", "i"], "'"}], 
            RowBox[{"s", " ", "!"}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"darn", "\[Equal]", "1"}], "&&", 
             RowBox[{"patience", "\[GreaterEqual]", "4"}]}], ",", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"If", " ", "the", " ", "guess", " ", "fails"}], ",", 
              " ", 
              RowBox[{"do", " ", "it", " ", "methodically"}]}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
             "Print", "[", 
              "\"\<Since patience\[GreaterEqual]4 , try exhausting all \
possibilities (within reason).\>\"", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"powarray", "=", 
              RowBox[{"Tuples", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "0", ",", "1"}], "}"}], ",", 
                RowBox[{"NZ", "+", "NF", "-", "1"}]}], "]"}]}], ";", " ", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{
               "contains", " ", "all", " ", "the", " ", "possibilities"}], 
               ",", " ", 
               RowBox[{
                RowBox[{"with", " ", "powers", " ", "between"}], " ", "-", 
                RowBox[{"1", " ", "and", " ", "1."}]}]}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"om", "=", "1"}], ",", 
               RowBox[{"om", "<", 
                RowBox[{
                 SuperscriptBox["3", 
                  RowBox[{"NZ", "+", "NF", "-", "1"}]], "+", "1"}]}], ",", 
               RowBox[{"om", "++"}], ",", " ", 
               RowBox[{"(*", 
                RowBox[{
                "Try", " ", "all", " ", "the", " ", "different", " ", 
                 "scenarios"}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 SubscriptBox["consider", "k"], "=", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"MonomialList", "[", "perf", "]"}], "[", 
                   RowBox[{"[", "k", "]"}], "]"}], "/", "ref"}]}], ";", 
                RowBox[{"(*", 
                 RowBox[{
                 "Each", " ", "time", " ", "start", " ", "from", " ", "the", 
                  " ", "beginning"}], "*)"}], "\[IndentingNewLine]", 
                RowBox[{
                 SubscriptBox["expression", "k"], "=", 
                 RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{
                 SubscriptBox["zexpression", "k"], "=", 
                 RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"pow", "=", "1"}], ";", "\[IndentingNewLine]", 
                RowBox[{"show", "=", "1"}], ";", "\[IndentingNewLine]", 
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"wfa", "=", "1"}], ",", 
                  RowBox[{"wfa", "<", "NF"}], ",", 
                  RowBox[{"wfa", "++"}], ",", 
                  RowBox[{"(*", 
                   RowBox[{
                   "Use", " ", "the", " ", "powers", " ", "for", " ", "the", 
                    " ", 
                    RowBox[{"w", "'"}], "s"}], "*)"}], "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], 
                    SuperscriptBox[
                    SubscriptBox["w", "wfa"], 
                    RowBox[{"powarray", "[", 
                    RowBox[{"[", 
                    RowBox[{"om", ",", "pow"}], "]"}], "]"}]]}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"show", "=", 
                    RowBox[{"show", " ", 
                    SuperscriptBox[
                    SubscriptBox["ww", "wfa"], 
                    RowBox[{"-", 
                    RowBox[{"powarray", "[", 
                    RowBox[{"[", 
                    RowBox[{"om", ",", "pow"}], "]"}], "]"}]}]]}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"ad", "=", "1"}], ",", 
                    RowBox[{"ad", "<", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"powarray", "[", 
                    RowBox[{"[", 
                    RowBox[{"om", ",", "pow"}], "]"}], "]"}], "]"}], "+", 
                    "1"}]}], ",", 
                    RowBox[{"ad", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "wfa"}], " ", 
                    RowBox[{"Sign", "[", 
                    RowBox[{"powarray", "[", 
                    RowBox[{"[", 
                    RowBox[{"om", ",", "pow"}], "]"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
                   ";", "\[IndentingNewLine]", 
                   RowBox[{"pow", "=", 
                    RowBox[{"pow", "+", "1"}]}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"inw", "=", "1"}], ",", 
                  RowBox[{"inw", "<", 
                   RowBox[{"NZ", "+", "1"}]}], ",", 
                  RowBox[{"inw", "++"}], ",", 
                  RowBox[{"(*", 
                   RowBox[{
                   "Use", " ", "the", " ", "powers", " ", "for", " ", "the", 
                    " ", 
                    RowBox[{"z", "'"}], "s"}], "*)"}], "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SuperscriptBox[
                    SubscriptBox["z", "inw"], 
                    RowBox[{"powarray", "[", 
                    RowBox[{"[", 
                    RowBox[{"om", ",", "pow"}], "]"}], "]"}]]}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"show", "=", 
                    RowBox[{"show", " ", 
                    SuperscriptBox[
                    SubscriptBox["zz", "inw"], 
                    RowBox[{"-", 
                    RowBox[{"powarray", "[", 
                    RowBox[{"[", 
                    RowBox[{"om", ",", "pow"}], "]"}], "]"}]}]]}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"ad", "=", "1"}], ",", 
                    RowBox[{"ad", "<", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"powarray", "[", 
                    RowBox[{"[", 
                    RowBox[{"om", ",", "pow"}], "]"}], "]"}], "]"}], "+", 
                    "1"}]}], ",", 
                    RowBox[{"ad", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "inw"}], " ", 
                    RowBox[{"Sign", "[", 
                    RowBox[{"powarray", "[", 
                    RowBox[{"[", 
                    RowBox[{"om", ",", "pow"}], "]"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
                   ";", "\[IndentingNewLine]", 
                   RowBox[{"pow", "=", 
                    RowBox[{"pow", "+", "1"}]}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    SubscriptBox["consider", "k"], "==", "1"}], " ", "||", 
                   RowBox[{
                    SubscriptBox["consider", "k"], "\[Equal]", 
                    RowBox[{"-", "1"}]}]}], " ", ",", " ", 
                  RowBox[{"(*", 
                   RowBox[{
                    RowBox[{
                    "If", " ", "the", " ", "term", " ", "is", " ", "1"}], ",",
                     " ", 
                    RowBox[{"we", " ", "are", " ", "done"}]}], "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<Found it on the \>\"", ",", "om", ",", 
                    "\"\<th try.\>\""}], "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"guess", "=", 
                    RowBox[{"guess", "+", "1"}]}], ";", "\[IndentingNewLine]", 
                   RowBox[{"darn", "=", "0"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"Break", "[", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
          RowBox[{"(*", 
           RowBox[{"Close", " ", "if"}], "*)"}], "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"darn", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
             "Now", " ", "turn", " ", "this", " ", "into", " ", "toric", " ", 
              "diagram", " ", "coordinates"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"mastercoords", "=", 
              RowBox[{"Table", "[", 
               RowBox[{"0", ",", 
                RowBox[{"{", 
                 RowBox[{"x", ",", 
                  RowBox[{"NZ", "+", "NF", "-", "1"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"y", ",", "1"}], "}"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"ei", "=", "1"}], ",", 
               RowBox[{"ei", "<", 
                RowBox[{"NZ", "+", "1"}]}], ",", 
               RowBox[{"ei", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"ai", "=", "1"}], ",", 
                  RowBox[{"ai", "<", 
                   RowBox[{
                    RowBox[{"Length", "[", 
                    SubscriptBox["zexpression", "k"], "]"}], "+", "1"}]}], 
                  ",", 
                  RowBox[{"ai", "++"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "[", 
                    RowBox[{"[", "ai", "]"}], "]"}], "\[Equal]", "ei"}], "||", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "[", 
                    RowBox[{"[", "ai", "]"}], "]"}], "\[Equal]", 
                    RowBox[{"-", "ei"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"mastercoords", "[", 
                    RowBox[{"[", 
                    RowBox[{"ei", ",", "1"}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"mastercoords", "[", 
                    RowBox[{"[", 
                    RowBox[{"ei", ",", "1"}], "]"}], "]"}], "+", 
                    RowBox[{"Sign", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "[", 
                    RowBox[{"[", "ai", "]"}], "]"}], "]"}]}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"ei", "=", "1"}], ",", 
               RowBox[{"ei", "<", "NF"}], ",", 
               RowBox[{"ei", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"ai", "=", "1"}], ",", 
                  RowBox[{"ai", "<", 
                   RowBox[{
                    RowBox[{"Length", "[", 
                    SubscriptBox["expression", "k"], "]"}], "+", "1"}]}], ",", 
                  RowBox[{"ai", "++"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["expression", "k"], "[", 
                    RowBox[{"[", "ai", "]"}], "]"}], "\[Equal]", "ei"}], "||", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["expression", "k"], "[", 
                    RowBox[{"[", "ai", "]"}], "]"}], "\[Equal]", 
                    RowBox[{"-", "ei"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"mastercoords", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"NZ", "+", "ei"}], ",", "1"}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"mastercoords", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"NZ", "+", "ei"}], ",", "1"}], "]"}], "]"}], "+", 
                    RowBox[{"Sign", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "[", 
                    RowBox[{"[", "ai", "]"}], "]"}], "]"}]}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"masterspace", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"masterspace", ",", "mastercoords", ",", "2"}], 
               "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"Make", " ", "the", " ", "expression", " ", "nice"}], 
              "*)"}], "\[IndentingNewLine]", 
             RowBox[{"nice", "=", "1"}], ";", "\[IndentingNewLine]", 
             RowBox[{"compare", "=", "1"}], ";", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"ei", "=", "1"}], ",", 
               RowBox[{"ei", "<", "NF"}], ",", 
               RowBox[{"ei", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"ai", "=", "1"}], ",", 
                  RowBox[{"ai", "<", 
                   RowBox[{
                    RowBox[{"Length", "[", 
                    SubscriptBox["expression", "k"], "]"}], "+", "1"}]}], ",", 
                  RowBox[{"ai", "++"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["expression", "k"], "[", 
                    RowBox[{"[", "ai", "]"}], "]"}], "\[Equal]", "ei"}], "||", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["expression", "k"], "[", 
                    RowBox[{"[", "ai", "]"}], "]"}], "\[Equal]", 
                    RowBox[{"-", "ei"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"nice", "=", 
                    RowBox[{"nice", " ", 
                    SuperscriptBox[
                    SubscriptBox["ww", "ei"], 
                    RowBox[{"Sign", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "[", 
                    RowBox[{"[", "ai", "]"}], "]"}], "]"}]]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"compare", "=", 
                    RowBox[{"compare", " ", 
                    SuperscriptBox[
                    SubscriptBox["w", "ei"], 
                    RowBox[{"Sign", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "[", 
                    RowBox[{"[", "ai", "]"}], "]"}], "]"}]]}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"ei", "=", "1"}], ",", 
               RowBox[{"ei", "<", 
                RowBox[{"NZ", "+", "1"}]}], ",", 
               RowBox[{"ei", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"ai", "=", "1"}], ",", 
                  RowBox[{"ai", "<", 
                   RowBox[{
                    RowBox[{"Length", "[", 
                    SubscriptBox["zexpression", "k"], "]"}], "+", "1"}]}], 
                  ",", 
                  RowBox[{"ai", "++"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "[", 
                    RowBox[{"[", "ai", "]"}], "]"}], "\[Equal]", "ei"}], "||", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "[", 
                    RowBox[{"[", "ai", "]"}], "]"}], "\[Equal]", 
                    RowBox[{"-", "ei"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"nice", "=", 
                    RowBox[{"nice", " ", 
                    SuperscriptBox[
                    SubscriptBox["zz", "ei"], 
                    RowBox[{"Sign", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "[", 
                    RowBox[{"[", "ai", "]"}], "]"}], "]"}]]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"compare", "=", 
                    RowBox[{"compare", " ", 
                    SuperscriptBox[
                    SubscriptBox["z", "ei"], 
                    RowBox[{"Sign", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "[", 
                    RowBox[{"[", "ai", "]"}], "]"}], "]"}]]}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"compare", "===", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"MonomialList", "[", "perf", "]"}], "[", 
                   RowBox[{"[", "k", "]"}], "]"}], "/", "ref"}]}], "||", 
                RowBox[{"compare", "===", 
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{
                    RowBox[{"MonomialList", "[", "perf", "]"}], "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "/", "ref"}]}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{"nice", ",", "\"\< = \>\"", ",", "compare"}], "]"}], 
                ";", "\[IndentingNewLine]", 
                RowBox[{
                 SubscriptBox["pm", "k"], "=", "nice"}], ";"}], " ", 
               RowBox[{"(*", 
                RowBox[{"Saves", " ", "the", " ", "expression"}], "*)"}], 
               "\[IndentingNewLine]", ",", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{
                 "\"\<Somehow this didn't work! Bug in the code. Do it by \
hand: \>\"", ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"MonomialList", "[", "perf", "]"}], "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "/", "ref"}]}], "]"}], 
                ";", "\[IndentingNewLine]", 
                RowBox[{"fail", "=", 
                 RowBox[{"fail", "+", "1"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"masterspace", "=", 
                 RowBox[{"Drop", "[", 
                  RowBox[{"masterspace", ",", "None", ",", 
                   RowBox[{"-", "1"}]}], "]"}]}], ";"}]}], 
              RowBox[{"(*", 
               RowBox[{
               "Remove", " ", "the", " ", "column", " ", "we", " ", "just", 
                " ", "added"}], "*)"}], "\[IndentingNewLine]", "]"}], ";"}], 
            "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{"\"\<All attempts failed. Do it by hand: \>\"", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"MonomialList", "[", "perf", "]"}], "[", 
                 RowBox[{"[", "k", "]"}], "]"}], "/", "ref"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"fail", "=", 
              RowBox[{"fail", "+", "1"}]}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";"}]}], 
        RowBox[{"(*", 
         RowBox[{"Close", " ", "if"}], "*)"}], "\[IndentingNewLine]", "]"}], 
       ";", 
       RowBox[{"(*", 
        RowBox[{"Close", " ", "for", " ", "k"}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", "\"\<---------------------------------------------\>\"", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<Failed \>\"", ",", "fail", ",", "\"\< times. Guessed \>\"", ",", 
         "guess", ",", "\"\< times.\>\""}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Computation time: \>\"", ",", 
         RowBox[{
          RowBox[{"TimeUsed", "[", "]"}], "-", "time"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"time", "=", 
        RowBox[{"TimeUsed", "[", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Gmaster", "=", "masterspace"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Gmaster = \>\"", ",", 
         RowBox[{"masterspace", "//", "MatrixForm"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"mastermult", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Dimensions", "[", 
            RowBox[{
             RowBox[{"Gather", "[", 
              RowBox[{"Transpose", "[", "masterspace", "]"}], "]"}], "[", 
             RowBox[{"[", "y", "]"}], "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", 
            RowBox[{
             RowBox[{"Dimensions", "[", 
              RowBox[{"Gather", "[", 
               RowBox[{"Transpose", "[", "masterspace", "]"}], "]"}], "]"}], 
             "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"DeleteDuplicates", "[", 
            RowBox[{"mastermult", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ">", "1"}], ",", 
         RowBox[{
          RowBox[{
          "Print", "[", 
           "\"\<ERROR!!! THERE ARE SEVERAL PERFECT MATCHINGS WITH THE SAME \
EXPRESSION!\>\"", "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", 
        "\"\<The order of the coordinates for Gmaster is: \!\(\*SubscriptBox[\
\(z\), \(i\)]\)'s, then faces (starting from face 1 to face NF-1).\>\"", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"gauging", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Gmoduli", "=", 
          RowBox[{"Delete", "[", 
           RowBox[{"Gmaster", ",", 
            RowBox[{"Transpose", "[", 
             RowBox[{"{", 
              RowBox[{"Table", "[", 
               RowBox[{"i", ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", 
                  RowBox[{"NZ", "+", "1"}], ",", 
                  RowBox[{"NZ", "+", "IF"}]}], "}"}]}], "]"}], "}"}], "]"}]}],
            "]"}]}], "\[IndentingNewLine]", ",", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"gauging", "\[Equal]", "2"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"deletelist", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"intz", ",", 
                RowBox[{"Table", "[", 
                 RowBox[{"i", ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{"NZ", "+", "1"}], ",", 
                    RowBox[{"NZ", "+", "IF"}]}], "}"}]}], "]"}]}], "]"}]}], 
             ";", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{
                RowBox[{
                "Here", " ", "we", " ", "also", " ", "dauge", " ", "the", " ",
                  "internal", " ", "zig"}], "-", "zags"}], ",", " ", 
               RowBox[{
               "as", " ", "well", " ", "as", " ", "delete", " ", "all", " ", 
                "internal", " ", "faces"}]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"Print", "[", 
                RowBox[{"\"\<deletelist=\>\"", ",", "deletelist"}], "]"}], 
               ";"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"boundaries", "=", 
              RowBox[{"Delete", "[", 
               RowBox[{"boundaries", ",", "1"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"bo", "=", "1"}], ",", 
               RowBox[{"bo", "<", 
                RowBox[{
                 RowBox[{"Length", "[", "boundaries", "]"}], "+", "1"}]}], 
               ",", 
               RowBox[{"bo", "++"}], ",", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{
                 "Each", " ", "time", " ", "we", " ", "have", " ", "external",
                   " ", "guys", " ", "going", " ", "around", " ", "a", " ", 
                  "boundary", " ", 
                  RowBox[{"(", 
                   RowBox[{
                   "hence", " ", "are", " ", "completely", " ", "internal"}], 
                   ")"}]}], ",", " ", 
                 RowBox[{
                 "we", " ", "have", " ", "to", " ", "subtract", " ", "the", 
                  " ", "value", " ", "of", " ", "one", " ", "row", " ", 
                  "from", " ", "all", " ", "the", " ", "others"}], ",", " ", 
                 RowBox[{
                 "and", " ", "then", " ", "gauge", " ", "this", " ", 
                  "row"}]}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"numb", "=", "1"}], ",", 
                  RowBox[{"numb", "<", 
                   RowBox[{"Length", "[", 
                    RowBox[{"boundaries", "[", 
                    RowBox[{"[", "bo", "]"}], "]"}], "]"}]}], ",", 
                  RowBox[{"numb", "++"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"masterspace", "[", 
                    RowBox[{"[", 
                    RowBox[{"boundaries", "[", 
                    RowBox[{"[", 
                    RowBox[{"bo", ",", "numb"}], "]"}], "]"}], "]"}], "]"}], 
                    "=", 
                    RowBox[{
                    RowBox[{"masterspace", "[", 
                    RowBox[{"[", 
                    RowBox[{"boundaries", "[", 
                    RowBox[{"[", 
                    RowBox[{"bo", ",", "numb"}], "]"}], "]"}], "]"}], "]"}], 
                    "-", 
                    RowBox[{"masterspace", "[", 
                    RowBox[{"[", 
                    RowBox[{"boundaries", "[", 
                    RowBox[{"[", 
                    RowBox[{"bo", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"boundaries", "[", 
                    RowBox[{"[", "bo", "]"}], "]"}], "]"}]}], "]"}], "]"}], 
                    "]"}], "]"}]}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
                ";", "\[IndentingNewLine]", 
                RowBox[{"deletelist", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{"deletelist", ",", 
                   RowBox[{"{", 
                    RowBox[{"NZ", "+", 
                    RowBox[{"boundaries", "[", 
                    RowBox[{"[", 
                    RowBox[{"bo", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"boundaries", "[", 
                    RowBox[{"[", "bo", "]"}], "]"}], "]"}]}], "]"}], "]"}]}], 
                    "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"Print", "[", 
                 RowBox[{"\"\<deletelist=\>\"", ",", "deletelist"}], "]"}], 
                ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Gmoduli", "=", 
              RowBox[{"Delete", "[", 
               RowBox[{"masterspace", ",", 
                RowBox[{"Transpose", "[", 
                 RowBox[{"{", "deletelist", "}"}], "]"}]}], "]"}]}], ";"}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{
             RowBox[{
             "Print", "[", 
              "\"\<Invalid value for 'gauging'. Need to specify either \
'gauging'=1 or 'gauging'=2.\>\"", "]"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Now", " ", "group", " ", "the", " ", "multiplicities", " ", "of", 
         " ", "G", " ", 
         RowBox[{"together", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Gshort", "=", 
        RowBox[{"Transpose", "[", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Transpose", "[", "Gmoduli", "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Multmatrix", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Dimensions", "[", 
            RowBox[{
             RowBox[{"Gather", "[", 
              RowBox[{"Transpose", "[", "Gmoduli", "]"}], "]"}], "[", 
             RowBox[{"[", "y", "]"}], "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", 
            RowBox[{
             RowBox[{"Dimensions", "[", 
              RowBox[{"Gather", "[", 
               RowBox[{"Transpose", "[", "Gmoduli", "]"}], "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Gshort = \>\"", ",", 
         RowBox[{"Gshort", "//", "MatrixForm"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Multipl = \>\"", ",", 
         RowBox[{"Multmatrix", "//", "MatrixForm"}]}], "]"}], ";"}]}], " ", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.576148817912237*^9, 3.576148928127171*^9}, {
   3.5761489689338007`*^9, 3.576149056150631*^9}, {3.5761492056310883`*^9, 
   3.576149274306745*^9}, {3.576149312465382*^9, 3.576149386752533*^9}, {
   3.576149491359613*^9, 3.57614949465446*^9}, {3.576149723190949*^9, 
   3.5761499230628767`*^9}, {3.576149977995221*^9, 3.576150164376753*^9}, {
   3.5761502098411922`*^9, 3.576150230668911*^9}, {3.5761502663387747`*^9, 
   3.576150318274827*^9}, {3.576150357542122*^9, 3.576150377096726*^9}, {
   3.5761504792596483`*^9, 3.5761506110021687`*^9}, {3.576150781148217*^9, 
   3.5761508537488527`*^9}, {3.576150927902979*^9, 3.57615095784647*^9}, {
   3.576151019012793*^9, 3.5761510254763803`*^9}, {3.5761510998536043`*^9, 
   3.576151315617023*^9}, {3.5761513965588703`*^9, 3.576151511071175*^9}, {
   3.5761515622068157`*^9, 3.57615157040322*^9}, {3.576151738724861*^9, 
   3.5761519506830807`*^9}, {3.5761519973722*^9, 3.576152038638912*^9}, {
   3.576152086187725*^9, 3.576152387554825*^9}, {3.576152460932548*^9, 
   3.576152466723721*^9}, {3.576152819389801*^9, 3.576152863530302*^9}, {
   3.576152899182455*^9, 3.576152934339652*^9}, {3.5761529864215593`*^9, 
   3.576153028855031*^9}, {3.576153107663233*^9, 3.576153122449911*^9}, {
   3.576153186977137*^9, 3.576153235746182*^9}, {3.576153322263803*^9, 
   3.5761533903371162`*^9}, {3.576153552252083*^9, 3.576153650326581*^9}, {
   3.576153782422483*^9, 3.576153973026595*^9}, {3.576154104509305*^9, 
   3.57615423728615*^9}, {3.5761547492353563`*^9, 3.576154749602059*^9}, {
   3.576154780179575*^9, 3.576154843122892*^9}, {3.5761549401111403`*^9, 
   3.576154988794104*^9}, {3.5761550298214703`*^9, 3.57615511679346*^9}, {
   3.5761553125133953`*^9, 3.576155329449048*^9}, {3.576155677776223*^9, 
   3.57615570035149*^9}, {3.5761557544205513`*^9, 3.57615580109277*^9}, {
   3.576155841504397*^9, 3.57615584351921*^9}, {3.5761559302250347`*^9, 
   3.576155930836429*^9}, 3.576156046147732*^9, {3.576156078253046*^9, 
   3.576156257075591*^9}, {3.576156481224762*^9, 3.576156496728744*^9}, {
   3.576156533245408*^9, 3.576156540113902*^9}, {3.576156723067902*^9, 
   3.576156746349201*^9}, {3.5761570742722263`*^9, 3.576157074970343*^9}, {
   3.5761571154587812`*^9, 3.576157133207965*^9}, {3.576157183315496*^9, 
   3.576157190293767*^9}, {3.57615736615119*^9, 3.576157395970818*^9}, {
   3.576158238330205*^9, 3.576158250499261*^9}, {3.576158283006201*^9, 
   3.5761583185151463`*^9}, {3.576158372480467*^9, 3.5761583746699266`*^9}, {
   3.576158435297688*^9, 3.576158563068829*^9}, {3.576158637401432*^9, 
   3.5761586660870943`*^9}, {3.576158708921126*^9, 3.576158906534074*^9}, {
   3.576158985725052*^9, 3.576159008650741*^9}, {3.576159067842807*^9, 
   3.5761592417473497`*^9}, {3.576159289206572*^9, 3.5761594186680727`*^9}, {
   3.5761596283971443`*^9, 3.576159650763504*^9}, {3.576159728368107*^9, 
   3.576159736948764*^9}, 3.576159891409306*^9, {3.576160248109364*^9, 
   3.576160253555657*^9}, {3.576160322563739*^9, 3.576160629640267*^9}, {
   3.576160678384303*^9, 3.576160709739375*^9}, {3.576160778857377*^9, 
   3.5761608154750843`*^9}, {3.576160900640486*^9, 3.576160909270117*^9}, {
   3.576160957749383*^9, 3.5761610207898617`*^9}, {3.576161347858952*^9, 
   3.576161436836183*^9}, {3.576161474928699*^9, 3.576161499347949*^9}, {
   3.5761616599899607`*^9, 3.576161661723804*^9}, {3.576161695145748*^9, 
   3.576161729201323*^9}, {3.576161775276593*^9, 3.576161787108982*^9}, {
   3.576161830273356*^9, 3.576161874556169*^9}, {3.576161940060336*^9, 
   3.576162113241889*^9}, {3.5762130920845633`*^9, 3.576213264998011*^9}, {
   3.576213315237341*^9, 3.576213326456188*^9}, {3.576213739622857*^9, 
   3.576213774958535*^9}, {3.57621451930411*^9, 3.576214693140319*^9}, {
   3.576214880402701*^9, 3.5762149263815403`*^9}, {3.576215270457015*^9, 
   3.5762152787058563`*^9}, {3.5762153412229433`*^9, 
   3.5762154758390512`*^9}, {3.576215507016677*^9, 3.576215518239626*^9}, {
   3.576215884260626*^9, 3.57621588549268*^9}, {3.576215927476409*^9, 
   3.576215941311426*^9}, {3.576215990105167*^9, 3.576216026156105*^9}, {
   3.576216064836007*^9, 3.576216065572057*^9}, {3.576217343783297*^9, 
   3.5762173444531*^9}, {3.5762173846284513`*^9, 3.576217385551711*^9}, {
   3.5762174222228928`*^9, 3.576217430317565*^9}, {3.576217832250169*^9, 
   3.576217837178451*^9}, {3.57621794282905*^9, 3.576217973236252*^9}, {
   3.576218059943801*^9, 3.5762180796658297`*^9}, {3.576218129360798*^9, 
   3.5762181407909822`*^9}, {3.576218238735223*^9, 3.57621823959406*^9}, {
   3.576218345371663*^9, 3.576218396823381*^9}, {3.576218450354456*^9, 
   3.576218458681058*^9}, {3.5762184931780167`*^9, 3.576218511618184*^9}, {
   3.576218650819393*^9, 3.576218668954953*^9}, {3.576218746538669*^9, 
   3.5762187970303097`*^9}, {3.576218951885481*^9, 3.576219002099832*^9}, {
   3.576219094461447*^9, 3.576219109658538*^9}, {3.5762191681944942`*^9, 
   3.5762191694169283`*^9}, {3.576219310139923*^9, 3.576219329169121*^9}, {
   3.576219367940628*^9, 3.576219415079692*^9}, {3.57621957183788*^9, 
   3.5762196218929358`*^9}, {3.5762196561788883`*^9, 3.576219663874861*^9}, {
   3.57622004812449*^9, 3.57622006234896*^9}, {3.576220116278512*^9, 
   3.5762202215698442`*^9}, {3.5762204816330233`*^9, 
   3.5762206250606117`*^9}, {3.576220662712875*^9, 3.576220663298085*^9}, {
   3.57622070557204*^9, 3.5762207835089083`*^9}, {3.576222275914914*^9, 
   3.576222318320671*^9}, {3.5762225668968697`*^9, 3.576222621162245*^9}, {
   3.5762226619101458`*^9, 3.576222662618107*^9}, {3.576222706464882*^9, 
   3.576222709084803*^9}, {3.576223104740198*^9, 3.5762231524902*^9}, {
   3.57622318645471*^9, 3.5762233100827847`*^9}, 3.57622334192253*^9, 
   3.5762234396522217`*^9, {3.576223473303012*^9, 3.576223477030285*^9}, {
   3.5762235384548388`*^9, 3.576223762190958*^9}, {3.5762238000976458`*^9, 
   3.576223813337001*^9}, {3.57622387617663*^9, 3.576223914001708*^9}, 
   3.5762239468861*^9, {3.5762240226616297`*^9, 3.576224177345602*^9}, {
   3.576224289448222*^9, 3.576224304651845*^9}, {3.576224419628501*^9, 
   3.576224468256078*^9}, {3.576224534599208*^9, 3.576224666883749*^9}, {
   3.576224805137806*^9, 3.5762248485039043`*^9}, {3.57622489628125*^9, 
   3.576224924313299*^9}, {3.576225277477585*^9, 3.576225301346291*^9}, {
   3.5762253418954887`*^9, 3.576225427579772*^9}, {3.5762317892931337`*^9, 
   3.576231790750937*^9}, {3.5762347778229847`*^9, 3.5762347918481503`*^9}, {
   3.576237237668058*^9, 3.5762372379744463`*^9}, {3.57623757001749*^9, 
   3.57623759725576*^9}, {3.576241960357307*^9, 3.5762419691405582`*^9}, {
   3.5762420073014593`*^9, 3.57624206121124*^9}, {3.5762422606565638`*^9, 
   3.576242306139943*^9}, {3.576242603671438*^9, 3.576242624566773*^9}, {
   3.576243746727086*^9, 3.576243751658803*^9}, {3.576243789635613*^9, 
   3.576243856417708*^9}, {3.576243886511959*^9, 3.576243973027932*^9}, {
   3.576244030042775*^9, 3.576244042303115*^9}, {3.5762441099807043`*^9, 
   3.5762441158048697`*^9}, {3.576303134179438*^9, 3.5763031652114*^9}, {
   3.576306985933362*^9, 3.576307087347661*^9}, {3.576307129380207*^9, 
   3.576307131646267*^9}, 3.576307194322825*^9, {3.5763074782027617`*^9, 
   3.57630755749109*^9}, {3.57630777874529*^9, 3.576307788047255*^9}, {
   3.576307855328994*^9, 3.576307922487919*^9}, {3.576308166645566*^9, 
   3.5763082136985273`*^9}, {3.576308255487319*^9, 3.576308280433248*^9}, {
   3.576315948705303*^9, 3.576316018295106*^9}, {3.576321798611573*^9, 
   3.576321848975234*^9}, {3.576321885051893*^9, 3.5763218858461943`*^9}, {
   3.576321953819397*^9, 3.576322049280579*^9}, {3.5763220914106913`*^9, 
   3.576322188775498*^9}, {3.5763223107799873`*^9, 3.576322397723781*^9}, {
   3.5763230685411882`*^9, 3.576323125880866*^9}, {3.576323917013579*^9, 
   3.57632395693712*^9}, {3.576324069582636*^9, 3.576324072321229*^9}, {
   3.576324489087204*^9, 3.576324504816905*^9}, {3.576325086157404*^9, 
   3.5763252000775023`*^9}, {3.576325232449173*^9, 3.576325237474349*^9}, {
   3.57632654401924*^9, 3.5763266127831087`*^9}, {3.576326810903273*^9, 
   3.576326839613799*^9}, {3.5763268783459187`*^9, 3.576327015702446*^9}, {
   3.576327207225713*^9, 3.5763273171696863`*^9}, {3.576328224119501*^9, 
   3.5763283083866577`*^9}, {3.576328342482373*^9, 3.576328365082905*^9}, {
   3.576328404400139*^9, 3.576328421796439*^9}, {3.576328472109136*^9, 
   3.576328472591237*^9}, {3.576328690205551*^9, 3.5763287245216722`*^9}, 
   3.576328940673818*^9, {3.576328978539794*^9, 3.576329006481028*^9}, {
   3.576843606027224*^9, 3.576843732040822*^9}, {3.5768437911828327`*^9, 
   3.576843818835994*^9}, {3.576843858923519*^9, 3.5768439465760107`*^9}, {
   3.5768439793713093`*^9, 3.5768439839894333`*^9}, {3.576846751762249*^9, 
   3.576846789633905*^9}, {3.576846836233926*^9, 3.576846855828642*^9}, {
   3.576847354836813*^9, 3.57684735590871*^9}, {3.577615393056913*^9, 
   3.57761551732902*^9}, {3.579342501719387*^9, 3.579342574952606*^9}, {
   3.579430856806521*^9, 3.579430924655119*^9}, {3.5794348961123667`*^9, 
   3.5794349349297132`*^9}, {3.5794349681689*^9, 3.579435298437531*^9}, {
   3.5794353491425943`*^9, 3.579435389039843*^9}, 3.579435546228895*^9, {
   3.5794356407750397`*^9, 3.57943564193216*^9}, {3.5794365885887737`*^9, 
   3.579436669189198*^9}, {3.5794372716166058`*^9, 3.579437277415022*^9}, {
   3.579607212601417*^9, 3.579607224518353*^9}, {3.5796073729528913`*^9, 
   3.5796074742978077`*^9}, {3.57967723439417*^9, 3.579677246553935*^9}, {
   3.579678832924945*^9, 3.5796788630068617`*^9}, {3.579685685406399*^9, 
   3.579685930230878*^9}, {3.5796891250330143`*^9, 3.579689127902423*^9}, {
   3.579690335401519*^9, 3.5796903808716288`*^9}, {3.579694233680674*^9, 
   3.579694352811335*^9}, {3.579694407182583*^9, 3.579694439498666*^9}, {
   3.5796945387428293`*^9, 3.579694599241303*^9}, {3.579694653822867*^9, 
   3.579694749139868*^9}, {3.5799555231161337`*^9, 3.579955553319438*^9}, {
   3.579955639743621*^9, 3.5799556659212914`*^9}, {3.5799584998838263`*^9, 
   3.5799586635957193`*^9}, {3.57995878588316*^9, 3.5799588931155157`*^9}, {
   3.580025237936866*^9, 3.5800252463420486`*^9}, {3.5817594826515617`*^9, 
   3.5817594923051977`*^9}, {3.5820299306252127`*^9, 3.582029948157402*^9}, {
   3.582030041865552*^9, 3.582030166465983*^9}, {3.582030269924653*^9, 
   3.5820302832691183`*^9}, 3.5820303265370626`*^9, {3.582030649795182*^9, 
   3.5820306796249027`*^9}, {3.5823512648998218`*^9, 3.582351299120349*^9}, {
   3.5823513537178106`*^9, 3.5823513597024975`*^9}, {3.582351423174545*^9, 
   3.5823514750366073`*^9}, {3.582973670258151*^9, 3.582973753778205*^9}, {
   3.5829768786502476`*^9, 3.582976895197998*^9}, {3.5829769282622538`*^9, 
   3.582976929981089*^9}, {3.58297718318867*^9, 3.582977211596422*^9}, {
   3.5855625840936613`*^9, 3.585562617671673*^9}, {3.5855632189114113`*^9, 
   3.58556322219191*^9}, {3.585563485291739*^9, 3.585563560661895*^9}, {
   3.585564752745022*^9, 3.5855647564780493`*^9}, {3.5855651289920073`*^9, 
   3.585565187075713*^9}, {3.585565252388776*^9, 3.585565278968121*^9}, {
   3.5855653275826187`*^9, 3.585565382603629*^9}, {3.5856394130686617`*^9, 
   3.585639434780405*^9}, {3.585639483326973*^9, 3.585639483629096*^9}, {
   3.585998392322534*^9, 3.585998398990336*^9}, {3.585998431222661*^9, 
   3.585998432590322*^9}, {3.585998632135688*^9, 3.585998655329258*^9}, {
   3.5866074448685913`*^9, 3.586607447018503*^9}, {3.5866074832775793`*^9, 
   3.5866074983497133`*^9}, {3.58686369618256*^9, 3.58686370909735*^9}, {
   3.586863841645384*^9, 3.586863842627022*^9}, {3.586864321000414*^9, 
   3.586864324895154*^9}, 3.586864366985751*^9, {3.586866755485326*^9, 
   3.5868668326806726`*^9}, {3.586869604190463*^9, 3.586869650198533*^9}, 
   3.586870433161932*^9, {3.587288656869013*^9, 3.587288659770417*^9}, {
   3.587293047912929*^9, 3.5872930496851187`*^9}, {3.587297226221148*^9, 
   3.587297264147582*^9}, {3.587301528775989*^9, 3.58730159462719*^9}, {
   3.587302767336502*^9, 3.58730283675079*^9}, {3.58730291731569*^9, 
   3.587302927909011*^9}, {3.587302999945421*^9, 3.587303199136139*^9}, {
   3.587304074510716*^9, 3.58730407496367*^9}, {3.5873046767098503`*^9, 
   3.587304687083124*^9}, {3.587359191878787*^9, 3.587359200442801*^9}, {
   3.587359874448225*^9, 3.587359934878413*^9}, {3.587359991205307*^9, 
   3.587360001821693*^9}, 3.587362504390326*^9, {3.587362544510345*^9, 
   3.587362545088139*^9}, {3.5873641863803177`*^9, 3.5873642065333*^9}, {
   3.587364285738385*^9, 3.587364305648054*^9}, {3.5873644161632233`*^9, 
   3.5873644530265713`*^9}, {3.587364543543462*^9, 3.5873646200314293`*^9}, {
   3.587364762939116*^9, 3.587364766194523*^9}, {3.587371269648548*^9, 
   3.587371280182069*^9}, {3.587371590413313*^9, 3.58737159650354*^9}, {
   3.587380233102644*^9, 3.587380348185586*^9}, {3.5873804147469254`*^9, 
   3.5873804598906384`*^9}, {3.587380570721362*^9, 3.587380624739603*^9}, {
   3.58738067062362*^9, 3.587380671314478*^9}, {3.587380722940173*^9, 
   3.587380747938287*^9}, {3.587380784273748*^9, 3.587380788271497*^9}, {
   3.5873839583509197`*^9, 3.587383986025703*^9}, {3.5873840516580067`*^9, 
   3.587384078907852*^9}, {3.587387282952498*^9, 3.58738728384243*^9}, {
   3.5873874850659103`*^9, 3.587387486332459*^9}, {3.587395448354924*^9, 
   3.587395451630028*^9}, {3.5873965849923487`*^9, 3.5873965862635117`*^9}, {
   3.587456187847877*^9, 3.587456191319253*^9}, {3.587542841997992*^9, 
   3.587542921400832*^9}, {3.5875430458073587`*^9, 3.587543059638785*^9}, {
   3.587819763896347*^9, 3.587819831668365*^9}, {3.587820909914227*^9, 
   3.5878209110812674`*^9}, {3.588487170587174*^9, 3.588487257187992*^9}, {
   3.590140318650488*^9, 3.590140365572927*^9}, {3.590140398712254*^9, 
   3.5901404009343452`*^9}, {3.5901404477877197`*^9, 
   3.5901405441101713`*^9}, {3.590140613382791*^9, 3.5901406194401093`*^9}, {
   3.590140655894506*^9, 3.5901406566250257`*^9}, {3.590140695224309*^9, 
   3.590140711446439*^9}, {3.591604666175776*^9, 3.591604699106963*^9}, {
   3.5986113588283157`*^9, 3.598611417271028*^9}, {3.598611491759286*^9, 
   3.598611502274373*^9}, {3.59861153749197*^9, 3.598611620850712*^9}, {
   3.5986117294906683`*^9, 3.598611743080658*^9}, {3.60585898088905*^9, 
   3.605858983043676*^9}, {3.620393024411577*^9, 3.620393033110076*^9}, {
   3.620393122534042*^9, 3.6203931521918507`*^9}, {3.6203932381511393`*^9, 
   3.620393284410076*^9}, {3.620393457241973*^9, 3.620393458825295*^9}, 
   3.6203934975661573`*^9, {3.620393719979827*^9, 3.620393813847763*^9}, 
   3.6203938667338*^9, {3.620393915093884*^9, 3.620393925979841*^9}, {
   3.620393973998962*^9, 3.620394008328063*^9}, {3.62039419115679*^9, 
   3.6203941919469213`*^9}, 3.620394486832745*^9, 3.620394630337385*^9, {
   3.620394790039661*^9, 3.6203948195114193`*^9}, 3.620395160103352*^9, 
   3.620395530280422*^9, {3.62039559813708*^9, 3.620395598814912*^9}, 
   3.620395639772415*^9, {3.6203957040907793`*^9, 3.6203957045281057`*^9}, {
   3.62039574397104*^9, 3.620395773839658*^9}, {3.620396005149191*^9, 
   3.6203960972862988`*^9}, {3.6203962349589033`*^9, 3.620396257293078*^9}, {
   3.620981465708709*^9, 3.620981556019998*^9}, {3.620981657138266*^9, 
   3.620981663497663*^9}, 3.620991241287923*^9, {3.620994812327745*^9, 
   3.620994900945229*^9}, {3.6209949381741543`*^9, 3.620994950028591*^9}, {
   3.62099538290107*^9, 3.6209954091060133`*^9}, {3.620995439181106*^9, 
   3.620995462683921*^9}, {3.620995494750704*^9, 3.620995496866028*^9}, 
   3.6209955716547956`*^9, {3.620996011272813*^9, 3.620996121557342*^9}, {
   3.620996155475589*^9, 3.620996211669683*^9}, {3.647327741096159*^9, 
   3.6473279004942007`*^9}, 3.6616868958526716`*^9, 3.6616913515181503`*^9, {
   3.6616913971847754`*^9, 3.6616914572889447`*^9}, 3.6617517258379326`*^9, {
   3.661751761045849*^9, 3.6617517629723654`*^9}, {3.6617522676333666`*^9, 
   3.6617522908079767`*^9}, {3.6617531086276145`*^9, 
   3.6617531135398755`*^9}, {3.661753153477132*^9, 3.6617531627600293`*^9}, {
   3.6617591224922295`*^9, 3.66175913476531*^9}, {3.661766060571831*^9, 
   3.6617660749719133`*^9}, {3.661775588198186*^9, 3.661775624496746*^9}, {
   3.661775772728195*^9, 3.6617758522627964`*^9}, {3.661854582867503*^9, 
   3.661854603581808*^9}, {3.6621161309735107`*^9, 3.6621162083981752`*^9}, 
   3.6621170377989798`*^9, {3.6621171151769876`*^9, 3.6621171396140523`*^9}, {
   3.6621171753239584`*^9, 3.662117209899497*^9}, {3.6621241004004955`*^9, 
   3.662124117260113*^9}, {3.6621253957044916`*^9, 3.6621254266957207`*^9}, {
   3.6621881481600285`*^9, 3.66218817452687*^9}, {3.662201740242825*^9, 
   3.6622017597209077`*^9}, {3.662203784992427*^9, 3.6622037899330816`*^9}, {
   3.662287726843808*^9, 3.662287785972896*^9}, {3.66244364371959*^9, 
   3.6624436726703053`*^9}, {3.6624437086683054`*^9, 3.662443763291527*^9}, {
   3.6624440679968176`*^9, 3.6624440955020547`*^9}}]
}, Closed]]
},
WindowSize->{1366, 685},
WindowMargins->{{-8, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.2 for Microsoft Windows (64-bit) (July 7, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 256, 6, 52, "Input"],
Cell[CellGroupData[{
Cell[839, 30, 272, 6, 31, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1114, 38, 7138, 181, 235, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]],
Cell[CellGroupData[{
Cell[8289, 224, 410, 10, 25, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.}],
Cell[8702, 236, 5164, 143, 235, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.}]
}, Closed]],
Cell[CellGroupData[{
Cell[13903, 384, 386, 9, 25, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.}],
Cell[14292, 395, 3665, 110, 215, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.}]
}, Closed]],
Cell[CellGroupData[{
Cell[17994, 510, 362, 9, 25, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[18359, 521, 3201, 85, 176, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]],
Cell[CellGroupData[{
Cell[21597, 611, 326, 7, 25, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.}],
Cell[21926, 620, 2621, 86, 215, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.}]
}, Closed]],
Cell[CellGroupData[{
Cell[24584, 711, 656, 17, 25, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10004.}],
Cell[25243, 730, 3740, 111, 215, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10004.}]
}, Closed]],
Cell[CellGroupData[{
Cell[29020, 846, 265, 6, 25, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10003.}],
Cell[29288, 854, 8279, 218, 315, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10003.}]
}, Closed]],
Cell[CellGroupData[{
Cell[37604, 1077, 381, 9, 25, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10004.}],
Cell[37988, 1088, 1926, 63, 215, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10004.}]
}, Closed]],
Cell[CellGroupData[{
Cell[39951, 1156, 370, 8, 25, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[40324, 1166, 2998, 91, 235, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]],
Cell[CellGroupData[{
Cell[43359, 1262, 321, 6, 25, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.}],
Cell[43683, 1270, 2853, 77, 212, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.}]
}, Closed]],
Cell[46551, 1350, 90, 1, 25, "Input"],
Cell[CellGroupData[{
Cell[46666, 1355, 208, 4, 31, "Input"],
Cell[46877, 1361, 87025, 1797, 540, 42273, 1062, "CachedBoxData", "BoxData", \
"Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[133939, 3163, 835, 25, 31, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[134777, 3190, 4228, 103, 232, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[139008, 3295, 4324, 104, 232, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[143335, 3401, 10431, 218, 872, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[153769, 3621, 16672, 361, 1512, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[170444, 3984, 4625, 101, 412, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[175072, 4087, 3282, 75, 372, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]],
Cell[178369, 4165, 243, 3, 25, "Input"],
Cell[CellGroupData[{
Cell[178637, 4172, 273, 5, 31, "Input"],
Cell[178913, 4179, 227, 3, 31, "Output"]
}, Open  ]],
Cell[179155, 4185, 226, 3, 31, "Input"],
Cell[CellGroupData[{
Cell[179406, 4192, 849, 25, 31, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[180258, 4219, 19796, 478, 1562, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Open  ]],
Cell[200069, 4700, 194, 3, 31, "Input"],
Cell[CellGroupData[{
Cell[200288, 4707, 779, 13, 31, "Input"],
Cell[201070, 4722, 1616, 36, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[202723, 4763, 667, 11, 31, "Input"],
Cell[203393, 4776, 1362, 34, 31, "Output"]
}, Open  ]],
Cell[204770, 4813, 94, 1, 31, "Input"],
Cell[CellGroupData[{
Cell[204889, 4818, 475, 6, 30, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[205367, 4826, 788873, 18858, 49346, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]]
}
]
*)

(* End of internal cache information *)
