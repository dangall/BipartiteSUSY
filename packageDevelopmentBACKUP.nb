(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    920570,      22502]
NotebookOptionsPosition[    914516,      22337]
NotebookOutlinePosition[    915026,      22357]
CellTagsIndexPosition[    914983,      22354]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "bipartiteSUSY.m"}]}], "Input",
 PageWidth->WindowWidth,
 CellChangeTimes->{{3.6616922986967053`*^9, 3.661692334211833*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"This", " ", "is", " ", "a", " ", "planar", " ", "example"}], 
  "*)"}]], "Input",
 PageWidth->WindowWidth,
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.6617747389072857`*^9, {3.6617752199012136`*^9, 3.6617752384313593`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"formatrule", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["XX_", 
      RowBox[{"z1_", ",", "z2_"}]], "\[Rule]", 
     RowBox[{"XX", "[", 
      RowBox[{"z1", ",", "z2"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aa", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"1", ",", "7"}]], 
        RowBox[{"(*", 
         RowBox[{"+", 
          SubscriptBox["X", 
           RowBox[{"7", ",", "7"}]]}], "*)"}], ",", 
        SubscriptBox["X", 
         RowBox[{"2", ",", "1"}]], 
        RowBox[{"(*", 
         RowBox[{
          SubscriptBox["X", 
           RowBox[{"2", ",", "100"}]], "+", 
          SubscriptBox["Y", 
           RowBox[{"100", ",", "200"}]], "+", 
          SubscriptBox["X", 
           RowBox[{"200", ",", "1"}]]}], "*)"}], ",", 
        SubscriptBox["X", 
         RowBox[{"3", ",", "2"}]], 
        RowBox[{"(*", 
         RowBox[{"+", 
          SubscriptBox["X", 
           RowBox[{"2", ",", "1"}]]}], "*)"}], 
        RowBox[{"(*", 
         RowBox[{"+", 
          SubscriptBox["Z", "30"]}], "*)"}], ",", 
        SubscriptBox["X", 
         RowBox[{"8", ",", "3"}]], 
        RowBox[{"(*", 
         RowBox[{"+", 
          SubscriptBox["X", 
           RowBox[{"8", ",", "3"}]]}], "*)"}], ",", "0", ",", "0", ",", "0"}],
        "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"13", ",", "1"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"1", ",", "4"}]], ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"4", ",", "13"}]], ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        SubscriptBox["X", 
         RowBox[{"4", ",", "2"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"2", ",", "5"}]], ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"5", ",", "4"}]], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"5", ",", "3"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"3", ",", "6"}]], ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"6", ",", "5"}]]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"12", ",", "4"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"4", ",", "11"}]], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"11", ",", "5"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"5", ",", "10"}]]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"6", ",", "9"}]], ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"10", ",", "6"}]]}], "}"}]}], "}"}], "/.", "formatrule"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bb", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"7", ",", "8"}]]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"11", ",", "12"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        SubscriptBox["X", 
         RowBox[{"10", ",", "11"}]], ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"9", ",", "10"}]], ",", "0"}], "}"}]}], "}"}], "/.", 
    "formatrule"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"7", ",", "13"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
        ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"9", ",", "8"}]], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"13", ",", "12"}]], ",", "0", ",", "0"}], "}"}]}], "}"}], "/.",
     "formatrule"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dd", "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], "/.", 
     "formatrule"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"topleft", "=", "aa"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"topright", "=", "bb"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bottomleft", "=", "cc"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bottomright", "=", "dd"}], ";"}]}], "Input",
 PageWidth->WindowWidth,
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.661768152279539*^9, 3.6617682070619636`*^9}, {
   3.661774734306241*^9, 3.6617747389077854`*^9}, {3.6617752199012136`*^9, 
   3.6617752384313593`*^9}, {3.6617792078461504`*^9, 3.6617792164162493`*^9}, 
   3.6618480142415557`*^9, 3.661848446017182*^9, {3.6618552249200983`*^9, 
   3.6618552265381966`*^9}, {3.661855261051271*^9, 3.6618553195379095`*^9}, {
   3.6618553565402327`*^9, 3.661855403134297*^9}, {3.66185591508606*^9, 
   3.6618559194691763`*^9}, 3.6618559759441557`*^9, 3.6618563248825703`*^9, 
   3.6618564442265024`*^9, {3.661856630895452*^9, 3.66185665717612*^9}, 
   3.6618567504434385`*^9, 3.661857125236326*^9, 3.661857243437956*^9, {
   3.6618573840060997`*^9, 3.6618573897571115`*^9}, {3.6618583582979946`*^9, 
   3.6618583709773593`*^9}, {3.661859440960431*^9, 3.661859442023737*^9}, {
   3.6618618165453277`*^9, 3.661861856700989*^9}, {3.6618619749549227`*^9, 
   3.6618619751086197`*^9}, {3.6618623835768223`*^9, 3.661862409858626*^9}, {
   3.6618625640333376`*^9, 3.6618625656505203`*^9}, {3.6618626495218782`*^9, 
   3.661862650808232*^9}, {3.6618629823303156`*^9, 3.6618630223085847`*^9}, {
   3.661863274557538*^9, 3.661863340611631*^9}, {3.6618658125815916`*^9, 
   3.661865928625715*^9}, 3.661866082529149*^9, {3.662099231769846*^9, 
   3.6620992328449216`*^9}, 3.662114969467435*^9, {3.6621150283796463`*^9, 
   3.662115043976282*^9}, 3.662115098818657*^9, 3.6621235783901234`*^9, {
   3.6621237205097446`*^9, 3.6621238138351326`*^9}, {3.6622035277936273`*^9, 
   3.6622036286946964`*^9}, 3.662275696648489*^9, 3.6622757658807836`*^9, {
   3.6622768051131735`*^9, 3.662276812093757*^9}, {3.6622777279171143`*^9, 
   3.6622777364208946`*^9}, 3.6622817983167496`*^9, 3.662285014252096*^9, 
   3.662387804407296*^9, 3.6623878535149612`*^9, {3.667658260731026*^9, 
   3.6676583072873363`*^9}, {3.667660909839994*^9, 3.6676609167822695`*^9}, 
   3.6682497986055903`*^9, 3.6701546125825787`*^9, {3.670221260412598*^9, 
   3.670221290849084*^9}, {3.670221327297327*^9, 3.6702213384201374`*^9}, {
   3.670232684853531*^9, 3.670232686659317*^9}, 3.6702335975204*^9, {
   3.6702421138947983`*^9, 3.670242139233144*^9}, {3.670311195048809*^9, 
   3.6703111982170053`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"This", " ", "is", " ", "a", " ", "non"}], "-", 
   RowBox[{
   "planar", " ", "example", " ", "with", " ", "secret", " ", "poles"}]}], 
  "*)"}]], "Input",
 PageWidth->WindowWidth,
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 CellChangeTimes->{
  3.6617747675998573`*^9, {3.6617752199012136`*^9, 3.6617752548205633`*^9}, {
   3.6617753549957905`*^9, 3.661775364335918*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"formatrule", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["XX_", 
      RowBox[{"z1_", ",", "z2_"}]], "\[Rule]", 
     RowBox[{"XX", "[", 
      RowBox[{"z1", ",", "z2"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aa", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"8", ",", "1"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"1", ",", "7"}]], 
        RowBox[{"(*", 
         RowBox[{"+", 
          SubscriptBox["Y", 
           RowBox[{"1", ",", "700"}]]}], "*)"}], ",", "0", ",", "0", ",", "0",
         ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        SubscriptBox["X", 
         RowBox[{"2", ",", "1"}]], 
        RowBox[{"(*", 
         RowBox[{"+", 
          SubscriptBox["X", 
           RowBox[{"2", ",", "100"}]]}], "*)"}], ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"4", ",", "2"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"1", ",", "4"}]]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"1", ",", "9"}]], ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"9", ",", "3"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"3", ",", "6"}]], ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"6", ",", "1"}]]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        SubscriptBox["X", 
         RowBox[{"7", ",", "2"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"3", ",", "7"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"2", ",", "3"}]], ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"6", ",", "2"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"2", ",", "5"}]], ",", "0"}], "}"}]}], "}"}], "/.", 
    "formatrule"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bb", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"7", ",", "8"}]], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        SubscriptBox["X", 
         RowBox[{"5", ",", "6"}]]}], "}"}]}], "}"}], "/.", "formatrule"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"9", ",", "8"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
        ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"7", ",", "9"}]], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"4", ",", "6"}]]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"5", ",", "4"}]], ",", "0"}], "}"}]}], "}"}], "/.", 
    "formatrule"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dd", "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "}"}], "/.", "formatrule"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"topleft", "=", "aa"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"topright", "=", "bb"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bottomleft", "=", "cc"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bottomright", "=", "dd"}], ";"}]}], "Input",
 PageWidth->WindowWidth,
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 CellChangeTimes->{{3.661759206605352*^9, 3.661759358643527*^9}, {
   3.661759930919339*^9, 3.6617599612497854`*^9}, {3.6617747579587717`*^9, 
   3.6617747675998573`*^9}, 3.6617752548205633`*^9, {3.661775354996293*^9, 
   3.66177536433642*^9}, 3.6618475958631124`*^9, {3.66184780359737*^9, 
   3.661847859584677*^9}, {3.66209923804358*^9, 3.6620992382935896`*^9}, {
   3.6622777440979004`*^9, 3.6622777650781717`*^9}, {3.662277846139641*^9, 
   3.662277861116992*^9}, {3.662285045911174*^9, 3.6622850590586057`*^9}, 
   3.662288387431682*^9, {3.662288683649874*^9, 3.6622886921119223`*^9}, {
   3.6622898064182396`*^9, 3.66228982513911*^9}, {3.662290916561075*^9, 
   3.6622909190055537`*^9}, 3.662293117676606*^9, 3.662293242519805*^9, 
   3.66229335572449*^9, 3.6622934346331215`*^9, {3.6623014874567614`*^9, 
   3.662301512775009*^9}, {3.6623015510421534`*^9, 3.662301555246936*^9}, {
   3.662301595399434*^9, 3.662301599011793*^9}, 3.6623649216569767`*^9, 
   3.6623651815366383`*^9, {3.662810160123227*^9, 3.6628101790488024`*^9}, {
   3.662810309285664*^9, 3.662810320630292*^9}, 3.6702398756773553`*^9, 
   3.670241123137061*^9, 3.670242099588305*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"This", " ", "is", " ", "another", " ", "non"}], "-", 
   RowBox[{
   "planar", " ", "example", " ", "with", " ", "secret", " ", "poles"}]}], 
  "*)"}]], "Input",
 PageWidth->WindowWidth,
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 CellChangeTimes->{{3.6617751562774353`*^9, 3.6617751755016255`*^9}, {
  3.661775354996293*^9, 3.661775376089506*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"formatrule", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["XX_", 
      RowBox[{"z1_", ",", "z2_"}]], "\[Rule]", 
     RowBox[{"XX", "[", 
      RowBox[{"z1", ",", "z2"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aa", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"3", ",", "9"}]], ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"6", ",", "3"}]], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"8", ",", "3"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"2", ",", "8"}]], ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"3", ",", "2"}]]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        SubscriptBox["X", 
         RowBox[{"7", ",", "1"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"1", ",", "6"}]], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        SubscriptBox["X", 
         RowBox[{"1", ",", "2"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"5", ",", "1"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"2", ",", "4"}]]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"3", ",", "5"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"4", ",", "3"}]]}], "}"}]}], "}"}], "/.", "formatrule"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bb", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"9", ",", "6"}]], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        SubscriptBox["X", 
         RowBox[{"6", ",", "7"}]], ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"4", ",", "5"}]]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"5", ",", "4"}]], ",", "0"}], "}"}]}], "}"}], "/.", 
    "formatrule"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"9", ",", "8"}]], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        SubscriptBox["X", 
         RowBox[{"8", ",", "7"}]], ",", "0", ",", "0"}], "}"}]}], "}"}], "/.",
     "formatrule"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dd", "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], "/.", 
     "formatrule"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"topleft", "=", "aa"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"topright", "=", "bb"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bottomleft", "=", "cc"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bottomright", "=", "dd"}], ";"}]}], "Input",
 PageWidth->WindowWidth,
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 CellChangeTimes->{{3.661775166051606*^9, 3.6617751755016255`*^9}, {
   3.661775354996293*^9, 3.661775376089506*^9}, {3.661847862533332*^9, 
   3.6618478943936143`*^9}, {3.6620992492607956`*^9, 3.662099249526434*^9}, {
   3.6641065831775303`*^9, 3.664106586046159*^9}, {3.6641066806842337`*^9, 
   3.6641066849215813`*^9}, 3.664114653272419*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"This", " ", "is", " ", "a", " ", "non"}], "-", 
   RowBox[{
   "planar", " ", "example", " ", "without", " ", "secret", " ", "poles"}]}], 
  "*)"}]], "Input",
 PageWidth->WindowWidth,
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6617750063834705`*^9, 3.6617750065439873`*^9}, 
   3.6617750660711355`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"aa", ",", "bb", ",", "cc", ",", "dd"}], "}"}], "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Z", "10"], ",", 
           SubscriptBox["Z", "1"], ",", "0", ",", 
           SubscriptBox["Z", "7"], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["Z", "12"], ",", 
           SubscriptBox["Z", "2"], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["Z", "14"], ",", 
           SubscriptBox["Z", "15"], ",", "0", ",", 
           SubscriptBox["Z", "4"]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["Z", "16"], ",", 
           SubscriptBox["Z", "3"], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Z", "9"], ",", 
           SubscriptBox["Z", "18"], ",", "0", ",", "0", ",", 
           SubscriptBox["Z", "19"]}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Z", "13"], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["Z", "17"], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["Z", "5"]}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Z", "21"], ",", "0", ",", "0", ",", "0", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["Z", "8"], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["Z", "6"]}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "}"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["XX_", "z1_"], "\[Rule]", 
       RowBox[{"XX", "[", "z1", "]"}]}], "}"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"topleft", "=", "aa"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"topright", "=", "bb"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bottomleft", "=", "cc"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bottomright", "=", "dd"}], ";"}]}], "Input",
 PageWidth->WindowWidth,
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6617749845034676`*^9, 3.6617749924638643`*^9}, {
  3.6617750568597474`*^9, 3.661775066071638*^9}, {3.661847902785837*^9, 
  3.661847919578432*^9}, {3.662099253065173*^9, 3.6620992533464346`*^9}, {
  3.6699789364493446`*^9, 3.669978937372786*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "This", " ", "is", " ", "the", " ", "normal", " ", "square", " ", "box"}], 
  "*)"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 CellChangeTimes->{{3.668774489320018*^9, 3.66877449515077*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"formatrule", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["XX_", 
      RowBox[{"z1_", ",", "z2_"}]], "\[Rule]", 
     RowBox[{"XX", "[", 
      RowBox[{"z1", ",", "z2"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aa", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"1", ",", "2"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"3", ",", "1"}]]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"5", ",", "1"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"1", ",", "4"}]]}], "}"}]}], "}"}], "/.", "formatrule"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bb", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"2", ",", "3"}]], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        SubscriptBox["X", 
         RowBox[{"4", ",", "5"}]]}], "}"}]}], "}"}], "/.", "formatrule"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"2", ",", "5"}]], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        SubscriptBox["X", 
         RowBox[{"4", ",", "3"}]]}], "}"}]}], "}"}], "/.", "formatrule"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dd", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"topleft", "=", "aa"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"topright", "=", "bb"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bottomleft", "=", "cc"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bottomright", "=", "dd"}], ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 CellChangeTimes->{{3.6687744951517715`*^9, 3.668774508834071*^9}, {
  3.668861112097895*^9, 3.6688611139574504`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "This", " ", "is", " ", "the", " ", "planar", " ", "double", " ", "square", 
   " ", "box"}], "*)"}]], "Input",
 PageWidth->WindowWidth,
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 CellChangeTimes->{{3.662301648989788*^9, 3.6623016629143643`*^9}, {
  3.662301706072893*^9, 3.6623017104741435`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"formatrule", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["XX_", 
      RowBox[{"z1_", ",", "z2_"}]], "\[Rule]", 
     RowBox[{"XX", "[", 
      RowBox[{"z1", ",", "z2"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aa", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"3", ",", "1"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"1", ",", "2"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"2", ",", "3"}]]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"1", ",", "4"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"5", ",", "1"}]], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        SubscriptBox["X", 
         RowBox[{"2", ",", "5"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"6", ",", "2"}]]}], "}"}]}], "}"}], "/.", "formatrule"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bb", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        SubscriptBox["X", 
         RowBox[{"4", ",", "5"}]]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"5", ",", "6"}]], ",", "0"}], "}"}]}], "}"}], "/.", 
    "formatrule"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"3", ",", "6"}]]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"4", ",", "3"}]], ",", "0", ",", "0"}], "}"}]}], "}"}], "/.",
     "formatrule"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dd", "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "}"}], "/.", "formatrule"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"topleft", "=", "aa"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"topright", "=", "bb"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bottomleft", "=", "cc"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bottomright", "=", "dd"}], ";"}]}], "Input",
 PageWidth->WindowWidth,
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 CellChangeTimes->{{3.6623016671663923`*^9, 3.6623017104741435`*^9}, {
   3.668509503755599*^9, 3.668509514020112*^9}, 3.668518113549163*^9, {
   3.66876381529138*^9, 3.6687638356799545`*^9}, {3.6687638718818107`*^9, 
   3.668763875937354*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Has", " ", "3", " ", "boundaries"}], ",", " ", 
   RowBox[{"but", " ", "is", " ", 
    RowBox[{"reducible", ".", " ", 
     RowBox[{"It", "'"}]}], "s", " ", "a", " ", "top", " ", "cell", " ", "of",
     " ", "Gr", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"3", ",", "5"}], ")"}], ".", " ", 
     RowBox[{"It", "'"}]}], "s", " ", 
    RowBox[{"a", " ", "'"}], 
    RowBox[{"reduction", "'"}], " ", "of", " ", "the", " ", "monster", " ", 
    "guy", " ", 
    RowBox[{"below", "."}]}]}], "*)"}]], "Input",
 PageWidth->WindowWidth,
 CellGroupingRules->{GroupTogetherGrouping, 10004.},
 CellChangeTimes->{3.662361848753731*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"formatrule", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["XX_", 
      RowBox[{"z1_", ",", "z2_"}]], "\[Rule]", 
     RowBox[{"XX", "[", 
      RowBox[{"z1", ",", "z2"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aa", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"7", ",", "1"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"1", ",", "6"}]], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"1", ",", "3"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"3", ",", "1"}]], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"3", ",", "7"}]], ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"4", ",", "3"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"7", ",", "4"}]], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        SubscriptBox["X", 
         RowBox[{"6", ",", "3"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"3", ",", "5"}]], ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"5", ",", "8"}]]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"4", ",", "2"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"2", ",", "5"}]]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"2", ",", "7"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"8", ",", "2"}]]}], "}"}]}], "}"}], "/.", "formatrule"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bb", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"6", ",", "7"}]], ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"3", ",", "3"}]], ",", "0", ",", "0", ",", "0", ",", "0"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"8", ",", "6"}]]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        SubscriptBox["Y", 
         RowBox[{"5", ",", "4"}]], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"7", ",", "8"}]], ",", "0"}], "}"}]}], "}"}], "/.", 
    "formatrule"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       SubscriptBox["X", 
        RowBox[{"5", ",", "4"}]], ",", "0", ",", "0"}], "}"}], "}"}], "/.", 
    "formatrule"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dd", "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], "}"}], "/.",
      "formatrule"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"topleft", "=", "aa"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"topright", "=", "bb"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bottomleft", "=", "cc"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bottomright", "=", "dd"}], ";"}]}], "Input",
 PageWidth->WindowWidth,
 CellGroupingRules->{GroupTogetherGrouping, 10004.},
 CellChangeTimes->{{3.6623618187225723`*^9, 3.662361848753731*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Monster", " ", "guy", " ", "with", " ", "intrinsically", " ", "3", " ", 
   RowBox[{"boundaries", "."}]}], "*)"}]], "Input",
 PageWidth->WindowWidth,
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 CellChangeTimes->{3.6623595961544695`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"formatrule", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["XX_", 
      RowBox[{"z1_", ",", "z2_"}]], "\[Rule]", 
     RowBox[{"XX", "[", 
      RowBox[{"z1", ",", "z2"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aa", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"2", ",", "1"}]], ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"1", ",", "7"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"11", ",", "2"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
        ",", 
        SubscriptBox["X", 
         RowBox[{"7", ",", "11"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
        ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"1", ",", "3"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"4", ",", "1"}]], ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"3", ",", "11"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"11", ",", "4"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
        ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        SubscriptBox["X", 
         RowBox[{"1", ",", "5"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"6", ",", "1"}]], ",", "0", ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"5", ",", "11"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"11", ",", "6"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
        ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"3", ",", "2"}]], ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"2", ",", "8"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"8", ",", "3"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
        ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        SubscriptBox["X", 
         RowBox[{"5", ",", "4"}]], ",", "0", ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"4", ",", "9"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"9", ",", "5"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
        ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"7", ",", "6"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
        ",", 
        SubscriptBox["X", 
         RowBox[{"6", ",", "10"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"10", ",", "7"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
        ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"8", ",", "11"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
        ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"12", ",", "8"}]], ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"11", ",", "12"}]], ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"11", ",", "8"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
        ",", 
        SubscriptBox["X", 
         RowBox[{"8", ",", "13"}]], ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"13", ",", "11"}]], ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"9", ",", "11"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
        ",", 
        SubscriptBox["X", 
         RowBox[{"14", ",", "9"}]], ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"11", ",", "14"}]], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"11", ",", "9"}]], ",", "0", ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"9", ",", "15"}]], ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"15", ",", "11"}]], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"10", ",", "11"}]], ",", "0", ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"16", ",", "10"}]], ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"11", ",", "16"}]]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", 
        SubscriptBox["X", 
         RowBox[{"11", ",", "10"}]], ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"10", ",", "17"}]], ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"17", ",", "11"}]]}], "}"}]}], "}"}], "/.", "formatrule"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bb", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "}"}], ",", 
      RowBox[{"{", "}"}], ",", 
      RowBox[{"{", "}"}], ",", 
      RowBox[{"{", "}"}], ",", 
      RowBox[{"{", "}"}], ",", 
      RowBox[{"{", "}"}], ",", 
      RowBox[{"{", "}"}], ",", 
      RowBox[{"{", "}"}], ",", 
      RowBox[{"{", "}"}], ",", 
      RowBox[{"{", "}"}], ",", 
      RowBox[{"{", "}"}], ",", 
      RowBox[{"{", "}"}]}], "}"}], "/.", "formatrule"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"13", ",", "12"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
        ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"12", ",", "13"}]], ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"15", ",", "14"}]], ",", "0", ",", "0", ",", "0", ",", "0"}],
        "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"14", ",", "15"}]], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"17", ",", "16"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"16", ",", "17"}]]}], "}"}]}], "}"}], "/.", "formatrule"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dd", "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", "}"}]}], "}"}], "/.", "formatrule"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"topleft", "=", "aa"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"topright", "=", "bb"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bottomleft", "=", "cc"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bottomright", "=", "dd"}], ";"}]}], "Input",
 PageWidth->WindowWidth,
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 CellChangeTimes->{{3.662359555768058*^9, 3.6623595961544695`*^9}, 
   3.66288458353869*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"This", " ", "is", " ", "a", " ", "dimer", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"no", " ", "boundaries"}], ",", " ", 
     RowBox[{"genus", " ", "1"}]}], ")"}]}], "*)"}]], "Input",
 PageWidth->WindowWidth,
 CellGroupingRules->{GroupTogetherGrouping, 10004.},
 CellChangeTimes->{{3.6624580361125507`*^9, 3.6624580509248238`*^9}, 
   3.662458099242345*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"formatrule", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["XX_", 
      RowBox[{"z1_", ",", "z2_"}]], "\[Rule]", 
     RowBox[{"XX", "[", 
      RowBox[{"z1", ",", "z2"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aa", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         SubscriptBox["X", 
          RowBox[{"3", ",", "4"}]], "+", 
         SubscriptBox["X", 
          RowBox[{"2", ",", "1"}]]}], ",", 
        RowBox[{
         SubscriptBox["X", 
          RowBox[{"1", ",", "3"}]], "+", 
         SubscriptBox["X", 
          RowBox[{"4", ",", "2"}]]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         SubscriptBox["Y", 
          RowBox[{"1", ",", "3"}]], "+", 
         SubscriptBox["Y", 
          RowBox[{"4", ",", "2"}]]}], ",", 
        RowBox[{
         SubscriptBox["Y", 
          RowBox[{"2", ",", "1"}]], "+", 
         SubscriptBox["Y", 
          RowBox[{"3", ",", "4"}]]}]}], "}"}]}], "}"}], "/.", 
    "formatrule"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bb", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dd", "=", 
    RowBox[{"{", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"topleft", "=", "aa"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"topright", "=", "bb"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bottomleft", "=", "cc"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bottomright", "=", "dd"}], ";"}]}], "Input",
 PageWidth->WindowWidth,
 CellGroupingRules->{GroupTogetherGrouping, 10004.},
 CellChangeTimes->{{3.6624580938513813`*^9, 3.662458099242345*^9}, {
  3.670309819823392*^9, 3.670309842229667*^9}, {3.670310250684775*^9, 
  3.670310290780529*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"This", " ", "is", " ", "a", " ", "larger", " ", "dimer", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"no", " ", "boundaries"}], ",", " ", 
     RowBox[{"genus", " ", "1"}]}], ")"}]}], "*)"}]], "Input",
 PageWidth->WindowWidth,
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6624580361125507`*^9, 3.6624580879321213`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"formatrule", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["XX_", 
      RowBox[{"z1_", ",", "z2_"}]], "\[Rule]", 
     RowBox[{"XX", "[", 
      RowBox[{"z1", ",", "z2"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aa", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"3", ",", "5"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"5", ",", "2"}]], ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"2", ",", "3"}]], ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        SubscriptBox["X", 
         RowBox[{"2", ",", "4"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"4", ",", "1"}]], ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"1", ",", "2"}]], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"6", ",", "3"}]], ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"1", ",", "6"}]], ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"3", ",", "1"}]]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"5", ",", "6"}]], ",", "0", ",", "0", ",", 
        SubscriptBox["Y", 
         RowBox[{"3", ",", "5"}]], ",", "0", ",", 
        SubscriptBox["Y", 
         RowBox[{"6", ",", "3"}]]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        SubscriptBox["X", 
         RowBox[{"4", ",", "5"}]], ",", "0", ",", 
        SubscriptBox["Y", 
         RowBox[{"5", ",", "2"}]], ",", 
        SubscriptBox["Y", 
         RowBox[{"2", ",", "4"}]], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"6", ",", "4"}]], ",", "0", ",", 
        SubscriptBox["Y", 
         RowBox[{"4", ",", "1"}]], ",", 
        SubscriptBox["Y", 
         RowBox[{"1", ",", "6"}]]}], "}"}]}], "}"}], "/.", "formatrule"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bb", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dd", "=", 
    RowBox[{"{", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"topleft", "=", "aa"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"topright", "=", "bb"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bottomleft", "=", "cc"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bottomright", "=", "dd"}], ";"}]}], "Input",
 PageWidth->WindowWidth,
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6624580795945396`*^9, 3.6624580879321213`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Y6", ",", 
   RowBox[{
   "0", " ", "with", " ", "TWO", " ", "boundaries", " ", "each", " ", 
    "cutting", " ", "ONE", " ", 
    RowBox[{"line", "."}]}]}], "*)"}]], "Input",
 PageWidth->WindowWidth,
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 CellChangeTimes->{3.6646175401935253`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"formatrule", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["XX_", 
      RowBox[{"z1_", ",", "z2_"}]], "\[Rule]", 
     RowBox[{"XX", "[", 
      RowBox[{"z1", ",", "z2"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aa", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"7", ",", "1"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"2", ",", "8"}]], ",", "0", ",", 
        RowBox[{
         SubscriptBox["X", 
          RowBox[{"1", ",", "2"}]], "+", 
         SubscriptBox["X", 
          RowBox[{"8", ",", "7"}]]}], ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        SubscriptBox["X", 
         RowBox[{"9", ",", "3"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"4", ",", "10"}]], ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"3", ",", "4"}]], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"6", ",", "12"}]], ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"11", ",", "5"}]], ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"5", ",", "6"}]]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         SubscriptBox["X", 
          RowBox[{"1", ",", "6"}]], "+", 
         SubscriptBox["X", 
          RowBox[{"12", ",", "7"}]]}], ",", "0", ",", "0", ",", 
        SubscriptBox["Y", 
         RowBox[{"7", ",", "1"}]], ",", "0", ",", 
        SubscriptBox["Y", 
         RowBox[{"6", ",", "12"}]]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{
         SubscriptBox["X", 
          RowBox[{"3", ",", "2"}]], "+", 
         SubscriptBox["X", 
          RowBox[{"8", ",", "9"}]]}], ",", "0", ",", 
        SubscriptBox["Y", 
         RowBox[{"2", ",", "8"}]], ",", 
        SubscriptBox["Y", 
         RowBox[{"9", ",", "3"}]], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        RowBox[{
         SubscriptBox["X", 
          RowBox[{"5", ",", "4"}]], "+", 
         SubscriptBox["X", 
          RowBox[{"10", ",", "11"}]]}], ",", "0", ",", 
        SubscriptBox["Y", 
         RowBox[{"4", ",", "10"}]], ",", 
        SubscriptBox["Y", 
         RowBox[{"11", ",", "5"}]]}], "}"}]}], "}"}], "/.", "formatrule"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bb", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        SubscriptBox["X", 
         RowBox[{"10", ",", "9"}]]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"12", ",", "11"}]], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}]}], "}"}], "/.", "formatrule"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        SubscriptBox["Y", 
         RowBox[{"12", ",", "11"}]]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
        SubscriptBox["Y", 
         RowBox[{"10", ",", "9"}]], ",", "0"}], "}"}]}], "}"}], "/.", 
    "formatrule"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dd", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"topleft", "=", "aa"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"topright", "=", "bb"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bottomleft", "=", "cc"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bottomright", "=", "dd"}], ";"}]}], "Input",
 PageWidth->WindowWidth,
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 CellChangeTimes->{{3.6646175013320694`*^9, 3.6646175401935253`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   SubscriptBox["bft", "29"], ",", " ", 
   RowBox[{
    RowBox[{"i", ".", "e", ".", " ", "the"}], " ", "nonplanar", " ", "G", 
    RowBox[{"(", 
     RowBox[{"3", ",", "6"}], ")"}], " ", "example", " ", "where", " ", 
    "secret", " ", "poles", " ", "first", " ", "appear", " ", "lower", " ", 
    "down", " ", "in", " ", "the", " ", "stratification"}]}], "*)"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10004.},
 CellChangeTimes->{{3.6685100572577324`*^9, 3.6685100917869563`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"formatrule", "=", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["XX_", 
       RowBox[{"z1_", ",", "z2_"}]], "\[Rule]", 
      RowBox[{"XX", "[", 
       RowBox[{"z1", ",", "z2"}], "]"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aa", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"4", ",", "1"}]], ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"1", ",", "6"}]], 
        RowBox[{"(*", 
         RowBox[{"+", 
          SubscriptBox["X", 
           RowBox[{"100", ",", "101"}]]}], "*)"}], ",", "0", ",", "0", ",", 
        "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"2", ",", "4"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"5", ",", "2"}]], ",", "0", ",", "0", ",", "0", ",", "0"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        SubscriptBox["X", 
         RowBox[{"3", ",", "5"}]], 
        RowBox[{"(*", 
         RowBox[{"+", 
          SubscriptBox["X", 
           RowBox[{"200", ",", "202"}]]}], "*)"}], ",", 
        SubscriptBox["X", 
         RowBox[{"6", ",", "3"}]], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"1", ",", "2"}]], ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"7", ",", "1"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"2", ",", "7"}]], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        SubscriptBox["X", 
         RowBox[{"2", ",", "3"}]], ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"8", ",", "2"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"3", ",", "8"}]]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"3", ",", "1"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"1", ",", "9"}]], ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"9", ",", "3"}]]}], "}"}]}], "}"}], "/.", "formatrule"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bb", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"6", ",", "4"}]], ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        SubscriptBox["X", 
         RowBox[{"4", ",", "5"}]], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"5", ",", "6"}]]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}], "/.", 
    "formatrule"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"9", ",", "7"}]], ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"7", ",", "8"}]], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"8", ",", "9"}]]}], "}"}]}], "}"}], "/.", "formatrule"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dd", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"topleft", "=", "aa"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"topright", "=", "bb"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bottomleft", "=", "cc"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bottomright", "=", "dd"}], ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10004.},
 CellChangeTimes->{{3.6685100917869563`*^9, 3.668510127350026*^9}, {
  3.668839672461958*^9, 3.668839686177472*^9}, {3.668845190503632*^9, 
  3.668845194207653*^9}, {3.6688453870724583`*^9, 3.668845389934749*^9}, {
  3.6688594774842925`*^9, 3.668859480876142*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Standard", " ", "example", " ", "on", " ", "a", " ", "cylinder", " ", 
   "which", " ", "reduces", " ", "to", " ", "sums", " ", "of", " ", "square", 
   " ", 
   RowBox[{"boxes", "."}]}], "*)"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10007.},
 CellChangeTimes->{3.6687601502238846`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"formatrule", "=", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["XX_", 
       RowBox[{"z1_", ",", "z2_"}]], "\[Rule]", 
      RowBox[{"XX", "[", 
       RowBox[{"z1", ",", "z2"}], "]"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aa", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"1", ",", "3"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"3", ",", "1"}]], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        SubscriptBox["X", 
         RowBox[{"1", ",", "2"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"2", ",", "1"}]]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        SubscriptBox["X", 
         RowBox[{"2", ",", "3"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"4", ",", "2"}]]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"5", ",", "1"}]], ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"1", ",", "4"}]]}], "}"}]}], "}"}], "/.", "formatrule"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bb", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"2", ",", "2"}]], ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        SubscriptBox["X", 
         RowBox[{"3", ",", "4"}]], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"4", ",", "5"}]]}], "}"}]}], "}"}], "/.", "formatrule"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["X", 
        RowBox[{"3", ",", "5"}]], ",", "0", ",", "0"}], "}"}], "}"}], "/.", 
    "formatrule"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dd", "=", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"topleft", "=", "aa"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"topright", "=", "bb"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bottomleft", "=", "cc"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bottomright", "=", "dd"}], ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10007.},
 CellChangeTimes->{{3.668760039534823*^9, 3.668760056666574*^9}, 
   3.6687601502238846`*^9, {3.668764511874802*^9, 3.668764577786397*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "This", " ", "is", " ", "just", " ", "like", " ", "the", " ", "nonplanar", 
    " ", "G", 
    RowBox[{"(", 
     RowBox[{"3", ",", "6"}], ")"}], " ", 
    SubscriptBox["bft", "29"], " ", "but", " ", "where", " ", "we", " ", 
    "shut", " ", "off", " ", "the", " ", "external", " ", "edges", " ", 
    SubscriptBox["X", 
     RowBox[{"4", ",", "5"}]]}], ",", " ", 
   RowBox[{
    SubscriptBox["X", 
     RowBox[{"5", ",", "6"}]], " ", "and", " ", 
    SubscriptBox["X", 
     RowBox[{"7", ",", "8"}]]}], ",", " ", 
   RowBox[{
   "thus", " ", "leaving", " ", "some", " ", "external", " ", "nodes", " ", 
    "empty"}]}], "*)"}]], "Input",
 PageWidth->WindowWidth,
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 CellChangeTimes->{{3.6676556677477255`*^9, 3.667655692245669*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"formatrule", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["XX_", 
      RowBox[{"z1_", ",", "z2_"}]], "\[Rule]", 
     RowBox[{"XX", "[", 
      RowBox[{"z1", ",", "z2"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aa", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"4", ",", "1"}]], ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"1", ",", "4"}]], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"2", ",", "4"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"4", ",", "2"}]], ",", "0", ",", "0", ",", "0", ",", "0"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        SubscriptBox["X", 
         RowBox[{"3", ",", "4"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"4", ",", "3"}]], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"1", ",", "2"}]], ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"7", ",", "1"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"2", ",", "7"}]], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        SubscriptBox["X", 
         RowBox[{"2", ",", "3"}]], ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"7", ",", "2"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"3", ",", "7"}]]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"3", ",", "1"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"1", ",", "9"}]], ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"9", ",", "3"}]]}], "}"}]}], "}"}], "/.", "formatrule"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bb", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"4", ",", "4"}]], ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}], "/.", 
    "formatrule"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"9", ",", "7"}]], ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"7", ",", "9"}]]}], "}"}]}], "}"}], "/.", "formatrule"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dd", "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}], "/.", 
     "formatrule"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"topleft", "=", "aa"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"topright", "=", "bb"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bottomleft", "=", "cc"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bottomright", "=", "dd"}], ";"}]}], "Input",
 PageWidth->WindowWidth,
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 CellChangeTimes->{
  3.667655692245669*^9, {3.667655742619673*^9, 3.6676557763179293`*^9}, {
   3.667738650122837*^9, 3.6677386569115353`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "This", " ", "is", " ", "just", " ", "like", " ", "the", " ", "dimer", " ", 
   SubscriptBox["bft", "55"], " ", "but", " ", "with", " ", "two", " ", 
   "additional", " ", "empty", " ", "white", " ", "nodes"}], "*)"}]], "Input",
 PageWidth->WindowWidth,
 CellGroupingRules->{GroupTogetherGrouping, 10004.},
 CellChangeTimes->{{3.6676557088922997`*^9, 3.667655710635133*^9}, 
   3.6676559329925933`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"formatrule", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["XX_", 
      RowBox[{"z1_", ",", "z2_"}]], "\[Rule]", 
     RowBox[{"XX", "[", 
      RowBox[{"z1", ",", "z2"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aa", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"2", ",", "3"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"3", ",", "1"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"1", ",", "2"}]], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"4", ",", "2"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"1", ",", "4"}]], ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"2", ",", "1"}]]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"3", ",", "4"}]], ",", "0", ",", 
        SubscriptBox["Y", 
         RowBox[{"2", ",", "3"}]], ",", 
        SubscriptBox["Y", 
         RowBox[{"4", ",", "2"}]]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        SubscriptBox["X", 
         RowBox[{"4", ",", "3"}]], ",", 
        SubscriptBox["Y", 
         RowBox[{"3", ",", "1"}]], ",", 
        SubscriptBox["Y", 
         RowBox[{"1", ",", "4"}]]}], "}"}]}], "}"}], "/.", "formatrule"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bb", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "}"}], ",", 
      RowBox[{"{", "}"}], ",", 
      RowBox[{"{", "}"}], ",", 
      RowBox[{"{", "}"}]}], "}"}], "/.", "formatrule"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], "/.", 
    "formatrule"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dd", "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", "}"}]}], "}"}], "/.", "formatrule"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"topleft", "=", "aa"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"topright", "=", "bb"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bottomleft", "=", "cc"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bottomright", "=", "dd"}], ";"}]}], "Input",
 PageWidth->WindowWidth,
 CellGroupingRules->{GroupTogetherGrouping, 10004.},
 CellChangeTimes->{{3.667655789949314*^9, 3.6676558002672615`*^9}, 
   3.6676559329925933`*^9, {3.667738668952115*^9, 3.6677386716032057`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "This", " ", "is", " ", "just", " ", "like", " ", "the", " ", "dimer", " ", 
   SubscriptBox["bft", "55"], " ", "but", " ", "with", " ", "two", " ", 
   "additional", " ", "empty", " ", "white", " ", "nodes", " ", "and", " ", 
   "an", " ", "empty", " ", "black", " ", "node"}], "*)"}]], "Input",
 PageWidth->WindowWidth,
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{3.6676558952150955`*^9, 3.6676559755052614`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"formatrule", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["XX_", 
      RowBox[{"z1_", ",", "z2_"}]], "\[Rule]", 
     RowBox[{"XX", "[", 
      RowBox[{"z1", ",", "z2"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aa", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"2", ",", "3"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"3", ",", "1"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"1", ",", "2"}]], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"4", ",", "2"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"1", ",", "4"}]], ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"2", ",", "1"}]]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"3", ",", "4"}]], ",", "0", ",", 
        SubscriptBox["Y", 
         RowBox[{"2", ",", "3"}]], ",", 
        SubscriptBox["Y", 
         RowBox[{"4", ",", "2"}]]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        SubscriptBox["X", 
         RowBox[{"4", ",", "3"}]], ",", 
        SubscriptBox["Y", 
         RowBox[{"3", ",", "1"}]], ",", 
        SubscriptBox["Y", 
         RowBox[{"1", ",", "4"}]]}], "}"}]}], "}"}], "/.", "formatrule"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bb", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "0", "}"}], ",", 
      RowBox[{"{", "0", "}"}], ",", 
      RowBox[{"{", "0", "}"}], ",", 
      RowBox[{"{", "0", "}"}]}], "}"}], "/.", "formatrule"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], "/.", 
    "formatrule"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dd", "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"{", "0", "}"}]}], "}"}], "/.", "formatrule"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"topleft", "=", "aa"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"topright", "=", "bb"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bottomleft", "=", "cc"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bottomright", "=", "dd"}], ";"}]}], "Input",
 PageWidth->WindowWidth,
 CellGroupingRules->{GroupTogetherGrouping, 10005.},
 CellChangeTimes->{{3.667655954709431*^9, 3.6676559755052614`*^9}, {
  3.6677386769757624`*^9, 3.6677386792199087`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"This", " ", "is", " ", "just", " ", "like", " ", 
    SubscriptBox["bft", "29"], " ", "but", " ", "where", " ", "we", " ", 
    "shut", " ", "off", " ", "the", " ", "external", " ", "edges", " ", 
    SubscriptBox["X", 
     RowBox[{"4", ",", "5"}]]}], ",", " ", 
   SubscriptBox["X", 
    RowBox[{"5", ",", "2"}]], ",", " ", 
   RowBox[{
    SubscriptBox["X", 
     RowBox[{"6", ",", "4"}]], " ", "and", " ", 
    SubscriptBox["X", 
     RowBox[{"1", ",", "6"}]], " ", "thus", " ", "leaving", " ", "us", " ", 
    "with", " ", "no", " ", "perfect", " ", "matchings", " ", 
    RowBox[{"(", 
     RowBox[{
     "as", " ", "well", " ", "as", " ", "empty", " ", "external", " ", 
      "nodes"}], ")"}]}]}], "*)"}]], "Input",
 PageWidth->WindowWidth,
 CellGroupingRules->{GroupTogetherGrouping, 10006.},
 CellChangeTimes->{3.667655905665558*^9, 3.6676560089845877`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"formatrule", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["XX_", 
      RowBox[{"z1_", ",", "z2_"}]], "\[Rule]", 
     RowBox[{"XX", "[", 
      RowBox[{"z1", ",", "z2"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aa", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"4", ",", "4"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
        ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["Y", 
         RowBox[{"4", ",", "4"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
        ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        SubscriptBox["X", 
         RowBox[{"3", ",", "4"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"4", ",", "3"}]], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["Z", 
         RowBox[{"4", ",", "4"}]], ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"7", ",", "4"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"4", ",", "7"}]], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        SubscriptBox["Y", 
         RowBox[{"4", ",", "3"}]], ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"8", ",", "4"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"3", ",", "8"}]]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        SubscriptBox["Y", 
         RowBox[{"3", ",", "4"}]], ",", 
        SubscriptBox["X", 
         RowBox[{"4", ",", "9"}]], ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"9", ",", "3"}]]}], "}"}]}], "}"}], "/.", "formatrule"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bb", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        SubscriptBox["W", 
         RowBox[{"4", ",", "4"}]]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}], "/.", 
    "formatrule"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"9", ",", "7"}]], ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"7", ",", "8"}]], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        SubscriptBox["X", 
         RowBox[{"8", ",", "9"}]]}], "}"}]}], "}"}], "/.", "formatrule"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dd", "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}], "/.", 
     "formatrule"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"topleft", "=", "aa"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"topright", "=", "bb"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bottomleft", "=", "cc"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bottomright", "=", "dd"}], ";"}]}], "Input",
 PageWidth->WindowWidth,
 CellGroupingRules->{GroupTogetherGrouping, 10006.},
 CellChangeTimes->{{3.667655984322343*^9, 3.6676560089845877`*^9}, {
  3.667738684286211*^9, 3.6677386857324743`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "This", " ", "is", " ", "a", " ", "random", " ", "large", " ", "and", " ", 
   "vaguely", " ", "\"\<Kasteleyn-like\>\"", " ", "matrix"}], "*)"}]], "Input",
 PageWidth->WindowWidth,
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 CellChangeTimes->{{3.6617754963342223`*^9, 3.6617755411838408`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"multiplier", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aa", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"X", "[", 
      RowBox[{
       RowBox[{"RandomInteger", "[", "100000", "]"}], ",", 
       RowBox[{"RandomInteger", "[", "100000", "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"60", "multiplier"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", 
       RowBox[{"60", "multiplier"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bb", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Y", "[", 
      RowBox[{
       RowBox[{"RandomInteger", "[", "100000", "]"}], ",", 
       RowBox[{"RandomInteger", "[", "100000", "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"10", "multiplier"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", 
       RowBox[{"60", "multiplier"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cc", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Z", "[", 
      RowBox[{
       RowBox[{"RandomInteger", "[", "100000", "]"}], ",", 
       RowBox[{"RandomInteger", "[", "100000", "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"60", "multiplier"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", 
       RowBox[{"15", "multiplier"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dd", "=", 
    RowBox[{"Table", "[", 
     RowBox[{"0", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"10", "multiplier"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", 
        RowBox[{"15", "multiplier"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"topleft", "=", "aa"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"topright", "=", "bb"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bottomleft", "=", "cc"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bottomright", "=", "dd"}], ";"}]}], "Input",
 PageWidth->WindowWidth,
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 CellChangeTimes->{{3.661693348100015*^9, 3.66169340837926*^9}, {
   3.6616934927295403`*^9, 3.661693626719072*^9}, {3.6616937703262477`*^9, 
   3.661693889829563*^9}, {3.6616939336039877`*^9, 3.6616940513238783`*^9}, {
   3.661696926536392*^9, 3.6616970253141675`*^9}, {3.661697278440854*^9, 
   3.661697303520342*^9}, {3.6616973412705407`*^9, 3.6616973495555525`*^9}, 
   3.661697408415449*^9, {3.6617516480006285`*^9, 3.661751683088457*^9}, {
   3.661752734642175*^9, 3.661752785324402*^9}, 3.6617528598260384`*^9, 
   3.661759193383051*^9, 3.6617755024581594`*^9, 3.6617755411843414`*^9, {
   3.6620992442118053`*^9, 3.6620992444774437`*^9}}]
}, Closed]],

Cell[BoxData[""], "Input",
 PageWidth->WindowWidth,
 CellChangeTimes->{
  3.662284700602398*^9, 3.662458016607738*^9, {3.672574995631766*^9, 
   3.672574997116378*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"These", " ", "functions", " ", "are", " ", 
   RowBox[{"NEW", ":", "           ", 
    RowBox[{
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", "--"}]}]}], ">", "     ", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", "--"}]}]}], ">", "     ", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", "--"}]}]}], ">", "     ", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", "--"}]}]}], ">", "     ", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", "--"}]}]}], ">", "     ", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", "--"}]}]}], ">"}]}]}], "  ", "*)"}]], "Input",
 PageWidth->WindowWidth,
 CellChangeTimes->{{3.662277791653617*^9, 3.6622778116713*^9}, 
   3.6622901088542557`*^9, 3.6687743205669203`*^9, 3.683353121246992*^9, 
   3.684146367496011*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"This", " ", "is", " ", "the", " ", "function"}], "*)"}]], "Input",
 CellChangeTimes->{{3.6841469789984474`*^9, 3.6841469845623264`*^9}}],

Cell[BoxData[""], "Input",
 PageWidth->WindowWidth,
 CellChangeTimes->{{3.6676562536308794`*^9, 3.667656253818391*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"These", " ", "functions", " ", "are", " ", 
   RowBox[{"OLD", ":", "           ", 
    RowBox[{
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", "--"}]}]}], ">", "     ", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", "--"}]}]}], ">", "     ", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", "--"}]}]}], ">", "     ", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", "--"}]}]}], ">", "     ", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", "--"}]}]}], ">", "     ", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", "--"}]}]}], ">"}]}]}], "  ", "*)"}]], "Input",
 PageWidth->WindowWidth,
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6677179777970104`*^9, 3.6677179854575377`*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6731137365038757`*^9, 3.6731137365909405`*^9}, {
  3.6840662070558786`*^9, 3.6840662092950225`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Z", "[", "1", "]"}], ",", 
       RowBox[{"Z", "[", "2", "]"}], ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"Z", "[", "3", "]"}], ",", 
       RowBox[{"Z", "[", "4", "]"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"Z", "[", "5", "]"}], ",", 
       RowBox[{"Z", "[", "6", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Z", "[", "7", "]"}], ",", 
       RowBox[{"Z", "[", "8", "]"}], ",", 
       RowBox[{"Z", "[", "9", "]"}], ",", 
       RowBox[{"Z", "[", "10", "]"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Z", "[", "11", "]"}], ",", "0", ",", "0", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"Z", "[", "12", "]"}], ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"Z", "[", "13", "]"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", 
       RowBox[{"Z", "[", "14", "]"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Z", "[", "15", "]"}], ",", "0", ",", "0", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", 
       RowBox[{"Z", "[", "16", "]"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
  "}"}]], "Input"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6799104349637427`*^9, 3.679910435041893*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.67991043577628*^9, 3.679910435823185*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.6799001780847073`*^9, {3.6799104299828587`*^9, 3.6799104307107882`*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.670052766264258*^9, 3.6700527673982434`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{
    "This", " ", "is", " ", "to", " ", "obtain", " ", "the", " ", "top"}], 
    "-", 
    RowBox[{"form", " ", "of", " ", "the", " ", "graph", " ", "in", " ", 
     RowBox[{"question", ".", " ", "It"}], " ", "works", " ", "decently", " ",
      "on", " ", "top"}], "-", "forms"}], ",", " ", 
   RowBox[{"especially", " ", "if", " ", "they", " ", 
    RowBox[{"don", "'"}], "t", " ", "have", " ", "any", " ", "nonstandard", 
    " ", "poles"}], ",", " ", 
   RowBox[{
    RowBox[{"but", " ", "is", " ", "otherwise", " ", "a", " ", "bit", " ", 
     RowBox[{"temperamental", ".", " ", "It"}], " ", "should", " ", "be", " ",
      "tested", " ", "on", " ", "boundaries", " ", "of", " ", "top"}], "-", 
    RowBox[{
    "dim", " ", "graphs", " ", "to", " ", "see", " ", "how", " ", "it", " ", 
     "copes"}]}], ",", 
   RowBox[{
   "as", " ", "well", " ", "as", " ", "properly", " ", "test", " ", "it", " ",
     "on", " ", "examples", " ", "with", " ", "nonstandard", " ", 
    RowBox[{"poles", ".", " ", "THE"}], " ", "FUNCTION", " ", "NAMES", " ", 
    "NEED", " ", "CHANGING", " ", "TO", " ", "THE", " ", "NEW", " ", 
    "NAMES"}]}], "*)"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.670064456868808*^9, 3.6700644654675922`*^9}, {
  3.6700651844105997`*^9, 3.6700652567572823`*^9}, {3.6715444548302937`*^9, 
  3.6715444630202236`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"allvars", "=", 
   RowBox[{"Variables", "[", 
    RowBox[{"joinupKasteleyn", "[", 
     RowBox[{
     "topleft", ",", "topright", ",", "bottomleft", ",", "bottomright"}], 
     "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"allvarssettoone", "=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "\[Rule]", "1"}], "&"}], ",", "allvars"}], "]"}]}], ";"}],
   "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"We", "'"}], "ll", " ", "change", " ", "variables", " ", "in", 
    " ", "the", " ", "path", " ", "matrix", " ", "to", " ", "loop", " ", 
    "variables"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"loopbasis", "=", 
   RowBox[{"Join", "@@", 
    RowBox[{"makeLoopVariablesBasis", "[", 
     RowBox[{
     "topleft", ",", "topright", ",", "bottomleft", ",", "bottomright"}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"basisvectors", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{"#", ",", 
           RowBox[{"allvars", "[", 
            RowBox[{"[", "iii", "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"iii", ",", 
           RowBox[{"Length", "[", "allvars", "]"}]}], "}"}]}], "]"}], "/.", 
       "allvarssettoone"}], "&"}], ",", "loopbasis"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tosolvefor", "=", 
   RowBox[{"Total", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"coef", "[", "iii", "]"}], 
       RowBox[{"basisvectors", "[", 
        RowBox[{"[", "iii", "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"iii", ",", 
        RowBox[{"Length", "[", "basisvectors", "]"}]}], "}"}]}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"coeflist", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"coef", "[", "iii", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"iii", ",", 
        RowBox[{"Length", "[", "basisvectors", "]"}]}], "}"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "These", " ", "three", " ", "functions", " ", "are", " ", "able", " ", 
    "to", " ", "turn", " ", "a", " ", "matrix", " ", "entry", " ", "in", " ", 
    "the", " ", "path", " ", "matrix", " ", "into", " ", "loop", " ", 
    "variables"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"singleTermToExpression", "=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", "singleterm", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "loopvariablesingleterm", "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", "singleterm", "]"}], "=!=", "Integer"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"loopvariablesingleterm", "=", 
            RowBox[{"Times", "@@", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Power", "[", 
                 RowBox[{
                  RowBox[{"loopvariable", "[", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], ",", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}], ",", 
               RowBox[{
                RowBox[{"Solve", "[", 
                 RowBox[{
                  RowBox[{"tosolvefor", "\[Equal]", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{"singleterm", ",", 
                    RowBox[{"allvars", "[", 
                    RowBox[{"[", "iii", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"iii", ",", 
                    RowBox[{"Length", "[", "allvars", "]"}]}], "}"}]}], "]"}],
                     "/.", "allvarssettoone"}], ")"}]}], ",", "coeflist"}], 
                 "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], ";"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"(*", 
           RowBox[{
           "we", " ", "have", " ", "a", " ", "1", " ", "or", " ", "a", " ", 
            "0"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"loopvariablesingleterm", "=", "singleterm"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "loopvariablesingleterm"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"termToExpression", "=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", "term", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"noloopterm", ",", "loopvariableterm"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", "term", "]"}], "=!=", "Integer"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Head", "[", 
               RowBox[{"Expand", "[", 
                RowBox[{"Denominator", "[", "term", "]"}], "]"}], "]"}], "===",
               "Plus"}], ",", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "we", " ", "have", " ", "a", " ", "loop", " ", "denominator"}], 
              "*)"}], "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"noloopterm", "=", 
               RowBox[{"term", " ", "loopdenominator"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"loopvariableterm", "=", 
               RowBox[{
                RowBox[{"singleTermToExpression", "[", "noloopterm", "]"}], 
                "/", "loopdenominatorinloopvariables"}]}], ";"}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{"(*", 
              RowBox[{"we", " ", 
               RowBox[{"don", "'"}], "t", " ", "have", " ", "a", " ", "loop", 
               " ", "denominator"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"loopvariableterm", "=", 
               RowBox[{"singleTermToExpression", "[", "term", "]"}]}], 
              ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"(*", 
           RowBox[{
           "we", " ", "have", " ", "a", " ", "1", " ", "or", " ", "a", " ", 
            "0"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"loopvariableterm", "=", "term"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "loopvariableterm"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"turnIntoLoopVariableExpression", "=", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", "entry", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", "loopvariableexpression", "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Head", "[", "entry", "]"}], "=!=", "Integer"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Head", "[", "entry", "]"}], "===", "Plus"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{"we", " ", "have", " ", "multiple", " ", "terms"}], 
               "*)"}], "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"loopvariableexpression", "=", 
                RowBox[{
                 RowBox[{"Total", "[", 
                  RowBox[{"Map", "[", 
                   RowBox[{"termToExpression", ",", 
                    RowBox[{"Cases", "[", 
                    RowBox[{
                    RowBox[{"List", "@@", "entry"}], ",", 
                    RowBox[{"Except", "[", 
                    RowBox[{"-", "___"}], "]"}]}], "]"}]}], "]"}], "]"}], "-", 
                 RowBox[{"Total", "[", 
                  RowBox[{"Map", "[", 
                   RowBox[{"termToExpression", ",", 
                    RowBox[{"-", 
                    RowBox[{"Cases", "[", 
                    RowBox[{
                    RowBox[{"List", "@@", "entry"}], ",", 
                    RowBox[{"-", "___"}]}], "]"}]}]}], "]"}], "]"}]}]}], 
               ";"}], "\[IndentingNewLine]", ",", 
              RowBox[{"(*", 
               RowBox[{
               "we", " ", "have", " ", "only", " ", "one", " ", "term"}], 
               "*)"}], "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"loopvariableexpression", "=", 
                RowBox[{"termToExpression", "[", "entry", "]"}]}], ";"}]}], 
             "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
           RowBox[{"(*", 
            RowBox[{
            "we", " ", "have", " ", "a", " ", "1", " ", "or", " ", "a", " ", 
             "0"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"loopvariableexpression", "=", "entry"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "loopvariableexpression"}]}], "]"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "We", " ", "should", " ", "use", " ", "as", " ", "reference", " ", 
     "perfect", " ", "matching", " ", "something", " ", "with", " ", "low", 
     " ", "number", " ", "of", " ", 
     RowBox[{"loops", ".", " ", "Sometimes"}], " ", "the", " ", "minor", " ", 
     "that", " ", "equals", " ", "1", " ", 
     RowBox[{"(", 
      RowBox[{"from", " ", "the", " ", "identiy", " ", "matrix"}], ")"}], " ",
      "appears", " ", "in", " ", "the", " ", "expression", " ", "of", " ", 
     "the", " ", 
     RowBox[{"form", ".", " ", "We"}], " ", "should", " ", "therefore", " ", 
     "use", " ", "two", " ", "different", " ", "reference", " ", 
     "matchings"}], ",", " ", 
    RowBox[{"with", " ", "different", " ", "sources", " ", "sets"}], ",", " ", 
    RowBox[{"and", " ", "compare", " ", "the", " ", "answers"}], ",", " ", 
    RowBox[{"to", " ", "make", " ", "sure", " ", "we", " ", 
     RowBox[{"don", "'"}], "t", " ", "miss", " ", "out", " ", "on", " ", 
     "minors", " ", "that", " ", "equal", " ", "1."}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Let", "'"}], "s", " ", "find", " ", "two", " ", "good", " ", 
    "reference", " ", "perfect", " ", "matchings"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"perfectmatchings", "=", 
   RowBox[{"perfectMatchings", "[", 
    RowBox[{
    "topleft", ",", "topright", ",", "bottomleft", ",", "bottomright"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sources", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"findSourceNodes", "[", 
       RowBox[{
       "topleft", ",", "topright", ",", "bottomleft", ",", "bottomright", ",",
         "#"}], "]"}], "&"}], ",", "perfectmatchings"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pmnumberswithdistinctsources", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"sources", ",", "#"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", 
      RowBox[{"DeleteDuplicates", "[", "sources", "]"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"referencematchings", "=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"perfectmatchings", "[", 
        RowBox[{"[", "#", "]"}], "]"}], "&"}], ",", 
      RowBox[{
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"Ordering", "[", 
          RowBox[{"sources", "/.", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Rule", "@@", "#"}], "&"}], ",", 
             RowBox[{"Tally", "[", "sources", "]"}]}], "]"}]}], "]"}], ",", 
         RowBox[{"Alternatives", "@@", "pmnumberswithdistinctsources"}]}], 
        "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}], "]"}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"We", "'"}], "ll", " ", "now", " ", "find", " ", "the", " ", 
    "form", " ", "for", " ", "each", " ", "of", " ", "the", " ", "two", " ", 
    "reference", " ", "matchings"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"jj", "=", "1"}], ",", 
     RowBox[{"jj", "\[LessEqual]", "2"}], ",", 
     RowBox[{"jj", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Print", "[", "jj", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"currentreferencematching", "=", 
       RowBox[{"referencematchings", "[", 
        RowBox[{"[", "jj", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"loopdenominator", "=", 
       RowBox[{"getLoopDenominator", "[", 
        RowBox[{
        "topleft", ",", "topright", ",", "bottomleft", ",", "bottomright", 
         ",", "currentreferencematching"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"loopdenominatorsigns", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"loopdenominator", "/.", 
          RowBox[{"Plus", "\[Rule]", "List"}]}], ")"}], "/.", 
        "allvarssettoone"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"loopdenominatorinloopvariables", "=", 
       RowBox[{"Total", "[", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{"singleTermToExpression", ",", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"loopdenominator", "/.", 
                RowBox[{"Plus", "\[Rule]", "List"}]}], ")"}], " ", 
              "loopdenominatorsigns"}], "}"}], "]"}]}], "]"}], 
         "loopdenominatorsigns"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"pathmat", "=", 
       RowBox[{"pathMatrix", "[", 
        RowBox[{
        "topleft", ",", "topright", ",", "bottomleft", ",", "bottomright", 
         ",", "currentreferencematching"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pathmatinloopvariables", "=", 
       RowBox[{"Map", "[", 
        RowBox[{"turnIntoLoopVariableExpression", ",", "pathmat", ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"matrixentries", "=", 
       RowBox[{"DeleteCases", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", "pathmatinloopvariables", "]"}], ",", 
         RowBox[{"0", "|", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"Now", " ", "we", " ", "want", " ", "to", " ", "turn", " ", 
          RowBox[{"df", "/", "f"}], " ", 
          RowBox[{"(", 
           RowBox[{"these", " ", "are", " ", "face", " ", "variables"}], 
           ")"}], " ", "in", " ", "the", " ", "on"}], "-", 
         RowBox[{"shell", " ", "form", " ", "into", " ", 
          RowBox[{"dC", "/", "minors"}], " ", "To", " ", "do", " ", "this", 
          " ", 
          RowBox[{"we", "'"}], "ll", " ", "need", " ", "the", " ", "Jacobian",
           " ", "of", " ", "the", " ", "variable", " ", 
          RowBox[{"transformation", ".", " ", "This"}], " ", "we", " ", "can",
           " ", "obtain", " ", "if", " ", "we", " ", "have", " ", 
          RowBox[{"df", "/", "dC"}]}]}], ",", " ", 
        RowBox[{
        "so", " ", "we", " ", "need", " ", "to", " ", "find", " ", "an", " ", 
         "expression", " ", "of", " ", "the", " ", "face", " ", "variables", 
         " ", "in", " ", "terms", " ", "of", " ", "matrix", " ", 
         RowBox[{"entries", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"allloopvariables", "=", 
       RowBox[{"Variables", "[", "pathmatinloopvariables", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"allequations", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"genericentry", "[", "iii", "]"}], "\[Equal]", 
          RowBox[{"matrixentries", "[", 
           RowBox[{"[", "iii", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"iii", ",", 
           RowBox[{"Length", "[", "matrixentries", "]"}]}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"onlysolvefortheseequations", "=", 
       RowBox[{"Subsets", "[", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{"Length", "[", "allequations", "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", "allloopvariables", "]"}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"ii", "=", "1"}], ",", 
        RowBox[{"ii", "\[LessEqual]", 
         RowBox[{"Length", "[", "onlysolvefortheseequations", "]"}]}], ",", 
        RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"loopvariablesolution", "=", 
          RowBox[{"Solve", "[", 
           RowBox[{
            RowBox[{"And", "@@", 
             RowBox[{"allequations", "[", 
              RowBox[{"[", 
               RowBox[{"onlysolvefortheseequations", "[", 
                RowBox[{"[", "ii", "]"}], "]"}], "]"}], "]"}]}], ",", 
            "allloopvariables"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "loopvariablesolution", "]"}], ">", "0"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"loopvariablesolution", "=", 
             RowBox[{"loopvariablesolution", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"loopvariablesolution", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "&"}], ",", 
         "loopvariablesolution"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "\"\<About to start simplifying\>\"", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"jacobian", "=", 
       RowBox[{"Simplify", "[", 
        RowBox[{"Det", "[", 
         RowBox[{"Simplify", "[", 
          RowBox[{"D", "[", 
           RowBox[{"loopvariablesolution", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", 
                "allequations"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"onlysolvefortheseequations", "[", 
                RowBox[{"[", "ii", "]"}], "]"}], "]"}], "]"}], "}"}]}], "]"}],
           "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "\"\<Done\>\"", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"We", " ", "now", " ", "have", " ", "the", " ", 
        RowBox[{"jacobian", "!"}], " ", "All", " ", "we", " ", "have", " ", 
        "left", " ", "is", " ", "1", " ", "divided", " ", "by", " ", "the", 
        " ", "product", " ", "of", " ", 
        RowBox[{"faces", "."}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"finalexpressiongeneric", "=", 
       RowBox[{"Simplify", "[", 
        RowBox[{"jacobian", "/", 
         RowBox[{"Simplify", "[", 
          RowBox[{"Times", "@@", "loopvariablesolution"}], "]"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"We", "'"}], "ll", " ", "now", " ", "try", " ", "and", " ", 
         "recast", " ", "these", " ", "in", " ", "terms", " ", "of", " ", 
         "minors"}], ",", " ", 
        RowBox[{"in", " ", "the", " ", "simplest", " ", "possible", " ", 
         RowBox[{"way", ".", " ", "To"}], " ", "do", " ", "this", " ", 
         RowBox[{"we", "'"}], "ll", " ", "start", " ", "with", " ", "making", 
         " ", "a", " ", "generic", " ", "matrix", " ", "with", " ", "matrix", 
         " ", "entries", " ", "in", " ", "the", " ", "same", " ", "places", 
         " ", "as", " ", 
         RowBox[{"pathmat", ".", " ", "Then"}], " ", "look", " ", "at", " ", 
         "its", " ", "minors"}], ",", " ", 
        RowBox[{
        "and", " ", "replace", " ", "the", " ", "expressions", " ", "of", " ",
          "minors", " ", "into", " ", 
         RowBox[{"finalexpressiongeneric", "."}]}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"genericpathmat", "=", 
       RowBox[{"pathmatinloopvariables", "/.", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"matrixentries", "[", 
            RowBox[{"[", "iii", "]"}], "]"}], "\[Rule]", 
           RowBox[{"genericentry", "[", "iii", "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"iii", ",", 
            RowBox[{"Length", "[", "matrixentries", "]"}]}], "}"}]}], 
         "]"}]}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"NB", " ", "this", " ", "line", " ", 
         RowBox[{"doesn", "'"}], "t", " ", "always", " ", 
         RowBox[{"work", "!"}], " ", 
         RowBox[{"It", "'"}], "s", " ", "a", " ", "bit", " ", "buggy"}], " ", 
        "-", " ", 
        RowBox[{"check", " ", "that", " ", "indeed", " ", 
         RowBox[{"it", "'"}], "s", " ", "a", " ", "generic", " ", "matrix", 
         " ", "with", " ", "matrix", " ", "entries", " ", "in", " ", "the", 
         " ", "right", " ", "places"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"allminors", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"HoldForm", "[", "minor", "]"}], "[", 
           RowBox[{"Sequence", "@@", "#"}], "]"}], "&"}], ",", 
         RowBox[{"Subsets", "[", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{
             RowBox[{"Dimensions", "[", "genericpathmat", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"Length", "[", "genericpathmat", "]"}], "}"}]}], "]"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"genericminors", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{"Rule", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"Minors", "[", 
             RowBox[{"genericpathmat", ",", 
              RowBox[{"Length", "[", "genericpathmat", "]"}]}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "allminors"}], "}"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"We", "'"}], "ll", " ", "now", " ", "make", " ", "a", " ", 
         "list", " ", "of", " ", "replacements"}], ",", " ", 
        RowBox[{
        "where", " ", "complicated", " ", "expressions", " ", "of", " ", 
         "products", " ", "of", " ", "matrix", " ", "entries", " ", "get", 
         " ", "turned", " ", "into", " ", 
         RowBox[{"minors", ".", " ", "Sometimes"}], " ", "they", " ", 
         "appear", " ", "with", " ", "a", " ", "minus"}], ",", " ", 
        RowBox[{"so", " ", "include", " ", 
         RowBox[{"both", ".", " ", "Also"}]}], ",", " ", 
        RowBox[{
        "we", " ", "should", " ", "put", " ", "the", " ", "more", " ", 
         "complex", " ", "ones", " ", "in", " ", "the", " ", "beginning", " ",
          "of", " ", "the", " ", "replacementlist"}], ",", " ", 
        RowBox[{
        "so", " ", "that", " ", "complicated", " ", "expressions", " ", "get",
          " ", "simplified", " ", "straight", " ", "away"}], ",", " ", 
        RowBox[{
         RowBox[{
         "rather", " ", "than", " ", "turn", " ", "into", " ", "a", " ", 
          "half"}], "-", 
         RowBox[{
         "replaced", " ", "form", " ", "that", " ", "is", " ", "very", " ", 
          "hard", " ", "to", " ", "simplify", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
            "unless", " ", "you", " ", "go", " ", "and", " ", "look", " ", 
             "at", " ", "all", " ", "the", " ", "Plucker", " ", "relations", 
             " ", "and", " ", "try", " ", "and", " ", "simplify", " ", 
             "things", " ", "that", " ", "way", " ", "somehow"}], ")"}], 
           "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"replacementlist", "=", 
       RowBox[{"DeleteCases", "[", 
        RowBox[{
         RowBox[{"SortBy", "[", 
          RowBox[{"genericminors", ",", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Length", "[", 
              RowBox[{"MonomialList", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], "&"}]}], 
          "]"}], ",", 
         RowBox[{"1", "\[Rule]", "___"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"replacementlist", "=", 
       RowBox[{"Riffle", "[", 
        RowBox[{"replacementlist", ",", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "\[Rule]", 
             RowBox[{"-", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}], "&"}], ",", 
           "replacementlist"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"finalexpression", "[", "jj", "]"}], "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{"Expand", ",", 
            RowBox[{"Simplify", "[", 
             RowBox[{"Numerator", "[", "finalexpressiongeneric", "]"}], 
             "]"}]}], "]"}], "//.", "replacementlist"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{"Expand", ",", 
            RowBox[{"Simplify", "[", 
             RowBox[{"Denominator", "[", "finalexpressiongeneric", "]"}], 
             "]"}]}], "]"}], "//.", "replacementlist"}], ")"}]}]}], ";"}]}], 
    "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Now", " ", "that", " ", "we", " ", "have", " ", "the", " ", "expression",
      " ", "in", " ", "terms", " ", "of", " ", "minors", " ", "from", " ", 
     "both", " ", "reference", " ", "perfect", " ", "matchings"}], ",", " ", 
    RowBox[{
    "find", " ", "a", " ", "unified", " ", "expression", " ", "that", " ", 
     "takes", " ", "them", " ", "both", " ", "into", " ", "account"}], ",", 
    " ", 
    RowBox[{"so", " ", "we", " ", 
     RowBox[{"don", "'"}], "t", " ", "miss", " ", "out", " ", "on", " ", 
     "the", " ", "minor", " ", "that", " ", "equals", " ", "1."}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expressionratio", "=", 
   RowBox[{
    RowBox[{"finalexpression", "[", "1", "]"}], "/", 
    RowBox[{"finalexpression", "[", "2", "]"}]}]}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"finalexpression", "[", "1", "]"}], "/", 
      RowBox[{"(", 
       RowBox[{"Numerator", "[", "expressionratio", "]"}], ")"}]}], "===", 
     RowBox[{
      RowBox[{"finalexpression", "[", "2", "]"}], "/", 
      RowBox[{"(", 
       RowBox[{"Denominator", "[", "expressionratio", "]"}], ")"}]}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"finalexpressionoutput", "=", 
      RowBox[{
       RowBox[{"finalexpression", "[", "1", "]"}], "/", 
       RowBox[{"(", 
        RowBox[{"Numerator", "[", "expressionratio", "]"}], ")"}]}]}], ";"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{
     RowBox[{"finalexpressionoutput", "=", 
      RowBox[{"finalexpression", "[", "1", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
     "Print", "[", "\"\<Couldn't agree on a final expression\>\"", "]"}], 
     ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}], "\[IndentingNewLine]", "finalexpressionoutput"}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.669978955992772*^9, 3.6699790023300323`*^9}, {
   3.669979069527957*^9, 3.669979074737541*^9}, {3.6699820718298492`*^9, 
   3.6699820726328974`*^9}, {3.669982111651662*^9, 3.6699821228097143`*^9}, {
   3.6699827905601015`*^9, 3.6699828166250663`*^9}, {3.6699834751025534`*^9, 
   3.6699834810363507`*^9}, {3.6699836473273525`*^9, 
   3.6699837036015015`*^9}, {3.6699844055351343`*^9, 3.669984500058134*^9}, {
   3.6699874213852935`*^9, 3.669987421847471*^9}, {3.670041442563506*^9, 
   3.670041447008606*^9}, {3.6700462406365323`*^9, 3.6700462417983055`*^9}, {
   3.6700467092814674`*^9, 3.6700467301765995`*^9}, {3.6700468429638863`*^9, 
   3.67004685703564*^9}, 3.6700469467092505`*^9, {3.670047343852245*^9, 
   3.6700473743157897`*^9}, {3.670047433118247*^9, 3.670047435618017*^9}, {
   3.6700475817155447`*^9, 3.6700476026651*^9}, {3.6700478450228796`*^9, 
   3.6700478470811696`*^9}, {3.6700481179650497`*^9, 3.670048128879428*^9}, {
   3.6700485079699707`*^9, 3.6700485263688183`*^9}, {3.6700570702603645`*^9, 
   3.670057128538765*^9}, {3.6700571753459835`*^9, 3.670057208268365*^9}, {
   3.67005768535776*^9, 3.670057714045118*^9}, {3.6700577586465254`*^9, 
   3.670057811046379*^9}, {3.6700578647342596`*^9, 3.6700578989105053`*^9}, {
   3.670057938766017*^9, 3.6700579388754044`*^9}, {3.6700579894627657`*^9, 
   3.670057994552559*^9}, {3.670058548715603*^9, 3.6700585488562307`*^9}, {
   3.6700585848178234`*^9, 3.670058584880314*^9}, {3.670058623082783*^9, 
   3.6700586594948263`*^9}, {3.670059145554825*^9, 3.6700591582968864`*^9}, {
   3.67005964764283*^9, 3.670059648533491*^9}, {3.670059751329955*^9, 
   3.6700597871257477`*^9}, {3.6700629831897297`*^9, 3.670062992070104*^9}, {
   3.670063295653164*^9, 3.6700633016936355`*^9}, {3.6700635869358573`*^9, 
   3.6700635900697193`*^9}, {3.6700637128561196`*^9, 
   3.6700637363901663`*^9}, {3.670064491320567*^9, 3.6700651227636895`*^9}, {
   3.6700651537550025`*^9, 3.670065171932646*^9}, 3.670065256772895*^9}],

Cell[BoxData["1"], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.670057995224659*^9, 3.670058550075041*^9, 3.670058585692855*^9, {
   3.6700586406922984`*^9, 3.670058662285692*^9}, {3.6700587082436404`*^9, 
   3.670058724437513*^9}, 3.6700591595712414`*^9, 3.6700591945040464`*^9, 
   3.6700592713726616`*^9, {3.670059347539632*^9, 3.6700593843559237`*^9}, 
   3.6700596512862825`*^9, 3.670059752970894*^9, 3.670059788274927*^9, 
   3.6700630011946826`*^9, {3.6700632830500574`*^9, 3.670063303311368*^9}, 
   3.6700634222653565`*^9, 3.670063590772879*^9, {3.670063717758592*^9, 
   3.670063737664942*^9}, 3.6700637888994484`*^9, 3.6700638556113806`*^9, 
   3.6700644343443203`*^9, 3.6700651777255006`*^9, 3.670065256772895*^9, 
   3.670065641794962*^9, 3.670065726653997*^9}],

Cell[BoxData["\<\"About to start simplifying\"\>"], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.670057995224659*^9, 3.670058550075041*^9, 3.670058585692855*^9, {
   3.6700586406922984`*^9, 3.670058662285692*^9}, {3.6700587082436404`*^9, 
   3.670058724437513*^9}, 3.6700591595712414`*^9, 3.6700591945040464`*^9, 
   3.6700592713726616`*^9, {3.670059347539632*^9, 3.6700593843559237`*^9}, 
   3.6700596512862825`*^9, 3.670059752970894*^9, 3.670059788274927*^9, 
   3.6700630011946826`*^9, {3.6700632830500574`*^9, 3.670063303311368*^9}, 
   3.6700634222653565`*^9, 3.670063590772879*^9, {3.670063717758592*^9, 
   3.670063737664942*^9}, 3.6700637888994484`*^9, 3.6700638556113806`*^9, 
   3.6700644343443203`*^9, 3.6700651777255006`*^9, 3.670065256772895*^9, 
   3.670065641794962*^9, 3.6700657271229963`*^9}],

Cell[BoxData["\<\"Done\"\>"], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.670057995224659*^9, 3.670058550075041*^9, 3.670058585692855*^9, {
   3.6700586406922984`*^9, 3.670058662285692*^9}, {3.6700587082436404`*^9, 
   3.670058724437513*^9}, 3.6700591595712414`*^9, 3.6700591945040464`*^9, 
   3.6700592713726616`*^9, {3.670059347539632*^9, 3.6700593843559237`*^9}, 
   3.6700596512862825`*^9, 3.670059752970894*^9, 3.670059788274927*^9, 
   3.6700630011946826`*^9, {3.6700632830500574`*^9, 3.670063303311368*^9}, 
   3.6700634222653565`*^9, 3.670063590772879*^9, {3.670063717758592*^9, 
   3.670063737664942*^9}, 3.6700637888994484`*^9, 3.6700638556113806`*^9, 
   3.6700644343443203`*^9, 3.6700651777255006`*^9, 3.670065256772895*^9, 
   3.670065641794962*^9, 3.6700657322431154`*^9}],

Cell[BoxData["2"], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.670057995224659*^9, 3.670058550075041*^9, 3.670058585692855*^9, {
   3.6700586406922984`*^9, 3.670058662285692*^9}, {3.6700587082436404`*^9, 
   3.670058724437513*^9}, 3.6700591595712414`*^9, 3.6700591945040464`*^9, 
   3.6700592713726616`*^9, {3.670059347539632*^9, 3.6700593843559237`*^9}, 
   3.6700596512862825`*^9, 3.670059752970894*^9, 3.670059788274927*^9, 
   3.6700630011946826`*^9, {3.6700632830500574`*^9, 3.670063303311368*^9}, 
   3.6700634222653565`*^9, 3.670063590772879*^9, {3.670063717758592*^9, 
   3.670063737664942*^9}, 3.6700637888994484`*^9, 3.6700638556113806`*^9, 
   3.6700644343443203`*^9, 3.6700651777255006`*^9, 3.670065256772895*^9, 
   3.670065641794962*^9, 3.6700657323837504`*^9}],

Cell[BoxData["\<\"About to start simplifying\"\>"], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.670057995224659*^9, 3.670058550075041*^9, 3.670058585692855*^9, {
   3.6700586406922984`*^9, 3.670058662285692*^9}, {3.6700587082436404`*^9, 
   3.670058724437513*^9}, 3.6700591595712414`*^9, 3.6700591945040464`*^9, 
   3.6700592713726616`*^9, {3.670059347539632*^9, 3.6700593843559237`*^9}, 
   3.6700596512862825`*^9, 3.670059752970894*^9, 3.670059788274927*^9, 
   3.6700630011946826`*^9, {3.6700632830500574`*^9, 3.670063303311368*^9}, 
   3.6700634222653565`*^9, 3.670063590772879*^9, {3.670063717758592*^9, 
   3.670063737664942*^9}, 3.6700637888994484`*^9, 3.6700638556113806`*^9, 
   3.6700644343443203`*^9, 3.6700651777255006`*^9, 3.670065256772895*^9, 
   3.670065641794962*^9, 3.670065732633763*^9}],

Cell[BoxData["\<\"Done\"\>"], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.670057995224659*^9, 3.670058550075041*^9, 3.670058585692855*^9, {
   3.6700586406922984`*^9, 3.670058662285692*^9}, {3.6700587082436404`*^9, 
   3.670058724437513*^9}, 3.6700591595712414`*^9, 3.6700591945040464`*^9, 
   3.6700592713726616`*^9, {3.670059347539632*^9, 3.6700593843559237`*^9}, 
   3.6700596512862825`*^9, 3.670059752970894*^9, 3.670059788274927*^9, 
   3.6700630011946826`*^9, {3.6700632830500574`*^9, 3.670063303311368*^9}, 
   3.6700634222653565`*^9, 3.670063590772879*^9, {3.670063717758592*^9, 
   3.670063737664942*^9}, 3.6700637888994484`*^9, 3.6700638556113806`*^9, 
   3.6700644343443203`*^9, 3.6700651777255006`*^9, 3.670065256772895*^9, 
   3.670065641794962*^9, 3.6700657330869102`*^9}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    TagBox["minor",
     HoldForm], "[", 
    RowBox[{"1", ",", "5", ",", "6"}], "]"}], 
   RowBox[{
    RowBox[{
     TagBox["minor",
      HoldForm], "[", 
     RowBox[{"1", ",", "2", ",", "5"}], "]"}], " ", 
    RowBox[{
     TagBox["minor",
      HoldForm], "[", 
     RowBox[{"1", ",", "2", ",", "6"}], "]"}], " ", 
    RowBox[{
     TagBox["minor",
      HoldForm], "[", 
     RowBox[{"1", ",", "3", ",", "6"}], "]"}], " ", 
    RowBox[{
     TagBox["minor",
      HoldForm], "[", 
     RowBox[{"1", ",", "4", ",", "6"}], "]"}], " ", 
    RowBox[{
     TagBox["minor",
      HoldForm], "[", 
     RowBox[{"2", ",", "4", ",", "5"}], "]"}], " ", 
    RowBox[{
     TagBox["minor",
      HoldForm], "[", 
     RowBox[{"3", ",", "4", ",", "5"}], "]"}], " ", 
    RowBox[{
     TagBox["minor",
      HoldForm], "[", 
     RowBox[{"3", ",", "5", ",", "6"}], "]"}]}]]}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.670063737711817*^9, 3.670063788977791*^9, 3.6700638556582565`*^9, 
   3.670064434422449*^9, 3.670065177803632*^9, 3.670065256772895*^9, {
   3.670065715323821*^9, 3.670065733149414*^9}}]
}, Closed]],

Cell[BoxData[""], "Input",
 PageWidth->WindowWidth,
 CellChangeTimes->{{3.666696031776988*^9, 3.6666960320895057`*^9}}],

Cell[CellGroupData[{

Cell["Here is all of the code in allBFTfunctions", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6383446299830313`*^9, 3.6383446727849455`*^9}, 
   3.638344710554902*^9, {3.64224303461718*^9, 3.642243068687608*^9}, {
   3.6422454702081013`*^9, 3.6422455111219*^9}, {3.64224555395127*^9, 
   3.6422455767021837`*^9}, {3.642245629828741*^9, 3.642245680063313*^9}, 
   3.6506921124964247`*^9, {3.661686864705759*^9, 3.6616868958526716`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "To", " ", "calculate", " ", "the", " ", "dimension", " ", "of", " ", "a", 
    " ", "polytope"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"BFTdim", "[", "mat_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"newsp", ",", "gi", ",", "dim"}], "}"}], ",", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", "mat", "]"}], ",", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0", ",", 
             RowBox[{"Length", "[", "mat", "]"}]}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"dim", "=", 
           RowBox[{"MatrixRank", "[", "mat", "]"}]}], ";"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{
          RowBox[{"newsp", "=", "mat"}], ";", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"gi", "=", "1"}], ",", 
            RowBox[{"gi", "<", 
             RowBox[{
              RowBox[{
               RowBox[{"Dimensions", "[", "mat", "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "1"}]}], ",", 
            RowBox[{"gi", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"newsp", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "gi"}], "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{"newsp", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "gi"}], "]"}], "]"}], "-", 
               RowBox[{"mat", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"dim", "=", 
           RowBox[{"MatrixRank", "[", "newsp", "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "dim"}]}], "]"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"DONE", ",", " ", 
    RowBox[{"NOW", " ", "CALLED", " ", "polytopeDim"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "To", " ", "obtain", " ", "the", " ", "coordinates", " ", "of", " ", "a", 
     " ", "polytope"}], ",", " ", 
    RowBox[{
    "with", " ", "the", " ", "shift", " ", "such", " ", "that", " ", "one", 
     " ", "vertex", " ", "is", " ", "at", " ", "the", " ", 
     RowBox[{"origin", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"polytope", "[", "mat_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"newsp", ",", "gi"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"newsp", "=", "mat"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"FreeQ", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", "mat", "]"}], ",", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0", ",", 
             RowBox[{"Length", "[", "mat", "]"}]}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"gi", "=", "1"}], ",", 
            RowBox[{"gi", "<", 
             RowBox[{
              RowBox[{
               RowBox[{"Dimensions", "[", "mat", "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "1"}]}], ",", 
            RowBox[{"gi", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"newsp", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "gi"}], "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{"newsp", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "gi"}], "]"}], "]"}], "-", 
               RowBox[{"mat", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"newsp", "=", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{
          RowBox[{"RowReduce", "[", "newsp", "]"}], ",", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", 
            RowBox[{
             RowBox[{"Dimensions", "[", "mat", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "newsp"}]}], "]"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", "SKIPPED", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Calculates", " ", "the", " ", "contour", " ", "integral", " ", "circled", 
    " ", "at", " ", "infinity", " ", 
    RowBox[{"(", 
     RowBox[{"takes", " ", "into", " ", "account", " ", "all", " ", "poles"}],
      ")"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"contourint", "[", 
     RowBox[{"func_", ",", "var_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"sols", ",", "tot", ",", "i"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sols", "=", 
        RowBox[{"Solve", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Denominator", "[", "func", "]"}], "\[Equal]", "0"}], ",", 
          "var"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"sols", "=", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"Sequence", "@@@", 
          RowBox[{"(", 
           RowBox[{"sols", "/.", 
            RowBox[{"{", 
             RowBox[{"Rule", "\[Rule]", "List"}], "}"}]}], ")"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"tot", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", "sols", "]"}], "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tot", "=", 
           RowBox[{"tot", "+", 
            RowBox[{"2", "Pi", " ", "I", " ", 
             RowBox[{"Residue", "[", 
              RowBox[{"func", ",", 
               RowBox[{"sols", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}]}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "tot"}]}], 
     "\[IndentingNewLine]", "]"}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "SKIPPED", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Gives", " ", "you", " ", "the", " ", "total", " ", "number", " ", "of", 
    " ", 
    RowBox[{"faces", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"totFaces", "[", 
     RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "K0full", ",", "K0flatX", ",", "facelist", ",", "i", ",", "nf"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"K0full", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{"a", ",", "c"}], "]"}], ",", 
          RowBox[{"Join", "[", 
           RowBox[{"b", ",", "d"}], "]"}], ",", "2"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"K0flatX", "=", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", "K0full", "]"}], ",", "0"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"K0flatX", "=", 
        RowBox[{"Sequence", "@@@", 
         RowBox[{"(", 
          RowBox[{"MapThread", "[", 
           RowBox[{"MonomialList", ",", 
            RowBox[{"{", "K0flatX", "}"}]}], "]"}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"facelist", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", "K0flatX", "]"}], "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"facelist", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"facelist", ",", 
             RowBox[{"{", 
              RowBox[{"sub1", "[", 
               RowBox[{"K0flatX", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"facelist", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"facelist", ",", 
             RowBox[{"{", 
              RowBox[{"sub2", "[", 
               RowBox[{"K0flatX", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], "}"}]}], "]"}]}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"facelist", "=", 
        RowBox[{"DeleteDuplicates", "[", "facelist", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"nf", "=", 
        RowBox[{"Length", "[", "facelist", "]"}]}], ";", 
       "\[IndentingNewLine]", "nf"}]}], "\[IndentingNewLine]", "]"}]}], 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"DONE", ",", " ", 
    RowBox[{"SAME", " ", "NAME"}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Gives", " ", "you", " ", "the", " ", "number", " ", "of", " ", "external",
     " ", 
    RowBox[{"faces", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"externalFaces", "[", 
     RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"flatext", ",", "extfacelist", ",", "i", ",", "extn"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"flatext", "=", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", "b", "]"}], ",", 
            RowBox[{"Flatten", "[", "c", "]"}]}], "]"}], ",", "0"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"flatext", "=", 
        RowBox[{"Sequence", "@@@", 
         RowBox[{"(", 
          RowBox[{"MapThread", "[", 
           RowBox[{"MonomialList", ",", 
            RowBox[{"{", "flatext", "}"}]}], "]"}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"extfacelist", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", "flatext", "]"}], "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"extfacelist", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"extfacelist", ",", 
             RowBox[{"{", 
              RowBox[{"sub1", "[", 
               RowBox[{"flatext", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"extfacelist", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"extfacelist", ",", 
             RowBox[{"{", 
              RowBox[{"sub2", "[", 
               RowBox[{"flatext", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], "}"}]}], "]"}]}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"extfacelist", "=", 
        RowBox[{"DeleteDuplicates", "[", "extfacelist", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"extn", "=", 
        RowBox[{"Length", "[", "extfacelist", "]"}]}], ";", 
       "\[IndentingNewLine]", "extn"}]}], "\[IndentingNewLine]", "]"}]}], 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"DONE", ",", " ", 
    RowBox[{"SAME", " ", "NAME"}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Gives", " ", "you", " ", "the", " ", "number", " ", "of", " ", "internal",
     " ", 
    RowBox[{"faces", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"internalFaces", "[", 
     RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "intn", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"intn", "=", 
        RowBox[{
         RowBox[{"totFaces", "[", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "-", 
         RowBox[{"externalFaces", "[", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", "intn"}]}], "\[IndentingNewLine]", "]"}]}], 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"DONE", ",", " ", 
    RowBox[{"SAME", " ", "NAME"}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Gives", " ", "True", " ", "if", " ", "\"\<fullspace\>\"", " ", "is", " ",
      "reducible"}], ",", " ", 
    RowBox[{"or", " ", "False", " ", "if", " ", "it", " ", 
     RowBox[{"isn", "'"}], 
     RowBox[{"t", ".", " ", "Fullspace"}], " ", "is", " ", "in", " ", "the", 
     " ", "form", " ", "of", " ", "the", " ", "perfect", " ", "matching", " ",
      "matrix", " ", 
     RowBox[{"P", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"reducibility", "[", 
     RowBox[{"fullspace_", ",", "moduli_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "coordi", ",", "red", ",", "columnlist", ",", "po", ",", "ps", ",", 
        "Pshort"}], "}"}], ",", 
      RowBox[{"(*", 
       RowBox[{
       "First", " ", "need", " ", "to", " ", "find", " ", "out", " ", "which",
         " ", "columns", " ", "are", " ", "the", " ", "same", " ", "point", 
        " ", "in", " ", "the", " ", "moduli", " ", "space"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"coordi", "=", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"Transpose", "[", "moduli", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"columnlist", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"po", "=", "1"}], ",", 
         RowBox[{"po", "<", 
          RowBox[{
           RowBox[{"Length", "[", "coordi", "]"}], "+", "1"}]}], ",", 
         RowBox[{"po", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"columnlist", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"columnlist", ",", 
             RowBox[{"Transpose", "[", 
              RowBox[{"Position", "[", 
               RowBox[{
                RowBox[{"Transpose", "[", "moduli", "]"}], ",", 
                RowBox[{"coordi", "[", 
                 RowBox[{"[", "po", "]"}], "]"}]}], "]"}], "]"}]}], "]"}]}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "Now", " ", "we", " ", "know", " ", "which", " ", "columns", " ", 
         "represent", " ", "the", " ", "same", " ", "point", " ", "in", " ", 
         "the", " ", "toric", " ", 
         RowBox[{"diagram", "!"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Pshort", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{"Length", "[", "fullspace", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", 
            RowBox[{"Length", "[", "columnlist", "]"}]}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"ps", "=", "1"}], ",", 
         RowBox[{"ps", "<", 
          RowBox[{
           RowBox[{"Length", "[", "columnlist", "]"}], "+", "1"}]}], ",", 
         RowBox[{"ps", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Pshort", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "ps"}], "]"}], "]"}], "=", 
           RowBox[{"Product", "[", 
            RowBox[{
             RowBox[{"fullspace", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", 
                RowBox[{"columnlist", "[", 
                 RowBox[{"[", 
                  RowBox[{"ps", ",", "i"}], "]"}], "]"}]}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "[", 
                RowBox[{"columnlist", "[", 
                 RowBox[{"[", "ps", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"Pshort", ",", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0", ",", 
             RowBox[{
              RowBox[{"Dimensions", "[", "Pshort", "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
         RowBox[{"red", "=", "True"}], ",", 
         RowBox[{"red", "=", "False"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "red"}]}], "\[IndentingNewLine]", "]"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"DONE", "!"}], " ", "NOW", " ", "CALLED", " ", 
    "reducibilityBFTQ"}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Draws", " ", "the", " ", "graph", " ", "in", " ", "a", " ", "way", " ", 
     "that", " ", "is", " ", "as", " ", "planar", " ", "as", " ", "possible", 
     " ", "to", " ", "help", " ", "you", " ", "to", " ", "work", " ", "out", 
     " ", "how", " ", "many", " ", "boundaries", " ", "it", " ", "must", " ", 
     "have"}], ",", " ", 
    RowBox[{
    "and", " ", "whether", " ", "it", " ", "can", " ", "be", " ", "drawn", 
     " ", "on", " ", "a", " ", "genus", " ", "zero", " ", 
     RowBox[{"surface", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"planarity", "[", 
     RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "kasta", ",", "bigamat", ",", "multiguys", ",", "newbigamat", ",", 
        "nu", ",", "tofix", ",", "coltoadd", ",", "rowtoadd", ",", "du", ",", 
        "graph"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"kasta", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{"a", ",", "c"}], "]"}], ",", 
          RowBox[{"Join", "[", 
           RowBox[{"b", ",", "d"}], "]"}], ",", "2"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Now", " ", "make", " ", "the", " ", "weighted", " ", "adjacency", 
         " ", "matrix"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"bigamat", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{"0", ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", 
                RowBox[{"Length", "[", "kasta", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", 
                RowBox[{"Length", "[", "kasta", "]"}]}], "}"}]}], "]"}], ",", 
            RowBox[{"Transpose", "[", "kasta", "]"}]}], "]"}], ",", 
          RowBox[{"Join", "[", 
           RowBox[{"kasta", ",", 
            RowBox[{"Table", "[", 
             RowBox[{"0", ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", 
                RowBox[{
                 RowBox[{"Dimensions", "[", "kasta", "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", 
                RowBox[{
                 RowBox[{"Dimensions", "[", "kasta", "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], "]"}], 
          ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"multiguys", "=", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Sort", ",", 
           RowBox[{"{", 
            RowBox[{"Position", "[", 
             RowBox[{
              RowBox[{"MapThread", "[", 
               RowBox[{"Length", ",", 
                RowBox[{"{", 
                 RowBox[{"MonomialList", "[", "bigamat", "]"}], "}"}], ",", 
                "2"}], "]"}], ",", 
              RowBox[{"x_", "/;", 
               RowBox[{"x", ">", "1"}]}]}], "]"}], "}"}]}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"newbigamat", "=", "bigamat"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"nu", "=", "1"}], ",", 
         RowBox[{"nu", "<", 
          RowBox[{
           RowBox[{"Length", "[", "multiguys", "]"}], "+", "1"}]}], ",", 
         RowBox[{"nu", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tofix", "=", 
           RowBox[{"MonomialList", "[", 
            RowBox[{"bigamat", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{
                RowBox[{"multiguys", "[", 
                 RowBox[{"[", "nu", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"multiguys", "[", 
                 RowBox[{"[", "nu", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
             RowBox[{"we", "'"}], "ll", " ", "now", " ", "need", " ", "to", 
             " ", "add", " ", "a", " ", "certain", " ", "number", " ", "of", 
             " ", "columns", " ", "and", " ", "rows"}], ",", " ", 
            RowBox[{
            "so", " ", "that", " ", "multiedges", " ", "get", " ", "their", 
             " ", "own", " ", "node", " ", "at", " ", "the", " ", "midway", 
             " ", "point"}], ",", " ", 
            RowBox[{"and", " ", "hence", " ", 
             RowBox[{"don", "'"}], "t", " ", 
             RowBox[{"overlap", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"coltoadd", "=", 
           RowBox[{"Table", "[", 
            RowBox[{"0", ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", 
               RowBox[{"Length", "[", "newbigamat", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"y", ",", 
               RowBox[{
                RowBox[{"Length", "[", "tofix", "]"}], "-", "1"}]}], "}"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"du", "=", "2"}], ",", 
            RowBox[{"du", "<", 
             RowBox[{
              RowBox[{"Length", "[", "tofix", "]"}], "+", "1"}]}], ",", 
            RowBox[{"du", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"coltoadd", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"multiguys", "[", 
                   RowBox[{"[", "nu", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"du", "-", "1"}]}], "]"}], "]"}], "=", 
              RowBox[{"tofix", "[", 
               RowBox[{"[", "du", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"coltoadd", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"multiguys", "[", 
                   RowBox[{"[", "nu", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                 RowBox[{"du", "-", "1"}]}], "]"}], "]"}], "=", 
              RowBox[{"tofix", "[", 
               RowBox[{"[", "du", "]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"rowtoadd", "=", 
           RowBox[{"Table", "[", 
            RowBox[{"0", ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", 
               RowBox[{
                RowBox[{"Length", "[", "tofix", "]"}], "-", "1"}]}], "}"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"y", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Dimensions", "[", "newbigamat", "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "+", 
                RowBox[{"Length", "[", "tofix", "]"}], "-", "1"}]}], "}"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"du", "=", "2"}], ",", 
            RowBox[{"du", "<", 
             RowBox[{
              RowBox[{"Length", "[", "tofix", "]"}], "+", "1"}]}], ",", 
            RowBox[{"du", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"rowtoadd", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"du", "-", "1"}], ",", 
                 RowBox[{
                  RowBox[{"multiguys", "[", 
                   RowBox[{"[", "nu", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "=", 
              RowBox[{"tofix", "[", 
               RowBox[{"[", "du", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"rowtoadd", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"du", "-", "1"}], ",", 
                 RowBox[{
                  RowBox[{"multiguys", "[", 
                   RowBox[{"[", "nu", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "=", 
              RowBox[{"tofix", "[", 
               RowBox[{"[", "du", "]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"newbigamat", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"newbigamat", ",", "coltoadd", ",", "2"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"newbigamat", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"newbigamat", ",", "rowtoadd"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"newbigamat", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{
               RowBox[{"multiguys", "[", 
                RowBox[{"[", "nu", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"multiguys", "[", 
                RowBox[{"[", "nu", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "=", 
           RowBox[{"tofix", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"newbigamat", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{
               RowBox[{"multiguys", "[", 
                RowBox[{"[", "nu", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"multiguys", "[", 
                RowBox[{"[", "nu", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "=", 
           RowBox[{"tofix", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"newbigamat", "=", 
        RowBox[{"newbigamat", "/.", 
         RowBox[{"{", 
          RowBox[{"0", "\[Rule]", "\[Infinity]"}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"graph", "=", 
        RowBox[{"WeightedAdjacencyGraph", "[", "newbigamat", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"PlanarGraphQ", "[", "graph", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "Print", "[", 
           "\"\<The graph can be written in a genus 0 surface, i.e. the plane \
with a certain number of boundaries.\>\"", "]"}], ";"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{
         "Print", "[", 
          "\"\<The graph CANNOT be written in a genus 0 surface! You have \
genus > 0 .\>\"", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", 
        "\"\<This is the graph as Mathematica preferes to draw it (usually \
Mathematica preferes to draw it without crossings, so the presence of \
crossings is usually an indicator for nonplanarity):\>\"", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"WeightedAdjacencyGraph", "[", 
         RowBox[{"newbigamat", ",", 
          RowBox[{"VertexLabels", "\[Rule]", "\"\<Name\>\""}]}], "]"}], "]"}],
        ";", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", 
        "\"\<This is the graph when Mathematica has been explicitly told to \
avoid edge crossings (Mathematica will usually try and do it with the \
smallest number of boundaries):\>\"", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"WeightedAdjacencyGraph", "[", 
         RowBox[{"newbigamat", ",", 
          RowBox[{"GraphLayout", "\[Rule]", "\"\<PlanarEmbedding\>\""}], ",", 
          RowBox[{"VertexLabels", "\[Rule]", "\"\<Name\>\""}], ",", 
          RowBox[{"ImagePadding", "\[Rule]", "20"}]}], "]"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"DONE", ",", " ", 
    RowBox[{"NOW", " ", "CALLED", " ", "planarityQ"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Draws", " ", "the", " ", "bipartite", " ", "graph", " ", "associated", 
    " ", "to", " ", "the", " ", "Kasteleyn", " ", "matrix"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"drawBFT", "[", 
     RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "kasta", ",", "bigamat", ",", "multiguys", ",", "newbigamat", ",", 
        "nu", ",", "tofix", ",", "coltoadd", ",", "rowtoadd", ",", "du", ",", 
        "edgelabs", ",", "colors", ",", "ai", ",", "aj"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"kasta", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{"a", ",", "c"}], "]"}], ",", 
          RowBox[{"Join", "[", 
           RowBox[{"b", ",", "d"}], "]"}], ",", "2"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Now", " ", "make", " ", "the", " ", "weighted", " ", "adjacency", 
         " ", "matrix"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"bigamat", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{"0", ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", 
                RowBox[{"Length", "[", "kasta", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", 
                RowBox[{"Length", "[", "kasta", "]"}]}], "}"}]}], "]"}], ",", 
            RowBox[{"Transpose", "[", "kasta", "]"}]}], "]"}], ",", 
          RowBox[{"Join", "[", 
           RowBox[{"kasta", ",", 
            RowBox[{"Table", "[", 
             RowBox[{"0", ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", 
                RowBox[{
                 RowBox[{"Dimensions", "[", "kasta", "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", 
                RowBox[{
                 RowBox[{"Dimensions", "[", "kasta", "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], "]"}], 
          ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"multiguys", "=", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Sort", ",", 
           RowBox[{"{", 
            RowBox[{"Position", "[", 
             RowBox[{
              RowBox[{"MapThread", "[", 
               RowBox[{"Length", ",", 
                RowBox[{"{", 
                 RowBox[{"MonomialList", "[", "bigamat", "]"}], "}"}], ",", 
                "2"}], "]"}], ",", 
              RowBox[{"x_", "/;", 
               RowBox[{"x", ">", "1"}]}]}], "]"}], "}"}]}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"newbigamat", "=", "bigamat"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"nu", "=", "1"}], ",", 
         RowBox[{"nu", "<", 
          RowBox[{
           RowBox[{"Length", "[", "multiguys", "]"}], "+", "1"}]}], ",", 
         RowBox[{"nu", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tofix", "=", 
           RowBox[{"MonomialList", "[", 
            RowBox[{"bigamat", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{
                RowBox[{"multiguys", "[", 
                 RowBox[{"[", "nu", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"multiguys", "[", 
                 RowBox[{"[", "nu", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
             RowBox[{"we", "'"}], "ll", " ", "now", " ", "need", " ", "to", 
             " ", "add", " ", "a", " ", "certain", " ", "number", " ", "of", 
             " ", "columns", " ", "and", " ", "rows"}], ",", " ", 
            RowBox[{
            "so", " ", "that", " ", "multiedges", " ", "get", " ", "their", 
             " ", "own", " ", "node", " ", "at", " ", "the", " ", "midway", 
             " ", "point"}], ",", " ", 
            RowBox[{"and", " ", "hence", " ", 
             RowBox[{"don", "'"}], "t", " ", 
             RowBox[{"overlap", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"coltoadd", "=", 
           RowBox[{"Table", "[", 
            RowBox[{"0", ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", 
               RowBox[{"Length", "[", "newbigamat", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"y", ",", 
               RowBox[{
                RowBox[{"Length", "[", "tofix", "]"}], "-", "1"}]}], "}"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"du", "=", "2"}], ",", 
            RowBox[{"du", "<", 
             RowBox[{
              RowBox[{"Length", "[", "tofix", "]"}], "+", "1"}]}], ",", 
            RowBox[{"du", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"coltoadd", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"multiguys", "[", 
                   RowBox[{"[", "nu", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"du", "-", "1"}]}], "]"}], "]"}], "=", 
              RowBox[{"tofix", "[", 
               RowBox[{"[", "du", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"coltoadd", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"multiguys", "[", 
                   RowBox[{"[", "nu", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                 RowBox[{"du", "-", "1"}]}], "]"}], "]"}], "=", 
              RowBox[{"tofix", "[", 
               RowBox[{"[", "du", "]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"rowtoadd", "=", 
           RowBox[{"Table", "[", 
            RowBox[{"0", ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", 
               RowBox[{
                RowBox[{"Length", "[", "tofix", "]"}], "-", "1"}]}], "}"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"y", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Dimensions", "[", "newbigamat", "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "+", 
                RowBox[{"Length", "[", "tofix", "]"}], "-", "1"}]}], "}"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"du", "=", "2"}], ",", 
            RowBox[{"du", "<", 
             RowBox[{
              RowBox[{"Length", "[", "tofix", "]"}], "+", "1"}]}], ",", 
            RowBox[{"du", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"rowtoadd", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"du", "-", "1"}], ",", 
                 RowBox[{
                  RowBox[{"multiguys", "[", 
                   RowBox[{"[", "nu", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "=", 
              RowBox[{"tofix", "[", 
               RowBox[{"[", "du", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"rowtoadd", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"du", "-", "1"}], ",", 
                 RowBox[{
                  RowBox[{"multiguys", "[", 
                   RowBox[{"[", "nu", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "=", 
              RowBox[{"tofix", "[", 
               RowBox[{"[", "du", "]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"newbigamat", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"newbigamat", ",", "coltoadd", ",", "2"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"newbigamat", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"newbigamat", ",", "rowtoadd"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"newbigamat", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{
               RowBox[{"multiguys", "[", 
                RowBox[{"[", "nu", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"multiguys", "[", 
                RowBox[{"[", "nu", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "=", 
           RowBox[{"tofix", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"newbigamat", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{
               RowBox[{"multiguys", "[", 
                RowBox[{"[", "nu", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"multiguys", "[", 
                RowBox[{"[", "nu", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "=", 
           RowBox[{"tofix", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"colors", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"MapThread", "[", 
           RowBox[{"Rule", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Range", "[", 
               RowBox[{"Length", "[", 
                RowBox[{"Join", "[", 
                 RowBox[{"a", ",", "c"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"ConstantArray", "[", 
               RowBox[{"White", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"Join", "[", 
                  RowBox[{"a", ",", "c"}], "]"}], "]"}]}], "]"}]}], "}"}]}], 
           "]"}], ",", 
          RowBox[{"MapThread", "[", 
           RowBox[{"Rule", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Range", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", 
                  RowBox[{"Join", "[", 
                   RowBox[{"a", ",", "c"}], "]"}], "]"}], "+", "1"}], ",", 
                RowBox[{
                 RowBox[{"Length", "[", 
                  RowBox[{"Join", "[", 
                   RowBox[{"a", ",", "c"}], "]"}], "]"}], "+", 
                 RowBox[{
                  RowBox[{"Dimensions", "[", 
                   RowBox[{"Join", "[", 
                    RowBox[{"a", ",", "b", ",", "2"}], "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], ",", 
              RowBox[{"ConstantArray", "[", 
               RowBox[{"Black", ",", 
                RowBox[{
                 RowBox[{"Dimensions", "[", 
                  RowBox[{"Join", "[", 
                   RowBox[{"a", ",", "b", ",", "2"}], "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "}"}]}], "]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"edgelabs", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"ai", "=", "1"}], ",", 
         RowBox[{"ai", "<", 
          RowBox[{
           RowBox[{"Length", "[", "newbigamat", "]"}], "+", "1"}]}], ",", 
         RowBox[{"ai", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"aj", "=", "ai"}], ",", 
            RowBox[{"aj", "<", 
             RowBox[{
              RowBox[{
               RowBox[{"Dimensions", "[", "newbigamat", "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "1"}]}], ",", 
            RowBox[{"aj", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"newbigamat", "[", 
                 RowBox[{"[", 
                  RowBox[{"ai", ",", "aj"}], "]"}], "]"}], "\[Equal]", "0"}], 
               ",", "True", ",", "True", ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"edgelabs", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{"edgelabs", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ai", "\[UndirectedEdge]", "aj"}], "\[Rule]", 
                    RowBox[{"newbigamat", "[", 
                    RowBox[{"[", 
                    RowBox[{"ai", ",", "aj"}], "]"}], "]"}]}], "}"}]}], 
                  "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"newbigamat", "=", 
        RowBox[{"newbigamat", "/.", 
         RowBox[{"{", 
          RowBox[{"0", "\[Rule]", "\[Infinity]"}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"WeightedAdjacencyGraph", "[", 
         RowBox[{"newbigamat", ",", 
          RowBox[{"EdgeLabels", "\[Rule]", "edgelabs"}], ",", 
          RowBox[{"VertexLabels", "\[Rule]", "\"\<Name\>\""}], ",", 
          RowBox[{"VertexLabelStyle", "\[Rule]", "15"}], ",", 
          RowBox[{"VertexSize", "\[Rule]", "Medium"}], ",", 
          RowBox[{"VertexStyle", "\[Rule]", "colors"}], ",", 
          RowBox[{"ImagePadding", "\[Rule]", "20"}]}], "]"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"DONE", ",", " ", 
    RowBox[{"NOW", " ", "CALLED", " ", "viewGraph"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Swaps", " ", "the", " ", "columns", " ", "\"\<col1\>\"", " ", "and", " ", 
    "\"\<col2\>\"", "of", " ", "\"\<matrix\>\""}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"columnswap", "[", 
     RowBox[{"matrix_", ",", "col1_", ",", "col2_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"newmat", ",", "rule", ",", "rightorder", ",", "ii"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"newmat", "=", 
        RowBox[{"Transpose", "[", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             RowBox[{"Length", "[", "matrix", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"y", ",", 
             RowBox[{
              RowBox[{"Dimensions", "[", "matrix", "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"rule", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"col1", "\[Rule]", "col2"}], ",", 
          RowBox[{"col2", "\[Rule]", "col1"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"rightorder", "=", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{
           RowBox[{"Dimensions", "[", "matrix", "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}], "/.", "rule"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"ii", "=", "1"}], ",", 
         RowBox[{"ii", "<", 
          RowBox[{
           RowBox[{"Length", "[", "rightorder", "]"}], "+", "1"}]}], ",", 
         RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"newmat", "[", 
            RowBox[{"[", "ii", "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{"Transpose", "[", "matrix", "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"rightorder", "[", 
              RowBox[{"[", "ii", "]"}], "]"}], "]"}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"newmat", "=", 
        RowBox[{"Transpose", "[", "newmat", "]"}]}], ";", 
       "\[IndentingNewLine]", "newmat"}]}], "\[IndentingNewLine]", "]"}]}], 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"SKIPPED", ",", " ", 
    RowBox[{"CAN", " ", "BE", " ", "DONE", " ", 
     RowBox[{"WITH", " ", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", 
        RowBox[{"{", 
         RowBox[{"...", ",", "col2", ",", "...", ",", "col1", ",", "..."}], 
         "}"}]}], "]"}], "]"}]}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Swaps", " ", "the", " ", "rows", " ", "\"\<row1\>\"", " ", "and", " ", 
    "\"\<row2\>\"", "of", " ", "\"\<matrix\>\""}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"rowswap", "[", 
     RowBox[{"matrix_", ",", "row1_", ",", "row2_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"newmat", ",", "rule", ",", "rightorder", ",", "ii"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"newmat", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{"Length", "[", "matrix", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", 
            RowBox[{
             RowBox[{"Dimensions", "[", "matrix", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"rule", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"row1", "\[Rule]", "row2"}], ",", 
          RowBox[{"row2", "\[Rule]", "row1"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"rightorder", "=", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{"Length", "[", "matrix", "]"}], "]"}], "/.", "rule"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"ii", "=", "1"}], ",", 
         RowBox[{"ii", "<", 
          RowBox[{
           RowBox[{"Length", "[", "rightorder", "]"}], "+", "1"}]}], ",", 
         RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"newmat", "[", 
            RowBox[{"[", "ii", "]"}], "]"}], "=", 
           RowBox[{"matrix", "[", 
            RowBox[{"[", 
             RowBox[{"rightorder", "[", 
              RowBox[{"[", "ii", "]"}], "]"}], "]"}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "newmat"}]}], "\[IndentingNewLine]", "]"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"SKIPPED", ",", " ", 
    RowBox[{"CAN", " ", "BE", " ", "DONE", " ", 
     RowBox[{"WITH", " ", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", 
        RowBox[{"{", 
         RowBox[{"...", ",", "col2", ",", "...", ",", "col1", ",", "..."}], 
         "}"}]}], "]"}], "]"}]}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Calculates", " ", "all", " ", "perfect", " ", "matchings"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"kasteleyn", "[", 
     RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "K0full", ",", "K0flatX", ",", "dupl", ",", "dupllist", ",", "bnset", 
        ",", "bnlength", ",", "cnset", ",", "cnlength", ",", "cnsub", ",", 
        "bnsub", ",", "i", ",", "j", ",", "totrow", ",", "totcol", ",", 
        "colsurplus", ",", "rowsurplus", ",", "num", ",", "contr", ",", 
        "bnew", ",", "cnew", ",", "dnew", ",", "part1", ",", "part2", ",", 
        "added", ",", "kk", ",", "finalcontr", ",", "finaladd", ",", "p", ",",
         "X", ",", "BigP", ",", "Pext", ",", "Pint", ",", "ai", ",", "ji", 
        ",", "jir", ",", "signs", ",", "ii", ",", "rowguys", ",", "relguy", 
        ",", "found", ",", "jj"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"K0full", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{"a", ",", "c"}], "]"}], ",", 
          RowBox[{"Join", "[", 
           RowBox[{"b", ",", "d"}], "]"}], ",", "2"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<\!\(\*SubscriptBox[\(K\), \(0\)]\) = \>\"", ",", 
         RowBox[{"K0full", "//", "MatrixForm"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Check", " ", "that", " ", "a", " ", "field", " ", 
         RowBox[{"hasn", "'"}], "t", " ", "been", " ", "entered", " ", "in", 
         " ", 
         RowBox[{"twice", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"K0flatX", "=", 
        RowBox[{"Sort", "[", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", "K0full", "]"}], ",", "0"}], "]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"K0flatX", "=", 
        RowBox[{"Sequence", "@@@", 
         RowBox[{"(", 
          RowBox[{"MapThread", "[", 
           RowBox[{"MonomialList", ",", 
            RowBox[{"{", "K0flatX", "}"}]}], "]"}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Made", " ", "a", " ", "list", " ", "with", " ", "all", " ", 
         "variables", " ", "in", " ", 
         SubscriptBox["K", "0"], " ", "excluding", " ", "zeroes"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"dupl", "=", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Split", "[", 
           RowBox[{"Sort", "[", "K0flatX", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "#", "]"}], "\[GreaterEqual]", "2"}], 
           "&"}]}], "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{"These", " ", "are", " ", "the", " ", 
         RowBox[{"duplicates", "!"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"dupllist", "=", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"Flatten", "[", "dupl", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "dupl", "]"}], "\[NotEqual]", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "Print", "[", 
           "\"\<In \!\(\*SubscriptBox[\(K\), \(0\)]\) there are several \
fields with the same name!!! ERROR\>\"", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<The duplicated fields are \>\"", ",", "dupllist"}], 
           "]"}], ";"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "Print", "[", "\"\<Matrix is OK, there are no doubles.\>\"", "]"}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Consistency", " ", 
         RowBox[{"check", ":", " ", 
          RowBox[{
          "see", " ", "whether", " ", "the", " ", "rows", " ", "have", " ", 
           "cyclic", " ", 
           RowBox[{"indices", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"ii", "=", "1"}], ",", 
         RowBox[{"ii", "<", 
          RowBox[{
           RowBox[{"Length", "[", "K0full", "]"}], "+", "1"}]}], ",", 
         RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"rowguys", "=", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{
             RowBox[{"K0full", "[", 
              RowBox[{"[", "ii", "]"}], "]"}], ",", "0"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"rowguys", "=", 
           RowBox[{"Sequence", "@@@", 
            RowBox[{"(", 
             RowBox[{"MapThread", "[", 
              RowBox[{"MonomialList", ",", 
               RowBox[{"{", "rowguys", "}"}]}], "]"}], ")"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"relguy", "=", 
           RowBox[{"rowguys", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"rowguys", "=", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{"rowguys", ",", "relguy"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{"rowguys", "\[NotEqual]", 
             RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"found", "=", "0"}], ";", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"jj", "=", "1"}], ",", 
               RowBox[{"jj", "<", 
                RowBox[{
                 RowBox[{"Length", "[", "rowguys", "]"}], "+", "1"}]}], ",", 
               RowBox[{"jj", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"sub1", "[", 
                    RowBox[{"rowguys", "[", 
                    RowBox[{"[", "jj", "]"}], "]"}], "]"}], "\[Equal]", 
                   RowBox[{"sub2", "[", "relguy", "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"found", "=", "1"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"relguy", "=", 
                    RowBox[{"rowguys", "[", 
                    RowBox[{"[", "jj", "]"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"rowguys", "=", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{"rowguys", ",", 
                    RowBox[{"rowguys", "[", 
                    RowBox[{"[", "jj", "]"}], "]"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", 
                 "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"If", " ", "the", " ", "guy", " ", 
                RowBox[{"we", "'"}], "re", " ", "looking", " ", "for", " ", 
                RowBox[{"doesn", "'"}], "t", " ", "exist"}], ",", " ", 
               RowBox[{"say", " ", "so"}]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"found", "\[Equal]", "0"}], ",", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{
                 "\"\<Mistake in row \>\"", ",", "ii", ",", 
                  "\"\< of Kasteleyn! Someone has a wrong name, or there's an \
extra field.\>\""}], "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}],
              ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Consistency", " ", 
         RowBox[{"check", ":", " ", 
          RowBox[{
          "now", " ", "check", " ", "the", " ", "indices", " ", "of", " ", 
           "the", " ", 
           RowBox[{"columns", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"ii", "=", "1"}], ",", 
         RowBox[{"ii", "<", 
          RowBox[{
           RowBox[{
            RowBox[{"Dimensions", "[", "K0full", "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", "1"}]}], ",", 
         RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"rowguys", "=", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Transpose", "[", "K0full", "]"}], "[", 
              RowBox[{"[", "ii", "]"}], "]"}], ",", "0"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"rowguys", "=", 
           RowBox[{"Sequence", "@@@", 
            RowBox[{"(", 
             RowBox[{"MapThread", "[", 
              RowBox[{"MonomialList", ",", 
               RowBox[{"{", "rowguys", "}"}]}], "]"}], ")"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"relguy", "=", 
           RowBox[{"rowguys", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"rowguys", "=", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{"rowguys", ",", "relguy"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{"rowguys", "\[NotEqual]", 
             RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"found", "=", "0"}], ";", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"jj", "=", "1"}], ",", 
               RowBox[{"jj", "<", 
                RowBox[{
                 RowBox[{"Length", "[", "rowguys", "]"}], "+", "1"}]}], ",", 
               RowBox[{"jj", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"sub1", "[", 
                    RowBox[{"rowguys", "[", 
                    RowBox[{"[", "jj", "]"}], "]"}], "]"}], "\[Equal]", 
                   RowBox[{"sub2", "[", "relguy", "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"found", "=", "1"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"relguy", "=", 
                    RowBox[{"rowguys", "[", 
                    RowBox[{"[", "jj", "]"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"rowguys", "=", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{"rowguys", ",", 
                    RowBox[{"rowguys", "[", 
                    RowBox[{"[", "jj", "]"}], "]"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", 
                 "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"If", " ", "the", " ", "guy", " ", 
                RowBox[{"we", "'"}], "re", " ", "looking", " ", "for", " ", 
                RowBox[{"doesn", "'"}], "t", " ", "exist"}], ",", " ", 
               RowBox[{"say", " ", "so"}]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"found", "\[Equal]", "0"}], ",", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{
                 "\"\<Mistake in column \>\"", ",", "ii", ",", 
                  "\"\< of Kasteleyn! Someone has a wrong name, or there's an \
extra field.\>\""}], "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}],
              ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Makes", " ", "the", " ", "sets", " ", "that", " ", "will", " ", 
         "number", " ", "the", " ", "rows", " ", "and", " ", "columns"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"bnset", "=", 
        RowBox[{"Range", "[", 
         RowBox[{
          RowBox[{"Dimensions", "[", "b", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Makes", " ", "a", " ", "list", " ", "1"}], ",", "2", ",", 
         RowBox[{
         "..", " ", "up", " ", "to", " ", "the", " ", "number", " ", "of", 
          " ", "external", " ", "nodes"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"bnlength", "=", 
        RowBox[{"Length", "[", "bnset", "]"}]}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{"gives", " ", "the", " ", "last", " ", "element"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"cnset", "=", 
        RowBox[{"Range", "[", 
         RowBox[{
          RowBox[{"Dimensions", "[", "c", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"cnlength", "=", 
        RowBox[{"Length", "[", "cnset", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Take", " ", "all", " ", "possible", " ", "subsets", " ", "and", " ", 
         "number", " ", "them"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{"cnlength", "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           SubscriptBox["cnsub", "i"], "=", 
           RowBox[{"Subsets", "[", 
            RowBox[{"cnset", ",", 
             RowBox[{"{", "i", "}"}]}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{"bnlength", "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           SubscriptBox["bnsub", "i"], "=", 
           RowBox[{"Subsets", "[", 
            RowBox[{"bnset", ",", 
             RowBox[{"{", "i", "}"}]}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Give", " ", "the", " ", "ith", " ", "row", " ", "and", " ", "the", 
         " ", "jth", " ", "column", " ", "a", " ", "name"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{"cnlength", "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           SubscriptBox["c", "i"], "=", 
           RowBox[{"Take", "[", 
            RowBox[{"c", ",", 
             RowBox[{"{", "i", "}"}]}], "]"}]}], ";"}]}], " ", 
        RowBox[{"(*", 
         RowBox[{"Is", " ", "the", " ", 
          SubscriptBox["c", "i"], " ", "th", " ", "row"}], "*)"}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "<", 
          RowBox[{"bnlength", "+", "1"}]}], ",", 
         RowBox[{"j", "++"}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           SubscriptBox["b", "j"], "=", 
           RowBox[{"Take", "[", 
            RowBox[{"b", ",", "All", ",", 
             RowBox[{"{", "j", "}"}]}], "]"}]}], ";"}]}], " ", 
        RowBox[{"(*", 
         RowBox[{"Is", " ", "the", " ", 
          SubscriptBox["b", "j"], " ", "th", " ", "column"}], "*)"}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"If", " ", "the", " ", "Kasteleyn", " ", "matrix", " ", 
          RowBox[{"isn", "'"}], "t", " ", "square"}], ",", " ", 
         RowBox[{
          RowBox[{"we", "'"}], "ll", " ", "need", " ", "to", " ", "remove", 
          " ", "more", " ", "columns", " ", "than", " ", "rows", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"or", " ", "vice"}], "-", "versa"}], ")"}], "."}]}]}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"totrow", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Dimensions", "[", "a", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", 
         RowBox[{
          RowBox[{"Dimensions", "[", "c", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"totcol", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Dimensions", "[", "a", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "+", 
         RowBox[{
          RowBox[{"Dimensions", "[", "b", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"totcol", "-", "totrow"}], "\[GreaterEqual]", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"colsurplus", "=", 
           RowBox[{"totcol", "-", "totrow"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"rowsurplus", "=", "0"}], ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{
          RowBox[{"rowsurplus", "=", 
           RowBox[{"totrow", "-", "totcol"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"colsurplus", "=", "0"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"num", "=", "1"}], ",", 
         RowBox[{"num", "<", 
          RowBox[{
           RowBox[{"Min", "[", 
            RowBox[{"bnlength", ",", "cnlength"}], "]"}], "+", "1"}]}], ",", 
         RowBox[{"num", "++"}], ",", " ", 
         RowBox[{"(*", 
          RowBox[{
          "num", " ", "is", " ", "the", " ", "number", " ", "of", " ", "rows",
            " ", "or", " ", "columns", " ", "that", " ", "are", " ", 
           "removed", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"can", "'"}], "t", " ", "remove", " ", "more", " ", 
              "than", " ", "all", " ", "external", " ", "rows", " ", "or", 
              " ", 
              RowBox[{"columns", ":", " ", 
               RowBox[{
               "this", " ", "sets", " ", "when", " ", "to", " ", "stop", " ", 
                "num"}]}]}], ")"}], "."}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           SubscriptBox["contr", "num"], "=", "0"}], ";", " ", 
          RowBox[{"(*", 
           RowBox[{
           "The", " ", "contribution", " ", "to", " ", "perf", " ", "with", 
            " ", "num", " ", "rows", " ", "and", " ", "columns", " ", 
            RowBox[{"removed", "."}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"i", "=", "1"}], ",", 
            RowBox[{"i", "<", 
             RowBox[{
              RowBox[{
               RowBox[{"Dimensions", "[", 
                SubscriptBox["cnsub", 
                 RowBox[{"num", "+", "rowsurplus"}]], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], ",", 
            RowBox[{"i", "++"}], ",", " ", 
            RowBox[{"(*", 
             RowBox[{"Counts", " ", "row", " ", "scenarios"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"j", "=", "1"}], ",", 
               RowBox[{"j", "<", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Dimensions", "[", 
                   SubscriptBox["bnsub", 
                    RowBox[{"num", "+", "colsurplus"}]], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], ",", 
               RowBox[{"j", "++"}], ",", " ", 
               RowBox[{"(*", 
                RowBox[{"Counts", " ", "column", " ", "scenarios"}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"bnew", "=", "b"}], ";", "\[IndentingNewLine]", 
                RowBox[{"cnew", "=", "c"}], ";", "\[IndentingNewLine]", 
                RowBox[{"dnew", "=", "d"}], ";", "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"kk", "=", "1"}], ",", 
                  RowBox[{"kk", " ", "<", " ", 
                   RowBox[{"(", 
                    RowBox[{"num", "+", "colsurplus", "+", "1"}], ")"}]}], 
                  ",", " ", 
                  RowBox[{"kk", "++"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"bnew", "=", 
                    RowBox[{"Drop", "[", 
                    RowBox[{"bnew", ",", "None", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["bnsub", 
                    RowBox[{"num", "+", "colsurplus"}]], "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "kk"}], "]"}], "]"}], "-", "kk", "+", 
                    "1"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                   RowBox[{"dnew", "=", 
                    RowBox[{"Drop", "[", 
                    RowBox[{"dnew", ",", "None", ",", 
                    RowBox[{"{", "1", "}"}]}], "]"}]}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"kk", "=", "1"}], ",", 
                  RowBox[{"kk", " ", "<", " ", 
                   RowBox[{"(", 
                    RowBox[{"num", "+", "rowsurplus", "+", "1"}], ")"}]}], 
                  ",", " ", 
                  RowBox[{"kk", "++"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"cnew", "=", 
                    RowBox[{"Drop", "[", 
                    RowBox[{"cnew", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["cnsub", 
                    RowBox[{"num", "+", "rowsurplus"}]], "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "kk"}], "]"}], "]"}], "-", "kk", "+", 
                    "1"}], "}"}], ",", "None"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"dnew", "=", 
                    RowBox[{"Drop", "[", 
                    RowBox[{"dnew", ",", 
                    RowBox[{"{", "1", "}"}], ",", "None"}], "]"}]}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Dimensions", "[", "cnew", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[NotEqual]", " ", "0"}],
                   ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"part1", "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{"a", ",", "cnew"}], "]"}]}], ";"}], ",", 
                  RowBox[{
                   RowBox[{"part1", "=", "a"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Dimensions", "[", "bnew", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "\[NotEqual]", " ", "0"}],
                   ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"part2", "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{"bnew", ",", "dnew"}], "]"}]}], ";"}], ",", 
                  RowBox[{
                   RowBox[{"part2", "=", 
                    RowBox[{"{", 
                    RowBox[{"{", "}"}], "}"}]}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Dimensions", "[", "part2", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[NotEqual]", "0"}], ",",
                   "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["added", "num"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{"part1", ",", "part2", ",", "2"}], "]"}]}], ";"}],
                   " ", ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["added", "num"], "=", "part1"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{"This", " ", "is", " ", "the", " ", "correct", " ", 
                  RowBox[{"matrix", "!"}]}], "*)"}], "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{
                 SubscriptBox["contr", "num"], "=", 
                 RowBox[{
                  SubscriptBox["contr", "num"], "+", 
                  RowBox[{"Det", "[", 
                   SubscriptBox["added", "num"], "]"}]}]}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Now", " ", "have", " ", "added", " ", "all", " ", "the", " ", 
         "contributions", " ", "when", " ", "we", " ", "removed", " ", "rows",
          " ", "and", " ", 
         RowBox[{"columns", ".", " ", "Have"}], " ", "to", " ", "still", " ", 
         "consider", " ", "the", " ", "contribution", " ", "where", " ", "we",
          " ", "remove", " ", "zero", " ", "rows", " ", 
         RowBox[{"or", "/", "and"}], " ", "zero", " ", 
         RowBox[{"columns", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"totcol", "-", "totrow"}], "\[Equal]", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "If", " ", "we", " ", "have", " ", "the", " ", "same", " ", 
            "number", " ", "of", " ", "rows", " ", "and", " ", "columns"}], 
           ",", " ", 
           RowBox[{
           "K0", " ", "is", " ", "already", " ", "a", " ", "square", " ", 
            "matrix"}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"finalcontr", "=", 
           RowBox[{"Det", "[", "K0full", "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"totcol", "-", "totrow"}], ">", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"finalcontr", "=", "0"}], ";", " ", 
          RowBox[{"(*", 
           RowBox[{
           "The", " ", "contribution", " ", "to", " ", "perf", " ", "with", 
            " ", "num", " ", "rows", " ", "and", " ", "columns", " ", 
            RowBox[{"removed", "."}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "<", 
             RowBox[{
              RowBox[{
               RowBox[{"Dimensions", "[", 
                SubscriptBox["bnsub", "colsurplus"], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], ",", 
            RowBox[{"j", "++"}], ",", " ", 
            RowBox[{"(*", 
             RowBox[{"Counts", " ", "column", " ", "scenarios"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"bnew", "=", "b"}], ";", "\[IndentingNewLine]", 
             RowBox[{"cnew", "=", "c"}], ";", "\[IndentingNewLine]", 
             RowBox[{"dnew", "=", "d"}], ";", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"kk", "=", "1"}], ",", 
               RowBox[{"kk", " ", "<", " ", 
                RowBox[{"(", 
                 RowBox[{"colsurplus", "+", "1"}], ")"}]}], ",", " ", 
               RowBox[{"kk", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"bnew", "=", 
                 RowBox[{"Drop", "[", 
                  RowBox[{"bnew", ",", "None", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["bnsub", "colsurplus"], "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "kk"}], "]"}], "]"}], "-", "kk", "+", 
                    "1"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"dnew", "=", 
                 RowBox[{"Drop", "[", 
                  RowBox[{"dnew", ",", "None", ",", 
                   RowBox[{"{", "1", "}"}]}], "]"}]}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Dimensions", "[", "cnew", "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "\[NotEqual]", " ", "0"}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"part1", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{"a", ",", "cnew"}], "]"}]}], ";"}], ",", 
               RowBox[{
                RowBox[{"part1", "=", "a"}], ";"}]}], "\[IndentingNewLine]", 
              "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Dimensions", "[", "bnew", "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "\[NotEqual]", " ", "0"}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"part2", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{"bnew", ",", "dnew"}], "]"}]}], ";"}], ",", 
               RowBox[{
                RowBox[{"part2", "=", 
                 RowBox[{"{", 
                  RowBox[{"{", "}"}], "}"}]}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Dimensions", "[", "part2", "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "\[NotEqual]", "0"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"finaladd", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{"part1", ",", "part2", ",", "2"}], "]"}]}], ";"}], 
               " ", ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"finaladd", "=", "part1"}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"This", " ", "is", " ", "the", " ", "correct", " ", 
               RowBox[{"matrix", "!"}]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"finalcontr", "=", 
              RowBox[{"finalcontr", "+", 
               RowBox[{"Det", "[", "finaladd", "]"}]}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"totrow", "-", "totcol"}], ">", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"finalcontr", "=", "0"}], ";", " ", 
          RowBox[{"(*", 
           RowBox[{
           "The", " ", "contribution", " ", "to", " ", "perf", " ", "with", 
            " ", "num", " ", "rows", " ", "and", " ", "columns", " ", 
            RowBox[{"removed", "."}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"i", "=", "1"}], ",", 
            RowBox[{"i", "<", 
             RowBox[{
              RowBox[{
               RowBox[{"Dimensions", "[", 
                SubscriptBox["cnsub", "rowsurplus"], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], ",", 
            RowBox[{"i", "++"}], ",", " ", 
            RowBox[{"(*", 
             RowBox[{"Counts", " ", "row", " ", "scenarios"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"bnew", "=", "b"}], ";", "\[IndentingNewLine]", 
             RowBox[{"cnew", "=", "c"}], ";", "\[IndentingNewLine]", 
             RowBox[{"dnew", "=", "d"}], ";", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"kk", "=", "1"}], ",", 
               RowBox[{"kk", " ", "<", " ", 
                RowBox[{"(", 
                 RowBox[{"rowsurplus", "+", "1"}], ")"}]}], ",", " ", 
               RowBox[{"kk", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"cnew", "=", 
                 RowBox[{"Drop", "[", 
                  RowBox[{"cnew", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["cnsub", "rowsurplus"], "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "kk"}], "]"}], "]"}], "-", "kk", "+", 
                    "1"}], "}"}], ",", "None"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"dnew", "=", 
                 RowBox[{"Drop", "[", 
                  RowBox[{"dnew", ",", 
                   RowBox[{"{", "1", "}"}], ",", "None"}], "]"}]}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Dimensions", "[", "cnew", "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "\[NotEqual]", " ", "0"}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"part1", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{"a", ",", "cnew"}], "]"}]}], ";"}], ",", 
               RowBox[{
                RowBox[{"part1", "=", "a"}], ";"}]}], "\[IndentingNewLine]", 
              "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Dimensions", "[", "bnew", "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "\[NotEqual]", " ", "0"}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"part2", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{"bnew", ",", "dnew"}], "]"}]}], ";"}], ",", 
               RowBox[{
                RowBox[{"part2", "=", 
                 RowBox[{"{", 
                  RowBox[{"{", "}"}], "}"}]}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Dimensions", "[", "part2", "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "\[NotEqual]", "0"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"finaladd", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{"part1", ",", "part2", ",", "2"}], "]"}]}], ";"}], 
               " ", ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"finaladd", "=", "part1"}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"This", " ", "is", " ", "the", " ", "correct", " ", 
               RowBox[{"matrix", "!"}]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"finalcontr", "=", 
              RowBox[{"finalcontr", "+", 
               RowBox[{"Det", "[", "finaladd", "]"}]}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"perf", "=", 
        RowBox[{"finalcontr", "+", 
         RowBox[{"Sum", "[", 
          RowBox[{
           SubscriptBox["contr", "i"], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Min", "[", 
              RowBox[{"bnlength", ",", "cnlength"}], "]"}]}], "}"}]}], 
          "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<There are \>\"", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"MonomialList", "[", "perf", "]"}], "]"}], ",", 
         "\"\< perfect matchings.\>\""}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"plist", "=", 
        RowBox[{"MonomialList", "[", "perf", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Xlist", "=", 
        RowBox[{"Variables", "[", "perf", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "<", 
          RowBox[{
           RowBox[{"Length", "[", "plist", "]"}], "+", "1"}]}], ",", 
         RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           SubscriptBox["p", "j"], "=", 
           RowBox[{"plist", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", "Xlist", "]"}], "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           SubscriptBox["X", "i"], "=", 
           RowBox[{"Xlist", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", "Xlist", "]"}], "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "<", 
             RowBox[{
              RowBox[{"Length", "[", "plist", "]"}], "+", "1"}]}], ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"D", "[", 
                RowBox[{
                 SubscriptBox["p", "j"], ",", 
                 SubscriptBox["X", "i"]}], "]"}], "\[Equal]", "0"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                SubscriptBox["BigP", 
                 RowBox[{"i", ",", "j"}]], "=", "0"}], ";"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                SubscriptBox["BigP", 
                 RowBox[{"i", ",", "j"}]], "=", "1"}], ";"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                SubscriptBox["BigP", 
                 RowBox[{"i", ",", "j"}]], "=", "1"}], ";"}]}], 
             "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"P", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          SubscriptBox["BigP", 
           RowBox[{"i", ",", "j"}]], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "Xlist", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"Length", "[", "plist", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Now", " ", 
         RowBox[{"we", "'"}], "ll", " ", "rearrange", " ", "P", " ", "in", 
         " ", "a", " ", "nice", " ", "way"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"xb", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"DeleteCases", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", "b", "]"}], ",", "0"}], "]"}], ",", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", "c", "]"}], ",", "0"}], "]"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Pext", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Pint", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"ai", "=", "1"}], ",", 
         RowBox[{"ai", "<", 
          RowBox[{
           RowBox[{"Length", "[", "Xlist", "]"}], "+", "1"}]}], ",", 
         RowBox[{"ai", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"xb", ",", 
              RowBox[{"Xlist", "[", 
               RowBox[{"[", "ai", "]"}], "]"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Pext", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"Pext", ",", 
                RowBox[{"{", "ai", "}"}]}], "]"}]}], ";"}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{
             RowBox[{"Pint", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"Pint", ",", 
                RowBox[{"{", "ai", "}"}]}], "]"}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Now", " ", "we", " ", "know", " ", "which", " ", "rows", " ", "we", 
         " ", "need", " ", "to", " ", "select", " ", "from", " ", "P"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"moduliP", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Xmoduli", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"ji", "=", "1"}], ",", 
         RowBox[{"ji", "<", 
          RowBox[{
           RowBox[{"Length", "[", "Pext", "]"}], "+", "1"}]}], ",", 
         RowBox[{"ji", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"moduliP", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"moduliP", ",", 
             RowBox[{"Take", "[", 
              RowBox[{"P", ",", 
               RowBox[{"{", 
                RowBox[{"Pext", "[", 
                 RowBox[{"[", "ji", "]"}], "]"}], "}"}]}], "]"}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"Xmoduli", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"Xmoduli", ",", 
             RowBox[{"Take", "[", 
              RowBox[{"Xlist", ",", 
               RowBox[{"{", 
                RowBox[{"Pext", "[", 
                 RowBox[{"[", "ji", "]"}], "]"}], "}"}]}], "]"}]}], "]"}]}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"moduliP", "\[Equal]", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{
          RowBox[{"moduliP", "=", 
           RowBox[{"{", 
            RowBox[{"{", "}"}], "}"}]}], ";"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"remainingP", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Xremain", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"jir", "=", "1"}], ",", 
         RowBox[{"jir", "<", 
          RowBox[{
           RowBox[{"Length", "[", "Pint", "]"}], "+", "1"}]}], ",", 
         RowBox[{"jir", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"remainingP", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"remainingP", ",", 
             RowBox[{"Take", "[", 
              RowBox[{"P", ",", 
               RowBox[{"{", 
                RowBox[{"Pint", "[", 
                 RowBox[{"[", "jir", "]"}], "]"}], "}"}]}], "]"}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"Xremain", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"Xremain", ",", 
             RowBox[{"Take", "[", 
              RowBox[{"Xlist", ",", 
               RowBox[{"{", 
                RowBox[{"Pint", "[", 
                 RowBox[{"[", "jir", "]"}], "]"}], "}"}]}], "]"}]}], "]"}]}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"remainingP", "\[Equal]", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{
          RowBox[{"remainingP", "=", 
           RowBox[{"{", 
            RowBox[{"{", "}"}], "}"}]}], ";"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"P", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"remainingP", ",", "moduliP"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Xlist", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"Xremain", ",", "Xmoduli"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", "\"\<-------------------------------------\>\"", "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Now", " ", "make", " ", "the", " ", "perfect", " ", "matchings", " ",
          "in", " ", "plist", " ", "manifestly", " ", "positive"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"signs", "=", 
        RowBox[{"plist", "/.", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Xlist", "[", 
             RowBox[{"[", "ii", "]"}], "]"}], "\[Rule]", "1"}], ",", 
           RowBox[{"{", 
            RowBox[{"ii", ",", 
             RowBox[{"Length", "[", "Xlist", "]"}]}], "}"}]}], "]"}]}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"plist", "=", 
        RowBox[{"plist", "*", "signs"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", 
        "\"\<Variables are 'perf'=determinant of Kasteleyn matrix; \
'plist'=list of perfect matchings; 'P'=perfect matching matrix; \
'Xlist'=fields corresponding to the rows of P; 'moduliP'=P but only with rows \
corresponding to external \!\(\*SubscriptBox[\(X\), \(i, j\)]\)'s; \
'remainingP'=P but only with rows corresponding to internal \
\!\(\*SubscriptBox[\(X\), \(i, j\)]\)'s; similarly for Xremain and Xmoduli; \
'xb'=list of external fields;\>\"", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", "\"\<-------------------------------------\>\"", "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "In", " ", "case", " ", "we", " ", "had", " ", "zero", " ", 
         "boundaries"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"moduliP", "\[Equal]", 
          RowBox[{"{", 
           RowBox[{"{", "}"}], "}"}]}], ",", 
         RowBox[{
          RowBox[{"moduliP", "=", 
           RowBox[{"{", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"0", ",", 
              RowBox[{
               RowBox[{"Dimensions", "[", "remainingP", "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "}"}]}], ";", 
          RowBox[{"P", "=", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{"P", ",", 
             RowBox[{"{", "}"}]}], "]"}]}], ";"}]}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"DONE", ",", " ", 
    RowBox[{"NOW", " ", "CALLED", " ", 
     RowBox[{"perfectMatchings", ".", " ", "SOME"}], " ", "FUNCTIONALITY", 
     " ", "IS", " ", "IN", " ", "getPmatrix", " ", "AND", " ", 
     RowBox[{"matroidPolytope", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Calculates", " ", "the", " ", "moduli", " ", "space", " ", "using", " ", 
    "Gauging", " ", "2", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"using", " ", "the", " ", "superslick", " ", "method"}], ")"}], 
     "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"moduliGauging2", "[", 
     RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"kasteleyn", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Gmaster", "=", 
       RowBox[{"DeleteCases", "[", 
        RowBox[{
         RowBox[{"RowReduce", "[", "P", "]"}], ",", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", 
           RowBox[{
            RowBox[{"Dimensions", "[", "P", "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<The Master space is \>\"", ",", 
        RowBox[{"BFTdim", "[", "Gmaster", "]"}], ",", 
        "\"\<-dimensional. (NB This is the dimension of its toric \
diagram!).\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Gmoduli", "=", "moduliP"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<G = \>\"", ",", 
        RowBox[{"Gmoduli", "//", "MatrixForm"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<The moduli space is \>\"", ",", 
        RowBox[{"BFTdim", "[", "Gmoduli", "]"}], ",", 
        "\"\<-dimensional. (NB This is the dimension of its toric \
diagram!).\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Now", " ", "group", " ", "the", " ", "multiplicities", " ", "of", " ",
         "G", " ", 
        RowBox[{"together", "."}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Gshort", "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"Transpose", "[", "Gmoduli", "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Multmatrix", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Dimensions", "[", 
           RowBox[{
            RowBox[{"Gather", "[", 
             RowBox[{"Transpose", "[", "Gmoduli", "]"}], "]"}], "[", 
            RowBox[{"[", "y", "]"}], "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"y", ",", 
           RowBox[{
            RowBox[{"Dimensions", "[", 
             RowBox[{"Gather", "[", 
              RowBox[{"Transpose", "[", "Gmoduli", "]"}], "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
      "Print", "[", "\"\<-------------------------------------\>\"", "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
      "Print", "[", 
       "\"\<Variables are 'Gmaster'=master space; 'Gmoduli'=moduli space; \
'Gshort'=moduli space where doubles have been removed; \
'Multmatrix'=moultiplicity of each point in Gshort;\>\"", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
      "Print", "[", "\"\<-------------------------------------\>\"", "]"}], 
      ";"}], "\[IndentingNewLine]", ")"}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"DONE", " ", 
     RowBox[{"(", 
      RowBox[{"SIMILAR", " ", "BUT", " ", "DIFFERENT"}], ")"}]}], ",", " ", 
    RowBox[{"NOW", " ", "CALLED", " ", 
     RowBox[{"matroidPolytope", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Compares", " ", "Gauging", " ", "2", " ", "calculated", " ", "using", " ",
     "the", " ", "superslick", " ", "method", " ", "with", " ", "the", " ", 
    "old", " ", "method", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"using", " ", "charge", " ", "matrices"}], ")"}], "."}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"compareGauging2", "[", 
     RowBox[{"addgauge_", ",", "zed_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "IF", ",", "NF", ",", "i", ",", "j", ",", "k", ",", "mem", ",", "memz",
         ",", "Delta", ",", "QDT", ",", "QDTlist", ",", "solution", ",", 
        "newQDTlist", ",", "Q", ",", "subtract", ",", "transGmoduliold", ",", 
        "multold", ",", "temp"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"QF", "=", 
        RowBox[{"NullSpace", "[", "P", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"NF", "=", 
        RowBox[{"totFaces", "[", 
         RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"IF", "=", 
        RowBox[{"internalFaces", "[", 
         RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<\!\(\*SubscriptBox[\(Q\), \(F\)]\) = \>\"", ",", 
          RowBox[{"QF", "//", "MatrixForm"}]}], "]"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"First", " ", "make", " ", "Delta"}], ",", " ", 
         RowBox[{
          RowBox[{"then", " ", "plug", " ", "in", " ", "the", " ", "non"}], 
          "-", 
          RowBox[{"zero", " ", 
           RowBox[{"numbers", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Delta", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{"Length", "[", "Xlist", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", 
            RowBox[{"IF", "+", 
             RowBox[{"Length", "[", "addgauge", "]"}], "+", 
             RowBox[{"Length", "[", "zed", "]"}]}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Now", " ", "fill", " ", "in", " ", "the", " ", "non"}], "=", 
         RowBox[{"zero", " ", "numbers"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{"NF", "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "<", 
             RowBox[{"NF", "+", "1"}]}], ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"Take", " ", "a", " ", "specific", " ", 
              SubscriptBox["X", 
               RowBox[{"i", ",", "j"}]], " ", "or", " ", 
              SubscriptBox["Y", 
               RowBox[{"i", ",", "j"}]], " ", 
              RowBox[{"etc", ".", " ", "and"}], " ", "check", " ", "if", " ", 
              RowBox[{"it", "'"}], "s", " ", "in", " ", 
              RowBox[{"Xlist", "."}]}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"i", "\[NotEqual]", "j"}], ",", " ", 
               RowBox[{"(*", 
                RowBox[{
                 SubscriptBox["X", 
                  RowBox[{"i", ",", "i"}]], " ", 
                 RowBox[{"shouldn", "'"}], "t", " ", "be", " ", "nonzero"}], 
                "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"k", "=", "1"}], ",", 
                  RowBox[{"k", "<", 
                   RowBox[{
                    RowBox[{"Length", "[", "Xlist", "]"}], "+", "1"}]}], ",", 
                  RowBox[{"k", "++"}], ",", " ", 
                  RowBox[{"(*", 
                   RowBox[{
                   "Run", " ", "through", " ", "the", " ", "whole", " ", 
                    "Xlist"}], "*)"}], "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["X", 
                    RowBox[{"i", ",", "j"}]], "\[Equal]", 
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "&&", 
                    RowBox[{"i", "\[NotEqual]", "j"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i"}], "]"}], "]"}], "=", "1"}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"j", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{"-", "1"}]}], ";"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Check", " ", "whether", " ", "i", " ", "is", " ", "in", 
                    " ", "any", " ", "of", " ", "the", " ", "additional", " ",
                     "gaugings"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"mem", "=", "1"}], ",", 
                    RowBox[{"mem", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "1"}]}], 
                    ",", 
                    RowBox[{"mem", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"addgauge", "[", 
                    RowBox[{"[", "mem", "]"}], "]"}], ",", "i"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "+", "1"}]}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"addgauge", "[", 
                    RowBox[{"[", "mem", "]"}], "]"}], ",", "j"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "-", "1"}]}], 
                    ";"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Now", " ", "sort", " ", "out", " ", "the", " ", "zed", 
                    " ", "gaugings"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"memz", "=", "1"}], ",", 
                    RowBox[{"memz", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", "zed", "]"}], "+", "1"}]}], ",", 
                    RowBox[{"memz", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}], "]"}], ",", 
                    SubscriptBox["X", 
                    RowBox[{"i", ",", "j"}]]}], "]"}], ",", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{
                    "if", " ", "the", " ", "field", " ", "is", " ", "in", " ",
                     "the", " ", "zigzag"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"it", "'"}], "s"}], " ", "-", 
                    RowBox[{
                    "1", " ", "if", " ", "it", " ", "appears", " ", "on", " ",
                     "top", " ", "and"}], " ", "+", 
                    RowBox[{
                    "1", " ", "if", " ", "it", " ", "appears", " ", "on", " ",
                     "the", " ", "bottom"}]}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}], ",", 
                    SubscriptBox["X", 
                    RowBox[{"i", ",", "j"}]]}], "]"}], 
                    SubscriptBox["X", 
                    RowBox[{"i", ",", "j"}]]}], "\[Equal]", 
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}]}], ",", 
                    RowBox[{"(*", 
                    RowBox[{"appears", " ", "on", " ", "top"}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "-", "1"}]}], ";"}], ",", "True", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "+", "1"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["Y", 
                    RowBox[{"i", ",", "j"}]], "\[Equal]", 
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "&&", 
                    RowBox[{"i", "\[NotEqual]", "j"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i"}], "]"}], "]"}], "=", "1"}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"j", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{"-", "1"}]}], ";"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Check", " ", "whether", " ", "i", " ", "is", " ", "in", 
                    " ", "any", " ", "of", " ", "the", " ", "additional", " ",
                     "gaugings"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"mem", "=", "1"}], ",", 
                    RowBox[{"mem", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "1"}]}], 
                    ",", 
                    RowBox[{"mem", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"addgauge", "[", 
                    RowBox[{"[", "mem", "]"}], "]"}], ",", "i"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "+", "1"}]}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"addgauge", "[", 
                    RowBox[{"[", "mem", "]"}], "]"}], ",", "j"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "-", "1"}]}], 
                    ";"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Now", " ", "sort", " ", "out", " ", "the", " ", "zed", 
                    " ", "gaugings"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"memz", "=", "1"}], ",", 
                    RowBox[{"memz", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", "zed", "]"}], "+", "1"}]}], ",", 
                    RowBox[{"memz", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}], "]"}], ",", 
                    SubscriptBox["Y", 
                    RowBox[{"i", ",", "j"}]]}], "]"}], ",", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{
                    "if", " ", "the", " ", "field", " ", "is", " ", "in", " ",
                     "the", " ", "zigzag"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"it", "'"}], "s"}], " ", "-", 
                    RowBox[{
                    "1", " ", "if", " ", "it", " ", "appears", " ", "on", " ",
                     "top", " ", "and"}], " ", "+", 
                    RowBox[{"1", " ", "if", " ", "it", " ", "appears", " ", 
                    "on", " ", "the", " ", "bottom"}]}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}], ",", 
                    SubscriptBox["Y", 
                    RowBox[{"i", ",", "j"}]]}], "]"}], 
                    SubscriptBox["Y", 
                    RowBox[{"i", ",", "j"}]]}], "\[Equal]", 
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}]}], ",", 
                    RowBox[{"(*", 
                    RowBox[{"appears", " ", "on", " ", "top"}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "-", "1"}]}], ";"}], ",", "True", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "+", "1"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["Z", 
                    RowBox[{"i", ",", "j"}]], "\[Equal]", 
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "&&", 
                    RowBox[{"i", "\[NotEqual]", "j"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i"}], "]"}], "]"}], "=", "1"}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"j", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{"-", "1"}]}], ";"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Check", " ", "whether", " ", "i", " ", "is", " ", "in", 
                    " ", "any", " ", "of", " ", "the", " ", "additional", " ",
                     "gaugings"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"mem", "=", "1"}], ",", 
                    RowBox[{"mem", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "1"}]}], 
                    ",", 
                    RowBox[{"mem", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"addgauge", "[", 
                    RowBox[{"[", "mem", "]"}], "]"}], ",", "i"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "+", "1"}]}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"addgauge", "[", 
                    RowBox[{"[", "mem", "]"}], "]"}], ",", "j"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "-", "1"}]}], 
                    ";"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Now", " ", "sort", " ", "out", " ", "the", " ", "zed", 
                    " ", "gaugings"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"memz", "=", "1"}], ",", 
                    RowBox[{"memz", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", "zed", "]"}], "+", "1"}]}], ",", 
                    RowBox[{"memz", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}], "]"}], ",", 
                    SubscriptBox["Z", 
                    RowBox[{"i", ",", "j"}]]}], "]"}], ",", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{
                    "if", " ", "the", " ", "field", " ", "is", " ", "in", " ",
                     "the", " ", "zigzag"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"it", "'"}], "s"}], " ", "-", 
                    RowBox[{
                    "1", " ", "if", " ", "it", " ", "appears", " ", "on", " ",
                     "top", " ", "and"}], " ", "+", 
                    RowBox[{
                    "1", " ", "if", " ", "it", " ", "appears", " ", "on", " ",
                     "the", " ", "bottom"}]}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}], ",", 
                    SubscriptBox["Z", 
                    RowBox[{"i", ",", "j"}]]}], "]"}], 
                    SubscriptBox["Z", 
                    RowBox[{"i", ",", "j"}]]}], "\[Equal]", 
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}]}], ",", 
                    RowBox[{"(*", 
                    RowBox[{"appears", " ", "on", " ", "top"}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "-", "1"}]}], ";"}], ",", "True", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "+", "1"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["W", 
                    RowBox[{"i", ",", "j"}]], "\[Equal]", 
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "&&", 
                    RowBox[{"i", "\[NotEqual]", "j"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i"}], "]"}], "]"}], "=", "1"}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"j", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{"-", "1"}]}], ";"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Check", " ", "whether", " ", "i", " ", "is", " ", "in", 
                    " ", "any", " ", "of", " ", "the", " ", "additional", " ",
                     "gaugings"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"mem", "=", "1"}], ",", 
                    RowBox[{"mem", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "1"}]}], 
                    ",", 
                    RowBox[{"mem", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"addgauge", "[", 
                    RowBox[{"[", "mem", "]"}], "]"}], ",", "i"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "+", "1"}]}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"addgauge", "[", 
                    RowBox[{"[", "mem", "]"}], "]"}], ",", "j"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "-", "1"}]}], 
                    ";"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Now", " ", "sort", " ", "out", " ", "the", " ", "zed", 
                    " ", "gaugings"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"memz", "=", "1"}], ",", 
                    RowBox[{"memz", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", "zed", "]"}], "+", "1"}]}], ",", 
                    RowBox[{"memz", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}], "]"}], ",", 
                    SubscriptBox["W", 
                    RowBox[{"i", ",", "j"}]]}], "]"}], ",", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{
                    "if", " ", "the", " ", "field", " ", "is", " ", "in", " ",
                     "the", " ", "zigzag"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"it", "'"}], "s"}], " ", "-", 
                    RowBox[{
                    "1", " ", "if", " ", "it", " ", "appears", " ", "on", " ",
                     "top", " ", "and"}], " ", "+", 
                    RowBox[{
                    "1", " ", "if", " ", "it", " ", "appears", " ", "on", " ",
                     "the", " ", "bottom"}]}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}], ",", 
                    SubscriptBox["W", 
                    RowBox[{"i", ",", "j"}]]}], "]"}], 
                    SubscriptBox["W", 
                    RowBox[{"i", ",", "j"}]]}], "\[Equal]", 
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}]}], ",", 
                    RowBox[{"(*", 
                    RowBox[{"appears", " ", "on", " ", "top"}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "-", "1"}]}], ";"}], ",", "True", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "+", "1"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["V", 
                    RowBox[{"i", ",", "j"}]], "\[Equal]", 
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "&&", 
                    RowBox[{"i", "\[NotEqual]", "j"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i"}], "]"}], "]"}], "=", "1"}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"j", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{"-", "1"}]}], ";"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Check", " ", "whether", " ", "i", " ", "is", " ", "in", 
                    " ", "any", " ", "of", " ", "the", " ", "additional", " ",
                     "gaugings"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"mem", "=", "1"}], ",", 
                    RowBox[{"mem", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "1"}]}], 
                    ",", 
                    RowBox[{"mem", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"addgauge", "[", 
                    RowBox[{"[", "mem", "]"}], "]"}], ",", "i"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "+", "1"}]}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"addgauge", "[", 
                    RowBox[{"[", "mem", "]"}], "]"}], ",", "j"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "-", "1"}]}], 
                    ";"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Now", " ", "sort", " ", "out", " ", "the", " ", "zed", 
                    " ", "gaugings"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"memz", "=", "1"}], ",", 
                    RowBox[{"memz", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", "zed", "]"}], "+", "1"}]}], ",", 
                    RowBox[{"memz", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}], "]"}], ",", 
                    SubscriptBox["V", 
                    RowBox[{"i", ",", "j"}]]}], "]"}], ",", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{
                    "if", " ", "the", " ", "field", " ", "is", " ", "in", " ",
                     "the", " ", "zigzag"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"it", "'"}], "s"}], " ", "-", 
                    RowBox[{
                    "1", " ", "if", " ", "it", " ", "appears", " ", "on", " ",
                     "top", " ", "and"}], " ", "+", 
                    RowBox[{
                    "1", " ", "if", " ", "it", " ", "appears", " ", "on", " ",
                     "the", " ", "bottom"}]}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}], ",", 
                    SubscriptBox["V", 
                    RowBox[{"i", ",", "j"}]]}], "]"}], 
                    SubscriptBox["V", 
                    RowBox[{"i", ",", "j"}]]}], "\[Equal]", 
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}]}], ",", 
                    RowBox[{"(*", 
                    RowBox[{"appears", " ", "on", " ", "top"}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "-", "1"}]}], ";"}], ",", "True", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "+", "1"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["UU", 
                    RowBox[{"i", ",", "j"}]], "\[Equal]", 
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "&&", 
                    RowBox[{"i", "\[NotEqual]", "j"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i"}], "]"}], "]"}], "=", "1"}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"j", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{"-", "1"}]}], ";"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Check", " ", "whether", " ", "i", " ", "is", " ", "in", 
                    " ", "any", " ", "of", " ", "the", " ", "additional", " ",
                     "gaugings"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"mem", "=", "1"}], ",", 
                    RowBox[{"mem", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "1"}]}], 
                    ",", 
                    RowBox[{"mem", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"addgauge", "[", 
                    RowBox[{"[", "mem", "]"}], "]"}], ",", "i"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "+", "1"}]}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"addgauge", "[", 
                    RowBox[{"[", "mem", "]"}], "]"}], ",", "j"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "-", "1"}]}], 
                    ";"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Now", " ", "sort", " ", "out", " ", "the", " ", "zed", 
                    " ", "gaugings"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"memz", "=", "1"}], ",", 
                    RowBox[{"memz", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", "zed", "]"}], "+", "1"}]}], ",", 
                    RowBox[{"memz", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}], "]"}], ",", 
                    SubscriptBox["UU", 
                    RowBox[{"i", ",", "j"}]]}], "]"}], ",", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{
                    "if", " ", "the", " ", "field", " ", "is", " ", "in", " ",
                     "the", " ", "zigzag"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"it", "'"}], "s"}], " ", "-", 
                    RowBox[{
                    "1", " ", "if", " ", "it", " ", "appears", " ", "on", " ",
                     "top", " ", "and"}], " ", "+", 
                    RowBox[{
                    "1", " ", "if", " ", "it", " ", "appears", " ", "on", " ",
                     "the", " ", "bottom"}]}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}], ",", 
                    SubscriptBox["UU", 
                    RowBox[{"i", ",", "j"}]]}], "]"}], 
                    SubscriptBox["UU", 
                    RowBox[{"i", ",", "j"}]]}], "\[Equal]", 
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}]}], ",", 
                    RowBox[{"(*", 
                    RowBox[{"appears", " ", "on", " ", "top"}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "-", "1"}]}], ";"}], ",", "True", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "+", "1"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["XX", 
                    RowBox[{"i", ",", "j"}]], "\[Equal]", 
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "&&", 
                    RowBox[{"i", "\[NotEqual]", "j"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i"}], "]"}], "]"}], "=", "1"}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"j", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{"-", "1"}]}], ";"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Check", " ", "whether", " ", "i", " ", "is", " ", "in", 
                    " ", "any", " ", "of", " ", "the", " ", "additional", " ",
                     "gaugings"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"mem", "=", "1"}], ",", 
                    RowBox[{"mem", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "1"}]}], 
                    ",", 
                    RowBox[{"mem", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"addgauge", "[", 
                    RowBox[{"[", "mem", "]"}], "]"}], ",", "i"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "+", "1"}]}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"addgauge", "[", 
                    RowBox[{"[", "mem", "]"}], "]"}], ",", "j"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "-", "1"}]}], 
                    ";"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Now", " ", "sort", " ", "out", " ", "the", " ", "zed", 
                    " ", "gaugings"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"memz", "=", "1"}], ",", 
                    RowBox[{"memz", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", "zed", "]"}], "+", "1"}]}], ",", 
                    RowBox[{"memz", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}], "]"}], ",", 
                    SubscriptBox["XX", 
                    RowBox[{"i", ",", "j"}]]}], "]"}], ",", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{
                    "if", " ", "the", " ", "field", " ", "is", " ", "in", " ",
                     "the", " ", "zigzag"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"it", "'"}], "s"}], " ", "-", 
                    RowBox[{
                    "1", " ", "if", " ", "it", " ", "appears", " ", "on", " ",
                     "top", " ", "and"}], " ", "+", 
                    RowBox[{
                    "1", " ", "if", " ", "it", " ", "appears", " ", "on", " ",
                     "the", " ", "bottom"}]}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}], ",", 
                    SubscriptBox["XX", 
                    RowBox[{"i", ",", "j"}]]}], "]"}], 
                    SubscriptBox["XX", 
                    RowBox[{"i", ",", "j"}]]}], "\[Equal]", 
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}]}], ",", 
                    RowBox[{"(*", 
                    RowBox[{"appears", " ", "on", " ", "top"}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "-", "1"}]}], ";"}], ",", "True", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "+", "1"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["YY", 
                    RowBox[{"i", ",", "j"}]], "\[Equal]", 
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "&&", 
                    RowBox[{"i", "\[NotEqual]", "j"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i"}], "]"}], "]"}], "=", "1"}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"j", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{"-", "1"}]}], ";"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Check", " ", "whether", " ", "i", " ", "is", " ", "in", 
                    " ", "any", " ", "of", " ", "the", " ", "additional", " ",
                     "gaugings"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"mem", "=", "1"}], ",", 
                    RowBox[{"mem", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "1"}]}], 
                    ",", 
                    RowBox[{"mem", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"addgauge", "[", 
                    RowBox[{"[", "mem", "]"}], "]"}], ",", "i"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "+", "1"}]}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"addgauge", "[", 
                    RowBox[{"[", "mem", "]"}], "]"}], ",", "j"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "-", "1"}]}], 
                    ";"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Now", " ", "sort", " ", "out", " ", "the", " ", "zed", 
                    " ", "gaugings"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"memz", "=", "1"}], ",", 
                    RowBox[{"memz", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", "zed", "]"}], "+", "1"}]}], ",", 
                    RowBox[{"memz", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}], "]"}], ",", 
                    SubscriptBox["YY", 
                    RowBox[{"i", ",", "j"}]]}], "]"}], ",", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{
                    "if", " ", "the", " ", "field", " ", "is", " ", "in", " ",
                     "the", " ", "zigzag"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"it", "'"}], "s"}], " ", "-", 
                    RowBox[{
                    "1", " ", "if", " ", "it", " ", "appears", " ", "on", " ",
                     "top", " ", "and"}], " ", "+", 
                    RowBox[{
                    "1", " ", "if", " ", "it", " ", "appears", " ", "on", " ",
                     "the", " ", "bottom"}]}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}], ",", 
                    SubscriptBox["YY", 
                    RowBox[{"i", ",", "j"}]]}], "]"}], 
                    SubscriptBox["YY", 
                    RowBox[{"i", ",", "j"}]]}], "\[Equal]", 
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}]}], ",", 
                    RowBox[{"(*", 
                    RowBox[{"appears", " ", "on", " ", "top"}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "-", "1"}]}], ";"}], ",", "True", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "+", "1"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<\[CapitalDelta] = \>\"", ",", 
           RowBox[{"Delta", "//", "MatrixForm"}]}], "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Make", " ", "the", " ", "variables", " ", "that", " ", "go", " ", 
         "into", " ", "QDT"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"QDT", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          SubscriptBox["y", 
           RowBox[{"m", ",", "n"}]], ",", 
          RowBox[{"{", 
           RowBox[{"m", ",", 
            RowBox[{"Length", "[", "plist", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", 
            RowBox[{"IF", "+", 
             RowBox[{"Length", "[", "addgauge", "]"}], "+", 
             RowBox[{"Length", "[", "zed", "]"}]}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Put", " ", "all", " ", "the", " ", "elements", " ", 
          SubscriptBox["y", 
           RowBox[{"m", ",", "n"}]], " ", "in", " ", "a", " ", "long", " ", 
          "list"}], ",", " ", 
         RowBox[{
         "so", " ", "that", " ", "we", " ", "can", " ", "solve", " ", "for", 
          " ", "the", " ", 
          RowBox[{"list", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"QDTlist", "=", 
        RowBox[{"Flatten", "[", "QDT", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"solution", "=", 
        RowBox[{"Solve", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"P", ".", "QDT"}], "\[Equal]", "Delta"}], ",", "QDTlist"}],
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"newQDTlist", "=", 
        RowBox[{"QDTlist", "/.", "solution"}]}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{
        "Plug", " ", "in", " ", "solution", " ", "into", " ", "a", " ", 
         "matrix"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Now", " ", "need", " ", "to", " ", "put", " ", "the", " ", 
         "elements", " ", "back", " ", "into", " ", "QDT"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"temp", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", "plist", "]"}], "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "<", 
             RowBox[{"IF", "+", 
              RowBox[{"Length", "[", "addgauge", "]"}], "+", 
              RowBox[{"Length", "[", "zed", "]"}], "+", "1"}]}], ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"QDT", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
              RowBox[{"newQDTlist", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "temp"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"temp", "=", 
              RowBox[{"temp", "+", "1"}]}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"QD", "=", 
        RowBox[{"Transpose", "[", "QDT", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<\!\(\*SubscriptBox[\(Q\), \(D\)]\)= \>\"", ",", 
           RowBox[{"QD", "//", "MatrixForm"}]}], "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Q", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"QF", ",", "QD"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Gmoduliold", "=", 
        RowBox[{"NullSpace", "[", "Q", "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"RowReduce", "[", "Gmoduli", "]"}], "\[Equal]", 
          RowBox[{"RowReduce", "[", "Gmoduliold", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "Print", "[", "\"\<The two MATRICES ARE THE SAME!\>\"", "]"}], 
          ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{
          RowBox[{
          "Print", "[", 
           "\"\<The two matrices are different... Maybe they are the same \
space after a translation...\>\"", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"subtract", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Transpose", "[", "Gmoduliold", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "-", 
            RowBox[{
             RowBox[{"Transpose", "[", "Gmoduli", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"transGmoduliold", "=", 
           RowBox[{"RowReduce", "[", 
            RowBox[{"Gmoduliold", "-", 
             RowBox[{"Transpose", "[", 
              RowBox[{"Table", "[", 
               RowBox[{"subtract", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Dimensions", "[", "Gmoduliold", "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "}"}]}], "]"}], "]"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"RowReduce", "[", "Gmoduli", "]"}], "\[Equal]", 
             RowBox[{"RowReduce", "[", "transGmoduliold", "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
             "Print", "[", 
              "\"\<After a translation, the two matrices are INDEED THE SAME!\
\>\"", "]"}], ";"}], "\[IndentingNewLine]", ",", 
            RowBox[{
             RowBox[{
             "Print", "[", 
              "\"\<The two MATRICES ARE DIFFERENT even after the translation. \
Look at the multiplicities.\>\"", "]"}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"multold", "=", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Dimensions", "[", 
                  RowBox[{
                   RowBox[{"Gather", "[", 
                    RowBox[{"Transpose", "[", "Gmoduliold", "]"}], "]"}], "[", 
                   RowBox[{"[", "y", "]"}], "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "1"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"y", ",", 
                  RowBox[{
                   RowBox[{"Dimensions", "[", 
                    RowBox[{"Gather", "[", 
                    RowBox[{"Transpose", "[", "Gmoduliold", "]"}], "]"}], 
                    "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Print", "[", 
              RowBox[{"\"\<multiplicity = \>\"", ",", 
               RowBox[{"multold", "//", "MatrixForm"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Print", "[", 
              RowBox[{"\"\<Multmatrix = \>\"", ",", 
               RowBox[{"Multmatrix", "//", "MatrixForm"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"multold", "\[Equal]", "Multmatrix"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                "Print", "[", 
                 "\"\<The multiplicities of each point are EXACTLY the same! \
Indication that the spaces are actually the same.\>\"", "]"}], ";"}], 
               "\[IndentingNewLine]", ",", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"Sort", "[", 
                    RowBox[{
                    RowBox[{"multold", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "Greater"}], "]"}], 
                    "}"}], "\[Equal]", 
                   RowBox[{"{", 
                    RowBox[{"Sort", "[", 
                    RowBox[{
                    RowBox[{"Multmatrix", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "Greater"}], "]"}], 
                    "}"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                   "Print", "[", 
                    "\"\<The multiplicity matrices are the same, only after \
reordering the columns.\>\"", "]"}], ";"}], "\[IndentingNewLine]", ",", 
                  RowBox[{
                   RowBox[{
                   "Print", "[", 
                    "\"\<The multiplicites are actually different... At best, \
the two moduli spaces are different phases of the same CY. But they naively \
seem DIFFERENT.\>\"", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", "\"\<-------------------------------------\>\"", "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", 
        "\"\<Variables are 'QF'=redundancies (F-term charge matrix); \
'QD'=D-term charge matrix; 'Gmoduliold'=moduli space using the old \
method;\>\"", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", "\"\<-------------------------------------\>\"", "]"}], 
       ";"}]}], "\[IndentingNewLine]", "]"}]}], "*)"}], "\[IndentingNewLine]",
   "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"SKIPPED", ",", " ", 
    RowBox[{"NO", " ", "NEED", " ", "FOR", " ", 
     RowBox[{"IT", "!"}]}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Finds", " ", "all", " ", "reductions", " ", "to", " ", "a", " ", 
      RowBox[{"graph", ".", " ", "It"}], " ", "needs", " ", "the", " ", 
      "moduli", " ", "space", " ", "and", " ", "the", " ", "perfect", " ", 
      "matching", " ", "matrix", " ", 
      RowBox[{"P", ".", " ", "Give"}], " ", "it", " ", "num"}], "=", 
     RowBox[{
     "1", " ", "if", " ", "you", " ", "are", " ", "considering", " ", 
      "Xlist"}]}], ",", " ", 
    RowBox[{
     RowBox[{"and", " ", "num"}], "=", 
     RowBox[{"2", " ", "if", " ", "you", " ", "are", " ", "considering", " ", 
      RowBox[{"Xlisthiggs", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"whichnum", "[", 
      RowBox[{"gi_", ",", "lev_"}], "]"}], ":=", 
     RowBox[{
      SubscriptBox["kills", "lev"], "[", 
      RowBox[{"[", "gi", "]"}], "]"}]}], ";", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
      "whichnum", " ", "and", " ", "Xs", " ", "are", " ", "auxiliary", " ", 
       "functions"}], ",", " ", 
      RowBox[{"useful", " ", "later"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "whichnum", " ", "translates", " ", "a", " ", "try", " ", "number", " ", 
      "to", " ", "which", " ", "pms", " ", "are", " ", "actually", " ", 
      "killed"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Xs", "[", "numb_", "]"}], ":=", 
     RowBox[{"Xlist", "[", 
      RowBox[{"[", "numb", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Xshigg", "[", "numb_", "]"}], ":=", 
     RowBox[{"Xlisthiggs", "[", 
      RowBox[{"[", "numb", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"reduction", "[", 
      RowBox[{"P_", ",", "Gmoduli_", ",", "num_"}], "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "level", ",", "try", ",", "die", ",", "hig", ",", "kil", ",", "el", 
         ",", "Gnew", ",", "dum", ",", "Gshorta", ",", "newGshort", ",", 
         "remSets", ",", "Xlista", ",", "Gnewtrans"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"num", "\[Equal]", "1"}], ",", 
          RowBox[{
           RowBox[{"Xlista", "=", "Xlist"}], ";"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"num", "\[Equal]", "2"}], ",", 
          RowBox[{
           RowBox[{"Xlista", "=", "Xlisthiggs"}], ";"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"level", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Gshorta", "=", 
         RowBox[{"Transpose", "[", 
          RowBox[{"DeleteDuplicates", "[", 
           RowBox[{"Transpose", "[", "Gmoduli", "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{"True", ",", 
          RowBox[{"(*", 
           RowBox[{"keep", " ", "going", " ", "until", " ", 
            RowBox[{"we", "'"}], "re", " ", "finished", " ", "Higgsing"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"level", "=", 
            RowBox[{"level", "+", "1"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            SubscriptBox["higgs", "level"], "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"level", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               SubscriptBox["kills", "level"], "=", 
               RowBox[{"Transpose", "[", 
                RowBox[{"{", 
                 RowBox[{"Range", "[", 
                  RowBox[{"Length", "[", "Xlista", "]"}], "]"}], "}"}], 
                "]"}]}], ";"}], 
             RowBox[{"(*", 
              RowBox[{"Higgs", " ", "for", " ", "level", " ", "1"}], "*)"}], 
             "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               SubscriptBox["kills", "level"], "=", 
               RowBox[{"Subsets", "[", 
                RowBox[{
                 SubscriptBox["higgs", "1"], ",", 
                 RowBox[{"{", "level", "}"}]}], "]"}]}], ";"}]}], 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{
              "These", " ", "are", " ", "the", " ", "sets", " ", "of", " ", 
               "fields", " ", "we", " ", "are", " ", "going", " ", "to", " ", 
               "try", " ", "and", " ", 
               RowBox[{"kill", ".", " ", "For"}], " ", 
               SubscriptBox["higgs", "1"]}], ",", 
              RowBox[{
               RowBox[{"Xlist", "[", 
                RowBox[{"[", 
                 RowBox[{
                  SubscriptBox["higgs", "1"], "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], " ", "makes", 
               " ", "sense"}], ",", " ", 
              RowBox[{
               SubscriptBox["higgs", "1"], " ", "happens", " ", "to", " ", 
               "actually", " ", "refer", " ", "to", " ", "the", " ", 
               "\"\<try\>\"", " ", "number", " ", "as", " ", "well", " ", 
               "as", " ", "the", " ", "number", " ", "of", " ", "the", " ", 
               "higgsed", " ", 
               RowBox[{"leg", "."}]}]}], "*)"}], "\[IndentingNewLine]", "]"}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<Level is \>\"", ",", "level", ",", 
             "\"\< and we have to check \>\"", ",", 
             RowBox[{"Length", "[", 
              SubscriptBox["kills", "level"], "]"}], ",", "\"\< guys.\>\""}], 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"try", "=", "1"}], ",", 
             RowBox[{"try", "<", 
              RowBox[{
               RowBox[{"Length", "[", 
                SubscriptBox["kills", "level"], "]"}], "+", "1"}]}], ",", 
             RowBox[{"try", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"die", "=", 
               RowBox[{"{", "}"}]}], ";", 
              RowBox[{"(*", 
               RowBox[{
               "Will", " ", "contains", " ", "the", " ", "list", " ", "of", 
                " ", "which", " ", "columns", " ", "die"}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"hig", "=", "1"}], ",", 
                RowBox[{"hig", "<", 
                 RowBox[{"level", "+", "1"}]}], ",", 
                RowBox[{"hig", "++"}], ",", 
                RowBox[{"(*", 
                 RowBox[{
                 "We", " ", "are", " ", "higgsing", " ", "\"\<level\>\"", " ",
                   "number", " ", "of", " ", "fields"}], "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"kil", "=", 
                  RowBox[{
                   SubscriptBox["kills", "level"], "[", 
                   RowBox[{"[", 
                    RowBox[{"try", ",", "hig"}], "]"}], "]"}]}], ";", 
                 RowBox[{"(*", 
                  RowBox[{"We", " ", "now", " ", "kill", " ", 
                   RowBox[{"Xlista", "[", 
                    RowBox[{"[", "kil", "]"}], "]"}]}], "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{"For", "[", 
                  RowBox[{
                   RowBox[{"el", "=", "1"}], ",", 
                   RowBox[{"el", "<", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Dimensions", "[", "P", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "+", "1"}]}], ",", 
                   RowBox[{"el", "++"}], ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"kil", ",", "el"}], "]"}], "]"}], "\[Equal]", 
                    "1"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"die", "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{"die", ",", 
                    RowBox[{"{", "el", "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"die", "=", 
               RowBox[{"DeleteDuplicates", "[", "die", "]"}]}], ";", 
              RowBox[{"(*", 
               RowBox[{
               "These", " ", "are", " ", "the", " ", "columns", " ", "that", 
                " ", "must", " ", "be", " ", "removed", " ", "from", " ", 
                "Gmoduli"}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"Gnewtrans", "=", 
               RowBox[{"Delete", "[", 
                RowBox[{
                 RowBox[{"Transpose", "[", "Gmoduli", "]"}], ",", 
                 RowBox[{"Transpose", "[", 
                  RowBox[{"{", "die", "}"}], "]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{"Finished", " ", "killing", " ", "perfect", " ", 
                RowBox[{"matchings", "!"}]}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
               "Now", " ", "check", " ", "if", " ", "Gshorta", " ", "has", 
                " ", "same", " ", "number", " ", "of", " ", "points", " ", 
                "as", " ", 
                RowBox[{"before", "."}]}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"Gnewtrans", "\[Equal]", 
                 RowBox[{"{", "}"}]}], ",", 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{
                  "if", " ", "Gnew", " ", "has", " ", "been", " ", "killed", 
                   " ", "completely"}], ",", 
                  RowBox[{
                   RowBox[{"i", ".", "e", ".", " ", "we"}], " ", "killed", 
                   " ", "all", " ", 
                   RowBox[{"pm", "'"}], "s"}], ",", " ", 
                  RowBox[{
                   RowBox[{"say", " ", "newGshort"}], "=", "Gnew"}]}], "*)"}],
                 "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"newGshort", "=", 
                  RowBox[{"Table", "[", 
                   RowBox[{"0", ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", 
                    RowBox[{
                    RowBox[{"Dimensions", "[", "Gshorta", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", "0"}], "}"}]}], "]"}]}], ";"}], 
                "\[IndentingNewLine]", ",", 
                RowBox[{
                 RowBox[{"Gnew", "=", 
                  RowBox[{"Transpose", "[", "Gnewtrans", "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"newGshort", "=", 
                  RowBox[{"Transpose", "[", 
                   RowBox[{"DeleteDuplicates", "[", "Gnewtrans", "]"}], 
                   "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Dimensions", "[", "newGshort", "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "==", 
                 RowBox[{
                  RowBox[{"Dimensions", "[", "Gshorta", "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  SubscriptBox["higgs", "level"], "=", 
                  RowBox[{"Join", "[", 
                   RowBox[{
                    SubscriptBox["higgs", "level"], ",", 
                    RowBox[{"{", "try", "}"}]}], "]"}]}], ";"}]}], 
               RowBox[{"(*", 
                RowBox[{
                "remebers", " ", "which", " ", "of", " ", "the", " ", 
                 "subsets", " ", "was", " ", "good", " ", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"doesn", "'"}], "t", " ", "know", " ", "what", 
                    " ", "the", " ", "subset", " ", "looks", " ", 
                    RowBox[{"like", ".", " ", 
                    RowBox[{"That", "'"}]}], "s", " ", "what", " ", 
                    "whichnum", " ", "is", " ", "for"}], ")"}], "."}]}], 
                "*)"}], "\[IndentingNewLine]", "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", 
           RowBox[{"(*", 
            RowBox[{"Close", " ", "for", " ", "try"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               SubscriptBox["higgs", "level"], "\[Equal]", 
               RowBox[{"{", "}"}]}], "||", 
              RowBox[{"level", "\[Equal]", 
               RowBox[{"Length", "[", "Xlista", "]"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"level", "\[Equal]", "1"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Print", "[", "\"\<No reductions!\>\"", "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", 
               "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"remSets", "=", 
               RowBox[{"MapThread", "[", 
                RowBox[{"whichnum", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   SubscriptBox["higgs", 
                    RowBox[{"level", "-", "1"}]], ",", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"level", "-", "1"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["higgs", 
                    RowBox[{"level", "-", "1"}]], "]"}], "}"}]}], "]"}]}], 
                  "}"}]}], "]"}]}], ";", " ", 
              RowBox[{"(*", 
               RowBox[{"evaluates", " ", 
                RowBox[{"whichnum", "[", 
                 RowBox[{"x", ",", 
                  RowBox[{"level", "-", "1"}]}], "]"}], " ", "for", " ", 
                "all", " ", "elements", " ", "in", " ", 
                SubscriptBox["higgs", 
                 RowBox[{"level", "-", "1"}]]}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"num", "\[Equal]", "1"}], ",", 
                RowBox[{
                 RowBox[{"higgslist", "=", 
                  RowBox[{"MapThread", "[", 
                   RowBox[{"Xs", ",", 
                    RowBox[{"{", "remSets", "}"}], ",", "2"}], "]"}]}], 
                 ";"}]}], "]"}], ";", " ", 
              RowBox[{"(*", 
               RowBox[{"turns", " ", "numbers", " ", "into", " ", 
                SubscriptBox["X", 
                 RowBox[{"i", ",", "j"}]], " ", "fields"}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"num", "\[Equal]", "2"}], ",", 
                RowBox[{
                 RowBox[{"higgslist", "=", 
                  RowBox[{"MapThread", "[", 
                   RowBox[{"Xshigg", ",", 
                    RowBox[{"{", "remSets", "}"}], ",", "2"}], "]"}]}], 
                 ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"higgslist", "=", 
               RowBox[{"DeleteDuplicates", "[", 
                RowBox[{"Map", "[", 
                 RowBox[{"Sort", ",", "higgslist"}], "]"}], "]"}]}], ";", 
              RowBox[{"(*", 
               RowBox[{
               "Make", " ", "sure", " ", "there", " ", "are", " ", "no", " ", 
                "Higgsings", " ", "that", " ", "are", " ", "actually", " ", 
                "the", " ", "same"}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"Print", "[", 
               RowBox[{"\"\<Can remove \>\"", ",", 
                RowBox[{"level", "-", "1"}], ",", "\"\< legs in \>\"", ",", 
                RowBox[{"Length", "[", "higgslist", "]"}], ",", 
                "\"\< different ways.\>\""}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<Sets of legs that can be Higgsed are 'higgslist'= \>\"", 
                ",", "higgslist"}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
      RowBox[{"(*", 
       RowBox[{"Close", " ", "while"}], "*)"}], "\[IndentingNewLine]", 
      "]"}]}]}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"DONE", ",", " ", 
    RowBox[{"NOW", " ", "CALLED", " ", "reductionGraphBFT"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Higgses", " ", "a", " ", "field"}], ",", " ", 
    RowBox[{
    "giving", " ", "the", " ", "new", " ", "P", " ", "matrix", " ", "and", 
     " ", "the", " ", "higgsed", " ", "moduli", " ", 
     RowBox[{"space", ".", " ", "Assumes"}], " ", "that", " ", "P", " ", 
     "and", " ", "Xlist", " ", "are", " ", "already", " ", 
     RowBox[{"known", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"higgs", "[", 
     RowBox[{"field_", ",", "Xlist_", ",", "P_", ",", "Gmoduli_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"num", ",", "killist", ",", "rowhiggs"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"num", "=", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"Xlist", ",", "field"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"killist", "=", 
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"P", "[", 
           RowBox[{"[", "num", "]"}], "]"}], ",", "1"}], "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "These", " ", "are", " ", "the", " ", "perfect", " ", "matchings", 
         " ", "that", " ", "die"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "We", " ", "also", " ", "have", " ", "to", " ", "higgs", " ", "any", 
         " ", "row", " ", "that", " ", "is", " ", "identical", " ", "to", " ",
          "the", " ", "one", " ", "we", " ", "removed"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"rowhiggs", "=", 
        RowBox[{"Position", "[", 
         RowBox[{"P", ",", 
          RowBox[{"P", "[", 
           RowBox[{"[", "num", "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Phiggs", "=", 
        RowBox[{"Delete", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"Delete", "[", 
            RowBox[{
             RowBox[{"Transpose", "[", "P", "]"}], ",", "killist"}], "]"}], 
           "]"}], ",", "rowhiggs"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "We", " ", "have", " ", "to", " ", "also", " ", "change", " ", "the", 
         " ", "moduli", " ", "space"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Gmodulihiggs", "=", 
        RowBox[{"Transpose", "[", 
         RowBox[{"Delete", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", "Gmoduli", "]"}], ",", "killist"}], 
          "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Gmodulihiggs", "=", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{"Gmodulihiggs", ",", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", 
            RowBox[{
             RowBox[{"Dimensions", "[", "Gmodulihiggs", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "This", " ", "is", " ", "the", " ", "space", " ", "we", " ", "get", 
         " ", "after", " ", "having", " ", "killed", " ", "the", " ", 
         RowBox[{"field", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Gmodulihiggs", "\[Equal]", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{
          RowBox[{"Gmodulihiggs", "=", 
           RowBox[{"{", 
            RowBox[{"{", "0", "}"}], "}"}]}], ";"}]}], "]"}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{
        "In", " ", "case", " ", "we", " ", "accidentally", " ", "killed", " ",
          "too", " ", "much"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Xlisthiggs", "=", 
        RowBox[{"Delete", "[", 
         RowBox[{"Xlist", ",", "rowhiggs"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<After killing \>\"", ",", "field", ",", 
         "\"\< the Master space has dimension \>\"", ",", 
         RowBox[{"BFTdim", "[", "Phiggs", "]"}], ",", 
         "\"\< and the moduli space has dimension \>\"", ",", 
         RowBox[{
          RowBox[{"BFTdim", "[", "Gmodulihiggs", "]"}], "\"\<.\>\""}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", 
        "\"\<The new P matrix is saved under 'Phiggs'. New moduli space under \
'Gmodulihiggs'. New Xlist under 'Xlisthiggs'.\>\"", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"reducibility", "[", 
          RowBox[{"Phiggs", ",", "Gmodulihiggs"}], "]"}], ",", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<The space is now reducible!\>\"", "]"}], 
          ";"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"SKIPPED", ",", " ", 
    RowBox[{
    "THIS", " ", "IS", " ", "DONE", " ", "IN", " ", "THREE", " ", "LINES", 
     " ", "IN", " ", "removableEdges"}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Does", " ", "the", " ", "exact", " ", "same", " ", "as", " ", 
     RowBox[{"higgs", "[", 
      RowBox[{"field", ",", "Xlist", ",", "P", ",", "Gmoduli"}], "]"}]}], ",",
     " ", 
    RowBox[{"but", " ", 
     RowBox[{"doesn", "'"}], "t", " ", "print", " ", "out", " ", "lots", " ", 
     "of", " ", 
     RowBox[{"text", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"higgsquiet", "[", 
     RowBox[{"field_", ",", "Xlist_", ",", "P_", ",", "Gmoduli_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"num", ",", "killist", ",", "rowhiggs"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"num", "=", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"Xlist", ",", "field"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"killist", "=", 
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"P", "[", 
           RowBox[{"[", "num", "]"}], "]"}], ",", "1"}], "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "These", " ", "are", " ", "the", " ", "perfect", " ", "matchings", 
         " ", "that", " ", "die"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "We", " ", "also", " ", "have", " ", "to", " ", "higgs", " ", "any", 
         " ", "row", " ", "that", " ", "is", " ", "identical", " ", "to", " ",
          "the", " ", "one", " ", "we", " ", "removed"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"rowhiggs", "=", 
        RowBox[{"Position", "[", 
         RowBox[{"P", ",", 
          RowBox[{"P", "[", 
           RowBox[{"[", "num", "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Phiggs", "=", 
        RowBox[{"Delete", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"Delete", "[", 
            RowBox[{
             RowBox[{"Transpose", "[", "P", "]"}], ",", "killist"}], "]"}], 
           "]"}], ",", "rowhiggs"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "We", " ", "have", " ", "to", " ", "also", " ", "change", " ", "the", 
         " ", "moduli", " ", "space"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Gmodulihiggs", "=", 
        RowBox[{"Transpose", "[", 
         RowBox[{"Delete", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", "Gmoduli", "]"}], ",", "killist"}], 
          "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Gmodulihiggs", "=", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{"Gmodulihiggs", ",", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", 
            RowBox[{
             RowBox[{"Dimensions", "[", "Gmodulihiggs", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "This", " ", "is", " ", "the", " ", "space", " ", "we", " ", "get", 
         " ", "after", " ", "having", " ", "killed", " ", "the", " ", 
         RowBox[{"field", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Gmodulihiggs", "\[Equal]", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{
          RowBox[{"Gmodulihiggs", "=", 
           RowBox[{"{", 
            RowBox[{"{", "0", "}"}], "}"}]}], ";"}]}], "]"}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{
        "In", " ", "case", " ", "we", " ", "accidentally", " ", "killed", " ",
          "too", " ", "much"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Xlisthiggs", "=", 
        RowBox[{"Delete", "[", 
         RowBox[{"Xlist", ",", "rowhiggs"}], "]"}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"SKIPPED", ",", " ", 
    RowBox[{"NOT", " ", "NEEDED"}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Gives", " ", "a", " ", "list", " ", "of", " ", "the", " ", "removable", 
    " ", 
    RowBox[{"legs", ".", " ", "Assumes"}], " ", "that", " ", "P", " ", "and", 
    " ", "Xlist", " ", "are", " ", "already", " ", 
    RowBox[{"known", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"removable", "[", 
     RowBox[{"Xlist_", ",", "P_", ",", "Gmoduli_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "la", ",", "field", ",", "killist", ",", "Ptry", ",", "Gmodulitry", 
        ",", "rowhiggs", ",", "skip"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Now", " ", "calculate", " ", "dimension", " ", "of", " ", "master", 
        " ", "space", " ", "after", " ", "killing", " ", "an", " ", 
        SubscriptBox["X", 
         RowBox[{"i", ",", "j"}]]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"remlegs", "=", 
        RowBox[{"{", "}"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{"lists", " ", "the", " ", "removable", " ", "edges"}], "*)"}],
        "\[IndentingNewLine]", 
       RowBox[{"skip", "=", 
        RowBox[{"{", "}"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "We", " ", "will", " ", "need", " ", "to", " ", "skip", " ", "rows", 
         " ", "that", " ", "are", " ", "identical", " ", "to", " ", "rows", 
         " ", 
         RowBox[{"we", "'"}], "ve", " ", "already", " ", "considered"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"la", "=", "1"}], ",", 
         RowBox[{"la", "<", 
          RowBox[{
           RowBox[{"Length", "[", "P", "]"}], "+", "1"}]}], ",", 
         RowBox[{"la", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"FreeQ", "[", 
             RowBox[{"skip", ",", "la"}], "]"}], ",", 
            RowBox[{"(*", 
             RowBox[{
             "If", " ", "the", " ", "row", " ", "we", " ", "consider", " ", 
              "is", " ", "not", " ", "one", " ", 
              RowBox[{"we", "'"}], "ve", " ", "already", " ", "considered", 
              " ", 
              RowBox[{"(", 
               RowBox[{
               "and", " ", "hence", " ", "been", " ", "told", " ", "to", " ", 
                "skip"}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"field", "=", 
              RowBox[{"Xlist", "[", 
               RowBox[{"[", "la", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"killist", "=", 
              RowBox[{"Position", "[", 
               RowBox[{
                RowBox[{"P", "[", 
                 RowBox[{"[", "la", "]"}], "]"}], ",", "1"}], "]"}]}], ";", 
             RowBox[{"(*", 
              RowBox[{
              "These", " ", "are", " ", "the", " ", "perfect", " ", 
               "matchings", " ", "that", " ", "die"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"rowhiggs", "=", 
              RowBox[{"Position", "[", 
               RowBox[{"P", ",", 
                RowBox[{"P", "[", 
                 RowBox[{"[", "la", "]"}], "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", "rowhiggs", "]"}], ">", "1"}], ",", 
               RowBox[{"skip", "=", 
                RowBox[{"Join", "[", 
                 RowBox[{"skip", ",", 
                  RowBox[{
                   RowBox[{"Transpose", "[", 
                    RowBox[{"Delete", "[", 
                    RowBox[{"rowhiggs", ",", "1"}], "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", "killist", "]"}], "<", 
                RowBox[{
                 RowBox[{"Dimensions", "[", "P", "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", 
               RowBox[{"(*", 
                RowBox[{
                "Only", " ", "kill", " ", "if", " ", "there", " ", "will", 
                 " ", "be", " ", "some", " ", "survivors"}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Ptry", "=", 
                 RowBox[{"Delete", "[", 
                  RowBox[{
                   RowBox[{"Transpose", "[", 
                    RowBox[{"Delete", "[", 
                    RowBox[{
                    RowBox[{"Transpose", "[", "P", "]"}], ",", "killist"}], 
                    "]"}], "]"}], ",", "rowhiggs"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"Gmodulitry", "=", 
                 RowBox[{"Transpose", "[", 
                  RowBox[{"Delete", "[", 
                   RowBox[{
                    RowBox[{"Transpose", "[", "Gmoduli", "]"}], ",", 
                    "killist"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"Gmodulitry", "=", 
                 RowBox[{"DeleteCases", "[", 
                  RowBox[{"Gmodulitry", ",", 
                   RowBox[{"ConstantArray", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{
                    RowBox[{"Dimensions", "[", "Gmodulitry", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"Gmodulitry", "\[Equal]", 
                   RowBox[{"{", "}"}]}], ",", 
                  RowBox[{
                   RowBox[{"Gmodulitry", "=", 
                    RowBox[{"{", 
                    RowBox[{"{", "0", "}"}], "}"}]}], ";"}]}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"!", 
                   RowBox[{"reducibility", "[", 
                    RowBox[{"Ptry", ",", "Gmodulitry"}], "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"remlegs", "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{"remlegs", ",", 
                    RowBox[{"{", "field", "}"}]}], "]"}]}], ";"}]}], "]"}], 
                ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "remlegs", "]"}], "\[NotEqual]", "0"}], ",", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<The removable legs are 'remlegs'=\>\"", ",", "remlegs"}], 
           "]"}], ";"}], ",", 
         RowBox[{
         "Print", "[", "\"\<There are no removable legs!\>\"", "]"}]}], "]"}],
        ";"}]}], "\[IndentingNewLine]", "]"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"DONE", ",", " ", 
    RowBox[{
    "THIS", " ", "IS", " ", "NOW", " ", "PART", " ", "OF", " ", 
     "removableEdges"}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Same", " ", "as", " ", 
     RowBox[{"removable", "[", 
      RowBox[{"Xlist", ",", "P", ",", "Gmoduli"}], "]"}]}], ",", " ", 
    RowBox[{"but", " ", 
     RowBox[{"doesn", "'"}], "t", " ", "print", " ", "any", " ", 
     RowBox[{"text", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"removablequiet", "[", 
     RowBox[{"Xlist_", ",", "P_", ",", "Gmoduli_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "la", ",", "field", ",", "killist", ",", "Ptry", ",", "Gmodulitry", 
        ",", "rowhiggs", ",", "skip"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Now", " ", "calculate", " ", "dimension", " ", "of", " ", "master", 
        " ", "space", " ", "after", " ", "killing", " ", "an", " ", 
        SubscriptBox["X", 
         RowBox[{"i", ",", "j"}]]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"remlegs", "=", 
        RowBox[{"{", "}"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{"lists", " ", "the", " ", "removable", " ", "edges"}], "*)"}],
        "\[IndentingNewLine]", 
       RowBox[{"skip", "=", 
        RowBox[{"{", "}"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "We", " ", "will", " ", "need", " ", "to", " ", "skip", " ", "rows", 
         " ", "that", " ", "are", " ", "identical", " ", "to", " ", "rows", 
         " ", 
         RowBox[{"we", "'"}], "ve", " ", "already", " ", "considered"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"la", "=", "1"}], ",", 
         RowBox[{"la", "<", 
          RowBox[{
           RowBox[{"Length", "[", "P", "]"}], "+", "1"}]}], ",", 
         RowBox[{"la", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"FreeQ", "[", 
             RowBox[{"skip", ",", "la"}], "]"}], ",", 
            RowBox[{"(*", 
             RowBox[{
             "If", " ", "the", " ", "row", " ", "we", " ", "consider", " ", 
              "is", " ", "not", " ", "one", " ", 
              RowBox[{"we", "'"}], "ve", " ", "already", " ", "considered", 
              " ", 
              RowBox[{"(", 
               RowBox[{
               "and", " ", "hence", " ", "been", " ", "told", " ", "to", " ", 
                "skip"}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"field", "=", 
              RowBox[{"Xlist", "[", 
               RowBox[{"[", "la", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"killist", "=", 
              RowBox[{"Position", "[", 
               RowBox[{
                RowBox[{"P", "[", 
                 RowBox[{"[", "la", "]"}], "]"}], ",", "1"}], "]"}]}], ";", 
             RowBox[{"(*", 
              RowBox[{
              "These", " ", "are", " ", "the", " ", "perfect", " ", 
               "matchings", " ", "that", " ", "die"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"rowhiggs", "=", 
              RowBox[{"Position", "[", 
               RowBox[{"P", ",", 
                RowBox[{"P", "[", 
                 RowBox[{"[", "la", "]"}], "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", "rowhiggs", "]"}], ">", "1"}], ",", 
               RowBox[{"skip", "=", 
                RowBox[{"Join", "[", 
                 RowBox[{"skip", ",", 
                  RowBox[{
                   RowBox[{"Transpose", "[", 
                    RowBox[{"Delete", "[", 
                    RowBox[{"rowhiggs", ",", "1"}], "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", "killist", "]"}], "<", 
                RowBox[{
                 RowBox[{"Dimensions", "[", "P", "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", 
               RowBox[{"(*", 
                RowBox[{
                "Only", " ", "kill", " ", "if", " ", "there", " ", "will", 
                 " ", "be", " ", "some", " ", "survivors"}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Ptry", "=", 
                 RowBox[{"Delete", "[", 
                  RowBox[{
                   RowBox[{"Transpose", "[", 
                    RowBox[{"Delete", "[", 
                    RowBox[{
                    RowBox[{"Transpose", "[", "P", "]"}], ",", "killist"}], 
                    "]"}], "]"}], ",", "rowhiggs"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"Gmodulitry", "=", 
                 RowBox[{"Transpose", "[", 
                  RowBox[{"Delete", "[", 
                   RowBox[{
                    RowBox[{"Transpose", "[", "Gmoduli", "]"}], ",", 
                    "killist"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"Gmodulitry", "=", 
                 RowBox[{"DeleteCases", "[", 
                  RowBox[{"Gmodulitry", ",", 
                   RowBox[{"ConstantArray", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{
                    RowBox[{"Dimensions", "[", "Gmodulitry", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"Gmodulitry", "\[Equal]", 
                   RowBox[{"{", "}"}]}], ",", 
                  RowBox[{
                   RowBox[{"Gmodulitry", "=", 
                    RowBox[{"{", 
                    RowBox[{"{", "0", "}"}], "}"}]}], ";"}]}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"!", 
                   RowBox[{"reducibility", "[", 
                    RowBox[{"Ptry", ",", "Gmodulitry"}], "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"remlegs", "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{"remlegs", ",", 
                    RowBox[{"{", "field", "}"}]}], "]"}]}], ";"}]}], "]"}], 
                ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"SKIPPED", ",", " ", 
    RowBox[{"THIS", " ", "IS", " ", "DONE", " ", "ALREADY"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Checks", " ", "whether", " ", "the", " ", "points", " ", "that", " ", 
     "survive", " ", "after", " ", "killist", " ", "has", " ", "killed", " ", 
     "the", " ", "corresponding", " ", "columns", " ", "are", " ", "indeed", 
     " ", "a", " ", "boundary", " ", "of", " ", "the", " ", 
     RowBox[{"space", ".", " ", "It"}], " ", "checks", " ", "by", " ", 
     "spanning", " ", "a", " ", "hyperplane", " ", "with", " ", "the", " ", 
     "surviving", " ", "points"}], ",", " ", 
    RowBox[{
    "and", " ", "checks", " ", "whether", " ", "the", " ", "dead", " ", 
     "points", " ", "were", " ", "all", " ", "on", " ", "one", " ", "side", 
     " ", "of", " ", "the", " ", "plane", " ", "or", " ", "on", " ", "both", 
     " ", 
     RowBox[{"sides", ".", " ", "Returns"}], " ", "True", " ", "or", " ", 
     RowBox[{"False", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"checkBoundary", "[", 
     RowBox[{"P_", ",", "killist_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "newmat", ",", "gi", ",", "allpoints", ",", "compl", ",", "face", ",", 
        "points", ",", "otherpoints", ",", "co", ",", "plane", ",", "rep", 
        ",", "equ1", ",", "equ2", ",", "equ3", ",", "aa", ",", "bb", ",", 
        "xx", ",", "i", ",", "cor", ",", "try", ",", "below", ",", "on", ",", 
        "above", ",", "check"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", "P", "]"}], ",", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0", ",", 
             RowBox[{"Length", "[", "P", "]"}]}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"newmat", "=", "P"}], ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{
          RowBox[{"newmat", "=", "P"}], ";", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"gi", "=", "1"}], ",", 
            RowBox[{"gi", "<", 
             RowBox[{
              RowBox[{
               RowBox[{"Dimensions", "[", "P", "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "1"}]}], ",", 
            RowBox[{"gi", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"newmat", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "gi"}], "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{"newmat", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "gi"}], "]"}], "]"}], "-", 
               RowBox[{"P", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"allpoints", "=", 
        RowBox[{"Transpose", "[", "newmat", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"compl", "=", 
        RowBox[{
         RowBox[{"Transpose", "[", "killist", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{"These", " ", "are", " ", "the", " ", 
         RowBox[{"pm", "'"}], "s", " ", "that", " ", "die"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"face", "=", 
        RowBox[{"Complement", "[", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{
            RowBox[{"Dimensions", "[", "newmat", "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", "compl"}], "]"}]}], 
       ";", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "These", " ", "are", " ", "the", " ", "ones", " ", "that", " ", 
          "live"}], ",", " ", 
         RowBox[{"and", " ", "span", " ", "a", " ", "hyperplane"}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"points", "=", 
        RowBox[{"{", "}"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "Now", " ", "make", " ", "a", " ", "list", " ", "with", " ", "all", 
         " ", "the", " ", "surviving", " ", "coordinates"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"fa", "=", "1"}], ",", 
         RowBox[{"fa", "<", 
          RowBox[{
           RowBox[{"Length", "[", "face", "]"}], "+", "1"}]}], ",", 
         RowBox[{"fa", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"points", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"points", ",", 
             RowBox[{"{", 
              RowBox[{"allpoints", "[", 
               RowBox[{"[", 
                RowBox[{"face", "[", 
                 RowBox[{"[", "fa", "]"}], "]"}], "]"}], "]"}], "}"}]}], 
            "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"otherpoints", "=", 
        RowBox[{"{", "}"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "These", " ", "are", " ", "the", " ", "dead", " ", "coordinates"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"co", "=", "1"}], ",", 
         RowBox[{"co", "<", 
          RowBox[{
           RowBox[{"Length", "[", "compl", "]"}], "+", "1"}]}], ",", 
         RowBox[{"co", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"otherpoints", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"otherpoints", ",", 
             RowBox[{"{", 
              RowBox[{"allpoints", "[", 
               RowBox[{"[", 
                RowBox[{"compl", "[", 
                 RowBox[{"[", "co", "]"}], "]"}], "]"}], "]"}], "}"}]}], 
            "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"plane", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          SubscriptBox["aa", 
           RowBox[{"i", ",", "j"}]], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"Length", "[", "newmat", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"rep", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"FindInstance", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"plane", ".", 
               RowBox[{"Transpose", "[", "points", "]"}]}], "]"}], "\[Equal]", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{"bb", ",", 
               RowBox[{"Length", "[", "face", "]"}]}], "]"}]}], ",", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"Flatten", "[", "plane", "]"}], ",", 
              RowBox[{"{", "bb", "}"}]}], "]"}], ",", "Reals", ",", "2"}], 
           "]"}], ")"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"equ1", "=", 
        RowBox[{"Simplify", "[", 
         RowBox[{"equ1", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"plane", ".", 
                RowBox[{"Transpose", "[", 
                 RowBox[{"{", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    SubscriptBox["xx", "i"], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "newmat", "]"}]}], "}"}]}], "]"}], 
                  "}"}], "]"}]}], ")"}], "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}], "<", "bb"}], ")"}], "/.",
            "rep"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"equ2", "=", 
        RowBox[{"Simplify", "[", 
         RowBox[{"equ2", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"plane", ".", 
                RowBox[{"Transpose", "[", 
                 RowBox[{"{", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    SubscriptBox["xx", "i"], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "newmat", "]"}]}], "}"}]}], "]"}], 
                  "}"}], "]"}]}], ")"}], "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}], "\[Equal]", "bb"}], 
            ")"}], "/.", "rep"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"equ3", "=", 
        RowBox[{"Simplify", "[", 
         RowBox[{"equ3", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"plane", ".", 
                RowBox[{"Transpose", "[", 
                 RowBox[{"{", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    SubscriptBox["xx", "i"], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "newmat", "]"}]}], "}"}]}], "]"}], 
                  "}"}], "]"}]}], ")"}], "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}], ">", "bb"}], ")"}], "/.",
            "rep"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "We", " ", "have", " ", "the", " ", "equation", " ", "of", " ", "the",
          " ", 
         RowBox[{"hyperplane", "!"}]}], "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"below", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"on", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"above", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", "compl", "]"}], "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", 
         RowBox[{"(*", 
          RowBox[{
          "Now", " ", "try", " ", "each", " ", "of", " ", "the", " ", 
           "points", " ", "that", " ", "died", "  ", "and", " ", "see", " ", 
           "if", " ", "they", " ", "live", " ", "above", " ", "or", " ", 
           "below", " ", "the", " ", "plane"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           SubscriptBox["try", "i"], "=", 
           RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"cor", "=", "1"}], ",", 
            RowBox[{"cor", "<", 
             RowBox[{
              RowBox[{"Length", "[", "newmat", "]"}], "+", "1"}]}], ",", 
            RowBox[{"cor", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              SubscriptBox["try", "i"], "=", 
              RowBox[{"Join", "[", 
               RowBox[{
                SubscriptBox["try", "i"], ",", 
                RowBox[{"{", 
                 RowBox[{
                  SubscriptBox["xx", "cor"], "\[Rule]", 
                  RowBox[{"otherpoints", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "cor"}], "]"}], "]"}]}], "}"}]}], 
               "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"equ1", "/.", 
             SubscriptBox["try", "i"]}], ",", 
            RowBox[{
             RowBox[{"below", "=", 
              RowBox[{"below", "+", "1"}]}], ";"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"equ2", "/.", 
             SubscriptBox["try", "i"]}], ",", 
            RowBox[{
             RowBox[{"on", "=", 
              RowBox[{"on", "+", "1"}]}], ";"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"equ3", "/.", 
             SubscriptBox["try", "i"]}], ",", 
            RowBox[{
             RowBox[{"above", "=", 
              RowBox[{"above", "+", "1"}]}], ";"}]}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"below", "\[Equal]", "0"}], "||", 
          RowBox[{"above", "\[Equal]", "0"}]}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"on", "\[Equal]", "0"}], ",", 
           RowBox[{
            RowBox[{"check", "=", "True"}], ";"}], "\[IndentingNewLine]", ",", 
           RowBox[{
            RowBox[{"check", "=", "True"}], ";", "\[IndentingNewLine]", 
            RowBox[{
            "Print", "[", 
             "\"\<This COULD be a true boundary. Some points that were \
Higgsed were on the boundary. If they were internal in the boundary, then we \
have only Higgsed away perfect matchings that takes us to a true boundary. If \
they were external in the boundary, what we have now is not the actual \
boundary.\>\"", "]"}], ";"}]}], "]"}], "\[IndentingNewLine]", ",", 
         RowBox[{
          RowBox[{"check", "=", "False"}], ";"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "check"}]}], "\[IndentingNewLine]", "]"}]}], 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"SKIPPED", ",", " ", 
    RowBox[{"NO", " ", "NEED", " ", "FOR", " ", 
     RowBox[{"IT", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Calculates", " ", "the", " ", "moduli", " ", "space", " ", "using", " ", 
    "Gauging", " ", "1", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"using", " ", "charge", " ", "matrices"}], ")"}], "."}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"moduliGauging1", "[", 
     RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "IF", ",", "NF", ",", "Delta", ",", "i", ",", "j", ",", "k", ",", 
        "QDT", ",", "QDTlist", ",", "solution", ",", "newQDTlist", ",", 
        "temp", ",", "Q"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"kasteleyn", "[", 
        RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"IF", "=", 
        RowBox[{"internalFaces", "[", 
         RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"NF", "=", 
        RowBox[{"totFaces", "[", 
         RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Gmaster", "=", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{
          RowBox[{"RowReduce", "[", "P", "]"}], ",", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", 
            RowBox[{
             RowBox[{"Dimensions", "[", "P", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<The Master space is \>\"", ",", 
         RowBox[{"BFTdim", "[", "Gmaster", "]"}], ",", 
         "\"\<-dimensional. (NB This is the dimension of its toric diagram!).\
\>\""}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"QF", "=", 
        RowBox[{"NullSpace", "[", "P", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<\!\(\*SubscriptBox[\(Q\), \(F\)]\) = \>\"", ",", 
          RowBox[{"QF", "//", "MatrixForm"}]}], "]"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"First", " ", "make", " ", "Delta"}], ",", " ", 
         RowBox[{
          RowBox[{"then", " ", "plug", " ", "in", " ", "the", " ", "non"}], 
          "-", 
          RowBox[{"zero", " ", 
           RowBox[{"numbers", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Delta", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{"Length", "[", "Xlist", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", "IF"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Now", " ", "fill", " ", "in", " ", "the", " ", "non"}], "=", 
         RowBox[{"zero", " ", "numbers"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{"NF", "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "<", 
             RowBox[{"NF", "+", "1"}]}], ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"Take", " ", "a", " ", "specific", " ", 
              SubscriptBox["X", 
               RowBox[{"i", ",", "j"}]], " ", "or", " ", 
              SubscriptBox["Y", 
               RowBox[{"i", ",", "j"}]], " ", 
              RowBox[{"etc", ".", " ", "and"}], " ", "check", " ", "if", " ", 
              RowBox[{"it", "'"}], "s", " ", "in", " ", 
              RowBox[{"Xlist", "."}]}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"i", "\[NotEqual]", "j"}], ",", " ", 
               RowBox[{"(*", 
                RowBox[{
                 SubscriptBox["X", 
                  RowBox[{"i", ",", "i"}]], " ", 
                 RowBox[{"shouldn", "'"}], "t", " ", "be", " ", "nonzero"}], 
                "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"k", "=", "1"}], ",", 
                  RowBox[{"k", "<", 
                   RowBox[{
                    RowBox[{"Length", "[", "Xlist", "]"}], "+", "1"}]}], ",", 
                  RowBox[{"k", "++"}], ",", " ", 
                  RowBox[{"(*", 
                   RowBox[{
                   "Run", " ", "through", " ", "the", " ", "whole", " ", 
                    "Xlist"}], "*)"}], "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["X", 
                    RowBox[{"i", ",", "j"}]], "\[Equal]", 
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "&&", 
                    RowBox[{"i", "\[NotEqual]", "j"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i"}], "]"}], "]"}], "=", "1"}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"j", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{"-", "1"}]}], ";"}]}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["Y", 
                    RowBox[{"i", ",", "j"}]], "\[Equal]", 
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "&&", 
                    RowBox[{"i", "\[NotEqual]", "j"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i"}], "]"}], "]"}], "=", "1"}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"j", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{"-", "1"}]}], ";"}]}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["Z", 
                    RowBox[{"i", ",", "j"}]], "\[Equal]", 
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "&&", 
                    RowBox[{"i", "\[NotEqual]", "j"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i"}], "]"}], "]"}], "=", "1"}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"j", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{"-", "1"}]}], ";"}]}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["W", 
                    RowBox[{"i", ",", "j"}]], "\[Equal]", 
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "&&", 
                    RowBox[{"i", "\[NotEqual]", "j"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i"}], "]"}], "]"}], "=", "1"}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"j", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{"-", "1"}]}], ";"}]}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["V", 
                    RowBox[{"i", ",", "j"}]], "\[Equal]", 
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "&&", 
                    RowBox[{"i", "\[NotEqual]", "j"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i"}], "]"}], "]"}], "=", "1"}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"j", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{"-", "1"}]}], ";"}]}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["UU", 
                    RowBox[{"i", ",", "j"}]], "\[Equal]", 
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "&&", 
                    RowBox[{"i", "\[NotEqual]", "j"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i"}], "]"}], "]"}], "=", "1"}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"j", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{"-", "1"}]}], ";"}]}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["XX", 
                    RowBox[{"i", ",", "j"}]], "\[Equal]", 
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "&&", 
                    RowBox[{"i", "\[NotEqual]", "j"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i"}], "]"}], "]"}], "=", "1"}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"j", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{"-", "1"}]}], ";"}]}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["YY", 
                    RowBox[{"i", ",", "j"}]], "\[Equal]", 
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "&&", 
                    RowBox[{"i", "\[NotEqual]", "j"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i"}], "]"}], "]"}], "=", "1"}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"j", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{"-", "1"}]}], ";"}]}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<\[CapitalDelta] = \>\"", ",", 
           RowBox[{"Delta", "//", "MatrixForm"}]}], "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Make", " ", "the", " ", "variables", " ", "that", " ", "go", " ", 
         "into", " ", "QDT"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"QDT", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          SubscriptBox["y", 
           RowBox[{"m", ",", "n"}]], ",", 
          RowBox[{"{", 
           RowBox[{"m", ",", 
            RowBox[{"Length", "[", "plist", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "IF"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Put", " ", "all", " ", "the", " ", "elements", " ", 
          SubscriptBox["y", 
           RowBox[{"m", ",", "n"}]], " ", "in", " ", "a", " ", "long", " ", 
          "list"}], ",", " ", 
         RowBox[{
         "so", " ", "that", " ", "we", " ", "can", " ", "solve", " ", "for", 
          " ", "the", " ", 
          RowBox[{"list", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"QDTlist", "=", 
        RowBox[{"Flatten", "[", "QDT", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"solution", "=", 
        RowBox[{"Solve", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"P", ".", "QDT"}], "==", "Delta"}], ",", "QDTlist"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"newQDTlist", "=", 
        RowBox[{"QDTlist", "/.", "solution"}]}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{
        "Plug", " ", "in", " ", "solution", " ", "into", " ", "a", " ", 
         "matrix"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Now", " ", "need", " ", "to", " ", "put", " ", "the", " ", 
         "elements", " ", "back", " ", "into", " ", "QDT"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"temp", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", "plist", "]"}], "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "<", 
             RowBox[{"IF", "+", "1"}]}], ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"QDT", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
              RowBox[{"newQDTlist", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "temp"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"temp", "=", 
              RowBox[{"temp", "+", "1"}]}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"QD", "=", 
        RowBox[{"Transpose", "[", "QDT", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<\!\(\*SubscriptBox[\(Q\), \(D\)]\)= \>\"", ",", 
           RowBox[{"QD", "//", "MatrixForm"}]}], "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Q", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"QF", ",", "QD"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Q = \>\"", ",", 
           RowBox[{"Q", "//", "MatrixForm"}]}], "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Gmoduli", "=", 
        RowBox[{"NullSpace", "[", "Q", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<G = \>\"", ",", 
         RowBox[{"Gmoduli", "//", "MatrixForm"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<The moduli space is \>\"", ",", 
         RowBox[{"BFTdim", "[", "Gmoduli", "]"}], ",", 
         "\"\<-dimensional. (NB This is the dimension of its toric diagram!).\
\>\""}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Gshort", "=", 
        RowBox[{"Transpose", "[", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Transpose", "[", "Gmoduli", "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Multmatrix", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Dimensions", "[", 
            RowBox[{
             RowBox[{"Gather", "[", 
              RowBox[{"Transpose", "[", "Gmoduli", "]"}], "]"}], "[", 
             RowBox[{"[", "y", "]"}], "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", 
            RowBox[{
             RowBox[{"Dimensions", "[", 
              RowBox[{"Gather", "[", 
               RowBox[{"Transpose", "[", "Gmoduli", "]"}], "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", "\"\<-------------------------------------\>\"", "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", 
        "\"\<Variables are 'Gmaster'=master space; 'Gmoduli'=moduli space; \
'Gshort'=moduli space where doubles have been removed; \
'Multmatrix'=moultiplicity of each point in Gshort; 'QF'=redundancies (F-term \
charge matrix); 'QD'=D-term charge matrix;\>\"", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", "\"\<-------------------------------------\>\"", "]"}], 
       ";"}]}], "\[IndentingNewLine]", "]"}]}], "*)"}], "\[IndentingNewLine]",
   "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"DONE", ",", " ", 
    RowBox[{"NOW", " ", "CALLED", " ", "moduliSpaceBFT"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Finds", " ", "the", " ", "zig"}], "-", 
    RowBox[{
    "zag", " ", "paths", " ", "expressed", " ", "as", " ", "a", " ", 
     "product", " ", "and", " ", "division", " ", "of", " ", "fields", " ", 
     SubscriptBox["X", 
      RowBox[{"i", ",", "j"}]], " ", 
     RowBox[{"etc", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"sub1", "[", "field_", "]"}], ":=", 
     RowBox[{"field", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"sub2", "[", "field_", "]"}], ":=", 
     RowBox[{"field", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"makeZigzags", "[", 
      RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "K0full", ",", "bvar", ",", "cvar", ",", "ci", ",", "field", ",", 
         "rowpos", ",", "colpos", ",", "column", ",", "row", ",", "j"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "Print", "[", 
         "\"\<zig-zags are stored under \!\(\*SubscriptBox[\(zig\), \
\(i\)]\)=...  and zigzag={list of all \!\(\*SubscriptBox[\(zig\), \(i\)]\)}\>\
\"", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"K0full", "=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{"a", ",", "c"}], "]"}], ",", 
           RowBox[{"Join", "[", 
            RowBox[{"b", ",", "d"}], "]"}], ",", "2"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"bvar", "=", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", "b", "]"}], ",", "0"}], "]"}]}], ";", 
        RowBox[{"(*", 
         RowBox[{"Variables", " ", "in", " ", "b"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"cvar", "=", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", "c", "]"}], ",", "0"}], "]"}]}], ";", 
        RowBox[{"(*", 
         RowBox[{"Variables", " ", "in", " ", "c"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"zigzag", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"First", " ", "go", " ", "throgh", " ", "the", " ", "zig"}],
           "-", 
          RowBox[{
          "zags", " ", "starting", " ", "from", " ", "white", " ", "nodes", 
           " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"i", ".", "e", ".", " ", "starting"}], " ", "from", " ", 
             "fields", " ", "in", " ", "the", "  ", "matrix", " ", 
             "c"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"ci", "=", "1"}], ",", 
          RowBox[{"ci", "<", 
           RowBox[{
            RowBox[{"Length", "[", "c", "]"}], "+", "1"}]}], ",", 
          RowBox[{"ci", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"field", "=", 
            RowBox[{
             RowBox[{"DeleteCases", "[", 
              RowBox[{
               RowBox[{"c", "[", 
                RowBox[{"[", "ci", "]"}], "]"}], ",", "0"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            SubscriptBox["zig", "ci"], "=", "field"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"rowpos", "=", 
            RowBox[{
             RowBox[{"Length", "[", "a", "]"}], "+", "ci"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"While", "[", 
            RowBox[{"True", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"colpos", "=", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{
                  RowBox[{"K0full", "[", 
                   RowBox[{"[", "rowpos", "]"}], "]"}], ",", "field"}], "]"}],
                 "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
              RowBox[{"(*", 
               RowBox[{
               "colpos", " ", "is", " ", "the", " ", "column", " ", "number", 
                " ", "this", " ", "field", " ", "is", " ", "in"}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
               "Now", " ", "look", " ", "for", " ", "its", " ", "partner", 
                " ", "in", " ", "the", " ", "column"}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"column", "=", 
               RowBox[{"DeleteCases", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Transpose", "[", "K0full", "]"}], "[", 
                  RowBox[{"[", "colpos", "]"}], "]"}], ",", "0"}], "]"}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"j", "=", "1"}], ",", 
                RowBox[{"j", "<", 
                 RowBox[{
                  RowBox[{"Length", "[", "column", "]"}], "+", "1"}]}], ",", 
                RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"sub1", "[", 
                    RowBox[{"column", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}], "\[Equal]", 
                    RowBox[{"sub2", "[", "field", "]"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["zig", "ci"], "=", 
                    RowBox[{
                    SubscriptBox["zig", "ci"], "/", 
                    RowBox[{"column", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"field", "=", 
                    RowBox[{"column", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", 
                  "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"If", " ", 
                 RowBox[{"we", "'"}], "ve", " ", "ended", " ", "up", " ", 
                 "inside", " ", "c"}], ",", " ", 
                RowBox[{
                 RowBox[{
                 "this", " ", "is", " ", "the", " ", "end", " ", "of", " ", 
                  "the", " ", "zig"}], "-", "zag"}]}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"MemberQ", "[", 
                 RowBox[{"cvar", ",", "field"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{
                   RowBox[{"Subscript", "[", 
                    RowBox[{"\"\<zig\>\"", ",", "ci"}], "]"}], ",", 
                   "\"\< = \>\"", ",", 
                   SubscriptBox["zig", "ci"]}], "]"}], ";", 
                 RowBox[{"zigzag", "=", 
                  RowBox[{"Join", "[", 
                   RowBox[{"zigzag", ",", 
                    RowBox[{"{", 
                    SubscriptBox["zig", "ci"], "}"}]}], "]"}]}], ";", 
                 RowBox[{"Break", "[", "]"}]}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
               "Find", " ", "which", " ", "row", " ", "number", " ", "this", 
                " ", "new", " ", "field", " ", "has"}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"rowpos", "=", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Transpose", "[", "K0full", "]"}], "[", 
                   RowBox[{"[", "colpos", "]"}], "]"}], ",", "field"}], "]"}],
                 "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
               "Now", " ", "look", " ", "for", " ", "its", " ", "partner", 
                " ", "in", " ", "the", " ", "row"}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"row", "=", 
               RowBox[{"DeleteCases", "[", 
                RowBox[{
                 RowBox[{"K0full", "[", 
                  RowBox[{"[", "rowpos", "]"}], "]"}], ",", "0"}], "]"}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"j", "=", "1"}], ",", 
                RowBox[{"j", "<", 
                 RowBox[{
                  RowBox[{"Length", "[", "row", "]"}], "+", "1"}]}], ",", 
                RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"sub1", "[", 
                    RowBox[{"row", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}], "\[Equal]", 
                    RowBox[{"sub2", "[", "field", "]"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["zig", "ci"], "=", 
                    RowBox[{
                    SubscriptBox["zig", "ci"], 
                    RowBox[{"row", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"field", "=", 
                    RowBox[{"row", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", 
                  "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"If", " ", 
                 RowBox[{"we", "'"}], "ve", " ", "ended", " ", "up", " ", 
                 "inside", " ", "b"}], ",", " ", 
                RowBox[{
                 RowBox[{
                 "this", " ", "is", " ", "the", " ", "end", " ", "of", " ", 
                  "the", " ", "zig"}], "-", "zag"}]}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"MemberQ", "[", 
                 RowBox[{"bvar", ",", "field"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{
                   RowBox[{"Subscript", "[", 
                    RowBox[{"\"\<zig\>\"", ",", "ci"}], "]"}], ",", 
                   "\"\< = \>\"", ",", 
                   SubscriptBox["zig", "ci"]}], "]"}], ";", 
                 RowBox[{"zigzag", "=", 
                  RowBox[{"Join", "[", 
                   RowBox[{"zigzag", ",", 
                    RowBox[{"{", 
                    SubscriptBox["zig", "ci"], "}"}]}], "]"}]}], ";", 
                 RowBox[{"Break", "[", "]"}]}]}], "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Now", " ", "go", " ", "throgh", " ", "the", " ", "zig"}], 
          "-", 
          RowBox[{
          "zags", " ", "starting", " ", "from", " ", "black", " ", "nodes", 
           " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"i", ".", "e", ".", " ", "starting"}], " ", "from", " ", 
             "fields", " ", "in", " ", "the", "  ", "matrix", " ", 
             "b"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"bi", "=", "1"}], ",", 
          RowBox[{"bi", "<", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Transpose", "[", "b", "]"}], "]"}], "+", "1"}]}], ",", 
          RowBox[{"bi", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"field", "=", 
            RowBox[{
             RowBox[{"DeleteCases", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Transpose", "[", "b", "]"}], "[", 
                RowBox[{"[", "bi", "]"}], "]"}], ",", "0"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            SubscriptBox["zig", 
             RowBox[{
              RowBox[{"Length", "[", "c", "]"}], "+", "bi"}]], "=", 
            RowBox[{"1", "/", "field"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"colpos", "=", 
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"Transpose", "[", "a", "]"}], "]"}], "+", "bi"}]}], ";",
            "\[IndentingNewLine]", 
           RowBox[{"While", "[", 
            RowBox[{"True", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"rowpos", "=", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Transpose", "[", "K0full", "]"}], "[", 
                   RowBox[{"[", "colpos", "]"}], "]"}], ",", "field"}], "]"}],
                 "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
               "Now", " ", "look", " ", "for", " ", "its", " ", "partner", 
                " ", "in", " ", "the", " ", "row"}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"row", "=", 
               RowBox[{"DeleteCases", "[", 
                RowBox[{
                 RowBox[{"K0full", "[", 
                  RowBox[{"[", "rowpos", "]"}], "]"}], ",", "0"}], "]"}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"j", "=", "1"}], ",", 
                RowBox[{"j", "<", 
                 RowBox[{
                  RowBox[{"Length", "[", "row", "]"}], "+", "1"}]}], ",", 
                RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"sub1", "[", 
                    RowBox[{"row", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}], "\[Equal]", 
                    RowBox[{"sub2", "[", "field", "]"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["zig", 
                    RowBox[{
                    RowBox[{"Length", "[", "c", "]"}], "+", "bi"}]], "=", 
                    RowBox[{
                    SubscriptBox["zig", 
                    RowBox[{
                    RowBox[{"Length", "[", "c", "]"}], "+", "bi"}]], 
                    RowBox[{"row", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"field", "=", 
                    RowBox[{"row", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", 
                  "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"If", " ", 
                 RowBox[{"we", "'"}], "ve", " ", "ended", " ", "up", " ", 
                 "inside", " ", "b"}], ",", " ", 
                RowBox[{
                 RowBox[{
                 "this", " ", "is", " ", "the", " ", "end", " ", "of", " ", 
                  "the", " ", "zig"}], "-", "zag"}]}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"MemberQ", "[", 
                 RowBox[{"bvar", ",", "field"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{
                   RowBox[{"Subscript", "[", 
                    RowBox[{"\"\<zig\>\"", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "c", "]"}], "+", "bi"}]}], "]"}], 
                   ",", "\"\< = \>\"", ",", 
                   SubscriptBox["zig", 
                    RowBox[{
                    RowBox[{"Length", "[", "c", "]"}], "+", "bi"}]]}], "]"}], 
                 ";", 
                 RowBox[{"zigzag", "=", 
                  RowBox[{"Join", "[", 
                   RowBox[{"zigzag", ",", 
                    RowBox[{"{", 
                    SubscriptBox["zig", 
                    RowBox[{
                    RowBox[{"Length", "[", "c", "]"}], "+", "bi"}]], "}"}]}], 
                   "]"}]}], ";", 
                 RowBox[{"Break", "[", "]"}]}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
               "Find", " ", "out", " ", "which", " ", "column", " ", "number",
                 " ", "this", " ", "new", " ", "field", " ", "has"}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"colpos", "=", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{
                  RowBox[{"K0full", "[", 
                   RowBox[{"[", "rowpos", "]"}], "]"}], ",", "field"}], "]"}],
                 "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
               "Now", " ", "look", " ", "for", " ", "its", " ", "partner", 
                " ", "in", " ", "the", " ", "column"}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"column", "=", 
               RowBox[{"DeleteCases", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Transpose", "[", "K0full", "]"}], "[", 
                  RowBox[{"[", "colpos", "]"}], "]"}], ",", "0"}], "]"}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"j", "=", "1"}], ",", 
                RowBox[{"j", "<", 
                 RowBox[{
                  RowBox[{"Length", "[", "column", "]"}], "+", "1"}]}], ",", 
                RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"sub1", "[", 
                    RowBox[{"column", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}], "\[Equal]", 
                    RowBox[{"sub2", "[", "field", "]"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["zig", 
                    RowBox[{
                    RowBox[{"Length", "[", "c", "]"}], "+", "bi"}]], "=", 
                    RowBox[{
                    SubscriptBox["zig", 
                    RowBox[{
                    RowBox[{"Length", "[", "c", "]"}], "+", "bi"}]], "/", 
                    RowBox[{"column", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"field", "=", 
                    RowBox[{"column", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", 
                  "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"If", " ", 
                 RowBox[{"we", "'"}], "ve", " ", "ended", " ", "up", " ", 
                 "inside", " ", "c"}], ",", " ", 
                RowBox[{
                 RowBox[{
                 "this", " ", "is", " ", "the", " ", "end", " ", "of", " ", 
                  "the", " ", "zig"}], "-", "zag"}]}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"MemberQ", "[", 
                 RowBox[{"cvar", ",", "field"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{
                   RowBox[{"Subscript", "[", 
                    RowBox[{"\"\<zig\>\"", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "c", "]"}], "+", "bi"}]}], "]"}], 
                   ",", "\"\< = \>\"", ",", 
                   SubscriptBox["zig", 
                    RowBox[{
                    RowBox[{"Length", "[", "c", "]"}], "+", "bi"}]]}], "]"}], 
                 ";", 
                 RowBox[{"zigzag", "=", 
                  RowBox[{"Join", "[", 
                   RowBox[{"zigzag", ",", 
                    RowBox[{"{", 
                    SubscriptBox["zig", 
                    RowBox[{
                    RowBox[{"Length", "[", "c", "]"}], "+", "bi"}]], "}"}]}], 
                   "]"}]}], ";", 
                 RowBox[{"Break", "[", "]"}]}]}], "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"DONE", "!"}], " ", "NOW", " ", "CALLED", " ", "makeZigZags"}], 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Tells", " ", "you", " ", "which", " ", "two", " ", "perfect", " ", 
    "matchings", " ", "produce", " ", "a", " ", "given", " ", 
    RowBox[{"zigzag", ".", " ", "'"}], 
    RowBox[{"zigzag", "'"}], " ", "should", " ", "be", " ", "given", " ", 
    "as", " ", "the", " ", "product", " ", "and", " ", "division", " ", "of", 
    " ", 
    RowBox[{
     SubscriptBox["X", 
      RowBox[{"i", ",", "j"}]], "'"}], 
    RowBox[{"s", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"zigzagPerfMatchings", "[", "zigzag_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "i", ",", "ja", ",", "ia", ",", "ib", ",", "signs", ",", 
        "positiveplist"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"signs", "=", 
        RowBox[{"plist", "/.", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Xlist", "[", 
             RowBox[{"[", "ii", "]"}], "]"}], "\[Rule]", "1"}], ",", 
           RowBox[{"{", 
            RowBox[{"ii", ",", 
             RowBox[{"Length", "[", "Xlist", "]"}]}], "}"}]}], "]"}]}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"positiveplist", "=", 
        RowBox[{"plist", "*", "signs"}]}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{
        "Make", " ", "a", " ", "list", " ", "of", " ", "perfect", " ", 
         "matchings", " ", "all", " ", "with", " ", "positive", " ", "signs", 
         " ", 
         RowBox[{"(", 
          RowBox[{
          "Kasteleyn", " ", "sometimes", " ", "gives", " ", "negative", " ", 
           "signs"}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"ja", "=", "1"}], ",", 
         RowBox[{"ja", "<", 
          RowBox[{
           RowBox[{"Length", "[", "zigzag", "]"}], "+", "1"}]}], ",", 
         RowBox[{"ja", "++"}], ",", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Go", " ", "through", " ", "the", " ", "zig"}], "-", 
           "zags"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"ia", "=", "1"}], ",", 
            RowBox[{"ia", "<", 
             RowBox[{
              RowBox[{"Length", "[", "positiveplist", "]"}], "+", "1"}]}], 
            ",", 
            RowBox[{"ia", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"ib", "=", "1"}], ",", 
               RowBox[{"ib", "<", 
                RowBox[{
                 RowBox[{"Length", "[", "positiveplist", "]"}], "+", "1"}]}], 
               ",", 
               RowBox[{"ib", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"zigzag", "[", 
                    RowBox[{"[", "ja", "]"}], "]"}], "\[Equal]", 
                   RowBox[{
                    RowBox[{"positiveplist", "[", 
                    RowBox[{"[", "ia", "]"}], "]"}], "/", 
                    RowBox[{"positiveplist", "[", 
                    RowBox[{"[", "ib", "]"}], "]"}]}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<zig-zag \>\"", ",", "ja", ",", "\"\< = pm[[\>\"", 
                    ",", "ia", ",", "\"\<]]/pm[[\>\"", ",", "ib", ",", 
                    "\"\<]]\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", 
                 "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"DONE", "!"}], " ", "NOW", " ", "CALLED", " ", 
    "zigZagsAsPerfectMatchings"}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Checks", " ", "whether", " ", "the", " ", "inputed", " ", 
     "\"\<matroida\>\""}], "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "b", ",", "c", ",", ".."}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"d", ",", "e", ",", "f", ",", ".."}], "}"}], ",", "..."}], 
      "}"}], "is", " ", "indeed", " ", "a", " ", 
     RowBox[{"matroid", ".", " ", "Returns"}], " ", "True", " ", "or", " ", 
     "False"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"matroidcheck", "[", "matroida_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "matroid", ",", "win", ",", "i", ",", "j", ",", "pairscore", ",", "k", 
        ",", "el", ",", "trial", ",", "success", ",", "matr"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"matroid", "=", 
        RowBox[{"Map", "[", 
         RowBox[{"Sort", ",", "matroida"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"win", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", "matroid", "]"}], "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "<", 
             RowBox[{
              RowBox[{"Length", "[", "matroid", "]"}], "+", "1"}]}], ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"i", "\[NotEqual]", "j"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"pairscore", "=", "1"}], ";", "\[IndentingNewLine]", 
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"k", "=", "1"}], ",", 
                  RowBox[{"k", "<", 
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"matroid", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "+", "1"}]}], ",", 
                  RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"el", "=", "1"}], ",", 
                    RowBox[{"el", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"matroid", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}], "+", "1"}]}], ",", 
                    RowBox[{"el", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"trial", "=", 
                    RowBox[{"Sort", "[", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"Delete", "[", 
                    RowBox[{
                    RowBox[{"matroid", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "k"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"matroid", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "el"}], "]"}], "]"}], "}"}]}], "]"}], 
                    "]"}]}], ";", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Try", " ", "exchanging", " ", "with", " ", "each", " ", 
                    "element", " ", "of", " ", 
                    RowBox[{"J", "."}]}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"matroid", ",", "trial"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"success", "=", "1"}], ";", 
                    RowBox[{"Break", "[", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"success", "=", "0"}], ";"}]}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"success", "\[Equal]", "0"}], ",", 
                    RowBox[{
                    RowBox[{"pairscore", "=", "0"}], ";"}]}], "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"pairscore", "\[Equal]", "0"}], ",", 
               RowBox[{
                RowBox[{"win", "=", "0"}], ";"}]}], "]"}]}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"win", "\[Equal]", "1"}], ",", 
         RowBox[{"matr", "=", "True"}], ",", 
         RowBox[{"matr", "=", "False"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "matr"}]}], "\[IndentingNewLine]", "]"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"DONE", ",", " ", 
    RowBox[{"NOW", " ", "CALLED", " ", "matroidQ"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Does", " ", "the", " ", "same", " ", "as", " ", "matroidcheck"}],
     ",", " ", 
    RowBox[{
    "but", " ", "instead", " ", "or", " ", "returning", " ", "True", " ", 
     "or", " ", "False"}], ",", " ", 
    RowBox[{
    "it", " ", "prints", " ", "out", " ", "all", " ", "the", " ", 
     "failures"}], ",", " ", 
    RowBox[{"or", " ", "whether", " ", "you", " ", "have", " ", "a", " ", 
     RowBox[{"success", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"matroidcheckwrite", "[", "matroida_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "matroid", ",", "win", ",", "i", ",", "j", ",", "pairscore", ",", "k", 
        ",", "el", ",", "trial", ",", "success"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"matroid", "=", 
        RowBox[{"Map", "[", 
         RowBox[{"Sort", ",", "matroida"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"win", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", "matroid", "]"}], "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "<", 
             RowBox[{
              RowBox[{"Length", "[", "matroid", "]"}], "+", "1"}]}], ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"i", "\[NotEqual]", "j"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"pairscore", "=", "1"}], ";", "\[IndentingNewLine]", 
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"k", "=", "1"}], ",", 
                  RowBox[{"k", "<", 
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"matroid", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "+", "1"}]}], ",", 
                  RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"el", "=", "1"}], ",", 
                    RowBox[{"el", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"matroid", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}], "+", "1"}]}], ",", 
                    RowBox[{"el", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"trial", "=", 
                    RowBox[{"Sort", "[", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"Delete", "[", 
                    RowBox[{
                    RowBox[{"matroid", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "k"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"matroid", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "el"}], "]"}], "]"}], "}"}]}], "]"}], 
                    "]"}]}], ";", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Try", " ", "exchanging", " ", "with", " ", "each", " ", 
                    "element", " ", "of", " ", 
                    RowBox[{"J", "."}]}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"matroid", ",", "trial"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"success", "=", "1"}], ";", 
                    RowBox[{"Break", "[", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"success", "=", "0"}], ";"}]}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"success", "\[Equal]", "0"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"pairscore", "=", "0"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Print", "[", 
                    RowBox[{"\"\<Failed! This is I=\>\"", ",", 
                    RowBox[{"matroid", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\"\< and J=\>\"", 
                    ",", 
                    RowBox[{"matroid", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", "\"\< where \>\"", 
                    ",", 
                    RowBox[{"matroid", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "k"}], "]"}], "]"}], ",", 
                    "\"\<\[Element]I cannot be exchanged with anyone in \
J\>\""}], "]"}], ";"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
                ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"pairscore", "\[Equal]", "0"}], ",", 
               RowBox[{
                RowBox[{"win", "=", "0"}], ";"}]}], "]"}]}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"win", "\[Equal]", "1"}], ",", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<It is a matroid!\>\"", "]"}], ";"}]}], 
        "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"DONE", ",", " ", 
    RowBox[{"NOW", " ", "CALLED", " ", "matroidViolationCheck"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Finds", " ", "all", " ", "Plucker", " ", "relations", " ", "for", " ", 
    "the", " ", "Pluckers", " ", "of", " ", "Gr", 
    RowBox[{"(", 
     RowBox[{"k", ",", "n"}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"pluckerRelations", "[", 
     RowBox[{"k_", ",", "n_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "aa", ",", "bb", ",", "conditions", ",", "\[CapitalDelta]", ",", "i", 
        ",", "j", ",", "relations", ",", "todel", ",", "ii", ",", "jj"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"bb", "=", 
        RowBox[{"Subsets", "[", 
         RowBox[{
          RowBox[{"Range", "[", "n", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", "-", "1"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"aa", "=", 
        RowBox[{"Subsets", "[", 
         RowBox[{
          RowBox[{"Range", "[", "n", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", "+", "1"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"relations", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"conditions", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Rule", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"MapThread", "[", 
             RowBox[{"Subscript", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"ConstantArray", "[", 
                 RowBox[{"\[CapitalDelta]", ",", 
                  RowBox[{"Length", "[", "bb", "]"}]}], "]"}], ",", "bb"}], 
               "}"}]}], "]"}], ",", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"0", ",", 
              RowBox[{"Length", "[", "bb", "]"}]}], "]"}]}], "}"}]}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", "bb", "]"}], "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "<", 
             RowBox[{
              RowBox[{"Length", "[", "aa", "]"}], "+", "1"}]}], ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"relations", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"relations", ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], 
                    RowBox[{"dum", "-", "1"}]], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], 
                    RowBox[{
                    RowBox[{"PermutationOrder", "[", 
                    RowBox[{"Ordering", "[", 
                    RowBox[{"DeleteDuplicates", "[", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"bb", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"aa", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "dum"}], "]"}], "]"}], "}"}]}], "]"}], 
                    "]"}], "]"}], "]"}], "-", "1"}]], 
                    SubscriptBox["\[CapitalDelta]", 
                    RowBox[{"Union", "[", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"bb", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"aa", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "dum"}], "]"}], "]"}], "}"}]}], "]"}], 
                    "]"}]], 
                    SubscriptBox["\[CapitalDelta]", 
                    RowBox[{"Complement", "[", 
                    RowBox[{
                    RowBox[{"aa", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"aa", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "dum"}], "]"}], "]"}], "}"}]}], 
                    "]"}]]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"dum", ",", 
                    RowBox[{"k", "+", "1"}]}], "}"}]}], "]"}], "\[Equal]", 
                   "0"}], "}"}], "/.", "conditions"}]}], "]"}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"relations", "=", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{"relations", ",", "True"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<We have \>\"", ",", 
           RowBox[{"Length", "[", "relations", "]"}], ",", 
           "\"\< Plucker relations:\>\""}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"relations", "//", "MatrixForm"}], "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Remove", " ", "the", " ", "ones", " ", "that", " ", "are", " ", 
         "duplicate", " ", "up", " ", "to", " ", "a", " ", "minus", " ", 
         "sign"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"todel", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"ii", "=", "1"}], ",", 
         RowBox[{"ii", "<", 
          RowBox[{
           RowBox[{"Length", "[", "relations", "]"}], "+", "1"}]}], ",", 
         RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"jj", "=", 
             RowBox[{"ii", "+", "1"}]}], ",", 
            RowBox[{"jj", "<", 
             RowBox[{
              RowBox[{"Length", "[", "relations", "]"}], "+", "1"}]}], ",", 
            RowBox[{"jj", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"relations", "[", 
                  RowBox[{"[", "ii", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
                RowBox[{"-", 
                 RowBox[{
                  RowBox[{"relations", "[", 
                   RowBox[{"[", "jj", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"todel", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{"todel", ",", 
                   RowBox[{"{", 
                    RowBox[{"{", "ii", "}"}], "}"}]}], "]"}]}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"relations", "=", 
        RowBox[{"Delete", "[", 
         RowBox[{"relations", ",", "todel"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "relations"}]}], "\[IndentingNewLine]", "]"}]}],
    "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"DONE", ",", " ", 
    RowBox[{"SAME", " ", "NAME"}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Gives", " ", "you", " ", "the", " ", "replacement", " ", "list", " ", 
    "for", " ", "perfect", " ", "matching", " ", "going", " ", "to", " ", 
    "their", " ", "source", " ", 
    RowBox[{"set", ".", " ", "You"}], " ", "need", " ", "to", " ", "run", " ",
     "moduliGaugingX", " ", 
    RowBox[{"first", ".", " ", "The"}], " ", "ordering", " ", "is", " ", 
    "given", " ", "in", " ", "the", " ", "form", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"2", ",", "3"}]], "\[Rule]", "1"}], ",", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"4", ",", "5"}]], "\[Rule]", "3"}], ",", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"2", ",", "5"}]], "\[Rule]", "4"}], ",", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"4", ",", "3"}]], "\[Rule]", "2"}]}], "}"}], "."}]}], "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"pmsourcesOrderingByHand", "[", 
     RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_", ",", "ordering_"}], "]"}],
     ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "flatb", ",", "flatc", ",", "toplu", ",", "pflow", ",", "k", ",", "j", 
        ",", "guys", ",", "i"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"ordering", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Rule", ",", 
           RowBox[{"{", 
            RowBox[{"xb", ",", 
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", "xb", "]"}], "]"}]}], "}"}]}], "]"}]}], 
        ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"ordering", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"2", ",", "3"}]], "\[Rule]", "1"}], ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"4", ",", "5"}]], "\[Rule]", "3"}], ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"2", ",", "5"}]], "\[Rule]", "4"}], ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"4", ",", "3"}]], "\[Rule]", "2"}]}], "}"}]}], ";"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"flatb", "=", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", "b", "]"}], ",", "0"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"flatc", "=", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", "c", "]"}], ",", "0"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"toplu", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "<", 
          RowBox[{
           RowBox[{"Length", "[", "plist", "]"}], "+", "1"}]}], ",", 
         RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           SubscriptBox["pflow", "j"], "=", 
           RowBox[{"{", "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"k", "=", "1"}], ",", 
         RowBox[{"k", "<", 
          RowBox[{
           RowBox[{"Length", "[", "xb", "]"}], "+", "1"}]}], ",", 
         RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"flatb", ",", 
              RowBox[{"xb", "[", 
               RowBox[{"[", "k", "]"}], "]"}]}], "]"}], ",", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Gli", " ", "Uni", " ", "sono", " ", "sorgent"}], ",", 
              " ", 
              RowBox[{
              "se", " ", "no", " ", "gli", " ", "zero", " ", "sono", " ", 
               "sorgenti"}]}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"guys", "=", 
              RowBox[{
               RowBox[{"Transpose", "[", 
                RowBox[{"Position", "[", 
                 RowBox[{
                  RowBox[{"P", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{"Xlist", ",", 
                    RowBox[{"xb", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "]"}], ",", 
                  "1"}], "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"i", "=", "1"}], ",", 
               RowBox[{"i", "<", 
                RowBox[{
                 RowBox[{"Length", "[", "guys", "]"}], "+", "1"}]}], ",", 
               RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 SubscriptBox["pflow", 
                  RowBox[{"guys", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]], "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{
                   SubscriptBox["pflow", 
                    RowBox[{"guys", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]], ",", 
                   RowBox[{"{", 
                    RowBox[{"xb", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "}"}]}], "]"}]}], ";"}]}],
               "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"flatc", ",", 
              RowBox[{"xb", "[", 
               RowBox[{"[", "k", "]"}], "]"}]}], "]"}], ",", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Gli", " ", "Uni", " ", "sono", " ", "sorgent"}], ",", 
              " ", 
              RowBox[{
              "se", " ", "no", " ", "gli", " ", "zero", " ", "sono", " ", 
               "sorgenti"}]}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"guys", "=", 
              RowBox[{
               RowBox[{"Transpose", "[", 
                RowBox[{"Position", "[", 
                 RowBox[{
                  RowBox[{"P", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{"Xlist", ",", 
                    RowBox[{"xb", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "]"}], ",", 
                  "0"}], "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"i", "=", "1"}], ",", 
               RowBox[{"i", "<", 
                RowBox[{
                 RowBox[{"Length", "[", "guys", "]"}], "+", "1"}]}], ",", 
               RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 SubscriptBox["pflow", 
                  RowBox[{"guys", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]], "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{
                   SubscriptBox["pflow", 
                    RowBox[{"guys", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]], ",", 
                   RowBox[{"{", 
                    RowBox[{"xb", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "}"}]}], "]"}]}], ";"}]}],
               "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "<", 
          RowBox[{
           RowBox[{"Length", "[", "plist", "]"}], "+", "1"}]}], ",", 
         RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           SubscriptBox["pflow", "j"], "=", 
           RowBox[{"Sort", "[", 
            RowBox[{
             SubscriptBox["pflow", "j"], "/.", "ordering"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"toplu", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"toplu", ",", 
             RowBox[{"{", 
              RowBox[{"j", "\[Rule]", 
               SubscriptBox["pflow", "j"]}], "}"}]}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "toplu"}]}],
      "\[IndentingNewLine]", "]"}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"SKIPPED", ",", " ", 
    RowBox[{"NOT", " ", "USEFUL"}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Gives", " ", "you", " ", "the", " ", "path", " ", "matrix", " ", "of", 
    " ", "a", " ", 
    RowBox[{"BFT", ".", " ", "You"}], " ", "have", " ", "to", " ", "first", 
    " ", "run", " ", 
    RowBox[{"moduliGaugingX", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"pathmatrix", "[", 
     RowBox[{
     "a_", ",", "b_", ",", "c_", ",", "d_", ",", "pmref_", ",", "order_"}], 
     "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "kast", ",", "sources", ",", "cond", ",", "i", ",", "j", ",", 
        "kastduo", ",", "cond3", ",", "kasttrio", ",", "bigguy", ",", "inv"}],
        "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"kast", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{"a", ",", "c"}], "]"}], ",", 
          RowBox[{"Join", "[", 
           RowBox[{"b", ",", "d"}], "]"}], ",", "2"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"sources", "=", 
        RowBox[{"findSources", "[", 
         RowBox[{
         "a", ",", "b", ",", "c", ",", "d", ",", "order", ",", "pmref"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"cond", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"Variables", "[", "pmref", "]"}], "]"}], "+", "1"}]}], 
         ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"cond", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"cond", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"Variables", "[", "pmref", "]"}], "[", 
                RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", "0"}], "}"}]}], 
            "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"kastduo", "=", 
        RowBox[{"kast", "/.", "cond"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"cond3", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", "Xlist", "]"}], "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"FreeQ", "[", 
             RowBox[{
              RowBox[{"Variables", "[", "pmref", "]"}], ",", 
              RowBox[{"Xlist", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"cond3", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"cond3", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Xlist", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", "0"}], "}"}]}], 
               "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
            RowBox[{
             RowBox[{"cond3", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"cond3", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Xlist", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
                  RowBox[{"1", "/", 
                   RowBox[{"Xlist", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}]}], "]"}]}], 
             ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"kasttrio", "=", 
        RowBox[{"kast", "/.", "cond3"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"bigguy", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"IdentityMatrix", "[", 
             RowBox[{
              RowBox[{"Length", "[", "a", "]"}], "+", 
              RowBox[{"Length", "[", "c", "]"}]}], "]"}], ",", 
            RowBox[{"-", 
             RowBox[{"Transpose", "[", "kasttrio", "]"}]}]}], "]"}], ",", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"-", "kastduo"}], ",", 
            RowBox[{"IdentityMatrix", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Dimensions", "[", "a", "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", 
              RowBox[{
               RowBox[{"Dimensions", "[", "b", "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}], ",", "2"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"bigguy", "//", "MatrixForm"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"inv", "=", 
        RowBox[{"Inverse", "[", "bigguy", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"inv", "//", "MatrixForm"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"pathmat", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{"Length", "[", "sources", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", 
            RowBox[{"Length", "[", "order", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", "sources", "]"}], "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"j", "=", "1"}], ",", 
           RowBox[{"j", "<", 
            RowBox[{
             RowBox[{"Length", "[", "order", "]"}], "+", "1"}]}], ",", 
           RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"pathmat", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
             RowBox[{"inv", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"sources", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", 
                RowBox[{"order", "[", 
                 RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "]"}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pathmat", "=", 
        RowBox[{"Expand", "[", 
         RowBox[{"Simplify", "[", "pathmat", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"fullmatrix", "=", "inv"}], ";", "\[IndentingNewLine]", 
       RowBox[{"loops", "=", 
        RowBox[{"Expand", "[", 
         RowBox[{"Det", "[", "bigguy", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", 
        "\"\<The full path matrix is 'fullmatrix', the part that goes from \
sources to sinks is 'pathmat', the loop denominator is 'loops'.\>\"", 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"DONE", ",", " ", 
    RowBox[{"NOW", " ", "CALLED", " ", "pathMatrix"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Order", " ", "should", " ", "be", " ", 
     RowBox[{"e", ".", "g", ".", " ", 
      RowBox[{"{", 
       RowBox[{"7", ",", "12", ",", "6", ",", "4", ",", "5"}], "}"}], ".", 
      " ", "The"}], " ", "function", " ", "will", " ", "return", " ", "the", 
     " ", "sources"}], ",", " ", 
    RowBox[{"e", ".", "g", ".", " ", 
     RowBox[{"{", 
      RowBox[{"12", ",", "6", ",", "5"}], "}"}], "."}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"findSources", "[", 
     RowBox[{
     "a_", ",", "b_", ",", "c_", ",", "d_", ",", "order_", ",", "pmref_"}], 
     "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "darul", ",", "invrul", ",", "btra", ",", "xtonode", ",", "i", ",", 
        "sources"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"darul", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Rule", ",", 
          RowBox[{"{", 
           RowBox[{"order", ",", 
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "order", "]"}], "]"}]}], "}"}]}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"invrul", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Rule", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "order", "]"}], "]"}], ",", "order"}], 
           "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Now", " ", "translate", " ", "fields", " ", "into", " ", "node", " ",
          "numbers"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"btra", "=", 
        RowBox[{"Transpose", "[", "b", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"xtonode", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", "c", "]"}], "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"xtonode", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"xtonode", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"DeleteCases", "[", 
                 RowBox[{
                  RowBox[{"c", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", "0"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"i", "+", 
                 RowBox[{"Length", "[", "a", "]"}]}], ")"}]}], "}"}]}], 
            "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "<", 
          RowBox[{
           RowBox[{"Length", "[", "btra", "]"}], "+", "1"}]}], ",", 
         RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"xtonode", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"xtonode", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"DeleteCases", "[", 
                 RowBox[{
                  RowBox[{"btra", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], ",", "0"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"j", "+", 
                 RowBox[{"Length", "[", "a", "]"}], "+", 
                 RowBox[{"Length", "[", "c", "]"}], "+", 
                 RowBox[{
                  RowBox[{"Dimensions", "[", "a", "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}], "}"}]}], "]"}]}],
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"sources", "=", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Complement", "[", 
            RowBox[{
             RowBox[{"DeleteCases", "[", 
              RowBox[{
               RowBox[{"Flatten", "[", "c", "]"}], ",", "0"}], "]"}], ",", 
             RowBox[{"Intersection", "[", 
              RowBox[{
               RowBox[{"DeleteCases", "[", 
                RowBox[{
                 RowBox[{"Flatten", "[", "c", "]"}], ",", "0"}], "]"}], ",", 
               RowBox[{"Variables", "[", "pmref", "]"}]}], "]"}]}], "]"}], 
           ",", 
           RowBox[{"Intersection", "[", 
            RowBox[{
             RowBox[{"DeleteCases", "[", 
              RowBox[{
               RowBox[{"Flatten", "[", "b", "]"}], ",", "0"}], "]"}], ",", 
             RowBox[{"Variables", "[", "pmref", "]"}]}], "]"}]}], "]"}], "/.",
          "xtonode"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"sources", "=", 
        RowBox[{
         RowBox[{"Sort", "[", 
          RowBox[{"sources", "/.", "darul"}], "]"}], "/.", "invrul"}]}], ";", 
       "\[IndentingNewLine]", "sources"}]}], "\[IndentingNewLine]", "]"}]}], 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"DONE", ",", " ", 
    RowBox[{
    "SAME", " ", "NAME", " ", "BUT", " ", "USES", " ", "DIFFERENT", " ", 
     "INPUT", " ", "AND", " ", "OUTPUT"}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Order", " ", "should", " ", "be", " ", 
     RowBox[{"e", ".", "g", ".", " ", 
      RowBox[{"{", 
       RowBox[{"7", ",", "12", ",", "6", ",", "4", ",", "5"}], "}"}], ".", 
      " ", "The"}], " ", "function", " ", "will", " ", "return", " ", "the", 
     " ", "sinks"}], ",", " ", 
    RowBox[{"e", ".", "g", ".", " ", 
     RowBox[{"{", 
      RowBox[{"7", ",", "4"}], "}"}], "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"findSinks", "[", 
     RowBox[{
     "a_", ",", "b_", ",", "c_", ",", "d_", ",", "order_", ",", "pmref_"}], 
     "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "darul", ",", "invrul", ",", "btra", ",", "xtonode", ",", "i", ",", 
        "sinks"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"darul", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Rule", ",", 
          RowBox[{"{", 
           RowBox[{"order", ",", 
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "order", "]"}], "]"}]}], "}"}]}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"invrul", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Rule", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "order", "]"}], "]"}], ",", "order"}], 
           "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Now", " ", "translate", " ", "fields", " ", "into", " ", "node", " ",
          "numbers"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"btra", "=", 
        RowBox[{"Transpose", "[", "b", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"xtonode", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", "c", "]"}], "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"xtonode", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"xtonode", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"DeleteCases", "[", 
                 RowBox[{
                  RowBox[{"c", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", "0"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"i", "+", 
                 RowBox[{"Length", "[", "a", "]"}]}], ")"}]}], "}"}]}], 
            "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "<", 
          RowBox[{
           RowBox[{"Length", "[", "btra", "]"}], "+", "1"}]}], ",", 
         RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"xtonode", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"xtonode", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"DeleteCases", "[", 
                 RowBox[{
                  RowBox[{"btra", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], ",", "0"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"j", "+", 
                 RowBox[{"Length", "[", "a", "]"}], "+", 
                 RowBox[{"Length", "[", "c", "]"}], "+", 
                 RowBox[{
                  RowBox[{"Dimensions", "[", "a", "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}], "}"}]}], "]"}]}],
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"sinks", "=", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Intersection", "[", 
            RowBox[{
             RowBox[{"DeleteCases", "[", 
              RowBox[{
               RowBox[{"Flatten", "[", "c", "]"}], ",", "0"}], "]"}], ",", 
             RowBox[{"Variables", "[", "pmref", "]"}]}], "]"}], ",", 
           RowBox[{"Complement", "[", 
            RowBox[{
             RowBox[{"DeleteCases", "[", 
              RowBox[{
               RowBox[{"Flatten", "[", "b", "]"}], ",", "0"}], "]"}], ",", 
             RowBox[{"Intersection", "[", 
              RowBox[{
               RowBox[{"DeleteCases", "[", 
                RowBox[{
                 RowBox[{"Flatten", "[", "b", "]"}], ",", "0"}], "]"}], ",", 
               RowBox[{"Variables", "[", "pmref", "]"}]}], "]"}]}], "]"}]}], 
          "]"}], "/.", "xtonode"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"sinks", "=", 
        RowBox[{
         RowBox[{"Sort", "[", 
          RowBox[{"sinks", "/.", "darul"}], "]"}], "/.", "invrul"}]}], ";", 
       "\[IndentingNewLine]", "sinks"}]}], "\[IndentingNewLine]", "]"}]}], 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"DONE", ",", " ", 
    RowBox[{
    "SAME", " ", "NAME", " ", "BUT", " ", "USES", " ", "DIFFERENT", " ", 
     "INPUT", " ", "AND", " ", "OUTPUT"}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Need", " ", "to", " ", "first", " ", "run", " ", 
      RowBox[{
       RowBox[{"moduliGaugingX", "[", 
        RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], ".", " ", "It"}], 
      " ", "works", " ", "only", " ", "GENUS", " ", "0", " ", 
      RowBox[{"embeddings", "!"}], " ", 
      RowBox[{"E", ".", "g", ".", " ", "pmref"}]}], "=", 
     RowBox[{"plist", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
    RowBox[{"order", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "9", ",", "10", ",", "7", ",", "8", ",", "11", ",", "19", ",", "6"}], 
       "}"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
        "assumes", " ", "you", " ", "first", " ", "label", " ", "all", " ", 
         "the", " ", "internal", " ", "white", " ", "nodes"}], ",", " ", 
        RowBox[{
        "then", " ", "all", " ", "external", " ", "white", " ", "nodes"}], 
        ",", " ", 
        RowBox[{"then", " ", "internal", " ", "black", " ", "nodes"}], ",", 
        " ", 
        RowBox[{"then", " ", "external", " ", "black", " ", "nodes"}]}], 
       ")"}]}]}], ",", " ", 
    RowBox[{"cuts", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          SubscriptBox["X", 
           RowBox[{"7", ",", "2"}]], "\[Rule]", 
          RowBox[{"-", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "2"}]]}]}], ",", 
         RowBox[{
          SubscriptBox["X", 
           RowBox[{"2", ",", "9"}]], "\[Rule]", 
          RowBox[{"-", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "9"}]]}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["X", 
          RowBox[{"4", ",", "10"}]], "\[Rule]", 
         RowBox[{"-", 
          SubscriptBox["X", 
           RowBox[{"4", ",", "10"}]]}]}], "}"}]}], "}"}]}], ",", " ", 
    RowBox[{"boundaries", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"9", ",", "10", ",", "11"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"7", ",", "8"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"19", ",", "6"}], "}"}]}], "}"}]}], ",", " ", 
    RowBox[{"boundarycuts", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}], "\[Rule]", 
        RowBox[{"cuts", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"2", ",", "3"}], "}"}], "\[Rule]", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"cuts", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"cuts", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "3"}], "}"}], "\[Rule]", 
        RowBox[{"cuts", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"kastToGrass", "[", 
     RowBox[{
     "a_", ",", "b_", ",", "c_", ",", "d_", ",", "pmref_", ",", "order_", ",",
       "boundaries_", ",", "boundarycuts_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "sources", ",", "sinks", ",", "therule", ",", "inverserule", ",", 
        "repl", ",", "newnumberrule", ",", "newsource", ",", "looprep", ",", 
        "invlooprep", ",", "loopflip", ",", "looplist", ",", "dummy", ",", 
        "i", ",", "l", ",", "loop", ",", "j", ",", "count", ",", "k", ",", 
        "terms", ",", "postnikovpathloop", ",", "numtoorder", ",", 
        "postgekhtmatrixloop", ",", "bguys", ",", "tempmat", ",", "pmloops", 
        ",", "kmat", ",", "btra", ",", "xtonum", ",", "xorder", ",", 
        "ordering", ",", "subs", ",", "compare", ",", "guys", ",", "compa", 
        ",", "change"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"pathmatrix", "[", 
        RowBox[{
        "a", ",", "b", ",", "c", ",", "d", ",", "pmref", ",", "order"}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", "\"\<This is the path matrix 'pathmat':\>\"", "]"}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"pathmat", "//", "MatrixForm"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"sources", "=", 
        RowBox[{"findSources", "[", 
         RowBox[{
         "a", ",", "b", ",", "c", ",", "d", ",", "order", ",", "pmref"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"sinks", "=", 
        RowBox[{"findSinks", "[", 
         RowBox[{
         "a", ",", "b", ",", "c", ",", "d", ",", "order", ",", "pmref"}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Now", " ", "make", " ", "it", " ", "nicer", " ", "and", " ", "plug", 
         " ", "in", " ", 
         RowBox[{"Postnikov", "'"}], "s", " ", "signs"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"First", " ", "make", " ", "the", " ", "replacement", " ", 
         RowBox[{"lists", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"therule", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Rule", ",", 
          RowBox[{"{", 
           RowBox[{"plist", ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              SubscriptBox["pp", "i"], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Length", "[", "plist", "]"}]}], "}"}]}], "]"}]}], 
           "}"}]}], "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "To", " ", "recognize", " ", "stuff", " ", "as", " ", "perfect", " ", 
         "matchings"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"inverserule", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Rule", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              SubscriptBox["pp", "i"], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Length", "[", "plist", "]"}]}], "}"}]}], "]"}], ",", 
            RowBox[{"plist", "/", "pmref"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"repl", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Rule", ",", 
          RowBox[{"{", 
           RowBox[{"Xlist", ",", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"1", ",", 
              RowBox[{"Length", "[", "Xlist", "]"}]}], "]"}]}], "}"}]}], 
         "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "This", " ", "is", " ", "needed", " ", "to", " ", "get", " ", "the", 
         " ", "signs", " ", "right"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"This", " ", "is", " ", "for", " ", 
         RowBox[{"Postnikov", "'"}], "s", " ", "signs"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"newnumberrule", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Rule", ",", 
          RowBox[{"{", 
           RowBox[{"order", ",", 
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "order", "]"}], "]"}]}], "}"}]}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"newsource", "=", 
        RowBox[{"sources", "/.", "newnumberrule"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Make", " ", "the", " ", "rule", " ", "for", " ", "the", " ", 
         "replacement", " ", "of", " ", "loops", " ", "with", " ", 
         "variables", " ", 
         SubscriptBox["loop", "i"]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"looprep", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"invlooprep", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"loopflip", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"looplist", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Times", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"MonomialList", "[", 
                RowBox[{"Expand", "[", 
                 RowBox[{"loops", " ", "pmref"}], "]"}], "]"}], "/", 
               "pmref"}], ")"}], "/.", "repl"}], ",", 
            RowBox[{
             RowBox[{"MonomialList", "[", 
              RowBox[{"Expand", "[", 
               RowBox[{"loops", " ", "pmref"}], "]"}], "]"}], "/", 
             "pmref"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dummy", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", "looplist", "]"}], "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"looplist", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "1"}], ",", "True", 
            ",", "True", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              SubscriptBox["l", "dummy"], "=", 
              RowBox[{"looplist", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"looprep", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"looprep", ",", 
                RowBox[{"{", 
                 RowBox[{
                  SubscriptBox["l", "dummy"], "\[Rule]", 
                  SubscriptBox["loop", "dummy"]}], "}"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"invlooprep", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"invlooprep", ",", 
                RowBox[{"{", 
                 RowBox[{
                  SubscriptBox["loop", "dummy"], "\[Rule]", 
                  SubscriptBox["l", "dummy"]}], "}"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"loopflip", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"loopflip", ",", 
                RowBox[{"{", 
                 RowBox[{
                  SubscriptBox["loop", "dummy"], "\[Rule]", 
                  RowBox[{"-", 
                   SubscriptBox["loop", "dummy"]}]}], "}"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"dummy", "=", 
              RowBox[{"dummy", "+", "1"}]}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"postnikovpath", "=", "pathmat"}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "this", " ", "will", " ", "be", " ", "the", " ", "path", " ", 
         "matrix", " ", "with", " ", 
         RowBox[{"postnikov", "'"}], "s", " ", "signs", " ", "incorporated"}],
         "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", "sources", "]"}], "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", 
         RowBox[{"(*", 
          RowBox[{"Rows", " ", "of", " ", "the", " ", "sign", " ", "matrix"}],
           "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "<", 
             RowBox[{
              RowBox[{"Length", "[", "order", "]"}], "+", "1"}]}], ",", 
            RowBox[{"j", "++"}], ",", 
            RowBox[{"(*", 
             RowBox[{
             "Columns", " ", "of", " ", "the", " ", "sign", " ", "matrix"}], 
             "*)"}], "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"This", " ", "is", " ", "to", " ", "get", " ", 
              RowBox[{"Postnikov", "'"}], "s", " ", "signs"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"count", "=", "0"}], ";", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"k", "=", "1"}], ",", 
               RowBox[{"k", "<", 
                RowBox[{
                 RowBox[{"Length", "[", "sources", "]"}], "+", "1"}]}], ",", 
               RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"newsource", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "j"}], "]"}], "<", 
                    RowBox[{"newsource", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "&&", 
                   RowBox[{
                    RowBox[{"newsource", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "<", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"newsource", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "j"}], "]"}]}]}], 
                  ",", 
                  RowBox[{
                   RowBox[{"count", "=", 
                    RowBox[{"count", "+", "1"}]}], ";"}]}], "]"}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{
               "This", " ", "is", " ", "to", " ", "make", " ", "it", " ", 
                "look", " ", "nice"}], ",", " ", 
               RowBox[{
               "and", " ", "plug", " ", "in", " ", "the", " ", "overall", " ", 
                RowBox[{"signs", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"pathmat", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j"}], "]"}], "]"}], "\[Equal]", "1"}], "||", 
                RowBox[{
                 RowBox[{"pathmat", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j"}], "]"}], "]"}], "\[Equal]", "0"}]}],
                ",", "True", ",", "True", ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Denominator", "[", 
                    RowBox[{"pathmat", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], "\[Equal]", 
                   "1"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{"we", " ", "have", " ", "multiple", " ", "terms"}],
                    "*)"}], "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"terms", "=", 
                    RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
                   RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"k", "=", "1"}], ",", 
                    RowBox[{"k", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"pathmat", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], "+", 
                    "1"}]}], ",", 
                    RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"MonomialList", "[", 
                    RowBox[{"Denominator", "[", 
                    RowBox[{
                    RowBox[{"pathmat", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "]"}], "]"}], "]"}], ">", 
                    "1"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"If", " ", "we", " ", "have", " ", "loops"}], 
                    "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"terms", "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{"terms", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Expand", "[", 
                    RowBox[{"Simplify", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"pathmat", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "loops"}], "]"}], "]"}], 
                    "/", "loops"}], "}"}]}], "]"}]}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"terms", "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{"terms", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"pathmat", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "}"}]}], "]"}]}], ";"}]}], 
                    RowBox[{"(*", 
                    RowBox[{"If", " ", "we", " ", 
                    RowBox[{"don", "'"}], "t", " ", "have", " ", "loops"}], 
                    "*)"}], "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"postnikovpath", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Total", "[", "terms", "]"}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], "count"]}]}], ";"}], 
                  "\[IndentingNewLine]", ",", "True", ",", 
                  RowBox[{"(*", 
                   RowBox[{
                   "we", " ", "have", " ", "only", " ", "one", " ", "term"}], 
                   "*)"}], "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"MonomialList", "[", 
                    RowBox[{"Denominator", "[", 
                    RowBox[{"pathmat", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], "]"}], 
                    "]"}], ">", "1"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "If", " ", "the", " ", "term", " ", "has", " ", "loops"}],
                     "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"postnikovpath", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], "count"], 
                    RowBox[{
                    RowBox[{"Expand", "[", 
                    RowBox[{"Simplify", "[", 
                    RowBox[{
                    RowBox[{"pathmat", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "loops"}], "]"}], 
                    "]"}], "/", "loops"}]}]}], ";"}], "\[IndentingNewLine]", 
                    ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"postnikovpath", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], "count"], 
                    RowBox[{"pathmat", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";"}]}], "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Done", " ", "looking", " ", "nice"}], ",", " ", 
             RowBox[{"and", " ", "overall", " ", 
              RowBox[{"signs", "!"}]}]}], "*)"}], "\[IndentingNewLine]", 
           "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"postnikovpathloop", "=", "postnikovpath"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Now", " ", "replace", " ", "loops", " ", "in", " ", 
         "postnikovpathloop", " ", "with", " ", 
         SubscriptBox["loop", "i"], " ", "variables"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"change", "=", "1"}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "Keeps", " ", "track", " ", "of", " ", "whether", " ", 
         "postnikovpathloop", " ", "changed", " ", "when", " ", "we", " ", 
         "gave", " ", "it", " ", "loopreplacements"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"compa", "=", "postnikovpathloop"}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "This", " ", "is", " ", "what", " ", "we", " ", "compare", " ", 
         "with"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{"change", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"postnikovpathloop", "=", 
           RowBox[{"postnikovpathloop", "/.", "looprep"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"compa", "\[Equal]", "postnikovpathloop"}], ",", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{
              "if", " ", "putting", " ", "in", " ", "loop", " ", 
               "replacement", " ", "changed", " ", "nothing"}], ",", " ", 
              RowBox[{
               RowBox[{"we", "'"}], "ve", " ", "replaced", " ", "all", " ", 
               "the", " ", "loops", " ", "that", " ", "can", " ", "be", " ", 
               "replaced"}]}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"change", "=", "0"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"compa", "=", "postnikovpathloop"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"postnikovpathloop", "=", 
        RowBox[{"postnikovpathloop", "/.", "loopflip"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"postnikovpath", "=", 
        RowBox[{"postnikovpathloop", "/.", "invlooprep"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", 
        "\"\<Path matrix with Postnikov's overall signs, and signs for loops \
'postnikovpath':\>\"", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"postnikovpath", "//", "MatrixForm"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"postnikovpathloop", "//", "MatrixForm"}], "]"}], ";"}], 
        "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Now", " ", "plug", "  ", "in", " ", 
         RowBox[{"Gekhtman", "'"}], "s", " ", "signs"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"numtoorder", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Rule", ",", 
          RowBox[{"{", 
           RowBox[{"order", ",", 
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "order", "]"}], "]"}]}], "}"}]}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"postgekhtmatrixloop", "=", "postnikovpathloop"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", "sources", "]"}], "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", 
         RowBox[{"(*", 
          RowBox[{"Rows", " ", "of", " ", "the", " ", "matrix"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "<", 
             RowBox[{
              RowBox[{"Length", "[", "order", "]"}], "+", "1"}]}], ",", 
            RowBox[{"j", "++"}], ",", 
            RowBox[{"(*", 
             RowBox[{"Columns", " ", "of", " ", "the", " ", "matrix"}], 
             "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"postnikovpathloop", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j"}], "]"}], "]"}], "\[Equal]", "1"}], "||", 
                RowBox[{
                 RowBox[{"postnikovpathloop", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j"}], "]"}], "]"}], "\[Equal]", "0"}]}],
                ",", "True", ",", "True", ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"bguys", "=", 
                 RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                 "Now", " ", "find", " ", "out", " ", "which", " ", 
                  "boundaries", " ", "this", " ", "entries", " ", "goes", " ", 
                  RowBox[{"between", "."}]}], "*)"}], "\[IndentingNewLine]", 
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"k", "=", "1"}], ",", 
                  RowBox[{"k", "<", 
                   RowBox[{
                    RowBox[{"Length", "[", "boundaries", "]"}], "+", "1"}]}], 
                  ",", 
                  RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"boundaries", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], ",", 
                    RowBox[{"sources", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "||", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"boundaries", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], ",", 
                    RowBox[{"order", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"bguys", "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{"bguys", ",", 
                    RowBox[{"{", "k", "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"bguys", "=", 
                 RowBox[{"Sort", "[", "bguys", "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"i", "\[Equal]", "1"}], "&&", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"j", "\[Equal]", "5"}], "||", 
                    RowBox[{"j", "\[Equal]", "4"}]}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{"\"\<bguys=\>\"", ",", "bguys"}], "]"}], ";"}]}], 
                   "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "[", "bguys", "]"}], "\[Equal]", "2"}], 
                  ",", 
                  RowBox[{"(*", 
                   RowBox[{
                   "Only", " ", "do", " ", "it", " ", "if", " ", "we", " ", 
                    "re", " ", "going", " ", "between", " ", "different", " ",
                     "boundaries"}], "*)"}], "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"postgekhtmatrixloop", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"postnikovpathloop", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "/.", 
                    RowBox[{"(", 
                    RowBox[{"bguys", "/.", "boundarycuts"}], ")"}]}]}], 
                   ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"postgekhtmatrix", "=", 
        RowBox[{"postgekhtmatrixloop", "/.", "invlooprep"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", 
        "\"\<This is the matrix with also include Gekhtmans's signs \
'postgekhtmatrix':\>\"", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"postgekhtmatrix", "//", "MatrixForm"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Now", " ", "write", " ", "it", " ", "up", " ", "nicely", " ", "in", 
         " ", "terms", " ", "of", " ", 
         RowBox[{"pms", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"tempmat", "=", 
        RowBox[{"Expand", "[", 
         RowBox[{"Simplify", "[", "postgekhtmatrix", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pmpostgekhtmatrix", "=", "postgekhtmatrix"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pmloops", "=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Total", "[", 
             RowBox[{"looplist", " ", "pmref"}], "]"}], "/.", "therule"}], 
           ")"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["pp", 
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{"plist", ",", "pmref"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}]], "\[Rule]", "1"}], 
           "}"}]}], ")"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", "sources", "]"}], "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", 
         RowBox[{"(*", 
          RowBox[{"Rows", " ", "of", " ", "the", " ", "sign", " ", "matrix"}],
           "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "<", 
             RowBox[{
              RowBox[{"Length", "[", "order", "]"}], "+", "1"}]}], ",", 
            RowBox[{"j", "++"}], ",", 
            RowBox[{"(*", 
             RowBox[{
             "Columns", " ", "of", " ", "the", " ", "sign", " ", "matrix"}], 
             "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"tempmat", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j"}], "]"}], "]"}], "\[Equal]", "1"}], "||", 
                RowBox[{
                 RowBox[{"tempmat", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j"}], "]"}], "]"}], "\[Equal]", "0"}]}],
                ",", "True", ",", "True", ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Denominator", "[", 
                    RowBox[{"tempmat", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], "\[Equal]", 
                   "1"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{"we", " ", "have", " ", "multiple", " ", "terms"}],
                    "*)"}], "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"terms", "=", 
                    RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
                   RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"k", "=", "1"}], ",", 
                    RowBox[{"k", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"tempmat", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], "+", 
                    "1"}]}], ",", 
                    RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"MonomialList", "[", 
                    RowBox[{"Denominator", "[", 
                    RowBox[{
                    RowBox[{"tempmat", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "]"}], "]"}], "]"}], ">", 
                    "1"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"If", " ", "we", " ", "have", " ", "loops"}], 
                    "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"terms", "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{"terms", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Expand", "[", 
                    RowBox[{"Simplify", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"tempmat", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "k", "]"}], "]"}], 
                    RowBox[{"Total", "[", "looplist", "]"}]}], "]"}], "]"}], 
                    "pmref"}], ")"}], "/.", "therule"}], ")"}], "/", 
                    "pmloops"}], "}"}]}], "]"}]}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"terms", "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{"terms", ",", 
                    RowBox[{"{", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"tempmat", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "pmref"}], ")"}], "/.", 
                    "therule"}], ")"}], "}"}]}], "]"}]}], ";"}]}], 
                    RowBox[{"(*", 
                    RowBox[{"If", " ", "we", " ", 
                    RowBox[{"don", "'"}], "t", " ", "have", " ", "loops"}], 
                    "*)"}], "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"pmpostgekhtmatrix", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{"Total", "[", "terms", "]"}]}], ";"}], 
                  "\[IndentingNewLine]", ",", "True", ",", 
                  RowBox[{"(*", 
                   RowBox[{
                   "we", " ", "have", " ", "only", " ", "one", " ", "term"}], 
                   "*)"}], "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"MonomialList", "[", 
                    RowBox[{"Denominator", "[", 
                    RowBox[{"tempmat", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], "]"}], 
                    "]"}], ">", "1"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "If", " ", "the", " ", "term", " ", "has", " ", "loops"}],
                     "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"pmpostgekhtmatrix", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Expand", "[", 
                    RowBox[{"Simplify", "[", 
                    RowBox[{
                    RowBox[{"tempmat", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], 
                    RowBox[{"Total", "[", "looplist", "]"}]}], "]"}], "]"}], 
                    " ", "pmref"}], ")"}], "/.", "therule"}], ")"}], "/", 
                    "pmloops"}]}], ";"}], "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"pmpostgekhtmatrix", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"tempmat", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], " ", "pmref"}], 
                    ")"}], "/.", "therule"}], ")"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";"}]}], "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Done", " ", "looking", " ", "nice"}], ",", " ", 
             RowBox[{"and", " ", "overall", " ", 
              RowBox[{"signs", "!"}]}]}], "*)"}], "\[IndentingNewLine]", 
           "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", 
        "\"\<The Grassmannian matrix in terms of perfect matchings is \
'pmpostgekhtmatrix':\>\"", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"pmpostgekhtmatrix", "//", "MatrixForm"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Now", " ", "calculate", " ", "the", " ", 
         RowBox[{"Pluckers", "!"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"plucker", "=", 
        RowBox[{"Expand", "[", 
         RowBox[{"Simplify", "[", 
          RowBox[{
           RowBox[{"Minors", "[", 
            RowBox[{"postgekhtmatrix", ",", 
             RowBox[{"Length", "[", "sources", "]"}]}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", "\"\<These are the Pluckers 'plucker':\>\"", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"plucker", "//", "MatrixForm"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Now", " ", "make", " ", "the", " ", "Pluckers", " ", "look", " ", 
         "nice"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"niceplucker", "=", "plucker"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", "plucker", "]"}], "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", 
         RowBox[{"(*", 
          RowBox[{"Rows", " ", "of", " ", "the", " ", "sign", " ", "matrix"}],
           "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"plucker", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "1"}], ",", "True", 
            ",", "True", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Denominator", "[", 
                 RowBox[{"plucker", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}], "\[Equal]", "1"}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{"we", " ", "have", " ", "multiple", " ", "terms"}], 
                "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"terms", "=", 
                 RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"k", "=", "1"}], ",", 
                  RowBox[{"k", "<", 
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"plucker", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "+", "1"}]}], ",", 
                  RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"MonomialList", "[", 
                    RowBox[{"Denominator", "[", 
                    RowBox[{
                    RowBox[{"plucker", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "]"}], "]"}], "]"}], ">", 
                    "1"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"If", " ", "we", " ", "have", " ", "loops"}], 
                    "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"terms", "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{"terms", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Expand", "[", 
                    RowBox[{"Simplify", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"plucker", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "k", "]"}], "]"}], 
                    RowBox[{"Total", "[", "looplist", "]"}]}], "]"}], "]"}], 
                    "pmref"}], ")"}], "/.", "therule"}], ")"}], "/", 
                    "pmloops"}], "}"}]}], "]"}]}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"terms", "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{"terms", ",", 
                    RowBox[{"{", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"plucker", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "pmref"}], ")"}], "/.", 
                    "therule"}], ")"}], "}"}]}], "]"}]}], ";"}]}], 
                    RowBox[{"(*", 
                    RowBox[{"If", " ", "we", " ", 
                    RowBox[{"don", "'"}], "t", " ", "have", " ", "loops"}], 
                    "*)"}], "\[IndentingNewLine]", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"niceplucker", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "=", 
                 RowBox[{"Total", "[", "terms", "]"}]}], ";"}], 
               "\[IndentingNewLine]", ",", "True", ",", 
               RowBox[{"(*", 
                RowBox[{
                "we", " ", "have", " ", "only", " ", "one", " ", "term"}], 
                "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "[", 
                    RowBox[{"MonomialList", "[", 
                    RowBox[{"Denominator", "[", 
                    RowBox[{"plucker", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "]"}], ">", 
                   "1"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{
                   "If", " ", "the", " ", "term", " ", "has", " ", "loops"}], 
                   "*)"}], "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"niceplucker", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Expand", "[", 
                    RowBox[{"Simplify", "[", 
                    RowBox[{
                    RowBox[{"plucker", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], 
                    RowBox[{"Total", "[", "looplist", "]"}]}], "]"}], "]"}], 
                    " ", "pmref"}], ")"}], "/.", "therule"}], ")"}], "/", 
                    "pmloops"}]}], ";"}], "\[IndentingNewLine]", ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"niceplucker", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "=", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"plucker", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], " ", "pmref"}], ")"}], "/.",
                     "therule"}], ")"}]}], ";"}]}], "\[IndentingNewLine]", 
                 "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Done", " ", "looking", " ", "nice"}], ",", " ", 
          RowBox[{"and", " ", "overall", " ", 
           RowBox[{"signs", "!"}]}]}], "*)"}], "\[IndentingNewLine]", "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", 
        "\"\<Pluckers written in terms of perfect matchings \
'niceplucker':\>\"", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"niceplucker", "//", "MatrixForm"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"realplucker", "=", 
        RowBox[{
         RowBox[{"Expand", "[", 
          RowBox[{"Simplify", "[", 
           RowBox[{"plucker", " ", 
            RowBox[{"Total", "[", "looplist", "]"}], "pmref"}], "]"}], "]"}], 
         "/.", "therule"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", 
        "\"\<Real map between Pluckers and perfect matchings 'realplucker':\>\
\"", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"realplucker", "//", "MatrixForm"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "Now", " ", "check", " ", "that", " ", "the", " ", "Pluckers", " ", 
          "are", " ", "correct"}], ",", " ", 
         RowBox[{
          RowBox[{"i", ".", "e", ".", " ", "that"}], " ", "they", " ", "all", 
          " ", "have", " ", "the", " ", "correct", " ", "source", " ", 
          RowBox[{"set", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"kmat", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{"a", ",", "c"}], "]"}], ",", 
          RowBox[{"Join", "[", 
           RowBox[{"b", ",", "d"}], "]"}], ",", "2"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"btra", "=", 
        RowBox[{"Transpose", "[", "b", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"xtonum", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", "c", "]"}], "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"xtonum", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"xtonum", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"i", "+", 
                 RowBox[{"Length", "[", "a", "]"}]}], ")"}], "\[Rule]", 
               RowBox[{
                RowBox[{"DeleteCases", "[", 
                 RowBox[{
                  RowBox[{"c", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", "0"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "<", 
          RowBox[{
           RowBox[{"Length", "[", "btra", "]"}], "+", "1"}]}], ",", 
         RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"xtonum", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"xtonum", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"j", "+", 
                 RowBox[{"Length", "[", "a", "]"}], "+", 
                 RowBox[{"Length", "[", "c", "]"}], "+", 
                 RowBox[{
                  RowBox[{"Dimensions", "[", "a", "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "\[Rule]", 
               RowBox[{
                RowBox[{"DeleteCases", "[", 
                 RowBox[{
                  RowBox[{"btra", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], ",", "0"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"xorder", "=", 
        RowBox[{"order", "/.", "xtonum"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ordering", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Rule", ",", 
          RowBox[{"{", 
           RowBox[{"xorder", ",", 
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "order", "]"}], "]"}]}], "}"}]}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Done", " ", "with", " ", "the", " ", "first", " ", 
          RowBox[{"part", "!"}], " ", "Now", " ", "check", " ", "source", " ",
           "sets"}], "..."}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"subs", "=", 
        RowBox[{"Subsets", "[", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "order", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"Length", "[", "sources", "]"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"compare", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", "realplucker", "]"}], "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"guys", "=", 
           RowBox[{"MapThread", "[", 
            RowBox[{"Times", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"MonomialList", "[", 
                 RowBox[{"realplucker", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}], "/.", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{
                   SubscriptBox["pp", "x"], "\[Rule]", "1"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"x", ",", 
                    RowBox[{"Length", "[", "plist", "]"}]}], "}"}]}], "]"}]}],
                ",", 
               RowBox[{"MonomialList", "[", 
                RowBox[{"realplucker", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "<", 
             RowBox[{
              RowBox[{"Length", "[", "guys", "]"}], "+", "1"}]}], ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"compare", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"compare", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"guys", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "\[Rule]", 
                  RowBox[{"subs", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "]"}]}], 
             ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"compare", "=", 
        RowBox[{"Sort", "[", "compare", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"compare", "\[Equal]", 
          RowBox[{"pmsourcesOrderingByHand", "[", 
           RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "ordering"}], 
           "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "Print", "[", 
           "\"\<Checked that the source set for these perfect matchings is \
indeed the Plucker coordiate in question, OK!\>\"", "]"}], ";"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{
          RowBox[{
          "Print", "[", 
           "\"\<It seems like the source set of some of these perfect \
matchings is NOT the correct Plucker coordinate...CHECK IT!\>\"", "]"}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"DONE", ",", " ", 
    RowBox[{"NOW", " ", "CALLED", " ", "getGrassmannian"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
     "Gives", " ", "the", " ", "master", " ", "and", " ", "moduli", " ", 
      "spaces", " ", "in", " ", "terms", " ", "of", " ", "loop", " ", 
      RowBox[{"variables", ".", " ", "You"}], " ", "need", " ", "to", " ", 
      "give", " ", "it", " ", "the", " ", "high"}], "-", 
     RowBox[{"genus", " ", "information", " ", "\"\<genusedges\>\""}]}], ",", 
    " ", 
    RowBox[{
     RowBox[{
      RowBox[{"e", ".", "g", ".", " ", "zeds"}], "=", 
      RowBox[{"{", 
       RowBox[{
        FractionBox[
         RowBox[{
          SubscriptBox["X", 
           RowBox[{"9", ",", "6"}]], 
          SubscriptBox["X", 
           RowBox[{"5", ",", "8"}]]}], 
         RowBox[{
          SubscriptBox["X", 
           RowBox[{"8", ",", "9"}]], 
          SubscriptBox["Y", 
           RowBox[{"6", ",", "5"}]], " "}]], ",", 
        FractionBox[
         RowBox[{
          SubscriptBox["X", 
           RowBox[{"6", ",", "8"}]], 
          SubscriptBox["X", 
           RowBox[{"5", ",", "8"}]], 
          SubscriptBox["X", 
           RowBox[{"5", ",", "14"}]]}], 
         RowBox[{
          SubscriptBox["X", 
           RowBox[{"8", ",", "9"}]], 
          SubscriptBox["Y", 
           RowBox[{"6", ",", "5"}]], " ", 
          SubscriptBox["X", 
           RowBox[{"14", ",", "6"}]]}]], ",", 
        FractionBox[
         RowBox[{
          SubscriptBox["X", 
           RowBox[{"14", ",", "14"}]], 
          SubscriptBox["X", 
           RowBox[{"8", ",", "14"}]]}], 
         RowBox[{" ", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"14", ",", "6"}]], 
           SubscriptBox["X", 
            RowBox[{"15", ",", "8"}]]}]}]], ",", 
        FractionBox[
         RowBox[{
          SubscriptBox["X", 
           RowBox[{"16", ",", "14"}]], 
          SubscriptBox["X", 
           RowBox[{"1", ",", "14"}]], 
          SubscriptBox["X", 
           RowBox[{"10", ",", "9"}]]}], 
         RowBox[{
          SubscriptBox["X", 
           RowBox[{"15", ",", "16"}]], 
          SubscriptBox["X", 
           RowBox[{"14", ",", "2"}]], " ", 
          SubscriptBox["X", 
           RowBox[{"9", ",", "1"}]]}]]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"genusedges", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"9", ",", "6"}]], ",", "\"\<b\>\""}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"9", ",", "5"}]], ",", "\"\<w\>\""}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"6", ",", "5"}]], ",", "\"\<b\>\""}], "}"}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"7", ",", "6"}]], ",", "\"\<b\>\""}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"8", ",", "7"}]], ",", "\"\<b\>\""}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"6", ",", "8"}]], ",", "\"\<b\>\""}], "}"}]}], "}"}]}], 
       "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
     "where", " ", "the", " ", "list", " ", "contains", " ", "the", " ", 
      "edges", " ", "going", " ", "through", " ", "each", " ", "of", " ", 
      "the", " ", "nontrivial", " ", "directions", " ", "in", " ", "the", " ", 
      RowBox[{"graph", ".", " ", "The"}], " ", "letter", " ", "after", " ", 
      "each", " ", "edge", " ", "refers", " ", "to", " ", "the", " ", "color",
       " ", "of", " ", "the", " ", "node", " ", "next", " ", "to", " ", "the",
       " ", "border", " ", "of", " ", "the", " ", "unit", " ", 
      RowBox[{"cell", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"newLoopVarModuli", "[", 
      RowBox[{
      "a_", ",", "b_", ",", "c_", ",", "d_", ",", "zeds_", ",", "genusedges_",
        ",", "refpm_", ",", "gauging_"}], "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "xbindices", ",", "boundaryindices", ",", "tempbs", ",", 
         "boundarygroups", ",", "edgevectors", ",", "bgs", ",", "inedges", 
         ",", "outedges", ",", "tovecin", ",", "tovecout", ",", "boundinout", 
         ",", "splitintonumdenom", ",", "numerators", ",", "denominators", 
         ",", "extzsinout", ",", "genusflowvecs", ",", "zis", ",", "inout", 
         ",", "intzsinout", ",", "IF", ",", "NF", ",", "NZ", ",", "fa", ",", 
         "li", ",", "fb", ",", "aia", ",", "fail", ",", "allexpressions", ",",
          "pmnumber", ",", "extZdirection", ",", "intZdirection", ",", 
         "intZcontrib", ",", "extZcontrib", ",", "zeroguessexpr", ",", 
         "zeroguess", ",", "nextface", ",", "dafacevars", ",", "time", ",", 
         "deletelist", ",", "tulplists", ",", "bo", ",", "boundinds", ",", 
         "alsodelete", ",", "numb"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"kasteleyn", "[", 
         RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "First", " ", "find", " ", "the", " ", "contributions", " ", "of", 
          " ", "the", " ", 
          RowBox[{
           SubscriptBox["z", "i"], "'"}], "s", " ", "that", " ", "stretch", 
          " ", "between", " ", "different", " ", 
          RowBox[{"boundaries", ".", " ", "For"}], " ", "this", " ", 
          RowBox[{"we", "'"}], "ll", " ", "now", " ", "find", " ", "whether", 
          " ", "each", " ", "edge", " ", "goes", " ", "in", " ", "or", " ", 
          "out", " ", "of", " ", "each", " ", "respective", " ", "boundary"}],
          "*)"}], "\[IndentingNewLine]", 
        RowBox[{
        "Print", "[", 
         "\"\<We're now going to look for which edges belong to which \
boundaries.\>\"", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"xbindices", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"sub1", "[", "#", "]"}], ",", 
              RowBox[{"sub2", "[", "#", "]"}]}], "}"}], "&"}], ",", "xb"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"boundaryindices", "=", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Sort", "[", 
              RowBox[{"Cases", "[", 
               RowBox[{"xbindices", ",", 
                RowBox[{"zz_", "/;", 
                 RowBox[{
                  RowBox[{"Intersection", "[", 
                   RowBox[{"zz", ",", "#"}], "]"}], "\[NotEqual]", 
                  RowBox[{"{", "}"}]}]}]}], "]"}], "]"}], "&"}], ",", 
            "xbindices"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{"True", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"tempbs", "=", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"DeleteDuplicates", "[", 
                 RowBox[{"Join", "@@", 
                  RowBox[{"Cases", "[", 
                   RowBox[{"boundaryindices", ",", 
                    RowBox[{"zz_", "/;", 
                    RowBox[{
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"Union", "@@", "zz"}], ",", 
                    RowBox[{"Union", "@@", "#"}]}], "]"}], "\[NotEqual]", 
                    RowBox[{"{", "}"}]}]}]}], "]"}]}], "]"}], "&"}], ",", 
               "boundaryindices"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"tempbs", "\[NotEqual]", "boundaryindices"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"boundaryindices", "=", "tempbs"}], ";"}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{
              RowBox[{"Break", "[", "]"}], ";"}]}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"boundaryindices", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Union", "[", 
             RowBox[{"Flatten", "[", "#", "]"}], "]"}], "&"}], ",", 
           "boundaryindices"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"boundarygroups", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{"xb", ",", 
              RowBox[{"zz_", "/;", 
               RowBox[{
                RowBox[{"Intersection", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"sub1", "[", "zz", "]"}], ",", 
                    RowBox[{"sub2", "[", "zz", "]"}]}], "}"}], ",", "#"}], 
                 "]"}], "\[NotEqual]", 
                RowBox[{"{", "}"}]}]}]}], "]"}], "&"}], ",", 
           "boundaryindices"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Done, the boundaries are \>\"", ",", "boundarygroups"}],
          "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"edgevectors", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"bgs", "=", "1"}], ",", 
          RowBox[{"bgs", "<", 
           RowBox[{
            RowBox[{"Length", "[", "boundarygroups", "]"}], "+", "1"}]}], ",", 
          RowBox[{"bgs", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"inedges", "=", 
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"boundarygroups", "[", 
               RowBox[{"[", "bgs", "]"}], "]"}], ",", 
              RowBox[{"zz_", "/;", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"MemberQ", "[", 
                   RowBox[{
                    RowBox[{"Variables", "[", "b", "]"}], ",", "zz"}], "]"}], 
                  "&&", 
                  RowBox[{"FreeQ", "[", 
                   RowBox[{
                    RowBox[{"Variables", "[", 
                    RowBox[{"plist", "[", 
                    RowBox[{"[", "refpm", "]"}], "]"}], "]"}], ",", "zz"}], 
                   "]"}]}], ")"}], "||", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"MemberQ", "[", 
                   RowBox[{
                    RowBox[{"Variables", "[", "c", "]"}], ",", "zz"}], "]"}], 
                  "&&", 
                  RowBox[{"MemberQ", "[", 
                   RowBox[{
                    RowBox[{"Variables", "[", 
                    RowBox[{"plist", "[", 
                    RowBox[{"[", "refpm", "]"}], "]"}], "]"}], ",", "zz"}], 
                   "]"}]}], ")"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"outedges", "=", 
            RowBox[{"Complement", "[", 
             RowBox[{
              RowBox[{"boundarygroups", "[", 
               RowBox[{"[", "bgs", "]"}], "]"}], ",", "inedges"}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"tovecin", "=", 
            RowBox[{"-", 
             RowBox[{"UnitVector", "[", 
              RowBox[{
               RowBox[{"Length", "[", "boundarygroups", "]"}], ",", "bgs"}], 
              "]"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"tovecout", "=", 
            RowBox[{"UnitVector", "[", 
             RowBox[{
              RowBox[{"Length", "[", "boundarygroups", "]"}], ",", "bgs"}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"edgevectors", "=", 
            RowBox[{"Join", "[", 
             RowBox[{"edgevectors", ",", 
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "\[Rule]", "tovecin"}], "&"}], ",", 
                  "inedges"}], "]"}], ",", 
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "\[Rule]", "tovecout"}], "&"}], ",", 
                  "outedges"}], "]"}]}], "]"}]}], "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Now", " ", "we", " ", "know", " ", "which", " ", "edges", " ", 
          "flow", " ", "in", " ", "or", " ", "out", " ", "of", " ", "each", 
          " ", "boundary", " ", "ACCORDING", " ", "TO", " ", "THE", " ", 
          "PERFECT", " ", 
          RowBox[{"ORIENTATION", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Now", " ", "need", " ", "to", " ", "find", " ", "out", " ", "if", 
           " ", "the", " ", 
           RowBox[{
            SubscriptBox["z", "i"], "'"}], "s", " ", "flow", " ", "in", " ", 
           "or", " ", "out", " ", "each", " ", "boundary"}], ",", " ", 
          RowBox[{"ACCORDING", " ", "TO", " ", "HOW", " ", 
           RowBox[{"THEY", "'"}], "VE", " ", "BEEN", " ", 
           RowBox[{"DEFINED", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"boundinout", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"MapThread", "[", 
           RowBox[{"Rule", ",", 
            RowBox[{"{", 
             RowBox[{"boundarygroups", ",", 
              RowBox[{"MapThread", "[", 
               RowBox[{"ReplaceAll", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"Variables", "[", "c", "]"}], ",", "#"}], "]"}], 
                    "&"}], ",", "boundarygroups", ",", 
                    RowBox[{"{", "2", "}"}]}], "]"}], ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"True", "\[Rule]", "#"}], ",", 
                    RowBox[{"False", "\[Rule]", 
                    RowBox[{"-", "#"}]}]}], "}"}], "&"}], ",", 
                    RowBox[{"IdentityMatrix", "[", 
                    RowBox[{"Length", "[", "boundarygroups", "]"}], "]"}]}], 
                   "]"}]}], "}"}]}], "]"}]}], "}"}], ",", "2"}], "]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"splitintonumdenom", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Intersection", "[", 
             RowBox[{"xb", ",", "#"}], "]"}], "&"}], ",", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Variables", "[", 
                 RowBox[{"Numerator", "[", "#", "]"}], "]"}], ",", 
                RowBox[{"Variables", "[", 
                 RowBox[{"Denominator", "[", "#", "]"}], "]"}]}], "}"}], 
              "&"}], ",", 
             RowBox[{"zeds", "[", 
              RowBox[{"[", 
               RowBox[{"Range", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", "genusedges", "]"}], "+", "1"}], ",", 
                 RowBox[{"Length", "[", "zeds", "]"}]}], "]"}], "]"}], 
              "]"}]}], "]"}], ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"numerators", "=", 
         RowBox[{
          RowBox[{"Transpose", "[", "splitintonumdenom", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"denominators", "=", 
         RowBox[{
          RowBox[{"Transpose", "[", "splitintonumdenom", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"extzsinout", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Plus", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Map", "[", 
              RowBox[{"Total", ",", 
               RowBox[{"(", 
                RowBox[{"numerators", "/.", "boundinout"}], ")"}]}], "]"}], 
             ",", 
             RowBox[{"Map", "[", 
              RowBox[{"Total", ",", 
               RowBox[{"-", 
                RowBox[{"(", 
                 RowBox[{"denominators", "/.", "boundinout"}], ")"}]}]}], 
              "]"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Done", "!"}], " ", "Now", " ", "we", " ", "know", " ", 
          "which", " ", "way", " ", "each", " ", "external", " ", 
          SubscriptBox["z", "i"], " ", "is", " ", 
          RowBox[{"going", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Now", " ", "find", " ", "the", " ", "contributions", " ", "of", 
           " ", "the", " ", 
           RowBox[{
            SubscriptBox["z", "i"], "'"}], "s", " ", "that", " ", "go", " ", 
           "around", " ", "nontrivial", " ", 
           RowBox[{"loops", ".", " ", "For"}], " ", "this", " ", 
           RowBox[{"we", "'"}], "ll", " ", "now", " ", "find", " ", "whether",
            " ", "each", " ", "edge", " ", "goes", " ", "in", " ", "or", " ", 
           "out", " ", "of", " ", "the", " ", "graph"}], ",", " ", 
          RowBox[{
          "as", " ", "seen", " ", "from", " ", "a", " ", "given", " ", 
           "border", " ", "of", " ", "the", " ", "unit", " ", 
           RowBox[{"cell", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "These", " ", "are", " ", "the", " ", "edges", " ", "whose", " ", 
          "perfect", " ", "orientation", " ", "flows", " ", "into", " ", 
          "the", " ", "graph"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"inedges", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"DeleteCases", "[", 
               RowBox[{
                RowBox[{"Cases", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{"{", 
                   RowBox[{"___", ",", "\"\<b\>\""}], "}"}]}], "]"}], ",", 
                RowBox[{"zz_", "/;", 
                 RowBox[{"MemberQ", "[", 
                  RowBox[{
                   RowBox[{"Variables", "[", 
                    RowBox[{"plist", "[", 
                    RowBox[{"[", "refpm", "]"}], "]"}], "]"}], ",", 
                   RowBox[{"zz", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "]"}], "&"}],
              ",", "genusedges"}], "]"}], ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"outedges", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Complement", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", "genusedges", 
               ",", 
               RowBox[{"{", "2", "}"}]}], "]"}], ",", "inedges"}], "}"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"genusflowvecs", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"zis", "=", "1"}], ",", 
          RowBox[{"zis", "<", 
           RowBox[{
            RowBox[{"Length", "[", "genusedges", "]"}], "+", "1"}]}], ",", 
          RowBox[{"zis", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"genusflowvecs", "=", 
            RowBox[{"Join", "[", 
             RowBox[{"genusflowvecs", ",", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "\[Rule]", 
                  RowBox[{"UnitVector", "[", 
                   RowBox[{
                    RowBox[{"Length", "[", "genusedges", "]"}], ",", "zis"}], 
                   "]"}]}], "&"}], ",", 
                RowBox[{"inedges", "[", 
                 RowBox[{"[", "zis", "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "\[Rule]", 
                  RowBox[{"-", 
                   RowBox[{"UnitVector", "[", 
                    RowBox[{
                    RowBox[{"Length", "[", "genusedges", "]"}], ",", "zis"}], 
                    "]"}]}]}], "&"}], ",", 
                RowBox[{"outedges", "[", 
                 RowBox[{"[", "zis", "]"}], "]"}]}], "]"}]}], "]"}]}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Now", " ", "we", " ", "know", " ", "which", " ", "edges", " ", 
          "flow", " ", "in", " ", "or", " ", "out", " ", "of", " ", "the", 
          " ", "graph", " ", "ACCORDING", " ", "TO", " ", "THE", " ", 
          "PERFECT", " ", 
          RowBox[{"ORIENTATION", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Now", " ", "need", " ", "to", " ", "find", " ", "out", " ", "if", 
           " ", "the", " ", 
           RowBox[{
            SubscriptBox["z", "i"], "'"}], "s", " ", "flow", " ", "in", " ", 
           "or", " ", "out", " ", "of", " ", "the", " ", "graph"}], ",", " ", 
          RowBox[{"ACCORDING", " ", "TO", " ", "HOW", " ", 
           RowBox[{"THEY", "'"}], "VE", " ", "BEEN", " ", 
           RowBox[{"DEFINED", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"splitintonumdenom", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Intersection", "[", 
             RowBox[{
              RowBox[{"DeleteCases", "[", 
               RowBox[{
                RowBox[{"Flatten", "[", "genusedges", "]"}], ",", 
                RowBox[{"\"\<b\>\"", "|", "\"\<w\>\""}]}], "]"}], ",", "#"}], 
             "]"}], "&"}], ",", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Variables", "[", 
                 RowBox[{"Numerator", "[", "#", "]"}], "]"}], ",", 
                RowBox[{"Variables", "[", 
                 RowBox[{"Denominator", "[", "#", "]"}], "]"}]}], "}"}], 
              "&"}], ",", 
             RowBox[{"zeds", "[", 
              RowBox[{"[", 
               RowBox[{"Range", "[", 
                RowBox[{"Length", "[", "genusedges", "]"}], "]"}], "]"}], 
              "]"}]}], "]"}], ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"numerators", "=", 
         RowBox[{
          RowBox[{"Transpose", "[", "splitintonumdenom", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"denominators", "=", 
         RowBox[{
          RowBox[{"Transpose", "[", "splitintonumdenom", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"inout", "=", 
         RowBox[{"Join", "@@", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"genusedges", "[", 
               RowBox[{"[", "#", "]"}], "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"zz_", ",", "\"\<b\>\""}], "}"}], "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{"zz", "\[Rule]", 
                   RowBox[{"UnitVector", "[", 
                    RowBox[{
                    RowBox[{"Length", "[", "genusedges", "]"}], ",", "#"}], 
                    "]"}]}], ")"}]}], ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"zzz_", ",", "\"\<w\>\""}], "}"}], "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{"zzz", "\[Rule]", 
                   RowBox[{"-", 
                    RowBox[{"UnitVector", "[", 
                    RowBox[{
                    RowBox[{"Length", "[", "genusedges", "]"}], ",", "#"}], 
                    "]"}]}]}], ")"}]}]}], "}"}]}], "&"}], ",", 
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "genusedges", "]"}], "]"}]}], "]"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"intzsinout", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Plus", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Map", "[", 
              RowBox[{"Total", ",", 
               RowBox[{"(", 
                RowBox[{"numerators", "/.", "inout"}], ")"}]}], "]"}], ",", 
             RowBox[{"Map", "[", 
              RowBox[{"Total", ",", 
               RowBox[{"-", 
                RowBox[{"(", 
                 RowBox[{"denominators", "/.", "inout"}], ")"}]}]}], "]"}]}], 
            "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Done", "!"}], " ", "Now", " ", "we", " ", "know", " ", 
          "which", " ", "way", " ", "each", " ", 
          SubscriptBox["z", "i"], " ", "is", " ", 
          RowBox[{"going", ".", " ", "This"}], " ", "even", " ", "allows", 
          " ", "for", " ", "the", " ", "possibility", " ", "of", " ", "a", 
          " ", 
          SubscriptBox["z", "i"], " ", "looping", " ", "around", " ", "both", 
          " ", "nontrivial", " ", 
          RowBox[{"directions", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Here", " ", "is", " ", "old", " ", "code", " ", "that", " ", 
           "creates", " ", "the", " ", "faces", " ", 
           SubscriptBox["w", "i"], "and", " ", 
           SubscriptBox["z", "j"], " ", "paths"}], ",", " ", 
          RowBox[{"but", " ", "now", " ", "we", " ", "also", " ", "form", " ", 
           RowBox[{
            SubscriptBox["w", "NF"], "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"IF", "=", 
         RowBox[{"internalFaces", "[", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"NF", "=", 
         RowBox[{
          RowBox[{"externalFaces", "[", 
           RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "+", "IF"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"First", " ", "make", " ", "the", " ", 
          SubscriptBox["w", "i"], " ", "variables"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"NZ", "=", 
         RowBox[{"Length", "[", "zeds", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"fa", "=", "1"}], ",", 
          RowBox[{"fa", "<", 
           RowBox[{"NF", "+", "1"}]}], ",", 
          RowBox[{"fa", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            SubscriptBox["w", "fa"], "=", "1"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"li", "=", "1"}], ",", 
          RowBox[{"li", "<", 
           RowBox[{
            RowBox[{"Length", "[", "Xlist", "]"}], "+", "1"}]}], ",", 
          RowBox[{"li", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"fa", "=", "1"}], ",", 
             RowBox[{"fa", "<", 
              RowBox[{"NF", "+", "1"}]}], ",", 
             RowBox[{"fa", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"fb", "=", "1"}], ",", 
                RowBox[{"fb", "<", 
                 RowBox[{"NF", "+", "1"}]}], ",", 
                RowBox[{"fb", "++"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}], "\[Equal]", 
                    SubscriptBox["X", 
                    RowBox[{"fa", ",", "fb"}]]}], "||", 
                    RowBox[{
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}], "\[Equal]", 
                    SubscriptBox["Y", 
                    RowBox[{"fa", ",", "fb"}]]}], "||", 
                    RowBox[{
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}], "\[Equal]", 
                    SubscriptBox["Z", 
                    RowBox[{"fa", ",", "fb"}]]}], "||", 
                    RowBox[{
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}], "\[Equal]", 
                    SubscriptBox["W", 
                    RowBox[{"fa", ",", "fb"}]]}], "||", 
                    RowBox[{
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}], "\[Equal]", 
                    SubscriptBox["V", 
                    RowBox[{"fa", ",", "fb"}]]}], "||", 
                    RowBox[{
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}], "\[Equal]", 
                    SubscriptBox["UU", 
                    RowBox[{"fa", ",", "fb"}]]}], "||", 
                    RowBox[{
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}], "\[Equal]", 
                    SubscriptBox["XX", 
                    RowBox[{"fa", ",", "fb"}]]}], "||", 
                    RowBox[{
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}], "\[Equal]", 
                    SubscriptBox["YY", 
                    RowBox[{"fa", ",", "fb"}]]}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["w", "fa"], "=", 
                    RowBox[{
                    SubscriptBox["w", "fa"], "/", 
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["w", "fb"], "=", 
                    RowBox[{
                    SubscriptBox["w", "fb"], 
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}]}]}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Now", " ", "label", " ", "the", " ", 
          RowBox[{"z", "'"}], "s"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"aia", "=", "1"}], ",", 
          RowBox[{"aia", "<", 
           RowBox[{
            RowBox[{"Length", "[", "zeds", "]"}], "+", "1"}]}], ",", 
          RowBox[{"aia", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            SubscriptBox["z", "aia"], "=", 
            RowBox[{"zeds", "[", 
             RowBox[{"[", "aia", "]"}], "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "This", " ", "finds", " ", "the", " ", "contribution", " ", "from", 
          " ", "all", " ", 
          RowBox[{"z", "'"}], "s", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
            "both", " ", "those", " ", "between", " ", "boundaries", " ", 
             "and", " ", "those", " ", "around", " ", "nontrivial", " ", 
             "loops"}], ")"}], "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"fail", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"allexpressions", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"pmnumber", "=", "1"}], ",", 
          RowBox[{"pmnumber", "<", 
           RowBox[{
            RowBox[{"Length", "[", "plist", "]"}], "+", "1"}]}], ",", 
          RowBox[{"pmnumber", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"\"\<pmnumber = \>\"", ",", "pmnumber"}], "]"}], ";"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"extZdirection", "=", 
            RowBox[{"Total", "[", 
             RowBox[{
              RowBox[{"Intersection", "[", 
               RowBox[{"xb", ",", 
                RowBox[{"Variables", "[", 
                 RowBox[{
                  RowBox[{"plist", "[", 
                   RowBox[{"[", "pmnumber", "]"}], "]"}], "/", 
                  RowBox[{"plist", "[", 
                   RowBox[{"[", "refpm", "]"}], "]"}]}], "]"}]}], "]"}], "/.",
               "edgevectors"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"intZdirection", "=", 
            RowBox[{"Total", "[", 
             RowBox[{
              RowBox[{"Intersection", "[", 
               RowBox[{
                RowBox[{"DeleteCases", "[", 
                 RowBox[{
                  RowBox[{"Flatten", "[", "genusedges", "]"}], ",", 
                  RowBox[{"\"\<b\>\"", "|", "\"\<w\>\""}]}], "]"}], ",", 
                RowBox[{"Variables", "[", 
                 RowBox[{
                  RowBox[{"plist", "[", 
                   RowBox[{"[", "pmnumber", "]"}], "]"}], "/", 
                  RowBox[{"plist", "[", 
                   RowBox[{"[", "refpm", "]"}], "]"}]}], "]"}]}], "]"}], "/.",
               "genusflowvecs"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"intZcontrib", "=", 
            RowBox[{"Times", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Solve", "[", 
                 RowBox[{
                  RowBox[{"Total", "[", 
                   RowBox[{"MapThread", "[", 
                    RowBox[{"Times", ",", 
                    RowBox[{"{", 
                    RowBox[{"intzsinout", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    SubscriptBox["zz", "iii"], ",", 
                    RowBox[{"{", 
                    RowBox[{"iii", ",", 
                    RowBox[{"Length", "[", "genusedges", "]"}]}], "}"}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}], "\[Equal]", 
                  "intZdirection"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "/.", 
               RowBox[{"Rule", "\[Rule]", "Power"}]}], ")"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"extZcontrib", "=", 
            RowBox[{"Times", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Solve", "[", 
                 RowBox[{
                  RowBox[{"Total", "[", 
                   RowBox[{"MapThread", "[", 
                    RowBox[{"Times", ",", 
                    RowBox[{"{", 
                    RowBox[{"extzsinout", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    SubscriptBox["zz", "iii"], ",", 
                    RowBox[{"{", 
                    RowBox[{"iii", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "genusedges", "]"}], "+", "1"}], 
                    ",", 
                    RowBox[{"Length", "[", "zeds", "]"}]}], "}"}]}], "]"}]}], 
                    "}"}]}], "]"}], "]"}], "\[Equal]", "extZdirection"}], 
                 "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "/.", 
               RowBox[{"Rule", "\[Rule]", "Power"}]}], ")"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"zeroguessexpr", "=", 
            RowBox[{"intZcontrib", " ", "extZcontrib"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"zeroguess", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"plist", "[", 
                RowBox[{"[", "pmnumber", "]"}], "]"}], "/", 
               RowBox[{"plist", "[", 
                RowBox[{"[", "refpm", "]"}], "]"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{"zeroguessexpr", "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"zz", "\[Rule]", "z"}], ",", 
                 RowBox[{"ww", "\[Rule]", "w"}]}], "}"}]}], ")"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"Found", " ", "the", " ", "correct", " ", 
             RowBox[{"expression", ".", " ", "What"}], " ", "remains", " ", 
             "in", " ", "\"\<zeroguess\>\"", " ", "is", " ", "guaranteed", 
             " ", "to", " ", "be", " ", "equal", " ", "to", " ", "some", " ", 
             "product", " ", "of", " ", 
             RowBox[{"faces", "."}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"Now", " ", 
             RowBox[{"we", "'"}], "ll", " ", "find", " ", "the", " ", 
             "expression", " ", "for", " ", "the", " ", "faces"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"TimeConstrained", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"While", "[", 
               RowBox[{
                RowBox[{"zeroguess", "=!=", "1"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"nextface", "=", 
                  RowBox[{"sub2", "[", 
                   RowBox[{
                    RowBox[{"Variables", "[", 
                    RowBox[{"Numerator", "[", "zeroguess", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"zeroguess", "=", 
                  RowBox[{"zeroguess", "/", 
                   SubscriptBox["w", "nextface"]}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"zeroguessexpr", "=", 
                  RowBox[{"zeroguessexpr", " ", 
                   SubscriptBox["ww", "nextface"]}]}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"zeroguessexpr", "=", 
               RowBox[{"zeroguessexpr", "/.", 
                RowBox[{
                 SubscriptBox["ww", "NF"], "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{"1", "/", 
                   RowBox[{"Times", "@@", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    SubscriptBox["ww", "iii"], ",", 
                    RowBox[{"{", 
                    RowBox[{"iii", ",", 
                    RowBox[{"NF", "-", "1"}]}], "}"}]}], "]"}]}]}], 
                  ")"}]}]}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"allexpressions", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"allexpressions", ",", "zeroguessexpr"}], "]"}]}], 
              ";"}], "\[IndentingNewLine]", ",", "20", ",", 
             RowBox[{
              RowBox[{"fail", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"fail", ",", "pmnumber"}], "]"}]}], ";", 
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<Number \>\"", ",", "pmnumber", ",", "\"\< failed!\>\""}], 
               "]"}], ";"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Done", "!"}], " ", 
          RowBox[{"We", "'"}], "ve", " ", "found", " ", "all", " ", 
          RowBox[{"expressions", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Now", " ", 
          RowBox[{"we", "'"}], "ll", " ", "make", " ", "Gmaster"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"dafacevars", "=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"MapThread", "[", 
            RowBox[{"Subscript", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"ConstantArray", "[", 
                RowBox[{"zz", ",", 
                 RowBox[{"Length", "[", "zeds", "]"}]}], "]"}], ",", 
               RowBox[{"Range", "[", 
                RowBox[{"Length", "[", "zeds", "]"}], "]"}]}], "}"}]}], "]"}],
            ",", 
           RowBox[{"MapThread", "[", 
            RowBox[{"Subscript", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"ConstantArray", "[", 
                RowBox[{"ww", ",", 
                 RowBox[{"NF", "-", "1"}]}], "]"}], ",", 
               RowBox[{"Range", "[", 
                RowBox[{"NF", "-", "1"}], "]"}]}], "}"}]}], "]"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Gmaster", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"allexpressions", "/.", 
              RowBox[{"Times", "\[Rule]", "Plus"}]}], ")"}], "/.", 
            RowBox[{"Power", "\[Rule]", "Times"}]}], ")"}], "/.", 
          RowBox[{"MapThread", "[", 
           RowBox[{"Rule", ",", 
            RowBox[{"{", 
             RowBox[{"dafacevars", ",", 
              RowBox[{"IdentityMatrix", "[", 
               RowBox[{"Length", "[", "dafacevars", "]"}], "]"}]}], "}"}]}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"Position", "[", 
             RowBox[{
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "===", "1"}], "&"}], ",", "allexpressions"}], 
               "]"}], ",", "True"}], "]"}], "]"}], "===", 
           RowBox[{"{", "refpm", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Gmaster", "[", 
             RowBox[{"[", "refpm", "]"}], "]"}], "=", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"0", ",", 
              RowBox[{"Length", "[", "dafacevars", "]"}]}], "]"}]}], ";"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{
           RowBox[{
           "Print", "[", 
            "\"\<There is some problem! It seems like multiple expressions \
are identically equal to 1!!!!\>\"", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Gmaster", "=", 
         RowBox[{"Transpose", "[", "Gmaster", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "This", " ", "is", " ", "old", " ", "code", " ", "that", " ", 
          "makes", " ", "the", " ", "moduli", " ", "space", " ", 
          RowBox[{"etc", ".", " ", "and"}], " ", "all", " ", "the", " ", 
          "printouts"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
        "Print", "[", "\"\<---------------------------------------------\>\"",
          "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Failed \>\"", ",", 
          RowBox[{"Length", "[", "fail", "]"}], ",", "\"\< times: \>\"", ",", 
          "fail"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Computation time: \>\"", ",", 
          RowBox[{
           RowBox[{"TimeUsed", "[", "]"}], "-", "time"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"time", "=", 
         RowBox[{"TimeUsed", "[", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Gmaster = \>\"", ",", 
          RowBox[{"Gmaster", "//", "MatrixForm"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mastermult", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Dimensions", "[", 
             RowBox[{
              RowBox[{"Gather", "[", 
               RowBox[{"Transpose", "[", "Gmaster", "]"}], "]"}], "[", 
              RowBox[{"[", "y", "]"}], "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"y", ",", 
             RowBox[{
              RowBox[{"Dimensions", "[", 
               RowBox[{"Gather", "[", 
                RowBox[{"Transpose", "[", "Gmaster", "]"}], "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"mastermult", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ">", "1"}], ",", 
          RowBox[{
           RowBox[{
           "Print", "[", 
            "\"\<ERROR!!! THERE ARE SEVERAL PERFECT MATCHINGS WITH THE SAME \
EXPRESSION!\>\"", "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{
        "Print", "[", 
         "\"\<The order of the coordinates for Gmaster is: \
\!\(\*SubscriptBox[\(z\), \(i\)]\)'s, then faces (starting from face 1 to \
face NF-1).\>\"", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"gauging", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Gmoduli", "=", 
           RowBox[{"Delete", "[", 
            RowBox[{"Gmaster", ",", 
             RowBox[{"Transpose", "[", 
              RowBox[{"{", 
               RowBox[{"Table", "[", 
                RowBox[{"i", ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", 
                   RowBox[{"NZ", "+", "1"}], ",", 
                   RowBox[{"NZ", "+", "IF"}]}], "}"}]}], "]"}], "}"}], 
              "]"}]}], "]"}]}], "\[IndentingNewLine]", ",", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"gauging", "\[Equal]", "2"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"deletelist", "=", 
               RowBox[{"Range", "[", 
                RowBox[{"Length", "[", "genusedges", "]"}], "]"}]}], ";", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{
                 RowBox[{
                 "Here", " ", "we", " ", "also", " ", "dauge", " ", "the", 
                  " ", "internal", " ", "zig"}], "-", "zags"}], ",", " ", 
                RowBox[{
                "as", " ", "well", " ", "as", " ", "delete", " ", "all", " ", 
                 "internal", " ", "faces"}]}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"Gmoduli", "=", "Gmaster"}], ";", "\[IndentingNewLine]", 
              RowBox[{"tulplists", "=", 
               RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"bo", "=", "1"}], ",", 
                RowBox[{"bo", "<", 
                 RowBox[{
                  RowBox[{"Length", "[", "boundarygroups", "]"}], "+", 
                  "1"}]}], ",", 
                RowBox[{"bo", "++"}], ",", 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{
                  "Each", " ", "time", " ", "we", " ", "have", " ", 
                   "external", " ", "guys", " ", "going", " ", "around", " ", 
                   "a", " ", "boundary", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    "hence", " ", "are", " ", "completely", " ", "internal"}],
                     ")"}]}], ",", " ", 
                  RowBox[{
                  "we", " ", "have", " ", "to", " ", "subtract", " ", "the", 
                   " ", "value", " ", "of", " ", "one", " ", "row", " ", 
                   "from", " ", "all", " ", "the", " ", "others"}], ",", " ", 
                  RowBox[{
                  "and", " ", "then", " ", "gauge", " ", "this", " ", 
                   "row"}]}], "*)"}], "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"boundinds", "=", 
                  RowBox[{"Union", "@@", 
                   RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"sub1", "[", "#", "]"}], ",", 
                    RowBox[{"sub2", "[", "#", "]"}]}], "}"}], "&"}], ",", 
                    RowBox[{"boundarygroups", "[", 
                    RowBox[{"[", "bo", "]"}], "]"}]}], "]"}]}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"MemberQ", "[", 
                    RowBox[{"boundinds", ",", "NF"}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"boundinds", "=", 
                    RowBox[{"Complement", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", "NF", "]"}], ",", "boundinds"}], 
                    "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"tulplists", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"tulplists", ",", "boundinds"}], "]"}]}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"alsodelete", "=", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "+", 
                   RowBox[{"Length", "[", "zeds", "]"}]}], "&"}], ",", 
                 RowBox[{
                  RowBox[{"Cases", "[", 
                   RowBox[{
                    RowBox[{"Tuples", "[", "tulplists", "]"}], ",", 
                    RowBox[{"zz_", "/;", 
                    RowBox[{
                    RowBox[{"Union", "[", "zz", "]"}], "\[Equal]", 
                    RowBox[{"Sort", "[", "zz", "]"}]}]}]}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"bo", "=", "1"}], ",", 
                RowBox[{"bo", "<", 
                 RowBox[{
                  RowBox[{"Length", "[", "tulplists", "]"}], "+", "1"}]}], 
                ",", 
                RowBox[{"bo", "++"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"For", "[", 
                  RowBox[{
                   RowBox[{"numb", "=", "1"}], ",", 
                   RowBox[{"numb", "<", 
                    RowBox[{"Length", "[", 
                    RowBox[{"tulplists", "[", 
                    RowBox[{"[", "bo", "]"}], "]"}], "]"}]}], ",", 
                   RowBox[{"numb", "++"}], ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Gmoduli", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Length", "[", "zeds", "]"}], "+", 
                    RowBox[{"tulplists", "[", 
                    RowBox[{"[", 
                    RowBox[{"bo", ",", "numb"}], "]"}], "]"}]}], "]"}], "]"}],
                     "=", 
                    RowBox[{
                    RowBox[{"Gmoduli", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Length", "[", "zeds", "]"}], "+", 
                    RowBox[{"tulplists", "[", 
                    RowBox[{"[", 
                    RowBox[{"bo", ",", "numb"}], "]"}], "]"}]}], "]"}], "]"}],
                     "-", 
                    RowBox[{"Gmoduli", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Length", "[", "zeds", "]"}], "+", 
                    RowBox[{"alsodelete", "[", 
                    RowBox[{"[", "bo", "]"}], "]"}]}], "]"}], "]"}]}]}], 
                    ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"deletelist", "=", 
               RowBox[{"Sort", "[", 
                RowBox[{"Join", "[", 
                 RowBox[{"deletelist", ",", "alsodelete"}], "]"}], "]"}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"Gmoduli", "=", 
               RowBox[{"Delete", "[", 
                RowBox[{"Gmoduli", ",", 
                 RowBox[{"Transpose", "[", 
                  RowBox[{"{", "deletelist", "}"}], "]"}]}], "]"}]}], ";"}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{
              RowBox[{
              "Print", "[", 
               "\"\<Invalid value for 'gauging'. Need to specify either \
'gauging'=1 or 'gauging'=2.\>\"", "]"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Now", " ", "group", " ", "the", " ", "multiplicities", " ", "of", 
          " ", "G", " ", 
          RowBox[{"together", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Gshort", "=", 
         RowBox[{"Transpose", "[", 
          RowBox[{"DeleteDuplicates", "[", 
           RowBox[{"Transpose", "[", "Gmoduli", "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Multmatrix", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Dimensions", "[", 
             RowBox[{
              RowBox[{"Gather", "[", 
               RowBox[{"Transpose", "[", "Gmoduli", "]"}], "]"}], "[", 
              RowBox[{"[", "y", "]"}], "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"y", ",", 
             RowBox[{
              RowBox[{"Dimensions", "[", 
               RowBox[{"Gather", "[", 
                RowBox[{"Transpose", "[", "Gmoduli", "]"}], "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Gshort = \>\"", ",", 
          RowBox[{"Gshort", "//", "MatrixForm"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Multipl = \>\"", ",", 
          RowBox[{"Multmatrix", "//", "MatrixForm"}]}], "]"}], ";"}]}], " ", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", "]"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"DONE", ",", " ", 
    RowBox[{"NOW", " ", "CALLED", " ", "moduliLoopVariablesBFT"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Gives", " ", "the", " ", "toric", " ", "diagram", " ", "of", " ", "the", 
    " ", "moduli", " ", "space", " ", "using", " ", "the", " ", 
    SubscriptBox["w", "i"], " ", 
    RowBox[{"variables", ".", " ", "You"}], " ", "need", " ", "to", " ", 
    "specify", " ", "whether", " ", "you", " ", "want", " ", "gauging", " ", 
    "1", " ", "or", " ", "gauging", " ", "2."}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"loopVariableModuli", "[", 
     RowBox[{
     "a_", ",", "b_", ",", "c_", ",", "d_", ",", "zeds_", ",", "patience_", 
      ",", "gauging_", ",", "referencenum_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "IF", ",", "NF", ",", "fa", ",", "li", ",", "fb", ",", "NZ", ",", 
        "NZI", ",", "temp", ",", "kk", ",", "check", ",", "jj", ",", "jk", 
        ",", "wext", ",", "allint", ",", "zext", ",", "ref", ",", "allext", 
        ",", "extsubs", ",", "intsubs", ",", "newint", ",", "numm", ",", 
        "tryshift", ",", "wpower", ",", "wpow", ",", 
        RowBox[{"(*", 
         RowBox[{"wshift", ","}], "*)"}], "ki", ",", "wtrya", ",", "el", ",", 
        "masterspace", ",", "fail", ",", "guess", ",", "k", ",", "darn", ",", 
        "retry", ",", "consider", ",", "expression", ",", "zexpression", ",", 
        "considervar", ",", "j", ",", "count", ",", "done", ",", "wextcont", 
        ",", "ranw", ",", "ranz", ",", "i", ",", "ii", ",", "save", ",", "jz",
         ",", "zextcont", ",", "save2", ",", "ij", ",", "ji", ",", 
        "senttointernal", ",", "sentexpression", ",", "zsentexpression", ",", 
        "zintcont", ",", "jsh", ",", "wshiftcont", ",", "save3", ",", 
        "wintcont", ",", "powers", ",", "tem", ",", "score", ",", "bore", ",",
         "cha", ",", "pow", ",", "inw", ",", "ad", ",", "powarray", ",", "om",
         ",", "show", ",", "wfa", ",", "mastercoords", ",", "ei", ",", "ai", 
        ",", "nice", ",", "compare", ",", "mastermult", ",", "bonudaries", 
        ",", "deletelist", ",", "bo", ",", "numb", ",", "intz", ",", "aia", 
        ",", "boundaries"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"kasteleyn", "[", 
        RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"IF", "=", 
        RowBox[{"internalFaces", "[", 
         RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"NF", "=", 
        RowBox[{
         RowBox[{"externalFaces", "[", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "+", "IF"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"First", " ", "make", " ", "the", " ", 
         SubscriptBox["w", "i"], " ", "variables"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"NZ", "=", 
        RowBox[{"Length", "[", "zeds", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"fa", "=", "1"}], ",", 
         RowBox[{"fa", "<", "NF"}], ",", 
         RowBox[{"fa", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           SubscriptBox["w", "fa"], "=", "1"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"li", "=", "1"}], ",", 
         RowBox[{"li", "<", 
          RowBox[{
           RowBox[{"Length", "[", "Xlist", "]"}], "+", "1"}]}], ",", 
         RowBox[{"li", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"fa", "=", "1"}], ",", 
            RowBox[{"fa", "<", 
             RowBox[{"NF", "+", "1"}]}], ",", 
            RowBox[{"fa", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"fb", "=", "1"}], ",", 
               RowBox[{"fb", "<", 
                RowBox[{"NF", "+", "1"}]}], ",", 
               RowBox[{"fb", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}], "\[Equal]", 
                    SubscriptBox["X", 
                    RowBox[{"fa", ",", "fb"}]]}], "||", 
                   RowBox[{
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}], "\[Equal]", 
                    SubscriptBox["Y", 
                    RowBox[{"fa", ",", "fb"}]]}], "||", 
                   RowBox[{
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}], "\[Equal]", 
                    SubscriptBox["Z", 
                    RowBox[{"fa", ",", "fb"}]]}], "||", 
                   RowBox[{
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}], "\[Equal]", 
                    SubscriptBox["W", 
                    RowBox[{"fa", ",", "fb"}]]}], "||", 
                   RowBox[{
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}], "\[Equal]", 
                    SubscriptBox["V", 
                    RowBox[{"fa", ",", "fb"}]]}], "||", 
                   RowBox[{
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}], "\[Equal]", 
                    SubscriptBox["UU", 
                    RowBox[{"fa", ",", "fb"}]]}], "||", 
                   RowBox[{
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}], "\[Equal]", 
                    SubscriptBox["XX", 
                    RowBox[{"fa", ",", "fb"}]]}], "||", 
                   RowBox[{
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}], "\[Equal]", 
                    SubscriptBox["YY", 
                    RowBox[{"fa", ",", "fb"}]]}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"fa", "\[NotEqual]", "NF"}], ",", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["w", "fa"], "=", 
                    RowBox[{
                    SubscriptBox["w", "fa"], "/", 
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}]}]}], ";"}]}], "]"}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"fb", "\[NotEqual]", "NF"}], ",", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["w", "fb"], "=", 
                    RowBox[{
                    SubscriptBox["w", "fb"], 
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}]}]}], ";"}]}], "]"}], 
                   ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Now", " ", "label", " ", "the", " ", 
         RowBox[{"z", "'"}], "s"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"aia", "=", "1"}], ",", 
         RowBox[{"aia", "<", 
          RowBox[{
           RowBox[{"Length", "[", "zeds", "]"}], "+", "1"}]}], ",", 
         RowBox[{"aia", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           SubscriptBox["z", "aia"], "=", 
           RowBox[{"zeds", "[", 
            RowBox[{"[", "aia", "]"}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Make", " ", "the", " ", 
          SubscriptBox["wext", "i"], " ", "and", " ", 
          SubscriptBox["zext", "i"]}], ",", " ", 
         RowBox[{
          RowBox[{"i", ".", "e", ".", " ", "removing"}], " ", "all", " ", 
          "internal", " ", 
          RowBox[{"edges", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"NZI", "=", "0"}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "Number", " ", "of", " ", "z", " ", "lines", " ", "that", " ", "only",
          " ", "have", " ", "internal", " ", 
         RowBox[{"edges", ".", " ", "We"}], " ", "will", " ", "now", " ", 
         "count", " ", 
         RowBox[{"them", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"temp", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"First", " ", "do", " ", "the", " ", 
         SubscriptBox["wext", "i"]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"kk", "=", "1"}], ",", 
         RowBox[{"kk", "<", "NF"}], ",", 
         RowBox[{"kk", "++"}], ",", 
         RowBox[{"(*", 
          RowBox[{"kk", " ", "is", " ", "the", " ", "the", " ", "face"}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           SubscriptBox["wext", "kk"], "=", 
           SubscriptBox["w", "kk"]}], ";", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"jj", "=", "1"}], ",", 
            RowBox[{"jj", "<", 
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"Variables", "[", 
                SubscriptBox["w", "kk"], "]"}], "]"}], "+", "1"}]}], ",", 
            RowBox[{"jj", "++"}], ",", 
            RowBox[{"(*", 
             RowBox[{
             "jj", " ", "is", " ", "the", " ", "variable", " ", "of", " ", 
              "the", " ", "the", " ", "face"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"check", "=", "0"}], ";", " ", 
             RowBox[{"(*", 
              RowBox[{
              "Check", " ", "whether", " ", "this", " ", "variable", " ", 
               "is", " ", "an", " ", "external", " ", "one"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"jk", "=", "1"}], ",", 
               RowBox[{"jk", "<", 
                RowBox[{
                 RowBox[{"Length", "[", "xb", "]"}], "+", "1"}]}], ",", 
               RowBox[{"jk", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["w", "kk"], "]"}], "[", 
                    RowBox[{"[", "jj", "]"}], "]"}], "\[Equal]", 
                   RowBox[{"xb", "[", 
                    RowBox[{"[", "jk", "]"}], "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"check", "=", "1"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"check", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"If", " ", 
                  RowBox[{"it", "'"}], "s", " ", "an", " ", "internal", " ", 
                  "one"}], ",", " ", 
                 RowBox[{"find", " ", "out", " ", "if", " ", 
                  RowBox[{"it", "'"}], "s", " ", "in", " ", "the", " ", "top",
                   " ", "or", " ", 
                  RowBox[{"bottom", ".", " ", "Then"}], " ", "remove", " ", 
                  RowBox[{"it", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["w", "kk"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["w", "kk"], "]"}], "[", 
                    RowBox[{"[", "jj", "]"}], "]"}]}], "]"}], "\[Equal]", 
                   "0"}], ",", " ", "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{
                    RowBox[{
                    "If", " ", "the", " ", "variable", " ", "is", " ", "in", 
                    " ", "the", " ", "denomianator", " ", 
                    RowBox[{"(", 
                    RowBox[{"ie", " ", "\[Equal]", "0"}], ")"}]}], ",", " ", 
                    RowBox[{"multiply", " ", "it", " ", 
                    RowBox[{"in", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["wext", "kk"], "=", 
                    RowBox[{
                    SubscriptBox["wext", "kk"], " ", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["w", "kk"], "]"}], "[", 
                    RowBox[{"[", "jj", "]"}], "]"}]}]}], ";"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["wext", "kk"], "=", 
                    RowBox[{
                    SubscriptBox["wext", "kk"], "/", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["w", "kk"], "]"}], "[", 
                    RowBox[{"[", "jj", "]"}], "]"}]}]}], ";"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["wext", "kk"], "=", 
                    RowBox[{
                    SubscriptBox["wext", "kk"], "/", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["w", "kk"], "]"}], "[", 
                    RowBox[{"[", "jj", "]"}], "]"}]}]}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"temp", "=", 
                 RowBox[{"temp", " ", 
                  RowBox[{
                   RowBox[{"Variables", "[", 
                    SubscriptBox["w", "kk"], "]"}], "[", 
                   RowBox[{"[", "jj", "]"}], "]"}]}]}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"allint", "=", 
        RowBox[{"Variables", "[", "temp", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Now", " ", "do", " ", "the", " ", 
         SubscriptBox["zext", "i"]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"intz", "=", 
        RowBox[{"{", "}"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{"Remembers", " ", "which", " ", 
         RowBox[{"z", "'"}], "s", " ", "are", " ", "internal"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"kk", "=", "1"}], ",", 
         RowBox[{"kk", "<", 
          RowBox[{"NZ", "+", "1"}]}], ",", 
         RowBox[{"kk", "++"}], ",", 
         RowBox[{"(*", 
          RowBox[{"kk", " ", "is", " ", "the", " ", "the", " ", 
           SubscriptBox["z", "k"], " ", "path"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           SubscriptBox["zext", "kk"], "=", 
           SubscriptBox["z", "kk"]}], ";", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"jj", "=", "1"}], ",", 
            RowBox[{"jj", "<", 
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"Variables", "[", 
                SubscriptBox["z", "kk"], "]"}], "]"}], "+", "1"}]}], ",", 
            RowBox[{"jj", "++"}], ",", 
            RowBox[{"(*", 
             RowBox[{
             "jj", " ", "is", " ", "the", " ", "variable", " ", "of", " ", 
              "the", " ", "the", " ", "path"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"check", "=", "0"}], ";", " ", 
             RowBox[{"(*", 
              RowBox[{
              "Check", " ", "whether", " ", "this", " ", "variable", " ", 
               "is", " ", "an", " ", "external", " ", "one"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"jk", "=", "1"}], ",", 
               RowBox[{"jk", "<", 
                RowBox[{
                 RowBox[{"Length", "[", "xb", "]"}], "+", "1"}]}], ",", 
               RowBox[{"jk", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["z", "kk"], "]"}], "[", 
                    RowBox[{"[", "jj", "]"}], "]"}], "\[Equal]", 
                   RowBox[{"xb", "[", 
                    RowBox[{"[", "jk", "]"}], "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"check", "=", "1"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"check", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"If", " ", 
                  RowBox[{"it", "'"}], "s", " ", "an", " ", "internal", " ", 
                  "one"}], ",", " ", 
                 RowBox[{"find", " ", "out", " ", "if", " ", 
                  RowBox[{"it", "'"}], "s", " ", "in", " ", "the", " ", "top",
                   " ", "or", " ", 
                  RowBox[{"bottom", ".", " ", "Then"}], " ", "remove", " ", 
                  RowBox[{"it", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["z", "kk"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["z", "kk"], "]"}], "[", 
                    RowBox[{"[", "jj", "]"}], "]"}]}], "]"}], "\[Equal]", 
                   "0"}], ",", " ", "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{
                    RowBox[{
                    "If", " ", "the", " ", "variable", " ", "is", " ", "in", 
                    " ", "the", " ", "denomianator", " ", 
                    RowBox[{"(", 
                    RowBox[{"ie", " ", "\[Equal]", "0"}], ")"}]}], ",", " ", 
                    RowBox[{"multiply", " ", "it", " ", 
                    RowBox[{"in", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["zext", "kk"], "=", 
                    RowBox[{
                    SubscriptBox["zext", "kk"], " ", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["z", "kk"], "]"}], "[", 
                    RowBox[{"[", "jj", "]"}], "]"}]}]}], ";"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["zext", "kk"], "=", 
                    RowBox[{
                    SubscriptBox["zext", "kk"], "/", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["z", "kk"], "]"}], "[", 
                    RowBox[{"[", "jj", "]"}], "]"}]}]}], ";"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["zext", "kk"], "=", 
                    RowBox[{
                    SubscriptBox["zext", "kk"], "/", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["z", "kk"], "]"}], "[", 
                    RowBox[{"[", "jj", "]"}], "]"}]}]}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             SubscriptBox["zext", "kk"], "\[Equal]", "1"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"NZI", "=", 
              RowBox[{"NZI", "+", "1"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"intz", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"intz", ",", "kk"}], "]"}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Now", " ", "we", " ", "have", " ", "the", " ", 
          SubscriptBox["wext", "i"]}], ",", " ", 
         RowBox[{
          SubscriptBox["zext", "i"], " ", "and", " ", "the", " ", "internal", 
          " ", 
          RowBox[{"lines", "!"}]}]}], "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"ref", "=", 
        RowBox[{
         RowBox[{"MonomialList", "[", "perf", "]"}], "[", 
         RowBox[{"[", "referencenum", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Make", " ", "a", " ", "list", " ", "with", " ", "all", " ", 
         "external", " ", "variables"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"allext", "=", "xb"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Create", " ", "\"\<shift operators\>\""}], ",", 
         RowBox[{
          RowBox[{"i", ".", "e", ".", " ", "products"}], " ", "of", " ", 
          "external", " ", 
          RowBox[{"w", "'"}], "s", " ", "that", " ", "end", " ", "up", " ", 
          "being", " ", "internal"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"extsubs", "=", 
        RowBox[{"Subsets", "[", 
         RowBox[{"Range", "[", 
          RowBox[{
           RowBox[{"IF", "+", "1"}], ",", 
           RowBox[{"NF", "-", "1"}]}], "]"}], "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "All", " ", "the", " ", "subsets", " ", "of", " ", "the", " ", 
         "external", " ", "faces"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"intsubs", "=", 
        RowBox[{"Subsets", "[", 
         RowBox[{"Range", "[", 
          RowBox[{"1", ",", "IF"}], "]"}], "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "All", " ", "the", " ", "subsets", " ", "of", " ", "the", " ", 
         "external", " ", "faces"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"newint", "=", "0"}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "The", " ", "label", " ", "of", " ", "the", " ", "new", " ", 
         "internal", " ", "variables"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"boundaries", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"numm", "=", "1"}], ",", 
         RowBox[{"numm", "<", 
          RowBox[{
           RowBox[{
            RowBox[{"Dimensions", "[", "extsubs", "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], ",", 
         RowBox[{"numm", "++"}], ",", 
         RowBox[{"(*", 
          RowBox[{
          "Go", " ", "through", " ", "all", " ", "the", " ", "subsets"}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Multiply", " ", "together", " ", "the", " ", "variables", " ", 
           "belonging", " ", "to", " ", "a", " ", "specific", " ", "subset"}],
           "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tryshift", "=", 
           RowBox[{"Product", "[", 
            RowBox[{
             SubscriptBox["w", 
              RowBox[{"extsubs", "[", 
               RowBox[{"[", 
                RowBox[{"numm", ",", "demax"}], "]"}], "]"}]], ",", 
             RowBox[{"{", 
              RowBox[{"demax", ",", 
               RowBox[{"Length", "[", 
                RowBox[{"extsubs", "[", 
                 RowBox[{"[", "numm", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"wpower", "=", 
           RowBox[{"extsubs", "[", 
            RowBox[{"[", "numm", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"check", "=", "0"}], ";", " ", 
          RowBox[{"(*", 
           RowBox[{
           "Check", " ", "whether", " ", "this", " ", "variable", " ", "is", 
            " ", "an", " ", "external", " ", "one"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"jj", "=", "1"}], ",", 
            RowBox[{"jj", "<", 
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"Variables", "[", "tryshift", "]"}], "]"}], "+", 
              "1"}]}], ",", 
            RowBox[{"jj", "++"}], ",", 
            RowBox[{"(*", 
             RowBox[{
             "go", " ", "through", " ", "the", " ", "tryshift", " ", 
              "variables"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"jk", "=", "1"}], ",", 
               RowBox[{"jk", "<", 
                RowBox[{
                 RowBox[{"Length", "[", "xb", "]"}], "+", "1"}]}], ",", 
               RowBox[{"jk", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Variables", "[", "tryshift", "]"}], "[", 
                    RowBox[{"[", "jj", "]"}], "]"}], "\[Equal]", 
                   RowBox[{"xb", "[", 
                    RowBox[{"[", "jk", "]"}], "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"check", "=", "1"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"check", "\[Equal]", "0"}], ",", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"If", " ", 
               RowBox[{"it", "'"}], "s", " ", "purely", " ", "internal"}], 
              ",", " ", 
              RowBox[{
              "record", " ", "a", " ", "\"\<new internal variable\>\""}], ",",
               " ", 
              RowBox[{"and", " ", "its", " ", 
               RowBox[{"powers", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              SubscriptBox["wshift", "newint"], "=", "tryshift"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              SubscriptBox["wpow", "newint"], "=", "wpower"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"boundaries", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"boundaries", ",", 
                RowBox[{"{", "wpower", "}"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"newint", "=", 
              RowBox[{"newint", "+", "1"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "Now", " ", "have", " ", "to", " ", "check", " ", "whether", 
               " ", "taking", " ", "this", " ", "internal", " ", "path", " ", 
               "made", " ", "up", " ", "of", " ", "external", " ", "faces", 
               " ", "can", " ", "be", " ", "shifted", " ", "without", " ", 
               "making", " ", "it", " ", 
               RowBox[{"longer", ".", " ", "Then"}], " ", "we", " ", "have", 
               " ", "a", " ", "new", " ", 
               RowBox[{"wshift", "."}]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"ki", "=", "2"}], ",", 
               RowBox[{"ki", "<", 
                RowBox[{
                 RowBox[{"Length", "[", "intsubs", "]"}], "+", "1"}]}], ",", 
               RowBox[{"ki", "++"}], ",", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{
                 "The", " ", "first", " ", "subset", " ", "is", " ", "the", 
                  " ", "zero", " ", "subset"}], ",", " ", 
                 RowBox[{"so", " ", "ignore", " ", "it"}]}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"wtrya", "=", "tryshift"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"el", "=", "1"}], ",", 
                  RowBox[{"el", "<", 
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"intsubs", "[", 
                    RowBox[{"[", "ki", "]"}], "]"}], "]"}], "+", "1"}]}], ",", 
                  RowBox[{"el", "++"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"wtrya", "=", 
                    RowBox[{"wtrya", " ", 
                    SubscriptBox["w", 
                    RowBox[{"intsubs", "[", 
                    RowBox[{"[", 
                    RowBox[{"ki", ",", "el"}], "]"}], "]"}]]}]}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                 "Now", " ", "we", " ", "have", " ", "a", " ", "trial", " ", 
                  RowBox[{"wshift", ".", " ", 
                   RowBox[{"Let", "'"}]}], "s", " ", "check", " ", "that", 
                  " ", "it", " ", "does", " ", "indeed", " ", "act", " ", 
                  "as", " ", "a", " ", "shift", " ", 
                  RowBox[{"operator", "."}]}], "*)"}], "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", "wtrya", "]"}], "]"}], 
                   "\[LessEqual]", 
                   RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", "tryshift", "]"}], "]"}]}], ",",
                   "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["wshift", "newint"], "=", "wtrya"}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    SubscriptBox["wpow", "newint"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{"wpower", ",", 
                    RowBox[{"intsubs", "[", 
                    RowBox[{"[", "ki", "]"}], "]"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"newint", "=", 
                    RowBox[{"newint", "+", "1"}]}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";"}]}], 
           RowBox[{"(*", 
            RowBox[{"Close", " ", "for", " ", "ki"}], "*)"}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Close", " ", "if", " ", "check"}], "\[Equal]", "0"}], 
         "*)"}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"masterspace", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{"NZ", "+", "NF", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", "0"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"fail", "=", "0"}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "The", " ", "number", " ", "of", " ", "cases", " ", "that", " ", 
         "fail"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"guess", "=", "0"}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{
        "The", " ", "number", " ", "of", " ", "times", " ", "we", " ", "had", 
         " ", "to", " ", "guess"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"k", "=", "1"}], ",", 
         RowBox[{"k", "<", 
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"MonomialList", "[", "perf", "]"}], "]"}], "+", "1"}]}], 
         ",", 
         RowBox[{"k", "++"}], ",", " ", 
         RowBox[{"(*", 
          RowBox[{
          "Go", " ", "through", " ", "all", " ", "perfect", " ", 
           "matchings"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"darn", "=", "0"}], ";", 
          RowBox[{"(*", 
           RowBox[{
           "Tells", " ", "you", " ", "whether", " ", "you", " ", "were", " ", 
            "successful", " ", "or", " ", "not"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"retry", "=", "0"}], ";", " ", 
          RowBox[{"(*", 
           RowBox[{
           "Keeps", " ", "track", " ", "of", " ", "whether", " ", "this", " ",
             "is", " ", "the", " ", "first", " ", "time", " ", "or", " ", 
            "not", " ", 
            RowBox[{
             RowBox[{"(", "Goto", ")"}], "."}]}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           SubscriptBox["consider", "k"], "=", 
           RowBox[{
            RowBox[{
             RowBox[{"MonomialList", "[", "perf", "]"}], "[", 
             RowBox[{"[", "k", "]"}], "]"}], "/", "ref"}]}], ";", " ", 
          RowBox[{"(*", 
           RowBox[{"The", " ", "term", " ", "under", " ", "consideration"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{
          "Print", "[", 
           "\"\<---------------------------------------------\>\"", "]"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<k = \>\"", ",", "k", ",", "\"\< , considering \>\"", ",", 
            SubscriptBox["consider", "k"]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Label", "[", "beginext", "]"}], ";", " ", 
          RowBox[{"(*", 
           RowBox[{"For", " ", "the", " ", "Goto", " ", "command"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"Label", "[", "beginagain", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           SubscriptBox["expression", "k"], "=", 
           RowBox[{"{", "}"}]}], ";", " ", 
          RowBox[{"(*", 
           RowBox[{
           "Will", " ", "keep", " ", "track", " ", "of", " ", "which", " ", 
            RowBox[{"w", "'"}], "s", " ", "go", " ", "into", " ", "the", " ", 
            "expression"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           SubscriptBox["zexpression", "k"], "=", 
           RowBox[{"{", "}"}]}], ";", " ", 
          RowBox[{"(*", 
           RowBox[{
           "Will", " ", "keep", " ", "track", " ", "of", " ", "which", " ", 
            RowBox[{"z", "'"}], "s", " ", "go", " ", "into", " ", "the", " ", 
            "expression"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           SubscriptBox["consider", "k"], "=", 
           RowBox[{
            RowBox[{
             RowBox[{"MonomialList", "[", "perf", "]"}], "[", 
             RowBox[{"[", "k", "]"}], "]"}], "/", "ref"}]}], ";", " ", 
          RowBox[{"(*", 
           RowBox[{
           "must", " ", "repeat", " ", "this", " ", "becuase", " ", "of", " ",
             "the", " ", "Labels"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           SubscriptBox["considervar", "k"], "=", 
           RowBox[{"Variables", "[", 
            SubscriptBox["consider", "k"], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "Now", " ", "find", " ", "out", " ", "what", " ", "the", " ", 
            "external", " ", "faces", " ", "and", " ", "external", " ", 
            RowBox[{
             SubscriptBox["z", "i"], "'"}], "s", " ", "are"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<Start external!\>\"", "]"}], ";"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"count", "=", "0"}], ";", " ", 
          RowBox[{"(*", 
           RowBox[{
           "Counter", " ", "needed", " ", "in", " ", "the", " ", "while", " ",
             "loop"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"done", "=", "0"}], ";", " ", 
          RowBox[{"(*", 
           RowBox[{
           "Tells", " ", "you", " ", "when", " ", "to", " ", "quit", " ", 
            "the", " ", "while", " ", "loop"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"done", "==", "0"}], " ", "&&", " ", 
             RowBox[{"IF", "\[NotEqual]", "NF"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"j", "=", 
              RowBox[{
               RowBox[{"Mod", "[", 
                RowBox[{"count", ",", 
                 RowBox[{"NF", "-", "IF", "-", "1"}]}], "]"}], "+", "IF", "+",
                "1"}]}], ";", 
             RowBox[{"(*", 
              RowBox[{"j", " ", "is", " ", "the", " ", 
               SubscriptBox["w", "j"], " ", "under", " ", "consideration"}], 
              "*)"}], "\[IndentingNewLine]", 
             RowBox[{
              SubscriptBox["wextcont", "j"], "=", "0"}], ";", " ", 
             RowBox[{"(*", 
              RowBox[{"Keeps", " ", "track", " ", "of", " ", "whether", " ", 
               SubscriptBox["w", "j"], " ", "is", " ", "included", " ", "or", 
               " ", "not"}], "*)"}], "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 SubscriptBox["consider", "k"], "==", "1"}], " ", "||", 
                RowBox[{
                 SubscriptBox["consider", "k"], "\[Equal]", 
                 RowBox[{"-", "1"}]}]}], " ", ",", " ", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"If", " ", "the", " ", "term", " ", "is", " ", "1"}],
                  ",", " ", 
                 RowBox[{"we", " ", "are", " ", "done"}]}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"darn", "=", "0"}], ";", "\[IndentingNewLine]", 
                RowBox[{"Break", "[", "]"}], ";"}]}], " ", 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"retry", "\[GreaterEqual]", 
                RowBox[{"(", 
                 RowBox[{"6", "patience"}], ")"}]}], ",", 
               RowBox[{"(*", 
                RowBox[{"give", " ", "up"}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"darn", "=", "1"}], ";", "\[IndentingNewLine]", 
                RowBox[{"Break", "[", "]"}], ";"}]}], "\[IndentingNewLine]", 
              "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"retry", ">", "0"}], ",", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"If", " ", 
                  RowBox[{"it", "'"}], "s", " ", "not", " ", "the", " ", 
                  "first", " ", "try", " ", "at", " ", "the", " ", "external",
                   " ", "guys"}], ",", " ", 
                 RowBox[{"mix", " ", "things", " ", "up", " ", "a", " ", 
                  RowBox[{"little", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"EvenQ", "[", "retry", "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", "/", 
                    RowBox[{"Product", "[", 
                    RowBox[{
                    SubscriptBox["w", "oio"], ",", 
                    RowBox[{"{", 
                    RowBox[{"oio", ",", 
                    RowBox[{"NF", "-", "1"}]}], "}"}]}], "]"}]}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"Range", "[", 
                    RowBox[{"NF", "-", "1"}], "]"}]}], "]"}]}], ";"}], 
                  "\[IndentingNewLine]", ",", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    RowBox[{"Product", "[", 
                    RowBox[{
                    SubscriptBox["w", "oio"], ",", 
                    RowBox[{"{", 
                    RowBox[{"oio", ",", 
                    RowBox[{"NF", "-", "1"}]}], "}"}]}], "]"}]}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"-", 
                    RowBox[{"Range", "[", 
                    RowBox[{"NF", "-", "1"}], "]"}]}]}], "]"}]}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                 "Pick", " ", "a", " ", "random", " ", "z", " ", "and", " ", 
                  "a", " ", "random", " ", "w", " ", "and", " ", "plug", " ", 
                  "it", " ", 
                  RowBox[{"in", "."}]}], "*)"}], "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"retry", ">", "2"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"ranw", "=", 
                    RowBox[{"RandomInteger", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"IF", "+", "1"}], ",", 
                    RowBox[{"NF", "-", "1"}]}], "}"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["w", "ranw"]}]}], ";", "\[IndentingNewLine]", 
                   RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "ranw"}], "}"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"NZ", "-", "NZI"}], ">", "0"}], ",", 
                    RowBox[{
                    RowBox[{"ranz", "=", 
                    RowBox[{"RandomInteger", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"NZI", "+", "1"}], ",", "NZ"}], "}"}], "]"}]}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["z", "ranz"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "ranz"}], "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{
                    SubscriptBox["considervar", "k"], "=", 
                    RowBox[{"Variables", "[", 
                    SubscriptBox["consider", "k"], "]"}]}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"count", "\[Equal]", "0"}], ",", 
                  RowBox[{
                   RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<Retried \>\"", ",", "retry", ",", 
                    "\"\< times.\>\""}], "]"}], ";"}]}], "]"}], ";"}], "*)"}],
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"count", "\[Equal]", "300"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{
                 "Print", "[", 
                  "\"\<Start over - even external faces failed.\>\"", "]"}], 
                 ";"}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"retry", "=", 
                 RowBox[{"retry", "+", "1"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"Goto", "[", "beginagain", "]"}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{
               "Check", " ", "if", " ", "wext", " ", "fits", " ", "into", " ", 
                SubscriptBox["consider", "k"]}], ",", " ", 
               RowBox[{
               "by", " ", "checking", " ", "whether", " ", "any", " ", "of", 
                " ", "the", " ", "variables", " ", "in", " ", "wext", " ", 
                "is", " ", "in", " ", 
                RowBox[{
                 SubscriptBox["consider", "k"], "."}]}]}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"i", "=", "1"}], ",", 
               RowBox[{"i", "<", 
                RowBox[{
                 RowBox[{"Length", "[", 
                  SubscriptBox["considervar", "k"], "]"}], "+", "1"}]}], ",", 
               RowBox[{"i", "++"}], ",", 
               RowBox[{"(*", 
                RowBox[{
                "Go", " ", "through", " ", "all", " ", "the", " ", 
                 "variables", " ", "of", " ", 
                 SubscriptBox["consider", "k"]}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"ii", "=", "1"}], ",", 
                  RowBox[{"ii", "<", 
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    SubscriptBox["wext", "j"], "]"}], "]"}], "+", "1"}]}], 
                  ",", 
                  RowBox[{"ii", "++"}], ",", " ", 
                  RowBox[{"(*", 
                   RowBox[{
                   "Go", " ", "through", " ", "all", " ", "the", " ", 
                    "variables", " ", "of", " ", "wext"}], "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["wext", "j"], "]"}], "[", 
                    RowBox[{"[", "ii", "]"}], "]"}], "==", 
                    RowBox[{
                    SubscriptBox["considervar", "k"], "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["wextcont", "j"], "=", "1"}], ";", " ", 
                    RowBox[{"(*", 
                    RowBox[{"It", " ", "is", " ", 
                    RowBox[{"contained", "!"}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"save", "=", "ii"}], ";"}]}], " ", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Remember", " ", "which", " ", "variable", " ", "was", 
                    " ", "contained"}], "*)"}], "\[IndentingNewLine]", "]"}], 
                   ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                SubscriptBox["wextcont", "j"], "==", "1"}], ",", " ", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"Now", " ", "remove", " ", "the", " ", 
                  SubscriptBox["w", "j"], " ", "from", " ", 
                  SubscriptBox["consider", "k"]}], ",", " ", 
                 RowBox[{"and", " ", "record", " ", "this", " ", "into", " ", 
                  SubscriptBox["expression", "k"]}]}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                "Decide", " ", "whether", " ", "to", " ", "divide", " ", "or",
                  " ", 
                 RowBox[{"multiply", "."}]}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["wext", "j"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["wext", "j"], "]"}], "[", 
                    RowBox[{"[", "save", "]"}], "]"}]}], "]"}], "\[Equal]", 
                   "0"}], ",", " ", "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{
                    RowBox[{
                    "If", " ", "the", " ", "variable", " ", "is", " ", "in", 
                    " ", "the", " ", "denomianator", " ", 
                    RowBox[{"(", 
                    RowBox[{"ie", " ", "\[Equal]", "0"}], ")"}]}], ",", " ", 
                    RowBox[{"do", " ", 
                    RowBox[{"\"\<the opposite\>\"", ".", " ", "Otherwise"}]}],
                     ",", " ", 
                    RowBox[{"act", " ", 
                    RowBox[{"\"\<as normal\>\"", "."}]}]}], "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["wext", "j"], "]"}], "[", 
                    RowBox[{"[", "save", "]"}], "]"}]}], "]"}], "\[Equal]", 
                    "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"Here", " ", "is", " ", "the", " ", 
                    RowBox[{"opposite", "!"}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["w", "j"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"{", "j", "}"}]}], "]"}]}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["w", "j"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "j"}], "}"}]}], "]"}]}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["w", "j"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "j"}], "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["wext", "j"], "]"}], "[", 
                    RowBox[{"[", "save", "]"}], "]"}]}], "]"}], "\[Equal]", 
                    "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"Here", " ", "is", " ", "the", " ", 
                    RowBox[{"normal", "!"}]}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["w", "j"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "j"}], "}"}]}], "]"}]}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["w", "j"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"{", "j", "}"}]}], "]"}]}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["w", "j"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"{", "j", "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["wext", "j"], "]"}], "[", 
                    RowBox[{"[", "save", "]"}], "]"}]}], "]"}], "\[Equal]", 
                    "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"Here", " ", "is", " ", "the", " ", 
                    RowBox[{"normal", "!"}]}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["w", "j"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "j"}], "}"}]}], "]"}]}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["w", "j"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"{", "j", "}"}]}], "]"}]}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["w", "j"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"{", "j", "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{
                 SubscriptBox["considervar", "k"], "=", 
                 RowBox[{"Variables", "[", 
                  SubscriptBox["consider", "k"], "]"}]}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";", " ", 
             RowBox[{"(*", 
              RowBox[{"Close", " ", "If"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"Finished", " ", "recording", " ", "the", " ", 
               RowBox[{"operation", "!"}]}], "*)"}], "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"NZ", "-", "NZI"}], ">", "0"}], ",", " ", 
               RowBox[{"(*", 
                RowBox[{
                "If", " ", "we", " ", "have", " ", "external", " ", "z", " ", 
                 "paths"}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"jz", "=", 
                 RowBox[{
                  RowBox[{"Mod", "[", 
                   RowBox[{"count", ",", "NZ"}], "]"}], "+", "1"}]}], ";", 
                RowBox[{"(*", 
                 RowBox[{"jz", " ", "is", " ", "the", " ", 
                  SubscriptBox["z", "jz"], " ", "under", " ", 
                  "consideration"}], "*)"}], "\[IndentingNewLine]", 
                RowBox[{
                 SubscriptBox["zextcont", "jz"], "=", "0"}], ";", " ", 
                RowBox[{"(*", 
                 RowBox[{
                 "Keeps", " ", "track", " ", "of", " ", "whether", " ", 
                  SubscriptBox["z", "j"], " ", "is", " ", "included", " ", 
                  "or", " ", "not"}], "*)"}], "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                 "Now", " ", "check", " ", "if", " ", "zext", " ", "fits", 
                  " ", "into", " ", 
                  RowBox[{
                   SubscriptBox["consider", "k"], "."}]}], "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"i", "=", "1"}], ",", 
                  RowBox[{"i", "<", 
                   RowBox[{
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}], "+", "1"}]}], 
                  ",", 
                  RowBox[{"i", "++"}], ",", 
                  RowBox[{"(*", 
                   RowBox[{
                   "Go", " ", "through", " ", "all", " ", "the", " ", 
                    "variables", " ", "of", " ", 
                    SubscriptBox["consider", "k"]}], "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"ii", "=", "1"}], ",", 
                    RowBox[{"ii", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    SubscriptBox["zext", "jz"], "]"}], "]"}], "+", "1"}]}], 
                    ",", 
                    RowBox[{"ii", "++"}], ",", " ", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Go", " ", "through", " ", "all", " ", "the", " ", 
                    "variables", " ", "of", " ", "zext"}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["zext", "jz"], "]"}], "[", 
                    RowBox[{"[", "ii", "]"}], "]"}], "==", 
                    RowBox[{
                    SubscriptBox["considervar", "k"], "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["zextcont", "jz"], "=", "1"}], ";", " ", 
                    RowBox[{"(*", 
                    RowBox[{"It", " ", "is", " ", 
                    RowBox[{"contained", "!"}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"save2", "=", "ii"}], ";"}]}], " ", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Remember", " ", "which", " ", "variable", " ", "was", 
                    " ", "contained"}], "*)"}], "\[IndentingNewLine]", "]"}], 
                    ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", 
                RowBox[{"a", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["zextcont", "jz"], "==", "1"}], ",", " ", 
                   RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"Now", " ", "remove", " ", "the", " ", 
                    SubscriptBox["z", "jz"], " ", "from", " ", 
                    SubscriptBox["consider", "k"]}], ",", " ", 
                    RowBox[{
                    "and", " ", "record", " ", "this", " ", "into", " ", 
                    SubscriptBox["zexpression", "k"]}]}], "*)"}], 
                   "\[IndentingNewLine]", 
                   RowBox[{"(*", 
                    RowBox[{
                    "Decide", " ", "whether", " ", "to", " ", "divide", " ", 
                    "or", " ", 
                    RowBox[{"multiply", "."}]}], "*)"}], 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["zext", "jz"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["zext", "jz"], "]"}], "[", 
                    RowBox[{"[", "save2", "]"}], "]"}]}], "]"}], "\[Equal]", 
                    "0"}], ",", " ", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{
                    "If", " ", "the", " ", "variable", " ", "is", " ", "in", 
                    " ", "the", " ", "denomianator", " ", 
                    RowBox[{"(", 
                    RowBox[{"ie", " ", "\[Equal]", "0"}], ")"}]}], ",", " ", 
                    RowBox[{"do", " ", 
                    RowBox[{"\"\<the opposite\>\"", ".", " ", "Otherwise"}]}],
                     ",", " ", 
                    RowBox[{"act", " ", 
                    RowBox[{"\"\<as normal\>\"", "."}]}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["zext", "jz"], "]"}], "[", 
                    RowBox[{"[", "save2", "]"}], "]"}]}], "]"}], "\[Equal]", 
                    "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"Here", " ", "is", " ", "the", " ", 
                    RowBox[{"opposite", "!"}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["z", "jz"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], ",", 
                    RowBox[{"{", "jz", "}"}]}], "]"}]}], ";"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["z", "jz"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "jz"}], "}"}]}], "]"}]}], ";"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["z", "jz"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "jz"}], "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["zext", "jz"], "]"}], "[", 
                    RowBox[{"[", "save2", "]"}], "]"}]}], "]"}], "\[Equal]", 
                    "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"Here", " ", "is", " ", "the", " ", 
                    RowBox[{"normal", "!"}]}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["z", "jz"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "jz"}], "}"}]}], "]"}]}], ";"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["z", "jz"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], ",", 
                    RowBox[{"{", "jz", "}"}]}], "]"}]}], ";"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["z", "jz"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], ",", 
                    RowBox[{"{", "jz", "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["zext", "jz"], "]"}], "[", 
                    RowBox[{"[", "save2", "]"}], "]"}]}], "]"}], "\[Equal]", 
                    "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"Here", " ", "is", " ", "the", " ", 
                    RowBox[{"normal", "!"}]}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["z", "jz"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "jz"}], "}"}]}], "]"}]}], ";"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["z", "jz"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], ",", 
                    RowBox[{"{", "jz", "}"}]}], "]"}]}], ";"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["z", "jz"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], ",", 
                    RowBox[{"{", "jz", "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["considervar", "k"], "=", 
                    RowBox[{"Variables", "[", 
                    SubscriptBox["consider", "k"], "]"}]}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}]}], ";"}]}], " ", 
              RowBox[{"(*", 
               RowBox[{"Close", " ", "If"}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{"Finished", " ", "recording", " ", "the", " ", 
                RowBox[{"operation", "!"}]}], "*)"}], "\[IndentingNewLine]", 
              "]"}], ";", " ", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{
                RowBox[{"Close", " ", "if", " ", "NZ"}], "-", "NZI"}], ">", 
               "0"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{
               "If", " ", "there", " ", "are", " ", "no", " ", "more", " ", 
                "wext", " ", "to", " ", "fit", " ", "in"}], ",", " ", 
               RowBox[{"we", " ", "are", " ", 
                RowBox[{"done", ".", " ", "Check"}], " ", 
                RowBox[{"this", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"done", "=", "1"}], ";", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"ij", "=", "1"}], ",", 
               RowBox[{"ij", "<", 
                RowBox[{
                 RowBox[{"Length", "[", "allext", "]"}], "+", "1"}]}], ",", 
               RowBox[{"ij", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"ji", "=", "1"}], ",", 
                  RowBox[{"ji", "<", 
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    SubscriptBox["consider", "k"], "]"}], "]"}], "+", "1"}]}],
                   ",", 
                  RowBox[{"ji", "++"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"allext", "[", 
                    RowBox[{"[", "ij", "]"}], "]"}], "\[Equal]", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["consider", "k"], "]"}], "[", 
                    RowBox[{"[", "ji", "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"done", "=", "0"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "Now", " ", "we", " ", "know", " ", "if", " ", "we", " ", "are",
                " ", "done", " ", "or", " ", "not"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"count", "=", 
              RowBox[{"count", "+", "1"}]}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";", " ", 
          RowBox[{"(*", 
           RowBox[{"Close", " ", "while", " ", "loop"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "Now", " ", "we", " ", "have", " ", "the", " ", "external", " ", 
            RowBox[{"faces", "!"}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"senttointernal", "=", 
           SubscriptBox["consider", "k"]}], ";", 
          RowBox[{"(*", 
           RowBox[{
           "Record", " ", "what", " ", "we", " ", "sent", " ", "to", " ", 
            "the", " ", "internal", " ", 
            RowBox[{"faces", "."}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"sentexpression", "=", 
           SubscriptBox["expression", "k"]}], ";", "\[IndentingNewLine]", 
          RowBox[{"zsentexpression", "=", 
           SubscriptBox["zexpression", "k"]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "Now", " ", "find", " ", "out", " ", "what", " ", "the", " ", 
            "internal", " ", "faces", " ", "and", " ", "internal", " ", 
            RowBox[{
             SubscriptBox["z", "i"], "'"}], "s", " ", "are"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<Start internal!\>\"", "]"}], ";"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"count", "=", "0"}], ";", " ", 
          RowBox[{"(*", 
           RowBox[{
           "Counter", " ", "needed", " ", "in", " ", "the", " ", "while", " ",
             "loop"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"IF", ">", "0"}], "||", 
             RowBox[{"NZI", ">", "0"}], "||", 
             RowBox[{"newint", ">", "1"}]}], ",", 
            RowBox[{"(*", 
             RowBox[{
             "Keeps", " ", "going", " ", "until", " ", "we", " ", "get", " ", 
              "1."}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 SubscriptBox["consider", "k"], "==", "1"}], " ", "||", 
                RowBox[{
                 SubscriptBox["consider", "k"], "\[Equal]", 
                 RowBox[{"-", "1"}]}]}], " ", ",", " ", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"If", " ", "the", " ", "term", " ", "is", " ", "1"}],
                  ",", " ", 
                 RowBox[{"we", " ", "are", " ", "done"}]}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"count", "\[NotEqual]", "300"}], ",", 
                  RowBox[{
                   RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<Found after \>\"", ",", "count", ",", 
                    "\"\< operations.\>\""}], "]"}], ";"}]}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"darn", "=", "0"}], ";", "\[IndentingNewLine]", 
                RowBox[{"Break", "[", "]"}], ";"}]}], " ", 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "Now", " ", "check", " ", "if", " ", "z", " ", "fits", " ", 
               "into", " ", 
               RowBox[{
                SubscriptBox["consider", "k"], "."}]}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"NZI", ">", "0"}], ",", 
               RowBox[{"(*", 
                RowBox[{"Check", " ", "internal", " ", 
                 RowBox[{
                  SubscriptBox["z", "i"], "'"}], "s"}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"jz", "=", 
                 RowBox[{
                  RowBox[{"Mod", "[", 
                   RowBox[{"count", ",", "NZI"}], "]"}], "+", "1"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 SubscriptBox["zintcont", "jz"], "=", "0"}], ";", " ", 
                RowBox[{"(*", 
                 RowBox[{
                 "Keeps", " ", "track", " ", "of", " ", "whether", " ", 
                  SubscriptBox["z", "j"], " ", "is", " ", "included", " ", 
                  "or", " ", "not"}], "*)"}], "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    SubscriptBox["consider", "k"], "==", "1"}], " ", "||", 
                   RowBox[{
                    SubscriptBox["consider", "k"], "\[Equal]", 
                    RowBox[{"-", "1"}]}]}], " ", ",", " ", 
                  RowBox[{"(*", 
                   RowBox[{
                    RowBox[{
                    "If", " ", "the", " ", "term", " ", "is", " ", "1"}], ",",
                     " ", 
                    RowBox[{"we", " ", "are", " ", "done"}]}], "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"darn", "=", "0"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"Break", "[", "]"}], ";"}]}], " ", 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"ii", "=", "1"}], ",", 
                  RowBox[{"ii", "<", 
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    SubscriptBox["z", "jz"], "]"}], "]"}], "+", "1"}]}], ",", 
                  RowBox[{"ii", "++"}], ",", " ", 
                  RowBox[{"(*", 
                   RowBox[{
                   "Go", " ", "through", " ", "all", " ", "the", " ", 
                    "variables", " ", "of", " ", 
                    SubscriptBox["z", "j"]}], "*)"}], "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"i", "=", "1"}], ",", 
                    RowBox[{"i", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}], "+", "1"}]}], 
                    ",", 
                    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Go", " ", "through", " ", "all", " ", "the", " ", 
                    "variables", " ", "of", " ", 
                    SubscriptBox["consider", "k"]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["z", "jz"], "]"}], "[", 
                    RowBox[{"[", "ii", "]"}], "]"}], "==", 
                    RowBox[{
                    SubscriptBox["considervar", "k"], "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["zintcont", "jz"], "=", "1"}], ";", " ", 
                    RowBox[{"(*", 
                    RowBox[{"It", " ", "is", " ", 
                    RowBox[{"contained", "!"}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"save2", "=", "ii"}], ";"}]}], " ", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Remember", " ", "which", " ", "variable", " ", "was", 
                    " ", "contained"}], "*)"}], "\[IndentingNewLine]", "]"}], 
                    ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   SubscriptBox["zintcont", "jz"], "==", "1"}], ",", " ", 
                  RowBox[{"(*", 
                   RowBox[{
                    RowBox[{"Now", " ", "remove", " ", "the", " ", 
                    SubscriptBox["z", "jz"], " ", "from", " ", 
                    SubscriptBox["consider", "k"]}], ",", " ", 
                    RowBox[{
                    "and", " ", "record", " ", "this", " ", "into", " ", 
                    SubscriptBox["expression", "k"]}]}], "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{
                   "Decide", " ", "whether", " ", "to", " ", "divide", " ", 
                    "or", " ", 
                    RowBox[{"multiply", "."}]}], "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["z", "jz"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["z", "jz"], "]"}], "[", 
                    RowBox[{"[", "save2", "]"}], "]"}]}], "]"}], "\[Equal]", 
                    "0"}], ",", " ", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{
                    "If", " ", "the", " ", "variable", " ", "is", " ", "in", 
                    " ", "the", " ", "denomianator", " ", 
                    RowBox[{"(", 
                    RowBox[{"ie", " ", "\[Equal]", "0"}], ")"}]}], ",", " ", 
                    RowBox[{"do", " ", 
                    RowBox[{"\"\<the opposite\>\"", ".", " ", "Otherwise"}]}],
                     ",", " ", 
                    RowBox[{"act", " ", 
                    RowBox[{"\"\<as normal\>\"", "."}]}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["z", "jz"], "]"}], "[", 
                    RowBox[{"[", "save2", "]"}], "]"}]}], "]"}], "\[Equal]", 
                    "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"Here", " ", "is", " ", "the", " ", 
                    RowBox[{"opposite", "!"}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["z", "jz"]}], "]"}], "]"}], "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["z", "jz"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], ",", 
                    RowBox[{"{", "jz", "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["z", "jz"]}], "]"}], "]"}], "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["z", "jz"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "jz"}], "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["z", "jz"]}], "]"}], "]"}], "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["z", "jz"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "jz"}], "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["z", "jz"], "]"}], "[", 
                    RowBox[{"[", "save2", "]"}], "]"}]}], "]"}], "\[Equal]", 
                    "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"Here", " ", "is", " ", "the", " ", 
                    RowBox[{"normal", "!"}]}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["z", "jz"]}], "]"}], "]"}], "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["z", "jz"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "jz"}], "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["z", "jz"]}], "]"}], "]"}], "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["z", "jz"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], ",", 
                    RowBox[{"{", "jz", "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["z", "jz"]}], "]"}], "]"}], "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["z", "jz"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], ",", 
                    RowBox[{"{", "jz", "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["z", "jz"], "]"}], "[", 
                    RowBox[{"[", "save2", "]"}], "]"}]}], "]"}], "\[Equal]", 
                    "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"Here", " ", "is", " ", "the", " ", 
                    RowBox[{"normal", "!"}]}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["z", "jz"]}], "]"}], "]"}], "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["z", "jz"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "jz"}], "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["z", "jz"]}], "]"}], "]"}], "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["z", "jz"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], ",", 
                    RowBox[{"{", "jz", "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["z", "jz"]}], "]"}], "]"}], "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["z", "jz"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], ",", 
                    RowBox[{"{", "jz", "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{
                    SubscriptBox["considervar", "k"], "=", 
                    RowBox[{"Variables", "[", 
                    SubscriptBox["consider", "k"], "]"}]}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], " ", 
              RowBox[{"(*", 
               RowBox[{"Close", " ", "If"}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{"Finished", " ", "recording", " ", "the", " ", 
                RowBox[{"operation", "!"}]}], "*)"}], "\[IndentingNewLine]", 
              "]"}], ";", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"Close", " ", "if", " ", "NZI"}], ">", "0"}], "*)"}], 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 SubscriptBox["consider", "k"], "==", "1"}], " ", "||", 
                RowBox[{
                 SubscriptBox["consider", "k"], "\[Equal]", 
                 RowBox[{"-", "1"}]}]}], " ", ",", " ", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"If", " ", "the", " ", "term", " ", "is", " ", "1"}],
                  ",", " ", 
                 RowBox[{"we", " ", "are", " ", "done"}]}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{
                 "\"\<Found after \>\"", ",", "count", ",", 
                  "\"\< operations.\>\""}], "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"darn", "=", "0"}], ";", "\[IndentingNewLine]", 
                RowBox[{"Break", "[", "]"}], ";"}]}], " ", 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "Now", " ", "check", " ", "if", " ", "wshift", " ", "fits", " ",
                "into", " ", 
               RowBox[{
                SubscriptBox["consider", "k"], "."}]}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"newint", ">", "1"}], ",", 
               RowBox[{"(*", 
                RowBox[{
                "If", " ", "we", " ", "have", " ", "any", " ", "wshift", " ", 
                 "to", " ", "consider"}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"jsh", "=", 
                 RowBox[{
                  RowBox[{"Mod", "[", 
                   RowBox[{"count", ",", 
                    RowBox[{"newint", "-", "1"}]}], "]"}], "+", "1"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 SubscriptBox["wshiftcont", "jsh"], "=", "0"}], ";", " ", 
                RowBox[{"(*", 
                 RowBox[{
                 "Keeps", " ", "track", " ", "of", " ", "whether", " ", 
                  SubscriptBox["wshift", "j"], " ", "is", " ", "included", 
                  " ", "or", " ", "not"}], "*)"}], "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    SubscriptBox["consider", "k"], "==", "1"}], " ", "||", 
                   RowBox[{
                    SubscriptBox["consider", "k"], "\[Equal]", 
                    RowBox[{"-", "1"}]}]}], " ", ",", " ", 
                  RowBox[{"(*", 
                   RowBox[{
                    RowBox[{
                    "If", " ", "the", " ", "term", " ", "is", " ", "1"}], ",",
                     " ", 
                    RowBox[{"we", " ", "are", " ", "done"}]}], "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"darn", "=", "0"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"Break", "[", "]"}], ";"}]}], " ", 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"ii", "=", "1"}], ",", 
                  RowBox[{"ii", "<", 
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    SubscriptBox["wshift", "jsh"], "]"}], "]"}], "+", "1"}]}],
                   ",", 
                  RowBox[{"ii", "++"}], ",", " ", 
                  RowBox[{"(*", 
                   RowBox[{
                   "Go", " ", "through", " ", "all", " ", "the", " ", 
                    "variables", " ", "of", " ", 
                    SubscriptBox["wshift", "j"]}], "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"i", "=", "1"}], ",", 
                    RowBox[{"i", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}], "+", "1"}]}], 
                    ",", 
                    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Go", " ", "through", " ", "all", " ", "the", " ", 
                    "variables", " ", "of", " ", 
                    SubscriptBox["consider", "k"]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["wshift", "jsh"], "]"}], "[", 
                    RowBox[{"[", "ii", "]"}], "]"}], "==", 
                    RowBox[{
                    SubscriptBox["considervar", "k"], "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["wshiftcont", "jsh"], "=", "1"}], ";", " ", 
                    RowBox[{"(*", 
                    RowBox[{"It", " ", "is", " ", 
                    RowBox[{"contained", "!"}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"save3", "=", "ii"}], ";"}]}], " ", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Remember", " ", "which", " ", "variable", " ", "was", 
                    " ", "contained"}], "*)"}], "\[IndentingNewLine]", "]"}], 
                    ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   SubscriptBox["wshiftcont", "jsh"], "==", "1"}], ",", " ", 
                  RowBox[{"(*", 
                   RowBox[{
                    RowBox[{"Now", " ", "remove", " ", "the", " ", 
                    SubscriptBox["wshift", "jz"], " ", "from", " ", 
                    SubscriptBox["consider", "k"]}], ",", " ", 
                    RowBox[{
                    "and", " ", "record", " ", "this", " ", "into", " ", 
                    SubscriptBox["expression", "k"]}]}], "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{
                   "Decide", " ", "whether", " ", "to", " ", "divide", " ", 
                    "or", " ", 
                    RowBox[{"multiply", "."}]}], "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["wshift", "jsh"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["wshift", "jsh"], "]"}], "[", 
                    RowBox[{"[", "save3", "]"}], "]"}]}], "]"}], "\[Equal]", 
                    "0"}], ",", " ", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{
                    "If", " ", "the", " ", "variable", " ", "is", " ", "in", 
                    " ", "the", " ", "denomianator", " ", 
                    RowBox[{"(", 
                    RowBox[{"ie", " ", "\[Equal]", "0"}], ")"}]}], ",", " ", 
                    RowBox[{"do", " ", 
                    RowBox[{"\"\<the opposite\>\"", ".", " ", "Otherwise"}]}],
                     ",", " ", 
                    RowBox[{"act", " ", 
                    RowBox[{"\"\<as normal\>\"", "."}]}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["wshift", "jsh"], "]"}], "[", 
                    RowBox[{"[", "save3", "]"}], "]"}]}], "]"}], "\[Equal]", 
                    "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"Here", " ", "is", " ", "the", " ", 
                    RowBox[{"opposite", "!"}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["wshift", "jsh"]}], "]"}], "]"}], 
                    "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["wshift", "jsh"]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    SubscriptBox["wpow", "jsh"]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["wshift", "jsh"]}], "]"}], "]"}], 
                    "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["wshift", "jsh"]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"-", 
                    SubscriptBox["wpow", "jsh"]}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["wshift", "jsh"]}], "]"}], "]"}], 
                    "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["wshift", "jsh"]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"-", 
                    SubscriptBox["wpow", "jsh"]}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["wshift", "jz"], "]"}], "[", 
                    RowBox[{"[", "save3", "]"}], "]"}]}], "]"}], "\[Equal]", 
                    "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"Here", " ", "is", " ", "the", " ", 
                    RowBox[{"normal", "!"}]}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["wshift", "jsh"]}], "]"}], "]"}], 
                    "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["wshift", "jsh"]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"-", 
                    SubscriptBox["wpow", "jsh"]}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["wshift", "jsh"]}], "]"}], "]"}], 
                    "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["wshift", "jsh"]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    SubscriptBox["wpow", "jsh"]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["wshift", "jsh"]}], "]"}], "]"}], 
                    "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["wshift", "jsh"]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    SubscriptBox["wpow", "jsh"]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["wshift", "jsh"], "]"}], "[", 
                    RowBox[{"[", "save3", "]"}], "]"}]}], "]"}], "\[Equal]", 
                    "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"Here", " ", "is", " ", "the", " ", 
                    RowBox[{"normal", "!"}]}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["wshift", "jsh"]}], "]"}], "]"}], 
                    "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["wshift", "jsh"]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"-", 
                    SubscriptBox["wpow", "jsh"]}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["wshift", "jsh"]}], "]"}], "]"}], 
                    "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["wshift", "jsh"]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    SubscriptBox["wpow", "jsh"]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["wshift", "jsh"]}], "]"}], "]"}], 
                    "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["wshift", "jsh"]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    SubscriptBox["wpow", "jsh"]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
                    "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{
                    SubscriptBox["considervar", "k"], "=", 
                    RowBox[{"Variables", "[", 
                    SubscriptBox["consider", "k"], "]"}]}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], " ", 
              RowBox[{"(*", 
               RowBox[{"Close", " ", "If"}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{"Finished", " ", "recording", " ", "the", " ", 
                RowBox[{"operation", "!"}]}], "*)"}], "\[IndentingNewLine]", 
              "]"}], ";", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"Close", " ", "if", " ", "newint"}], ">", "0"}], 
              "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 SubscriptBox["consider", "k"], "==", "1"}], " ", "||", 
                RowBox[{
                 SubscriptBox["consider", "k"], "\[Equal]", 
                 RowBox[{"-", "1"}]}]}], " ", ",", " ", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"If", " ", "the", " ", "term", " ", "is", " ", "1"}],
                  ",", " ", 
                 RowBox[{"we", " ", "are", " ", "done"}]}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{
                 "\"\<Found after \>\"", ",", "count", ",", 
                  "\"\< operations.\>\""}], "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"darn", "=", "0"}], ";", "\[IndentingNewLine]", 
                RowBox[{"Break", "[", "]"}], ";"}]}], " ", 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"IF", ">", "0"}], ",", " ", 
               RowBox[{"(*", 
                RowBox[{"Check", " ", "internal", " ", "faces"}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"j", "=", 
                 RowBox[{
                  RowBox[{"Mod", "[", 
                   RowBox[{"count", ",", "IF"}], "]"}], "+", "1"}]}], ";", 
                RowBox[{"(*", 
                 RowBox[{"j", " ", "is", " ", "the", " ", 
                  SubscriptBox["w", "j"], " ", "under", " ", 
                  "consideration"}], "*)"}], "\[IndentingNewLine]", 
                RowBox[{
                 SubscriptBox["wintcont", "j"], "=", "0"}], ";", " ", 
                RowBox[{"(*", 
                 RowBox[{
                 "Keeps", " ", "track", " ", "of", " ", "whether", " ", 
                  SubscriptBox["w", "j"], " ", "is", " ", "included", " ", 
                  "or", " ", "not"}], "*)"}], "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{
                  "Check", " ", "if", " ", "w", " ", "fits", " ", "into", " ", 
                   SubscriptBox["consider", "k"]}], ",", " ", 
                  RowBox[{
                  "by", " ", "checking", " ", "whether", " ", "any", " ", 
                   "of", " ", "the", " ", "variables", " ", "in", " ", 
                   SubscriptBox["w", "j"], " ", "is", " ", "in", " ", 
                   RowBox[{
                    SubscriptBox["consider", "k"], "."}]}]}], "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"i", "=", "1"}], ",", 
                  RowBox[{"i", "<", 
                   RowBox[{
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}], "+", "1"}]}], 
                  ",", 
                  RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"ii", "=", "1"}], ",", 
                    RowBox[{"ii", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    SubscriptBox["w", "j"], "]"}], "]"}], "+", "1"}]}], ",", 
                    RowBox[{"ii", "++"}], ",", " ", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Go", " ", "through", " ", "all", " ", "the", " ", 
                    "variables", " ", "of", " ", 
                    SubscriptBox["w", "j"]}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Go", " ", "through", " ", "all", " ", "the", " ", 
                    "variables", " ", "of", " ", 
                    SubscriptBox["consider", "k"]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["w", "j"], "]"}], "[", 
                    RowBox[{"[", "ii", "]"}], "]"}], "==", 
                    RowBox[{
                    SubscriptBox["considervar", "k"], "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["wintcont", "j"], "=", "1"}], ";", " ", 
                    RowBox[{"(*", 
                    RowBox[{"It", " ", "is", " ", 
                    RowBox[{"contained", "!"}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"save", "=", "ii"}], ";"}]}], " ", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Remember", " ", "which", " ", "variable", " ", "was", 
                    " ", "contained"}], "*)"}], "\[IndentingNewLine]", "]"}], 
                    ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   SubscriptBox["wintcont", "j"], "==", "1"}], ",", " ", 
                  RowBox[{"(*", 
                   RowBox[{
                    RowBox[{"Now", " ", "remove", " ", "the", " ", 
                    SubscriptBox["w", "j"], " ", "from", " ", 
                    SubscriptBox["consider", "k"]}], ",", " ", 
                    RowBox[{
                    "and", " ", "record", " ", "this", " ", "into", " ", 
                    SubscriptBox["expression", "k"]}]}], "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{
                   "Decide", " ", "whether", " ", "to", " ", "divide", " ", 
                    "or", " ", 
                    RowBox[{"multiply", "."}]}], "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["w", "j"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["w", "j"], "]"}], "[", 
                    RowBox[{"[", "save", "]"}], "]"}]}], "]"}], "\[Equal]", 
                    "0"}], ",", " ", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{
                    "If", " ", "the", " ", "variable", " ", "is", " ", "in", 
                    " ", "the", " ", "denomianator", " ", 
                    RowBox[{"(", 
                    RowBox[{"ie", " ", "\[Equal]", "0"}], ")"}]}], ",", " ", 
                    RowBox[{"do", " ", 
                    RowBox[{"\"\<the opposite\>\"", ".", " ", "Otherwise"}]}],
                     ",", " ", 
                    RowBox[{"act", " ", 
                    RowBox[{"\"\<as normal\>\"", "."}]}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["w", "j"], "]"}], "[", 
                    RowBox[{"[", "save", "]"}], "]"}]}], "]"}], "\[Equal]", 
                    "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"Here", " ", "is", " ", "the", " ", 
                    RowBox[{"opposite", "!"}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["w", "j"]}], "]"}], "]"}], "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["w", "j"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"{", "j", "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["w", "j"]}], "]"}], "]"}], "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["w", "j"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "j"}], "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["w", "j"]}], "]"}], "]"}], "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["w", "j"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "j"}], "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["w", "j"], "]"}], "[", 
                    RowBox[{"[", "save", "]"}], "]"}]}], "]"}], "\[Equal]", 
                    "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"Here", " ", "is", " ", "the", " ", 
                    RowBox[{"normal", "!"}]}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["w", "j"]}], "]"}], "]"}], "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["w", "j"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "j"}], "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["w", "j"]}], "]"}], "]"}], "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["w", "j"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"{", "j", "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["w", "j"]}], "]"}], "]"}], "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["w", "j"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"{", "j", "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["w", "j"], "]"}], "[", 
                    RowBox[{"[", "save", "]"}], "]"}]}], "]"}], "\[Equal]", 
                    "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"Here", " ", "is", " ", "the", " ", 
                    RowBox[{"normal", "!"}]}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["w", "j"]}], "]"}], "]"}], "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["w", "j"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "j"}], "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["w", "j"]}], "]"}], "]"}], "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["w", "j"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"{", "j", "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["w", "j"]}], "]"}], "]"}], "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["w", "j"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"{", "j", "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{
                    SubscriptBox["considervar", "k"], "=", 
                    RowBox[{"Variables", "[", 
                    SubscriptBox["consider", "k"], "]"}]}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], " ", 
              RowBox[{"(*", 
               RowBox[{"Close", " ", "If"}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{"Finished", " ", "recording", " ", "the", " ", 
                RowBox[{"operation", "!"}]}], "*)"}], "\[IndentingNewLine]", 
              "]"}], ";", " ", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"Close", " ", "if", " ", "IF"}], ">", "0"}], "*)"}], 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"count", "=", 
              RowBox[{"count", "+", "1"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"count", "\[Equal]", "300"}], "&&", 
                RowBox[{"retry", "<", 
                 RowBox[{"(", 
                  RowBox[{"6", "patience"}], ")"}]}]}], ",", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{
                 "If", " ", "it", " ", "failed", " ", "but", " ", "it", " ", 
                  "could", " ", "be", " ", "our", " ", "fault"}], ",", " ", 
                 RowBox[{"try", " ", "to", " ", "guess", " ", "it", " ", 
                  RowBox[{"randomly", "."}]}]}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"powers", "=", 
                 RowBox[{"Array", "[", 
                  RowBox[{"tem", ",", 
                   RowBox[{"IF", "+", "NZI"}]}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                 "The", " ", "list", " ", "that", " ", "contains", " ", "all",
                   " ", "the", " ", "powers"}], "*)"}], "\[IndentingNewLine]", 
                RowBox[{"score", "=", "0"}], ";", "\[IndentingNewLine]", 
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"bore", "=", "1"}], ",", 
                  RowBox[{"bore", "<", 
                   RowBox[{
                    SuperscriptBox["10", 
                    RowBox[{"(", 
                    RowBox[{"patience", "+", "1"}], ")"}]], "+", "1"}]}], ",", 
                  RowBox[{"bore", "++"}], ",", 
                  RowBox[{"(*", 
                   RowBox[{"Try", " ", "lots", " ", "of", " ", "times"}], 
                   "*)"}], "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["consider", "k"], "=", "senttointernal"}], 
                   ";", 
                   RowBox[{"(*", 
                    RowBox[{
                    "Each", " ", "time", " ", "start", " ", "again", " ", 
                    "with", " ", "what", " ", "we", " ", "were", " ", 
                    "given"}], "*)"}], "\[IndentingNewLine]", 
                   RowBox[{
                    SubscriptBox["expression", "k"], "=", "sentexpression"}], 
                   ";", "\[IndentingNewLine]", 
                   RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    "zsentexpression"}], ";", "\[IndentingNewLine]", 
                   "\[IndentingNewLine]", 
                   RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"cha", "=", "1"}], ",", 
                    RowBox[{"cha", "<", 
                    RowBox[{"IF", "+", "NZI", "+", "1"}]}], ",", 
                    RowBox[{"cha", "++"}], ",", 
                    RowBox[{"(*", 
                    RowBox[{"Assign", " ", "random", " ", "powers"}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"powers", "[", 
                    RowBox[{"[", "cha", "]"}], "]"}], "=", 
                    RowBox[{"RandomInteger", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "2"}], ",", "2"}], "}"}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"pow", "=", "1"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"(*", 
                    RowBox[{
                    "Use", " ", "the", " ", "powers", " ", "for", " ", "the", 
                    " ", 
                    RowBox[{"w", "'"}], "s"}], "*)"}], "\[IndentingNewLine]", 
                   RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"inw", "=", "1"}], ",", 
                    RowBox[{"inw", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{"inw", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SuperscriptBox[
                    SubscriptBox["w", "inw"], 
                    RowBox[{"powers", "[", 
                    RowBox[{"[", "pow", "]"}], "]"}]]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"ad", "=", "1"}], ",", 
                    RowBox[{"ad", "<", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"powers", "[", 
                    RowBox[{"[", "pow", "]"}], "]"}], "]"}], "+", "1"}]}], 
                    ",", 
                    RowBox[{"ad", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "inw"}], " ", 
                    RowBox[{"Sign", "[", 
                    RowBox[{"powers", "[", 
                    RowBox[{"[", "pow", "]"}], "]"}], "]"}]}], "}"}]}], 
                    "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"pow", "=", 
                    RowBox[{"pow", "+", "1"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"(*", 
                    RowBox[{
                    "Use", " ", "the", " ", "powers", " ", "for", " ", "the", 
                    " ", 
                    RowBox[{"z", "'"}], "s"}], "*)"}], "\[IndentingNewLine]", 
                   RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"inw", "=", "1"}], ",", 
                    RowBox[{"inw", "<", 
                    RowBox[{"NZI", "+", "1"}]}], ",", 
                    RowBox[{"inw", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SuperscriptBox[
                    SubscriptBox["z", "inw"], 
                    RowBox[{"powers", "[", 
                    RowBox[{"[", "pow", "]"}], "]"}]]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"ad", "=", "1"}], ",", 
                    RowBox[{"ad", "<", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"powers", "[", 
                    RowBox[{"[", "pow", "]"}], "]"}], "]"}], "+", "1"}]}], 
                    ",", 
                    RowBox[{"ad", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "inw"}], " ", 
                    RowBox[{"Sign", "[", 
                    RowBox[{"powers", "[", 
                    RowBox[{"[", "pow", "]"}], "]"}], "]"}]}], "}"}]}], 
                    "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"pow", "=", 
                    RowBox[{"pow", "+", "1"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "==", "1"}], " ", "||", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "\[Equal]", 
                    RowBox[{"-", "1"}]}]}], " ", ",", " ", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{
                    "If", " ", "the", " ", "term", " ", "is", " ", "1"}], ",",
                     " ", 
                    RowBox[{"we", " ", "are", " ", "done"}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<Guessed it! Attempted \>\"", ",", "bore", ",", 
                    "\"\< times.\>\""}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"darn", "=", "0"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"guess", "=", 
                    RowBox[{"guess", "+", "1"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"score", "=", "1"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"Break", "[", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"score", "\[Equal]", "0"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"retry", "=", 
                    RowBox[{"retry", "+", "1"}]}], ";", "\[IndentingNewLine]", 
                   RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"Print", "[", "\"\<Sent it away!\>\"", "]"}], 
                    ";"}], "*)"}], "\[IndentingNewLine]", 
                   RowBox[{"Goto", "[", "beginext", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"count", "\[Equal]", "300"}], "&&", 
                RowBox[{"retry", "\[GreaterEqual]", 
                 RowBox[{"(", 
                  RowBox[{"6", "patience"}], ")"}]}]}], ",", 
               RowBox[{"(*", 
                RowBox[{
                "If", " ", "it", " ", "really", " ", "fails", " ", "just", 
                 " ", "give", " ", "up"}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                "Print", "[", 
                 "\"\<Failed methodically, failed to guess it.\>\"", "]"}], 
                ";", "\[IndentingNewLine]", 
                RowBox[{"darn", "=", "1"}], ";", "\[IndentingNewLine]", 
                RowBox[{"Break", "[", "]"}], ";"}]}], "\[IndentingNewLine]", 
              "]"}], ";"}]}], " ", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", "]"}], ";", " ", 
          RowBox[{"(*", 
           RowBox[{"Close", " ", "while", " ", "loop"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "Now", " ", "we", " ", "have", " ", "the", " ", "internal", " ", 
            "faces", " ", "and", " ", 
            RowBox[{
             SubscriptBox["z", "i"], "'"}], 
            RowBox[{"s", " ", "!"}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"darn", "\[Equal]", "1"}], "&&", 
             RowBox[{"patience", "\[GreaterEqual]", "4"}]}], ",", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"If", " ", "the", " ", "guess", " ", "fails"}], ",", 
              " ", 
              RowBox[{"do", " ", "it", " ", "methodically"}]}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
             "Print", "[", 
              "\"\<Since patience\[GreaterEqual]4 , try exhausting all \
possibilities (within reason).\>\"", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"powarray", "=", 
              RowBox[{"Tuples", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "0", ",", "1"}], "}"}], ",", 
                RowBox[{"NZ", "+", "NF", "-", "1"}]}], "]"}]}], ";", " ", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{
               "contains", " ", "all", " ", "the", " ", "possibilities"}], 
               ",", " ", 
               RowBox[{
                RowBox[{"with", " ", "powers", " ", "between"}], " ", "-", 
                RowBox[{"1", " ", "and", " ", "1."}]}]}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"om", "=", "1"}], ",", 
               RowBox[{"om", "<", 
                RowBox[{
                 SuperscriptBox["3", 
                  RowBox[{"NZ", "+", "NF", "-", "1"}]], "+", "1"}]}], ",", 
               RowBox[{"om", "++"}], ",", " ", 
               RowBox[{"(*", 
                RowBox[{
                "Try", " ", "all", " ", "the", " ", "different", " ", 
                 "scenarios"}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 SubscriptBox["consider", "k"], "=", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"MonomialList", "[", "perf", "]"}], "[", 
                   RowBox[{"[", "k", "]"}], "]"}], "/", "ref"}]}], ";", 
                RowBox[{"(*", 
                 RowBox[{
                 "Each", " ", "time", " ", "start", " ", "from", " ", "the", 
                  " ", "beginning"}], "*)"}], "\[IndentingNewLine]", 
                RowBox[{
                 SubscriptBox["expression", "k"], "=", 
                 RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{
                 SubscriptBox["zexpression", "k"], "=", 
                 RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"pow", "=", "1"}], ";", "\[IndentingNewLine]", 
                RowBox[{"show", "=", "1"}], ";", "\[IndentingNewLine]", 
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"wfa", "=", "1"}], ",", 
                  RowBox[{"wfa", "<", "NF"}], ",", 
                  RowBox[{"wfa", "++"}], ",", 
                  RowBox[{"(*", 
                   RowBox[{
                   "Use", " ", "the", " ", "powers", " ", "for", " ", "the", 
                    " ", 
                    RowBox[{"w", "'"}], "s"}], "*)"}], "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], 
                    SuperscriptBox[
                    SubscriptBox["w", "wfa"], 
                    RowBox[{"powarray", "[", 
                    RowBox[{"[", 
                    RowBox[{"om", ",", "pow"}], "]"}], "]"}]]}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"show", "=", 
                    RowBox[{"show", " ", 
                    SuperscriptBox[
                    SubscriptBox["ww", "wfa"], 
                    RowBox[{"-", 
                    RowBox[{"powarray", "[", 
                    RowBox[{"[", 
                    RowBox[{"om", ",", "pow"}], "]"}], "]"}]}]]}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"ad", "=", "1"}], ",", 
                    RowBox[{"ad", "<", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"powarray", "[", 
                    RowBox[{"[", 
                    RowBox[{"om", ",", "pow"}], "]"}], "]"}], "]"}], "+", 
                    "1"}]}], ",", 
                    RowBox[{"ad", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "wfa"}], " ", 
                    RowBox[{"Sign", "[", 
                    RowBox[{"powarray", "[", 
                    RowBox[{"[", 
                    RowBox[{"om", ",", "pow"}], "]"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
                   ";", "\[IndentingNewLine]", 
                   RowBox[{"pow", "=", 
                    RowBox[{"pow", "+", "1"}]}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"inw", "=", "1"}], ",", 
                  RowBox[{"inw", "<", 
                   RowBox[{"NZ", "+", "1"}]}], ",", 
                  RowBox[{"inw", "++"}], ",", 
                  RowBox[{"(*", 
                   RowBox[{
                   "Use", " ", "the", " ", "powers", " ", "for", " ", "the", 
                    " ", 
                    RowBox[{"z", "'"}], "s"}], "*)"}], "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SuperscriptBox[
                    SubscriptBox["z", "inw"], 
                    RowBox[{"powarray", "[", 
                    RowBox[{"[", 
                    RowBox[{"om", ",", "pow"}], "]"}], "]"}]]}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"show", "=", 
                    RowBox[{"show", " ", 
                    SuperscriptBox[
                    SubscriptBox["zz", "inw"], 
                    RowBox[{"-", 
                    RowBox[{"powarray", "[", 
                    RowBox[{"[", 
                    RowBox[{"om", ",", "pow"}], "]"}], "]"}]}]]}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"ad", "=", "1"}], ",", 
                    RowBox[{"ad", "<", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"powarray", "[", 
                    RowBox[{"[", 
                    RowBox[{"om", ",", "pow"}], "]"}], "]"}], "]"}], "+", 
                    "1"}]}], ",", 
                    RowBox[{"ad", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "inw"}], " ", 
                    RowBox[{"Sign", "[", 
                    RowBox[{"powarray", "[", 
                    RowBox[{"[", 
                    RowBox[{"om", ",", "pow"}], "]"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
                   ";", "\[IndentingNewLine]", 
                   RowBox[{"pow", "=", 
                    RowBox[{"pow", "+", "1"}]}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    SubscriptBox["consider", "k"], "==", "1"}], " ", "||", 
                   RowBox[{
                    SubscriptBox["consider", "k"], "\[Equal]", 
                    RowBox[{"-", "1"}]}]}], " ", ",", " ", 
                  RowBox[{"(*", 
                   RowBox[{
                    RowBox[{
                    "If", " ", "the", " ", "term", " ", "is", " ", "1"}], ",",
                     " ", 
                    RowBox[{"we", " ", "are", " ", "done"}]}], "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<Found it on the \>\"", ",", "om", ",", 
                    "\"\<th try.\>\""}], "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"guess", "=", 
                    RowBox[{"guess", "+", "1"}]}], ";", "\[IndentingNewLine]", 
                   RowBox[{"darn", "=", "0"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"Break", "[", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
          RowBox[{"(*", 
           RowBox[{"Close", " ", "if"}], "*)"}], "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"darn", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
             "Now", " ", "turn", " ", "this", " ", "into", " ", "toric", " ", 
              "diagram", " ", "coordinates"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"mastercoords", "=", 
              RowBox[{"Table", "[", 
               RowBox[{"0", ",", 
                RowBox[{"{", 
                 RowBox[{"x", ",", 
                  RowBox[{"NZ", "+", "NF", "-", "1"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"y", ",", "1"}], "}"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"ei", "=", "1"}], ",", 
               RowBox[{"ei", "<", 
                RowBox[{"NZ", "+", "1"}]}], ",", 
               RowBox[{"ei", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"ai", "=", "1"}], ",", 
                  RowBox[{"ai", "<", 
                   RowBox[{
                    RowBox[{"Length", "[", 
                    SubscriptBox["zexpression", "k"], "]"}], "+", "1"}]}], 
                  ",", 
                  RowBox[{"ai", "++"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "[", 
                    RowBox[{"[", "ai", "]"}], "]"}], "\[Equal]", "ei"}], "||", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "[", 
                    RowBox[{"[", "ai", "]"}], "]"}], "\[Equal]", 
                    RowBox[{"-", "ei"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"mastercoords", "[", 
                    RowBox[{"[", 
                    RowBox[{"ei", ",", "1"}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"mastercoords", "[", 
                    RowBox[{"[", 
                    RowBox[{"ei", ",", "1"}], "]"}], "]"}], "+", 
                    RowBox[{"Sign", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "[", 
                    RowBox[{"[", "ai", "]"}], "]"}], "]"}]}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"ei", "=", "1"}], ",", 
               RowBox[{"ei", "<", "NF"}], ",", 
               RowBox[{"ei", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"ai", "=", "1"}], ",", 
                  RowBox[{"ai", "<", 
                   RowBox[{
                    RowBox[{"Length", "[", 
                    SubscriptBox["expression", "k"], "]"}], "+", "1"}]}], ",", 
                  RowBox[{"ai", "++"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["expression", "k"], "[", 
                    RowBox[{"[", "ai", "]"}], "]"}], "\[Equal]", "ei"}], "||", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["expression", "k"], "[", 
                    RowBox[{"[", "ai", "]"}], "]"}], "\[Equal]", 
                    RowBox[{"-", "ei"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"mastercoords", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"NZ", "+", "ei"}], ",", "1"}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"mastercoords", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"NZ", "+", "ei"}], ",", "1"}], "]"}], "]"}], "+", 
                    RowBox[{"Sign", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "[", 
                    RowBox[{"[", "ai", "]"}], "]"}], "]"}]}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"masterspace", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"masterspace", ",", "mastercoords", ",", "2"}], 
               "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"Make", " ", "the", " ", "expression", " ", "nice"}], 
              "*)"}], "\[IndentingNewLine]", 
             RowBox[{"nice", "=", "1"}], ";", "\[IndentingNewLine]", 
             RowBox[{"compare", "=", "1"}], ";", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"ei", "=", "1"}], ",", 
               RowBox[{"ei", "<", "NF"}], ",", 
               RowBox[{"ei", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"ai", "=", "1"}], ",", 
                  RowBox[{"ai", "<", 
                   RowBox[{
                    RowBox[{"Length", "[", 
                    SubscriptBox["expression", "k"], "]"}], "+", "1"}]}], ",", 
                  RowBox[{"ai", "++"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["expression", "k"], "[", 
                    RowBox[{"[", "ai", "]"}], "]"}], "\[Equal]", "ei"}], "||", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["expression", "k"], "[", 
                    RowBox[{"[", "ai", "]"}], "]"}], "\[Equal]", 
                    RowBox[{"-", "ei"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"nice", "=", 
                    RowBox[{"nice", " ", 
                    SuperscriptBox[
                    SubscriptBox["ww", "ei"], 
                    RowBox[{"Sign", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "[", 
                    RowBox[{"[", "ai", "]"}], "]"}], "]"}]]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"compare", "=", 
                    RowBox[{"compare", " ", 
                    SuperscriptBox[
                    SubscriptBox["w", "ei"], 
                    RowBox[{"Sign", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "[", 
                    RowBox[{"[", "ai", "]"}], "]"}], "]"}]]}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"ei", "=", "1"}], ",", 
               RowBox[{"ei", "<", 
                RowBox[{"NZ", "+", "1"}]}], ",", 
               RowBox[{"ei", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"ai", "=", "1"}], ",", 
                  RowBox[{"ai", "<", 
                   RowBox[{
                    RowBox[{"Length", "[", 
                    SubscriptBox["zexpression", "k"], "]"}], "+", "1"}]}], 
                  ",", 
                  RowBox[{"ai", "++"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "[", 
                    RowBox[{"[", "ai", "]"}], "]"}], "\[Equal]", "ei"}], "||", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "[", 
                    RowBox[{"[", "ai", "]"}], "]"}], "\[Equal]", 
                    RowBox[{"-", "ei"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"nice", "=", 
                    RowBox[{"nice", " ", 
                    SuperscriptBox[
                    SubscriptBox["zz", "ei"], 
                    RowBox[{"Sign", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "[", 
                    RowBox[{"[", "ai", "]"}], "]"}], "]"}]]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"compare", "=", 
                    RowBox[{"compare", " ", 
                    SuperscriptBox[
                    SubscriptBox["z", "ei"], 
                    RowBox[{"Sign", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "[", 
                    RowBox[{"[", "ai", "]"}], "]"}], "]"}]]}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"compare", "===", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"MonomialList", "[", "perf", "]"}], "[", 
                   RowBox[{"[", "k", "]"}], "]"}], "/", "ref"}]}], "||", 
                RowBox[{"compare", "===", 
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{
                    RowBox[{"MonomialList", "[", "perf", "]"}], "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "/", "ref"}]}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{"nice", ",", "\"\< = \>\"", ",", "compare"}], "]"}], 
                ";", "\[IndentingNewLine]", 
                RowBox[{
                 SubscriptBox["pm", "k"], "=", "nice"}], ";"}], " ", 
               RowBox[{"(*", 
                RowBox[{"Saves", " ", "the", " ", "expression"}], "*)"}], 
               "\[IndentingNewLine]", ",", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{
                 "\"\<Somehow this didn't work! Bug in the code. Do it by \
hand: \>\"", ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"MonomialList", "[", "perf", "]"}], "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "/", "ref"}]}], "]"}], 
                ";", "\[IndentingNewLine]", 
                RowBox[{"fail", "=", 
                 RowBox[{"fail", "+", "1"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"masterspace", "=", 
                 RowBox[{"Drop", "[", 
                  RowBox[{"masterspace", ",", "None", ",", 
                   RowBox[{"-", "1"}]}], "]"}]}], ";"}]}], 
              RowBox[{"(*", 
               RowBox[{
               "Remove", " ", "the", " ", "column", " ", "we", " ", "just", 
                " ", "added"}], "*)"}], "\[IndentingNewLine]", "]"}], ";"}], 
            "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{"\"\<All attempts failed. Do it by hand: \>\"", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"MonomialList", "[", "perf", "]"}], "[", 
                 RowBox[{"[", "k", "]"}], "]"}], "/", "ref"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"fail", "=", 
              RowBox[{"fail", "+", "1"}]}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";"}]}], 
        RowBox[{"(*", 
         RowBox[{"Close", " ", "if"}], "*)"}], "\[IndentingNewLine]", "]"}], 
       ";", 
       RowBox[{"(*", 
        RowBox[{"Close", " ", "for", " ", "k"}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", "\"\<---------------------------------------------\>\"", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<Failed \>\"", ",", "fail", ",", "\"\< times. Guessed \>\"", ",", 
         "guess", ",", "\"\< times.\>\""}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Computation time: \>\"", ",", 
         RowBox[{
          RowBox[{"TimeUsed", "[", "]"}], "-", "time"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"time", "=", 
        RowBox[{"TimeUsed", "[", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Gmaster", "=", "masterspace"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Gmaster = \>\"", ",", 
         RowBox[{"masterspace", "//", "MatrixForm"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"mastermult", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Dimensions", "[", 
            RowBox[{
             RowBox[{"Gather", "[", 
              RowBox[{"Transpose", "[", "masterspace", "]"}], "]"}], "[", 
             RowBox[{"[", "y", "]"}], "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", 
            RowBox[{
             RowBox[{"Dimensions", "[", 
              RowBox[{"Gather", "[", 
               RowBox[{"Transpose", "[", "masterspace", "]"}], "]"}], "]"}], 
             "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"DeleteDuplicates", "[", 
            RowBox[{"mastermult", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ">", "1"}], ",", 
         RowBox[{
          RowBox[{
          "Print", "[", 
           "\"\<ERROR!!! THERE ARE SEVERAL PERFECT MATCHINGS WITH THE SAME \
EXPRESSION!\>\"", "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", 
        "\"\<The order of the coordinates for Gmaster is: \!\(\*SubscriptBox[\
\(z\), \(i\)]\)'s, then faces (starting from face 1 to face NF-1).\>\"", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"gauging", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Gmoduli", "=", 
          RowBox[{"Delete", "[", 
           RowBox[{"Gmaster", ",", 
            RowBox[{"Transpose", "[", 
             RowBox[{"{", 
              RowBox[{"Table", "[", 
               RowBox[{"i", ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", 
                  RowBox[{"NZ", "+", "1"}], ",", 
                  RowBox[{"NZ", "+", "IF"}]}], "}"}]}], "]"}], "}"}], "]"}]}],
            "]"}]}], "\[IndentingNewLine]", ",", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"gauging", "\[Equal]", "2"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"deletelist", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"intz", ",", 
                RowBox[{"Table", "[", 
                 RowBox[{"i", ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{"NZ", "+", "1"}], ",", 
                    RowBox[{"NZ", "+", "IF"}]}], "}"}]}], "]"}]}], "]"}]}], 
             ";", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{
                RowBox[{
                "Here", " ", "we", " ", "also", " ", "dauge", " ", "the", " ",
                  "internal", " ", "zig"}], "-", "zags"}], ",", " ", 
               RowBox[{
               "as", " ", "well", " ", "as", " ", "delete", " ", "all", " ", 
                "internal", " ", "faces"}]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"Print", "[", 
                RowBox[{"\"\<deletelist=\>\"", ",", "deletelist"}], "]"}], 
               ";"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"boundaries", "=", 
              RowBox[{"Delete", "[", 
               RowBox[{"boundaries", ",", "1"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"bo", "=", "1"}], ",", 
               RowBox[{"bo", "<", 
                RowBox[{
                 RowBox[{"Length", "[", "boundaries", "]"}], "+", "1"}]}], 
               ",", 
               RowBox[{"bo", "++"}], ",", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{
                 "Each", " ", "time", " ", "we", " ", "have", " ", "external",
                   " ", "guys", " ", "going", " ", "around", " ", "a", " ", 
                  "boundary", " ", 
                  RowBox[{"(", 
                   RowBox[{
                   "hence", " ", "are", " ", "completely", " ", "internal"}], 
                   ")"}]}], ",", " ", 
                 RowBox[{
                 "we", " ", "have", " ", "to", " ", "subtract", " ", "the", 
                  " ", "value", " ", "of", " ", "one", " ", "row", " ", 
                  "from", " ", "all", " ", "the", " ", "others"}], ",", " ", 
                 RowBox[{
                 "and", " ", "then", " ", "gauge", " ", "this", " ", 
                  "row"}]}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"numb", "=", "1"}], ",", 
                  RowBox[{"numb", "<", 
                   RowBox[{"Length", "[", 
                    RowBox[{"boundaries", "[", 
                    RowBox[{"[", "bo", "]"}], "]"}], "]"}]}], ",", 
                  RowBox[{"numb", "++"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"masterspace", "[", 
                    RowBox[{"[", 
                    RowBox[{"boundaries", "[", 
                    RowBox[{"[", 
                    RowBox[{"bo", ",", "numb"}], "]"}], "]"}], "]"}], "]"}], 
                    "=", 
                    RowBox[{
                    RowBox[{"masterspace", "[", 
                    RowBox[{"[", 
                    RowBox[{"boundaries", "[", 
                    RowBox[{"[", 
                    RowBox[{"bo", ",", "numb"}], "]"}], "]"}], "]"}], "]"}], 
                    "-", 
                    RowBox[{"masterspace", "[", 
                    RowBox[{"[", 
                    RowBox[{"boundaries", "[", 
                    RowBox[{"[", 
                    RowBox[{"bo", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"boundaries", "[", 
                    RowBox[{"[", "bo", "]"}], "]"}], "]"}]}], "]"}], "]"}], 
                    "]"}], "]"}]}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
                ";", "\[IndentingNewLine]", 
                RowBox[{"deletelist", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{"deletelist", ",", 
                   RowBox[{"{", 
                    RowBox[{"NZ", "+", 
                    RowBox[{"boundaries", "[", 
                    RowBox[{"[", 
                    RowBox[{"bo", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"boundaries", "[", 
                    RowBox[{"[", "bo", "]"}], "]"}], "]"}]}], "]"}], "]"}]}], 
                    "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"Print", "[", 
                 RowBox[{"\"\<deletelist=\>\"", ",", "deletelist"}], "]"}], 
                ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Gmoduli", "=", 
              RowBox[{"Delete", "[", 
               RowBox[{"masterspace", ",", 
                RowBox[{"Transpose", "[", 
                 RowBox[{"{", "deletelist", "}"}], "]"}]}], "]"}]}], ";"}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{
             RowBox[{
             "Print", "[", 
              "\"\<Invalid value for 'gauging'. Need to specify either \
'gauging'=1 or 'gauging'=2.\>\"", "]"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Now", " ", "group", " ", "the", " ", "multiplicities", " ", "of", 
         " ", "G", " ", 
         RowBox[{"together", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Gshort", "=", 
        RowBox[{"Transpose", "[", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Transpose", "[", "Gmoduli", "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Multmatrix", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Dimensions", "[", 
            RowBox[{
             RowBox[{"Gather", "[", 
              RowBox[{"Transpose", "[", "Gmoduli", "]"}], "]"}], "[", 
             RowBox[{"[", "y", "]"}], "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", 
            RowBox[{
             RowBox[{"Dimensions", "[", 
              RowBox[{"Gather", "[", 
               RowBox[{"Transpose", "[", "Gmoduli", "]"}], "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Gshort = \>\"", ",", 
         RowBox[{"Gshort", "//", "MatrixForm"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Multipl = \>\"", ",", 
         RowBox[{"Multmatrix", "//", "MatrixForm"}]}], "]"}], ";"}]}], " ", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", "]"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"SKIPPED", ",", " ", 
    RowBox[{"ALREADY", " ", "DID", " ", "moduliLoopVariablesBFT"}]}], "*)"}], 
  "\[IndentingNewLine]"}]], "Input",
 PageWidth->WindowWidth,
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.576148817912237*^9, 3.576148928127171*^9}, {
   3.5761489689338007`*^9, 3.576149056150631*^9}, {3.5761492056310883`*^9, 
   3.576149274306745*^9}, {3.576149312465382*^9, 3.576149386752533*^9}, {
   3.576149491359613*^9, 3.57614949465446*^9}, {3.576149723190949*^9, 
   3.5761499230628767`*^9}, {3.576149977995221*^9, 3.576150164376753*^9}, {
   3.5761502098411922`*^9, 3.576150230668911*^9}, {3.5761502663387747`*^9, 
   3.576150318274827*^9}, {3.576150357542122*^9, 3.576150377096726*^9}, {
   3.5761504792596483`*^9, 3.5761506110021687`*^9}, {3.576150781148217*^9, 
   3.5761508537488527`*^9}, {3.576150927902979*^9, 3.57615095784647*^9}, {
   3.576151019012793*^9, 3.5761510254763803`*^9}, {3.5761510998536043`*^9, 
   3.576151315617023*^9}, {3.5761513965588703`*^9, 3.576151511071175*^9}, {
   3.5761515622068157`*^9, 3.57615157040322*^9}, {3.576151738724861*^9, 
   3.5761519506830807`*^9}, {3.5761519973722*^9, 3.576152038638912*^9}, {
   3.576152086187725*^9, 3.576152387554825*^9}, {3.576152460932548*^9, 
   3.576152466723721*^9}, {3.576152819389801*^9, 3.576152863530302*^9}, {
   3.576152899182455*^9, 3.576152934339652*^9}, {3.5761529864215593`*^9, 
   3.576153028855031*^9}, {3.576153107663233*^9, 3.576153122449911*^9}, {
   3.576153186977137*^9, 3.576153235746182*^9}, {3.576153322263803*^9, 
   3.5761533903371162`*^9}, {3.576153552252083*^9, 3.576153650326581*^9}, {
   3.576153782422483*^9, 3.576153973026595*^9}, {3.576154104509305*^9, 
   3.57615423728615*^9}, {3.5761547492353563`*^9, 3.576154749602059*^9}, {
   3.576154780179575*^9, 3.576154843122892*^9}, {3.5761549401111403`*^9, 
   3.576154988794104*^9}, {3.5761550298214703`*^9, 3.57615511679346*^9}, {
   3.5761553125133953`*^9, 3.576155329449048*^9}, {3.576155677776223*^9, 
   3.57615570035149*^9}, {3.5761557544205513`*^9, 3.57615580109277*^9}, {
   3.576155841504397*^9, 3.57615584351921*^9}, {3.5761559302250347`*^9, 
   3.576155930836429*^9}, 3.576156046147732*^9, {3.576156078253046*^9, 
   3.576156257075591*^9}, {3.576156481224762*^9, 3.576156496728744*^9}, {
   3.576156533245408*^9, 3.576156540113902*^9}, {3.576156723067902*^9, 
   3.576156746349201*^9}, {3.5761570742722263`*^9, 3.576157074970343*^9}, {
   3.5761571154587812`*^9, 3.576157133207965*^9}, {3.576157183315496*^9, 
   3.576157190293767*^9}, {3.57615736615119*^9, 3.576157395970818*^9}, {
   3.576158238330205*^9, 3.576158250499261*^9}, {3.576158283006201*^9, 
   3.5761583185151463`*^9}, {3.576158372480467*^9, 3.5761583746699266`*^9}, {
   3.576158435297688*^9, 3.576158563068829*^9}, {3.576158637401432*^9, 
   3.5761586660870943`*^9}, {3.576158708921126*^9, 3.576158906534074*^9}, {
   3.576158985725052*^9, 3.576159008650741*^9}, {3.576159067842807*^9, 
   3.5761592417473497`*^9}, {3.576159289206572*^9, 3.5761594186680727`*^9}, {
   3.5761596283971443`*^9, 3.576159650763504*^9}, {3.576159728368107*^9, 
   3.576159736948764*^9}, 3.576159891409306*^9, {3.576160248109364*^9, 
   3.576160253555657*^9}, {3.576160322563739*^9, 3.576160629640267*^9}, {
   3.576160678384303*^9, 3.576160709739375*^9}, {3.576160778857377*^9, 
   3.5761608154750843`*^9}, {3.576160900640486*^9, 3.576160909270117*^9}, {
   3.576160957749383*^9, 3.5761610207898617`*^9}, {3.576161347858952*^9, 
   3.576161436836183*^9}, {3.576161474928699*^9, 3.576161499347949*^9}, {
   3.5761616599899607`*^9, 3.576161661723804*^9}, {3.576161695145748*^9, 
   3.576161729201323*^9}, {3.576161775276593*^9, 3.576161787108982*^9}, {
   3.576161830273356*^9, 3.576161874556169*^9}, {3.576161940060336*^9, 
   3.576162113241889*^9}, {3.5762130920845633`*^9, 3.576213264998011*^9}, {
   3.576213315237341*^9, 3.576213326456188*^9}, {3.576213739622857*^9, 
   3.576213774958535*^9}, {3.57621451930411*^9, 3.576214693140319*^9}, {
   3.576214880402701*^9, 3.5762149263815403`*^9}, {3.576215270457015*^9, 
   3.5762152787058563`*^9}, {3.5762153412229433`*^9, 
   3.5762154758390512`*^9}, {3.576215507016677*^9, 3.576215518239626*^9}, {
   3.576215884260626*^9, 3.57621588549268*^9}, {3.576215927476409*^9, 
   3.576215941311426*^9}, {3.576215990105167*^9, 3.576216026156105*^9}, {
   3.576216064836007*^9, 3.576216065572057*^9}, {3.576217343783297*^9, 
   3.5762173444531*^9}, {3.5762173846284513`*^9, 3.576217385551711*^9}, {
   3.5762174222228928`*^9, 3.576217430317565*^9}, {3.576217832250169*^9, 
   3.576217837178451*^9}, {3.57621794282905*^9, 3.576217973236252*^9}, {
   3.576218059943801*^9, 3.5762180796658297`*^9}, {3.576218129360798*^9, 
   3.5762181407909822`*^9}, {3.576218238735223*^9, 3.57621823959406*^9}, {
   3.576218345371663*^9, 3.576218396823381*^9}, {3.576218450354456*^9, 
   3.576218458681058*^9}, {3.5762184931780167`*^9, 3.576218511618184*^9}, {
   3.576218650819393*^9, 3.576218668954953*^9}, {3.576218746538669*^9, 
   3.5762187970303097`*^9}, {3.576218951885481*^9, 3.576219002099832*^9}, {
   3.576219094461447*^9, 3.576219109658538*^9}, {3.5762191681944942`*^9, 
   3.5762191694169283`*^9}, {3.576219310139923*^9, 3.576219329169121*^9}, {
   3.576219367940628*^9, 3.576219415079692*^9}, {3.57621957183788*^9, 
   3.5762196218929358`*^9}, {3.5762196561788883`*^9, 3.576219663874861*^9}, {
   3.57622004812449*^9, 3.57622006234896*^9}, {3.576220116278512*^9, 
   3.5762202215698442`*^9}, {3.5762204816330233`*^9, 
   3.5762206250606117`*^9}, {3.576220662712875*^9, 3.576220663298085*^9}, {
   3.57622070557204*^9, 3.5762207835089083`*^9}, {3.576222275914914*^9, 
   3.576222318320671*^9}, {3.5762225668968697`*^9, 3.576222621162245*^9}, {
   3.5762226619101458`*^9, 3.576222662618107*^9}, {3.576222706464882*^9, 
   3.576222709084803*^9}, {3.576223104740198*^9, 3.5762231524902*^9}, {
   3.57622318645471*^9, 3.5762233100827847`*^9}, 3.57622334192253*^9, 
   3.5762234396522217`*^9, {3.576223473303012*^9, 3.576223477030285*^9}, {
   3.5762235384548388`*^9, 3.576223762190958*^9}, {3.5762238000976458`*^9, 
   3.576223813337001*^9}, {3.57622387617663*^9, 3.576223914001708*^9}, 
   3.5762239468861*^9, {3.5762240226616297`*^9, 3.576224177345602*^9}, {
   3.576224289448222*^9, 3.576224304651845*^9}, {3.576224419628501*^9, 
   3.576224468256078*^9}, {3.576224534599208*^9, 3.576224666883749*^9}, {
   3.576224805137806*^9, 3.5762248485039043`*^9}, {3.57622489628125*^9, 
   3.576224924313299*^9}, {3.576225277477585*^9, 3.576225301346291*^9}, {
   3.5762253418954887`*^9, 3.576225427579772*^9}, {3.5762317892931337`*^9, 
   3.576231790750937*^9}, {3.5762347778229847`*^9, 3.5762347918481503`*^9}, {
   3.576237237668058*^9, 3.5762372379744463`*^9}, {3.57623757001749*^9, 
   3.57623759725576*^9}, {3.576241960357307*^9, 3.5762419691405582`*^9}, {
   3.5762420073014593`*^9, 3.57624206121124*^9}, {3.5762422606565638`*^9, 
   3.576242306139943*^9}, {3.576242603671438*^9, 3.576242624566773*^9}, {
   3.576243746727086*^9, 3.576243751658803*^9}, {3.576243789635613*^9, 
   3.576243856417708*^9}, {3.576243886511959*^9, 3.576243973027932*^9}, {
   3.576244030042775*^9, 3.576244042303115*^9}, {3.5762441099807043`*^9, 
   3.5762441158048697`*^9}, {3.576303134179438*^9, 3.5763031652114*^9}, {
   3.576306985933362*^9, 3.576307087347661*^9}, {3.576307129380207*^9, 
   3.576307131646267*^9}, 3.576307194322825*^9, {3.5763074782027617`*^9, 
   3.57630755749109*^9}, {3.57630777874529*^9, 3.576307788047255*^9}, {
   3.576307855328994*^9, 3.576307922487919*^9}, {3.576308166645566*^9, 
   3.5763082136985273`*^9}, {3.576308255487319*^9, 3.576308280433248*^9}, {
   3.576315948705303*^9, 3.576316018295106*^9}, {3.576321798611573*^9, 
   3.576321848975234*^9}, {3.576321885051893*^9, 3.5763218858461943`*^9}, {
   3.576321953819397*^9, 3.576322049280579*^9}, {3.5763220914106913`*^9, 
   3.576322188775498*^9}, {3.5763223107799873`*^9, 3.576322397723781*^9}, {
   3.5763230685411882`*^9, 3.576323125880866*^9}, {3.576323917013579*^9, 
   3.57632395693712*^9}, {3.576324069582636*^9, 3.576324072321229*^9}, {
   3.576324489087204*^9, 3.576324504816905*^9}, {3.576325086157404*^9, 
   3.5763252000775023`*^9}, {3.576325232449173*^9, 3.576325237474349*^9}, {
   3.57632654401924*^9, 3.5763266127831087`*^9}, {3.576326810903273*^9, 
   3.576326839613799*^9}, {3.5763268783459187`*^9, 3.576327015702446*^9}, {
   3.576327207225713*^9, 3.5763273171696863`*^9}, {3.576328224119501*^9, 
   3.5763283083866577`*^9}, {3.576328342482373*^9, 3.576328365082905*^9}, {
   3.576328404400139*^9, 3.576328421796439*^9}, {3.576328472109136*^9, 
   3.576328472591237*^9}, {3.576328690205551*^9, 3.5763287245216722`*^9}, 
   3.576328940673818*^9, {3.576328978539794*^9, 3.576329006481028*^9}, {
   3.576843606027224*^9, 3.576843732040822*^9}, {3.5768437911828327`*^9, 
   3.576843818835994*^9}, {3.576843858923519*^9, 3.5768439465760107`*^9}, {
   3.5768439793713093`*^9, 3.5768439839894333`*^9}, {3.576846751762249*^9, 
   3.576846789633905*^9}, {3.576846836233926*^9, 3.576846855828642*^9}, {
   3.576847354836813*^9, 3.57684735590871*^9}, {3.577615393056913*^9, 
   3.57761551732902*^9}, {3.579342501719387*^9, 3.579342574952606*^9}, {
   3.579430856806521*^9, 3.579430924655119*^9}, {3.5794348961123667`*^9, 
   3.5794349349297132`*^9}, {3.5794349681689*^9, 3.579435298437531*^9}, {
   3.5794353491425943`*^9, 3.579435389039843*^9}, 3.579435546228895*^9, {
   3.5794356407750397`*^9, 3.57943564193216*^9}, {3.5794365885887737`*^9, 
   3.579436669189198*^9}, {3.5794372716166058`*^9, 3.579437277415022*^9}, {
   3.579607212601417*^9, 3.579607224518353*^9}, {3.5796073729528913`*^9, 
   3.5796074742978077`*^9}, {3.57967723439417*^9, 3.579677246553935*^9}, {
   3.579678832924945*^9, 3.5796788630068617`*^9}, {3.579685685406399*^9, 
   3.579685930230878*^9}, {3.5796891250330143`*^9, 3.579689127902423*^9}, {
   3.579690335401519*^9, 3.5796903808716288`*^9}, {3.579694233680674*^9, 
   3.579694352811335*^9}, {3.579694407182583*^9, 3.579694439498666*^9}, {
   3.5796945387428293`*^9, 3.579694599241303*^9}, {3.579694653822867*^9, 
   3.579694749139868*^9}, {3.5799555231161337`*^9, 3.579955553319438*^9}, {
   3.579955639743621*^9, 3.5799556659212914`*^9}, {3.5799584998838263`*^9, 
   3.5799586635957193`*^9}, {3.57995878588316*^9, 3.5799588931155157`*^9}, {
   3.580025237936866*^9, 3.5800252463420486`*^9}, {3.5817594826515617`*^9, 
   3.5817594923051977`*^9}, {3.5820299306252127`*^9, 3.582029948157402*^9}, {
   3.582030041865552*^9, 3.582030166465983*^9}, {3.582030269924653*^9, 
   3.5820302832691183`*^9}, 3.5820303265370626`*^9, {3.582030649795182*^9, 
   3.5820306796249027`*^9}, {3.5823512648998218`*^9, 3.582351299120349*^9}, {
   3.5823513537178106`*^9, 3.5823513597024975`*^9}, {3.582351423174545*^9, 
   3.5823514750366073`*^9}, {3.582973670258151*^9, 3.582973753778205*^9}, {
   3.5829768786502476`*^9, 3.582976895197998*^9}, {3.5829769282622538`*^9, 
   3.582976929981089*^9}, {3.58297718318867*^9, 3.582977211596422*^9}, {
   3.5855625840936613`*^9, 3.585562617671673*^9}, {3.5855632189114113`*^9, 
   3.58556322219191*^9}, {3.585563485291739*^9, 3.585563560661895*^9}, {
   3.585564752745022*^9, 3.5855647564780493`*^9}, {3.5855651289920073`*^9, 
   3.585565187075713*^9}, {3.585565252388776*^9, 3.585565278968121*^9}, {
   3.5855653275826187`*^9, 3.585565382603629*^9}, {3.5856394130686617`*^9, 
   3.585639434780405*^9}, {3.585639483326973*^9, 3.585639483629096*^9}, {
   3.585998392322534*^9, 3.585998398990336*^9}, {3.585998431222661*^9, 
   3.585998432590322*^9}, {3.585998632135688*^9, 3.585998655329258*^9}, {
   3.5866074448685913`*^9, 3.586607447018503*^9}, {3.5866074832775793`*^9, 
   3.5866074983497133`*^9}, {3.58686369618256*^9, 3.58686370909735*^9}, {
   3.586863841645384*^9, 3.586863842627022*^9}, {3.586864321000414*^9, 
   3.586864324895154*^9}, 3.586864366985751*^9, {3.586866755485326*^9, 
   3.5868668326806726`*^9}, {3.586869604190463*^9, 3.586869650198533*^9}, 
   3.586870433161932*^9, {3.587288656869013*^9, 3.587288659770417*^9}, {
   3.587293047912929*^9, 3.5872930496851187`*^9}, {3.587297226221148*^9, 
   3.587297264147582*^9}, {3.587301528775989*^9, 3.58730159462719*^9}, {
   3.587302767336502*^9, 3.58730283675079*^9}, {3.58730291731569*^9, 
   3.587302927909011*^9}, {3.587302999945421*^9, 3.587303199136139*^9}, {
   3.587304074510716*^9, 3.58730407496367*^9}, {3.5873046767098503`*^9, 
   3.587304687083124*^9}, {3.587359191878787*^9, 3.587359200442801*^9}, {
   3.587359874448225*^9, 3.587359934878413*^9}, {3.587359991205307*^9, 
   3.587360001821693*^9}, 3.587362504390326*^9, {3.587362544510345*^9, 
   3.587362545088139*^9}, {3.5873641863803177`*^9, 3.5873642065333*^9}, {
   3.587364285738385*^9, 3.587364305648054*^9}, {3.5873644161632233`*^9, 
   3.5873644530265713`*^9}, {3.587364543543462*^9, 3.5873646200314293`*^9}, {
   3.587364762939116*^9, 3.587364766194523*^9}, {3.587371269648548*^9, 
   3.587371280182069*^9}, {3.587371590413313*^9, 3.58737159650354*^9}, {
   3.587380233102644*^9, 3.587380348185586*^9}, {3.5873804147469254`*^9, 
   3.5873804598906384`*^9}, {3.587380570721362*^9, 3.587380624739603*^9}, {
   3.58738067062362*^9, 3.587380671314478*^9}, {3.587380722940173*^9, 
   3.587380747938287*^9}, {3.587380784273748*^9, 3.587380788271497*^9}, {
   3.5873839583509197`*^9, 3.587383986025703*^9}, {3.5873840516580067`*^9, 
   3.587384078907852*^9}, {3.587387282952498*^9, 3.58738728384243*^9}, {
   3.5873874850659103`*^9, 3.587387486332459*^9}, {3.587395448354924*^9, 
   3.587395451630028*^9}, {3.5873965849923487`*^9, 3.5873965862635117`*^9}, {
   3.587456187847877*^9, 3.587456191319253*^9}, {3.587542841997992*^9, 
   3.587542921400832*^9}, {3.5875430458073587`*^9, 3.587543059638785*^9}, {
   3.587819763896347*^9, 3.587819831668365*^9}, {3.587820909914227*^9, 
   3.5878209110812674`*^9}, {3.588487170587174*^9, 3.588487257187992*^9}, {
   3.590140318650488*^9, 3.590140365572927*^9}, {3.590140398712254*^9, 
   3.5901404009343452`*^9}, {3.5901404477877197`*^9, 
   3.5901405441101713`*^9}, {3.590140613382791*^9, 3.5901406194401093`*^9}, {
   3.590140655894506*^9, 3.5901406566250257`*^9}, {3.590140695224309*^9, 
   3.590140711446439*^9}, {3.591604666175776*^9, 3.591604699106963*^9}, {
   3.5986113588283157`*^9, 3.598611417271028*^9}, {3.598611491759286*^9, 
   3.598611502274373*^9}, {3.59861153749197*^9, 3.598611620850712*^9}, {
   3.5986117294906683`*^9, 3.598611743080658*^9}, {3.60585898088905*^9, 
   3.605858983043676*^9}, {3.620393024411577*^9, 3.620393033110076*^9}, {
   3.620393122534042*^9, 3.6203931521918507`*^9}, {3.6203932381511393`*^9, 
   3.620393284410076*^9}, {3.620393457241973*^9, 3.620393458825295*^9}, 
   3.6203934975661573`*^9, {3.620393719979827*^9, 3.620393813847763*^9}, 
   3.6203938667338*^9, {3.620393915093884*^9, 3.620393925979841*^9}, {
   3.620393973998962*^9, 3.620394008328063*^9}, {3.62039419115679*^9, 
   3.6203941919469213`*^9}, 3.620394486832745*^9, 3.620394630337385*^9, {
   3.620394790039661*^9, 3.6203948195114193`*^9}, 3.620395160103352*^9, 
   3.620395530280422*^9, {3.62039559813708*^9, 3.620395598814912*^9}, 
   3.620395639772415*^9, {3.6203957040907793`*^9, 3.6203957045281057`*^9}, {
   3.62039574397104*^9, 3.620395773839658*^9}, {3.620396005149191*^9, 
   3.6203960972862988`*^9}, {3.6203962349589033`*^9, 3.620396257293078*^9}, {
   3.620981465708709*^9, 3.620981556019998*^9}, {3.620981657138266*^9, 
   3.620981663497663*^9}, 3.620991241287923*^9, {3.620994812327745*^9, 
   3.620994900945229*^9}, {3.6209949381741543`*^9, 3.620994950028591*^9}, {
   3.62099538290107*^9, 3.6209954091060133`*^9}, {3.620995439181106*^9, 
   3.620995462683921*^9}, {3.620995494750704*^9, 3.620995496866028*^9}, 
   3.6209955716547956`*^9, {3.620996011272813*^9, 3.620996121557342*^9}, {
   3.620996155475589*^9, 3.620996211669683*^9}, {3.647327741096159*^9, 
   3.6473279004942007`*^9}, 3.6616868958526716`*^9, 3.6616913515181503`*^9, {
   3.6616913971847754`*^9, 3.6616914572889447`*^9}, 3.6617517258379326`*^9, {
   3.661751761045849*^9, 3.6617517629723654`*^9}, {3.6617522676333666`*^9, 
   3.6617522908079767`*^9}, {3.6617531086276145`*^9, 
   3.6617531135398755`*^9}, {3.661753153477132*^9, 3.6617531627600293`*^9}, {
   3.6617591224922295`*^9, 3.66175913476531*^9}, {3.661766060571831*^9, 
   3.6617660749719133`*^9}, {3.661775588198186*^9, 3.661775624496746*^9}, {
   3.661775772728195*^9, 3.6617758522627964`*^9}, {3.661854582867503*^9, 
   3.661854603581808*^9}, {3.6621161309735107`*^9, 3.6621162083981752`*^9}, 
   3.6621170377989798`*^9, {3.6621171151769876`*^9, 3.6621171396140523`*^9}, {
   3.6621171753239584`*^9, 3.662117209899497*^9}, {3.6621241004004955`*^9, 
   3.662124117260113*^9}, {3.6621253957044916`*^9, 3.6621254266957207`*^9}, {
   3.6621881481600285`*^9, 3.66218817452687*^9}, {3.662201740242825*^9, 
   3.6622017597209077`*^9}, {3.662203784992427*^9, 3.6622037899330816`*^9}, {
   3.662287726843808*^9, 3.662287785972896*^9}, {3.66244364371959*^9, 
   3.6624436726703053`*^9}, {3.6624437086683054`*^9, 3.662443763291527*^9}, {
   3.6624440679968176`*^9, 3.6624440955020547`*^9}, {3.6627344413853006`*^9, 
   3.6627344506490607`*^9}, {3.662819441897256*^9, 3.6628194522809496`*^9}, {
   3.6628945315192575`*^9, 3.662894574587954*^9}, {3.6629001963256254`*^9, 
   3.6629002126733947`*^9}, {3.6639206332743454`*^9, 3.6639206438645053`*^9}, 
   3.6639207806741037`*^9, {3.6645204323055563`*^9, 3.6645204745161104`*^9}, {
   3.664706950511255*^9, 3.6647069629276733`*^9}, {3.664707003142525*^9, 
   3.664707043150221*^9}}]
}, Closed]]
},
WindowSize->{1366, 685},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
PrintingCopies->1,
PrintingPageRange->{32000, 32000},
PrintingOptions->{"Magnification"->1.,
"PaperOrientation"->"Portrait",
"PaperSize"->{595.3199999999999, 841.92}},
FrontEndVersion->"10.2 for Microsoft Windows (64-bit) (July 7, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 281, 7, 52, "Input"],
Cell[CellGroupData[{
Cell[864, 31, 297, 7, 31, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1164, 40, 7732, 192, 235, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]],
Cell[CellGroupData[{
Cell[8933, 237, 435, 11, 25, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.}],
Cell[9371, 250, 5359, 146, 235, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.}]
}, Closed]],
Cell[CellGroupData[{
Cell[14767, 401, 411, 10, 25, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.}],
Cell[15181, 413, 3820, 113, 214, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.}]
}, Closed]],
Cell[CellGroupData[{
Cell[19038, 531, 387, 10, 25, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[19428, 543, 3277, 87, 176, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]],
Cell[CellGroupData[{
Cell[22742, 635, 256, 6, 25, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.}],
Cell[23001, 643, 2270, 76, 215, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.}]
}, Closed]],
Cell[CellGroupData[{
Cell[25308, 724, 351, 8, 25, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.}],
Cell[25662, 734, 2821, 90, 214, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.}]
}, Closed]],
Cell[CellGroupData[{
Cell[28520, 829, 681, 18, 25, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10004.}],
Cell[29204, 849, 3765, 112, 214, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10004.}]
}, Closed]],
Cell[CellGroupData[{
Cell[33006, 966, 290, 7, 25, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10003.}],
Cell[33299, 975, 8329, 220, 315, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10003.}]
}, Closed]],
Cell[CellGroupData[{
Cell[41665, 1200, 406, 10, 25, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10004.}],
Cell[42074, 1212, 2049, 66, 214, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10004.}]
}, Closed]],
Cell[CellGroupData[{
Cell[44160, 1283, 395, 9, 25, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[44558, 1294, 3023, 92, 235, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]],
Cell[CellGroupData[{
Cell[47618, 1391, 338, 9, 25, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.}],
Cell[47959, 1402, 4279, 132, 235, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.}]
}, Closed]],
Cell[CellGroupData[{
Cell[52275, 1539, 539, 11, 25, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10004.}],
Cell[52817, 1552, 4586, 135, 255, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10004.}]
}, Closed]],
Cell[CellGroupData[{
Cell[57440, 1692, 346, 8, 25, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10007.}],
Cell[57789, 1702, 2760, 87, 235, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10007.}]
}, Closed]],
Cell[CellGroupData[{
Cell[60586, 1794, 842, 22, 46, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10003.}],
Cell[61431, 1818, 4064, 121, 235, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10003.}]
}, Closed]],
Cell[CellGroupData[{
Cell[65532, 1944, 445, 9, 25, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10004.}],
Cell[65980, 1955, 2775, 88, 214, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10004.}]
}, Closed]],
Cell[CellGroupData[{
Cell[68792, 2048, 485, 9, 25, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}],
Cell[69280, 2059, 2782, 88, 214, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10005.}]
}, Closed]],
Cell[CellGroupData[{
Cell[72099, 2152, 920, 22, 46, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10006.}],
Cell[73022, 2176, 3983, 118, 214, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10006.}]
}, Closed]],
Cell[CellGroupData[{
Cell[77042, 2299, 346, 7, 25, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.}],
Cell[77391, 2308, 2878, 78, 212, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.}]
}, Closed]],
Cell[80284, 2389, 168, 4, 25, "Input"],
Cell[80455, 2395, 879, 26, 31, "Input"],
Cell[81337, 2423, 177, 3, 31, "Input"],
Cell[81517, 2428, 119, 2, 31, "Input"],
Cell[81639, 2432, 838, 25, 31, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[82480, 2459, 149, 2, 31, "Input"],
Cell[82632, 2463, 1754, 53, 52, "Input"],
Cell[84389, 2518, 94, 1, 31, "Input"],
Cell[84486, 2521, 91, 1, 31, "Input"],
Cell[84580, 2524, 123, 2, 31, "Input"],
Cell[84706, 2528, 94, 1, 31, "Input"],
Cell[CellGroupData[{
Cell[84825, 2533, 1446, 29, 72, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[86274, 2564, 30918, 717, 2312, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[117195, 3283, 815, 12, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[118013, 3297, 850, 12, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[118866, 3311, 828, 12, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[119697, 3325, 817, 12, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[120517, 3339, 848, 12, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[121368, 3353, 828, 12, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[122199, 3367, 1200, 40, 48, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]],
Cell[123414, 3410, 119, 2, 25, "Input"],
Cell[CellGroupData[{
Cell[123558, 3416, 475, 6, 30, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[124036, 3424, 790464, 18910, 49702, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]]
}
]
*)

(* End of internal cache information *)
