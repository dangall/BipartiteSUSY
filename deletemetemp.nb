(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     48376,       1243]
NotebookOptionsPosition[     47534,       1213]
NotebookOutlinePosition[     47876,       1228]
CellTagsIndexPosition[     47833,       1225]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "This", " ", "is", " ", "code", " ", "from", " ", "stackexchange", " ", 
     RowBox[{"http", ":"}]}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"mathematica", ".", "stackexchange", ".", "com"}], "/", 
        "questions"}], "/", "18514"}], "/", "finding"}], "-", "face", "-", 
     "vertices", "-", "from", "-", "the", "-", "face", "-", "adjacency", "-", 
     RowBox[{
     "graph", " ", "for", " ", "counting", " ", "the", " ", "number", " ", 
      "of", " ", "faces"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
      "===", "===", "===", "==="}], "=", 
    RowBox[{
     RowBox[{
     "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", 
      "==="}], "=", 
     RowBox[{"===", "===", "===", "===", "===", "===", "===", "=="}]}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"nextCandidate", "[", 
      RowBox[{"s_", ",", "t_", ",", "adj_"}], "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"length", ",", "pos"}], "}"}], ",", 
       RowBox[{
        RowBox[{"length", "=", 
         RowBox[{"Length", "[", "adj", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"pos", "=", 
         RowBox[{"Mod", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Position", "[", 
              RowBox[{"adj", ",", "s"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", "1"}], ",", 
           "length", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"t", ",", 
          RowBox[{"adj", "[", 
           RowBox[{"[", "pos", "]"}], "]"}]}], "}"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FindFace", "[", 
      RowBox[{"g_", "?", "PlanarGraphQ"}], "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "emb", "}"}], ",", 
       RowBox[{
        RowBox[{"emb", "=", 
         RowBox[{"GraphEmbedding", "[", 
          RowBox[{"g", ",", "\"\<PlanarEmbedding\>\""}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"FindFace", "[", 
         RowBox[{"g", ",", "emb"}], "]"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"FindFace", "[", 
     RowBox[{
      RowBox[{"g_", "?", "PlanarGraphQ"}], ",", "emb_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "m", ",", "realvertexlist", ",", "fakevertexlist", ",", "tofakenums", 
        ",", "torealnums", ",", "orderings", ",", "pAdj", ",", "rightF", ",", 
        "s", ",", "t", ",", "initial", ",", "face", ",", "answers", ",", 
        "outputfaces"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"m", "=", 
        RowBox[{"AdjacencyMatrix", "[", "g", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"realvertexlist", "=", 
        RowBox[{"VertexList", "[", "g", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"fakevertexlist", "=", 
        RowBox[{"Range", "[", 
         RowBox[{"Length", "[", "realvertexlist", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tofakenums", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Rule", ",", 
          RowBox[{"{", 
           RowBox[{"realvertexlist", ",", "fakevertexlist"}], "}"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"torealnums", "=", 
        RowBox[{"Map", "[", 
         RowBox[{"Reverse", ",", "tofakenums"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"pAdj", "[", "v", "]"}], "=", 
          RowBox[{"SortBy", "[", 
           RowBox[{
            RowBox[{"Pick", "[", 
             RowBox[{"fakevertexlist", ",", 
              RowBox[{"m", "[", 
               RowBox[{"[", "v", "]"}], "]"}], ",", "1"}], "]"}], ",", 
            RowBox[{
             RowBox[{"ArcTan", "@@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"emb", "[", 
                 RowBox[{"[", "v", "]"}], "]"}], "-", 
                RowBox[{"emb", "[", 
                 RowBox[{"[", "#", "]"}], "]"}]}], ")"}]}], "&"}]}], "]"}]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"v", ",", "fakevertexlist"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"rightF", "[", "_", "]"}], ":=", "False"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"answers", "=", 
        RowBox[{
         RowBox[{"Reap", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"rightF", "[", "e", "]"}]}], ",", 
              RowBox[{
               RowBox[{"s", "=", 
                RowBox[{"e", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"t", "=", 
                RowBox[{"e", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"initial", "=", "s"}], ";", "\[IndentingNewLine]", 
               RowBox[{"face", "=", 
                RowBox[{"{", "s", "}"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"While", "[", 
                RowBox[{
                 RowBox[{"t", "=!=", "initial"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"rightF", "[", 
                    RowBox[{"UndirectedEdge", "[", 
                    RowBox[{"s", ",", "t"}], "]"}], "]"}], "=", "True"}], ";",
                   "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"s", ",", "t"}], "}"}], "=", 
                   RowBox[{"nextCandidate", "[", 
                    RowBox[{"s", ",", "t", ",", 
                    RowBox[{"pAdj", "[", "t", "]"}]}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"face", "=", 
                   RowBox[{"Join", "[", 
                    RowBox[{"face", ",", 
                    RowBox[{"{", "s", "}"}]}], "]"}]}], ";"}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"Sow", "[", "face", "]"}], ";"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"e", ",", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"EdgeList", "[", "g", "]"}], "/.", "tofakenums"}], 
               ")"}]}], "}"}]}], "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"answers", "\[Equal]", 
          RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"outputfaces", "=", 
           RowBox[{"answers", "/.", "torealnums"}]}], ";"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{
          RowBox[{"outputfaces", "=", 
           RowBox[{
            RowBox[{"answers", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "/.", "torealnums"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "outputfaces"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
       "===", "===", "===", "==="}], "=", 
     RowBox[{
      RowBox[{
      "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", 
       "==="}], "=", 
      RowBox[{"===", "===", "===", "===", "===", "===", "===", "=="}]}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"allTestPlanarityQ", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"aa_", ",", "bb_", ",", "cc_", ",", "dd_"}], "}"}], ",", 
       "bftlabeling_"}], "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "a", ",", "b", ",", "c", ",", "d", ",", "planaritycollapsed", ",", 
         "graph", ",", "externalnodes", ",", "choppedgraph", ",", 
         "connectedcomponents", ",", "internalfaces", ",", 
         "internalfacenodes", ",", "externaledges", ",", 
         "whichfacescouldyoubein", ",", "howmanyfacescanyoubein", ",", 
         "numcommonfaces"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"planaritycollapsed", "=", 
         RowBox[{"planarityQ", "[", 
          RowBox[{"aa", ",", "bb", ",", "cc", ",", "dd"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"aa", ",", "bb", ",", "cc", ",", "dd"}], "}"}], "//.", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "firstmat_", ",", "secondmat_", ",", "thirdmat_", ",", 
             "fourthmat_"}], "}"}], "\[RuleDelayed]", 
           RowBox[{"simplifyGraph", "[", 
            RowBox[{"firstmat", ",", 
             RowBox[{"(", 
              RowBox[{"secondmat", "/.", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "\[Rule]", "0"}], "&"}], ",", 
                 RowBox[{"Flatten", "[", 
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ";;"}], "]"}], "]"}], "&"}], ",", 
                    RowBox[{"Cases", "[", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Variables", ",", "secondmat"}], "]"}], ",", 
                    RowBox[{"zz_", "/;", 
                    RowBox[{
                    RowBox[{"Length", "[", "zz", "]"}], ">", "1"}]}]}], 
                    "]"}]}], "]"}], "]"}]}], "]"}]}], ")"}], ",", 
             RowBox[{
              RowBox[{"Function", "[", 
               RowBox[{
                RowBox[{"{", "thebottomleft", "}"}], ",", 
                RowBox[{"Block", "[", 
                 RowBox[{
                  RowBox[{"{", "output", "}"}], ",", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "thebottomleft", "]"}], ">", "0"}],
                     ",", 
                    RowBox[{
                    RowBox[{"output", "=", 
                    RowBox[{"thebottomleft", "/.", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "\[Rule]", "0"}], "&"}], ",", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ";;"}], "]"}], "]"}], "&"}], ",", 
                    RowBox[{"Cases", "[", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Variables", ",", 
                    RowBox[{"Transpose", "[", "thebottomleft", "]"}]}], "]"}],
                     ",", 
                    RowBox[{"zz_", "/;", 
                    RowBox[{
                    RowBox[{"Length", "[", "zz", "]"}], ">", "1"}]}]}], 
                    "]"}]}], "]"}], "]"}]}], "]"}]}]}], ";"}], ",", 
                    RowBox[{
                    RowBox[{"output", "=", "thebottomleft"}], ";"}]}], "]"}], 
                   ";", "output"}]}], "]"}]}], "]"}], "[", "thirdmat", "]"}], 
             ",", "fourthmat"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"graph", "=", 
         RowBox[{"turnIntoGraph", "[", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "False"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"PlanarGraphQ", "[", "graph", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"externalnodes", "=", 
            RowBox[{"getOrderingExternalNodesDefault", "[", 
             RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"choppedgraph", "=", 
            RowBox[{"Graph", "[", 
             RowBox[{
              RowBox[{"turnIntoGraph", "[", 
               RowBox[{
                RowBox[{"Sequence", "@@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], "/.", 
                   RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "\[Rule]", "0"}], "&"}], ",", 
                    RowBox[{"Variables", "[", 
                    RowBox[{"{", 
                    RowBox[{"b", ",", "c"}], "}"}], "]"}]}], "]"}]}], ")"}]}],
                 ",", "False"}], "]"}], ",", 
              RowBox[{"GraphLayout", "\[Rule]", "\"\<PlanarEmbedding\>\""}]}],
              "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"connectedcomponents", "=", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Subgraph", "[", 
                RowBox[{"choppedgraph", ",", "#"}], "]"}], "&"}], ",", 
              RowBox[{"DeleteCases", "[", 
               RowBox[{
                RowBox[{"ConnectedComponents", "[", "choppedgraph", "]"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"Alternatives", "@@", "externalnodes"}], "}"}]}], 
               "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"internalfacenodes", "=", 
            RowBox[{"DeleteCases", "[", 
             RowBox[{
              RowBox[{"Map", "[", 
               RowBox[{"FindFace", ",", "connectedcomponents"}], "]"}], ",", 
              RowBox[{"zz_", "/;", 
               RowBox[{
                RowBox[{"Length", "[", "zz", "]"}], "\[LessEqual]", "1"}]}]}],
              "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"internalfacenodes", "=", 
            RowBox[{"DeleteCases", "[", 
             RowBox[{
              RowBox[{"Append", "[", 
               RowBox[{
                RowBox[{"Join", "@@", 
                 RowBox[{"internalfacenodes", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", 
                    RowBox[{";;", 
                    RowBox[{"-", "2"}]}]}], "]"}], "]"}]}], ",", 
                RowBox[{"Join", "@@", 
                 RowBox[{"internalfacenodes", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}]}]}], "]"}], ",", 
              RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"externaledges", "=", 
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"EdgeList", "[", "graph", "]"}], ",", 
              RowBox[{
               RowBox[{"UndirectedEdge", "[", 
                RowBox[{
                 RowBox[{"Alternatives", "@@", "externalnodes"}], ",", "_"}], 
                "]"}], "|", 
               RowBox[{"UndirectedEdge", "[", 
                RowBox[{"_", ",", 
                 RowBox[{"Alternatives", "@@", "externalnodes"}]}], "]"}]}]}],
              "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"whichfacescouldyoubein", "=", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"DeleteDuplicates", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"#", "/.", 
                   RowBox[{
                    RowBox[{"{", "}"}], "\[Rule]", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"ii", ",", "ii"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"ii", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Length", "[", "internalfacenodes", "]"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"0", "\[Rule]", "1"}], "}"}]}], ")"}]}], "}"}]}], 
                    "]"}]}]}], ")"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], "&"}], ",", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"internalfacenodes", ",", 
                   RowBox[{"Alternatives", "@@", "#"}]}], "]"}], "&"}], ",", 
                "externaledges"}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"whichfacescouldyoubein", "\[Equal]", 
              RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"numcommonfaces", "=", "1"}], ";"}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{
              RowBox[{"numcommonfaces", "=", 
               RowBox[{"Length", "[", 
                RowBox[{"Intersection", "@@", "whichfacescouldyoubein"}], 
                "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"planaritycollapsed", "===", "True"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"numcommonfaces", "\[Equal]", "0"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{"\"\<kast=\>\"", ",", 
                   RowBox[{"{", 
                    RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], ",", 
                   "\"\< : There's a problem with planarityQ! We are on genus \
zero on a graph declared planar, and yet we don't have that B=1.\>\""}], 
                  "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"numcommonfaces", "\[GreaterEqual]", "1"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{"\"\<kast=\>\"", ",", 
                   RowBox[{"{", 
                    RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], ",", 
                   "\"\< : There's a problem with planarityQ! We are on genus \
zero on a graph declared nonplanar, and yet we have that B=1.\>\""}], "]"}], 
                 ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"planaritycollapsed", "=!=", "False"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{"\"\<kast=\>\"", ",", 
                RowBox[{"{", 
                 RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], ",", 
                "\"\< : There's a problem with planarityQ! When we don't \
collapse bivalent nodes, it gives that this example is planar even though it \
can't even be embedded on genus zero.\>\""}], "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DistributeDefinitions", "[", "allTestPlanarityQ", "]"}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.687515705982732*^9, 3.687515739851569*^9}, {
   3.6875157760283637`*^9, 3.687515779791551*^9}, 3.6875159489901147`*^9, {
   3.687516148047002*^9, 3.6875161502748933`*^9}, {3.68751903371249*^9, 
   3.687519042865605*^9}, {3.6875190801038055`*^9, 3.6875190914460974`*^9}, 
   3.6875196814560356`*^9, 3.6875198327355633`*^9, {3.6875228375914917`*^9, 
   3.687522898955289*^9}, {3.6875232754560323`*^9, 3.687523291166*^9}, 
   3.6875237028728943`*^9, {3.6875241146877403`*^9, 3.6875241255571136`*^9}, {
   3.687524465170884*^9, 3.6875244691256523`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ParallelMap", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"allTestPlanarityQ", "[", 
      RowBox[{"#", ",", "True"}], "]"}], "&"}], ",", 
    RowBox[{"Cases", "[", 
     RowBox[{"annoyingsmallexamples", ",", 
      RowBox[{"zz_", "/;", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"perfectMatchings", "@@", "zz"}], ")"}], "\[NotEqual]", 
        RowBox[{"{", "}"}]}]}]}], "]"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.6875198723503547`*^9, 3.687519875836772*^9}, 
   3.6875245879189672`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ParallelMap", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"allTestPlanarityQ", "[", 
      RowBox[{"#", ",", "True"}], "]"}], "&"}], ",", "allbft1kasteleyns"}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.68751988557037*^9, 3.687519895692232*^9}, {
  3.687524498596073*^9, 3.6875245090579877`*^9}, {3.687524579993471*^9, 
  3.6875245810175366`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"kast=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"2", ",", "3"}], "]"}], ",", 
         RowBox[{"X", "[", 
          RowBox[{"3", ",", "1"}], "]"}], ",", 
         RowBox[{"X", "[", 
          RowBox[{"1", ",", "2"}], "]"}], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"4", ",", "2"}], "]"}], ",", 
         RowBox[{"X", "[", 
          RowBox[{"1", ",", "4"}], "]"}], ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", 
         RowBox[{"X", "[", 
          RowBox[{"2", ",", "5"}], "]"}], ",", 
         RowBox[{"X", "[", 
          RowBox[{"6", ",", "2"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", 
         RowBox[{"X", "[", 
          RowBox[{"5", ",", "1"}], "]"}], ",", 
         RowBox[{"X", "[", 
          RowBox[{"1", ",", "6"}], "]"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", 
         RowBox[{"Y", "[", 
          RowBox[{"2", ",", "1"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"5", ",", "6"}], "]"}], ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"X", "[", 
          RowBox[{"6", ",", "5"}], "]"}], ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"3", ",", "4"}], "]"}], ",", "0", ",", "0", ",", "0"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"X", "[", 
          RowBox[{"4", ",", "3"}], "]"}], ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", 
         RowBox[{"X", "[", 
          RowBox[{"2", ",", "1"}], "]"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "}"}], 
   "\[InvisibleSpace]", "\<\" : There's a problem with planarityQ! We are on \
genus zero on a graph declared planar, and yet we don't have that B=1.\"\>"}],
  SequenceForm["kast=", {{{
      $CellContext`X[2, 3], 
      $CellContext`X[3, 1], 
      $CellContext`X[1, 2], 0}, {
      $CellContext`X[4, 2], 
      $CellContext`X[1, 4], 0, 0}, {0, 0, 
      $CellContext`X[2, 5], 
      $CellContext`X[6, 2]}, {0, 0, 
      $CellContext`X[5, 1], 
      $CellContext`X[1, 6]}}, {{0, 0, 0}, {0, 0, 
      $CellContext`Y[2, 1]}, {
      $CellContext`X[5, 6], 0, 0}, {0, 
      $CellContext`X[6, 5], 0}}, {{
      $CellContext`X[3, 4], 0, 0, 0}, {0, 
      $CellContext`X[4, 3], 0, 0}, {0, 0, 0, 
      $CellContext`X[2, 1]}}, {{0, 0, 0}, {0, 0, 0}, {0, 0, 0}}}, 
   " : There's a problem with planarityQ! We are on genus zero on a graph \
declared planar, and yet we don't have that B=1."],
  Editable->False]], "Print",
 ShowCellLabel->True,
 CellChangeTimes->{3.6875248103869743`*^9}],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.6875248336666365`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"ParallelMap", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"allTestPlanarityQ", "[", 
      RowBox[{"#", ",", "Null"}], "]"}], "&"}], ",", "allbft2kasteleyns"}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.6875245222860727`*^9, 3.6875245955327215`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ParallelMap", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"allTestPlanarityQ", "[", 
      RowBox[{"#", ",", "False"}], "]"}], "&"}], ",", 
    "allscatteringkasteleyns"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.687524549881817*^9, 3.687524567503231*^9}, {
  3.6875245993947444`*^9, 3.6875246003320465`*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.687525602805124*^9, 3.687525602852005*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"aa", ",", "bb", ",", "cc", ",", "dd"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"2", ",", "3"}], "]"}], ",", 
         RowBox[{"X", "[", 
          RowBox[{"3", ",", "1"}], "]"}], ",", 
         RowBox[{"X", "[", 
          RowBox[{"1", ",", "2"}], "]"}], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"4", ",", "2"}], "]"}], ",", 
         RowBox[{"X", "[", 
          RowBox[{"1", ",", "4"}], "]"}], ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", 
         RowBox[{"X", "[", 
          RowBox[{"2", ",", "5"}], "]"}], ",", 
         RowBox[{"X", "[", 
          RowBox[{"6", ",", "2"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", 
         RowBox[{"X", "[", 
          RowBox[{"5", ",", "1"}], "]"}], ",", 
         RowBox[{"X", "[", 
          RowBox[{"1", ",", "6"}], "]"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", 
         RowBox[{"Y", "[", 
          RowBox[{"2", ",", "1"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"5", ",", "6"}], "]"}], ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"X", "[", 
          RowBox[{"6", ",", "5"}], "]"}], ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"3", ",", "4"}], "]"}], ",", "0", ",", "0", ",", "0"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"X", "[", 
          RowBox[{"4", ",", "3"}], "]"}], ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", 
         RowBox[{"X", "[", 
          RowBox[{"2", ",", "1"}], "]"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"planaritycollapsed", "=", 
   RowBox[{"planarityQ", "[", 
    RowBox[{"aa", ",", "bb", ",", "cc", ",", "dd"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"aa", ",", "bb", ",", "cc", ",", "dd"}], "}"}], "//.", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "firstmat_", ",", "secondmat_", ",", "thirdmat_", ",", "fourthmat_"}], 
      "}"}], "\[RuleDelayed]", 
     RowBox[{"simplifyGraph", "[", 
      RowBox[{"firstmat", ",", 
       RowBox[{"(", 
        RowBox[{"secondmat", "/.", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "\[Rule]", "0"}], "&"}], ",", 
           RowBox[{"Flatten", "[", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ";;"}], "]"}], "]"}], "&"}], ",", 
              RowBox[{"Cases", "[", 
               RowBox[{
                RowBox[{"Map", "[", 
                 RowBox[{"Variables", ",", "secondmat"}], "]"}], ",", 
                RowBox[{"zz_", "/;", 
                 RowBox[{
                  RowBox[{"Length", "[", "zz", "]"}], ">", "1"}]}]}], "]"}]}],
              "]"}], "]"}]}], "]"}]}], ")"}], ",", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", "thebottomleft", "}"}], ",", 
          RowBox[{"Block", "[", 
           RowBox[{
            RowBox[{"{", "output", "}"}], ",", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", "thebottomleft", "]"}], ">", "0"}], 
               ",", 
               RowBox[{
                RowBox[{"output", "=", 
                 RowBox[{"thebottomleft", "/.", 
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", "\[Rule]", "0"}], "&"}], ",", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ";;"}], "]"}], "]"}], "&"}], ",", 
                    RowBox[{"Cases", "[", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Variables", ",", 
                    RowBox[{"Transpose", "[", "thebottomleft", "]"}]}], "]"}],
                     ",", 
                    RowBox[{"zz_", "/;", 
                    RowBox[{
                    RowBox[{"Length", "[", "zz", "]"}], ">", "1"}]}]}], 
                    "]"}]}], "]"}], "]"}]}], "]"}]}]}], ";"}], ",", 
               RowBox[{
                RowBox[{"output", "=", "thebottomleft"}], ";"}]}], "]"}], ";",
              "output"}]}], "]"}]}], "]"}], "[", "thirdmat", "]"}], ",", 
       "fourthmat"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"graph", "=", 
   RowBox[{"turnIntoGraph", "[", 
    RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "False"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"externalnodes", "=", 
    RowBox[{"getOrderingExternalNodesDefault", "[", 
     RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"choppedgraph", "=", 
  RowBox[{"Graph", "[", 
   RowBox[{
    RowBox[{"turnIntoGraph", "[", 
     RowBox[{
      RowBox[{"Sequence", "@@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], "/.", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "\[Rule]", "0"}], "&"}], ",", 
           RowBox[{"Variables", "[", 
            RowBox[{"{", 
             RowBox[{"b", ",", "c"}], "}"}], "]"}]}], "]"}]}], ")"}]}], ",", 
      "False"}], "]"}], ",", 
    RowBox[{"GraphLayout", "\[Rule]", "\"\<PlanarEmbedding\>\""}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"connectedcomponents", "=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Subgraph", "[", 
      RowBox[{"choppedgraph", ",", "#"}], "]"}], "&"}], ",", 
    RowBox[{"DeleteCases", "[", 
     RowBox[{
      RowBox[{"ConnectedComponents", "[", "choppedgraph", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"Alternatives", "@@", "externalnodes"}], "}"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"internalfacenodes", "=", 
  RowBox[{"DeleteCases", "[", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{"FindFace", ",", "connectedcomponents"}], "]"}], ",", 
    RowBox[{"zz_", "/;", 
     RowBox[{
      RowBox[{"Length", "[", "zz", "]"}], "\[LessEqual]", "1"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"internalfacenodes", "=", 
   RowBox[{"DeleteCases", "[", 
    RowBox[{
     RowBox[{"Append", "[", 
      RowBox[{
       RowBox[{"Join", "@@", 
        RowBox[{"internalfacenodes", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{";;", 
            RowBox[{"-", "2"}]}]}], "]"}], "]"}]}], ",", 
       RowBox[{"Join", "@@", 
        RowBox[{"internalfacenodes", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}]}], "]"}], ",", 
     RowBox[{"{", "}"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"externaledges", "=", 
   RowBox[{"Cases", "[", 
    RowBox[{
     RowBox[{"EdgeList", "[", "graph", "]"}], ",", 
     RowBox[{
      RowBox[{"UndirectedEdge", "[", 
       RowBox[{
        RowBox[{"Alternatives", "@@", "externalnodes"}], ",", "_"}], "]"}], 
      "|", 
      RowBox[{"UndirectedEdge", "[", 
       RowBox[{"_", ",", 
        RowBox[{"Alternatives", "@@", "externalnodes"}]}], "]"}]}]}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{"whichfacescouldyoubein", "=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"DeleteDuplicates", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"#", "/.", 
         RowBox[{
          RowBox[{"{", "}"}], "\[Rule]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"ii", ",", "ii"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"ii", ",", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Length", "[", "internalfacenodes", "]"}], "/.", 
                RowBox[{"{", 
                 RowBox[{"0", "\[Rule]", "1"}], "}"}]}], ")"}]}], "}"}]}], 
           "]"}]}]}], ")"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], "&"}], ",", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{"internalfacenodes", ",", 
         RowBox[{"Alternatives", "@@", "#"}]}], "]"}], "&"}], ",", 
      "externaledges"}], "]"}]}], "]"}]}]}], "Input"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14}, {Null, 
       SparseArray[
       Automatic, {14, 14}, 0, {
        1, {{0, 3, 5, 7, 9, 9, 9, 9, 11, 13, 16, 18, 18, 18, 18}, {{8}, {9}, {
          10}, {8}, {9}, {10}, {11}, {10}, {11}, {1}, {2}, {1}, {2}, {1}, {
          3}, {4}, {3}, {4}}}, Pattern}]}, {
      GraphLayout -> {"Dimension" -> 2, "VertexLayout" -> "PlanarEmbedding"}, 
       ImagePadding -> 20, VertexLabels -> {"Name"}, VertexLabelStyle -> {15},
        VertexSize -> {Medium}, 
       VertexStyle -> {
        6 -> GrayLevel[1], 1 -> GrayLevel[1], 9 -> GrayLevel[0], 13 -> 
         GrayLevel[0], 2 -> GrayLevel[1], 8 -> GrayLevel[0], 3 -> 
         GrayLevel[1], 4 -> GrayLevel[1], 11 -> GrayLevel[0], 10 -> 
         GrayLevel[0], 7 -> GrayLevel[1], 14 -> GrayLevel[0], 5 -> 
         GrayLevel[1], 12 -> GrayLevel[0]}}]]}, 
    TagBox[GraphicsGroupBox[{
       {Hue[0.6, 0.7, 0.5], Opacity[0.7], 
        {Arrowheads[0.], 
         ArrowBox[{{0.21429571428571403`, -5.214295714285714}, {
          0.21429571428571403`, -1.214295714285714}}, 0.05338164251207729]}, 
        {Arrowheads[0.], 
         ArrowBox[{{0.21429571428571403`, -5.214295714285714}, {
          3.214295714285714, -3.214295714285714}}, 0.05338164251207729]}, 
        {Arrowheads[0.], 
         ArrowBox[{{0.21429571428571403`, -5.214295714285714}, {
          4.214295714285714, -4.214295714285714}}, 0.05338164251207729]}, 
        {Arrowheads[0.], 
         ArrowBox[{{0.21429571428571403`, -0.21429571428571403`}, {
          0.21429571428571403`, -1.214295714285714}}, 0.05338164251207729]}, 
        {Arrowheads[0.], 
         ArrowBox[{{0.21429571428571403`, -0.21429571428571403`}, {
          3.214295714285714, -3.214295714285714}}, 0.05338164251207729]}, 
        {Arrowheads[0.], 
         ArrowBox[{{4.214295714285714, -2.214295714285714}, {
          4.214295714285714, -4.214295714285714}}, 0.05338164251207729]}, 
        {Arrowheads[0.], 
         ArrowBox[{{4.214295714285714, -2.214295714285714}, {
          6.214295714285714, -4.214295714285714}}, 0.05338164251207729]}, 
        {Arrowheads[0.], 
         ArrowBox[{{7.214295714285714, -5.214295714285714}, {
          4.214295714285714, -4.214295714285714}}, 0.05338164251207729]}, 
        {Arrowheads[0.], 
         ArrowBox[{{7.214295714285714, -5.214295714285714}, {
          6.214295714285714, -4.214295714285714}}, 0.05338164251207729]}}, 
       {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], {
         {GrayLevel[1], 
          DiskBox[{0.21429571428571403`, -5.214295714285714}, 
           0.04285914285714281]}, InsetBox[
          StyleBox["1",
           StripOnInput->False,
           FontSize->15], 
          Offset[{2, 2}, {0.25715485714285685`, -5.171436571428571}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {GrayLevel[1], 
          DiskBox[{0.21429571428571403`, -0.21429571428571403`}, 
           0.04285914285714281]}, InsetBox[
          StyleBox["2",
           StripOnInput->False,
           FontSize->15], 
          Offset[{2, 2}, {0.25715485714285685`, -0.17143657142857122`}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {GrayLevel[1], 
          DiskBox[{4.214295714285714, -2.214295714285714}, 
           0.04285914285714281]}, InsetBox[
          StyleBox["3",
           StripOnInput->False,
           FontSize->15], 
          Offset[{2, 2}, {4.257154857142857, -2.171436571428571}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {GrayLevel[1], 
          DiskBox[{7.214295714285714, -5.214295714285714}, 
           0.04285914285714281]}, InsetBox[
          StyleBox["4",
           StripOnInput->False,
           FontSize->15], 
          Offset[{2, 2}, {7.257154857142857, -5.171436571428571}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {GrayLevel[1], 
          DiskBox[{6.40478857142857, -5.642887142857142}, 
           0.04285914285714281]}, InsetBox[
          StyleBox["5",
           StripOnInput->False,
           FontSize->15], 
          Offset[{2, 2}, {6.447647714285713, -5.600027999999999}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {GrayLevel[1], 
          DiskBox[{0.21429571428571428`, -5.642887142857142}, 
           0.04285914285714281]}, InsetBox[
          StyleBox["6",
           StripOnInput->False,
           FontSize->15], 
          Offset[{2, 2}, {0.2571548571428571, -5.600027999999999}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {GrayLevel[1], 
          DiskBox[{1.4523942857142855`, -5.642887142857142}, 
           0.04285914285714281]}, InsetBox[
          StyleBox["7",
           StripOnInput->False,
           FontSize->15], 
          Offset[{2, 2}, {1.4952534285714283`, -5.600027999999999}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {GrayLevel[0], 
          DiskBox[{0.21429571428571403`, -1.214295714285714}, 
           0.04285914285714281]}, InsetBox[
          StyleBox["8",
           StripOnInput->False,
           FontSize->15], 
          Offset[{2, 2}, {0.25715485714285685`, -1.1714365714285713`}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {GrayLevel[0], 
          DiskBox[{3.214295714285714, -3.214295714285714}, 
           0.04285914285714281]}, InsetBox[
          StyleBox["9",
           StripOnInput->False,
           FontSize->15], 
          Offset[{2, 2}, {3.257154857142857, -3.171436571428571}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {GrayLevel[0], 
          DiskBox[{4.214295714285714, -4.214295714285714}, 
           0.04285914285714281]}, InsetBox[
          StyleBox["10",
           StripOnInput->False,
           FontSize->15], 
          Offset[{2, 2}, {4.257154857142857, -4.171436571428571}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {GrayLevel[0], 
          DiskBox[{6.214295714285714, -4.214295714285714}, 
           0.04285914285714281]}, InsetBox[
          StyleBox["11",
           StripOnInput->False,
           FontSize->15], 
          Offset[{2, 2}, {6.257154857142857, -4.171436571428571}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {GrayLevel[0], 
          DiskBox[{2.690492857142857, -5.642887142857142}, 
           0.04285914285714281]}, InsetBox[
          StyleBox["12",
           StripOnInput->False,
           FontSize->15], Offset[{2, 2}, {2.733352, -5.600027999999999}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {GrayLevel[0], 
          DiskBox[{3.9285914285714285`, -5.642887142857142}, 
           0.04285914285714281]}, InsetBox[
          StyleBox["13",
           StripOnInput->False,
           FontSize->15], 
          Offset[{2, 2}, {3.9714505714285715`, -5.600027999999999}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {
         {GrayLevel[0], 
          DiskBox[{5.166689999999999, -5.642887142857142}, 
           0.04285914285714281]}, InsetBox[
          StyleBox["14",
           StripOnInput->False,
           FontSize->15], 
          Offset[{2, 2}, {5.209549142857142, -5.600027999999999}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FrameTicks->None,
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->20]], "Output",
 CellChangeTimes->{3.6875256054639225`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  GraphicsBox[
   NamespaceBox["NetworkGraphics",
    DynamicModuleBox[{Typeset`graph = HoldComplete[
      Graph[{1, 8, 9, 10, 2, 3, 4, 11}, {Null, 
        SparseArray[
        Automatic, {8, 8}, 0, {
         1, {{0, 3, 5, 7, 10, 12, 14, 16, 18}, {{2}, {3}, {4}, {1}, {5}, {
           1}, {5}, {1}, {6}, {7}, {2}, {3}, {4}, {8}, {4}, {8}, {6}, {7}}}, 
          Pattern}]}]]}, 
     TagBox[
      GraphicsGroupBox[
       GraphicsComplexBox[{{3.0396828120467125`, 0.4170401802472364}, {
        3.992156945323891, 0.}, {3.99165605669015, 0.8342779174054581}, {
        1.6858535974175446`, 0.41723272772116904`}, {4.723858420094968, 
        0.4174215414127728}, {0.7334653265297271, 0.00009847532004969572}, {
        0.7332133855914253, 0.8343760855122592}, {0., 0.41709770893504633`}}, {
         {Hue[0.6, 0.7, 0.5], Opacity[0.7], 
          {Arrowheads[0.], ArrowBox[{1, 2}, 0.04144510588408598]}, 
          {Arrowheads[0.], ArrowBox[{1, 3}, 0.04144510588408598]}, 
          {Arrowheads[0.], ArrowBox[{1, 4}, 0.04144510588408598]}, 
          {Arrowheads[0.], ArrowBox[{2, 5}, 0.04144510588408598]}, 
          {Arrowheads[0.], ArrowBox[{3, 5}, 0.04144510588408598]}, 
          {Arrowheads[0.], ArrowBox[{4, 6}, 0.04144510588408598]}, 
          {Arrowheads[0.], ArrowBox[{4, 7}, 0.04144510588408598]}, 
          {Arrowheads[0.], ArrowBox[{6, 8}, 0.04144510588408598]}, 
          {Arrowheads[0.], ArrowBox[{7, 8}, 0.04144510588408598]}}, 
         {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
          DiskBox[1, 0.04144510588408598], DiskBox[2, 0.04144510588408598], 
          DiskBox[3, 0.04144510588408598], DiskBox[4, 0.04144510588408598], 
          DiskBox[5, 0.04144510588408598], DiskBox[6, 0.04144510588408598], 
          DiskBox[7, 0.04144510588408598], DiskBox[8, 0.04144510588408598]}}]],
      MouseAppearanceTag["NetworkGraphics"]],
     AllowKernelInitialization->False]],
   DefaultBaseStyle->{
    "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
   FrameTicks->None,
   GridLinesStyle->Directive[
     GrayLevel[0.5, 0.4]]], "}"}]], "Output",
 CellChangeTimes->{3.6875256055108004`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "8", ",", "2", ",", "9"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "9", ",", "2", ",", "8"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "10", ",", "4", ",", "11", ",", "3", ",", "10"}], 
     "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"10", ",", "3", ",", "11", ",", "4"}], "}"}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.687525605526424*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "8", ",", "2", ",", "9"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "9", ",", "2", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "10", ",", "4", ",", "11", ",", "3", ",", "10"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{"10", ",", "3", ",", "11", ",", "4"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.687525605526424*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6875256055420513`*^9}]
}, Open  ]]
},
WindowSize->{1366, 685},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"10.2 for Microsoft Windows (64-bit) (July 7, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 20672, 486, 1492, "Input"],
Cell[21233, 508, 547, 15, 31, "Input"],
Cell[CellGroupData[{
Cell[21805, 527, 390, 10, 31, "Input"],
Cell[22198, 539, 3417, 94, 62, "Print"],
Cell[25618, 635, 79, 1, 31, "Output"]
}, Open  ]],
Cell[25712, 639, 293, 8, 31, "Input"],
Cell[26008, 649, 350, 9, 31, "Input"],
Cell[26361, 660, 146, 2, 72, "Input"],
Cell[CellGroupData[{
Cell[26532, 666, 9570, 271, 452, "Input"],
Cell[36105, 939, 7841, 182, 306, "Output"],
Cell[43949, 1123, 2192, 40, 58, "Output"],
Cell[46144, 1165, 477, 14, 31, "Output"],
Cell[46624, 1181, 440, 12, 31, "Output"],
Cell[47067, 1195, 451, 15, 31, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
