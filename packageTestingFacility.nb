(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[   1395990,      35056]
NotebookOptionsPosition[   1389915,      34895]
NotebookOutlinePosition[   1390277,      34911]
CellTagsIndexPosition[   1390234,      34908]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "bipartiteSUSY.m"}]}], "Input",
 CellChangeTimes->{{3.6616922986967053`*^9, 3.661692334211833*^9}, 
   3.6645297915320587`*^9, {3.664542240753628*^9, 3.6645422474264593`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"These", " ", "functions", " ", "are", " ", 
   RowBox[{"NEW", ":", "           ", 
    RowBox[{
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", "--"}]}]}], ">", "     ", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", "--"}]}]}], ">", "     ", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", "--"}]}]}], ">", "     ", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", "--"}]}]}], ">", "     ", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", "--"}]}]}], ">", "     ", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", "--"}]}]}], ">"}]}]}], "  ", "*)"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.662277791653617*^9, 3.6622778116713*^9}, 
   3.6622901088542557`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Returns", " ", "a", " ", "list", " ", "of", " ", "paths", " ", "that", 
     " ", "form", " ", "a", " ", "basis", " ", "with", " ", "which", " ", 
     "it", " ", "is", " ", "possible", " ", "to", " ", "express", " ", "any", 
     " ", "path", " ", "in", " ", "the", " ", 
     RowBox[{"graph", ".", " ", "The"}], " ", "output", " ", "is", " ", "of", 
     " ", "the", " ", "form", " ", "of", " ", "three", " ", 
     RowBox[{"lists", ":", " ", 
      RowBox[{
      "the", " ", "first", " ", "one", " ", "contains", " ", "the", " ", 
       "internal", " ", "faces"}]}]}], ",", " ", 
    RowBox[{
     RowBox[{"and", " ", "if", " ", "the", " ", "optional", " ", 
      RowBox[{"input", " ", "'"}], 
      RowBox[{"standardfacevariables", "'"}], " ", "is", " ", "False", " ", 
      "it", " ", "also", " ", "contains", " ", "non"}], "-", 
     RowBox[{
     "trivial", " ", "cycles", " ", "around", " ", "surfaces", " ", "with", 
      " ", "non"}], "-", 
     RowBox[{
     "zero", " ", "genus", " ", "as", " ", "well", " ", "as", " ", "products",
       " ", "of", " ", "external", " ", "faces", " ", "which", " ", "circle", 
      " ", "around", " ", "a", " ", 
      RowBox[{"boundary", ".", " ", "The"}], " ", "first", " ", "list", " ", 
      "will", " ", "generically", " ", "be", " ", "a", " ", "linear", " ", 
      "combination", " ", "of", " ", "these", " ", 
      RowBox[{"paths", ".", " ", "The"}], " ", "second", " ", "entry", " ", 
      "contains", " ", "external", " ", "faces"}]}], ",", " ", 
    RowBox[{
     RowBox[{"and", " ", 
      RowBox[{"if", " ", "'"}], 
      RowBox[{"standardfacevariables", "'"}], " ", "is", " ", "True", " ", 
      "it", " ", "also", " ", "contains", " ", "non"}], "-", 
     RowBox[{"trivial", " ", "cycles", " ", "for", " ", "non"}], "-", 
     RowBox[{"zero", " ", 
      RowBox[{"genus", ".", " ", "The"}], " ", "third", " ", "entry", " ", 
      "contains", " ", "paths", " ", "going", " ", "between", " ", 
      "different", " ", 
      RowBox[{"boundaries", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"makeLoopVariablesBasis", "[", 
     RowBox[{
     "topleft_", ",", "topright_", ",", "bottomleft_", ",", "bottomright_", 
      ",", 
      RowBox[{"standardfacevariables_:", "False"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "externaledges", ",", "boundaries", ",", "oldexpression", ",", 
        "bpathendpoints", ",", "bpaths", ",", "adjacencymat", ",", "graph", 
        ",", "externaledgestonodenumbers", ",", "kasteleyn", ",", 
        "bigkasteleyn", ",", "nameUndirectedEdges", ",", "directedgraph", ",",
         "nameDirectedEdges", ",", "edgelist", ",", "internalpaths", ",", 
        "alledges", ",", "boundaryfaces", ",", "missingexternalfaces", ",", 
        "loopvariablebasis", ",", "facenames", ",", "facevariables", ",", 
        "facevariablevectors", ",", "coef", ",", "tosolvefor", ",", 
        "coeflist", ",", "basisvectors", ",", "nontrivialpaths", ",", 
        "genuspaths", ",", "accountedforvectors", ",", 
        "internalfacevariables", ",", "externalfacevariables"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"externaledges", "=", 
        RowBox[{"Variables", "[", 
         RowBox[{"Join", "[", 
          RowBox[{"bottomleft", ",", "topright"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"boundaries", "=", 
        RowBox[{"Gather", "[", 
         RowBox[{"externaledges", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Intersection", "[", 
             RowBox[{
              RowBox[{"List", "@@", "#1"}], ",", 
              RowBox[{"List", "@@", "#2"}]}], "]"}], "=!=", 
            RowBox[{"{", "}"}]}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"The", " ", "Gather", " ", "function", " ", 
          RowBox[{"doesn", "'"}], "t", " ", "work", " ", "recursively"}], ",",
          " ", 
         RowBox[{
         "so", " ", "we", " ", "must", " ", "Gather", " ", "edges", " ", 
          "into", " ", "boundaries", " ", "until", " ", "there", " ", "is", 
          " ", "nothing", " ", "left", " ", "to", " ", "gather"}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"oldexpression", "=", "Null"}], ";", "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{"oldexpression", "=!=", "boundaries"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"oldexpression", "=", "boundaries"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"boundaries", "=", 
           RowBox[{"Map", "[", 
            RowBox[{"Flatten", ",", 
             RowBox[{"Gather", "[", 
              RowBox[{"boundaries", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Intersection", "[", 
                  RowBox[{
                   RowBox[{"Flatten", "[", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"List", "@@", "#"}], "&"}], ",", "#1"}], "]"}], 
                    "]"}], ",", 
                   RowBox[{"Flatten", "[", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"List", "@@", "#"}], "&"}], ",", "#2"}], "]"}], 
                    "]"}]}], "]"}], "=!=", 
                 RowBox[{"{", "}"}]}], "&"}]}], "]"}]}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Now", " ", "we", " ", "have", " ", "the", " ", "boundaries"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"bpathendpoints", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", "boundaries"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"bpaths", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"bpathendpoints", "[", 
             RowBox[{"[", "iii", "]"}], "]"}], ",", 
            RowBox[{"bpathendpoints", "[", 
             RowBox[{"[", 
              RowBox[{"iii", "+", "1"}], "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"iii", ",", 
            RowBox[{
             RowBox[{"Length", "[", "bpathendpoints", "]"}], "-", "1"}]}], 
           "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "For", " ", "now", " ", "bpaths", " ", "only", " ", "contain", " ", 
          "the", " ", "external", " ", 
          RowBox[{"edges", ".", " ", 
           RowBox[{"We", "'"}]}], "ll", " ", "now", " ", "look", " ", "for", 
          " ", "the", " ", "shortest", " ", "path", " ", "between", " ", 
          "these", " ", "edges"}], ",", " ", 
         RowBox[{
         "to", " ", "complete", " ", "the", " ", "paths", " ", "between", " ",
           "boundaries"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"adjacencymat", "=", 
        RowBox[{"getAdjacencyMatrix", "[", 
         RowBox[{
         "topleft", ",", "topright", ",", "bottomleft", ",", "bottomright"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"graph", "=", 
        RowBox[{"AdjacencyGraph", "[", "adjacencymat", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"externaledgestonodenumbers", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Rule", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{"DeleteCases", "[", 
              RowBox[{
               RowBox[{"Join", "[", 
                RowBox[{"bottomleft", ",", 
                 RowBox[{"Transpose", "[", "topright", "]"}]}], "]"}], ",", 
               "0", ",", 
               RowBox[{"{", "2", "}"}]}], "]"}], "]"}], ",", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Range", "[", 
                RowBox[{"Length", "[", "bottomleft", "]"}], "]"}], "+", 
               RowBox[{"Length", "[", "topleft", "]"}]}], ",", 
              RowBox[{
               RowBox[{"Range", "[", 
                RowBox[{
                 RowBox[{"Dimensions", "[", "topright", "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], "+", 
               RowBox[{"Total", "[", 
                RowBox[{"Dimensions", "[", "topleft", "]"}], "]"}], "+", 
               RowBox[{"Length", "[", "bottomleft", "]"}]}]}], "]"}]}], 
           "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"bpaths", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"UndirectedEdge", "[", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "iii", "]"}], "]"}], ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", 
                 RowBox[{"iii", "+", "1"}], "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"iii", ",", 
               RowBox[{
                RowBox[{"Length", "[", "#", "]"}], "-", "1"}]}], "}"}]}], 
            "]"}], "&"}], ",", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"FindShortestPath", "[", 
              RowBox[{"graph", ",", 
               RowBox[{"Sequence", "@@", "#"}]}], "]"}], "&"}], ",", 
            RowBox[{"bpaths", "/.", "externaledgestonodenumbers"}]}], "]"}]}],
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Now", " ", "each", " ", "boundary", " ", "path", " ", "is", " ", 
         "expressed", " ", "as", " ", "a", " ", "list", " ", "of", " ", 
         "directed", " ", "edges", " ", "that", " ", "go", " ", "from", " ", 
         "one", " ", "boundary", " ", "to", " ", "the", " ", 
         RowBox[{"next", ".", " ", "We"}], " ", "need", " ", "to", " ", 
         "turn", " ", "these", " ", "directed", " ", "edges", " ", "into", 
         " ", "a", " ", "product", " ", "of", " ", "edges"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"kasteleyn", "=", 
        RowBox[{"joinupKasteleyn", "[", 
         RowBox[{
         "topleft", ",", "topright", ",", "bottomleft", ",", "bottomright"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"bigkasteleyn", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"kasteleyn", ",", 
          RowBox[{"Transpose", "[", "kasteleyn", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"nameUndirectedEdges", "=", 
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", "undirectededge", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Block", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"edgename", ",", "edgeweight"}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"edgename", "=", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"Intersection", "@@", 
                 RowBox[{"Map", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Variables", "[", 
                    RowBox[{"bigkasteleyn", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "]"}], "&"}], ",", 
                   RowBox[{"List", "@@", "undirectededge"}]}], "]"}]}], ")"}],
                "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"undirectededge", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "<", 
                RowBox[{"undirectededge", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"edgeweight", "=", "edgename"}], ";"}], 
               "\[IndentingNewLine]", ",", 
               RowBox[{
                RowBox[{"edgeweight", "=", 
                 RowBox[{"1", "/", "edgename"}]}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             "edgeweight"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"bpaths", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Times", "@@", "#"}], "&"}], ",", 
          RowBox[{"Map", "[", 
           RowBox[{"nameUndirectedEdges", ",", "bpaths", ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "Now", " ", "we", " ", "have", " ", "the", " ", "paths", " ", 
          "running", " ", "between", " ", "different", " ", "boundaries"}], 
         ",", " ", 
         RowBox[{
         "expressed", " ", "as", " ", "products", " ", "of", " ", "edge", " ",
           "variables"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "We", " ", "shall", " ", "now", " ", "make", " ", "all", " ", 
          "internal", " ", 
          RowBox[{"paths", ".", " ", "These"}], " ", "contain", " ", "all", 
          " ", "internal", " ", "faces"}], ",", " ", 
         RowBox[{"non", "-", 
          RowBox[{"trivial", " ", "paths", " ", "around", " ", "higher"}], 
          "-", "genus"}], ",", " ", 
         RowBox[{
         "and", " ", "products", " ", "of", " ", "external", " ", "faces", 
          " ", "around", " ", "each", " ", "boundary"}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "We", " ", "start", " ", "from", " ", "a", " ", "direct", " ", 
          "graph"}], ",", " ", 
         RowBox[{
         "as", " ", "this", " ", "will", " ", "allow", " ", "us", " ", "to", 
          " ", "understand", " ", "the", " ", "direction", " ", "of", " ", 
          "our", " ", "internal", " ", "loops"}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"directedgraph", "=", 
        RowBox[{"AdjacencyGraph", "[", 
         RowBox[{"UpperTriangularize", "[", "adjacencymat", "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"nameDirectedEdges", "=", 
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", "directededge", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Block", "[", 
           RowBox[{
            RowBox[{"{", "edgename", "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"edgename", "=", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"Intersection", "@@", 
                 RowBox[{"Map", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Variables", "[", 
                    RowBox[{"bigkasteleyn", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "]"}], "&"}], ",", 
                   RowBox[{"List", "@@", "directededge"}]}], "]"}]}], ")"}], 
               "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"bigkasteleyn", "=", 
              RowBox[{"bigkasteleyn", "/.", 
               RowBox[{"{", 
                RowBox[{"edgename", "\[Rule]", "0"}], "}"}]}]}], ";", 
             "\[IndentingNewLine]", "edgename"}]}], "]"}]}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"edgelist", "=", 
        RowBox[{"Map", "[", 
         RowBox[{"nameDirectedEdges", ",", 
          RowBox[{"EdgeList", "[", "directedgraph", "]"}]}], "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"watch", " ", 
          RowBox[{"out", "!"}], " ", "I", " ", "have", " ", "now", " ", 
          "changed", " ", 
          RowBox[{"bigkasteleyn", "!"}], " ", "If", " ", "you", " ", "need", 
          " ", "it", " ", "again"}], ",", " ", 
         RowBox[{
          RowBox[{"you", "'"}], "ll", " ", "need", " ", "to", " ", "reset", 
          " ", "it"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"internalpaths", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Times", "@@", 
            RowBox[{"Power", "[", 
             RowBox[{"edgelist", ",", "#"}], "]"}]}], "&"}], ",", 
          RowBox[{"Normal", "[", 
           RowBox[{"EdgeCycleMatrix", "[", "directedgraph", "]"}], "]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "The", " ", "only", " ", "paths", " ", "that", " ", "I", " ", 
          "still", " ", "need", " ", "are", " ", "some", " ", "external", " ",
           "face", " ", 
          RowBox[{"variables", ":", " ", 
           RowBox[{"around", " ", "each", " ", "boundary"}]}]}], ",", " ", 
         RowBox[{
         "I", " ", "only", " ", "need", " ", "to", " ", "report", " ", "all", 
          " ", "but", " ", "one", " ", "external", " ", "faces", " ", 
          "belonging", " ", "to", " ", "that", " ", 
          RowBox[{"boundary", ".", " ", "Then"}], " ", "we", " ", "will", " ",
           "have", " ", "completed", " ", "our", " ", "path", " ", 
          RowBox[{"basis", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"alledges", "=", 
        RowBox[{"Variables", "[", "kasteleyn", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"boundaryfaces", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Union", "[", 
            RowBox[{"Flatten", "[", "#", "]"}], "]"}], "&"}], ",", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"List", "@@", "#"}], "&"}], ",", "boundaries", ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "these", " ", "are", " ", "the", " ", "face", " ", "names", " ", 
         "around", " ", "each", " ", "boundary"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"missingexternalfaces", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"Range", "[", 
               RowBox[{
                RowBox[{"Length", "[", "#", "]"}], "-", "1"}], "]"}], "]"}], 
             "]"}], "&"}], ",", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"Times", "@@", 
                 RowBox[{"Cases", "[", 
                  RowBox[{"alledges", ",", 
                   RowBox[{"_", "[", 
                    RowBox[{"_", ",", "#"}], "]"}]}], "]"}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{"Times", "@@", 
                 RowBox[{"Cases", "[", 
                  RowBox[{"alledges", ",", 
                   RowBox[{"_", "[", 
                    RowBox[{"#", ",", "_"}], "]"}]}], "]"}]}], ")"}]}], "&"}],
              ",", "boundaryfaces", ",", 
             RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"loopvariablebasis", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", "internalpaths", "}"}], ",", 
          RowBox[{"{", "missingexternalfaces", "}"}], ",", 
          RowBox[{"{", "bpaths", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"standardfacevariables", ",", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"We", "'"}], "ll", " ", "change", " ", "basis", " ", 
             "such", " ", "that", " ", "we", " ", "only", " ", "have", " ", 
             "the", " ", "nontrivial", " ", "cycles", " ", "around", " ", 
             "high"}], "-", 
            RowBox[{"genus", " ", "surfaces"}]}], ",", " ", 
           RowBox[{"face", " ", "variables"}], ",", 
           RowBox[{
           "and", " ", "paths", " ", "stretching", " ", "between", " ", 
            "different", " ", "boundaries"}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"We", "'"}], "ll", " ", "start", " ", "by", " ", "making", 
           " ", "all", " ", "the", " ", "face", " ", "variables"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"facenames", "=", 
           RowBox[{"Union", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"List", "@@", "#"}], "&"}], ",", "alledges"}], "]"}], 
             "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"facevariables", "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"Times", "@@", 
                 RowBox[{"Cases", "[", 
                  RowBox[{"alledges", ",", 
                   RowBox[{"_", "[", 
                    RowBox[{"_", ",", "#"}], "]"}]}], "]"}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{"Times", "@@", 
                 RowBox[{"Cases", "[", 
                  RowBox[{"alledges", ",", 
                   RowBox[{"_", "[", 
                    RowBox[{"#", ",", "_"}], "]"}]}], "]"}]}], ")"}]}], "&"}],
              ",", "facenames"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
             RowBox[{"We", "'"}], "ll", " ", "now", " ", "need", " ", "to", 
             " ", "see", " ", "whichof", " ", "the", " ", "internalpaths", 
             " ", "are", " ", "simply", " ", "products", " ", "of", " ", 
             "internal", " ", "faces"}], ",", " ", 
            RowBox[{
             RowBox[{
             "and", " ", "which", " ", "ones", " ", "wrap", " ", "non"}], "-", 
             RowBox[{
             "trivial", " ", "cycles", " ", "around", " ", "a", " ", 
              "higher"}], "-", 
             RowBox[{"genus", " ", "surface"}]}]}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"facevariablevectors", "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"D", "[", 
                  RowBox[{"#", ",", 
                   RowBox[{"alledges", "[", 
                    RowBox[{"[", "iii", "]"}], "]"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"iii", ",", 
                   RowBox[{"Length", "[", "alledges", "]"}]}], "}"}]}], "]"}],
                "/.", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "\[Rule]", "1"}], "&"}], ",", "alledges"}], 
                "]"}]}], "&"}], ",", "facevariables"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"tosolvefor", "=", 
           RowBox[{"Total", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"coef", "[", "iii", "]"}], 
               RowBox[{"facevariablevectors", "[", 
                RowBox[{"[", "iii", "]"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"iii", ",", 
                RowBox[{
                 RowBox[{"Length", "[", "facevariablevectors", "]"}], "-", 
                 "1"}]}], "}"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"coeflist", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"coef", "[", "iii", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"iii", ",", 
               RowBox[{
                RowBox[{"Length", "[", "facevariablevectors", "]"}], "-", 
                "1"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Let", "'"}], "s", " ", "turn", " ", "the", " ", 
            "internalpaths", " ", "into", " ", "vectors"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"basisvectors", "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"D", "[", 
                  RowBox[{"#", ",", 
                   RowBox[{"alledges", "[", 
                    RowBox[{"[", "iii", "]"}], "]"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"iii", ",", 
                   RowBox[{"Length", "[", "alledges", "]"}]}], "}"}]}], "]"}],
                "/.", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "\[Rule]", "1"}], "&"}], ",", "alledges"}], 
                "]"}]}], "&"}], ",", "internalpaths"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "These", " ", "are", " ", "the", " ", "paths", " ", "in", " ", 
            "our", " ", "basis", " ", "that", " ", "are", " ", "not", " ", 
            "purely", " ", "expressibly", " ", "in", " ", "terms", " ", "of", 
            " ", "faces"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"nontrivialpaths", "=", 
           RowBox[{"Cases", "[", 
            RowBox[{"basisvectors", ",", 
             RowBox[{"zz_", "/;", 
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"Solve", "[", 
                 RowBox[{
                  RowBox[{"tosolvefor", "\[Equal]", "zz"}], ",", "coeflist"}],
                  "]"}], "]"}], "\[Equal]", "0"}]}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
             RowBox[{"We", "'"}], "ll", " ", "now", " ", "add", " ", 
             "independent", " ", "non"}], "-", 
            RowBox[{"trivial", " ", "cycles", " ", 
             RowBox[{"(", 
              RowBox[{"in", " ", "vector", " ", "form"}], ")"}], " ", "to", 
             " ", "a", " ", "list", " ", "called", " ", "genuspaths"}]}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"genuspaths", "=", 
           RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"accountedforvectors", "=", "facevariablevectors"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{"nontrivialpaths", "=!=", 
             RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"genuspaths", "=", 
              RowBox[{"Append", "[", 
               RowBox[{"genuspaths", ",", 
                RowBox[{"nontrivialpaths", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"accountedforvectors", "=", 
              RowBox[{"Prepend", "[", 
               RowBox[{"accountedforvectors", ",", 
                RowBox[{"nontrivialpaths", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"tosolvefor", "=", 
              RowBox[{"tosolvefor", "+", 
               RowBox[{
                RowBox[{"accountedforvectors", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], 
                RowBox[{"coef", "[", 
                 RowBox[{
                  RowBox[{"Length", "[", "accountedforvectors", "]"}], "-", 
                  "1"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"coeflist", "=", 
              RowBox[{"Append", "[", 
               RowBox[{"coeflist", ",", 
                RowBox[{"coef", "[", 
                 RowBox[{
                  RowBox[{"Length", "[", "accountedforvectors", "]"}], "-", 
                  "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"nontrivialpaths", "=", 
              RowBox[{"Cases", "[", 
               RowBox[{"nontrivialpaths", ",", 
                RowBox[{"zz_", "/;", 
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"Solve", "[", 
                    RowBox[{
                    RowBox[{"tosolvefor", "\[Equal]", "zz"}], ",", 
                    "coeflist"}], "]"}], "]"}], "\[Equal]", "0"}]}]}], 
               "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
            "We", " ", "now", " ", "have", " ", "all", " ", "paths", " ", 
             "wrapping", " ", "non"}], "-", 
            RowBox[{
            "trivial", " ", "cycles", " ", "on", " ", "the", " ", "higher"}], 
            "-", 
            RowBox[{"genus", " ", 
             RowBox[{"surface", ".", " ", "Turn"}], " ", "these", " ", "into",
              " ", "products", " ", "of", " ", "edges"}]}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"genuspaths", "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Times", "@@", 
               RowBox[{"Power", "[", 
                RowBox[{"alledges", ",", "#"}], "]"}]}], "&"}], ",", 
             "genuspaths"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"We", "'"}], "ll", " ", "split", " ", "the", " ", 
            "internal", " ", "faces", " ", "from", " ", "the", " ", 
            "external", " ", "ones"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"internalfacevariables", "=", 
           RowBox[{"facevariables", "[", 
            RowBox[{"[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"Position", "[", 
               RowBox[{"facenames", ",", 
                RowBox[{"Alternatives", "@@", 
                 RowBox[{"internalFaceLabels", "[", 
                  RowBox[{
                  "topleft", ",", "topright", ",", "bottomleft", ",", 
                   "bottomright"}], "]"}]}]}], "]"}], "]"}], "]"}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"externalfacevariables", "=", 
           RowBox[{"Complement", "[", 
            RowBox[{"facevariables", ",", "internalfacevariables"}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
            "We", " ", "now", " ", "remove", " ", "one", " ", "face", " ", 
             "from", " ", "the", " ", "total"}], ",", " ", 
            RowBox[{
            "since", " ", "they", " ", "are", " ", "not", " ", "all", " ", 
             RowBox[{"independent", ".", " ", "If"}], " ", "we", " ", "only", 
             " ", "have", " ", "internal", " ", "faces"}], ",", " ", 
            RowBox[{"remove", " ", "one", " ", "of", " ", 
             RowBox[{"those", ".", " ", "Otherwise"}], " ", "remove", " ", 
             "an", " ", "external", " ", "face"}]}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "internalfacevariables", "]"}], 
             "\[Equal]", 
             RowBox[{"Length", "[", "facevariables", "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"internalfacevariables", "=", 
              RowBox[{"internalfacevariables", "[", 
               RowBox[{"[", 
                RowBox[{"Range", "[", 
                 RowBox[{
                  RowBox[{"Length", "[", "internalfacevariables", "]"}], "-", 
                  "1"}], "]"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
            ",", 
            RowBox[{
             RowBox[{"externalfacevariables", "=", 
              RowBox[{"externalfacevariables", "[", 
               RowBox[{"[", 
                RowBox[{"Range", "[", 
                 RowBox[{
                  RowBox[{"Length", "[", "externalfacevariables", "]"}], "-", 
                  "1"}], "]"}], "]"}], "]"}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"loopvariablebasis", "=", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", "internalfacevariables", "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"Join", "[", 
               RowBox[{"genuspaths", ",", "externalfacevariables"}], "]"}], 
              "}"}], ",", 
             RowBox[{"{", "bpaths", "}"}]}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "loopvariablebasis"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQBGIQ/e1wClO/72vHRceVWUB0jIGr/1ogLSIckAyiT+q9
/74OSH+r1v4Jos9w7xbfAqQPqV6TBtG32JWbtgHpJ+zqYHrHOa67IJohqOEZ
iA7m/7NxB5Cu5mfZBKKTrnA67gTS777W+oLodeUXjx4A0llfQk6AaK2nf6+A
6ApFwRsguoND+A6Yv3LrKxD9jrHc8yCQZvn41xdE7zvwOhBEqz0OiADRqnde
xYDoqlUT40A03/UvZ0B05O+6qyBaKsv6Llj9ji4w7RJw4DmI/v/+znsQLdBj
pHALSJ9+dEIVRDtfZNAD0Q4vb1qC6AdR0W4getuVeE8Qfe/H8hAQ7ZIdHAqi
78gnJ4DoKY59YNqH+VoKiF502T0XRIfLbWoB0W/Dp84D0e3+BQH3gbTH59xa
EA0ANHPW4A==
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Returns", " ", "a", " ", "list", " ", "of", " ", "three", " ", 
     RowBox[{"items", ":", " ", 
      RowBox[{
      "the", " ", "first", " ", "is", " ", "the", " ", "master", " ", 
       "space"}]}]}], ",", " ", 
    RowBox[{
    "the", " ", "second", " ", "is", " ", "the", " ", "moduli", " ", 
     "space"}], ",", " ", 
    RowBox[{
    "and", " ", "the", " ", "third", " ", "is", " ", "the", " ", "loop", " ", 
     "variable", " ", "basis", " ", "used", " ", "to", " ", "make", " ", 
     "these", " ", 
     RowBox[{"spaces", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"moduliLoopVariablesBFT", "[", 
      RowBox[{
      "topleft_", ",", "topright_", ",", "bottomleft_", ",", "bottomright_", 
       ",", "gauging_", ",", 
       RowBox[{"referencematching_:", "Null"}], ",", 
       RowBox[{"loopvariablebasis_:", "Null"}]}], "]"}], "/;", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"gauging", "===", "1"}], "||", 
       RowBox[{"gauging", "===", "2"}]}], ")"}]}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "perfmatchings", ",", "referenceperfmatch", ",", "basispaths", ",", 
        "basis", ",", "kasteleyn", ",", "allvariables", ",", 
        "perfmatchingvectors", ",", "basisvectors", ",", "tosolvefor", ",", 
        "coef", ",", "coeflist", ",", "perfmatchingsasloops", ",", 
        "masterspace", ",", "modulispace", ",", "internalfacenames", ",", 
        "internalfacevariables", ",", "internalfacevariablevectors", ",", 
        "internalfacesasbasispaths", ",", "vectorMod"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"edgesBFTformQ", "[", 
          RowBox[{
          "topleft", ",", "topright", ",", "bottomleft", ",", "bottomright"}],
           "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"perfmatchings", "=", 
           RowBox[{"perfectMatchings", "[", 
            RowBox[{
            "topleft", ",", "topright", ",", "bottomleft", ",", 
             "bottomright"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"referencematching", "===", "Null"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"referenceperfmatch", "=", 
              RowBox[{"perfmatchings", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]",
             ",", 
            RowBox[{
             RowBox[{"referenceperfmatch", "=", "referencematching"}], 
             ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"loopvariablebasis", "===", "Null"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"make", " ", "my", " ", "own", " ", "basis"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"gauging", "\[Equal]", "2"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"basispaths", "=", 
                 RowBox[{"makeLoopVariablesBasis", "[", 
                  RowBox[{
                  "topleft", ",", "topright", ",", "bottomleft", ",", 
                   "bottomright"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
               ",", 
               RowBox[{
                RowBox[{"basispaths", "=", 
                 RowBox[{"makeLoopVariablesBasis", "[", 
                  RowBox[{
                  "topleft", ",", "topright", ",", "bottomleft", ",", 
                   "bottomright", ",", "True"}], "]"}]}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
            RowBox[{
             RowBox[{"basispaths", "=", "loopvariablebasis"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
            "The", " ", "first", " ", "part", " ", "contains", " ", "the", 
             " ", "internal", " ", "loops"}], ",", " ", 
            RowBox[{
            "the", " ", "second", " ", "contains", " ", "remaining", " ", 
             "external", " ", "faces"}], ",", " ", 
            RowBox[{
            "and", " ", "the", " ", "final", " ", "contains", " ", "paths", 
             " ", "strecthing", " ", "between", " ", "different", " ", 
             "boundaries"}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"basis", "=", 
           RowBox[{"Flatten", "[", "basispaths", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"We", "'"}], "ll", " ", "now", " ", "express", " ", 
            "each", " ", "perfect", " ", "matching", " ", "as", " ", "a", " ",
             "vector", " ", "describing", " ", "which", " ", "edges", " ", 
            "are", " ", "present", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"1", ":", " ", 
               RowBox[{"in", " ", "numerator"}]}], ";", " ", 
              RowBox[{
               RowBox[{"-", "1"}], ":", " ", 
               RowBox[{"in", " ", "denominator"}]}], ";", " ", 
              RowBox[{"0", ":", " ", "absent"}]}], ")"}]}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"kasteleyn", "=", 
           RowBox[{"joinupKasteleyn", "[", 
            RowBox[{
            "topleft", ",", "topright", ",", "bottomleft", ",", 
             "bottomright"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"allvariables", "=", 
           RowBox[{"Variables", "[", "kasteleyn", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"perfmatchingvectors", "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"D", "[", 
                  RowBox[{"#", ",", 
                   RowBox[{"allvariables", "[", 
                    RowBox[{"[", "iii", "]"}], "]"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"iii", ",", 
                   RowBox[{"Length", "[", "allvariables", "]"}]}], "}"}]}], 
                "]"}], "/.", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "\[Rule]", "1"}], "&"}], ",", "allvariables"}],
                 "]"}]}], "&"}], ",", 
             RowBox[{"perfmatchings", "/", "referenceperfmatch"}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"We", "'"}], "ll", " ", "also", " ", "express", " ", 
            "the", " ", "path", " ", "basis", " ", "in", " ", "this", " ", 
            "vectorial", " ", "way"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"basisvectors", "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"D", "[", 
                  RowBox[{"#", ",", 
                   RowBox[{"allvariables", "[", 
                    RowBox[{"[", "iii", "]"}], "]"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"iii", ",", 
                   RowBox[{"Length", "[", "allvariables", "]"}]}], "}"}]}], 
                "]"}], "/.", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "\[Rule]", "1"}], "&"}], ",", "allvariables"}],
                 "]"}]}], "&"}], ",", "basis"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "We", " ", "can", " ", "now", " ", "solve", " ", "for", " ", 
            "which", " ", "basis", " ", "vectors", " ", "are", " ", 
            "required", " ", "to", " ", "form", " ", "a", " ", "given", " ", 
            "expression"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"tosolvefor", "=", 
           RowBox[{"Total", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"coef", "[", "iii", "]"}], 
               RowBox[{"basisvectors", "[", 
                RowBox[{"[", "iii", "]"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"iii", ",", 
                RowBox[{"Length", "[", "basisvectors", "]"}]}], "}"}]}], 
             "]"}], "]"}]}], ";", 
          RowBox[{"coeflist", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"coef", "[", "iii", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"iii", ",", 
               RowBox[{"Length", "[", "basisvectors", "]"}]}], "}"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"perfmatchingsasloops", "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "&"}], ",", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Solve", "[", 
                  RowBox[{
                   RowBox[{"tosolvefor", "\[Equal]", "#"}], ",", "coeflist"}],
                   "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", 
               "perfmatchingvectors"}], "]"}], ",", 
             RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "We", " ", "now", " ", "have", " ", "the", " ", "expression", " ", 
            "of", " ", "each", " ", "perfect", " ", "matching", " ", "in", 
            " ", "terms", " ", "of", " ", "the", " ", "loop", " ", "basis"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"masterspace", "=", 
           RowBox[{"Transpose", "[", "perfmatchingsasloops", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
            "We", " ", "need", " ", "to", " ", "gauge", " ", "away", " ", 
             "all", " ", "internal", " ", "faces"}], ",", " ", 
            RowBox[{
            "and", " ", "if", " ", "we", " ", "use", " ", "gauging", " ", "2",
              " ", "also", " ", "all", " ", "internal", " ", 
             RowBox[{"loops", ".", " ", "This"}], " ", "corresponds", " ", 
             "to", " ", "the", " ", "first", " ", "rows", " ", "of", " ", 
             "the", " ", "masterspace"}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"loopvariablebasis", "===", "Null"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{
              "if", " ", "I", " ", "made", " ", "my", " ", "own", " ", 
               "basis"}], ",", " ", 
              RowBox[{
              "I", " ", "arranged", " ", "it", " ", "such", " ", "that", " ", 
               "the", " ", "first", " ", "entry", " ", "is", " ", "what", " ", 
               RowBox[{"we", "'"}], "ll", " ", "be", " ", "gauging", " ", 
               RowBox[{"away", ".", " ", "Otherwise"}]}], ",", " ", 
              RowBox[{
               RowBox[{"we", "'"}], "ll", " ", "need", " ", "to", " ", "find",
                " ", "what", " ", "to", " ", "gauge", " ", "away", " ", "by", 
               " ", "hand"}]}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"modulispace", "=", 
              RowBox[{"masterspace", "[", 
               RowBox[{"[", 
                RowBox[{"Range", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "[", 
                    RowBox[{"basispaths", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "+", "1"}], ",", 
                  RowBox[{"Length", "[", "basis", "]"}]}], "]"}], "]"}], 
               "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{
              "We", " ", "need", " ", "to", " ", "gauge", " ", "away", " ", 
               "internal", " ", "faces", " ", 
               RowBox[{"only", ".", " ", 
                RowBox[{"We", "'"}]}], "ll", " ", "find", " ", "out", " ", 
               "how", " ", "to", " ", "express", " ", "internal", " ", 
               "faces", " ", "in", " ", "terms", " ", "of", " ", 
               "basispaths"}], ",", " ", 
              RowBox[{
              "and", " ", "then", " ", "mod", " ", "out", " ", "by", " ", 
               "these", " ", "expressions"}]}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"internalfacenames", "=", 
              RowBox[{"internalFaceLabels", "[", 
               RowBox[{
               "topleft", ",", "topright", ",", "bottomleft", ",", 
                "bottomright"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"internalfacevariables", "=", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"Times", "@@", 
                    RowBox[{"Cases", "[", 
                    RowBox[{"allvariables", ",", 
                    RowBox[{"_", "[", 
                    RowBox[{"_", ",", "#"}], "]"}]}], "]"}]}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{"Times", "@@", 
                    RowBox[{"Cases", "[", 
                    RowBox[{"allvariables", ",", 
                    RowBox[{"_", "[", 
                    RowBox[{"#", ",", "_"}], "]"}]}], "]"}]}], ")"}]}], "&"}],
                 ",", "internalfacenames"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"internalfacevariablevectors", "=", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"allvariables", "[", 
                    RowBox[{"[", "iii", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"iii", ",", 
                    RowBox[{"Length", "[", "allvariables", "]"}]}], "}"}]}], 
                   "]"}], "/.", 
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", "\[Rule]", "1"}], "&"}], ",", 
                    "allvariables"}], "]"}]}], "&"}], ",", 
                "internalfacevariables"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"tosolvefor", "=", 
              RowBox[{"Total", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"coef", "[", "iii", "]"}], 
                  RowBox[{"basisvectors", "[", 
                   RowBox[{"[", "iii", "]"}], "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"iii", ",", 
                   RowBox[{"Length", "[", "basisvectors", "]"}]}], "}"}]}], 
                "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"coeflist", "=", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"coef", "[", "iii", "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"iii", ",", 
                  RowBox[{"Length", "[", "basisvectors", "]"}]}], "}"}]}], 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"We", "'"}], "ll", " ", "now", " ", "express", " ", 
               "the", " ", "internal", " ", "faces", " ", "as", " ", "a", " ",
                "combination", " ", "of", " ", "basis", " ", "paths"}], 
              "*)"}], "\[IndentingNewLine]", 
             RowBox[{"internalfacesasbasispaths", "=", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "&"}], ",", 
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Solve", "[", 
                    RowBox[{
                    RowBox[{"tosolvefor", "\[Equal]", "#"}], ",", 
                    "coeflist"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", 
                  "internalfacevariablevectors"}], "]"}], ",", 
                RowBox[{"{", "2", "}"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{
                RowBox[{"We", "'"}], "ll", " ", "need", " ", "to", " ", "mod",
                 " ", "out", " ", "by", " ", "these", " ", "vectors"}], ",", 
               " ", 
               RowBox[{
               "as", " ", "they", " ", "represent", " ", "internal", " ", 
                "faces"}]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"vectorMod", "=", 
              RowBox[{"Function", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"vector", ",", "modoutbyvectors"}], "}"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Total", "[", 
                 RowBox[{"Map", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Projection", "[", 
                    RowBox[{"vector", ",", "#"}], "]"}], "&"}], ",", 
                   RowBox[{"NullSpace", "[", "modoutbyvectors", "]"}]}], 
                  "]"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"modulispace", "=", 
              RowBox[{"Transpose", "[", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"vectorMod", "[", 
                   RowBox[{"#", ",", "internalfacesasbasispaths"}], "]"}], 
                  "&"}], ",", "perfmatchingsasloops"}], "]"}], "]"}]}], 
             ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{
          RowBox[{
          "Print", "[", 
           "\"\<The graph must be of BFT type for this function to work: \
edges must be of the form _[_Integer,_Integer] and be labeled according the \
numbering of faces.\>\"", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"basis", "=", "Null"}], ";", "\[IndentingNewLine]", 
          RowBox[{"masterspace", "=", "Null"}], ";", "\[IndentingNewLine]", 
          RowBox[{"modulispace", "=", "Null"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"masterspace", ",", "modulispace", ",", "basis"}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.664704296296817*^9, 3.6647043068089943`*^9}, {
  3.664705964659605*^9, 3.6647061099837313`*^9}, {3.664706547766859*^9, 
  3.6647065947926884`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"These", " ", "are", " ", "ALL", " ", "the", " ", 
   RowBox[{"Kasteleyns", ":", "           ", 
    RowBox[{
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", "--"}]}]}], ">", "     ", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", "--"}]}]}], ">", "     ", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", "--"}]}]}], ">", "     ", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", "--"}]}]}], ">", "     ", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", "--"}]}]}], ">", "     ", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", "--"}]}]}], ">"}]}]}], "  ", "*)"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 CellChangeTimes->{{3.6647096906820107`*^9, 3.6647097227226796`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "There", " ", "are", " ", "currently", " ", "76", " ", "different", " ", 
     "examples", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"highest", " ", "is", " ", 
        SubscriptBox["bft", "76"]}], ")"}], ".", " ", "If"}], " ", "you", " ",
      "introduce", " ", "any", " ", "more"}], ",", " ", 
    RowBox[{"call", " ", "the", " ", "next", " ", "one", " ", "77"}], ",", 
    " ", 
    RowBox[{"and", " ", "update", " ", "this", " ", 
     RowBox[{"number", "!"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Rules", ":", " ", 
     RowBox[{"'", 
      RowBox[{"a", "'"}], " ", "is", " ", "the", " ", "upper", " ", "left", 
      " ", "matrix"}]}], ",", " ", 
    RowBox[{"'", 
     RowBox[{"b", "'"}], " ", "is", " ", "the", " ", "upper", " ", "right"}], 
    ",", " ", 
    RowBox[{"'", 
     RowBox[{"c", "'"}], " ", "is", " ", "the", " ", "lower", " ", "left"}], 
    ",", " ", 
    RowBox[{"'", 
     RowBox[{"d", "'"}], " ", "is", " ", "the", " ", "lower", " ", 
     RowBox[{"right", ".", " ", "You"}], " ", "have", " ", "to", " ", "label",
      " ", "the", " ", "internal", " ", "faces", " ", "first"}], ",", " ", 
    RowBox[{"Then", " ", "external", " ", 
     RowBox[{"ones", ".", " ", "You"}], " ", "have", " ", "to", " ", "label", 
     " ", "First", " ", "the", " ", "internal", " ", "white", " ", "nodes"}], 
    ",", " ", 
    RowBox[{"then", " ", "external", " ", "white", " ", "nodes"}], ",", " ", 
    RowBox[{"then", " ", "internal", " ", "black", " ", "nodes"}], ",", " ", 
    RowBox[{"then", " ", "external", " ", "black", " ", 
     RowBox[{"nodes", "."}]}]}], "  ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"-", "GENUS"}]}]}]}]}]}]}]}]}]}]}], " ", "ZERO"}], ",",
     " ", 
    RowBox[{"ONE", " ", "BOUNDARY", " ", "CASES"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"I", ".", "E", ".", " ", "THE"}], " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"DISK", "--"}], "--"}], "--"}], "--"}], "--"}], "--"}]}], 
     "-", 
     RowBox[{"-", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", "-"}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Normal", " ", "square", " ", 
    RowBox[{"box", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    SubscriptBox["bft", "1"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"5", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "5"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "5"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Square", " ", "box", " ", "with", " ", "crossed", " ", "legs"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "2"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "1"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "1"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "4"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Double", " ", "square", " ", "box"}], ",", " ", 
     RowBox[{
      RowBox[{"i", ".", "e", ".", " ", "the"}], " ", "unreduced", " ", "Gr", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"2", ",", "4"}], ")"}], "."}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "3"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "1"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "5"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "2"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "5"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"5", ",", "6"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "6"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Double", " ", "square", " ", "box", " ", "with", " ", 
     SubscriptBox["X", 
      RowBox[{"6", ",", "2"}]], " ", 
     RowBox[{"Higgsed", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "4"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"5", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "5"}]], ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "5"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"5", ",", "2"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Double", " ", "square", " ", "box"}], ",", " ", 
     RowBox[{
     "with", " ", "face", " ", "2", " ", "being", " ", "a", " ", 
      "confinement", " ", 
      RowBox[{"bubble", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "5"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"6", ",", "2"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"2", ",", "1"}]]}], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "5"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "1"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"5", ",", "6"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "4"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "6"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "4"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Normal", " ", "planar", " ", "Gr", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"3", ",", "5"}], ")"}], "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "6"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"5", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "6"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "2"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "5"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"6", ",", "7"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "7"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"6", ",", "5"}]], ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Normal", " ", "planar", " ", "Gr", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2", ",", "5"}], ")"}], "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "73"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"7", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "6"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "7"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "5"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"6", ",", "7"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "5"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"2", " ", "gluon"}], ",", " ", 
     RowBox[{
      RowBox[{"2", " ", "loop", " ", "on", " ", "a", " ", 
       RowBox[{"disk", ".", " ", "CONTAINS"}], " ", "SELF"}], "-", 
      RowBox[{"INTERSECTING", " ", 
       RowBox[{"ZIGZAGS", "!"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "7"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["X", 
           RowBox[{"3", ",", "1"}]], "+", 
          SubscriptBox["X", 
           RowBox[{"1", ",", "2"}]], "+", 
          SubscriptBox["X", 
           RowBox[{"2", ",", "4"}]]}], "}"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         SubscriptBox["X", 
          RowBox[{"4", ",", "3"}]], "}"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         SubscriptBox["Y", 
          RowBox[{"4", ",", "3"}]], "}"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{"{", "0", "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"3", " ", "gluon"}], ",", " ", 
     RowBox[{
      RowBox[{"3", " ", "loop", " ", "on", " ", "a", " ", 
       RowBox[{"disk", ".", " ", "CONTAINS"}], " ", "SELF"}], "-", 
      RowBox[{"INTERSECTING", " ", 
       RowBox[{"ZIGZAGS", "!"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "8"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "5"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"5", ",", "3"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "5"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["X", 
           RowBox[{"4", ",", "3"}]], ",", "0"}], "}"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Top", " ", "cell", " ", "of", " ", "Gr", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2", ",", "6"}], ")"}], "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "9"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"9", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "8"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "7"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "6"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "3"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"8", ",", "9"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "8"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "7"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "5"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"4", ",", "9"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "5"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Top", " ", "cell", " ", "of", " ", "Gr", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"3", ",", "6"}], ")"}], "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "10"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"5", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "10"}]], ",", "0", ",", "0", ",", "0", ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "6"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "1"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "6"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "3"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "1"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "8"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"10", ",", "1"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "10"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "8"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "4"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"10", ",", "5"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "7"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "9"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"6", ",", "5"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "7"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"10", ",", "9"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"7", "-", 
     RowBox[{"dimensional", " ", "Gr", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"3", ",", "6"}], ")"}], "."}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "11"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "8"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "5"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "2"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "6"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "1"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"8", ",", "3"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "6"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "7"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "4"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "7"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Top", " ", "cell", " ", "of", " ", "Gr", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2", ",", "7"}], ")"}], "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "12"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"11", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "10"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"10", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "9"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "8"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "7"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "5"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "4"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"10", ",", "11"}]], ",", "0", ",", "0", ",", "0", ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "10"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "9"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "8"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "6"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"5", ",", "11"}]], ",", "0", ",", "0", ",", "0", ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "6"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], 
        "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Top", " ", "cell", " ", "of", " ", "Gr", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"3", ",", "7"}], ")"}], "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "13"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "7"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "3"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"13", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "13"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "5"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "4"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "6"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "5"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"12", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "11"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"11", ",", "5"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "10"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "9"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"10", ",", "6"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "8"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"11", ",", "12"}]], ",", "0", ",", "0", ",", "0"}], "}"}],
          ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"10", ",", "11"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "10"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"7", ",", "13"}]], ",", "0", ",", "0", ",", "0", ",", "0",
            ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "8"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"13", ",", "12"}]], ",", "0", ",", "0"}], "}"}]}], 
        "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Permutation", " ", 
     RowBox[{"{", 
      RowBox[{"4", ",", "5", ",", "6", ",", "7", ",", "8", ",", "9"}], "}"}], 
     " ", 
     RowBox[{"(", "bipartite", ")"}], " ", "under", " ", "scheme", " ", 
     "0."}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "14"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"6", ",", "2"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "5"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "7"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "8"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"10", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "9"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"5", ",", "6"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "9"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "10"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"7", ",", "6"}]], ",", "0", ",", "0", ",", "0", ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "7"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "10"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Permutation", " ", 
     RowBox[{"{", 
      RowBox[{"4", ",", "5", ",", "6", ",", "7", ",", "8", ",", "9"}], "}"}], 
     " ", 
     RowBox[{"(", "bipartite", ")"}], " ", "under", " ", "scheme", " ", 
     "1."}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "15"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"6", ",", "2"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "5"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "7"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "8"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "1"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "4"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"10", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "10"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"5", ",", "6"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "9"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"10", ",", "9"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"7", ",", "6"}]], ",", "0", ",", "0", ",", "0", ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "7"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "10"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"-", "GENUS"}]}]}]}]}]}]}]}]}]}]}], " ", "ZERO"}], 
     ",", " ", 
     RowBox[{"MULTI", " ", "BOUNDARY", " ", "CASES"}], ",", " ", 
     RowBox[{
      RowBox[{"I", ".", "E", ".", " ", "NON"}], "-", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"PLANAR", "--"}], "--"}], "--"}], "--"}], "--"}], 
          "--"}], "--"}], "--"}], 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", "-"}]}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"G", 
       RowBox[{"(", 
        RowBox[{"3", ",", "6"}], ")"}], " ", "top"}], "-", 
      RowBox[{"dim", " ", "guy", " ", "with", " ", "B"}]}], "=", 
     RowBox[{"2", " ", "and", " ", "two", " ", "strange", " ", "poles"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "75"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"8", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "7"}]], ",", "0", ",", "0", ",", "0", ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "9"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "6"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "7"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "5"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"7", ",", "8"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "6"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"9", ",", "8"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "9"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "6"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "4"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"G", 
       RowBox[{"(", 
        RowBox[{"3", ",", "6"}], ")"}], " ", "top"}], "-", 
      RowBox[{"dim", " ", "guy", " ", "with", " ", "B"}]}], "=", 
     RowBox[{"2", " ", "and", " ", "one", " ", "strange", " ", "poles"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "76"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"9", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "5"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "9"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "6"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "2"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "2"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "4"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "5"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "7"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "2"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "3"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "8"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "5"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"5", ",", "4"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "9"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"6", ",", "9"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "6"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "7"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Standard", " ", "example", " ", "on", " ", "a", " ", "cylinder", " ", 
     "which", " ", "reduces", " ", "to", " ", "sums", " ", "of", " ", 
     "square", " ", 
     RowBox[{"boxes", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "16"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"5", ",", "1"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "2"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "4"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "5"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["X", 
           RowBox[{"3", ",", "5"}]], ",", "0", ",", "0"}], "}"}], "}"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Standard", " ", "example", " ", "on", " ", "a", " ", "cylinder"}], ",", 
     " ", 
     RowBox[{"after", " ", "a", " ", "flip", " ", 
      RowBox[{"manoever", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "17"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"5", ",", "1"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "2"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "4"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "5"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["X", 
           RowBox[{"3", ",", "5"}]], ",", "0", ",", "0"}], "}"}], "}"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Standard", " ", "example", " ", "on", " ", "a", " ", "cylinder"}], ",", 
     " ", 
     RowBox[{"with", " ", "massive", " ", "node", " ", "integrated", " ", 
      RowBox[{"out", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "18"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "5"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "1"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"5", ",", "3"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "5"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["X", 
           RowBox[{"4", ",", "3"}]], ",", "0"}], "}"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Standard", " ", "example", " ", "on", " ", "a", " ", "cylinder"}], ",", 
     " ", 
     RowBox[{
      RowBox[{
      "with", " ", "massive", " ", "node", " ", "integrated", " ", "out", " ",
        "and", " ", "a", " ", "flip", " ", "manoever"}], ".."}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "19"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "5"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "1"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"5", ",", "3"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "5"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["X", 
           RowBox[{"4", ",", "3"}]], ",", "0"}], "}"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Similar", " ", "to", " ", "standard", " ", "example"}], ",", 
     " ", 
     RowBox[{"this", " ", "is", " ", "a", " ", "6", " ", "gluon"}], ",", " ", 
     RowBox[{"1", " ", "loop", " ", "on", " ", "a", " ", 
      RowBox[{"cylinder", ".", " ", "It"}], " ", "is", " ", 
      RowBox[{"reduced", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "20"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "2"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "3"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"6", ",", "2"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "6"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "5"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "2"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "5"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"4", ",", "6"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "5"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Simpler", " ", "than", " ", "standard", " ", 
      RowBox[{"example", ":", " ", 
       RowBox[{"3", " ", "gluon"}]}]}], ",", " ", 
     RowBox[{"1", " ", "loop", " ", "on", " ", "a", " ", 
      RowBox[{"cylinder", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "21"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "2"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"5", ",", "2"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "4"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "4"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"4", ",", "5"}]], ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["X", 
           RowBox[{"3", ",", "5"}]], ",", "0", ",", "0"}], "}"}], "}"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Simplest", " ", "nonplanar", " ", "cylinder", " ", "guy", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"intrinsically", " ", "nonplanar"}], ")"}], "."}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "22"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"6", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "6"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "6"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "3"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "5"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", 
          SubscriptBox["X", 
           RowBox[{"5", ",", "4"}]], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "2"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "4"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "6"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "0", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Slightly", " ", "more", " ", "complicated", " ", "intrinsically", " ", 
     "nonplanar", " ", "guy", " ", "on", " ", "the", " ", 
     RowBox[{"cylinder", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "23"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "2"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "3"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"6", ",", "2"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "6"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "5"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "2"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "5"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"4", ",", "6"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "5"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Y2", ",", 
     RowBox[{
     "0", " ", "with", " ", "a", " ", "periodic", " ", "direction", " ", 
      "cut", " ", "out", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"i", ".", "e", ".", " ", "on"}], " ", "cylinder"}], ")"}], 
       "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "24"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"5", ",", "2"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"1", ",", "4"}]]}], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Y", 
            RowBox[{"2", ",", "1"}]], ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"3", ",", "2"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"1", ",", "6"}]]}]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "5"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"6", ",", "3"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["Y", 
            RowBox[{"6", ",", "3"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Y", 
            RowBox[{"4", ",", "5"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Y4", ",", 
     RowBox[{
     "0", " ", "with", " ", "a", " ", "periodic", " ", "direction", " ", 
      "cut", " ", "out", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"i", ".", "e", ".", " ", "on"}], " ", "cylinder"}], ")"}], 
       "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "25"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"7", ",", "1"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"4", ",", "8"}]]}], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Y", 
            RowBox[{"1", ",", "4"}]], ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"2", ",", "1"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"4", ",", "5"}]]}], ",", 
           SubscriptBox["Y", 
            RowBox[{"5", ",", "2"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "2"}]], ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"2", ",", "3"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"6", ",", "5"}]]}], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "6"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"3", ",", "6"}]], ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"9", ",", "3"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"6", ",", "10"}]]}]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"8", ",", "7"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"10", ",", "9"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Y", 
            RowBox[{"8", ",", "7"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"10", ",", "9"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"This", " ", "is", " ", "Y6"}], ",", 
     RowBox[{
     "0", " ", "with", " ", "one", " ", "periodic", " ", "direction", " ", 
      "cut", " ", "out", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"ie", " ", "on", " ", "cylinder"}], ")"}], "."}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "26"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"11", ",", "1"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"6", ",", "12"}]]}], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "6"}]], ",", "0", ",", "0", ",", "0", ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Y", 
            RowBox[{"1", ",", "6"}]], ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"2", ",", "1"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"6", ",", "7"}]]}], ",", 
           SubscriptBox["Y", 
            RowBox[{"7", ",", "2"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "2"}]], ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"2", ",", "3"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"8", ",", "7"}]]}], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "8"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"3", ",", "8"}]], ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"4", ",", "3"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"8", ",", "9"}]]}], ",", 
           SubscriptBox["Y", 
            RowBox[{"9", ",", "4"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "4"}]], ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"4", ",", "5"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"10", ",", "9"}]]}], ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "10"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"5", ",", "10"}]], ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"13", ",", "5"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"10", ",", "14"}]]}]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"12", ",", "11"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"14", ",", "13"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Y", 
            RowBox[{"12", ",", "11"}]], ",", "0", ",", "0", ",", "0", ",", 
           "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"14", ",", "13"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Reduction", " ", "of", " ", "square", " ", "torus", " ", "chopping", 
      " ", "THREE", " ", "lines"}], ",", " ", 
     RowBox[{
     "is", " ", "a", " ", "6", " ", "gluon", " ", "3", " ", "loops", " ", 
      "on", " ", "a", " ", 
      RowBox[{"cylinder", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "27"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "4"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "5"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "7"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"7", ",", "1"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "8"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"5", ",", "6"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "9"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "7"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "4"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "6"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "9"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Reduction", " ", "of", " ", "square", " ", "torus", " ", "chopping", 
      " ", "THREE", " ", "lines"}], ",", " ", 
     RowBox[{
      RowBox[{"and", " ", "Seiberg"}], "-", 
      RowBox[{"dualizing", " ", "face", " ", "2"}]}], ",", " ", 
     RowBox[{
     "is", " ", "a", " ", "6", " ", "gluon", " ", "3", " ", "loops", " ", 
      "on", " ", "a", " ", 
      RowBox[{"cylinder", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "28"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "4"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "5"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "1"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "7"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "3"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"7", ",", "1"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "8"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "3"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "6"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "9"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"5", ",", "6"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "9"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "7"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "4"}]], ",", "0", ",", "0", ",", "0", ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "6"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "9"}]], ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Rather", " ", "complicated", " ", "6", " ", "gluon"}], ",", " ", 
     RowBox[{"3", " ", "loop", " ", "on", " ", "a", " ", 
      RowBox[{"cylinder", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "29"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"4", ",", "1"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "6"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "2"}]], ",", "0", ",", "0", ",", "0", ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "5"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "3"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "7"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "8"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "9"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "3"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"6", ",", "4"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "5"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "6"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "7"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "8"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "9"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Another", " ", "6", " ", "gluon"}], ",", " ", 
     RowBox[{"3", " ", "loop", " ", "on", " ", "a", " ", 
      RowBox[{"cylinder", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "30"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "6"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "2"}]], ",", "0", ",", "0", ",", "0", ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "5"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "1"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "7"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "8"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "9"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "1"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"6", ",", "4"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "5"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "6"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "7"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "8"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "9"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Y", 
            RowBox[{"3", ",", "2"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", "0"}], "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Reduction", " ", "of", " ", "the", " ", "square", " ", "torus", " ", 
     "with", " ", "a", " ", "single", " ", "boundary", " ", "chopping", " ", 
     "THREE", " ", 
     RowBox[{"lines", ".", " ", "It"}], " ", "lives", " ", "on", " ", "a", 
     " ", 
     RowBox[{"cylinder", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "31"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"6", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "5"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "1"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "8"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "7"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "1"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"4", ",", "6"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "4"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "9"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"5", ",", "6"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "9"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "7"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Has", " ", "3", " ", "boundaries"}], ",", " ", 
     RowBox[{"but", " ", "is", " ", 
      RowBox[{"reducible", ".", " ", 
       RowBox[{"It", "'"}]}], "s", " ", "a", " ", "top", " ", "cell", " ", 
      "of", " ", "Gr", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"3", ",", "5"}], ")"}], ".", " ", 
       RowBox[{"It", "'"}]}], "s", " ", 
      RowBox[{"a", " ", "'"}], 
      RowBox[{"reduction", "'"}], " ", "of", " ", "the", " ", "monster", " ", 
      "guy", " ", 
      RowBox[{"below", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "69"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"7", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "6"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "7"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "4"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "5"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "8"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "5"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "7"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "2"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "7"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "3"}]], ",", "0", ",", "0", ",", "0", ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "6"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["Y", 
            RowBox[{"5", ",", "4"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "8"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", 
          SubscriptBox["X", 
           RowBox[{"5", ",", "4"}]], ",", "0", ",", "0"}], "}"}], "}"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
        "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Guy", " ", "with", " ", "intrinsically", " ", "3", " ", 
     RowBox[{"boundaries", ".", " ", 
      RowBox[{"It", "'"}]}], "s", " ", "a", " ", "top", " ", "cell", " ", 
     "of", " ", "Gr", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"3", ",", "5"}], ")"}], ".", " ", 
      RowBox[{"It", "'"}]}], "s", " ", 
     RowBox[{"a", " ", "'"}], 
     RowBox[{"reduction", "'"}], " ", "of", " ", "the", " ", "monster", " ", 
     "guy", " ", 
     RowBox[{"below", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "32"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"10", ",", "1"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "10"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "8"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "2"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "5"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "9"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "3"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "7"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "10"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"10", ",", "6"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "6"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "4"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", 
          SubscriptBox["X", 
           RowBox[{"4", ",", "5"}]], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "5"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "7"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "6"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"8", ",", "10"}]], ",", "0", ",", "0", ",", "0", ",", "0",
            ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "8"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"10", ",", "9"}]], ",", "0", ",", "0", ",", "0", ",", 
           "0"}], "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "0", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Monster", " ", "guy", " ", "with", " ", "intrinsically", " ", "3", " ", 
     RowBox[{"boundaries", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "33"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "7"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"11", ",", "2"}]], ",", "0", ",", "0", ",", "0", ",", "0",
            ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "11"}]], ",", "0", ",", "0", ",", "0", ",", "0",
            ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "1"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "11"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"11", ",", "4"}]], ",", "0", ",", "0", ",", "0", ",", "0",
            ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "5"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "1"}]], ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "11"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"11", ",", "6"}]], ",", "0", ",", "0", ",", "0", ",", "0",
            ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "2"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "8"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "3"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "4"}]], ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "9"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "5"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "6"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "10"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"10", ",", "7"}]], ",", "0", ",", "0", ",", "0", ",", "0",
            ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "11"}]], ",", "0", ",", "0", ",", "0", ",", "0",
            ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"12", ",", "8"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"11", ",", "12"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"11", ",", "8"}]], ",", "0", ",", "0", ",", "0", ",", "0",
            ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "13"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"13", ",", "11"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "11"}]], ",", "0", ",", "0", ",", "0", ",", "0",
            ",", 
           SubscriptBox["X", 
            RowBox[{"14", ",", "9"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"11", ",", "14"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"11", ",", "9"}]], ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "15"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"15", ",", "11"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", 
           SubscriptBox["X", 
            RowBox[{"10", ",", "11"}]], ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"16", ",", "10"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"11", ",", "16"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"11", ",", "10"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"10", ",", "17"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"17", ",", "11"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"13", ",", "12"}]], ",", "0", ",", "0", ",", "0", ",", 
           "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"12", ",", "13"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"15", ",", "14"}]], ",", "0", ",", "0", ",", "0", ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"14", ",", "15"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", "0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"17", ",", "16"}]], ",", "0", ",", "0", ",", "0"}], "}"}],
          ",", 
         RowBox[{"{", 
          RowBox[{
          "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
           "0", ",", 
           SubscriptBox["X", 
            RowBox[{"16", ",", "17"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"-", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", "HIGHER"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], 
      " ", "GENUS"}], ",", " ", 
     RowBox[{
      RowBox[{"ONE", " ", "BOUNDARY", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"CASES", "--"}], "--"}], "--"}], "--"}], "--"}], "--"}],
          "--"}], "--"}]}], "-", 
      RowBox[{"-", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"-", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"-", 
             RowBox[{"-", 
              RowBox[{"--", 
               RowBox[{"--", "-"}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Y2", ",", 
     RowBox[{
     "0", " ", "with", " ", "a", " ", "single", " ", "boundary", " ", 
      "cutting", " ", "ONE", " ", 
      RowBox[{"line", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "34"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"2", ",", "1"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"3", ",", "4"}]]}], ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"1", ",", "3"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"4", ",", "2"}]]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["Y", 
             RowBox[{"1", ",", "3"}]], "+", 
            SubscriptBox["Y", 
             RowBox[{"4", ",", "2"}]]}], ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "1"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", 
          SubscriptBox["Y", 
           RowBox[{"3", ",", "4"}]], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          SubscriptBox["Z", 
           RowBox[{"3", ",", "4"}]]}], "}"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{"{", "0", "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Y2", ",", 
     RowBox[{
     "2", " ", "with", " ", "a", " ", "single", " ", "boundary", " ", 
      "cutting", " ", "ONE", " ", 
      RowBox[{"line", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "35"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"4", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "3"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"3", ",", "1"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"1", ",", "4"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", 
          SubscriptBox["X", 
           RowBox[{"3", ",", "4"}]], "}"}], ",", 
         RowBox[{"{", "0", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["Y", 
           RowBox[{"3", ",", "4"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
        "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{"{", "0", "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Y2", ",", 
     RowBox[{
     "2", " ", "with", " ", "a", " ", "single", " ", "boundary", " ", 
      "cutting", " ", "TWO", " ", 
      RowBox[{"lines", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "36"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "5"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"4", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "4"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "3"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "2"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "4"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "4"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"5", ",", "4"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["Y", 
            RowBox[{"3", ",", "2"}]], ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"This", " ", "is", " ", "Y4"}], ",", 
     RowBox[{
     "0", " ", "with", " ", "a", " ", "single", " ", "boundary", " ", 
      "cutting", " ", "ONE", " ", 
      RowBox[{"line", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "37"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"5", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "6"}]], ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"1", ",", "2"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"6", ",", "5"}]]}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"4", ",", "8"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "3"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "4"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"1", ",", "4"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"8", ",", "5"}]]}], ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"5", ",", "1"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "8"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"3", ",", "2"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"6", ",", "7"}]]}], ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "6"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"7", ",", "3"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", 
          SubscriptBox["X", 
           RowBox[{"8", ",", "7"}]], "}"}], ",", 
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "0", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", 
          SubscriptBox["Y", 
           RowBox[{"8", ",", "7"}]]}], "}"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{"{", "0", "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Y4", ",", 
     RowBox[{
     "0", " ", "with", " ", "a", " ", "single", " ", "boundary", " ", 
      "cutting", " ", "TWO", " ", 
      RowBox[{"lines", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "38"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"6", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "7"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"4", ",", "5"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "3"}]], ",", "0", ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"3", ",", "4"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"5", ",", "8"}]]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"1", ",", "4"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"5", ",", "6"}]]}], ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"6", ",", "1"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "5"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "2"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "9"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"8", ",", "3"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"7", ",", "6"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "8"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "8"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "6"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Y6", ",", 
     RowBox[{
     "0", " ", "with", " ", "a", " ", "single", " ", "boundary", " ", 
      "cutting", " ", "ONE", " ", 
      RowBox[{"line", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "39"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"7", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "8"}]], ",", "0", ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"1", ",", "2"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"8", ",", "7"}]]}], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "10"}]], ",", "0", ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"3", ",", "4"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"10", ",", "9"}]]}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"6", ",", "12"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"11", ",", "5"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "6"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"1", ",", "6"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"12", ",", "7"}]]}], ",", "0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"7", ",", "1"}]], ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"6", ",", "12"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"3", ",", "2"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"8", ",", "9"}]]}], ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "8"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"9", ",", "3"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"5", ",", "4"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"10", ",", "11"}]]}], ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "10"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"11", ",", "5"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", 
          SubscriptBox["X", 
           RowBox[{"12", ",", "11"}]], "}"}], ",", 
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "0", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
          SubscriptBox["Y", 
           RowBox[{"12", ",", "11"}]]}], "}"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{"{", "0", "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Wider", "-", "by", "-", 
      RowBox[{"one", " ", "Y3"}]}], ",", "3", ",", " ", 
     RowBox[{
     "with", " ", "a", " ", "single", " ", "boundary", " ", "cutting", " ", 
      "TWO", " ", 
      RowBox[{"lines", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "40"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "6"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "2"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "5"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "1"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"6", ",", "4"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"10", ",", "6"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "10"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "6"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "8"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "5"}]], ",", "0", ",", "0", ",", "0", ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "5"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "7"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "4"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"10", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "9"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "7"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"10", ",", "7"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "10"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "3"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"9", ",", "10"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "9"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "10"}]], ",", "0", ",", "0", ",", "0", ",", "0",
            ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "8"}]], ",", "0", ",", "0", ",", "0", ",", 
           "0"}], "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Square", " ", "torus", " ", 
     RowBox[{"(", 
      RowBox[{"section", " ", "7.3"}], ")"}], " ", "with", " ", "a", " ", 
     "single", " ", "boundary", " ", "chopping", " ", "ONE", " ", 
     RowBox[{"line", ".", " ", "It"}], " ", "is", " ", 
     RowBox[{"reducible", "!"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "41"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"7", ",", "3"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "8"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "4"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "6"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "1"}]], ",", "0", ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"6", ",", "5"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"1", ",", "2"}]]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"6", ",", "7"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"3", ",", "2"}]]}], ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"7", ",", "3"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "6"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"8", ",", "5"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"1", ",", "4"}]]}], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "8"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"5", ",", "1"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          SubscriptBox["X", 
           RowBox[{"8", ",", "7"}]], "}"}], ",", 
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "0", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", 
          SubscriptBox["Y", 
           RowBox[{"8", ",", "7"}]], ",", "0"}], "}"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{"{", "0", "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"addgauge", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"7", ",", "8"}], "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"zed", "=", 
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "6"}]], 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "8"}]]}], 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"7", ",", "3"}]], 
           SubscriptBox["X", 
            RowBox[{"5", ",", "1"}]]}]], ",", 
         FractionBox[
          SubscriptBox["X", 
           RowBox[{"6", ",", "7"}]], 
          SubscriptBox["X", 
           RowBox[{"3", ",", "2"}]]]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Untwisted", " ", "square", " ", "torus", " ", 
     RowBox[{"(", 
      RowBox[{"section", " ", "7.3"}], ")"}], " ", "with", " ", "a", " ", 
     "single", " ", "boundary", " ", "chopping", " ", "ONE", " ", 
     RowBox[{"line", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "42"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"2", ",", "4"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"3", ",", "1"}]]}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Y", 
            RowBox[{"4", ",", "3"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"1", ",", "2"}]], ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "4"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["Z", 
             RowBox[{"2", ",", "4"}]], "+", 
            SubscriptBox["Z", 
             RowBox[{"3", ",", "1"}]]}], ",", "0", ",", 
           SubscriptBox["Z", 
            RowBox[{"4", ",", "3"}]], ",", 
           SubscriptBox["Z", 
            RowBox[{"1", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{
            SubscriptBox["W", 
             RowBox[{"2", ",", "4"}]], "+", 
            SubscriptBox["W", 
             RowBox[{"3", ",", "1"}]]}], ",", 
           SubscriptBox["W", 
            RowBox[{"1", ",", "2"}]], ",", 
           SubscriptBox["W", 
            RowBox[{"4", ",", "3"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", 
          SubscriptBox["Y", 
           RowBox[{"3", ",", "1"}]], "}"}], ",", 
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "0", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", 
          SubscriptBox["V", 
           RowBox[{"3", ",", "1"}]]}], "}"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{"{", "0", "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Square", " ", "torus", " ", 
     RowBox[{"(", 
      RowBox[{"section", " ", "7.3"}], ")"}], " ", "with", " ", "a", " ", 
     "single", " ", "boundary", " ", "chopping", " ", "TWO", " ", 
     RowBox[{"lines", ".", " ", "It"}], " ", "is", " ", 
     RowBox[{"reducible", "!"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "43"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"6", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "7"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"4", ",", "5"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "3"}]], ",", "0", ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"3", ",", "4"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"5", ",", "8"}]]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"1", ",", "4"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"5", ",", "6"}]]}], ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"6", ",", "1"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "5"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "2"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "9"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"8", ",", "3"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"7", ",", "6"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "8"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "8"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "6"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Untwisted", " ", "square", " ", "torus", " ", 
     RowBox[{"(", 
      RowBox[{"section", " ", "7.3"}], ")"}], " ", "with", " ", "a", " ", 
     "single", " ", "boundary", " ", "chopping", " ", "TWO", " ", 
     RowBox[{"lines", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "44"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["W", 
            RowBox[{"1", ",", "2"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "4"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["W", 
            RowBox[{"4", ",", "3"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"1", ",", "2"}]], ",", "0", ",", 
           RowBox[{
            SubscriptBox["Z", 
             RowBox[{"2", ",", "4"}]], "+", 
            SubscriptBox["Y", 
             RowBox[{"3", ",", "1"}]]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["Z", 
             RowBox[{"3", ",", "1"}]], "+", 
            SubscriptBox["W", 
             RowBox[{"2", ",", "4"}]]}], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", 
           SubscriptBox["Z", 
            RowBox[{"1", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["W", 
            RowBox[{"3", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", 
           SubscriptBox["Z", 
            RowBox[{"4", ",", "3"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["V", 
            RowBox[{"3", ",", "1"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "4"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["V", 
            RowBox[{"2", ",", "4"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Square", " ", "torus", " ", 
     RowBox[{"(", 
      RowBox[{"section", " ", "7.3"}], ")"}], " ", "with", " ", "a", " ", 
     "single", " ", "boundary", " ", "chopping", " ", "THREE", " ", 
     RowBox[{"lines", ".", " ", "It"}], " ", "is", " ", 
     RowBox[{"reducible", "!"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "45"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"6", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "7"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"4", ",", "5"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "3"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "4"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"1", ",", "4"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"5", ",", "6"}]]}], ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"6", ",", "1"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "5"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "2"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "9"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"10", ",", "3"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"7", ",", "6"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "8"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "10"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "8"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "6"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "10"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"addgauge", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"5", ",", "6", ",", "7", ",", "8", ",", "9", ",", "10"}], 
         "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"zed", "=", 
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "7"}]], 
           SubscriptBox["X", 
            RowBox[{"4", ",", "5"}]]}], 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"8", ",", "3"}]], 
           SubscriptBox["X", 
            RowBox[{"6", ",", "1"}]]}]], ",", 
         FractionBox[
          SubscriptBox["X", 
           RowBox[{"5", ",", "6"}]], 
          SubscriptBox["X", 
           RowBox[{"1", ",", "4"}]]]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Untwisted", " ", "square", " ", "torus", " ", 
     RowBox[{"(", 
      RowBox[{"section", " ", "7.3"}], ")"}], " ", "with", " ", "a", " ", 
     "single", " ", "boundary", " ", "chopping", " ", "THREE", " ", 
     RowBox[{"lines", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "46"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "5"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "4"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Y", 
            RowBox[{"4", ",", "3"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"6", ",", "2"}]], ",", "0", ",", 
           SubscriptBox["W", 
            RowBox[{"2", ",", "4"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["V", 
             RowBox[{"2", ",", "4"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"3", ",", "1"}]]}], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"1", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "6"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "2"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "5"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"5", ",", "1"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["Y", 
            RowBox[{"3", ",", "6"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "4"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["Z", 
            RowBox[{"2", ",", "4"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "6"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"5", ",", "1"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Torus", " ", "example", " ", "with", " ", "5", " ", "loops", " ", "and",
       " ", "4", " ", "external", " ", "legs"}], ",", " ", 
     RowBox[{"Seiberg", "-", 
      RowBox[{"dualized", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "47"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"6", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "7"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "8"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "4"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"4", ",", "6"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "5"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "5"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"5", ",", "4"}]], ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "8"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "6"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"6", ",", "1"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "2"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "9"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"8", ",", "3"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"7", ",", "6"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "8"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "8"}]], ",", "0", ",", "0", ",", "0", ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "6"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Example", " ", "on", " ", "genus", " ", "2"}], ",", " ", 
     RowBox[{"with", " ", "one", " ", 
      RowBox[{"boundary", ".", " ", 
       RowBox[{"(", 
        RowBox[{
        "Constructed", " ", "for", " ", "the", " ", "higher", " ", "genus", 
         " ", "boundary", " ", "measurement"}], ")"}], "."}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "74"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "5"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "4"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Y", 
            RowBox[{"4", ",", "3"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"6", ",", "2"}]], ",", "0", ",", 
           SubscriptBox["W", 
            RowBox[{"2", ",", "4"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["V", 
             RowBox[{"2", ",", "4"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"3", ",", "1"}]]}], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"1", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "6"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "2"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "5"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"5", ",", "1"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["Y", 
            RowBox[{"3", ",", "6"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "4"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["Z", 
            RowBox[{"2", ",", "4"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "6"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"5", ",", "1"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", "HIGHER"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], " ", 
      "GENUS"}], ",", " ", 
     RowBox[{
      RowBox[{"MULTI", " ", "BOUNDARY", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"CASES", "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
        "--"}]}], "-", 
      RowBox[{"-", 
       RowBox[{"-", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"-", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"-", 
              RowBox[{"-", 
               RowBox[{"--", 
                RowBox[{"--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Y2", ",", 
     RowBox[{
     "0", " ", "with", " ", "TWO", " ", "boundaries", " ", "each", " ", 
      "cutting", " ", "ONE", " ", 
      RowBox[{"line", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "48"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"1", ",", "3"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"4", ",", "2"}]]}], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "4"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]], ",", 
           RowBox[{
            SubscriptBox["Y", 
             RowBox[{"1", ",", "3"}]], "+", 
            SubscriptBox["Y", 
             RowBox[{"4", ",", "2"}]]}]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Y", 
            RowBox[{"3", ",", "4"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Z", 
            RowBox[{"3", ",", "4"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["Z", 
            RowBox[{"2", ",", "1"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Relabeled", " ", "Y2"}], ",", 
     RowBox[{
     "0", " ", "with", " ", "TWO", " ", "boundaries", " ", "each", " ", 
      "cutting", " ", "ONE", " ", 
      RowBox[{"line", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "70"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"3", ",", "1"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"2", ",", "4"}]]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["Y", 
             RowBox[{"3", ",", "1"}]], "+", 
            SubscriptBox["Y", 
             RowBox[{"2", ",", "4"}]]}], ",", 
           SubscriptBox["Z", 
            RowBox[{"1", ",", "2"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["Z", 
            RowBox[{"4", ",", "3"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Y", 
            RowBox[{"1", ",", "2"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "3"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Y2", ",", 
     RowBox[{
     "2", " ", "with", " ", "TWO", " ", "boundaries", " ", "each", " ", 
      "cutting", " ", "ONE", " ", 
      RowBox[{"line", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "49"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "3"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"4", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "4"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"1", ",", "3"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"3", ",", "2"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "4"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "4"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Y", 
            RowBox[{"3", ",", "4"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["Z", 
            RowBox[{"3", ",", "2"}]], ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Y6", ",", 
     RowBox[{
     "0", " ", "with", " ", "TWO", " ", "boundaries", " ", "each", " ", 
      "cutting", " ", "ONE", " ", 
      RowBox[{"line", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "50"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"7", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "8"}]], ",", "0", ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"1", ",", "2"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"8", ",", "7"}]]}], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "10"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "4"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"6", ",", "12"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"11", ",", "5"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "6"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"1", ",", "6"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"12", ",", "7"}]]}], ",", "0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"7", ",", "1"}]], ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"6", ",", "12"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"3", ",", "2"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"8", ",", "9"}]]}], ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "8"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"9", ",", "3"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"5", ",", "4"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"10", ",", "11"}]]}], ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "10"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"11", ",", "5"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"10", ",", "9"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"12", ",", "11"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"12", ",", "11"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"10", ",", "9"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Y6", ",", 
     RowBox[{"0", " ", "with", " ", "TWO", " ", 
      RowBox[{"(", 
       RowBox[{"further", " ", "apart"}], ")"}], " ", "boundaries", " ", 
      "each", " ", "cutting", " ", "ONE", " ", 
      RowBox[{"line", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "51"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"7", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "10"}]], ",", "0", ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"1", ",", "2"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"10", ",", "7"}]]}], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "8"}]], ",", "0", ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"3", ",", "4"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"8", ",", "9"}]]}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"6", ",", "12"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"11", ",", "5"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "6"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"1", ",", "6"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"12", ",", "7"}]]}], ",", "0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"7", ",", "1"}]], ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"6", ",", "12"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "2"}]], ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "10"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"9", ",", "3"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"5", ",", "4"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"8", ",", "11"}]]}], ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "8"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"11", ",", "5"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"12", ",", "11"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"10", ",", "9"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"12", ",", "11"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["Y", 
            RowBox[{"10", ",", "9"}]], ",", "0", ",", "0", ",", "0", ",", 
           "0"}], "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Wider", "-", "by", "-", 
      RowBox[{"one", " ", "Y3"}]}], ",", "3", ",", " ", 
     RowBox[{
     "with", " ", "TWO", " ", "boundaries", " ", "each", " ", "cutting", " ", 
      "ONE", " ", 
      RowBox[{"line", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "52"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "7"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "2"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "6"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "1"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"7", ",", "4"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "7"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "9"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "8"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "6"}]], ",", "0", ",", "0", ",", "0", ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "6"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "5"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "4"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "8"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "8"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "5"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "5"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "9"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "3"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"6", ",", "7"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "9"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["Y", 
            RowBox[{"6", ",", "7"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"8", ",", "9"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", "0"}], "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Square", " ", "torus", " ", 
     RowBox[{"(", 
      RowBox[{"section", " ", "7.3"}], ")"}], " ", "with", " ", "two", " ", 
     "boundaries", " ", "each", " ", "chopping", " ", "each", " ", "ONE", " ", 
     RowBox[{"line", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "53"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Y", 
            RowBox[{"7", ",", "2"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"5", ",", "8"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "5"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Y", 
            RowBox[{"1", ",", "4"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"3", ",", "6"}]], ",", "0", ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"6", ",", "1"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"4", ",", "3"}]]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"4", ",", "7"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"2", ",", "1"}]]}], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "8"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "6"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"8", ",", "7"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "5"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"8", ",", "7"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["Y", 
            RowBox[{"6", ",", "5"}]], ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"addgauge", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"7", ",", "8"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"5", ",", "6"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"zed", "=", 
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{
           SubscriptBox["Y", 
            RowBox[{"1", ",", "4"}]], 
           SubscriptBox["Y", 
            RowBox[{"5", ",", "8"}]]}], 
          RowBox[{
           SubscriptBox["Y", 
            RowBox[{"7", ",", "2"}]], 
           SubscriptBox["Y", 
            RowBox[{"3", ",", "6"}]]}]], ",", 
         FractionBox[
          SubscriptBox["X", 
           RowBox[{"4", ",", "7"}]], 
          SubscriptBox["X", 
           RowBox[{"2", ",", "1"}]]]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", "HIGHER"}]}]}]}]}]}]}]}]}]}]}], " ", "GENUS"}], 
     ",", " ", 
     RowBox[{"ZERO", " ", "BOUNDARY", " ", "CASES"}], ",", " ", 
     RowBox[{
      RowBox[{"E", ".", "G", ".", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"DIMERS", "--"}], "--"}], "--"}], "--"}]}], 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", "-"}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Y2", ",", 
     RowBox[{"0", " ", "without", " ", 
      RowBox[{"boundaries", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "54"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"3", ",", "4"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"2", ",", "1"}]]}], ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"1", ",", "3"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"4", ",", "2"}]]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["Y", 
             RowBox[{"1", ",", "3"}]], "+", 
            SubscriptBox["Y", 
             RowBox[{"4", ",", "2"}]]}], ",", 
           RowBox[{
            SubscriptBox["Y", 
             RowBox[{"2", ",", "1"}]], "+", 
            SubscriptBox["Y", 
             RowBox[{"3", ",", "4"}]]}]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Y2", ",", 
     RowBox[{"2", " ", "without", " ", 
      RowBox[{"boundaries", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "55"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"4", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "4"}]], ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "3"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"3", ",", "1"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"1", ",", "4"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Untwisted", " ", "Y2"}], ",", 
     RowBox[{"2", " ", "without", " ", 
      RowBox[{"boundaries", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "56"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Y", 
            RowBox[{"3", ",", "1"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"1", ",", "2"}]], ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "3"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Z", 
            RowBox[{"2", ",", "3"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["W", 
            RowBox[{"2", ",", "3"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "2"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"3", ",", "4"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"addgauge", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"zed", "=", 
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]], 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "2"}]]}], 
          RowBox[{
           SubscriptBox["W", 
            RowBox[{"2", ",", "3"}]], 
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]]}]], ",", 
         FractionBox[
          RowBox[{
           SubscriptBox["W", 
            RowBox[{"2", ",", "3"}]], 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "3"}]]}], 
          RowBox[{
           SubscriptBox["Y", 
            RowBox[{"1", ",", "2"}]], 
           SubscriptBox["Y", 
            RowBox[{"3", ",", "4"}]]}]]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Y3", ",", 
     RowBox[{"3", " ", "without", " ", 
      RowBox[{"boundaries", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "57"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "5"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "2"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "1"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"6", ",", "3"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "6"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"5", ",", "6"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"3", ",", "5"}]], ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"6", ",", "3"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "5"}]], ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"5", ",", "2"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "4"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "4"}]], ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "1"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"1", ",", "6"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Untwisted", " ", "Y3"}], ",", 
     RowBox[{"3", " ", "without", " ", 
      RowBox[{"boundaries", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "58"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "3"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "2"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "1"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"1", ",", "3"}]], ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"3", ",", "2"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Z", 
            RowBox[{"1", ",", "3"}]], ",", "0", ",", 
           SubscriptBox["Z", 
            RowBox[{"2", ",", "1"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["Z", 
            RowBox[{"3", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["W", 
            RowBox[{"3", ",", "2"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "4"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["V", 
            RowBox[{"3", ",", "2"}]], ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "4"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "3"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["UU", 
            RowBox[{"3", ",", "2"}]], ",", "0", ",", 
           SubscriptBox["Z", 
            RowBox[{"2", ",", "4"}]], ",", 
           SubscriptBox["Z", 
            RowBox[{"4", ",", "3"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Y4", ",", 
     RowBox[{"4", " ", "without", " ", 
      RowBox[{"boundaries", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "59"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"4", ",", "7"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "3"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "4"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "6"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "2"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "5"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "1"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"8", ",", "4"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "8"}]], ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"7", ",", "8"}]], ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "7"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"8", ",", "4"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "7"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"7", ",", "3"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"3", ",", "6"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "6"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"6", ",", "2"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "5"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "5"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"5", ",", "1"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"1", ",", "8"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Untwisted", " ", "Y4"}], ",", 
     RowBox[{"4", " ", "without", " ", 
      RowBox[{"boundaries", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "60"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["Y", 
            RowBox[{"1", ",", "2"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"3", ",", "1"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "3"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["Z", 
            RowBox[{"1", ",", "2"}]], ",", 
           SubscriptBox["Z", 
            RowBox[{"3", ",", "1"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["Z", 
            RowBox[{"2", ",", "3"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["W", 
            RowBox[{"3", ",", "1"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["W", 
            RowBox[{"1", ",", "2"}]], ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["W", 
            RowBox[{"2", ",", "3"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["V", 
            RowBox[{"2", ",", "3"}]], ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "4"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["UU", 
            RowBox[{"2", ",", "3"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "2"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"3", ",", "4"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["XX", 
            RowBox[{"2", ",", "3"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["Z", 
            RowBox[{"4", ",", "2"}]], ",", 
           SubscriptBox["Z", 
            RowBox[{"3", ",", "4"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["YY", 
            RowBox[{"2", ",", "3"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["W", 
            RowBox[{"4", ",", "2"}]], ",", 
           SubscriptBox["W", 
            RowBox[{"3", ",", "4"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Y6", ",", 
     RowBox[{"0", " ", "with", " ", "no", " ", 
      RowBox[{"boundaries", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "61"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"7", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "8"}]], ",", "0", ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"8", ",", "7"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"1", ",", "2"}]]}], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "10"}]], ",", "0", ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"3", ",", "4"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"10", ",", "9"}]]}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"6", ",", "12"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"11", ",", "5"}]], ",", "0", ",", "0", ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"5", ",", "6"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"12", ",", "11"}]]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"12", ",", "7"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"1", ",", "6"}]]}], ",", "0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"7", ",", "1"}]], ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"6", ",", "12"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"3", ",", "2"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"8", ",", "9"}]]}], ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "8"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"9", ",", "3"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"10", ",", "11"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"5", ",", "4"}]]}], ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "10"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"11", ",", "5"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Wider", "-", "by", "-", 
      RowBox[{"one", " ", "Y3"}]}], ",", "3", ",", " ", 
     RowBox[{"without", " ", 
      RowBox[{"boundaries", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "62"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "5"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "2"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "1"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"6", ",", "3"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "6"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"5", ",", "6"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "5"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "9"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "5"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "8"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "4"}]], ",", "0", ",", "0", ",", "0", ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "4"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "7"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "6"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "9"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "8"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "8"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "7"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "7"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "9"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "3"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Square", " ", "torus", " ", 
     RowBox[{"(", 
      RowBox[{"section", " ", "7.3"}], ")"}], " ", "with", " ", "no", " ", 
     RowBox[{"boundaries", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "63"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"5", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "6"}]], ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"6", ",", "5"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"1", ",", "2"}]]}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"4", ",", "8"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "3"}]], ",", "0", ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"3", ",", "4"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"8", ",", "7"}]]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"1", ",", "4"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"8", ",", "5"}]]}], ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"5", ",", "1"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "8"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"3", ",", "2"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"6", ",", "7"}]]}], ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "6"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"7", ",", "3"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Untwisted", " ", "square", " ", "torus", " ", 
     RowBox[{"(", 
      RowBox[{"section", " ", "7.3"}], ")"}], " ", "without", " ", 
     RowBox[{"boundaries", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "64"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"2", ",", "4"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"3", ",", "1"}]]}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Z", 
            RowBox[{"4", ",", "3"}]], ",", 
           SubscriptBox["Z", 
            RowBox[{"1", ",", "2"}]], ",", "0", ",", 
           RowBox[{
            SubscriptBox["Z", 
             RowBox[{"2", ",", "4"}]], "+", 
            SubscriptBox["W", 
             RowBox[{"3", ",", "1"}]]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["W", 
             RowBox[{"2", ",", "4"}]], "+", 
            SubscriptBox["V", 
             RowBox[{"3", ",", "1"}]]}], ",", "0", ",", 
           SubscriptBox["W", 
            RowBox[{"4", ",", "3"}]], ",", 
           SubscriptBox["W", 
            RowBox[{"1", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{
            SubscriptBox["Y", 
             RowBox[{"2", ",", "4"}]], "+", 
            SubscriptBox["Z", 
             RowBox[{"3", ",", "1"}]]}], ",", 
           SubscriptBox["Y", 
            RowBox[{"1", ",", "2"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "3"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"L2", ",", "2", ",", 
     RowBox[{"2", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"no", " ", "boundaries"}], ")"}], "."}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "71"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"1", ",", "2"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"2", ",", "1"}]]}], ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"2", ",", "3"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"3", ",", "2"}]]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"1", ",", "4"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"4", ",", "1"}]]}], ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"4", ",", "3"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"3", ",", "4"}]]}]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"L2", ",", "2", ",", 
     RowBox[{"2", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"no", " ", "boundaries"}], ")"}], "."}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "72"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"1", ",", "2"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"2", ",", "1"}]]}], ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"2", ",", "3"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"3", ",", "2"}]]}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"3", ",", "4"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"4", ",", "3"}]]}], ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"4", ",", "5"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"5", ",", "4"}]]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"1", ",", "6"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"6", ",", "1"}]]}], ",", "0", ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"6", ",", "5"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"5", ",", "6"}]]}]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"UNCLASSIFIED", "--"}], "--"}], "--"}], "--"}], 
                    "--"}], "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], 
     "-", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"-", 
              RowBox[{"-", 
               RowBox[{"-", 
                RowBox[{"-", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Junk", " ", 
     RowBox[{"one", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "65"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"1", ",", "2"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"2", ",", "1"}]]}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "1"}]], ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"1", ",", "3"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"3", ",", "1"}]]}]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          SubscriptBox["X", 
           RowBox[{"2", ",", "2"}]], "}"}], ",", 
         RowBox[{"{", "0", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          SubscriptBox["X", 
           RowBox[{"3", ",", "3"}]]}], "}"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{"{", "0", "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Second", " ", "junk", " ", 
     RowBox[{"one", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "66"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "2"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "5"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "6"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "4"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "6"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "5"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Second", " ", "junk", " ", "one", " ", "with", " ", "an", " ", "extra", 
     " ", 
     RowBox[{"boundary", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "67"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "2"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "5"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "6"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "4"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "6"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "5"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "1"}]], ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Second", " ", "junk", " ", "one", " ", "with", " ", "two", " ", "extra", 
     " ", 
     RowBox[{"boundaries", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "68"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "2"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "5"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "6"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "4"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "6"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "5"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "1"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Y", 
            RowBox[{"1", ",", "2"}]], ",", "0", ",", "0", ",", "0"}], "}"}]}],
         "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 CellChangeTimes->{{3.66470967834403*^9, 3.664709704091943*^9}}]
}, Closed]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6647098193051944`*^9, 3.6647098195095406`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"formatrule", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["XX_", 
      RowBox[{"z1_", ",", "z2_"}]], "\[Rule]", 
     RowBox[{"XX", "[", 
      RowBox[{"z1", ",", "z2"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ii", "=", "1"}], ",", 
    RowBox[{"ii", "\[LessEqual]", "76"}], ",", 
    RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{"ii", ",", "10"}], "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<ii=\>\"", ",", "ii"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     SubscriptBox["bft", "ii"], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"a", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b", "=", 
      RowBox[{"b", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"c", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"d", "=", 
      RowBox[{"d", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "loopvarmasterspace", ",", "loopvarmodulispace", ",", "loopvarbasis"}],
        "}"}], "=", 
      RowBox[{"moduliLoopVariablesBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "2"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"loopvarmodulispace", "=", 
      RowBox[{"loopvarmodulispace", "-", 
       RowBox[{"loopvarmodulispace", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"traditionalmodulispace", "=", 
      RowBox[{"moduliSpaceBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "2"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"traditionalmodulispace", "=", 
      RowBox[{"traditionalmodulispace", "-", 
       RowBox[{"traditionalmodulispace", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"DeleteCases", "[", 
         RowBox[{
          RowBox[{"RowReduce", "[", "traditionalmodulispace", "]"}], ",", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", 
            RowBox[{
             RowBox[{"Dimensions", "[", "traditionalmodulispace", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}], "=!=", 
        RowBox[{"RowReduce", "[", "loopvarmodulispace", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<ii=\>\"", ",", "ii", ",", 
          "\"\< : There's a problem with the moduli spaces! moduliSpaceBFT \
and moduliLoopVariablesBFT give different results!\>\""}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{
  3.662284700602398*^9, 3.662458016607738*^9, {3.664709815805024*^9, 
   3.664709833541993*^9}, {3.6647099087711387`*^9, 3.6647099198175707`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "10"}],
  SequenceForm["ii=", 10],
  Editable->False]], "Print",
 CellChangeTimes->{3.664709922838109*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "20"}],
  SequenceForm["ii=", 20],
  Editable->False]], "Print",
 CellChangeTimes->{3.6647099236887465`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "30"}],
  SequenceForm["ii=", 30],
  Editable->False]], "Print",
 CellChangeTimes->{3.6647099250366445`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "40"}],
  SequenceForm["ii=", 40],
  Editable->False]], "Print",
 CellChangeTimes->{3.664709931495743*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Part", "::", "partw"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Part \[NoBreak]\\!\\(1\\)\[NoBreak] of \
\[NoBreak]\\!\\({}\\)\[NoBreak] does not exist. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/partw\\\", ButtonNote -> \
\\\"Part::partw\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.664709932545439*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Part", "::", "partw"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Part \[NoBreak]\\!\\(1\\)\[NoBreak] of \
\[NoBreak]\\!\\({}\\)\[NoBreak] does not exist. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/partw\\\", ButtonNote -> \
\\\"Part::partw\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.6647099326204915`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Part", "::", "partw"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Part \[NoBreak]\\!\\(1\\)\[NoBreak] of \
\[NoBreak]\\!\\({}\\)\[NoBreak] does not exist. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/partw\\\", ButtonNote -> \
\\\"Part::partw\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.6647099326935387`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \[NoBreak]\\!\\(\\*StyleBox[\\(Part :: \
partw\\), \\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during this \
calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.664709932734565*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Part", "::", "partd"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Part specification \[NoBreak]\\!\\(1 \[LeftDoubleBracket] \
2 \[RightDoubleBracket]\\)\[NoBreak] is longer than depth of object. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/partd\\\", \
ButtonNote -> \\\"Part::partd\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.6647099328106174`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Part", "::", "pkspec1"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"The expression \[NoBreak]\\!\\(1 \[LeftDoubleBracket] 2 \
\[RightDoubleBracket]\\)\[NoBreak] cannot be used as a part specification. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/Part\\\", ButtonNote -> \
\\\"Part::pkspec1\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.6647099329166875`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Part", "::", "partd"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Part specification \[NoBreak]\\!\\(1 \[LeftDoubleBracket] \
2 \[RightDoubleBracket]\\)\[NoBreak] is longer than depth of object. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/partd\\\", \
ButtonNote -> \\\"Part::partd\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.664709932990738*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Part", "::", "pkspec1"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"The expression \[NoBreak]\\!\\(1 \[LeftDoubleBracket] 2 \
\[RightDoubleBracket]\\)\[NoBreak] cannot be used as a part specification. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/Part\\\", ButtonNote -> \
\\\"Part::pkspec1\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.664709933095806*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Part", "::", "partd"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Part specification \[NoBreak]\\!\\(1 \[LeftDoubleBracket] \
2 \[RightDoubleBracket]\\)\[NoBreak] is longer than depth of object. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/partd\\\", \
ButtonNote -> \\\"Part::partd\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.664709933167854*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \[NoBreak]\\!\\(\\*StyleBox[\\(Part :: \
partd\\), \\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during this \
calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.664709933208892*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Part", "::", "pkspec1"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"The expression \[NoBreak]\\!\\(1 \[LeftDoubleBracket] 2 \
\[RightDoubleBracket]\\)\[NoBreak] cannot be used as a part specification. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/Part\\\", ButtonNote -> \
\\\"Part::pkspec1\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.664709933315959*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \[NoBreak]\\!\\(\\*StyleBox[\\(Part :: \
pkspec1\\), \\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during this \
calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.664709933360675*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Transpose", "::", "nmtx"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"The first two levels of \[NoBreak]\\!\\({\\(\\({0, 0, 0, \
0, 0}\\)\\), \\(\\({1, 0, 0, 0, 0}\\)\\), \\(\\({\\(\\(-1\\)\\), 0, 0, \
\\(\\(-1\\)\\), \\(\\(-1\\)\\)}\\)\\), \\(\\(\\(\\(\\(\\({}\\)\\) \
\[LeftDoubleBracket] 2 \[RightDoubleBracket]\\)\\) \[LeftDoubleBracket] \
\\(\\(1 \[LeftDoubleBracket] 2 \[RightDoubleBracket]\\)\\) \
\[RightDoubleBracket]\\)\\), \\(\\({0, 0, 0, \\(\\(-1\\)\\), \
\\(\\(-1\\)\\)}\\)\\), \\(\\(\\(\\(\\(\\({}\\)\\) \[LeftDoubleBracket] 2 \
\[RightDoubleBracket]\\)\\) \[LeftDoubleBracket] \\(\\(1 \[LeftDoubleBracket] \
2 \[RightDoubleBracket]\\)\\) \[RightDoubleBracket]\\)\\), \\(\\({0, 0, 1, 0, \
0}\\)\\), \\(\\({0, 1, 1, 0, 0}\\)\\), \\(\\(\\(\\(\\(\\({}\\)\\) \
\[LeftDoubleBracket] 2 \[RightDoubleBracket]\\)\\) \[LeftDoubleBracket] \
\\(\\(1 \[LeftDoubleBracket] 2 \[RightDoubleBracket]\\)\\) \
\[RightDoubleBracket]\\)\\), \\(\\(\\(\\(\\(\\({}\\)\\) \[LeftDoubleBracket] \
2 \[RightDoubleBracket]\\)\\) \[LeftDoubleBracket] \\(\\(1 \
\[LeftDoubleBracket] 2 \[RightDoubleBracket]\\)\\) \
\[RightDoubleBracket]\\)\\), \\(\\({2, \\(\\(-1\\)\\), 0, 1, 0}\\)\\), \\(\\(\
\\(\\(\\(\\({}\\)\\) \[LeftDoubleBracket] 2 \[RightDoubleBracket]\\)\\) \
\[LeftDoubleBracket] \\(\\(1 \[LeftDoubleBracket] 2 \
\[RightDoubleBracket]\\)\\) \[RightDoubleBracket]\\)\\), \\(\\({0, 0, 0, 0, \
\\(\\(-1\\)\\)}\\)\\), \\(\\({1, 0, 1, 1, 0}\\)\\)}\\)\[NoBreak] cannot be \
transposed. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/Transpose/nmtx\\\", ButtonNote -> \
\\\"Transpose::nmtx\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.664709933404215*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "49", 
   "\[InvisibleSpace]", "\<\" : There's a problem with the moduli spaces! \
moduliSpaceBFT and moduliLoopVariablesBFT give different results!\"\>"}],
  SequenceForm[
  "ii=", 49, 
   " : There's a problem with the moduli spaces! moduliSpaceBFT and \
moduliLoopVariablesBFT give different results!"],
  Editable->False]], "Print",
 CellChangeTimes->{3.6647099334062104`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "50"}],
  SequenceForm["ii=", 50],
  Editable->False]], "Print",
 CellChangeTimes->{3.664709933409212*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"RowReduce", "::", "matrix"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Argument \[NoBreak]\\!\\({}\\)\[NoBreak] at position \
\[NoBreak]\\!\\(1\\)\[NoBreak] is not a non-empty rectangular matrix. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/matrix\\\", \
ButtonNote -> \\\"RowReduce::matrix\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.6647099348962045`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"ConstantArray", "::", "ilsmn"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Single or list of non-negative machine-sized integers \
expected at position \[NoBreak]\\!\\(2\\)\[NoBreak] of \
\[NoBreak]\\!\\(ConstantArray[\\(\\(0, \\(\\(\\(\\({0}\\)\\) \
\[LeftDoubleBracket] 2 \[RightDoubleBracket]\\)\\)\\)\\)]\\)\[NoBreak]. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/ilsmn\\\", \
ButtonNote -> \\\"ConstantArray::ilsmn\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.66470993497726*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"RowReduce", "::", "matrix"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Argument \[NoBreak]\\!\\({}\\)\[NoBreak] at position \
\[NoBreak]\\!\\(1\\)\[NoBreak] is not a non-empty rectangular matrix. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/matrix\\\", \
ButtonNote -> \\\"RowReduce::matrix\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.664709935050309*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"RowReduce", "::", "matrix"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Argument \[NoBreak]\\!\\({}\\)\[NoBreak] at position \
\[NoBreak]\\!\\(1\\)\[NoBreak] is not a non-empty rectangular matrix. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/matrix\\\", \
ButtonNote -> \\\"RowReduce::matrix\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.664709935141369*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \[NoBreak]\\!\\(\\*StyleBox[\\(RowReduce \
:: matrix\\), \\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during \
this calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.6647099351823945`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"ConstantArray", "::", "ilsmn"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Single or list of non-negative machine-sized integers \
expected at position \[NoBreak]\\!\\(2\\)\[NoBreak] of \
\[NoBreak]\\!\\(ConstantArray[\\(\\(0, \\(\\(\\(\\({0}\\)\\) \
\[LeftDoubleBracket] 2 \[RightDoubleBracket]\\)\\)\\)\\)]\\)\[NoBreak]. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/ilsmn\\\", \
ButtonNote -> \\\"ConstantArray::ilsmn\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.6647099352604485`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"ConstantArray", "::", "ilsmn"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Single or list of non-negative machine-sized integers \
expected at position \[NoBreak]\\!\\(2\\)\[NoBreak] of \
\[NoBreak]\\!\\(ConstantArray[\\(\\(0, \\(\\(\\(\\({0}\\)\\) \
\[LeftDoubleBracket] 2 \[RightDoubleBracket]\\)\\)\\)\\)]\\)\[NoBreak]. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/ilsmn\\\", \
ButtonNote -> \\\"ConstantArray::ilsmn\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.6647099353571997`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \
\[NoBreak]\\!\\(\\*StyleBox[\\(ConstantArray :: ilsmn\\), \
\\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during this calculation. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/stop\\\", \
ButtonNote -> \\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.6647099354497695`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "60"}],
  SequenceForm["ii=", 60],
  Editable->False]], "Print",
 CellChangeTimes->{3.664709935611881*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Solve", "::", "svars"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Equations may not give solutions for all \\\"solve\\\" \
variables. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\
\\\", ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/Solve/svars\\\", \
ButtonNote -> \\\"Solve::svars\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.6647099366035395`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Solve", "::", "svars"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Equations may not give solutions for all \\\"solve\\\" \
variables. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\
\\\", ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/Solve/svars\\\", \
ButtonNote -> \\\"Solve::svars\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.6647099366475687`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Solve", "::", "svars"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Equations may not give solutions for all \\\"solve\\\" \
variables. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\
\\\", ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/Solve/svars\\\", \
ButtonNote -> \\\"Solve::svars\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.664709936712612*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \[NoBreak]\\!\\(\\*StyleBox[\\(Solve :: \
svars\\), \\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during this \
calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.6647099367596426`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Transpose", "::", "nmtx"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"The first two levels of \[NoBreak]\\!\\({\\(\\({0, 0, 0, \
0, 0}\\)\\), \\(\\({0, \\(\\(-1\\)\\), 0, 0, 0}\\)\\), \
\\(\\(\\(\\(\\(\\({}\\)\\) \[LeftDoubleBracket] 2 \[RightDoubleBracket]\\)\\) \
\[LeftDoubleBracket] \\(\\(1 \[LeftDoubleBracket] 2 \
\[RightDoubleBracket]\\)\\) \[RightDoubleBracket]\\)\\), \\(\\(\\(\\(\\(\\({}\
\\)\\) \[LeftDoubleBracket] 2 \[RightDoubleBracket]\\)\\) \
\[LeftDoubleBracket] \\(\\(1 \[LeftDoubleBracket] 2 \
\[RightDoubleBracket]\\)\\) \[RightDoubleBracket]\\)\\), \\(\\(\\(\\(\\(\\({}\
\\)\\) \[LeftDoubleBracket] 2 \[RightDoubleBracket]\\)\\) \
\[LeftDoubleBracket] \\(\\(1 \[LeftDoubleBracket] 2 \
\[RightDoubleBracket]\\)\\) \[RightDoubleBracket]\\)\\), \\(\\(\\(\\(\\(\\({}\
\\)\\) \[LeftDoubleBracket] 2 \[RightDoubleBracket]\\)\\) \
\[LeftDoubleBracket] \\(\\(1 \[LeftDoubleBracket] 2 \
\[RightDoubleBracket]\\)\\) \[RightDoubleBracket]\\)\\), \
\\(\\({\\(\\(-1\\)\\), 0, 0, 0, 0}\\)\\), \\(\\({\\(\\(-1\\)\\), \
\\(\\(-1\\)\\), 0, 0, 0}\\)\\), \\(\\(\\(\\(\\(\\({}\\)\\) \
\[LeftDoubleBracket] 2 \[RightDoubleBracket]\\)\\) \[LeftDoubleBracket] \
\\(\\(1 \[LeftDoubleBracket] 2 \[RightDoubleBracket]\\)\\) \
\[RightDoubleBracket]\\)\\), \\(\\(\\(\\(\\(\\({}\\)\\) \[LeftDoubleBracket] \
2 \[RightDoubleBracket]\\)\\) \[LeftDoubleBracket] \\(\\(1 \
\[LeftDoubleBracket] 2 \[RightDoubleBracket]\\)\\) \
\[RightDoubleBracket]\\)\\), \\(\\(\\(\\(\\(\\({}\\)\\) \[LeftDoubleBracket] \
2 \[RightDoubleBracket]\\)\\) \[LeftDoubleBracket] \\(\\(1 \
\[LeftDoubleBracket] 2 \[RightDoubleBracket]\\)\\) \
\[RightDoubleBracket]\\)\\), \\(\\(\\(\\(\\(\\({}\\)\\) \[LeftDoubleBracket] \
2 \[RightDoubleBracket]\\)\\) \[LeftDoubleBracket] \\(\\(1 \
\[LeftDoubleBracket] 2 \[RightDoubleBracket]\\)\\) \
\[RightDoubleBracket]\\)\\), \\(\\(\\(\\(\\(\\({}\\)\\) \[LeftDoubleBracket] \
2 \[RightDoubleBracket]\\)\\) \[LeftDoubleBracket] \\(\\(1 \
\[LeftDoubleBracket] 2 \[RightDoubleBracket]\\)\\) \
\[RightDoubleBracket]\\)\\), \\(\\(\\(\\(\\(\\({}\\)\\) \[LeftDoubleBracket] \
2 \[RightDoubleBracket]\\)\\) \[LeftDoubleBracket] \\(\\(1 \
\[LeftDoubleBracket] 2 \[RightDoubleBracket]\\)\\) \
\[RightDoubleBracket]\\)\\), \\(\\(\\(\\(\\(\\({}\\)\\) \[LeftDoubleBracket] \
2 \[RightDoubleBracket]\\)\\) \[LeftDoubleBracket] \\(\\(1 \
\[LeftDoubleBracket] 2 \[RightDoubleBracket]\\)\\) \
\[RightDoubleBracket]\\)\\), \\(\\(\\(\\(\\(\\({}\\)\\) \[LeftDoubleBracket] \
2 \[RightDoubleBracket]\\)\\) \[LeftDoubleBracket] \\(\\(1 \
\[LeftDoubleBracket] 2 \[RightDoubleBracket]\\)\\) \
\[RightDoubleBracket]\\)\\), \\(\\(\\(\\(\\(\\({}\\)\\) \[LeftDoubleBracket] \
2 \[RightDoubleBracket]\\)\\) \[LeftDoubleBracket] \\(\\(1 \
\[LeftDoubleBracket] 2 \[RightDoubleBracket]\\)\\) \
\[RightDoubleBracket]\\)\\), \\(\\(\\(\\(\\(\\({}\\)\\) \[LeftDoubleBracket] \
2 \[RightDoubleBracket]\\)\\) \[LeftDoubleBracket] \\(\\(1 \
\[LeftDoubleBracket] 2 \[RightDoubleBracket]\\)\\) \
\[RightDoubleBracket]\\)\\), \\(\\(\\(\\(\\(\\({}\\)\\) \[LeftDoubleBracket] \
2 \[RightDoubleBracket]\\)\\) \[LeftDoubleBracket] \\(\\(1 \
\[LeftDoubleBracket] 2 \[RightDoubleBracket]\\)\\) \
\[RightDoubleBracket]\\)\\), \\(\\(\\(\\(\\(\\({}\\)\\) \[LeftDoubleBracket] \
2 \[RightDoubleBracket]\\)\\) \[LeftDoubleBracket] \\(\\(1 \
\[LeftDoubleBracket] 2 \[RightDoubleBracket]\\)\\) \
\[RightDoubleBracket]\\)\\), \\(\\(\\(\\(\\(\\({}\\)\\) \[LeftDoubleBracket] \
2 \[RightDoubleBracket]\\)\\) \[LeftDoubleBracket] \\(\\(1 \
\[LeftDoubleBracket] 2 \[RightDoubleBracket]\\)\\) \
\[RightDoubleBracket]\\)\\), \\(\\(\\(\\(\\(\\({}\\)\\) \[LeftDoubleBracket] \
2 \[RightDoubleBracket]\\)\\) \[LeftDoubleBracket] \\(\\(1 \
\[LeftDoubleBracket] 2 \[RightDoubleBracket]\\)\\) \
\[RightDoubleBracket]\\)\\), \\(\\(\\(\\(\\(\\({}\\)\\) \[LeftDoubleBracket] \
2 \[RightDoubleBracket]\\)\\) \[LeftDoubleBracket] \\(\\(1 \
\[LeftDoubleBracket] 2 \[RightDoubleBracket]\\)\\) \
\[RightDoubleBracket]\\)\\), \\(\\(\\(\\(\\(\\({}\\)\\) \[LeftDoubleBracket] \
2 \[RightDoubleBracket]\\)\\) \[LeftDoubleBracket] \\(\\(1 \
\[LeftDoubleBracket] 2 \[RightDoubleBracket]\\)\\) \
\[RightDoubleBracket]\\)\\), \\(\\(\[LeftSkeleton] 1 \[RightSkeleton]\\)\\), \
\\(\\(\\(\\(\\(\\({}\\)\\) \[LeftDoubleBracket] 2 \[RightDoubleBracket]\\)\\) \
\[LeftDoubleBracket] \\(\\(\[LeftSkeleton] 1 \[RightSkeleton]\\)\\) \
\[RightDoubleBracket]\\)\\), \\(\\(\\(\\(\\(\\({}\\)\\) \[LeftDoubleBracket] \
2 \[RightDoubleBracket]\\)\\) \[LeftDoubleBracket] \\(\\(1 \
\[LeftDoubleBracket] 2 \[RightDoubleBracket]\\)\\) \
\[RightDoubleBracket]\\)\\), \\(\\(\\(\\(\\(\\({}\\)\\) \[LeftDoubleBracket] \
2 \[RightDoubleBracket]\\)\\) \[LeftDoubleBracket] \\(\\(1 \
\[LeftDoubleBracket] 2 \[RightDoubleBracket]\\)\\) \
\[RightDoubleBracket]\\)\\), \\(\\(\\(\\(\\(\\({}\\)\\) \[LeftDoubleBracket] \
2 \[RightDoubleBracket]\\)\\) \[LeftDoubleBracket] \\(\\(1 \
\[LeftDoubleBracket] 2 \[RightDoubleBracket]\\)\\) \
\[RightDoubleBracket]\\)\\), \\(\\(\\(\\(\\(\\({}\\)\\) \[LeftDoubleBracket] \
2 \[RightDoubleBracket]\\)\\) \[LeftDoubleBracket] \\(\\(1 \
\[LeftDoubleBracket] 2 \[RightDoubleBracket]\\)\\) \
\[RightDoubleBracket]\\)\\), \\(\\(\\(\\(\\(\\({}\\)\\) \[LeftDoubleBracket] \
2 \[RightDoubleBracket]\\)\\) \[LeftDoubleBracket] \\(\\(1 \
\[LeftDoubleBracket] 2 \[RightDoubleBracket]\\)\\) \
\[RightDoubleBracket]\\)\\), \\(\\(\\(\\(\\(\\({}\\)\\) \[LeftDoubleBracket] \
2 \[RightDoubleBracket]\\)\\) \[LeftDoubleBracket] \\(\\(1 \
\[LeftDoubleBracket] 2 \[RightDoubleBracket]\\)\\) \
\[RightDoubleBracket]\\)\\), \\(\\(\\(\\(\\(\\({}\\)\\) \[LeftDoubleBracket] \
2 \[RightDoubleBracket]\\)\\) \[LeftDoubleBracket] \\(\\(1 \
\[LeftDoubleBracket] 2 \[RightDoubleBracket]\\)\\) \
\[RightDoubleBracket]\\)\\), \\(\\(\\(\\(\\(\\({}\\)\\) \[LeftDoubleBracket] \
2 \[RightDoubleBracket]\\)\\) \[LeftDoubleBracket] \\(\\(1 \
\[LeftDoubleBracket] 2 \[RightDoubleBracket]\\)\\) \
\[RightDoubleBracket]\\)\\), \\(\\(\\(\\(\\(\\({}\\)\\) \[LeftDoubleBracket] \
2 \[RightDoubleBracket]\\)\\) \[LeftDoubleBracket] \\(\\(1 \
\[LeftDoubleBracket] 2 \[RightDoubleBracket]\\)\\) \
\[RightDoubleBracket]\\)\\), \\(\\(\\(\\(\\(\\({}\\)\\) \[LeftDoubleBracket] \
2 \[RightDoubleBracket]\\)\\) \[LeftDoubleBracket] \\(\\(1 \
\[LeftDoubleBracket] 2 \[RightDoubleBracket]\\)\\) \
\[RightDoubleBracket]\\)\\), \\(\\(\\(\\(\\(\\({}\\)\\) \[LeftDoubleBracket] \
2 \[RightDoubleBracket]\\)\\) \[LeftDoubleBracket] \\(\\(1 \
\[LeftDoubleBracket] 2 \[RightDoubleBracket]\\)\\) \
\[RightDoubleBracket]\\)\\), \\(\\(\\(\\(\\(\\({}\\)\\) \[LeftDoubleBracket] \
2 \[RightDoubleBracket]\\)\\) \[LeftDoubleBracket] \\(\\(1 \
\[LeftDoubleBracket] 2 \[RightDoubleBracket]\\)\\) \
\[RightDoubleBracket]\\)\\), \\(\\(\\(\\(\\(\\({}\\)\\) \[LeftDoubleBracket] \
2 \[RightDoubleBracket]\\)\\) \[LeftDoubleBracket] \\(\\(1 \
\[LeftDoubleBracket] 2 \[RightDoubleBracket]\\)\\) \
\[RightDoubleBracket]\\)\\), \\(\\(\\(\\(\\(\\({}\\)\\) \[LeftDoubleBracket] \
2 \[RightDoubleBracket]\\)\\) \[LeftDoubleBracket] \\(\\(1 \
\[LeftDoubleBracket] 2 \[RightDoubleBracket]\\)\\) \
\[RightDoubleBracket]\\)\\), \\(\\(\\(\\(\\(\\({}\\)\\) \[LeftDoubleBracket] \
2 \[RightDoubleBracket]\\)\\) \[LeftDoubleBracket] \\(\\(1 \
\[LeftDoubleBracket] 2 \[RightDoubleBracket]\\)\\) \
\[RightDoubleBracket]\\)\\), \\(\\(\\(\\(\\(\\({}\\)\\) \[LeftDoubleBracket] \
2 \[RightDoubleBracket]\\)\\) \[LeftDoubleBracket] \\(\\(1 \
\[LeftDoubleBracket] 2 \[RightDoubleBracket]\\)\\) \
\[RightDoubleBracket]\\)\\), \\(\\(\\(\\(\\(\\({}\\)\\) \[LeftDoubleBracket] \
2 \[RightDoubleBracket]\\)\\) \[LeftDoubleBracket] \\(\\(1 \
\[LeftDoubleBracket] 2 \[RightDoubleBracket]\\)\\) \
\[RightDoubleBracket]\\)\\), \\(\\(\\(\\(\\(\\({}\\)\\) \[LeftDoubleBracket] \
2 \[RightDoubleBracket]\\)\\) \[LeftDoubleBracket] \\(\\(1 \
\[LeftDoubleBracket] 2 \[RightDoubleBracket]\\)\\) \
\[RightDoubleBracket]\\)\\), \\(\\(\\(\\(\\(\\({}\\)\\) \[LeftDoubleBracket] \
2 \[RightDoubleBracket]\\)\\) \[LeftDoubleBracket] \\(\\(1 \
\[LeftDoubleBracket] 2 \[RightDoubleBracket]\\)\\) \
\[RightDoubleBracket]\\)\\), \\(\\(\\(\\(\\(\\({}\\)\\) \[LeftDoubleBracket] \
2 \[RightDoubleBracket]\\)\\) \[LeftDoubleBracket] \\(\\(1 \
\[LeftDoubleBracket] 2 \[RightDoubleBracket]\\)\\) \
\[RightDoubleBracket]\\)\\), \\(\\(\\(\\(\\(\\({}\\)\\) \[LeftDoubleBracket] \
2 \[RightDoubleBracket]\\)\\) \[LeftDoubleBracket] \\(\\(1 \
\[LeftDoubleBracket] 2 \[RightDoubleBracket]\\)\\) \
\[RightDoubleBracket]\\)\\), \\(\\(\\(\\(\\(\\({}\\)\\) \[LeftDoubleBracket] \
2 \[RightDoubleBracket]\\)\\) \[LeftDoubleBracket] \\(\\(1 \
\[LeftDoubleBracket] 2 \[RightDoubleBracket]\\)\\) \
\[RightDoubleBracket]\\)\\), \\(\\(\\(\\(\\(\\({}\\)\\) \[LeftDoubleBracket] \
2 \[RightDoubleBracket]\\)\\) \[LeftDoubleBracket] \\(\\(1 \
\[LeftDoubleBracket] 2 \[RightDoubleBracket]\\)\\) \
\[RightDoubleBracket]\\)\\)}\\)\[NoBreak] cannot be transposed. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/Transpose/nmtx\\\", \
ButtonNote -> \\\"Transpose::nmtx\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.664709936825688*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "68", 
   "\[InvisibleSpace]", "\<\" : There's a problem with the moduli spaces! \
moduliSpaceBFT and moduliLoopVariablesBFT give different results!\"\>"}],
  SequenceForm[
  "ii=", 68, 
   " : There's a problem with the moduli spaces! moduliSpaceBFT and \
moduliLoopVariablesBFT give different results!"],
  Editable->False]], "Print",
 CellChangeTimes->{3.6647099368316936`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "70"}],
  SequenceForm["ii=", 70],
  Editable->False]], "Print",
 CellChangeTimes->{3.6647099369277573`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"jj", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"loopdenom", "=", 
  RowBox[{
   RowBox[{"Expand", "[", 
    RowBox[{"1", "/", 
     RowBox[{"Expand", "[", 
      RowBox[{"Simplify", "[", 
       RowBox[{"Det", "[", 
        RowBox[{"connectivityMatrix", "[", 
         RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", 
          RowBox[{"perfs", "[", 
           RowBox[{"[", "jj", "]"}], "]"}]}], "]"}], "]"}], "]"}], "]"}]}], 
    "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Times", "[", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "zz_"}], "]"}], "\[Rule]", 
     RowBox[{"Times", "[", 
      RowBox[{"1", ",", "zz"}], "]"}]}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"truemappluckertoperfmatch", "=", 
  RowBox[{"Expand", "[", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"pluckers", "[", 
      RowBox[{"[", "2", "]"}], "]"}], " ", "loopdenom", " ", 
     RowBox[{"perfs", "[", 
      RowBox[{"[", "jj", "]"}], "]"}]}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"sourcesets", "=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"findSources", "[", 
      RowBox[{"b", ",", "c", ",", "#"}], "]"}], "&"}], ",", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", "terms", "}"}], ",", 
          RowBox[{"Block", "[", 
           RowBox[{
            RowBox[{"{", "return", "}"}], ",", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Head", "[", "terms", "]"}], "===", "Plus"}], ",", 
               RowBox[{
                RowBox[{"return", "=", 
                 RowBox[{"List", "@@", "terms"}]}], ";"}], ",", 
               RowBox[{
                RowBox[{"return", "=", 
                 RowBox[{"{", "terms", "}"}]}], ";"}]}], "]"}], ";", 
             "return"}]}], "]"}]}], "]"}], "[", "#", "]"}], "&"}], ",", 
      "truemappluckertoperfmatch"}], "]"}], ",", 
    RowBox[{"{", "2", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"correctsourcesets", "=", 
  RowBox[{"Subsets", "[", 
   RowBox[{
    RowBox[{"pluckers", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"Length", "[", 
      RowBox[{"srcs", "[", 
       RowBox[{"[", "jj", "]"}], "]"}], "]"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"everythingOK", "=", 
   RowBox[{"And", "@@", 
    RowBox[{"Flatten", "[", 
     RowBox[{"MapThread", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Sort", "[", "#", "]"}], "===", 
            RowBox[{"Sort", "[", "#1", "]"}]}], "&"}], ",", "#2"}], "]"}], 
        "&"}], ",", 
       RowBox[{"{", 
        RowBox[{"correctsourcesets", ",", "sourcesets"}], "}"}]}], "]"}], 
     "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6645435245125084`*^9, 3.664543556545208*^9}, {
  3.664543594810079*^9, 3.664543598381584*^9}, {3.6645436597981243`*^9, 
  3.664543899503933*^9}, {3.6645439600232325`*^9, 3.664543968324605*^9}, {
  3.664544006338789*^9, 3.6645441582178926`*^9}, {3.6645442088731003`*^9, 
  3.664544228592906*^9}, {3.664544279084282*^9, 3.664544319204629*^9}}],

Cell[BoxData[
 RowBox[{"1", "+", 
  FractionBox[
   RowBox[{
    SubscriptBox["X", 
     RowBox[{"3", ",", "1"}]], " ", 
    SubscriptBox["X", 
     RowBox[{"5", ",", "1"}]]}], 
   RowBox[{
    SubscriptBox["X", 
     RowBox[{"1", ",", "2"}]], " ", 
    SubscriptBox["X", 
     RowBox[{"1", ",", "4"}]]}]]}]], "Output",
 CellChangeTimes->{
  3.6645435573647504`*^9, {3.664543596199825*^9, 3.6645435987628374`*^9}, {
   3.664543661573197*^9, 3.6645436787360506`*^9}, 3.6645437117663436`*^9, {
   3.6645438028667855`*^9, 3.664543828018671*^9}, {3.6645438705598125`*^9, 
   3.664543900219595*^9}, 3.664543965209233*^9, 3.664544008811948*^9, 
   3.6645440449653263`*^9, 3.664544076479596*^9, 3.664544120419495*^9, 
   3.664544161149417*^9, {3.664544219510102*^9, 3.664544228911112*^9}, {
   3.6645442805722213`*^9, 3.664544320175787*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SubscriptBox["X", 
     RowBox[{"2", ",", "3"}]], " ", 
    SubscriptBox["X", 
     RowBox[{"4", ",", "3"}]], " ", 
    SubscriptBox["X", 
     RowBox[{"5", ",", "1"}]]}], ",", 
   RowBox[{
    RowBox[{
     SubscriptBox["X", 
      RowBox[{"1", ",", "2"}]], " ", 
     SubscriptBox["X", 
      RowBox[{"1", ",", "4"}]]}], "+", 
    RowBox[{
     SubscriptBox["X", 
      RowBox[{"3", ",", "1"}]], " ", 
     SubscriptBox["X", 
      RowBox[{"5", ",", "1"}]]}]}], ",", 
   RowBox[{
    SubscriptBox["X", 
     RowBox[{"1", ",", "2"}]], " ", 
    SubscriptBox["X", 
     RowBox[{"4", ",", "3"}]], " ", 
    SubscriptBox["X", 
     RowBox[{"4", ",", "5"}]]}], ",", 
   RowBox[{
    SubscriptBox["X", 
     RowBox[{"1", ",", "4"}]], " ", 
    SubscriptBox["X", 
     RowBox[{"2", ",", "3"}]], " ", 
    SubscriptBox["X", 
     RowBox[{"2", ",", "5"}]]}], ",", 
   RowBox[{
    SubscriptBox["X", 
     RowBox[{"2", ",", "3"}]], " ", 
    SubscriptBox["X", 
     RowBox[{"2", ",", "5"}]], " ", 
    SubscriptBox["X", 
     RowBox[{"4", ",", "3"}]], " ", 
    SubscriptBox["X", 
     RowBox[{"4", ",", "5"}]]}], ",", 
   RowBox[{
    SubscriptBox["X", 
     RowBox[{"2", ",", "5"}]], " ", 
    SubscriptBox["X", 
     RowBox[{"3", ",", "1"}]], " ", 
    SubscriptBox["X", 
     RowBox[{"4", ",", "5"}]]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6645435573647504`*^9, {3.664543596199825*^9, 3.6645435987628374`*^9}, {
   3.664543661573197*^9, 3.6645436787360506`*^9}, 3.6645437117663436`*^9, {
   3.6645438028667855`*^9, 3.664543828018671*^9}, {3.6645438705598125`*^9, 
   3.664543900219595*^9}, 3.664543965209233*^9, 3.664544008811948*^9, 
   3.6645440449653263`*^9, 3.664544076479596*^9, 3.664544120419495*^9, 
   3.664544161149417*^9, {3.664544219510102*^9, 3.664544228911112*^9}, {
   3.6645442805722213`*^9, 3.6645443201830044`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["X", 
       RowBox[{"2", ",", "3"}]], ",", 
      SubscriptBox["X", 
       RowBox[{"2", ",", "5"}]]}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["X", 
        RowBox[{"2", ",", "5"}]], ",", 
       SubscriptBox["X", 
        RowBox[{"4", ",", "3"}]]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["X", 
        RowBox[{"2", ",", "5"}]], ",", 
       SubscriptBox["X", 
        RowBox[{"4", ",", "3"}]]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["X", 
       RowBox[{"2", ",", "5"}]], ",", 
      SubscriptBox["X", 
       RowBox[{"4", ",", "5"}]]}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["X", 
       RowBox[{"2", ",", "3"}]], ",", 
      SubscriptBox["X", 
       RowBox[{"4", ",", "3"}]]}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["X", 
       RowBox[{"2", ",", "3"}]], ",", 
      SubscriptBox["X", 
       RowBox[{"4", ",", "5"}]]}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["X", 
       RowBox[{"4", ",", "3"}]], ",", 
      SubscriptBox["X", 
       RowBox[{"4", ",", "5"}]]}], "}"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6645435573647504`*^9, {3.664543596199825*^9, 3.6645435987628374`*^9}, {
   3.664543661573197*^9, 3.6645436787360506`*^9}, 3.6645437117663436`*^9, {
   3.6645438028667855`*^9, 3.664543828018671*^9}, {3.6645438705598125`*^9, 
   3.664543900219595*^9}, 3.664543965209233*^9, 3.664544008811948*^9, 
   3.6645440449653263`*^9, 3.664544076479596*^9, 3.664544120419495*^9, 
   3.664544161149417*^9, {3.664544219510102*^9, 3.664544228911112*^9}, {
   3.6645442805722213`*^9, 3.6645443201890063`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["X", 
      RowBox[{"2", ",", "5"}]], ",", 
     SubscriptBox["X", 
      RowBox[{"2", ",", "3"}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["X", 
      RowBox[{"2", ",", "5"}]], ",", 
     SubscriptBox["X", 
      RowBox[{"4", ",", "3"}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["X", 
      RowBox[{"2", ",", "5"}]], ",", 
     SubscriptBox["X", 
      RowBox[{"4", ",", "5"}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["X", 
      RowBox[{"2", ",", "3"}]], ",", 
     SubscriptBox["X", 
      RowBox[{"4", ",", "3"}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["X", 
      RowBox[{"2", ",", "3"}]], ",", 
     SubscriptBox["X", 
      RowBox[{"4", ",", "5"}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["X", 
      RowBox[{"4", ",", "3"}]], ",", 
     SubscriptBox["X", 
      RowBox[{"4", ",", "5"}]]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6645435573647504`*^9, {3.664543596199825*^9, 3.6645435987628374`*^9}, {
   3.664543661573197*^9, 3.6645436787360506`*^9}, 3.6645437117663436`*^9, {
   3.6645438028667855`*^9, 3.664543828018671*^9}, {3.6645438705598125`*^9, 
   3.664543900219595*^9}, 3.664543965209233*^9, 3.664544008811948*^9, 
   3.6645440449653263`*^9, 3.664544076479596*^9, 3.664544120419495*^9, 
   3.664544161149417*^9, {3.664544219510102*^9, 3.664544228911112*^9}, {
   3.6645442805722213`*^9, 3.664544320194013*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ii", "=", "1"}], ",", 
    RowBox[{"ii", "<", "10"}], ",", 
    RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     SubscriptBox["bft", "ii"], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Looking at bft number \>\"", ",", "ii"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"perfs", "=", 
      RowBox[{"perfectMatchings", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<We have \>\"", ",", 
       RowBox[{"Length", "[", "perfs", "]"}], ",", 
       "\"\< perfect matchings to go through.\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"srcs", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"findSources", "[", 
          RowBox[{"b", ",", "c", ",", "#"}], "]"}], "&"}], ",", "perfs"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"multiplic", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Tally", "[", "srcs", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"#", ",", "2"}], "]"}], "]"}], "&"}], ",", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{
              RowBox[{"Tally", "[", "srcs", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"#", ",", "_"}], "}"}]}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "&"}], ",", "srcs"}], 
         "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"jj", "=", "1"}], ",", 
       RowBox[{"jj", "<", 
        RowBox[{"Length", "[", "perfs", "]"}]}], ",", 
       RowBox[{"jj", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"multiplic", "[", 
            RowBox[{"[", "jj", "]"}], "]"}], "\[LessEqual]", "3"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"pluckers", "=", 
            RowBox[{"pluckerCoordinates", "[", 
             RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", 
              RowBox[{"perfs", "[", 
               RowBox[{"[", "jj", "]"}], "]"}], ",", "True"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{"pluckers", ",", 
                RowBox[{
                 RowBox[{"Power", "[", 
                  RowBox[{"___", ",", "2"}], "]"}], "|", 
                 RowBox[{"Power", "[", 
                  RowBox[{"___", ",", "3"}], "]"}], "|", 
                 RowBox[{"Power", "[", 
                  RowBox[{"___", ",", "4"}], "]"}], "|", 
                 RowBox[{"Times", "[", 
                  RowBox[{"2", ",", "___"}], "]"}], "|", 
                 RowBox[{"Times", "[", 
                  RowBox[{"3", ",", "___"}], "]"}], "|", 
                 RowBox[{"Times", "[", 
                  RowBox[{"4", ",", "___"}], "]"}]}]}], "]"}], "=!=", 
              RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<PROBLEM HERE?? Perfect matching \>\"", ",", "jj"}], "]"}],
               ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"loopdenom", "=", 
            RowBox[{
             RowBox[{"Expand", "[", 
              RowBox[{"1", "/", 
               RowBox[{"Expand", "[", 
                RowBox[{"Simplify", "[", 
                 RowBox[{"Det", "[", 
                  RowBox[{"connectivityMatrix", "[", 
                   RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", 
                    RowBox[{"perfs", "[", 
                    RowBox[{"[", "jj", "]"}], "]"}]}], "]"}], "]"}], "]"}], 
                "]"}]}], "]"}], "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Times", "[", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "zz_"}], "]"}], "\[Rule]", 
               RowBox[{"Times", "[", 
                RowBox[{"1", ",", "zz"}], "]"}]}], "}"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"truemappluckertoperfmatch", "=", 
            RowBox[{"Expand", "[", 
             RowBox[{"Simplify", "[", 
              RowBox[{
               RowBox[{"pluckers", "[", 
                RowBox[{"[", "2", "]"}], "]"}], " ", "loopdenom", " ", 
               RowBox[{"perfs", "[", 
                RowBox[{"[", "jj", "]"}], "]"}]}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"sourcesets", "=", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"findSources", "[", 
                RowBox[{"b", ",", "c", ",", "#"}], "]"}], "&"}], ",", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Function", "[", 
                   RowBox[{
                    RowBox[{"{", "terms", "}"}], ",", 
                    RowBox[{"Block", "[", 
                    RowBox[{
                    RowBox[{"{", "return", "}"}], ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Head", "[", "terms", "]"}], "===", "Plus"}], ",", 
                    RowBox[{
                    RowBox[{"return", "=", 
                    RowBox[{"List", "@@", "terms"}]}], ";"}], ",", 
                    RowBox[{
                    RowBox[{"return", "=", 
                    RowBox[{"{", "terms", "}"}]}], ";"}]}], "]"}], ";", 
                    "return"}]}], "]"}]}], "]"}], "[", "#", "]"}], "&"}], ",",
                 "truemappluckertoperfmatch"}], "]"}], ",", 
              RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"correctsourcesets", "=", 
            RowBox[{"Subsets", "[", 
             RowBox[{
              RowBox[{"pluckers", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"Length", "[", 
                RowBox[{"srcs", "[", 
                 RowBox[{"[", "jj", "]"}], "]"}], "]"}], "}"}]}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"everythingOK", "=", 
            RowBox[{"And", "@@", 
             RowBox[{"Flatten", "[", 
              RowBox[{"MapThread", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Map", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"Sort", "[", "#", "]"}], "===", 
                    RowBox[{"Sort", "[", "#1", "]"}]}], "&"}], ",", "#2"}], 
                  "]"}], "&"}], ",", 
                RowBox[{"{", 
                 RowBox[{"correctsourcesets", ",", "sourcesets"}], "}"}]}], 
               "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"everythingOK", "=!=", "True"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<SOME PERFECT MATCHINGS DON'T HAVE THE SOURCE SET DICTATED \
BY THE PLUCKER COORDINATE IN WHICH THEY'RE IN! Perfect matching \>\"", ",", 
                "jj"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}],
          "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<DONE\>\"", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
     "Print", "[", "\"\<-----------------------------------------\>\"", "]"}],
      ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.664541947318012*^9, 3.664541954505026*^9}, {
  3.664541989840146*^9, 3.6645420409873915`*^9}, {3.664542078453598*^9, 
  3.664542079388213*^9}, {3.664542143097637*^9, 3.664542173823498*^9}, {
  3.66454231831004*^9, 3.664542350395336*^9}, {3.6645423913358984`*^9, 
  3.6645424684165535`*^9}, {3.6645425106779113`*^9, 3.664542548316332*^9}, {
  3.6645426176059256`*^9, 3.6645426516663284`*^9}, {3.6645427400554066`*^9, 
  3.664542801779271*^9}, {3.66454285527442*^9, 3.6645428711268263`*^9}, {
  3.6645429058601065`*^9, 3.664543088676875*^9}, {3.6645431293436847`*^9, 
  3.6645431649195104`*^9}, {3.6645432002958755`*^9, 3.664543484477997*^9}, {
  3.6645439365615396`*^9, 3.6645439405535393`*^9}, {3.664544337345024*^9, 
  3.664544507183031*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Looking at bft number \"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["Looking at bft number ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{{3.6645425915426016`*^9, 3.6645426562812386`*^9}, {
   3.6645427478209243`*^9, 3.6645427702546463`*^9}, 3.664542802185042*^9, 
   3.664542871479051*^9, 3.6645429074981937`*^9, {3.6645429787149553`*^9, 
   3.664543012453538*^9}, 3.6645430908994308`*^9, 3.664543167661518*^9, {
   3.6645432043914194`*^9, 3.6645432567579927`*^9}, {3.664543366644001*^9, 
   3.6645433909167085`*^9}, {3.664543451292409*^9, 3.6645434743723803`*^9}, 
   3.664543940887757*^9, {3.6645444424638166`*^9, 3.6645444728715076`*^9}, 
   3.6645445083133607`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"We have \"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\" perfect matchings to go through.\"\>"}],
  SequenceForm["We have ", 7, " perfect matchings to go through."],
  Editable->False]], "Print",
 CellChangeTimes->{{3.6645425915426016`*^9, 3.6645426562812386`*^9}, {
   3.6645427478209243`*^9, 3.6645427702546463`*^9}, 3.664542802185042*^9, 
   3.664542871479051*^9, 3.6645429074981937`*^9, {3.6645429787149553`*^9, 
   3.664543012453538*^9}, 3.6645430908994308`*^9, 3.664543167661518*^9, {
   3.6645432043914194`*^9, 3.6645432567579927`*^9}, {3.664543366644001*^9, 
   3.6645433909167085`*^9}, {3.664543451292409*^9, 3.6645434743723803`*^9}, 
   3.664543940887757*^9, {3.6645444424638166`*^9, 3.6645444728715076`*^9}, 
   3.6645445083193645`*^9}],

Cell[BoxData["\<\"DONE\"\>"], "Print",
 CellChangeTimes->{{3.6645425915426016`*^9, 3.6645426562812386`*^9}, {
   3.6645427478209243`*^9, 3.6645427702546463`*^9}, 3.664542802185042*^9, 
   3.664542871479051*^9, 3.6645429074981937`*^9, {3.6645429787149553`*^9, 
   3.664543012453538*^9}, 3.6645430908994308`*^9, 3.664543167661518*^9, {
   3.6645432043914194`*^9, 3.6645432567579927`*^9}, {3.664543366644001*^9, 
   3.6645433909167085`*^9}, {3.664543451292409*^9, 3.6645434743723803`*^9}, 
   3.664543940887757*^9, {3.6645444424638166`*^9, 3.6645444728715076`*^9}, 
   3.66454450862757*^9}],

Cell[BoxData["\<\"-----------------------------------------\"\>"], "Print",
 CellChangeTimes->{{3.6645425915426016`*^9, 3.6645426562812386`*^9}, {
   3.6645427478209243`*^9, 3.6645427702546463`*^9}, 3.664542802185042*^9, 
   3.664542871479051*^9, 3.6645429074981937`*^9, {3.6645429787149553`*^9, 
   3.664543012453538*^9}, 3.6645430908994308`*^9, 3.664543167661518*^9, {
   3.6645432043914194`*^9, 3.6645432567579927`*^9}, {3.664543366644001*^9, 
   3.6645433909167085`*^9}, {3.664543451292409*^9, 3.6645434743723803`*^9}, 
   3.664543940887757*^9, {3.6645444424638166`*^9, 3.6645444728715076`*^9}, 
   3.664544508629572*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Looking at bft number \"\>", "\[InvisibleSpace]", "2"}],
  SequenceForm["Looking at bft number ", 2],
  Editable->False]], "Print",
 CellChangeTimes->{{3.6645425915426016`*^9, 3.6645426562812386`*^9}, {
   3.6645427478209243`*^9, 3.6645427702546463`*^9}, 3.664542802185042*^9, 
   3.664542871479051*^9, 3.6645429074981937`*^9, {3.6645429787149553`*^9, 
   3.664543012453538*^9}, 3.6645430908994308`*^9, 3.664543167661518*^9, {
   3.6645432043914194`*^9, 3.6645432567579927`*^9}, {3.664543366644001*^9, 
   3.6645433909167085`*^9}, {3.664543451292409*^9, 3.6645434743723803`*^9}, 
   3.664543940887757*^9, {3.6645444424638166`*^9, 3.6645444728715076`*^9}, 
   3.664544508633576*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"We have \"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\" perfect matchings to go through.\"\>"}],
  SequenceForm["We have ", 7, " perfect matchings to go through."],
  Editable->False]], "Print",
 CellChangeTimes->{{3.6645425915426016`*^9, 3.6645426562812386`*^9}, {
   3.6645427478209243`*^9, 3.6645427702546463`*^9}, 3.664542802185042*^9, 
   3.664542871479051*^9, 3.6645429074981937`*^9, {3.6645429787149553`*^9, 
   3.664543012453538*^9}, 3.6645430908994308`*^9, 3.664543167661518*^9, {
   3.6645432043914194`*^9, 3.6645432567579927`*^9}, {3.664543366644001*^9, 
   3.6645433909167085`*^9}, {3.664543451292409*^9, 3.6645434743723803`*^9}, 
   3.664543940887757*^9, {3.6645444424638166`*^9, 3.6645444728715076`*^9}, 
   3.664544508637576*^9}],

Cell[BoxData["\<\"DONE\"\>"], "Print",
 CellChangeTimes->{{3.6645425915426016`*^9, 3.6645426562812386`*^9}, {
   3.6645427478209243`*^9, 3.6645427702546463`*^9}, 3.664542802185042*^9, 
   3.664542871479051*^9, 3.6645429074981937`*^9, {3.6645429787149553`*^9, 
   3.664543012453538*^9}, 3.6645430908994308`*^9, 3.664543167661518*^9, {
   3.6645432043914194`*^9, 3.6645432567579927`*^9}, {3.664543366644001*^9, 
   3.6645433909167085`*^9}, {3.664543451292409*^9, 3.6645434743723803`*^9}, 
   3.664543940887757*^9, {3.6645444424638166`*^9, 3.6645444728715076`*^9}, 
   3.664544509054854*^9}],

Cell[BoxData["\<\"-----------------------------------------\"\>"], "Print",
 CellChangeTimes->{{3.6645425915426016`*^9, 3.6645426562812386`*^9}, {
   3.6645427478209243`*^9, 3.6645427702546463`*^9}, 3.664542802185042*^9, 
   3.664542871479051*^9, 3.6645429074981937`*^9, {3.6645429787149553`*^9, 
   3.664543012453538*^9}, 3.6645430908994308`*^9, 3.664543167661518*^9, {
   3.6645432043914194`*^9, 3.6645432567579927`*^9}, {3.664543366644001*^9, 
   3.6645433909167085`*^9}, {3.664543451292409*^9, 3.6645434743723803`*^9}, 
   3.664543940887757*^9, {3.6645444424638166`*^9, 3.6645444728715076`*^9}, 
   3.6645445090598574`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Looking at bft number \"\>", "\[InvisibleSpace]", "3"}],
  SequenceForm["Looking at bft number ", 3],
  Editable->False]], "Print",
 CellChangeTimes->{{3.6645425915426016`*^9, 3.6645426562812386`*^9}, {
   3.6645427478209243`*^9, 3.6645427702546463`*^9}, 3.664542802185042*^9, 
   3.664542871479051*^9, 3.6645429074981937`*^9, {3.6645429787149553`*^9, 
   3.664543012453538*^9}, 3.6645430908994308`*^9, 3.664543167661518*^9, {
   3.6645432043914194`*^9, 3.6645432567579927`*^9}, {3.664543366644001*^9, 
   3.6645433909167085`*^9}, {3.664543451292409*^9, 3.6645434743723803`*^9}, 
   3.664543940887757*^9, {3.6645444424638166`*^9, 3.6645444728715076`*^9}, 
   3.6645445090648613`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"We have \"\>", "\[InvisibleSpace]", "10", 
   "\[InvisibleSpace]", "\<\" perfect matchings to go through.\"\>"}],
  SequenceForm["We have ", 10, " perfect matchings to go through."],
  Editable->False]], "Print",
 CellChangeTimes->{{3.6645425915426016`*^9, 3.6645426562812386`*^9}, {
   3.6645427478209243`*^9, 3.6645427702546463`*^9}, 3.664542802185042*^9, 
   3.664542871479051*^9, 3.6645429074981937`*^9, {3.6645429787149553`*^9, 
   3.664543012453538*^9}, 3.6645430908994308`*^9, 3.664543167661518*^9, {
   3.6645432043914194`*^9, 3.6645432567579927`*^9}, {3.664543366644001*^9, 
   3.6645433909167085`*^9}, {3.664543451292409*^9, 3.6645434743723803`*^9}, 
   3.664543940887757*^9, {3.6645444424638166`*^9, 3.6645444728715076`*^9}, 
   3.664544509068864*^9}],

Cell[BoxData["\<\"DONE\"\>"], "Print",
 CellChangeTimes->{{3.6645425915426016`*^9, 3.6645426562812386`*^9}, {
   3.6645427478209243`*^9, 3.6645427702546463`*^9}, 3.664542802185042*^9, 
   3.664542871479051*^9, 3.6645429074981937`*^9, {3.6645429787149553`*^9, 
   3.664543012453538*^9}, 3.6645430908994308`*^9, 3.664543167661518*^9, {
   3.6645432043914194`*^9, 3.6645432567579927`*^9}, {3.664543366644001*^9, 
   3.6645433909167085`*^9}, {3.664543451292409*^9, 3.6645434743723803`*^9}, 
   3.664543940887757*^9, {3.6645444424638166`*^9, 3.6645444728715076`*^9}, 
   3.664544510706674*^9}],

Cell[BoxData["\<\"-----------------------------------------\"\>"], "Print",
 CellChangeTimes->{{3.6645425915426016`*^9, 3.6645426562812386`*^9}, {
   3.6645427478209243`*^9, 3.6645427702546463`*^9}, 3.664542802185042*^9, 
   3.664542871479051*^9, 3.6645429074981937`*^9, {3.6645429787149553`*^9, 
   3.664543012453538*^9}, 3.6645430908994308`*^9, 3.664543167661518*^9, {
   3.6645432043914194`*^9, 3.6645432567579927`*^9}, {3.664543366644001*^9, 
   3.6645433909167085`*^9}, {3.664543451292409*^9, 3.6645434743723803`*^9}, 
   3.664543940887757*^9, {3.6645444424638166`*^9, 3.6645444728715076`*^9}, 
   3.664544510714676*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Looking at bft number \"\>", "\[InvisibleSpace]", "4"}],
  SequenceForm["Looking at bft number ", 4],
  Editable->False]], "Print",
 CellChangeTimes->{{3.6645425915426016`*^9, 3.6645426562812386`*^9}, {
   3.6645427478209243`*^9, 3.6645427702546463`*^9}, 3.664542802185042*^9, 
   3.664542871479051*^9, 3.6645429074981937`*^9, {3.6645429787149553`*^9, 
   3.664543012453538*^9}, 3.6645430908994308`*^9, 3.664543167661518*^9, {
   3.6645432043914194`*^9, 3.6645432567579927`*^9}, {3.664543366644001*^9, 
   3.6645433909167085`*^9}, {3.664543451292409*^9, 3.6645434743723803`*^9}, 
   3.664543940887757*^9, {3.6645444424638166`*^9, 3.6645444728715076`*^9}, 
   3.664544510722681*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"We have \"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\" perfect matchings to go through.\"\>"}],
  SequenceForm["We have ", 7, " perfect matchings to go through."],
  Editable->False]], "Print",
 CellChangeTimes->{{3.6645425915426016`*^9, 3.6645426562812386`*^9}, {
   3.6645427478209243`*^9, 3.6645427702546463`*^9}, 3.664542802185042*^9, 
   3.664542871479051*^9, 3.6645429074981937`*^9, {3.6645429787149553`*^9, 
   3.664543012453538*^9}, 3.6645430908994308`*^9, 3.664543167661518*^9, {
   3.6645432043914194`*^9, 3.6645432567579927`*^9}, {3.664543366644001*^9, 
   3.6645433909167085`*^9}, {3.664543451292409*^9, 3.6645434743723803`*^9}, 
   3.664543940887757*^9, {3.6645444424638166`*^9, 3.6645444728715076`*^9}, 
   3.664544510732689*^9}],

Cell[BoxData["\<\"DONE\"\>"], "Print",
 CellChangeTimes->{{3.6645425915426016`*^9, 3.6645426562812386`*^9}, {
   3.6645427478209243`*^9, 3.6645427702546463`*^9}, 3.664542802185042*^9, 
   3.664542871479051*^9, 3.6645429074981937`*^9, {3.6645429787149553`*^9, 
   3.664543012453538*^9}, 3.6645430908994308`*^9, 3.664543167661518*^9, {
   3.6645432043914194`*^9, 3.6645432567579927`*^9}, {3.664543366644001*^9, 
   3.6645433909167085`*^9}, {3.664543451292409*^9, 3.6645434743723803`*^9}, 
   3.664543940887757*^9, {3.6645444424638166`*^9, 3.6645444728715076`*^9}, 
   3.664544511028885*^9}],

Cell[BoxData["\<\"-----------------------------------------\"\>"], "Print",
 CellChangeTimes->{{3.6645425915426016`*^9, 3.6645426562812386`*^9}, {
   3.6645427478209243`*^9, 3.6645427702546463`*^9}, 3.664542802185042*^9, 
   3.664542871479051*^9, 3.6645429074981937`*^9, {3.6645429787149553`*^9, 
   3.664543012453538*^9}, 3.6645430908994308`*^9, 3.664543167661518*^9, {
   3.6645432043914194`*^9, 3.6645432567579927`*^9}, {3.664543366644001*^9, 
   3.6645433909167085`*^9}, {3.664543451292409*^9, 3.6645434743723803`*^9}, 
   3.664543940887757*^9, {3.6645444424638166`*^9, 3.6645444728715076`*^9}, 
   3.664544511031887*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Looking at bft number \"\>", "\[InvisibleSpace]", "5"}],
  SequenceForm["Looking at bft number ", 5],
  Editable->False]], "Print",
 CellChangeTimes->{{3.6645425915426016`*^9, 3.6645426562812386`*^9}, {
   3.6645427478209243`*^9, 3.6645427702546463`*^9}, 3.664542802185042*^9, 
   3.664542871479051*^9, 3.6645429074981937`*^9, {3.6645429787149553`*^9, 
   3.664543012453538*^9}, 3.6645430908994308`*^9, 3.664543167661518*^9, {
   3.6645432043914194`*^9, 3.6645432567579927`*^9}, {3.664543366644001*^9, 
   3.6645433909167085`*^9}, {3.664543451292409*^9, 3.6645434743723803`*^9}, 
   3.664543940887757*^9, {3.6645444424638166`*^9, 3.6645444728715076`*^9}, 
   3.6645445110358896`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"We have \"\>", "\[InvisibleSpace]", "9", 
   "\[InvisibleSpace]", "\<\" perfect matchings to go through.\"\>"}],
  SequenceForm["We have ", 9, " perfect matchings to go through."],
  Editable->False]], "Print",
 CellChangeTimes->{{3.6645425915426016`*^9, 3.6645426562812386`*^9}, {
   3.6645427478209243`*^9, 3.6645427702546463`*^9}, 3.664542802185042*^9, 
   3.664542871479051*^9, 3.6645429074981937`*^9, {3.6645429787149553`*^9, 
   3.664543012453538*^9}, 3.6645430908994308`*^9, 3.664543167661518*^9, {
   3.6645432043914194`*^9, 3.6645432567579927`*^9}, {3.664543366644001*^9, 
   3.6645433909167085`*^9}, {3.664543451292409*^9, 3.6645434743723803`*^9}, 
   3.664543940887757*^9, {3.6645444424638166`*^9, 3.6645444728715076`*^9}, 
   3.6645445110408955`*^9}],

Cell[BoxData["\<\"DONE\"\>"], "Print",
 CellChangeTimes->{{3.6645425915426016`*^9, 3.6645426562812386`*^9}, {
   3.6645427478209243`*^9, 3.6645427702546463`*^9}, 3.664542802185042*^9, 
   3.664542871479051*^9, 3.6645429074981937`*^9, {3.6645429787149553`*^9, 
   3.664543012453538*^9}, 3.6645430908994308`*^9, 3.664543167661518*^9, {
   3.6645432043914194`*^9, 3.6645432567579927`*^9}, {3.664543366644001*^9, 
   3.6645433909167085`*^9}, {3.664543451292409*^9, 3.6645434743723803`*^9}, 
   3.664543940887757*^9, {3.6645444424638166`*^9, 3.6645444728715076`*^9}, 
   3.6645445120085373`*^9}],

Cell[BoxData["\<\"-----------------------------------------\"\>"], "Print",
 CellChangeTimes->{{3.6645425915426016`*^9, 3.6645426562812386`*^9}, {
   3.6645427478209243`*^9, 3.6645427702546463`*^9}, 3.664542802185042*^9, 
   3.664542871479051*^9, 3.6645429074981937`*^9, {3.6645429787149553`*^9, 
   3.664543012453538*^9}, 3.6645430908994308`*^9, 3.664543167661518*^9, {
   3.6645432043914194`*^9, 3.6645432567579927`*^9}, {3.664543366644001*^9, 
   3.6645433909167085`*^9}, {3.664543451292409*^9, 3.6645434743723803`*^9}, 
   3.664543940887757*^9, {3.6645444424638166`*^9, 3.6645444728715076`*^9}, 
   3.6645445120165453`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Looking at bft number \"\>", "\[InvisibleSpace]", "6"}],
  SequenceForm["Looking at bft number ", 6],
  Editable->False]], "Print",
 CellChangeTimes->{{3.6645425915426016`*^9, 3.6645426562812386`*^9}, {
   3.6645427478209243`*^9, 3.6645427702546463`*^9}, 3.664542802185042*^9, 
   3.664542871479051*^9, 3.6645429074981937`*^9, {3.6645429787149553`*^9, 
   3.664543012453538*^9}, 3.6645430908994308`*^9, 3.664543167661518*^9, {
   3.6645432043914194`*^9, 3.6645432567579927`*^9}, {3.664543366644001*^9, 
   3.6645433909167085`*^9}, {3.664543451292409*^9, 3.6645434743723803`*^9}, 
   3.664543940887757*^9, {3.6645444424638166`*^9, 3.6645444728715076`*^9}, 
   3.664544512020548*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"We have \"\>", "\[InvisibleSpace]", "14", 
   "\[InvisibleSpace]", "\<\" perfect matchings to go through.\"\>"}],
  SequenceForm["We have ", 14, " perfect matchings to go through."],
  Editable->False]], "Print",
 CellChangeTimes->{{3.6645425915426016`*^9, 3.6645426562812386`*^9}, {
   3.6645427478209243`*^9, 3.6645427702546463`*^9}, 3.664542802185042*^9, 
   3.664542871479051*^9, 3.6645429074981937`*^9, {3.6645429787149553`*^9, 
   3.664543012453538*^9}, 3.6645430908994308`*^9, 3.664543167661518*^9, {
   3.6645432043914194`*^9, 3.6645432567579927`*^9}, {3.664543366644001*^9, 
   3.6645433909167085`*^9}, {3.664543451292409*^9, 3.6645434743723803`*^9}, 
   3.664543940887757*^9, {3.6645444424638166`*^9, 3.6645444728715076`*^9}, 
   3.664544512023547*^9}],

Cell[BoxData["\<\"DONE\"\>"], "Print",
 CellChangeTimes->{{3.6645425915426016`*^9, 3.6645426562812386`*^9}, {
   3.6645427478209243`*^9, 3.6645427702546463`*^9}, 3.664542802185042*^9, 
   3.664542871479051*^9, 3.6645429074981937`*^9, {3.6645429787149553`*^9, 
   3.664543012453538*^9}, 3.6645430908994308`*^9, 3.664543167661518*^9, {
   3.6645432043914194`*^9, 3.6645432567579927`*^9}, {3.664543366644001*^9, 
   3.6645433909167085`*^9}, {3.664543451292409*^9, 3.6645434743723803`*^9}, 
   3.664543940887757*^9, {3.6645444424638166`*^9, 3.6645444728715076`*^9}, 
   3.6645445146992893`*^9}],

Cell[BoxData["\<\"-----------------------------------------\"\>"], "Print",
 CellChangeTimes->{{3.6645425915426016`*^9, 3.6645426562812386`*^9}, {
   3.6645427478209243`*^9, 3.6645427702546463`*^9}, 3.664542802185042*^9, 
   3.664542871479051*^9, 3.6645429074981937`*^9, {3.6645429787149553`*^9, 
   3.664543012453538*^9}, 3.6645430908994308`*^9, 3.664543167661518*^9, {
   3.6645432043914194`*^9, 3.6645432567579927`*^9}, {3.664543366644001*^9, 
   3.6645433909167085`*^9}, {3.664543451292409*^9, 3.6645434743723803`*^9}, 
   3.664543940887757*^9, {3.6645444424638166`*^9, 3.6645444728715076`*^9}, 
   3.6645445147092953`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Looking at bft number \"\>", "\[InvisibleSpace]", "7"}],
  SequenceForm["Looking at bft number ", 7],
  Editable->False]], "Print",
 CellChangeTimes->{{3.6645425915426016`*^9, 3.6645426562812386`*^9}, {
   3.6645427478209243`*^9, 3.6645427702546463`*^9}, 3.664542802185042*^9, 
   3.664542871479051*^9, 3.6645429074981937`*^9, {3.6645429787149553`*^9, 
   3.664543012453538*^9}, 3.6645430908994308`*^9, 3.664543167661518*^9, {
   3.6645432043914194`*^9, 3.6645432567579927`*^9}, {3.664543366644001*^9, 
   3.6645433909167085`*^9}, {3.664543451292409*^9, 3.6645434743723803`*^9}, 
   3.664543940887757*^9, {3.6645444424638166`*^9, 3.6645444728715076`*^9}, 
   3.6645445147142954`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"We have \"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\" perfect matchings to go through.\"\>"}],
  SequenceForm["We have ", 4, " perfect matchings to go through."],
  Editable->False]], "Print",
 CellChangeTimes->{{3.6645425915426016`*^9, 3.6645426562812386`*^9}, {
   3.6645427478209243`*^9, 3.6645427702546463`*^9}, 3.664542802185042*^9, 
   3.664542871479051*^9, 3.6645429074981937`*^9, {3.6645429787149553`*^9, 
   3.664543012453538*^9}, 3.6645430908994308`*^9, 3.664543167661518*^9, {
   3.6645432043914194`*^9, 3.6645432567579927`*^9}, {3.664543366644001*^9, 
   3.6645433909167085`*^9}, {3.664543451292409*^9, 3.6645434743723803`*^9}, 
   3.664543940887757*^9, {3.6645444424638166`*^9, 3.6645444728715076`*^9}, 
   3.6645445147202997`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"AdjacencyMatrix", "::", "graph"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"A graph object is expected at position \
\[NoBreak]\\!\\(1\\)\[NoBreak] in \
\[NoBreak]\\!\\(AdjacencyMatrix[\\(\\(PathGraph[\\(\\({2, 1, 2}\\)\\)]\\)\\)]\
\\)\[NoBreak]. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/AdjacencyMatrix\\\", ButtonNote -> \
\\\"AdjacencyMatrix::graph\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.66454451485539*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Part", "::", "partw"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Part \[NoBreak]\\!\\({1, 2}\\)\[NoBreak] of \
\[NoBreak]\\!\\(PathGraph[\\(\\({2, 1, 2}\\)\\)]\\)\[NoBreak] does not exist. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/partw\\\", \
ButtonNote -> \\\"Part::partw\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.664544514928438*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Part", "::", "partw"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Part \[NoBreak]\\!\\({1, 2}\\)\[NoBreak] of \
\[NoBreak]\\!\\(PathGraph[\\(\\({2, 1, 2}\\)\\)]\\)\[NoBreak] does not exist. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/partw\\\", \
ButtonNote -> \\\"Part::partw\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.6645445150084915`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"AdjacencyGraph", "::", "inv"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"The argument \[NoBreak]\\!\\({\\(\\({0, 0, 3, 1}\\)\\), \
\\(\\({0, \\(\\(\\(\\(AdjacencyMatrix[\\(\\(PathGraph[\\(\\({2, 1, \
2}\\)\\)]\\)\\)]\\)\\) \[LeftDoubleBracket] \\(\\(\\(\\({1, 2}\\)\\), \
\\(\\({1, 2}\\)\\)\\)\\) \[RightDoubleBracket]\\)\\), 1, \
\\(\\(\\(\\(AdjacencyMatrix[\\(\\(PathGraph[\\(\\({2, 1, \
2}\\)\\)]\\)\\)]\\)\\) \[LeftDoubleBracket] \\(\\(\\(\\({1, 2}\\)\\), \
\\(\\({1, 2}\\)\\)\\)\\) \[RightDoubleBracket]\\)\\)}\\)\\), \\(\\({3, 1, 0, \
0}\\)\\), \\(\\({1, \\(\\(\\(\\(AdjacencyMatrix[\\(\\(PathGraph[\\(\\({2, 1, \
2}\\)\\)]\\)\\)]\\)\\) \[LeftDoubleBracket] \\(\\(\\(\\({1, 2}\\)\\), \
\\(\\({1, 2}\\)\\)\\)\\) \[RightDoubleBracket]\\)\\), 0, \
\\(\\(\\(\\(AdjacencyMatrix[\\(\\(PathGraph[\\(\\({2, 1, \
2}\\)\\)]\\)\\)]\\)\\) \[LeftDoubleBracket] \\(\\(\\(\\({1, 2}\\)\\), \
\\(\\({1, 2}\\)\\)\\)\\) \[RightDoubleBracket]\\)\\)}\\)\\)}\\)\[NoBreak] in \
\[NoBreak]\\!\\(AdjacencyGraph[\\(\\({\\(\\({0, 0, 3, 1}\\)\\), \\(\\({0, \\(\
\\(\\(\\(AdjacencyMatrix[\\(\\(PathGraph[\\(\\({2, 1, 2}\\)\\)]\\)\\)]\\)\\) \
\[LeftDoubleBracket] \\(\\(\\(\\({1, 2}\\)\\), \\(\\({1, 2}\\)\\)\\)\\) \
\[RightDoubleBracket]\\)\\), 1, \
\\(\\(\\(\\(AdjacencyMatrix[\\(\\(PathGraph[\\(\\({2, 1, \
2}\\)\\)]\\)\\)]\\)\\) \[LeftDoubleBracket] \\(\\(\\(\\({1, 2}\\)\\), \
\\(\\({1, 2}\\)\\)\\)\\) \[RightDoubleBracket]\\)\\)}\\)\\), \\(\\({3, 1, 0, \
0}\\)\\), \\(\\({1, \\(\\(\\(\\(AdjacencyMatrix[\\(\\(PathGraph[\\(\\({2, 1, \
2}\\)\\)]\\)\\)]\\)\\) \[LeftDoubleBracket] \\(\\(\\(\\({1, 2}\\)\\), \
\\(\\({1, 2}\\)\\)\\)\\) \[RightDoubleBracket]\\)\\), 0, \
\\(\\(\\(\\(AdjacencyMatrix[\\(\\(PathGraph[\\(\\({2, 1, \
2}\\)\\)]\\)\\)]\\)\\) \[LeftDoubleBracket] \\(\\(\\(\\({1, 2}\\)\\), \
\\(\\({1, 2}\\)\\)\\)\\) \[RightDoubleBracket]\\)\\)}\\)\\)}\\)\\)]\\)\
\[NoBreak] is not a valid \[NoBreak]\\!\\(\\\"adjacency matrix\\\"\\)\
\[NoBreak]. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/AdjacencyGraph\\\", ButtonNote -> \
\\\"AdjacencyGraph::inv\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.6645445151335783`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"MapThread", "::", "mptc"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Incompatible dimensions of objects at positions {2, \
\[NoBreak]\\!\\(1\\)\[NoBreak]} and {2, \[NoBreak]\\!\\(2\\)\[NoBreak]} of \
\[NoBreak]\\!\\(MapThread[\\(\\(\\(\\(\\(\\(\\(\\((\\(\\(\\(\\(\\(Sort[#1]\\)\
\\) === \\(\\(Sort[#1]\\)\\)\\)\\) &\\))\\)\\)/@#2\\)\\) &\\)\\), \
\\(\\({\\(\\({\\(\\({X\\_\\(4, 3\\)}\\)\\), \\(\\({Y\\_\\(4, 3\\)}\\)\\), \\(\
\\({X\\_\\(4, 3\\)}\\)\\), \\(\\({Y\\_\\(4, 3\\)}\\)\\)}\\)\\), \
\\(\\({\\(\\({\\(\\({Y\\_\\(4, 3\\)}\\)\\), \\(\\({Y\\_\\(4, 3\\)}\\)\\), \\(\
\\({Y\\_\\(4, 3\\)}\\)\\)}\\)\\), \\(\\({\\({X\\_\\(4, \
3\\)}\\)}\\)\\)}\\)\\)}\\)\\)\\)\\)]\\)\[NoBreak]; dimensions are \
\[NoBreak]\\!\\(4\\)\[NoBreak] and \[NoBreak]\\!\\(2\\)\[NoBreak]. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/MapThread/mptc\\\", \
ButtonNote -> \\\"MapThread::mptc\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.66454451521663*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"SOME PERFECT MATCHINGS DON'T HAVE THE SOURCE SET DICTATED BY \
THE PLUCKER COORDINATE IN WHICH THEY'RE IN! Perfect matching \"\>", 
   "\[InvisibleSpace]", "1"}],
  SequenceForm[
  "SOME PERFECT MATCHINGS DON'T HAVE THE SOURCE SET DICTATED BY THE PLUCKER \
COORDINATE IN WHICH THEY'RE IN! Perfect matching ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{{3.6645425915426016`*^9, 3.6645426562812386`*^9}, {
   3.6645427478209243`*^9, 3.6645427702546463`*^9}, 3.664542802185042*^9, 
   3.664542871479051*^9, 3.6645429074981937`*^9, {3.6645429787149553`*^9, 
   3.664543012453538*^9}, 3.6645430908994308`*^9, 3.664543167661518*^9, {
   3.6645432043914194`*^9, 3.6645432567579927`*^9}, {3.664543366644001*^9, 
   3.6645433909167085`*^9}, {3.664543451292409*^9, 3.6645434743723803`*^9}, 
   3.664543940887757*^9, {3.6645444424638166`*^9, 3.6645444728715076`*^9}, 
   3.664544515245651*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"AdjacencyMatrix", "::", "graph"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"A graph object is expected at position \
\[NoBreak]\\!\\(1\\)\[NoBreak] in \
\[NoBreak]\\!\\(AdjacencyMatrix[\\(\\(PathGraph[\\(\\({2, 1, 2}\\)\\)]\\)\\)]\
\\)\[NoBreak]. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/AdjacencyMatrix\\\", ButtonNote -> \
\\\"AdjacencyMatrix::graph\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.664544515341714*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Part", "::", "partw"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Part \[NoBreak]\\!\\({1, 2}\\)\[NoBreak] of \
\[NoBreak]\\!\\(PathGraph[\\(\\({2, 1, 2}\\)\\)]\\)\[NoBreak] does not exist. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/partw\\\", \
ButtonNote -> \\\"Part::partw\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.6645445154187665`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \[NoBreak]\\!\\(\\*StyleBox[\\(Part :: \
partw\\), \\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during this \
calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.6645445154707994`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"AdjacencyGraph", "::", "inv"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"The argument \[NoBreak]\\!\\({\\(\\({0, 0, 3, 1}\\)\\), \
\\(\\({0, \\(\\(\\(\\(AdjacencyMatrix[\\(\\(PathGraph[\\(\\({2, 1, \
2}\\)\\)]\\)\\)]\\)\\) \[LeftDoubleBracket] \\(\\(\\(\\({1, 2}\\)\\), \
\\(\\({1, 2}\\)\\)\\)\\) \[RightDoubleBracket]\\)\\), 1, \
\\(\\(\\(\\(AdjacencyMatrix[\\(\\(PathGraph[\\(\\({2, 1, \
2}\\)\\)]\\)\\)]\\)\\) \[LeftDoubleBracket] \\(\\(\\(\\({1, 2}\\)\\), \
\\(\\({1, 2}\\)\\)\\)\\) \[RightDoubleBracket]\\)\\)}\\)\\), \\(\\({3, 1, 0, \
0}\\)\\), \\(\\({1, \\(\\(\\(\\(AdjacencyMatrix[\\(\\(PathGraph[\\(\\({2, 1, \
2}\\)\\)]\\)\\)]\\)\\) \[LeftDoubleBracket] \\(\\(\\(\\({1, 2}\\)\\), \
\\(\\({1, 2}\\)\\)\\)\\) \[RightDoubleBracket]\\)\\), 0, \
\\(\\(\\(\\(AdjacencyMatrix[\\(\\(PathGraph[\\(\\({2, 1, \
2}\\)\\)]\\)\\)]\\)\\) \[LeftDoubleBracket] \\(\\(\\(\\({1, 2}\\)\\), \
\\(\\({1, 2}\\)\\)\\)\\) \[RightDoubleBracket]\\)\\)}\\)\\)}\\)\[NoBreak] in \
\[NoBreak]\\!\\(AdjacencyGraph[\\(\\({\\(\\({0, 0, 3, 1}\\)\\), \\(\\({0, \\(\
\\(\\(\\(AdjacencyMatrix[\\(\\(PathGraph[\\(\\({2, 1, 2}\\)\\)]\\)\\)]\\)\\) \
\[LeftDoubleBracket] \\(\\(\\(\\({1, 2}\\)\\), \\(\\({1, 2}\\)\\)\\)\\) \
\[RightDoubleBracket]\\)\\), 1, \
\\(\\(\\(\\(AdjacencyMatrix[\\(\\(PathGraph[\\(\\({2, 1, \
2}\\)\\)]\\)\\)]\\)\\) \[LeftDoubleBracket] \\(\\(\\(\\({1, 2}\\)\\), \
\\(\\({1, 2}\\)\\)\\)\\) \[RightDoubleBracket]\\)\\)}\\)\\), \\(\\({3, 1, 0, \
0}\\)\\), \\(\\({1, \\(\\(\\(\\(AdjacencyMatrix[\\(\\(PathGraph[\\(\\({2, 1, \
2}\\)\\)]\\)\\)]\\)\\) \[LeftDoubleBracket] \\(\\(\\(\\({1, 2}\\)\\), \
\\(\\({1, 2}\\)\\)\\)\\) \[RightDoubleBracket]\\)\\), 0, \
\\(\\(\\(\\(AdjacencyMatrix[\\(\\(PathGraph[\\(\\({2, 1, \
2}\\)\\)]\\)\\)]\\)\\) \[LeftDoubleBracket] \\(\\(\\(\\({1, 2}\\)\\), \
\\(\\({1, 2}\\)\\)\\)\\) \[RightDoubleBracket]\\)\\)}\\)\\)}\\)\\)]\\)\
\[NoBreak] is not a valid \[NoBreak]\\!\\(\\\"adjacency matrix\\\"\\)\
\[NoBreak]. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/AdjacencyGraph\\\", ButtonNote -> \
\\\"AdjacencyGraph::inv\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.6645445155838737`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"MapThread", "::", "mptc"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Incompatible dimensions of objects at positions {2, \
\[NoBreak]\\!\\(1\\)\[NoBreak]} and {2, \[NoBreak]\\!\\(2\\)\[NoBreak]} of \
\[NoBreak]\\!\\(MapThread[\\(\\(\\(\\(\\(\\(\\(\\((\\(\\(\\(\\(\\(Sort[#1]\\)\
\\) === \\(\\(Sort[#1]\\)\\)\\)\\) &\\))\\)\\)/@#2\\)\\) &\\)\\), \
\\(\\({\\(\\({\\(\\({X\\_\\(4, 3\\)}\\)\\), \\(\\({Y\\_\\(4, 3\\)}\\)\\), \\(\
\\({X\\_\\(4, 3\\)}\\)\\), \\(\\({Y\\_\\(4, 3\\)}\\)\\)}\\)\\), \
\\(\\({\\(\\({\\(\\({Y\\_\\(4, 3\\)}\\)\\), \\(\\({Y\\_\\(4, 3\\)}\\)\\), \\(\
\\({Y\\_\\(4, 3\\)}\\)\\)}\\)\\), \\(\\({\\({X\\_\\(4, \
3\\)}\\)}\\)\\)}\\)\\)}\\)\\)\\)\\)]\\)\[NoBreak]; dimensions are \
\[NoBreak]\\!\\(4\\)\[NoBreak] and \[NoBreak]\\!\\(2\\)\[NoBreak]. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/MapThread/mptc\\\", \
ButtonNote -> \\\"MapThread::mptc\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.664544515658924*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"SOME PERFECT MATCHINGS DON'T HAVE THE SOURCE SET DICTATED BY \
THE PLUCKER COORDINATE IN WHICH THEY'RE IN! Perfect matching \"\>", 
   "\[InvisibleSpace]", "2"}],
  SequenceForm[
  "SOME PERFECT MATCHINGS DON'T HAVE THE SOURCE SET DICTATED BY THE PLUCKER \
COORDINATE IN WHICH THEY'RE IN! Perfect matching ", 2],
  Editable->False]], "Print",
 CellChangeTimes->{{3.6645425915426016`*^9, 3.6645426562812386`*^9}, {
   3.6645427478209243`*^9, 3.6645427702546463`*^9}, 3.664542802185042*^9, 
   3.664542871479051*^9, 3.6645429074981937`*^9, {3.6645429787149553`*^9, 
   3.664543012453538*^9}, 3.6645430908994308`*^9, 3.664543167661518*^9, {
   3.6645432043914194`*^9, 3.6645432567579927`*^9}, {3.664543366644001*^9, 
   3.6645433909167085`*^9}, {3.664543451292409*^9, 3.6645434743723803`*^9}, 
   3.664543940887757*^9, {3.6645444424638166`*^9, 3.6645444728715076`*^9}, 
   3.664544515663927*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"AdjacencyMatrix", "::", "graph"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"A graph object is expected at position \
\[NoBreak]\\!\\(1\\)\[NoBreak] in \
\[NoBreak]\\!\\(AdjacencyMatrix[\\(\\(PathGraph[\\(\\({2, 1, 2}\\)\\)]\\)\\)]\
\\)\[NoBreak]. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/AdjacencyMatrix\\\", ButtonNote -> \
\\\"AdjacencyMatrix::graph\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.6645445157790036`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \
\[NoBreak]\\!\\(\\*StyleBox[\\(AdjacencyMatrix :: graph\\), \\\"MessageName\\\
\"]\\)\[NoBreak] will be suppressed during this calculation. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/stop\\\", \
ButtonNote -> \\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.664544515842046*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"AdjacencyGraph", "::", "inv"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"The argument \[NoBreak]\\!\\({\\(\\({0, 0, 3, 1}\\)\\), \
\\(\\({0, \\(\\(\\(\\(AdjacencyMatrix[\\(\\(PathGraph[\\(\\({2, 1, \
2}\\)\\)]\\)\\)]\\)\\) \[LeftDoubleBracket] \\(\\(\\(\\({1, 2}\\)\\), \
\\(\\({1, 2}\\)\\)\\)\\) \[RightDoubleBracket]\\)\\), 1, \
\\(\\(\\(\\(AdjacencyMatrix[\\(\\(PathGraph[\\(\\({2, 1, \
2}\\)\\)]\\)\\)]\\)\\) \[LeftDoubleBracket] \\(\\(\\(\\({1, 2}\\)\\), \
\\(\\({1, 2}\\)\\)\\)\\) \[RightDoubleBracket]\\)\\)}\\)\\), \\(\\({3, 1, 0, \
0}\\)\\), \\(\\({1, \\(\\(\\(\\(AdjacencyMatrix[\\(\\(PathGraph[\\(\\({2, 1, \
2}\\)\\)]\\)\\)]\\)\\) \[LeftDoubleBracket] \\(\\(\\(\\({1, 2}\\)\\), \
\\(\\({1, 2}\\)\\)\\)\\) \[RightDoubleBracket]\\)\\), 0, \
\\(\\(\\(\\(AdjacencyMatrix[\\(\\(PathGraph[\\(\\({2, 1, \
2}\\)\\)]\\)\\)]\\)\\) \[LeftDoubleBracket] \\(\\(\\(\\({1, 2}\\)\\), \
\\(\\({1, 2}\\)\\)\\)\\) \[RightDoubleBracket]\\)\\)}\\)\\)}\\)\[NoBreak] in \
\[NoBreak]\\!\\(AdjacencyGraph[\\(\\({\\(\\({0, 0, 3, 1}\\)\\), \\(\\({0, \\(\
\\(\\(\\(AdjacencyMatrix[\\(\\(PathGraph[\\(\\({2, 1, 2}\\)\\)]\\)\\)]\\)\\) \
\[LeftDoubleBracket] \\(\\(\\(\\({1, 2}\\)\\), \\(\\({1, 2}\\)\\)\\)\\) \
\[RightDoubleBracket]\\)\\), 1, \
\\(\\(\\(\\(AdjacencyMatrix[\\(\\(PathGraph[\\(\\({2, 1, \
2}\\)\\)]\\)\\)]\\)\\) \[LeftDoubleBracket] \\(\\(\\(\\({1, 2}\\)\\), \
\\(\\({1, 2}\\)\\)\\)\\) \[RightDoubleBracket]\\)\\)}\\)\\), \\(\\({3, 1, 0, \
0}\\)\\), \\(\\({1, \\(\\(\\(\\(AdjacencyMatrix[\\(\\(PathGraph[\\(\\({2, 1, \
2}\\)\\)]\\)\\)]\\)\\) \[LeftDoubleBracket] \\(\\(\\(\\({1, 2}\\)\\), \
\\(\\({1, 2}\\)\\)\\)\\) \[RightDoubleBracket]\\)\\), 0, \
\\(\\(\\(\\(AdjacencyMatrix[\\(\\(PathGraph[\\(\\({2, 1, \
2}\\)\\)]\\)\\)]\\)\\) \[LeftDoubleBracket] \\(\\(\\(\\({1, 2}\\)\\), \
\\(\\({1, 2}\\)\\)\\)\\) \[RightDoubleBracket]\\)\\)}\\)\\)}\\)\\)]\\)\
\[NoBreak] is not a valid \[NoBreak]\\!\\(\\\"adjacency matrix\\\"\\)\
\[NoBreak]. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/AdjacencyGraph\\\", ButtonNote -> \
\\\"AdjacencyGraph::inv\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.6645445159411116`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \
\[NoBreak]\\!\\(\\*StyleBox[\\(AdjacencyGraph :: inv\\), \\\"MessageName\\\"]\
\\)\[NoBreak] will be suppressed during this calculation. \\!\\(\\*ButtonBox[\
\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.664544516001152*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"MapThread", "::", "mptc"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Incompatible dimensions of objects at positions {2, \
\[NoBreak]\\!\\(1\\)\[NoBreak]} and {2, \[NoBreak]\\!\\(2\\)\[NoBreak]} of \
\[NoBreak]\\!\\(MapThread[\\(\\(\\(\\(\\(\\(\\(\\((\\(\\(\\(\\(\\(Sort[#1]\\)\
\\) === \\(\\(Sort[#1]\\)\\)\\)\\) &\\))\\)\\)/@#2\\)\\) &\\)\\), \
\\(\\({\\(\\({\\(\\({X\\_\\(4, 3\\)}\\)\\), \\(\\({Y\\_\\(4, 3\\)}\\)\\), \\(\
\\({X\\_\\(4, 3\\)}\\)\\), \\(\\({Y\\_\\(4, 3\\)}\\)\\)}\\)\\), \
\\(\\({\\(\\({\\(\\({Y\\_\\(4, 3\\)}\\)\\), \\(\\({Y\\_\\(4, 3\\)}\\)\\), \\(\
\\({Y\\_\\(4, 3\\)}\\)\\)}\\)\\), \\(\\({\\({X\\_\\(4, \
3\\)}\\)}\\)\\)}\\)\\)}\\)\\)\\)\\)]\\)\[NoBreak]; dimensions are \
\[NoBreak]\\!\\(4\\)\[NoBreak] and \[NoBreak]\\!\\(2\\)\[NoBreak]. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/MapThread/mptc\\\", \
ButtonNote -> \\\"MapThread::mptc\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.664544516062195*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \[NoBreak]\\!\\(\\*StyleBox[\\(MapThread \
:: mptc\\), \\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during this \
calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.664544516118229*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"SOME PERFECT MATCHINGS DON'T HAVE THE SOURCE SET DICTATED BY \
THE PLUCKER COORDINATE IN WHICH THEY'RE IN! Perfect matching \"\>", 
   "\[InvisibleSpace]", "3"}],
  SequenceForm[
  "SOME PERFECT MATCHINGS DON'T HAVE THE SOURCE SET DICTATED BY THE PLUCKER \
COORDINATE IN WHICH THEY'RE IN! Perfect matching ", 3],
  Editable->False]], "Print",
 CellChangeTimes->{{3.6645425915426016`*^9, 3.6645426562812386`*^9}, {
   3.6645427478209243`*^9, 3.6645427702546463`*^9}, 3.664542802185042*^9, 
   3.664542871479051*^9, 3.6645429074981937`*^9, {3.6645429787149553`*^9, 
   3.664543012453538*^9}, 3.6645430908994308`*^9, 3.664543167661518*^9, {
   3.6645432043914194`*^9, 3.6645432567579927`*^9}, {3.664543366644001*^9, 
   3.6645433909167085`*^9}, {3.664543451292409*^9, 3.6645434743723803`*^9}, 
   3.664543940887757*^9, {3.6645444424638166`*^9, 3.6645444728715076`*^9}, 
   3.664544516122232*^9}],

Cell[BoxData["\<\"DONE\"\>"], "Print",
 CellChangeTimes->{{3.6645425915426016`*^9, 3.6645426562812386`*^9}, {
   3.6645427478209243`*^9, 3.6645427702546463`*^9}, 3.664542802185042*^9, 
   3.664542871479051*^9, 3.6645429074981937`*^9, {3.6645429787149553`*^9, 
   3.664543012453538*^9}, 3.6645430908994308`*^9, 3.664543167661518*^9, {
   3.6645432043914194`*^9, 3.6645432567579927`*^9}, {3.664543366644001*^9, 
   3.6645433909167085`*^9}, {3.664543451292409*^9, 3.6645434743723803`*^9}, 
   3.664543940887757*^9, {3.6645444424638166`*^9, 3.6645444728715076`*^9}, 
   3.6645445161242332`*^9}],

Cell[BoxData["\<\"-----------------------------------------\"\>"], "Print",
 CellChangeTimes->{{3.6645425915426016`*^9, 3.6645426562812386`*^9}, {
   3.6645427478209243`*^9, 3.6645427702546463`*^9}, 3.664542802185042*^9, 
   3.664542871479051*^9, 3.6645429074981937`*^9, {3.6645429787149553`*^9, 
   3.664543012453538*^9}, 3.6645430908994308`*^9, 3.664543167661518*^9, {
   3.6645432043914194`*^9, 3.6645432567579927`*^9}, {3.664543366644001*^9, 
   3.6645433909167085`*^9}, {3.664543451292409*^9, 3.6645434743723803`*^9}, 
   3.664543940887757*^9, {3.6645444424638166`*^9, 3.6645444728715076`*^9}, 
   3.664544516128236*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Looking at bft number \"\>", "\[InvisibleSpace]", "8"}],
  SequenceForm["Looking at bft number ", 8],
  Editable->False]], "Print",
 CellChangeTimes->{{3.6645425915426016`*^9, 3.6645426562812386`*^9}, {
   3.6645427478209243`*^9, 3.6645427702546463`*^9}, 3.664542802185042*^9, 
   3.664542871479051*^9, 3.6645429074981937`*^9, {3.6645429787149553`*^9, 
   3.664543012453538*^9}, 3.6645430908994308`*^9, 3.664543167661518*^9, {
   3.6645432043914194`*^9, 3.6645432567579927`*^9}, {3.664543366644001*^9, 
   3.6645433909167085`*^9}, {3.664543451292409*^9, 3.6645434743723803`*^9}, 
   3.664543940887757*^9, {3.6645444424638166`*^9, 3.6645444728715076`*^9}, 
   3.6645445161322393`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"We have \"\>", "\[InvisibleSpace]", "5", 
   "\[InvisibleSpace]", "\<\" perfect matchings to go through.\"\>"}],
  SequenceForm["We have ", 5, " perfect matchings to go through."],
  Editable->False]], "Print",
 CellChangeTimes->{{3.6645425915426016`*^9, 3.6645426562812386`*^9}, {
   3.6645427478209243`*^9, 3.6645427702546463`*^9}, 3.664542802185042*^9, 
   3.664542871479051*^9, 3.6645429074981937`*^9, {3.6645429787149553`*^9, 
   3.664543012453538*^9}, 3.6645430908994308`*^9, 3.664543167661518*^9, {
   3.6645432043914194`*^9, 3.6645432567579927`*^9}, {3.664543366644001*^9, 
   3.6645433909167085`*^9}, {3.664543451292409*^9, 3.6645434743723803`*^9}, 
   3.664543940887757*^9, {3.6645444424638166`*^9, 3.6645444728715076`*^9}, 
   3.6645445161372423`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"SOME PERFECT MATCHINGS DON'T HAVE THE SOURCE SET DICTATED BY \
THE PLUCKER COORDINATE IN WHICH THEY'RE IN! Perfect matching \"\>", 
   "\[InvisibleSpace]", "1"}],
  SequenceForm[
  "SOME PERFECT MATCHINGS DON'T HAVE THE SOURCE SET DICTATED BY THE PLUCKER \
COORDINATE IN WHICH THEY'RE IN! Perfect matching ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{{3.6645425915426016`*^9, 3.6645426562812386`*^9}, {
   3.6645427478209243`*^9, 3.6645427702546463`*^9}, 3.664542802185042*^9, 
   3.664542871479051*^9, 3.6645429074981937`*^9, {3.6645429787149553`*^9, 
   3.664543012453538*^9}, 3.6645430908994308`*^9, 3.664543167661518*^9, {
   3.6645432043914194`*^9, 3.6645432567579927`*^9}, {3.664543366644001*^9, 
   3.6645433909167085`*^9}, {3.664543451292409*^9, 3.6645434743723803`*^9}, 
   3.664543940887757*^9, {3.6645444424638166`*^9, 3.6645444728715076`*^9}, 
   3.664544516314245*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"SOME PERFECT MATCHINGS DON'T HAVE THE SOURCE SET DICTATED BY \
THE PLUCKER COORDINATE IN WHICH THEY'RE IN! Perfect matching \"\>", 
   "\[InvisibleSpace]", "2"}],
  SequenceForm[
  "SOME PERFECT MATCHINGS DON'T HAVE THE SOURCE SET DICTATED BY THE PLUCKER \
COORDINATE IN WHICH THEY'RE IN! Perfect matching ", 2],
  Editable->False]], "Print",
 CellChangeTimes->{{3.6645425915426016`*^9, 3.6645426562812386`*^9}, {
   3.6645427478209243`*^9, 3.6645427702546463`*^9}, 3.664542802185042*^9, 
   3.664542871479051*^9, 3.6645429074981937`*^9, {3.6645429787149553`*^9, 
   3.664543012453538*^9}, 3.6645430908994308`*^9, 3.664543167661518*^9, {
   3.6645432043914194`*^9, 3.6645432567579927`*^9}, {3.664543366644001*^9, 
   3.6645433909167085`*^9}, {3.664543451292409*^9, 3.6645434743723803`*^9}, 
   3.664543940887757*^9, {3.6645444424638166`*^9, 3.6645444728715076`*^9}, 
   3.6645445164883614`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"SOME PERFECT MATCHINGS DON'T HAVE THE SOURCE SET DICTATED BY \
THE PLUCKER COORDINATE IN WHICH THEY'RE IN! Perfect matching \"\>", 
   "\[InvisibleSpace]", "3"}],
  SequenceForm[
  "SOME PERFECT MATCHINGS DON'T HAVE THE SOURCE SET DICTATED BY THE PLUCKER \
COORDINATE IN WHICH THEY'RE IN! Perfect matching ", 3],
  Editable->False]], "Print",
 CellChangeTimes->{{3.6645425915426016`*^9, 3.6645426562812386`*^9}, {
   3.6645427478209243`*^9, 3.6645427702546463`*^9}, 3.664542802185042*^9, 
   3.664542871479051*^9, 3.6645429074981937`*^9, {3.6645429787149553`*^9, 
   3.664543012453538*^9}, 3.6645430908994308`*^9, 3.664543167661518*^9, {
   3.6645432043914194`*^9, 3.6645432567579927`*^9}, {3.664543366644001*^9, 
   3.6645433909167085`*^9}, {3.664543451292409*^9, 3.6645434743723803`*^9}, 
   3.664543940887757*^9, {3.6645444424638166`*^9, 3.6645444728715076`*^9}, 
   3.664544516684492*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"SOME PERFECT MATCHINGS DON'T HAVE THE SOURCE SET DICTATED BY \
THE PLUCKER COORDINATE IN WHICH THEY'RE IN! Perfect matching \"\>", 
   "\[InvisibleSpace]", "4"}],
  SequenceForm[
  "SOME PERFECT MATCHINGS DON'T HAVE THE SOURCE SET DICTATED BY THE PLUCKER \
COORDINATE IN WHICH THEY'RE IN! Perfect matching ", 4],
  Editable->False]], "Print",
 CellChangeTimes->{{3.6645425915426016`*^9, 3.6645426562812386`*^9}, {
   3.6645427478209243`*^9, 3.6645427702546463`*^9}, 3.664542802185042*^9, 
   3.664542871479051*^9, 3.6645429074981937`*^9, {3.6645429787149553`*^9, 
   3.664543012453538*^9}, 3.6645430908994308`*^9, 3.664543167661518*^9, {
   3.6645432043914194`*^9, 3.6645432567579927`*^9}, {3.664543366644001*^9, 
   3.6645433909167085`*^9}, {3.664543451292409*^9, 3.6645434743723803`*^9}, 
   3.664543940887757*^9, {3.6645444424638166`*^9, 3.6645444728715076`*^9}, 
   3.664544516730522*^9}],

Cell[BoxData["\<\"DONE\"\>"], "Print",
 CellChangeTimes->{{3.6645425915426016`*^9, 3.6645426562812386`*^9}, {
   3.6645427478209243`*^9, 3.6645427702546463`*^9}, 3.664542802185042*^9, 
   3.664542871479051*^9, 3.6645429074981937`*^9, {3.6645429787149553`*^9, 
   3.664543012453538*^9}, 3.6645430908994308`*^9, 3.664543167661518*^9, {
   3.6645432043914194`*^9, 3.6645432567579927`*^9}, {3.664543366644001*^9, 
   3.6645433909167085`*^9}, {3.664543451292409*^9, 3.6645434743723803`*^9}, 
   3.664543940887757*^9, {3.6645444424638166`*^9, 3.6645444728715076`*^9}, 
   3.6645445167385283`*^9}],

Cell[BoxData["\<\"-----------------------------------------\"\>"], "Print",
 CellChangeTimes->{{3.6645425915426016`*^9, 3.6645426562812386`*^9}, {
   3.6645427478209243`*^9, 3.6645427702546463`*^9}, 3.664542802185042*^9, 
   3.664542871479051*^9, 3.6645429074981937`*^9, {3.6645429787149553`*^9, 
   3.664543012453538*^9}, 3.6645430908994308`*^9, 3.664543167661518*^9, {
   3.6645432043914194`*^9, 3.6645432567579927`*^9}, {3.664543366644001*^9, 
   3.6645433909167085`*^9}, {3.664543451292409*^9, 3.6645434743723803`*^9}, 
   3.664543940887757*^9, {3.6645444424638166`*^9, 3.6645444728715076`*^9}, 
   3.664544516742531*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Looking at bft number \"\>", "\[InvisibleSpace]", "9"}],
  SequenceForm["Looking at bft number ", 9],
  Editable->False]], "Print",
 CellChangeTimes->{{3.6645425915426016`*^9, 3.6645426562812386`*^9}, {
   3.6645427478209243`*^9, 3.6645427702546463`*^9}, 3.664542802185042*^9, 
   3.664542871479051*^9, 3.6645429074981937`*^9, {3.6645429787149553`*^9, 
   3.664543012453538*^9}, 3.6645430908994308`*^9, 3.664543167661518*^9, {
   3.6645432043914194`*^9, 3.6645432567579927`*^9}, {3.664543366644001*^9, 
   3.6645433909167085`*^9}, {3.664543451292409*^9, 3.6645434743723803`*^9}, 
   3.664543940887757*^9, {3.6645444424638166`*^9, 3.6645444728715076`*^9}, 
   3.664544516747534*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"We have \"\>", "\[InvisibleSpace]", "25", 
   "\[InvisibleSpace]", "\<\" perfect matchings to go through.\"\>"}],
  SequenceForm["We have ", 25, " perfect matchings to go through."],
  Editable->False]], "Print",
 CellChangeTimes->{{3.6645425915426016`*^9, 3.6645426562812386`*^9}, {
   3.6645427478209243`*^9, 3.6645427702546463`*^9}, 3.664542802185042*^9, 
   3.664542871479051*^9, 3.6645429074981937`*^9, {3.6645429787149553`*^9, 
   3.664543012453538*^9}, 3.6645430908994308`*^9, 3.664543167661518*^9, {
   3.6645432043914194`*^9, 3.6645432567579927`*^9}, {3.664543366644001*^9, 
   3.6645433909167085`*^9}, {3.664543451292409*^9, 3.6645434743723803`*^9}, 
   3.664543940887757*^9, {3.6645444424638166`*^9, 3.6645444728715076`*^9}, 
   3.6645445167515373`*^9}],

Cell[BoxData["\<\"DONE\"\>"], "Print",
 CellChangeTimes->{{3.6645425915426016`*^9, 3.6645426562812386`*^9}, {
   3.6645427478209243`*^9, 3.6645427702546463`*^9}, 3.664542802185042*^9, 
   3.664542871479051*^9, 3.6645429074981937`*^9, {3.6645429787149553`*^9, 
   3.664543012453538*^9}, 3.6645430908994308`*^9, 3.664543167661518*^9, {
   3.6645432043914194`*^9, 3.6645432567579927`*^9}, {3.664543366644001*^9, 
   3.6645433909167085`*^9}, {3.664543451292409*^9, 3.6645434743723803`*^9}, 
   3.664543940887757*^9, {3.6645444424638166`*^9, 3.6645444728715076`*^9}, 
   3.664544529795608*^9}],

Cell[BoxData["\<\"-----------------------------------------\"\>"], "Print",
 CellChangeTimes->{{3.6645425915426016`*^9, 3.6645426562812386`*^9}, {
   3.6645427478209243`*^9, 3.6645427702546463`*^9}, 3.664542802185042*^9, 
   3.664542871479051*^9, 3.6645429074981937`*^9, {3.6645429787149553`*^9, 
   3.664543012453538*^9}, 3.6645430908994308`*^9, 3.664543167661518*^9, {
   3.6645432043914194`*^9, 3.6645432567579927`*^9}, {3.664543366644001*^9, 
   3.6645433909167085`*^9}, {3.664543451292409*^9, 3.6645434743723803`*^9}, 
   3.664543940887757*^9, {3.6645444424638166`*^9, 3.6645444728715076`*^9}, 
   3.6645445298036118`*^9}]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"pluckerCoordinates", "[", 
    RowBox[{
    "topleft_", ",", "topright_", ",", "bottomleft_", ",", "bottomright_", 
     ",", 
     RowBox[{"referencematching_:", "Null"}], ",", 
     RowBox[{"withsigns_:", "False"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "referenceperfmatch", ",", "Cmatrix", ",", "minors", ",", 
       "externalvarentries", ",", "sources", ",", "sinks", ",", 
       "putsourcesinlist", ",", "externalordering", ",", "pathmat"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"referencematching", "===", "Null"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"referenceperfmatch", "=", 
          RowBox[{
           RowBox[{"perfectMatchings", "[", 
            RowBox[{
            "topleft", ",", "topright", ",", "bottomleft", ",", 
             "bottomright"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"lowNumberLoopsPM", "[", 
             RowBox[{
             "topleft", ",", "topright", ",", "bottomleft", ",", 
              "bottomright"}], "]"}], "]"}], "]"}]}], ";"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{
         RowBox[{"referenceperfmatch", "=", "referencematching"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"withsigns", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Cmatrix", "=", 
          RowBox[{"getGrassmannian", "[", 
           RowBox[{
           "topleft", ",", "topright", ",", "bottomleft", ",", "bottomright", 
            ",", "referencematching"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"minors", "=", 
          RowBox[{"Expand", "[", 
           RowBox[{"Simplify", "[", 
            RowBox[{
             RowBox[{"Minors", "[", 
              RowBox[{"Cmatrix", ",", 
               RowBox[{"Length", "[", "Cmatrix", "]"}]}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Now", " ", 
           RowBox[{"let", "'"}], "s", " ", "find", " ", "the", " ", 
           "ordering", " ", "of", " ", "external", " ", "edges"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"externalvarentries", "=", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Intersection", "[", 
              RowBox[{
               RowBox[{"Variables", "[", "#", "]"}], ",", 
               RowBox[{"Variables", "[", 
                RowBox[{"Join", "[", 
                 RowBox[{"bottomleft", ",", "topright"}], "]"}], "]"}]}], 
              "]"}], "&"}], ",", "Cmatrix", ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"sources", "=", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Intersection", "@@", 
              RowBox[{"DeleteCases", "[", 
               RowBox[{"#", ",", 
                RowBox[{"{", "}"}]}], "]"}]}], "&"}], ",", 
            "externalvarentries"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"sinks", "=", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Intersection", "@@", "#"}], "&"}], ",", 
            RowBox[{"Transpose", "[", "externalvarentries", "]"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"putsourcesinlist", "=", 
          RowBox[{"Function", "[", 
           RowBox[{
            RowBox[{"{", "input", "}"}], ",", 
            RowBox[{"Block", "[", 
             RowBox[{
              RowBox[{"{", "return", "}"}], ",", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"input", "===", 
                  RowBox[{"{", "}"}]}], ",", 
                 RowBox[{
                  RowBox[{"return", "=", 
                   RowBox[{"sources", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ";", 
                  RowBox[{"sources", "=", 
                   RowBox[{"Delete", "[", 
                    RowBox[{"sources", ",", "1"}], "]"}]}], ";"}], ",", 
                 RowBox[{
                  RowBox[{"return", "=", "input"}], ";"}]}], "]"}], ";", 
               "return"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"externalordering", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"putsourcesinlist", "[", "#", "]"}], "&"}], ",", 
             "sinks"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
        RowBox[{
         RowBox[{"pathmat", "=", 
          RowBox[{"pathMatrix", "[", 
           RowBox[{
           "topleft", ",", "topright", ",", "bottomleft", ",", "bottomright", 
            ",", "referenceperfmatch"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"minors", "=", 
          RowBox[{"Expand", "[", 
           RowBox[{"Simplify", "[", 
            RowBox[{
             RowBox[{"Minors", "[", 
              RowBox[{"pathmat", ",", 
               RowBox[{"Length", "[", "pathmat", "]"}]}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"externalordering", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{
             RowBox[{"Join", "[", 
              RowBox[{"bottomleft", ",", 
               RowBox[{"Transpose", "[", "topright", "]"}]}], "]"}], ",", "0",
              ",", 
             RowBox[{"{", "2", "}"}]}], "]"}], "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"externalordering", ",", "minors"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6645179497216415`*^9, 3.664517983745689*^9}, {
  3.6645182774612465`*^9, 3.6645182883862343`*^9}, {3.6645183418361444`*^9, 
  3.6645183429455633`*^9}, {3.6645194181533413`*^9, 3.664519469394976*^9}, {
  3.6645195194138308`*^9, 3.664519651162485*^9}, {3.664520192015279*^9, 
  3.664520372928857*^9}, {3.6645208904666815`*^9, 3.664520916134387*^9}, {
  3.6645210980288324`*^9, 3.664521101438094*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"pluckerCoordinates", "[", 
    RowBox[{
    "topleft", ",", "topright", ",", "bottomleft", ",", "bottomright", ",", 
     "Null", ",", "True"}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}], "[", 
  RowBox[{"[", 
   RowBox[{
    RowBox[{"Subsets", "[", 
     RowBox[{
      RowBox[{"Range", "[", 
       RowBox[{
        RowBox[{"Dimensions", "[", 
         RowBox[{"pathMatrix", "[", 
          RowBox[{
          "topleft", ",", "topright", ",", "bottomleft", ",", "bottomright", 
           ",", 
           RowBox[{
            RowBox[{"perfectMatchings", "[", 
             RowBox[{
             "topleft", ",", "topright", ",", "bottomleft", ",", 
              "bottomright"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"lowNumberLoopsPM", "[", 
              RowBox[{
              "topleft", ",", "topright", ",", "bottomleft", ",", 
               "bottomright"}], "]"}], "]"}], "]"}]}], "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"Length", "[", 
        RowBox[{"pathMatrix", "[", 
         RowBox[{
         "topleft", ",", "topright", ",", "bottomleft", ",", "bottomright", 
          ",", 
          RowBox[{
           RowBox[{"perfectMatchings", "[", 
            RowBox[{
            "topleft", ",", "topright", ",", "bottomleft", ",", 
             "bottomright"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"lowNumberLoopsPM", "[", 
             RowBox[{
             "topleft", ",", "topright", ",", "bottomleft", ",", 
              "bottomright"}], "]"}], "]"}], "]"}]}], "]"}], "]"}], "}"}]}], 
     "]"}], "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"pluckerCoordinates", "[", 
            RowBox[{
            "topleft", ",", "topright", ",", "bottomleft", ",", "bottomright",
              ",", "Null", ",", "True"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", "1"}], "]"}], ",", 
        RowBox[{"zz_", "/;", 
         RowBox[{
          RowBox[{"Length", "[", "zz", "]"}], "\[Equal]", "1"}]}]}], "]"}], 
      "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "]"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"findSources", "[", 
  RowBox[{"topright", ",", "bottomleft", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"perfectMatchings", "[", 
     RowBox[{
     "topleft", ",", "topright", ",", "bottomleft", ",", "bottomright"}], 
     "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"lowNumberLoopsPM", "[", 
      RowBox[{
      "topleft", ",", "topright", ",", "bottomleft", ",", "bottomright"}], 
      "]"}], "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pluckerCoordinates", "[", 
   RowBox[{
   "topleft", ",", "topright", ",", "bottomleft", ",", "bottomright"}], "]"}],
   "[", 
  RowBox[{"[", "2", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.6645209362439566`*^9, 3.664520948191135*^9}, {
  3.6645211290257807`*^9, 3.664521251002838*^9}, {3.6645213820130124`*^9, 
  3.6645214027251215`*^9}, {3.6645214759186172`*^9, 3.664521480248254*^9}, {
  3.6645215196063395`*^9, 3.664521619446661*^9}, {3.6645217306029243`*^9, 
  3.6645217567185326`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"X", "[", 
    RowBox[{"13", ",", "12"}], "]"}], ",", 
   RowBox[{"X", "[", 
    RowBox[{"11", ",", "12"}], "]"}], ",", 
   RowBox[{"X", "[", 
    RowBox[{"10", ",", "11"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.664520949450572*^9, 3.664521079385209*^9, {3.6645211195971246`*^9, 
   3.6645211656660967`*^9}, {3.6645211972409286`*^9, 3.664521279681505*^9}, {
   3.664521403787674*^9, 3.6645215711492896`*^9}, {3.664521602880198*^9, 
   3.6645216215650215`*^9}, {3.66452173267423*^9, 3.6645217585076036`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"X", "[", 
    RowBox[{"10", ",", "11"}], "]"}], ",", 
   RowBox[{"X", "[", 
    RowBox[{"11", ",", "12"}], "]"}], ",", 
   RowBox[{"X", "[", 
    RowBox[{"13", ",", "12"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.664520949450572*^9, 3.664521079385209*^9, {3.6645211195971246`*^9, 
   3.6645211656660967`*^9}, {3.6645211972409286`*^9, 3.664521279681505*^9}, {
   3.664521403787674*^9, 3.6645215711492896`*^9}, {3.664521602880198*^9, 
   3.6645216215650215`*^9}, {3.66452173267423*^9, 3.664521758554485*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"1", ",", "7"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "2"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "11"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "10"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"6", ",", "9"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "11"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "12"}], "]"}]}]], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"1", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"1", ",", "7"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "10"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"6", ",", "9"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"12", ",", "4"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "11"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "12"}], "]"}]}]], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"1", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"1", ",", "7"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"3", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"12", ",", "4"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "11"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "12"}], "]"}]}]], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"1", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"1", ",", "7"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"6", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"6", ",", "9"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"12", ",", "4"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "11"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "12"}], "]"}]}]], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "10"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"6", ",", "9"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"12", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "1"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "11"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "12"}], "]"}]}]], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"3", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"12", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "1"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "11"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "12"}], "]"}]}]], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"3", ",", "2"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"3", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "2"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"12", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "1"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "11"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "12"}], "]"}]}]], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "2"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"8", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"12", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "1"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "11"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "12"}], "]"}]}]], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"6", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"6", ",", "9"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"12", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "1"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "11"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "12"}], "]"}]}]], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"3", ",", "2"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "2"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"6", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"6", ",", "9"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"12", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "1"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "11"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "12"}], "]"}]}]]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       RowBox[{"X", "[", 
        RowBox[{"1", ",", "4"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"1", ",", "7"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"5", ",", "10"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"6", ",", "9"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"13", ",", "12"}], "]"}]}], 
      RowBox[{
       RowBox[{"X", "[", 
        RowBox[{"2", ",", "1"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"4", ",", "13"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"7", ",", "13"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"9", ",", "8"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"10", ",", "6"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"10", ",", "11"}], "]"}]}]]}], "-", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"1", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"1", ",", "7"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"3", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "12"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "11"}], "]"}]}]], "-", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"1", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"1", ",", "7"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"6", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"6", ",", "9"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "12"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "11"}], "]"}]}]], "-", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "10"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"6", ",", "9"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "12"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "11"}], "]"}]}]], "-", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"3", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "12"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "11"}], "]"}]}]], "-", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"3", ",", "2"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"3", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "2"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "12"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "11"}], "]"}]}]], "-", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "2"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"8", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "12"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "11"}], "]"}]}]], "-", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"6", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"6", ",", "9"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "12"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "11"}], "]"}]}]], "-", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"3", ",", "2"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "2"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"6", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"6", ",", "9"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "12"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "11"}], "]"}]}]]}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"1", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"1", ",", "7"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"3", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "11"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "12"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "12"}], "]"}]}]], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"1", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"1", ",", "7"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "11"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"6", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"6", ",", "9"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "12"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "12"}], "]"}]}]], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"3", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "11"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "12"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "12"}], "]"}]}]], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"3", ",", "2"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"3", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "2"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "11"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "12"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "12"}], "]"}]}]], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "2"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "11"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"8", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "12"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "12"}], "]"}]}]], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "11"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"6", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"6", ",", "9"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "12"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "12"}], "]"}]}]], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"3", ",", "2"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "2"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "11"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"6", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"6", ",", "9"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "12"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "12"}], "]"}]}]]}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"1", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"1", ",", "7"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"3", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "11"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "10"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "10"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "12"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "11"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "12"}], "]"}]}]], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"3", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "11"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "10"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "10"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "12"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "11"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "12"}], "]"}]}]], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"3", ",", "2"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"3", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "2"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "11"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "10"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "10"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "12"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "11"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "12"}], "]"}]}]], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "2"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "11"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "10"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"8", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "10"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "12"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "11"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "12"}], "]"}]}]]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "2"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "11"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "10"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"6", ",", "9"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "12"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "11"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "12"}], "]"}]}]]}], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"X", "[", 
      RowBox[{"1", ",", "7"}], "]"}], " ", 
     RowBox[{"X", "[", 
      RowBox[{"4", ",", "2"}], "]"}], " ", 
     RowBox[{"X", "[", 
      RowBox[{"11", ",", "5"}], "]"}]}], 
    RowBox[{
     RowBox[{"X", "[", 
      RowBox[{"2", ",", "1"}], "]"}], " ", 
     RowBox[{"X", "[", 
      RowBox[{"5", ",", "4"}], "]"}], " ", 
     RowBox[{"X", "[", 
      RowBox[{"7", ",", "13"}], "]"}], " ", 
     RowBox[{"X", "[", 
      RowBox[{"10", ",", "11"}], "]"}]}]], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       RowBox[{"X", "[", 
        RowBox[{"1", ",", "7"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"4", ",", "2"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"4", ",", "11"}], "]"}]}], 
      RowBox[{
       RowBox[{"X", "[", 
        RowBox[{"2", ",", "1"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"5", ",", "4"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"7", ",", "13"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"11", ",", "12"}], "]"}]}]]}], "-", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"1", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"1", ",", "7"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"12", ",", "4"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "12"}], "]"}]}]], "-", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"12", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "1"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "12"}], "]"}]}]]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       RowBox[{"X", "[", 
        RowBox[{"1", ",", "7"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"4", ",", "2"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"4", ",", "11"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"5", ",", "10"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"9", ",", "10"}], "]"}]}], 
      RowBox[{
       RowBox[{"X", "[", 
        RowBox[{"2", ",", "1"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"5", ",", "4"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"7", ",", "13"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"10", ",", "6"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"10", ",", "11"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"11", ",", "12"}], "]"}]}]]}], "-", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"1", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"1", ",", "7"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "10"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "10"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"12", ",", "4"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "11"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "12"}], "]"}]}]], "-", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"1", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"1", ",", "7"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"6", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "10"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"12", ",", "4"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "11"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "12"}], "]"}]}]], "-", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "10"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "10"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"12", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "1"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "11"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "12"}], "]"}]}]], "-", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"6", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "10"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"12", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "1"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "11"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "12"}], "]"}]}]], "-", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"3", ",", "2"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "2"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"6", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "10"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"12", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "1"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "11"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "12"}], "]"}]}]]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "2"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"12", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "1"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "11"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "12"}], "]"}]}]]}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"1", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"1", ",", "7"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "12"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "13"}], "]"}]}]], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "12"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "13"}], "]"}]}]]}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"1", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"1", ",", "7"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "10"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "10"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "12"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "11"}], "]"}]}]], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"1", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"1", ",", "7"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"6", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "10"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "12"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "11"}], "]"}]}]], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "10"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "10"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "12"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "11"}], "]"}]}]], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"6", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "10"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "12"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "11"}], "]"}]}]], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"3", ",", "2"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "2"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"6", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "10"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "12"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "11"}], "]"}]}]]}], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"X", "[", 
      RowBox[{"4", ",", "2"}], "]"}], " ", 
     RowBox[{"X", "[", 
      RowBox[{"7", ",", "8"}], "]"}], " ", 
     RowBox[{"X", "[", 
      RowBox[{"11", ",", "5"}], "]"}], " ", 
     RowBox[{"X", "[", 
      RowBox[{"13", ",", "1"}], "]"}], " ", 
     RowBox[{"X", "[", 
      RowBox[{"13", ",", "12"}], "]"}]}], 
    RowBox[{
     RowBox[{"X", "[", 
      RowBox[{"2", ",", "1"}], "]"}], " ", 
     RowBox[{"X", "[", 
      RowBox[{"4", ",", "13"}], "]"}], " ", 
     RowBox[{"X", "[", 
      RowBox[{"5", ",", "4"}], "]"}], " ", 
     RowBox[{"X", "[", 
      RowBox[{"7", ",", "13"}], "]"}], " ", 
     RowBox[{"X", "[", 
      RowBox[{"10", ",", "11"}], "]"}]}]], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       RowBox[{"X", "[", 
        RowBox[{"1", ",", "4"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"1", ",", "7"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"2", ",", "5"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"4", ",", "11"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"6", ",", "5"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"9", ",", "10"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"13", ",", "12"}], "]"}]}], 
      RowBox[{
       RowBox[{"X", "[", 
        RowBox[{"2", ",", "1"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"4", ",", "13"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"5", ",", "3"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"5", ",", "4"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"7", ",", "13"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"10", ",", "6"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"11", ",", "12"}], "]"}]}]]}], "-", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "11"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"6", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "10"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "12"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "12"}], "]"}]}]], "-", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"3", ",", "2"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "2"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "11"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"6", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "10"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "12"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "12"}], "]"}]}]]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "2"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "11"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "12"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "12"}], "]"}]}]]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "2"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "11"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "10"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "10"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "12"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "11"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "12"}], "]"}]}]]}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "10"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"6", ",", "9"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "11"}], "]"}]}]], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"3", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "5"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "11"}], "]"}]}]], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"3", ",", "2"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"3", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "2"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "5"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "11"}], "]"}]}]], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "2"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"8", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "5"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "11"}], "]"}]}]], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"6", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"6", ",", "9"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "5"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "11"}], "]"}]}]], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"3", ",", "2"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "2"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"6", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"6", ",", "9"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "5"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "11"}], "]"}]}]]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       RowBox[{"X", "[", 
        RowBox[{"2", ",", "5"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"3", ",", "6"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"4", ",", "11"}], "]"}]}], 
      RowBox[{
       RowBox[{"X", "[", 
        RowBox[{"5", ",", "3"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"5", ",", "4"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"9", ",", "8"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"11", ",", "12"}], "]"}]}]]}], "-", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"3", ",", "2"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"3", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "2"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "11"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "12"}], "]"}]}]], "-", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "2"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "11"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"8", ",", "3"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "12"}], "]"}]}]], "-", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "11"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"6", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"6", ",", "9"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "12"}], "]"}]}]], "-", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"3", ",", "2"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "2"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "11"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"6", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"6", ",", "9"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "12"}], "]"}]}]], "-", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"1", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"3", ",", "2"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"3", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"12", ",", "4"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "12"}], "]"}]}]], "-", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"1", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"8", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"12", ",", "4"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "12"}], "]"}]}]], "-", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"1", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"3", ",", "2"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"6", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"6", ",", "9"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"12", ",", "4"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "12"}], "]"}]}]]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       RowBox[{"X", "[", 
        RowBox[{"2", ",", "5"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"3", ",", "6"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"4", ",", "11"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"5", ",", "10"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"9", ",", "10"}], "]"}]}], 
      RowBox[{
       RowBox[{"X", "[", 
        RowBox[{"5", ",", "3"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"5", ",", "4"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"9", ",", "8"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"10", ",", "6"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"10", ",", "11"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"11", ",", "12"}], "]"}]}]]}], "-", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"3", ",", "2"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"3", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "2"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "11"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "10"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "10"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "11"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "12"}], "]"}]}]], "-", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "2"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "11"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "10"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"8", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "10"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "11"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "12"}], "]"}]}]], "-", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"1", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"3", ",", "2"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"3", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "10"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "10"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"12", ",", "4"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "11"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "12"}], "]"}]}]], "-", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"1", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "10"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"8", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "10"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"12", ",", "4"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "11"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "12"}], "]"}]}]], "-", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"1", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"6", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"8", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "10"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"12", ",", "4"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "11"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "12"}], "]"}]}]]}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "2"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "11"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "10"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"6", ",", "9"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "8"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "11"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "12"}], "]"}]}]], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"1", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "10"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"6", ",", "9"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"12", ",", "4"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "11"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "12"}], "]"}]}]], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"1", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"3", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"12", ",", "4"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "11"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "12"}], "]"}]}]], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"1", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"6", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"6", ",", "9"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"12", ",", "4"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "11"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "12"}], "]"}]}]]}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"1", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"3", ",", "2"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"3", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "12"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "8"}], "]"}]}]], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"1", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"8", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "12"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "8"}], "]"}]}]], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"1", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"3", ",", "2"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"6", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"6", ",", "9"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "12"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "6"}], "]"}]}]]}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"1", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"3", ",", "2"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"3", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "10"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "10"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "12"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "11"}], "]"}]}]], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"1", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "10"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"8", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "10"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "12"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "11"}], "]"}]}]], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"1", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"6", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"8", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "10"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "12"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "11"}], "]"}]}]]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       RowBox[{"X", "[", 
        RowBox[{"1", ",", "4"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"5", ",", "10"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"6", ",", "9"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"7", ",", "8"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"13", ",", "12"}], "]"}]}], 
      RowBox[{
       RowBox[{"X", "[", 
        RowBox[{"2", ",", "1"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"4", ",", "13"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"9", ",", "8"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"10", ",", "6"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"10", ",", "11"}], "]"}]}]]}], "-", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"1", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"3", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "12"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "11"}], "]"}]}]], "-", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"1", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"6", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"6", ",", "9"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "12"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "11"}], "]"}]}]]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"1", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "11"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"6", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"8", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "10"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "12"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "12"}], "]"}]}]]}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"1", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"3", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "11"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "12"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "12"}], "]"}]}]], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"1", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "11"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"6", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"6", ",", "9"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "12"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "12"}], "]"}]}]]}], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"X", "[", 
      RowBox[{"1", ",", "4"}], "]"}], " ", 
     RowBox[{"X", "[", 
      RowBox[{"2", ",", "5"}], "]"}], " ", 
     RowBox[{"X", "[", 
      RowBox[{"3", ",", "6"}], "]"}], " ", 
     RowBox[{"X", "[", 
      RowBox[{"4", ",", "11"}], "]"}], " ", 
     RowBox[{"X", "[", 
      RowBox[{"5", ",", "10"}], "]"}], " ", 
     RowBox[{"X", "[", 
      RowBox[{"7", ",", "8"}], "]"}], " ", 
     RowBox[{"X", "[", 
      RowBox[{"9", ",", "10"}], "]"}], " ", 
     RowBox[{"X", "[", 
      RowBox[{"13", ",", "12"}], "]"}]}], 
    RowBox[{
     RowBox[{"X", "[", 
      RowBox[{"2", ",", "1"}], "]"}], " ", 
     RowBox[{"X", "[", 
      RowBox[{"4", ",", "13"}], "]"}], " ", 
     RowBox[{"X", "[", 
      RowBox[{"5", ",", "3"}], "]"}], " ", 
     RowBox[{"X", "[", 
      RowBox[{"5", ",", "4"}], "]"}], " ", 
     RowBox[{"X", "[", 
      RowBox[{"9", ",", "8"}], "]"}], " ", 
     RowBox[{"X", "[", 
      RowBox[{"10", ",", "6"}], "]"}], " ", 
     RowBox[{"X", "[", 
      RowBox[{"10", ",", "11"}], "]"}], " ", 
     RowBox[{"X", "[", 
      RowBox[{"11", ",", "12"}], "]"}]}]], ",", "1", ",", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "10"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "10"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "11"}], "]"}]}]], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"6", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "10"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "5"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "11"}], "]"}]}]], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"3", ",", "2"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "2"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"6", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "10"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "5"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "11"}], "]"}]}]]}], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"X", "[", 
      RowBox[{"4", ",", "2"}], "]"}], " ", 
     RowBox[{"X", "[", 
      RowBox[{"7", ",", "8"}], "]"}], " ", 
     RowBox[{"X", "[", 
      RowBox[{"11", ",", "5"}], "]"}]}], 
    RowBox[{
     RowBox[{"X", "[", 
      RowBox[{"2", ",", "1"}], "]"}], " ", 
     RowBox[{"X", "[", 
      RowBox[{"5", ",", "4"}], "]"}], " ", 
     RowBox[{"X", "[", 
      RowBox[{"10", ",", "11"}], "]"}]}]], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       RowBox[{"X", "[", 
        RowBox[{"2", ",", "5"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"4", ",", "11"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"6", ",", "5"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"9", ",", "10"}], "]"}]}], 
      RowBox[{
       RowBox[{"X", "[", 
        RowBox[{"5", ",", "3"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"5", ",", "4"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"10", ",", "6"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"11", ",", "12"}], "]"}]}]]}], "-", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"3", ",", "2"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "2"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "11"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"6", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "10"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "12"}], "]"}]}]], "-", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"1", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"3", ",", "2"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"6", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "10"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"12", ",", "4"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "12"}], "]"}]}]]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       RowBox[{"X", "[", 
        RowBox[{"4", ",", "2"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"4", ",", "11"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"7", ",", "8"}], "]"}]}], 
      RowBox[{
       RowBox[{"X", "[", 
        RowBox[{"2", ",", "1"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"5", ",", "4"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"11", ",", "12"}], "]"}]}]]}], "-", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"1", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"12", ",", "4"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "12"}], "]"}]}]]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       RowBox[{"X", "[", 
        RowBox[{"4", ",", "2"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"4", ",", "11"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"5", ",", "10"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"7", ",", "8"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"9", ",", "10"}], "]"}]}], 
      RowBox[{
       RowBox[{"X", "[", 
        RowBox[{"2", ",", "1"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"5", ",", "4"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"10", ",", "6"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"10", ",", "11"}], "]"}], " ", 
       RowBox[{"X", "[", 
        RowBox[{"11", ",", "12"}], "]"}]}]]}], "-", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"1", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "10"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "10"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"12", ",", "4"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "11"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "12"}], "]"}]}]], "-", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"1", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"6", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "10"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"12", ",", "4"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "11"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "12"}], "]"}]}]]}], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"X", "[", 
      RowBox[{"1", ",", "4"}], "]"}], " ", 
     RowBox[{"X", "[", 
      RowBox[{"3", ",", "2"}], "]"}], " ", 
     RowBox[{"X", "[", 
      RowBox[{"6", ",", "5"}], "]"}], " ", 
     RowBox[{"X", "[", 
      RowBox[{"9", ",", "10"}], "]"}], " ", 
     RowBox[{"X", "[", 
      RowBox[{"13", ",", "12"}], "]"}]}], 
    RowBox[{
     RowBox[{"X", "[", 
      RowBox[{"2", ",", "1"}], "]"}], " ", 
     RowBox[{"X", "[", 
      RowBox[{"4", ",", "13"}], "]"}], " ", 
     RowBox[{"X", "[", 
      RowBox[{"5", ",", "3"}], "]"}], " ", 
     RowBox[{"X", "[", 
      RowBox[{"10", ",", "6"}], "]"}]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"X", "[", 
      RowBox[{"1", ",", "4"}], "]"}], " ", 
     RowBox[{"X", "[", 
      RowBox[{"7", ",", "8"}], "]"}], " ", 
     RowBox[{"X", "[", 
      RowBox[{"13", ",", "12"}], "]"}]}], 
    RowBox[{
     RowBox[{"X", "[", 
      RowBox[{"2", ",", "1"}], "]"}], " ", 
     RowBox[{"X", "[", 
      RowBox[{"4", ",", "13"}], "]"}]}]], ",", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"1", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "10"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "10"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "12"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "11"}], "]"}]}]], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"1", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"6", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "10"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "12"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "11"}], "]"}]}]]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"1", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "11"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"6", ",", "5"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"7", ",", "8"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"9", ",", "10"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"13", ",", "12"}], "]"}]}], 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"4", ",", "13"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "3"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"5", ",", "4"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"10", ",", "6"}], "]"}], " ", 
      RowBox[{"X", "[", 
       RowBox[{"11", ",", "12"}], "]"}]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.664520949450572*^9, 3.664521079385209*^9, {3.6645211195971246`*^9, 
   3.6645211656660967`*^9}, {3.6645211972409286`*^9, 3.664521279681505*^9}, {
   3.664521403787674*^9, 3.6645215711492896`*^9}, {3.664521602880198*^9, 
   3.6645216215650215`*^9}, {3.66452173267423*^9, 3.6645217591638885`*^9}}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.662190126744543*^9, 3.6621901279559746`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
     "Gives", " ", "the", " ", "master", " ", "and", " ", "moduli", " ", 
      "spaces", " ", "in", " ", "terms", " ", "of", " ", "loop", " ", 
      RowBox[{"variables", ".", " ", "You"}], " ", "need", " ", "to", " ", 
      "give", " ", "it", " ", "the", " ", "high"}], "-", 
     RowBox[{"genus", " ", "information", " ", "\"\<genusedges\>\""}]}], ",", 
    " ", 
    RowBox[{
     RowBox[{
      RowBox[{"e", ".", "g", ".", " ", "zeds"}], "=", 
      RowBox[{"{", 
       RowBox[{
        FractionBox[
         RowBox[{
          SubscriptBox["X", 
           RowBox[{"9", ",", "6"}]], 
          SubscriptBox["X", 
           RowBox[{"5", ",", "8"}]]}], 
         RowBox[{
          SubscriptBox["X", 
           RowBox[{"8", ",", "9"}]], 
          SubscriptBox["Y", 
           RowBox[{"6", ",", "5"}]], " "}]], ",", 
        FractionBox[
         RowBox[{
          SubscriptBox["X", 
           RowBox[{"6", ",", "8"}]], 
          SubscriptBox["X", 
           RowBox[{"5", ",", "8"}]], 
          SubscriptBox["X", 
           RowBox[{"5", ",", "14"}]]}], 
         RowBox[{
          SubscriptBox["X", 
           RowBox[{"8", ",", "9"}]], 
          SubscriptBox["Y", 
           RowBox[{"6", ",", "5"}]], " ", 
          SubscriptBox["X", 
           RowBox[{"14", ",", "6"}]]}]], ",", 
        FractionBox[
         RowBox[{
          SubscriptBox["X", 
           RowBox[{"14", ",", "14"}]], 
          SubscriptBox["X", 
           RowBox[{"8", ",", "14"}]]}], 
         RowBox[{" ", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"14", ",", "6"}]], 
           SubscriptBox["X", 
            RowBox[{"15", ",", "8"}]]}]}]], ",", 
        FractionBox[
         RowBox[{
          SubscriptBox["X", 
           RowBox[{"16", ",", "14"}]], 
          SubscriptBox["X", 
           RowBox[{"1", ",", "14"}]], 
          SubscriptBox["X", 
           RowBox[{"10", ",", "9"}]]}], 
         RowBox[{
          SubscriptBox["X", 
           RowBox[{"15", ",", "16"}]], 
          SubscriptBox["X", 
           RowBox[{"14", ",", "2"}]], " ", 
          SubscriptBox["X", 
           RowBox[{"9", ",", "1"}]]}]]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"genusedges", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"9", ",", "6"}]], ",", "\"\<b\>\""}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"9", ",", "5"}]], ",", "\"\<w\>\""}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"6", ",", "5"}]], ",", "\"\<b\>\""}], "}"}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"7", ",", "6"}]], ",", "\"\<b\>\""}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"8", ",", "7"}]], ",", "\"\<b\>\""}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"6", ",", "8"}]], ",", "\"\<b\>\""}], "}"}]}], "}"}]}], 
       "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
     "where", " ", "the", " ", "list", " ", "contains", " ", "the", " ", 
      "edges", " ", "going", " ", "through", " ", "each", " ", "of", " ", 
      "the", " ", "nontrivial", " ", "directions", " ", "in", " ", "the", " ", 
      RowBox[{"graph", ".", " ", "The"}], " ", "letter", " ", "after", " ", 
      "each", " ", "edge", " ", "refers", " ", "to", " ", "the", " ", "color",
       " ", "of", " ", "the", " ", "node", " ", "next", " ", "to", " ", "the",
       " ", "border", " ", "of", " ", "the", " ", "unit", " ", 
      RowBox[{"cell", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"newLoopVarModuli", "[", 
     RowBox[{
     "a_", ",", "b_", ",", "c_", ",", "d_", ",", "zeds_", ",", "genusedges_", 
      ",", "refpm_", ",", "gauging_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "xbindices", ",", "boundaryindices", ",", "tempbs", ",", 
        "boundarygroups", ",", "edgevectors", ",", "bgs", ",", "inedges", ",",
         "outedges", ",", "tovecin", ",", "tovecout", ",", "boundinout", ",", 
        "splitintonumdenom", ",", "numerators", ",", "denominators", ",", 
        "extzsinout", ",", "genusflowvecs", ",", "zis", ",", "inout", ",", 
        "intzsinout", ",", "IF", ",", "NF", ",", "NZ", ",", "fa", ",", "li", 
        ",", "fb", ",", "aia", ",", "fail", ",", "allexpressions", ",", 
        "pmnumber", ",", "extZdirection", ",", "intZdirection", ",", 
        "intZcontrib", ",", "extZcontrib", ",", "zeroguessexpr", ",", 
        "zeroguess", ",", "nextface", ",", "dafacevars", ",", "time", ",", 
        "deletelist", ",", "tulplists", ",", "bo", ",", "boundinds", ",", 
        "alsodelete", ",", "numb"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"kasteleyn", "[", 
        RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "First", " ", "find", " ", "the", " ", "contributions", " ", "of", 
         " ", "the", " ", 
         RowBox[{
          SubscriptBox["z", "i"], "'"}], "s", " ", "that", " ", "stretch", 
         " ", "between", " ", "different", " ", 
         RowBox[{"boundaries", ".", " ", "For"}], " ", "this", " ", 
         RowBox[{"we", "'"}], "ll", " ", "now", " ", "find", " ", "whether", 
         " ", "each", " ", "edge", " ", "goes", " ", "in", " ", "or", " ", 
         "out", " ", "of", " ", "each", " ", "respective", " ", "boundary"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", 
        "\"\<We're now going to look for which edges belong to which \
boundaries.\>\"", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"xbindices", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"sub1", "[", "#", "]"}], ",", 
             RowBox[{"sub2", "[", "#", "]"}]}], "}"}], "&"}], ",", "xb"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"boundaryindices", "=", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Sort", "[", 
             RowBox[{"Cases", "[", 
              RowBox[{"xbindices", ",", 
               RowBox[{"zz_", "/;", 
                RowBox[{
                 RowBox[{"Intersection", "[", 
                  RowBox[{"zz", ",", "#"}], "]"}], "\[NotEqual]", 
                 RowBox[{"{", "}"}]}]}]}], "]"}], "]"}], "&"}], ",", 
           "xbindices"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{"True", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tempbs", "=", 
           RowBox[{"DeleteDuplicates", "[", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"DeleteDuplicates", "[", 
                RowBox[{"Join", "@@", 
                 RowBox[{"Cases", "[", 
                  RowBox[{"boundaryindices", ",", 
                   RowBox[{"zz_", "/;", 
                    RowBox[{
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"Union", "@@", "zz"}], ",", 
                    RowBox[{"Union", "@@", "#"}]}], "]"}], "\[NotEqual]", 
                    RowBox[{"{", "}"}]}]}]}], "]"}]}], "]"}], "&"}], ",", 
              "boundaryindices"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"tempbs", "\[NotEqual]", "boundaryindices"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"boundaryindices", "=", "tempbs"}], ";"}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{
             RowBox[{"Break", "[", "]"}], ";"}]}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"boundaryindices", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Union", "[", 
            RowBox[{"Flatten", "[", "#", "]"}], "]"}], "&"}], ",", 
          "boundaryindices"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"boundarygroups", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{"xb", ",", 
             RowBox[{"zz_", "/;", 
              RowBox[{
               RowBox[{"Intersection", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"sub1", "[", "zz", "]"}], ",", 
                   RowBox[{"sub2", "[", "zz", "]"}]}], "}"}], ",", "#"}], 
                "]"}], "\[NotEqual]", 
               RowBox[{"{", "}"}]}]}]}], "]"}], "&"}], ",", 
          "boundaryindices"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Done, the boundaries are \>\"", ",", "boundarygroups"}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"edgevectors", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"bgs", "=", "1"}], ",", 
         RowBox[{"bgs", "<", 
          RowBox[{
           RowBox[{"Length", "[", "boundarygroups", "]"}], "+", "1"}]}], ",", 
         RowBox[{"bgs", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"inedges", "=", 
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"boundarygroups", "[", 
              RowBox[{"[", "bgs", "]"}], "]"}], ",", 
             RowBox[{"zz_", "/;", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"MemberQ", "[", 
                  RowBox[{
                   RowBox[{"Variables", "[", "b", "]"}], ",", "zz"}], "]"}], "&&", 
                 RowBox[{"FreeQ", "[", 
                  RowBox[{
                   RowBox[{"Variables", "[", 
                    RowBox[{"plist", "[", 
                    RowBox[{"[", "refpm", "]"}], "]"}], "]"}], ",", "zz"}], 
                  "]"}]}], ")"}], "||", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"MemberQ", "[", 
                  RowBox[{
                   RowBox[{"Variables", "[", "c", "]"}], ",", "zz"}], "]"}], "&&", 
                 RowBox[{"MemberQ", "[", 
                  RowBox[{
                   RowBox[{"Variables", "[", 
                    RowBox[{"plist", "[", 
                    RowBox[{"[", "refpm", "]"}], "]"}], "]"}], ",", "zz"}], 
                  "]"}]}], ")"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"outedges", "=", 
           RowBox[{"Complement", "[", 
            RowBox[{
             RowBox[{"boundarygroups", "[", 
              RowBox[{"[", "bgs", "]"}], "]"}], ",", "inedges"}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"tovecin", "=", 
           RowBox[{"-", 
            RowBox[{"UnitVector", "[", 
             RowBox[{
              RowBox[{"Length", "[", "boundarygroups", "]"}], ",", "bgs"}], 
             "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"tovecout", "=", 
           RowBox[{"UnitVector", "[", 
            RowBox[{
             RowBox[{"Length", "[", "boundarygroups", "]"}], ",", "bgs"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"edgevectors", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"edgevectors", ",", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "\[Rule]", "tovecin"}], "&"}], ",", 
                 "inedges"}], "]"}], ",", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "\[Rule]", "tovecout"}], "&"}], ",", 
                 "outedges"}], "]"}]}], "]"}]}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Now", " ", "we", " ", "know", " ", "which", " ", "edges", " ", 
         "flow", " ", "in", " ", "or", " ", "out", " ", "of", " ", "each", 
         " ", "boundary", " ", "ACCORDING", " ", "TO", " ", "THE", " ", 
         "PERFECT", " ", 
         RowBox[{"ORIENTATION", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "Now", " ", "need", " ", "to", " ", "find", " ", "out", " ", "if", 
          " ", "the", " ", 
          RowBox[{
           SubscriptBox["z", "i"], "'"}], "s", " ", "flow", " ", "in", " ", 
          "or", " ", "out", " ", "each", " ", "boundary"}], ",", " ", 
         RowBox[{"ACCORDING", " ", "TO", " ", "HOW", " ", 
          RowBox[{"THEY", "'"}], "VE", " ", "BEEN", " ", 
          RowBox[{"DEFINED", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"boundinout", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Rule", ",", 
           RowBox[{"{", 
            RowBox[{"boundarygroups", ",", 
             RowBox[{"MapThread", "[", 
              RowBox[{"ReplaceAll", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Map", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"Variables", "[", "c", "]"}], ",", "#"}], "]"}], 
                    "&"}], ",", "boundarygroups", ",", 
                   RowBox[{"{", "2", "}"}]}], "]"}], ",", 
                 RowBox[{"Map", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"True", "\[Rule]", "#"}], ",", 
                    RowBox[{"False", "\[Rule]", 
                    RowBox[{"-", "#"}]}]}], "}"}], "&"}], ",", 
                   RowBox[{"IdentityMatrix", "[", 
                    RowBox[{"Length", "[", "boundarygroups", "]"}], "]"}]}], 
                  "]"}]}], "}"}]}], "]"}]}], "}"}], ",", "2"}], "]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"splitintonumdenom", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Intersection", "[", 
            RowBox[{"xb", ",", "#"}], "]"}], "&"}], ",", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Variables", "[", 
                RowBox[{"Numerator", "[", "#", "]"}], "]"}], ",", 
               RowBox[{"Variables", "[", 
                RowBox[{"Denominator", "[", "#", "]"}], "]"}]}], "}"}], "&"}],
             ",", 
            RowBox[{"zeds", "[", 
             RowBox[{"[", 
              RowBox[{"Range", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "genusedges", "]"}], "+", "1"}], ",", 
                RowBox[{"Length", "[", "zeds", "]"}]}], "]"}], "]"}], "]"}]}],
            "]"}], ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"numerators", "=", 
        RowBox[{
         RowBox[{"Transpose", "[", "splitintonumdenom", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"denominators", "=", 
        RowBox[{
         RowBox[{"Transpose", "[", "splitintonumdenom", "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"extzsinout", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Plus", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Map", "[", 
             RowBox[{"Total", ",", 
              RowBox[{"(", 
               RowBox[{"numerators", "/.", "boundinout"}], ")"}]}], "]"}], 
            ",", 
            RowBox[{"Map", "[", 
             RowBox[{"Total", ",", 
              RowBox[{"-", 
               RowBox[{"(", 
                RowBox[{"denominators", "/.", "boundinout"}], ")"}]}]}], 
             "]"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Done", "!"}], " ", "Now", " ", "we", " ", "know", " ", 
         "which", " ", "way", " ", "each", " ", "external", " ", 
         SubscriptBox["z", "i"], " ", "is", " ", 
         RowBox[{"going", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "Now", " ", "find", " ", "the", " ", "contributions", " ", "of", " ",
           "the", " ", 
          RowBox[{
           SubscriptBox["z", "i"], "'"}], "s", " ", "that", " ", "go", " ", 
          "around", " ", "nontrivial", " ", 
          RowBox[{"loops", ".", " ", "For"}], " ", "this", " ", 
          RowBox[{"we", "'"}], "ll", " ", "now", " ", "find", " ", "whether", 
          " ", "each", " ", "edge", " ", "goes", " ", "in", " ", "or", " ", 
          "out", " ", "of", " ", "the", " ", "graph"}], ",", " ", 
         RowBox[{
         "as", " ", "seen", " ", "from", " ", "a", " ", "given", " ", 
          "border", " ", "of", " ", "the", " ", "unit", " ", 
          RowBox[{"cell", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "These", " ", "are", " ", "the", " ", "edges", " ", "whose", " ", 
         "perfect", " ", "orientation", " ", "flows", " ", "into", " ", "the",
          " ", "graph"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"inedges", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"DeleteCases", "[", 
              RowBox[{
               RowBox[{"Cases", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"{", 
                  RowBox[{"___", ",", "\"\<b\>\""}], "}"}]}], "]"}], ",", 
               RowBox[{"zz_", "/;", 
                RowBox[{"MemberQ", "[", 
                 RowBox[{
                  RowBox[{"Variables", "[", 
                   RowBox[{"plist", "[", 
                    RowBox[{"[", "refpm", "]"}], "]"}], "]"}], ",", 
                  RowBox[{"zz", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "]"}], "&"}], 
            ",", "genusedges"}], "]"}], ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"outedges", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Complement", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", "genusedges", ",", 
              RowBox[{"{", "2", "}"}]}], "]"}], ",", "inedges"}], "}"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"genusflowvecs", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"zis", "=", "1"}], ",", 
         RowBox[{"zis", "<", 
          RowBox[{
           RowBox[{"Length", "[", "genusedges", "]"}], "+", "1"}]}], ",", 
         RowBox[{"zis", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"genusflowvecs", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"genusflowvecs", ",", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "\[Rule]", 
                 RowBox[{"UnitVector", "[", 
                  RowBox[{
                   RowBox[{"Length", "[", "genusedges", "]"}], ",", "zis"}], 
                  "]"}]}], "&"}], ",", 
               RowBox[{"inedges", "[", 
                RowBox[{"[", "zis", "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "\[Rule]", 
                 RowBox[{"-", 
                  RowBox[{"UnitVector", "[", 
                   RowBox[{
                    RowBox[{"Length", "[", "genusedges", "]"}], ",", "zis"}], 
                   "]"}]}]}], "&"}], ",", 
               RowBox[{"outedges", "[", 
                RowBox[{"[", "zis", "]"}], "]"}]}], "]"}]}], "]"}]}], ";"}]}],
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Now", " ", "we", " ", "know", " ", "which", " ", "edges", " ", 
         "flow", " ", "in", " ", "or", " ", "out", " ", "of", " ", "the", " ",
          "graph", " ", "ACCORDING", " ", "TO", " ", "THE", " ", "PERFECT", 
         " ", 
         RowBox[{"ORIENTATION", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "Now", " ", "need", " ", "to", " ", "find", " ", "out", " ", "if", 
          " ", "the", " ", 
          RowBox[{
           SubscriptBox["z", "i"], "'"}], "s", " ", "flow", " ", "in", " ", 
          "or", " ", "out", " ", "of", " ", "the", " ", "graph"}], ",", " ", 
         RowBox[{"ACCORDING", " ", "TO", " ", "HOW", " ", 
          RowBox[{"THEY", "'"}], "VE", " ", "BEEN", " ", 
          RowBox[{"DEFINED", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"splitintonumdenom", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Intersection", "[", 
            RowBox[{
             RowBox[{"DeleteCases", "[", 
              RowBox[{
               RowBox[{"Flatten", "[", "genusedges", "]"}], ",", 
               RowBox[{"\"\<b\>\"", "|", "\"\<w\>\""}]}], "]"}], ",", "#"}], 
            "]"}], "&"}], ",", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Variables", "[", 
                RowBox[{"Numerator", "[", "#", "]"}], "]"}], ",", 
               RowBox[{"Variables", "[", 
                RowBox[{"Denominator", "[", "#", "]"}], "]"}]}], "}"}], "&"}],
             ",", 
            RowBox[{"zeds", "[", 
             RowBox[{"[", 
              RowBox[{"Range", "[", 
               RowBox[{"Length", "[", "genusedges", "]"}], "]"}], "]"}], 
             "]"}]}], "]"}], ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"numerators", "=", 
        RowBox[{
         RowBox[{"Transpose", "[", "splitintonumdenom", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"denominators", "=", 
        RowBox[{
         RowBox[{"Transpose", "[", "splitintonumdenom", "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"inout", "=", 
        RowBox[{"Join", "@@", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"genusedges", "[", 
              RowBox[{"[", "#", "]"}], "]"}], "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"zz_", ",", "\"\<b\>\""}], "}"}], "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"zz", "\[Rule]", 
                  RowBox[{"UnitVector", "[", 
                   RowBox[{
                    RowBox[{"Length", "[", "genusedges", "]"}], ",", "#"}], 
                   "]"}]}], ")"}]}], ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"zzz_", ",", "\"\<w\>\""}], "}"}], "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"zzz", "\[Rule]", 
                  RowBox[{"-", 
                   RowBox[{"UnitVector", "[", 
                    RowBox[{
                    RowBox[{"Length", "[", "genusedges", "]"}], ",", "#"}], 
                    "]"}]}]}], ")"}]}]}], "}"}]}], "&"}], ",", 
           RowBox[{"Range", "[", 
            RowBox[{"Length", "[", "genusedges", "]"}], "]"}]}], "]"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"intzsinout", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Plus", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Map", "[", 
             RowBox[{"Total", ",", 
              RowBox[{"(", 
               RowBox[{"numerators", "/.", "inout"}], ")"}]}], "]"}], ",", 
            RowBox[{"Map", "[", 
             RowBox[{"Total", ",", 
              RowBox[{"-", 
               RowBox[{"(", 
                RowBox[{"denominators", "/.", "inout"}], ")"}]}]}], "]"}]}], 
           "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Done", "!"}], " ", "Now", " ", "we", " ", "know", " ", 
         "which", " ", "way", " ", "each", " ", 
         SubscriptBox["z", "i"], " ", "is", " ", 
         RowBox[{"going", ".", " ", "This"}], " ", "even", " ", "allows", " ",
          "for", " ", "the", " ", "possibility", " ", "of", " ", "a", " ", 
         SubscriptBox["z", "i"], " ", "looping", " ", "around", " ", "both", 
         " ", "nontrivial", " ", 
         RowBox[{"directions", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "Here", " ", "is", " ", "old", " ", "code", " ", "that", " ", 
          "creates", " ", "the", " ", "faces", " ", 
          SubscriptBox["w", "i"], "and", " ", 
          SubscriptBox["z", "j"], " ", "paths"}], ",", " ", 
         RowBox[{"but", " ", "now", " ", "we", " ", "also", " ", "form", " ", 
          RowBox[{
           SubscriptBox["w", "NF"], "."}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"IF", "=", 
        RowBox[{"internalFaces", "[", 
         RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"NF", "=", 
        RowBox[{
         RowBox[{"externalFaces", "[", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "+", "IF"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"First", " ", "make", " ", "the", " ", 
         SubscriptBox["w", "i"], " ", "variables"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"NZ", "=", 
        RowBox[{"Length", "[", "zeds", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"fa", "=", "1"}], ",", 
         RowBox[{"fa", "<", 
          RowBox[{"NF", "+", "1"}]}], ",", 
         RowBox[{"fa", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           SubscriptBox["w", "fa"], "=", "1"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"li", "=", "1"}], ",", 
         RowBox[{"li", "<", 
          RowBox[{
           RowBox[{"Length", "[", "Xlist", "]"}], "+", "1"}]}], ",", 
         RowBox[{"li", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"fa", "=", "1"}], ",", 
            RowBox[{"fa", "<", 
             RowBox[{"NF", "+", "1"}]}], ",", 
            RowBox[{"fa", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"fb", "=", "1"}], ",", 
               RowBox[{"fb", "<", 
                RowBox[{"NF", "+", "1"}]}], ",", 
               RowBox[{"fb", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}], "\[Equal]", 
                    SubscriptBox["X", 
                    RowBox[{"fa", ",", "fb"}]]}], "||", 
                   RowBox[{
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}], "\[Equal]", 
                    SubscriptBox["Y", 
                    RowBox[{"fa", ",", "fb"}]]}], "||", 
                   RowBox[{
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}], "\[Equal]", 
                    SubscriptBox["Z", 
                    RowBox[{"fa", ",", "fb"}]]}], "||", 
                   RowBox[{
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}], "\[Equal]", 
                    SubscriptBox["W", 
                    RowBox[{"fa", ",", "fb"}]]}], "||", 
                   RowBox[{
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}], "\[Equal]", 
                    SubscriptBox["V", 
                    RowBox[{"fa", ",", "fb"}]]}], "||", 
                   RowBox[{
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}], "\[Equal]", 
                    SubscriptBox["UU", 
                    RowBox[{"fa", ",", "fb"}]]}], "||", 
                   RowBox[{
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}], "\[Equal]", 
                    SubscriptBox["XX", 
                    RowBox[{"fa", ",", "fb"}]]}], "||", 
                   RowBox[{
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}], "\[Equal]", 
                    SubscriptBox["YY", 
                    RowBox[{"fa", ",", "fb"}]]}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["w", "fa"], "=", 
                    RowBox[{
                    SubscriptBox["w", "fa"], "/", 
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}]}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    SubscriptBox["w", "fb"], "=", 
                    RowBox[{
                    SubscriptBox["w", "fb"], 
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}]}]}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Now", " ", "label", " ", "the", " ", 
         RowBox[{"z", "'"}], "s"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"aia", "=", "1"}], ",", 
         RowBox[{"aia", "<", 
          RowBox[{
           RowBox[{"Length", "[", "zeds", "]"}], "+", "1"}]}], ",", 
         RowBox[{"aia", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           SubscriptBox["z", "aia"], "=", 
           RowBox[{"zeds", "[", 
            RowBox[{"[", "aia", "]"}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "This", " ", "finds", " ", "the", " ", "contribution", " ", "from", 
         " ", "all", " ", 
         RowBox[{"z", "'"}], "s", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
           "both", " ", "those", " ", "between", " ", "boundaries", " ", 
            "and", " ", "those", " ", "around", " ", "nontrivial", " ", 
            "loops"}], ")"}], "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"fail", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"allexpressions", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"pmnumber", "=", "1"}], ",", 
         RowBox[{"pmnumber", "<", 
          RowBox[{
           RowBox[{"Length", "[", "plist", "]"}], "+", "1"}]}], ",", 
         RowBox[{"pmnumber", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"\"\<pmnumber = \>\"", ",", "pmnumber"}], "]"}], ";"}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"extZdirection", "=", 
           RowBox[{"Total", "[", 
            RowBox[{
             RowBox[{"Intersection", "[", 
              RowBox[{"xb", ",", 
               RowBox[{"Variables", "[", 
                RowBox[{
                 RowBox[{"plist", "[", 
                  RowBox[{"[", "pmnumber", "]"}], "]"}], "/", 
                 RowBox[{"plist", "[", 
                  RowBox[{"[", "refpm", "]"}], "]"}]}], "]"}]}], "]"}], "/.", 
             "edgevectors"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"intZdirection", "=", 
           RowBox[{"Total", "[", 
            RowBox[{
             RowBox[{"Intersection", "[", 
              RowBox[{
               RowBox[{"DeleteCases", "[", 
                RowBox[{
                 RowBox[{"Flatten", "[", "genusedges", "]"}], ",", 
                 RowBox[{"\"\<b\>\"", "|", "\"\<w\>\""}]}], "]"}], ",", 
               RowBox[{"Variables", "[", 
                RowBox[{
                 RowBox[{"plist", "[", 
                  RowBox[{"[", "pmnumber", "]"}], "]"}], "/", 
                 RowBox[{"plist", "[", 
                  RowBox[{"[", "refpm", "]"}], "]"}]}], "]"}]}], "]"}], "/.", 
             "genusflowvecs"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"intZcontrib", "=", 
           RowBox[{"Times", "@@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Solve", "[", 
                RowBox[{
                 RowBox[{"Total", "[", 
                  RowBox[{"MapThread", "[", 
                   RowBox[{"Times", ",", 
                    RowBox[{"{", 
                    RowBox[{"intzsinout", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    SubscriptBox["zz", "iii"], ",", 
                    RowBox[{"{", 
                    RowBox[{"iii", ",", 
                    RowBox[{"Length", "[", "genusedges", "]"}]}], "}"}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}], "\[Equal]", 
                 "intZdirection"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "/.", 
              RowBox[{"Rule", "\[Rule]", "Power"}]}], ")"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"extZcontrib", "=", 
           RowBox[{"Times", "@@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Solve", "[", 
                RowBox[{
                 RowBox[{"Total", "[", 
                  RowBox[{"MapThread", "[", 
                   RowBox[{"Times", ",", 
                    RowBox[{"{", 
                    RowBox[{"extzsinout", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    SubscriptBox["zz", "iii"], ",", 
                    RowBox[{"{", 
                    RowBox[{"iii", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "genusedges", "]"}], "+", "1"}], 
                    ",", 
                    RowBox[{"Length", "[", "zeds", "]"}]}], "}"}]}], "]"}]}], 
                    "}"}]}], "]"}], "]"}], "\[Equal]", "extZdirection"}], 
                "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "/.", 
              RowBox[{"Rule", "\[Rule]", "Power"}]}], ")"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"zeroguessexpr", "=", 
           RowBox[{"intZcontrib", " ", "extZcontrib"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"zeroguess", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"plist", "[", 
               RowBox[{"[", "pmnumber", "]"}], "]"}], "/", 
              RowBox[{"plist", "[", 
               RowBox[{"[", "refpm", "]"}], "]"}]}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{"zeroguessexpr", "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"zz", "\[Rule]", "z"}], ",", 
                RowBox[{"ww", "\[Rule]", "w"}]}], "}"}]}], ")"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Found", " ", "the", " ", "correct", " ", 
            RowBox[{"expression", ".", " ", "What"}], " ", "remains", " ", 
            "in", " ", "\"\<zeroguess\>\"", " ", "is", " ", "guaranteed", " ",
             "to", " ", "be", " ", "equal", " ", "to", " ", "some", " ", 
            "product", " ", "of", " ", 
            RowBox[{"faces", "."}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Now", " ", 
            RowBox[{"we", "'"}], "ll", " ", "find", " ", "the", " ", 
            "expression", " ", "for", " ", "the", " ", "faces"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"TimeConstrained", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"While", "[", 
              RowBox[{
               RowBox[{"zeroguess", "=!=", "1"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"nextface", "=", 
                 RowBox[{"sub2", "[", 
                  RowBox[{
                   RowBox[{"Variables", "[", 
                    RowBox[{"Numerator", "[", "zeroguess", "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"zeroguess", "=", 
                 RowBox[{"zeroguess", "/", 
                  SubscriptBox["w", "nextface"]}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"zeroguessexpr", "=", 
                 RowBox[{"zeroguessexpr", " ", 
                  SubscriptBox["ww", "nextface"]}]}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"zeroguessexpr", "=", 
              RowBox[{"zeroguessexpr", "/.", 
               RowBox[{
                SubscriptBox["ww", "NF"], "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"1", "/", 
                  RowBox[{"Times", "@@", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    SubscriptBox["ww", "iii"], ",", 
                    RowBox[{"{", 
                    RowBox[{"iii", ",", 
                    RowBox[{"NF", "-", "1"}]}], "}"}]}], "]"}]}]}], 
                 ")"}]}]}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"allexpressions", "=", 
              RowBox[{"Append", "[", 
               RowBox[{"allexpressions", ",", "zeroguessexpr"}], "]"}]}], 
             ";"}], "\[IndentingNewLine]", ",", "20", ",", 
            RowBox[{
             RowBox[{"fail", "=", 
              RowBox[{"Append", "[", 
               RowBox[{"fail", ",", "pmnumber"}], "]"}]}], ";", 
             RowBox[{"Print", "[", 
              RowBox[{
              "\"\<Number \>\"", ",", "pmnumber", ",", "\"\< failed!\>\""}], 
              "]"}], ";"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Done", "!"}], " ", 
         RowBox[{"We", "'"}], "ve", " ", "found", " ", "all", " ", 
         RowBox[{"expressions", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Now", " ", 
         RowBox[{"we", "'"}], "ll", " ", "make", " ", "Gmaster"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"dafacevars", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"MapThread", "[", 
           RowBox[{"Subscript", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"ConstantArray", "[", 
               RowBox[{"zz", ",", 
                RowBox[{"Length", "[", "zeds", "]"}]}], "]"}], ",", 
              RowBox[{"Range", "[", 
               RowBox[{"Length", "[", "zeds", "]"}], "]"}]}], "}"}]}], "]"}], 
          ",", 
          RowBox[{"MapThread", "[", 
           RowBox[{"Subscript", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"ConstantArray", "[", 
               RowBox[{"ww", ",", 
                RowBox[{"NF", "-", "1"}]}], "]"}], ",", 
              RowBox[{"Range", "[", 
               RowBox[{"NF", "-", "1"}], "]"}]}], "}"}]}], "]"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Gmaster", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"allexpressions", "/.", 
             RowBox[{"Times", "\[Rule]", "Plus"}]}], ")"}], "/.", 
           RowBox[{"Power", "\[Rule]", "Times"}]}], ")"}], "/.", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Rule", ",", 
           RowBox[{"{", 
            RowBox[{"dafacevars", ",", 
             RowBox[{"IdentityMatrix", "[", 
              RowBox[{"Length", "[", "dafacevars", "]"}], "]"}]}], "}"}]}], 
          "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "===", "1"}], "&"}], ",", "allexpressions"}], 
              "]"}], ",", "True"}], "]"}], "]"}], "===", 
          RowBox[{"{", "refpm", "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Gmaster", "[", 
            RowBox[{"[", "refpm", "]"}], "]"}], "=", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0", ",", 
             RowBox[{"Length", "[", "dafacevars", "]"}]}], "]"}]}], ";"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{
          RowBox[{
          "Print", "[", 
           "\"\<There is some problem! It seems like multiple expressions are \
identically equal to 1!!!!\>\"", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"Gmaster", "=", 
        RowBox[{"Transpose", "[", "Gmaster", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "This", " ", "is", " ", "old", " ", "code", " ", "that", " ", "makes",
          " ", "the", " ", "moduli", " ", "space", " ", 
         RowBox[{"etc", ".", " ", "and"}], " ", "all", " ", "the", " ", 
         "printouts"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", "\"\<---------------------------------------------\>\"", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Failed \>\"", ",", 
         RowBox[{"Length", "[", "fail", "]"}], ",", "\"\< times: \>\"", ",", 
         "fail"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Computation time: \>\"", ",", 
         RowBox[{
          RowBox[{"TimeUsed", "[", "]"}], "-", "time"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"time", "=", 
        RowBox[{"TimeUsed", "[", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Gmaster = \>\"", ",", 
         RowBox[{"Gmaster", "//", "MatrixForm"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"mastermult", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Dimensions", "[", 
            RowBox[{
             RowBox[{"Gather", "[", 
              RowBox[{"Transpose", "[", "Gmaster", "]"}], "]"}], "[", 
             RowBox[{"[", "y", "]"}], "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", 
            RowBox[{
             RowBox[{"Dimensions", "[", 
              RowBox[{"Gather", "[", 
               RowBox[{"Transpose", "[", "Gmaster", "]"}], "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"DeleteDuplicates", "[", 
            RowBox[{"mastermult", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ">", "1"}], ",", 
         RowBox[{
          RowBox[{
          "Print", "[", 
           "\"\<ERROR!!! THERE ARE SEVERAL PERFECT MATCHINGS WITH THE SAME \
EXPRESSION!\>\"", "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", 
        "\"\<The order of the coordinates for Gmaster is: \!\(\*SubscriptBox[\
\(z\), \(i\)]\)'s, then faces (starting from face 1 to face NF-1).\>\"", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"gauging", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Gmoduli", "=", 
          RowBox[{"Delete", "[", 
           RowBox[{"Gmaster", ",", 
            RowBox[{"Transpose", "[", 
             RowBox[{"{", 
              RowBox[{"Table", "[", 
               RowBox[{"i", ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", 
                  RowBox[{"NZ", "+", "1"}], ",", 
                  RowBox[{"NZ", "+", "IF"}]}], "}"}]}], "]"}], "}"}], "]"}]}],
            "]"}]}], "\[IndentingNewLine]", ",", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"gauging", "\[Equal]", "2"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"deletelist", "=", 
              RowBox[{"Range", "[", 
               RowBox[{"Length", "[", "genusedges", "]"}], "]"}]}], ";", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{
                RowBox[{
                "Here", " ", "we", " ", "also", " ", "dauge", " ", "the", " ",
                  "internal", " ", "zig"}], "-", "zags"}], ",", " ", 
               RowBox[{
               "as", " ", "well", " ", "as", " ", "delete", " ", "all", " ", 
                "internal", " ", "faces"}]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"Gmoduli", "=", "Gmaster"}], ";", "\[IndentingNewLine]", 
             RowBox[{"tulplists", "=", 
              RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"bo", "=", "1"}], ",", 
               RowBox[{"bo", "<", 
                RowBox[{
                 RowBox[{"Length", "[", "boundarygroups", "]"}], "+", "1"}]}],
                ",", 
               RowBox[{"bo", "++"}], ",", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{
                 "Each", " ", "time", " ", "we", " ", "have", " ", "external",
                   " ", "guys", " ", "going", " ", "around", " ", "a", " ", 
                  "boundary", " ", 
                  RowBox[{"(", 
                   RowBox[{
                   "hence", " ", "are", " ", "completely", " ", "internal"}], 
                   ")"}]}], ",", " ", 
                 RowBox[{
                 "we", " ", "have", " ", "to", " ", "subtract", " ", "the", 
                  " ", "value", " ", "of", " ", "one", " ", "row", " ", 
                  "from", " ", "all", " ", "the", " ", "others"}], ",", " ", 
                 RowBox[{
                 "and", " ", "then", " ", "gauge", " ", "this", " ", 
                  "row"}]}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"boundinds", "=", 
                 RowBox[{"Union", "@@", 
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"sub1", "[", "#", "]"}], ",", 
                    RowBox[{"sub2", "[", "#", "]"}]}], "}"}], "&"}], ",", 
                    RowBox[{"boundarygroups", "[", 
                    RowBox[{"[", "bo", "]"}], "]"}]}], "]"}]}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"MemberQ", "[", 
                   RowBox[{"boundinds", ",", "NF"}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"boundinds", "=", 
                    RowBox[{"Complement", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", "NF", "]"}], ",", "boundinds"}], 
                    "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"tulplists", "=", 
                 RowBox[{"Append", "[", 
                  RowBox[{"tulplists", ",", "boundinds"}], "]"}]}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"alsodelete", "=", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "+", 
                  RowBox[{"Length", "[", "zeds", "]"}]}], "&"}], ",", 
                RowBox[{
                 RowBox[{"Cases", "[", 
                  RowBox[{
                   RowBox[{"Tuples", "[", "tulplists", "]"}], ",", 
                   RowBox[{"zz_", "/;", 
                    RowBox[{
                    RowBox[{"Union", "[", "zz", "]"}], "\[Equal]", 
                    RowBox[{"Sort", "[", "zz", "]"}]}]}]}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"bo", "=", "1"}], ",", 
               RowBox[{"bo", "<", 
                RowBox[{
                 RowBox[{"Length", "[", "tulplists", "]"}], "+", "1"}]}], ",", 
               RowBox[{"bo", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"numb", "=", "1"}], ",", 
                  RowBox[{"numb", "<", 
                   RowBox[{"Length", "[", 
                    RowBox[{"tulplists", "[", 
                    RowBox[{"[", "bo", "]"}], "]"}], "]"}]}], ",", 
                  RowBox[{"numb", "++"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Gmoduli", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Length", "[", "zeds", "]"}], "+", 
                    RowBox[{"tulplists", "[", 
                    RowBox[{"[", 
                    RowBox[{"bo", ",", "numb"}], "]"}], "]"}]}], "]"}], "]"}],
                     "=", 
                    RowBox[{
                    RowBox[{"Gmoduli", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Length", "[", "zeds", "]"}], "+", 
                    RowBox[{"tulplists", "[", 
                    RowBox[{"[", 
                    RowBox[{"bo", ",", "numb"}], "]"}], "]"}]}], "]"}], "]"}],
                     "-", 
                    RowBox[{"Gmoduli", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Length", "[", "zeds", "]"}], "+", 
                    RowBox[{"alsodelete", "[", 
                    RowBox[{"[", "bo", "]"}], "]"}]}], "]"}], "]"}]}]}], 
                   ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"deletelist", "=", 
              RowBox[{"Sort", "[", 
               RowBox[{"Join", "[", 
                RowBox[{"deletelist", ",", "alsodelete"}], "]"}], "]"}]}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"Gmoduli", "=", 
              RowBox[{"Delete", "[", 
               RowBox[{"Gmoduli", ",", 
                RowBox[{"Transpose", "[", 
                 RowBox[{"{", "deletelist", "}"}], "]"}]}], "]"}]}], ";"}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{
             RowBox[{
             "Print", "[", 
              "\"\<Invalid value for 'gauging'. Need to specify either \
'gauging'=1 or 'gauging'=2.\>\"", "]"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Now", " ", "group", " ", "the", " ", "multiplicities", " ", "of", 
         " ", "G", " ", 
         RowBox[{"together", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Gshort", "=", 
        RowBox[{"Transpose", "[", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Transpose", "[", "Gmoduli", "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Multmatrix", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Dimensions", "[", 
            RowBox[{
             RowBox[{"Gather", "[", 
              RowBox[{"Transpose", "[", "Gmoduli", "]"}], "]"}], "[", 
             RowBox[{"[", "y", "]"}], "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", 
            RowBox[{
             RowBox[{"Dimensions", "[", 
              RowBox[{"Gather", "[", 
               RowBox[{"Transpose", "[", "Gmoduli", "]"}], "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Gshort = \>\"", ",", 
         RowBox[{"Gshort", "//", "MatrixForm"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Multipl = \>\"", ",", 
         RowBox[{"Multmatrix", "//", "MatrixForm"}]}], "]"}], ";"}]}], " ", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", "]"}]}], 
   ";"}]}]], "Input"],

Cell[CellGroupData[{

Cell["Here is all of the code in allBFTfunctions", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6383446299830313`*^9, 3.6383446727849455`*^9}, 
   3.638344710554902*^9, {3.64224303461718*^9, 3.642243068687608*^9}, {
   3.6422454702081013`*^9, 3.6422455111219*^9}, {3.64224555395127*^9, 
   3.6422455767021837`*^9}, {3.642245629828741*^9, 3.642245680063313*^9}, 
   3.6506921124964247`*^9, {3.661686864705759*^9, 3.6616868958526716`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "To", " ", "calculate", " ", "the", " ", "dimension", " ", "of", " ", "a", 
    " ", "polytope"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"BFTdim", "[", "mat_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"newsp", ",", "gi", ",", "dim"}], "}"}], ",", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", "mat", "]"}], ",", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0", ",", 
             RowBox[{"Length", "[", "mat", "]"}]}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"dim", "=", 
           RowBox[{"MatrixRank", "[", "mat", "]"}]}], ";"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{
          RowBox[{"newsp", "=", "mat"}], ";", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"gi", "=", "1"}], ",", 
            RowBox[{"gi", "<", 
             RowBox[{
              RowBox[{
               RowBox[{"Dimensions", "[", "mat", "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "1"}]}], ",", 
            RowBox[{"gi", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"newsp", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "gi"}], "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{"newsp", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "gi"}], "]"}], "]"}], "-", 
               RowBox[{"mat", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"dim", "=", 
           RowBox[{"MatrixRank", "[", "newsp", "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "dim"}]}], "]"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"DONE", ",", " ", 
    RowBox[{"NOW", " ", "CALLED", " ", "polytopeDim"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "To", " ", "obtain", " ", "the", " ", "coordinates", " ", "of", " ", "a", 
     " ", "polytope"}], ",", " ", 
    RowBox[{
    "with", " ", "the", " ", "shift", " ", "such", " ", "that", " ", "one", 
     " ", "vertex", " ", "is", " ", "at", " ", "the", " ", 
     RowBox[{"origin", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"polytope", "[", "mat_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"newsp", ",", "gi"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"newsp", "=", "mat"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"FreeQ", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", "mat", "]"}], ",", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0", ",", 
             RowBox[{"Length", "[", "mat", "]"}]}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"gi", "=", "1"}], ",", 
            RowBox[{"gi", "<", 
             RowBox[{
              RowBox[{
               RowBox[{"Dimensions", "[", "mat", "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "1"}]}], ",", 
            RowBox[{"gi", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"newsp", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "gi"}], "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{"newsp", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "gi"}], "]"}], "]"}], "-", 
               RowBox[{"mat", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"newsp", "=", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{
          RowBox[{"RowReduce", "[", "newsp", "]"}], ",", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", 
            RowBox[{
             RowBox[{"Dimensions", "[", "mat", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "newsp"}]}], "]"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", "SKIPPED", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Calculates", " ", "the", " ", "contour", " ", "integral", " ", "circled", 
    " ", "at", " ", "infinity", " ", 
    RowBox[{"(", 
     RowBox[{"takes", " ", "into", " ", "account", " ", "all", " ", "poles"}],
      ")"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"contourint", "[", 
     RowBox[{"func_", ",", "var_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"sols", ",", "tot", ",", "i"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sols", "=", 
        RowBox[{"Solve", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Denominator", "[", "func", "]"}], "\[Equal]", "0"}], ",", 
          "var"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"sols", "=", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"Sequence", "@@@", 
          RowBox[{"(", 
           RowBox[{"sols", "/.", 
            RowBox[{"{", 
             RowBox[{"Rule", "\[Rule]", "List"}], "}"}]}], ")"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"tot", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", "sols", "]"}], "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tot", "=", 
           RowBox[{"tot", "+", 
            RowBox[{"2", "Pi", " ", "I", " ", 
             RowBox[{"Residue", "[", 
              RowBox[{"func", ",", 
               RowBox[{"sols", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}]}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "tot"}]}], 
     "\[IndentingNewLine]", "]"}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "SKIPPED", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Gives", " ", "you", " ", "the", " ", "total", " ", "number", " ", "of", 
    " ", 
    RowBox[{"faces", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"totFaces", "[", 
     RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "K0full", ",", "K0flatX", ",", "facelist", ",", "i", ",", "nf"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"K0full", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{"a", ",", "c"}], "]"}], ",", 
          RowBox[{"Join", "[", 
           RowBox[{"b", ",", "d"}], "]"}], ",", "2"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"K0flatX", "=", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", "K0full", "]"}], ",", "0"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"K0flatX", "=", 
        RowBox[{"Sequence", "@@@", 
         RowBox[{"(", 
          RowBox[{"MapThread", "[", 
           RowBox[{"MonomialList", ",", 
            RowBox[{"{", "K0flatX", "}"}]}], "]"}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"facelist", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", "K0flatX", "]"}], "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"facelist", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"facelist", ",", 
             RowBox[{"{", 
              RowBox[{"sub1", "[", 
               RowBox[{"K0flatX", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"facelist", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"facelist", ",", 
             RowBox[{"{", 
              RowBox[{"sub2", "[", 
               RowBox[{"K0flatX", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], "}"}]}], "]"}]}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"facelist", "=", 
        RowBox[{"DeleteDuplicates", "[", "facelist", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"nf", "=", 
        RowBox[{"Length", "[", "facelist", "]"}]}], ";", 
       "\[IndentingNewLine]", "nf"}]}], "\[IndentingNewLine]", "]"}]}], 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"DONE", ",", " ", 
    RowBox[{"SAME", " ", "NAME"}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Gives", " ", "you", " ", "the", " ", "number", " ", "of", " ", "external",
     " ", 
    RowBox[{"faces", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"externalFaces", "[", 
     RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"flatext", ",", "extfacelist", ",", "i", ",", "extn"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"flatext", "=", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", "b", "]"}], ",", 
            RowBox[{"Flatten", "[", "c", "]"}]}], "]"}], ",", "0"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"flatext", "=", 
        RowBox[{"Sequence", "@@@", 
         RowBox[{"(", 
          RowBox[{"MapThread", "[", 
           RowBox[{"MonomialList", ",", 
            RowBox[{"{", "flatext", "}"}]}], "]"}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"extfacelist", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", "flatext", "]"}], "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"extfacelist", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"extfacelist", ",", 
             RowBox[{"{", 
              RowBox[{"sub1", "[", 
               RowBox[{"flatext", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"extfacelist", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"extfacelist", ",", 
             RowBox[{"{", 
              RowBox[{"sub2", "[", 
               RowBox[{"flatext", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], "}"}]}], "]"}]}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"extfacelist", "=", 
        RowBox[{"DeleteDuplicates", "[", "extfacelist", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"extn", "=", 
        RowBox[{"Length", "[", "extfacelist", "]"}]}], ";", 
       "\[IndentingNewLine]", "extn"}]}], "\[IndentingNewLine]", "]"}]}], 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"DONE", ",", " ", 
    RowBox[{"SAME", " ", "NAME"}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Gives", " ", "you", " ", "the", " ", "number", " ", "of", " ", "internal",
     " ", 
    RowBox[{"faces", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"internalFaces", "[", 
     RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "intn", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"intn", "=", 
        RowBox[{
         RowBox[{"totFaces", "[", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "-", 
         RowBox[{"externalFaces", "[", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", "intn"}]}], "\[IndentingNewLine]", "]"}]}], 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"DONE", ",", " ", 
    RowBox[{"SAME", " ", "NAME"}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Gives", " ", "True", " ", "if", " ", "\"\<fullspace\>\"", " ", "is", " ",
      "reducible"}], ",", " ", 
    RowBox[{"or", " ", "False", " ", "if", " ", "it", " ", 
     RowBox[{"isn", "'"}], 
     RowBox[{"t", ".", " ", "Fullspace"}], " ", "is", " ", "in", " ", "the", 
     " ", "form", " ", "of", " ", "the", " ", "perfect", " ", "matching", " ",
      "matrix", " ", 
     RowBox[{"P", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"reducibility", "[", 
     RowBox[{"fullspace_", ",", "moduli_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "coordi", ",", "red", ",", "columnlist", ",", "po", ",", "ps", ",", 
        "Pshort"}], "}"}], ",", 
      RowBox[{"(*", 
       RowBox[{
       "First", " ", "need", " ", "to", " ", "find", " ", "out", " ", "which",
         " ", "columns", " ", "are", " ", "the", " ", "same", " ", "point", 
        " ", "in", " ", "the", " ", "moduli", " ", "space"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"coordi", "=", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"Transpose", "[", "moduli", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"columnlist", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"po", "=", "1"}], ",", 
         RowBox[{"po", "<", 
          RowBox[{
           RowBox[{"Length", "[", "coordi", "]"}], "+", "1"}]}], ",", 
         RowBox[{"po", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"columnlist", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"columnlist", ",", 
             RowBox[{"Transpose", "[", 
              RowBox[{"Position", "[", 
               RowBox[{
                RowBox[{"Transpose", "[", "moduli", "]"}], ",", 
                RowBox[{"coordi", "[", 
                 RowBox[{"[", "po", "]"}], "]"}]}], "]"}], "]"}]}], "]"}]}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "Now", " ", "we", " ", "know", " ", "which", " ", "columns", " ", 
         "represent", " ", "the", " ", "same", " ", "point", " ", "in", " ", 
         "the", " ", "toric", " ", 
         RowBox[{"diagram", "!"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Pshort", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{"Length", "[", "fullspace", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", 
            RowBox[{"Length", "[", "columnlist", "]"}]}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"ps", "=", "1"}], ",", 
         RowBox[{"ps", "<", 
          RowBox[{
           RowBox[{"Length", "[", "columnlist", "]"}], "+", "1"}]}], ",", 
         RowBox[{"ps", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Pshort", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "ps"}], "]"}], "]"}], "=", 
           RowBox[{"Product", "[", 
            RowBox[{
             RowBox[{"fullspace", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", 
                RowBox[{"columnlist", "[", 
                 RowBox[{"[", 
                  RowBox[{"ps", ",", "i"}], "]"}], "]"}]}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "[", 
                RowBox[{"columnlist", "[", 
                 RowBox[{"[", "ps", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"Pshort", ",", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0", ",", 
             RowBox[{
              RowBox[{"Dimensions", "[", "Pshort", "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
         RowBox[{"red", "=", "True"}], ",", 
         RowBox[{"red", "=", "False"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "red"}]}], "\[IndentingNewLine]", "]"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"DONE", "!"}], " ", "NOW", " ", "CALLED", " ", 
    "reducibilityBFTQ"}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Draws", " ", "the", " ", "graph", " ", "in", " ", "a", " ", "way", " ", 
     "that", " ", "is", " ", "as", " ", "planar", " ", "as", " ", "possible", 
     " ", "to", " ", "help", " ", "you", " ", "to", " ", "work", " ", "out", 
     " ", "how", " ", "many", " ", "boundaries", " ", "it", " ", "must", " ", 
     "have"}], ",", " ", 
    RowBox[{
    "and", " ", "whether", " ", "it", " ", "can", " ", "be", " ", "drawn", 
     " ", "on", " ", "a", " ", "genus", " ", "zero", " ", 
     RowBox[{"surface", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"planarity", "[", 
     RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "kasta", ",", "bigamat", ",", "multiguys", ",", "newbigamat", ",", 
        "nu", ",", "tofix", ",", "coltoadd", ",", "rowtoadd", ",", "du", ",", 
        "graph"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"kasta", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{"a", ",", "c"}], "]"}], ",", 
          RowBox[{"Join", "[", 
           RowBox[{"b", ",", "d"}], "]"}], ",", "2"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Now", " ", "make", " ", "the", " ", "weighted", " ", "adjacency", 
         " ", "matrix"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"bigamat", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{"0", ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", 
                RowBox[{"Length", "[", "kasta", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", 
                RowBox[{"Length", "[", "kasta", "]"}]}], "}"}]}], "]"}], ",", 
            RowBox[{"Transpose", "[", "kasta", "]"}]}], "]"}], ",", 
          RowBox[{"Join", "[", 
           RowBox[{"kasta", ",", 
            RowBox[{"Table", "[", 
             RowBox[{"0", ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", 
                RowBox[{
                 RowBox[{"Dimensions", "[", "kasta", "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", 
                RowBox[{
                 RowBox[{"Dimensions", "[", "kasta", "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], "]"}], 
          ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"multiguys", "=", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Sort", ",", 
           RowBox[{"{", 
            RowBox[{"Position", "[", 
             RowBox[{
              RowBox[{"MapThread", "[", 
               RowBox[{"Length", ",", 
                RowBox[{"{", 
                 RowBox[{"MonomialList", "[", "bigamat", "]"}], "}"}], ",", 
                "2"}], "]"}], ",", 
              RowBox[{"x_", "/;", 
               RowBox[{"x", ">", "1"}]}]}], "]"}], "}"}]}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"newbigamat", "=", "bigamat"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"nu", "=", "1"}], ",", 
         RowBox[{"nu", "<", 
          RowBox[{
           RowBox[{"Length", "[", "multiguys", "]"}], "+", "1"}]}], ",", 
         RowBox[{"nu", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tofix", "=", 
           RowBox[{"MonomialList", "[", 
            RowBox[{"bigamat", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{
                RowBox[{"multiguys", "[", 
                 RowBox[{"[", "nu", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"multiguys", "[", 
                 RowBox[{"[", "nu", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
             RowBox[{"we", "'"}], "ll", " ", "now", " ", "need", " ", "to", 
             " ", "add", " ", "a", " ", "certain", " ", "number", " ", "of", 
             " ", "columns", " ", "and", " ", "rows"}], ",", " ", 
            RowBox[{
            "so", " ", "that", " ", "multiedges", " ", "get", " ", "their", 
             " ", "own", " ", "node", " ", "at", " ", "the", " ", "midway", 
             " ", "point"}], ",", " ", 
            RowBox[{"and", " ", "hence", " ", 
             RowBox[{"don", "'"}], "t", " ", 
             RowBox[{"overlap", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"coltoadd", "=", 
           RowBox[{"Table", "[", 
            RowBox[{"0", ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", 
               RowBox[{"Length", "[", "newbigamat", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"y", ",", 
               RowBox[{
                RowBox[{"Length", "[", "tofix", "]"}], "-", "1"}]}], "}"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"du", "=", "2"}], ",", 
            RowBox[{"du", "<", 
             RowBox[{
              RowBox[{"Length", "[", "tofix", "]"}], "+", "1"}]}], ",", 
            RowBox[{"du", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"coltoadd", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"multiguys", "[", 
                   RowBox[{"[", "nu", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"du", "-", "1"}]}], "]"}], "]"}], "=", 
              RowBox[{"tofix", "[", 
               RowBox[{"[", "du", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"coltoadd", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"multiguys", "[", 
                   RowBox[{"[", "nu", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                 RowBox[{"du", "-", "1"}]}], "]"}], "]"}], "=", 
              RowBox[{"tofix", "[", 
               RowBox[{"[", "du", "]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"rowtoadd", "=", 
           RowBox[{"Table", "[", 
            RowBox[{"0", ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", 
               RowBox[{
                RowBox[{"Length", "[", "tofix", "]"}], "-", "1"}]}], "}"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"y", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Dimensions", "[", "newbigamat", "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "+", 
                RowBox[{"Length", "[", "tofix", "]"}], "-", "1"}]}], "}"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"du", "=", "2"}], ",", 
            RowBox[{"du", "<", 
             RowBox[{
              RowBox[{"Length", "[", "tofix", "]"}], "+", "1"}]}], ",", 
            RowBox[{"du", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"rowtoadd", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"du", "-", "1"}], ",", 
                 RowBox[{
                  RowBox[{"multiguys", "[", 
                   RowBox[{"[", "nu", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "=", 
              RowBox[{"tofix", "[", 
               RowBox[{"[", "du", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"rowtoadd", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"du", "-", "1"}], ",", 
                 RowBox[{
                  RowBox[{"multiguys", "[", 
                   RowBox[{"[", "nu", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "=", 
              RowBox[{"tofix", "[", 
               RowBox[{"[", "du", "]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"newbigamat", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"newbigamat", ",", "coltoadd", ",", "2"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"newbigamat", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"newbigamat", ",", "rowtoadd"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"newbigamat", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{
               RowBox[{"multiguys", "[", 
                RowBox[{"[", "nu", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"multiguys", "[", 
                RowBox[{"[", "nu", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "=", 
           RowBox[{"tofix", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"newbigamat", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{
               RowBox[{"multiguys", "[", 
                RowBox[{"[", "nu", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"multiguys", "[", 
                RowBox[{"[", "nu", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "=", 
           RowBox[{"tofix", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"newbigamat", "=", 
        RowBox[{"newbigamat", "/.", 
         RowBox[{"{", 
          RowBox[{"0", "\[Rule]", "\[Infinity]"}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"graph", "=", 
        RowBox[{"WeightedAdjacencyGraph", "[", "newbigamat", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"PlanarGraphQ", "[", "graph", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "Print", "[", 
           "\"\<The graph can be written in a genus 0 surface, i.e. the plane \
with a certain number of boundaries.\>\"", "]"}], ";"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{
         "Print", "[", 
          "\"\<The graph CANNOT be written in a genus 0 surface! You have \
genus > 0 .\>\"", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", 
        "\"\<This is the graph as Mathematica preferes to draw it (usually \
Mathematica preferes to draw it without crossings, so the presence of \
crossings is usually an indicator for nonplanarity):\>\"", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"WeightedAdjacencyGraph", "[", 
         RowBox[{"newbigamat", ",", 
          RowBox[{"VertexLabels", "\[Rule]", "\"\<Name\>\""}]}], "]"}], "]"}],
        ";", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", 
        "\"\<This is the graph when Mathematica has been explicitly told to \
avoid edge crossings (Mathematica will usually try and do it with the \
smallest number of boundaries):\>\"", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"WeightedAdjacencyGraph", "[", 
         RowBox[{"newbigamat", ",", 
          RowBox[{"GraphLayout", "\[Rule]", "\"\<PlanarEmbedding\>\""}], ",", 
          RowBox[{"VertexLabels", "\[Rule]", "\"\<Name\>\""}], ",", 
          RowBox[{"ImagePadding", "\[Rule]", "20"}]}], "]"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"DONE", ",", " ", 
    RowBox[{"NOW", " ", "CALLED", " ", "planarityQ"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Draws", " ", "the", " ", "bipartite", " ", "graph", " ", "associated", 
    " ", "to", " ", "the", " ", "Kasteleyn", " ", "matrix"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"drawBFT", "[", 
     RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "kasta", ",", "bigamat", ",", "multiguys", ",", "newbigamat", ",", 
        "nu", ",", "tofix", ",", "coltoadd", ",", "rowtoadd", ",", "du", ",", 
        "edgelabs", ",", "colors", ",", "ai", ",", "aj"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"kasta", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{"a", ",", "c"}], "]"}], ",", 
          RowBox[{"Join", "[", 
           RowBox[{"b", ",", "d"}], "]"}], ",", "2"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Now", " ", "make", " ", "the", " ", "weighted", " ", "adjacency", 
         " ", "matrix"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"bigamat", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{"0", ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", 
                RowBox[{"Length", "[", "kasta", "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", 
                RowBox[{"Length", "[", "kasta", "]"}]}], "}"}]}], "]"}], ",", 
            RowBox[{"Transpose", "[", "kasta", "]"}]}], "]"}], ",", 
          RowBox[{"Join", "[", 
           RowBox[{"kasta", ",", 
            RowBox[{"Table", "[", 
             RowBox[{"0", ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", 
                RowBox[{
                 RowBox[{"Dimensions", "[", "kasta", "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", 
                RowBox[{
                 RowBox[{"Dimensions", "[", "kasta", "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], "]"}], 
          ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"multiguys", "=", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Sort", ",", 
           RowBox[{"{", 
            RowBox[{"Position", "[", 
             RowBox[{
              RowBox[{"MapThread", "[", 
               RowBox[{"Length", ",", 
                RowBox[{"{", 
                 RowBox[{"MonomialList", "[", "bigamat", "]"}], "}"}], ",", 
                "2"}], "]"}], ",", 
              RowBox[{"x_", "/;", 
               RowBox[{"x", ">", "1"}]}]}], "]"}], "}"}]}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"newbigamat", "=", "bigamat"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"nu", "=", "1"}], ",", 
         RowBox[{"nu", "<", 
          RowBox[{
           RowBox[{"Length", "[", "multiguys", "]"}], "+", "1"}]}], ",", 
         RowBox[{"nu", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tofix", "=", 
           RowBox[{"MonomialList", "[", 
            RowBox[{"bigamat", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{
                RowBox[{"multiguys", "[", 
                 RowBox[{"[", "nu", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"multiguys", "[", 
                 RowBox[{"[", "nu", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
             RowBox[{"we", "'"}], "ll", " ", "now", " ", "need", " ", "to", 
             " ", "add", " ", "a", " ", "certain", " ", "number", " ", "of", 
             " ", "columns", " ", "and", " ", "rows"}], ",", " ", 
            RowBox[{
            "so", " ", "that", " ", "multiedges", " ", "get", " ", "their", 
             " ", "own", " ", "node", " ", "at", " ", "the", " ", "midway", 
             " ", "point"}], ",", " ", 
            RowBox[{"and", " ", "hence", " ", 
             RowBox[{"don", "'"}], "t", " ", 
             RowBox[{"overlap", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"coltoadd", "=", 
           RowBox[{"Table", "[", 
            RowBox[{"0", ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", 
               RowBox[{"Length", "[", "newbigamat", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"y", ",", 
               RowBox[{
                RowBox[{"Length", "[", "tofix", "]"}], "-", "1"}]}], "}"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"du", "=", "2"}], ",", 
            RowBox[{"du", "<", 
             RowBox[{
              RowBox[{"Length", "[", "tofix", "]"}], "+", "1"}]}], ",", 
            RowBox[{"du", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"coltoadd", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"multiguys", "[", 
                   RowBox[{"[", "nu", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"du", "-", "1"}]}], "]"}], "]"}], "=", 
              RowBox[{"tofix", "[", 
               RowBox[{"[", "du", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"coltoadd", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"multiguys", "[", 
                   RowBox[{"[", "nu", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                 RowBox[{"du", "-", "1"}]}], "]"}], "]"}], "=", 
              RowBox[{"tofix", "[", 
               RowBox[{"[", "du", "]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"rowtoadd", "=", 
           RowBox[{"Table", "[", 
            RowBox[{"0", ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", 
               RowBox[{
                RowBox[{"Length", "[", "tofix", "]"}], "-", "1"}]}], "}"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"y", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Dimensions", "[", "newbigamat", "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "+", 
                RowBox[{"Length", "[", "tofix", "]"}], "-", "1"}]}], "}"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"du", "=", "2"}], ",", 
            RowBox[{"du", "<", 
             RowBox[{
              RowBox[{"Length", "[", "tofix", "]"}], "+", "1"}]}], ",", 
            RowBox[{"du", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"rowtoadd", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"du", "-", "1"}], ",", 
                 RowBox[{
                  RowBox[{"multiguys", "[", 
                   RowBox[{"[", "nu", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "=", 
              RowBox[{"tofix", "[", 
               RowBox[{"[", "du", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"rowtoadd", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"du", "-", "1"}], ",", 
                 RowBox[{
                  RowBox[{"multiguys", "[", 
                   RowBox[{"[", "nu", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "=", 
              RowBox[{"tofix", "[", 
               RowBox[{"[", "du", "]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"newbigamat", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"newbigamat", ",", "coltoadd", ",", "2"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"newbigamat", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"newbigamat", ",", "rowtoadd"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"newbigamat", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{
               RowBox[{"multiguys", "[", 
                RowBox[{"[", "nu", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"multiguys", "[", 
                RowBox[{"[", "nu", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "=", 
           RowBox[{"tofix", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"newbigamat", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{
               RowBox[{"multiguys", "[", 
                RowBox[{"[", "nu", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"multiguys", "[", 
                RowBox[{"[", "nu", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "=", 
           RowBox[{"tofix", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"colors", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"MapThread", "[", 
           RowBox[{"Rule", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Range", "[", 
               RowBox[{"Length", "[", 
                RowBox[{"Join", "[", 
                 RowBox[{"a", ",", "c"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"ConstantArray", "[", 
               RowBox[{"White", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"Join", "[", 
                  RowBox[{"a", ",", "c"}], "]"}], "]"}]}], "]"}]}], "}"}]}], 
           "]"}], ",", 
          RowBox[{"MapThread", "[", 
           RowBox[{"Rule", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Range", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", 
                  RowBox[{"Join", "[", 
                   RowBox[{"a", ",", "c"}], "]"}], "]"}], "+", "1"}], ",", 
                RowBox[{
                 RowBox[{"Length", "[", 
                  RowBox[{"Join", "[", 
                   RowBox[{"a", ",", "c"}], "]"}], "]"}], "+", 
                 RowBox[{
                  RowBox[{"Dimensions", "[", 
                   RowBox[{"Join", "[", 
                    RowBox[{"a", ",", "b", ",", "2"}], "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], ",", 
              RowBox[{"ConstantArray", "[", 
               RowBox[{"Black", ",", 
                RowBox[{
                 RowBox[{"Dimensions", "[", 
                  RowBox[{"Join", "[", 
                   RowBox[{"a", ",", "b", ",", "2"}], "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "}"}]}], "]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"edgelabs", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"ai", "=", "1"}], ",", 
         RowBox[{"ai", "<", 
          RowBox[{
           RowBox[{"Length", "[", "newbigamat", "]"}], "+", "1"}]}], ",", 
         RowBox[{"ai", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"aj", "=", "ai"}], ",", 
            RowBox[{"aj", "<", 
             RowBox[{
              RowBox[{
               RowBox[{"Dimensions", "[", "newbigamat", "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "1"}]}], ",", 
            RowBox[{"aj", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"newbigamat", "[", 
                 RowBox[{"[", 
                  RowBox[{"ai", ",", "aj"}], "]"}], "]"}], "\[Equal]", "0"}], 
               ",", "True", ",", "True", ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"edgelabs", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{"edgelabs", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ai", "\[UndirectedEdge]", "aj"}], "\[Rule]", 
                    RowBox[{"newbigamat", "[", 
                    RowBox[{"[", 
                    RowBox[{"ai", ",", "aj"}], "]"}], "]"}]}], "}"}]}], 
                  "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"newbigamat", "=", 
        RowBox[{"newbigamat", "/.", 
         RowBox[{"{", 
          RowBox[{"0", "\[Rule]", "\[Infinity]"}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"WeightedAdjacencyGraph", "[", 
         RowBox[{"newbigamat", ",", 
          RowBox[{"EdgeLabels", "\[Rule]", "edgelabs"}], ",", 
          RowBox[{"VertexLabels", "\[Rule]", "\"\<Name\>\""}], ",", 
          RowBox[{"VertexLabelStyle", "\[Rule]", "15"}], ",", 
          RowBox[{"VertexSize", "\[Rule]", "Medium"}], ",", 
          RowBox[{"VertexStyle", "\[Rule]", "colors"}], ",", 
          RowBox[{"ImagePadding", "\[Rule]", "20"}]}], "]"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"DONE", ",", " ", 
    RowBox[{"NOW", " ", "CALLED", " ", "viewGraph"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Swaps", " ", "the", " ", "columns", " ", "\"\<col1\>\"", " ", "and", " ", 
    "\"\<col2\>\"", "of", " ", "\"\<matrix\>\""}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"columnswap", "[", 
     RowBox[{"matrix_", ",", "col1_", ",", "col2_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"newmat", ",", "rule", ",", "rightorder", ",", "ii"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"newmat", "=", 
        RowBox[{"Transpose", "[", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             RowBox[{"Length", "[", "matrix", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"y", ",", 
             RowBox[{
              RowBox[{"Dimensions", "[", "matrix", "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"rule", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"col1", "\[Rule]", "col2"}], ",", 
          RowBox[{"col2", "\[Rule]", "col1"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"rightorder", "=", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{
           RowBox[{"Dimensions", "[", "matrix", "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}], "/.", "rule"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"ii", "=", "1"}], ",", 
         RowBox[{"ii", "<", 
          RowBox[{
           RowBox[{"Length", "[", "rightorder", "]"}], "+", "1"}]}], ",", 
         RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"newmat", "[", 
            RowBox[{"[", "ii", "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{"Transpose", "[", "matrix", "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"rightorder", "[", 
              RowBox[{"[", "ii", "]"}], "]"}], "]"}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"newmat", "=", 
        RowBox[{"Transpose", "[", "newmat", "]"}]}], ";", 
       "\[IndentingNewLine]", "newmat"}]}], "\[IndentingNewLine]", "]"}]}], 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"SKIPPED", ",", " ", 
    RowBox[{"CAN", " ", "BE", " ", "DONE", " ", 
     RowBox[{"WITH", " ", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", 
        RowBox[{"{", 
         RowBox[{"...", ",", "col2", ",", "...", ",", "col1", ",", "..."}], 
         "}"}]}], "]"}], "]"}]}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Swaps", " ", "the", " ", "rows", " ", "\"\<row1\>\"", " ", "and", " ", 
    "\"\<row2\>\"", "of", " ", "\"\<matrix\>\""}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"rowswap", "[", 
     RowBox[{"matrix_", ",", "row1_", ",", "row2_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"newmat", ",", "rule", ",", "rightorder", ",", "ii"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"newmat", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{"Length", "[", "matrix", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", 
            RowBox[{
             RowBox[{"Dimensions", "[", "matrix", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"rule", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"row1", "\[Rule]", "row2"}], ",", 
          RowBox[{"row2", "\[Rule]", "row1"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"rightorder", "=", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{"Length", "[", "matrix", "]"}], "]"}], "/.", "rule"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"ii", "=", "1"}], ",", 
         RowBox[{"ii", "<", 
          RowBox[{
           RowBox[{"Length", "[", "rightorder", "]"}], "+", "1"}]}], ",", 
         RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"newmat", "[", 
            RowBox[{"[", "ii", "]"}], "]"}], "=", 
           RowBox[{"matrix", "[", 
            RowBox[{"[", 
             RowBox[{"rightorder", "[", 
              RowBox[{"[", "ii", "]"}], "]"}], "]"}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "newmat"}]}], "\[IndentingNewLine]", "]"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"SKIPPED", ",", " ", 
    RowBox[{"CAN", " ", "BE", " ", "DONE", " ", 
     RowBox[{"WITH", " ", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", 
        RowBox[{"{", 
         RowBox[{"...", ",", "col2", ",", "...", ",", "col1", ",", "..."}], 
         "}"}]}], "]"}], "]"}]}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Calculates", " ", "all", " ", "perfect", " ", "matchings"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"kasteleyn", "[", 
     RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "K0full", ",", "K0flatX", ",", "dupl", ",", "dupllist", ",", "bnset", 
        ",", "bnlength", ",", "cnset", ",", "cnlength", ",", "cnsub", ",", 
        "bnsub", ",", "i", ",", "j", ",", "totrow", ",", "totcol", ",", 
        "colsurplus", ",", "rowsurplus", ",", "num", ",", "contr", ",", 
        "bnew", ",", "cnew", ",", "dnew", ",", "part1", ",", "part2", ",", 
        "added", ",", "kk", ",", "finalcontr", ",", "finaladd", ",", "p", ",",
         "X", ",", "BigP", ",", "Pext", ",", "Pint", ",", "ai", ",", "ji", 
        ",", "jir", ",", "signs", ",", "ii", ",", "rowguys", ",", "relguy", 
        ",", "found", ",", "jj"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"K0full", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{"a", ",", "c"}], "]"}], ",", 
          RowBox[{"Join", "[", 
           RowBox[{"b", ",", "d"}], "]"}], ",", "2"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<\!\(\*SubscriptBox[\(K\), \(0\)]\) = \>\"", ",", 
         RowBox[{"K0full", "//", "MatrixForm"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Check", " ", "that", " ", "a", " ", "field", " ", 
         RowBox[{"hasn", "'"}], "t", " ", "been", " ", "entered", " ", "in", 
         " ", 
         RowBox[{"twice", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"K0flatX", "=", 
        RowBox[{"Sort", "[", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", "K0full", "]"}], ",", "0"}], "]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"K0flatX", "=", 
        RowBox[{"Sequence", "@@@", 
         RowBox[{"(", 
          RowBox[{"MapThread", "[", 
           RowBox[{"MonomialList", ",", 
            RowBox[{"{", "K0flatX", "}"}]}], "]"}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Made", " ", "a", " ", "list", " ", "with", " ", "all", " ", 
         "variables", " ", "in", " ", 
         SubscriptBox["K", "0"], " ", "excluding", " ", "zeroes"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"dupl", "=", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Split", "[", 
           RowBox[{"Sort", "[", "K0flatX", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "#", "]"}], "\[GreaterEqual]", "2"}], 
           "&"}]}], "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{"These", " ", "are", " ", "the", " ", 
         RowBox[{"duplicates", "!"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"dupllist", "=", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"Flatten", "[", "dupl", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "dupl", "]"}], "\[NotEqual]", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "Print", "[", 
           "\"\<In \!\(\*SubscriptBox[\(K\), \(0\)]\) there are several \
fields with the same name!!! ERROR\>\"", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<The duplicated fields are \>\"", ",", "dupllist"}], 
           "]"}], ";"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "Print", "[", "\"\<Matrix is OK, there are no doubles.\>\"", "]"}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Consistency", " ", 
         RowBox[{"check", ":", " ", 
          RowBox[{
          "see", " ", "whether", " ", "the", " ", "rows", " ", "have", " ", 
           "cyclic", " ", 
           RowBox[{"indices", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"ii", "=", "1"}], ",", 
         RowBox[{"ii", "<", 
          RowBox[{
           RowBox[{"Length", "[", "K0full", "]"}], "+", "1"}]}], ",", 
         RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"rowguys", "=", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{
             RowBox[{"K0full", "[", 
              RowBox[{"[", "ii", "]"}], "]"}], ",", "0"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"rowguys", "=", 
           RowBox[{"Sequence", "@@@", 
            RowBox[{"(", 
             RowBox[{"MapThread", "[", 
              RowBox[{"MonomialList", ",", 
               RowBox[{"{", "rowguys", "}"}]}], "]"}], ")"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"relguy", "=", 
           RowBox[{"rowguys", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"rowguys", "=", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{"rowguys", ",", "relguy"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{"rowguys", "\[NotEqual]", 
             RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"found", "=", "0"}], ";", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"jj", "=", "1"}], ",", 
               RowBox[{"jj", "<", 
                RowBox[{
                 RowBox[{"Length", "[", "rowguys", "]"}], "+", "1"}]}], ",", 
               RowBox[{"jj", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"sub1", "[", 
                    RowBox[{"rowguys", "[", 
                    RowBox[{"[", "jj", "]"}], "]"}], "]"}], "\[Equal]", 
                   RowBox[{"sub2", "[", "relguy", "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"found", "=", "1"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"relguy", "=", 
                    RowBox[{"rowguys", "[", 
                    RowBox[{"[", "jj", "]"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"rowguys", "=", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{"rowguys", ",", 
                    RowBox[{"rowguys", "[", 
                    RowBox[{"[", "jj", "]"}], "]"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", 
                 "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"If", " ", "the", " ", "guy", " ", 
                RowBox[{"we", "'"}], "re", " ", "looking", " ", "for", " ", 
                RowBox[{"doesn", "'"}], "t", " ", "exist"}], ",", " ", 
               RowBox[{"say", " ", "so"}]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"found", "\[Equal]", "0"}], ",", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{
                 "\"\<Mistake in row \>\"", ",", "ii", ",", 
                  "\"\< of Kasteleyn! Someone has a wrong name, or there's an \
extra field.\>\""}], "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}],
              ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Consistency", " ", 
         RowBox[{"check", ":", " ", 
          RowBox[{
          "now", " ", "check", " ", "the", " ", "indices", " ", "of", " ", 
           "the", " ", 
           RowBox[{"columns", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"ii", "=", "1"}], ",", 
         RowBox[{"ii", "<", 
          RowBox[{
           RowBox[{
            RowBox[{"Dimensions", "[", "K0full", "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "+", "1"}]}], ",", 
         RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"rowguys", "=", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Transpose", "[", "K0full", "]"}], "[", 
              RowBox[{"[", "ii", "]"}], "]"}], ",", "0"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"rowguys", "=", 
           RowBox[{"Sequence", "@@@", 
            RowBox[{"(", 
             RowBox[{"MapThread", "[", 
              RowBox[{"MonomialList", ",", 
               RowBox[{"{", "rowguys", "}"}]}], "]"}], ")"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"relguy", "=", 
           RowBox[{"rowguys", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"rowguys", "=", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{"rowguys", ",", "relguy"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{"rowguys", "\[NotEqual]", 
             RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"found", "=", "0"}], ";", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"jj", "=", "1"}], ",", 
               RowBox[{"jj", "<", 
                RowBox[{
                 RowBox[{"Length", "[", "rowguys", "]"}], "+", "1"}]}], ",", 
               RowBox[{"jj", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"sub1", "[", 
                    RowBox[{"rowguys", "[", 
                    RowBox[{"[", "jj", "]"}], "]"}], "]"}], "\[Equal]", 
                   RowBox[{"sub2", "[", "relguy", "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"found", "=", "1"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"relguy", "=", 
                    RowBox[{"rowguys", "[", 
                    RowBox[{"[", "jj", "]"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"rowguys", "=", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{"rowguys", ",", 
                    RowBox[{"rowguys", "[", 
                    RowBox[{"[", "jj", "]"}], "]"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", 
                 "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"If", " ", "the", " ", "guy", " ", 
                RowBox[{"we", "'"}], "re", " ", "looking", " ", "for", " ", 
                RowBox[{"doesn", "'"}], "t", " ", "exist"}], ",", " ", 
               RowBox[{"say", " ", "so"}]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"found", "\[Equal]", "0"}], ",", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{
                 "\"\<Mistake in column \>\"", ",", "ii", ",", 
                  "\"\< of Kasteleyn! Someone has a wrong name, or there's an \
extra field.\>\""}], "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}],
              ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Makes", " ", "the", " ", "sets", " ", "that", " ", "will", " ", 
         "number", " ", "the", " ", "rows", " ", "and", " ", "columns"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"bnset", "=", 
        RowBox[{"Range", "[", 
         RowBox[{
          RowBox[{"Dimensions", "[", "b", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Makes", " ", "a", " ", "list", " ", "1"}], ",", "2", ",", 
         RowBox[{
         "..", " ", "up", " ", "to", " ", "the", " ", "number", " ", "of", 
          " ", "external", " ", "nodes"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"bnlength", "=", 
        RowBox[{"Length", "[", "bnset", "]"}]}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{"gives", " ", "the", " ", "last", " ", "element"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"cnset", "=", 
        RowBox[{"Range", "[", 
         RowBox[{
          RowBox[{"Dimensions", "[", "c", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"cnlength", "=", 
        RowBox[{"Length", "[", "cnset", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Take", " ", "all", " ", "possible", " ", "subsets", " ", "and", " ", 
         "number", " ", "them"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{"cnlength", "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           SubscriptBox["cnsub", "i"], "=", 
           RowBox[{"Subsets", "[", 
            RowBox[{"cnset", ",", 
             RowBox[{"{", "i", "}"}]}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{"bnlength", "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           SubscriptBox["bnsub", "i"], "=", 
           RowBox[{"Subsets", "[", 
            RowBox[{"bnset", ",", 
             RowBox[{"{", "i", "}"}]}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Give", " ", "the", " ", "ith", " ", "row", " ", "and", " ", "the", 
         " ", "jth", " ", "column", " ", "a", " ", "name"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{"cnlength", "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           SubscriptBox["c", "i"], "=", 
           RowBox[{"Take", "[", 
            RowBox[{"c", ",", 
             RowBox[{"{", "i", "}"}]}], "]"}]}], ";"}]}], " ", 
        RowBox[{"(*", 
         RowBox[{"Is", " ", "the", " ", 
          SubscriptBox["c", "i"], " ", "th", " ", "row"}], "*)"}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "<", 
          RowBox[{"bnlength", "+", "1"}]}], ",", 
         RowBox[{"j", "++"}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           SubscriptBox["b", "j"], "=", 
           RowBox[{"Take", "[", 
            RowBox[{"b", ",", "All", ",", 
             RowBox[{"{", "j", "}"}]}], "]"}]}], ";"}]}], " ", 
        RowBox[{"(*", 
         RowBox[{"Is", " ", "the", " ", 
          SubscriptBox["b", "j"], " ", "th", " ", "column"}], "*)"}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"If", " ", "the", " ", "Kasteleyn", " ", "matrix", " ", 
          RowBox[{"isn", "'"}], "t", " ", "square"}], ",", " ", 
         RowBox[{
          RowBox[{"we", "'"}], "ll", " ", "need", " ", "to", " ", "remove", 
          " ", "more", " ", "columns", " ", "than", " ", "rows", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"or", " ", "vice"}], "-", "versa"}], ")"}], "."}]}]}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"totrow", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Dimensions", "[", "a", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", 
         RowBox[{
          RowBox[{"Dimensions", "[", "c", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"totcol", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Dimensions", "[", "a", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "+", 
         RowBox[{
          RowBox[{"Dimensions", "[", "b", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"totcol", "-", "totrow"}], "\[GreaterEqual]", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"colsurplus", "=", 
           RowBox[{"totcol", "-", "totrow"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"rowsurplus", "=", "0"}], ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{
          RowBox[{"rowsurplus", "=", 
           RowBox[{"totrow", "-", "totcol"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"colsurplus", "=", "0"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"num", "=", "1"}], ",", 
         RowBox[{"num", "<", 
          RowBox[{
           RowBox[{"Min", "[", 
            RowBox[{"bnlength", ",", "cnlength"}], "]"}], "+", "1"}]}], ",", 
         RowBox[{"num", "++"}], ",", " ", 
         RowBox[{"(*", 
          RowBox[{
          "num", " ", "is", " ", "the", " ", "number", " ", "of", " ", "rows",
            " ", "or", " ", "columns", " ", "that", " ", "are", " ", 
           "removed", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"can", "'"}], "t", " ", "remove", " ", "more", " ", 
              "than", " ", "all", " ", "external", " ", "rows", " ", "or", 
              " ", 
              RowBox[{"columns", ":", " ", 
               RowBox[{
               "this", " ", "sets", " ", "when", " ", "to", " ", "stop", " ", 
                "num"}]}]}], ")"}], "."}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           SubscriptBox["contr", "num"], "=", "0"}], ";", " ", 
          RowBox[{"(*", 
           RowBox[{
           "The", " ", "contribution", " ", "to", " ", "perf", " ", "with", 
            " ", "num", " ", "rows", " ", "and", " ", "columns", " ", 
            RowBox[{"removed", "."}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"i", "=", "1"}], ",", 
            RowBox[{"i", "<", 
             RowBox[{
              RowBox[{
               RowBox[{"Dimensions", "[", 
                SubscriptBox["cnsub", 
                 RowBox[{"num", "+", "rowsurplus"}]], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], ",", 
            RowBox[{"i", "++"}], ",", " ", 
            RowBox[{"(*", 
             RowBox[{"Counts", " ", "row", " ", "scenarios"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"j", "=", "1"}], ",", 
               RowBox[{"j", "<", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Dimensions", "[", 
                   SubscriptBox["bnsub", 
                    RowBox[{"num", "+", "colsurplus"}]], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], ",", 
               RowBox[{"j", "++"}], ",", " ", 
               RowBox[{"(*", 
                RowBox[{"Counts", " ", "column", " ", "scenarios"}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"bnew", "=", "b"}], ";", "\[IndentingNewLine]", 
                RowBox[{"cnew", "=", "c"}], ";", "\[IndentingNewLine]", 
                RowBox[{"dnew", "=", "d"}], ";", "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"kk", "=", "1"}], ",", 
                  RowBox[{"kk", " ", "<", " ", 
                   RowBox[{"(", 
                    RowBox[{"num", "+", "colsurplus", "+", "1"}], ")"}]}], 
                  ",", " ", 
                  RowBox[{"kk", "++"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"bnew", "=", 
                    RowBox[{"Drop", "[", 
                    RowBox[{"bnew", ",", "None", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["bnsub", 
                    RowBox[{"num", "+", "colsurplus"}]], "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "kk"}], "]"}], "]"}], "-", "kk", "+", 
                    "1"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                   RowBox[{"dnew", "=", 
                    RowBox[{"Drop", "[", 
                    RowBox[{"dnew", ",", "None", ",", 
                    RowBox[{"{", "1", "}"}]}], "]"}]}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"kk", "=", "1"}], ",", 
                  RowBox[{"kk", " ", "<", " ", 
                   RowBox[{"(", 
                    RowBox[{"num", "+", "rowsurplus", "+", "1"}], ")"}]}], 
                  ",", " ", 
                  RowBox[{"kk", "++"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"cnew", "=", 
                    RowBox[{"Drop", "[", 
                    RowBox[{"cnew", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["cnsub", 
                    RowBox[{"num", "+", "rowsurplus"}]], "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "kk"}], "]"}], "]"}], "-", "kk", "+", 
                    "1"}], "}"}], ",", "None"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"dnew", "=", 
                    RowBox[{"Drop", "[", 
                    RowBox[{"dnew", ",", 
                    RowBox[{"{", "1", "}"}], ",", "None"}], "]"}]}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Dimensions", "[", "cnew", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[NotEqual]", " ", "0"}],
                   ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"part1", "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{"a", ",", "cnew"}], "]"}]}], ";"}], ",", 
                  RowBox[{
                   RowBox[{"part1", "=", "a"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Dimensions", "[", "bnew", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "\[NotEqual]", " ", "0"}],
                   ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"part2", "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{"bnew", ",", "dnew"}], "]"}]}], ";"}], ",", 
                  RowBox[{
                   RowBox[{"part2", "=", 
                    RowBox[{"{", 
                    RowBox[{"{", "}"}], "}"}]}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Dimensions", "[", "part2", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "\[NotEqual]", "0"}], ",",
                   "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["added", "num"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{"part1", ",", "part2", ",", "2"}], "]"}]}], ";"}],
                   " ", ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["added", "num"], "=", "part1"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{"This", " ", "is", " ", "the", " ", "correct", " ", 
                  RowBox[{"matrix", "!"}]}], "*)"}], "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{
                 SubscriptBox["contr", "num"], "=", 
                 RowBox[{
                  SubscriptBox["contr", "num"], "+", 
                  RowBox[{"Det", "[", 
                   SubscriptBox["added", "num"], "]"}]}]}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Now", " ", "have", " ", "added", " ", "all", " ", "the", " ", 
         "contributions", " ", "when", " ", "we", " ", "removed", " ", "rows",
          " ", "and", " ", 
         RowBox[{"columns", ".", " ", "Have"}], " ", "to", " ", "still", " ", 
         "consider", " ", "the", " ", "contribution", " ", "where", " ", "we",
          " ", "remove", " ", "zero", " ", "rows", " ", 
         RowBox[{"or", "/", "and"}], " ", "zero", " ", 
         RowBox[{"columns", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"totcol", "-", "totrow"}], "\[Equal]", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "If", " ", "we", " ", "have", " ", "the", " ", "same", " ", 
            "number", " ", "of", " ", "rows", " ", "and", " ", "columns"}], 
           ",", " ", 
           RowBox[{
           "K0", " ", "is", " ", "already", " ", "a", " ", "square", " ", 
            "matrix"}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"finalcontr", "=", 
           RowBox[{"Det", "[", "K0full", "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"totcol", "-", "totrow"}], ">", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"finalcontr", "=", "0"}], ";", " ", 
          RowBox[{"(*", 
           RowBox[{
           "The", " ", "contribution", " ", "to", " ", "perf", " ", "with", 
            " ", "num", " ", "rows", " ", "and", " ", "columns", " ", 
            RowBox[{"removed", "."}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "<", 
             RowBox[{
              RowBox[{
               RowBox[{"Dimensions", "[", 
                SubscriptBox["bnsub", "colsurplus"], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], ",", 
            RowBox[{"j", "++"}], ",", " ", 
            RowBox[{"(*", 
             RowBox[{"Counts", " ", "column", " ", "scenarios"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"bnew", "=", "b"}], ";", "\[IndentingNewLine]", 
             RowBox[{"cnew", "=", "c"}], ";", "\[IndentingNewLine]", 
             RowBox[{"dnew", "=", "d"}], ";", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"kk", "=", "1"}], ",", 
               RowBox[{"kk", " ", "<", " ", 
                RowBox[{"(", 
                 RowBox[{"colsurplus", "+", "1"}], ")"}]}], ",", " ", 
               RowBox[{"kk", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"bnew", "=", 
                 RowBox[{"Drop", "[", 
                  RowBox[{"bnew", ",", "None", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["bnsub", "colsurplus"], "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "kk"}], "]"}], "]"}], "-", "kk", "+", 
                    "1"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"dnew", "=", 
                 RowBox[{"Drop", "[", 
                  RowBox[{"dnew", ",", "None", ",", 
                   RowBox[{"{", "1", "}"}]}], "]"}]}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Dimensions", "[", "cnew", "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "\[NotEqual]", " ", "0"}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"part1", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{"a", ",", "cnew"}], "]"}]}], ";"}], ",", 
               RowBox[{
                RowBox[{"part1", "=", "a"}], ";"}]}], "\[IndentingNewLine]", 
              "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Dimensions", "[", "bnew", "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "\[NotEqual]", " ", "0"}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"part2", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{"bnew", ",", "dnew"}], "]"}]}], ";"}], ",", 
               RowBox[{
                RowBox[{"part2", "=", 
                 RowBox[{"{", 
                  RowBox[{"{", "}"}], "}"}]}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Dimensions", "[", "part2", "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "\[NotEqual]", "0"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"finaladd", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{"part1", ",", "part2", ",", "2"}], "]"}]}], ";"}], 
               " ", ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"finaladd", "=", "part1"}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"This", " ", "is", " ", "the", " ", "correct", " ", 
               RowBox[{"matrix", "!"}]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"finalcontr", "=", 
              RowBox[{"finalcontr", "+", 
               RowBox[{"Det", "[", "finaladd", "]"}]}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"totrow", "-", "totcol"}], ">", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"finalcontr", "=", "0"}], ";", " ", 
          RowBox[{"(*", 
           RowBox[{
           "The", " ", "contribution", " ", "to", " ", "perf", " ", "with", 
            " ", "num", " ", "rows", " ", "and", " ", "columns", " ", 
            RowBox[{"removed", "."}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"i", "=", "1"}], ",", 
            RowBox[{"i", "<", 
             RowBox[{
              RowBox[{
               RowBox[{"Dimensions", "[", 
                SubscriptBox["cnsub", "rowsurplus"], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], ",", 
            RowBox[{"i", "++"}], ",", " ", 
            RowBox[{"(*", 
             RowBox[{"Counts", " ", "row", " ", "scenarios"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"bnew", "=", "b"}], ";", "\[IndentingNewLine]", 
             RowBox[{"cnew", "=", "c"}], ";", "\[IndentingNewLine]", 
             RowBox[{"dnew", "=", "d"}], ";", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"kk", "=", "1"}], ",", 
               RowBox[{"kk", " ", "<", " ", 
                RowBox[{"(", 
                 RowBox[{"rowsurplus", "+", "1"}], ")"}]}], ",", " ", 
               RowBox[{"kk", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"cnew", "=", 
                 RowBox[{"Drop", "[", 
                  RowBox[{"cnew", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["cnsub", "rowsurplus"], "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "kk"}], "]"}], "]"}], "-", "kk", "+", 
                    "1"}], "}"}], ",", "None"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"dnew", "=", 
                 RowBox[{"Drop", "[", 
                  RowBox[{"dnew", ",", 
                   RowBox[{"{", "1", "}"}], ",", "None"}], "]"}]}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Dimensions", "[", "cnew", "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "\[NotEqual]", " ", "0"}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"part1", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{"a", ",", "cnew"}], "]"}]}], ";"}], ",", 
               RowBox[{
                RowBox[{"part1", "=", "a"}], ";"}]}], "\[IndentingNewLine]", 
              "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Dimensions", "[", "bnew", "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "\[NotEqual]", " ", "0"}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"part2", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{"bnew", ",", "dnew"}], "]"}]}], ";"}], ",", 
               RowBox[{
                RowBox[{"part2", "=", 
                 RowBox[{"{", 
                  RowBox[{"{", "}"}], "}"}]}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Dimensions", "[", "part2", "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "\[NotEqual]", "0"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"finaladd", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{"part1", ",", "part2", ",", "2"}], "]"}]}], ";"}], 
               " ", ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"finaladd", "=", "part1"}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"This", " ", "is", " ", "the", " ", "correct", " ", 
               RowBox[{"matrix", "!"}]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"finalcontr", "=", 
              RowBox[{"finalcontr", "+", 
               RowBox[{"Det", "[", "finaladd", "]"}]}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"perf", "=", 
        RowBox[{"finalcontr", "+", 
         RowBox[{"Sum", "[", 
          RowBox[{
           SubscriptBox["contr", "i"], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Min", "[", 
              RowBox[{"bnlength", ",", "cnlength"}], "]"}]}], "}"}]}], 
          "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<There are \>\"", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"MonomialList", "[", "perf", "]"}], "]"}], ",", 
         "\"\< perfect matchings.\>\""}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"plist", "=", 
        RowBox[{"MonomialList", "[", "perf", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Xlist", "=", 
        RowBox[{"Variables", "[", "perf", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "<", 
          RowBox[{
           RowBox[{"Length", "[", "plist", "]"}], "+", "1"}]}], ",", 
         RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           SubscriptBox["p", "j"], "=", 
           RowBox[{"plist", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", "Xlist", "]"}], "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           SubscriptBox["X", "i"], "=", 
           RowBox[{"Xlist", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", "Xlist", "]"}], "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "<", 
             RowBox[{
              RowBox[{"Length", "[", "plist", "]"}], "+", "1"}]}], ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"D", "[", 
                RowBox[{
                 SubscriptBox["p", "j"], ",", 
                 SubscriptBox["X", "i"]}], "]"}], "\[Equal]", "0"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                SubscriptBox["BigP", 
                 RowBox[{"i", ",", "j"}]], "=", "0"}], ";"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                SubscriptBox["BigP", 
                 RowBox[{"i", ",", "j"}]], "=", "1"}], ";"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                SubscriptBox["BigP", 
                 RowBox[{"i", ",", "j"}]], "=", "1"}], ";"}]}], 
             "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"P", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          SubscriptBox["BigP", 
           RowBox[{"i", ",", "j"}]], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "Xlist", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"Length", "[", "plist", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Now", " ", 
         RowBox[{"we", "'"}], "ll", " ", "rearrange", " ", "P", " ", "in", 
         " ", "a", " ", "nice", " ", "way"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"xb", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"DeleteCases", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", "b", "]"}], ",", "0"}], "]"}], ",", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", "c", "]"}], ",", "0"}], "]"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Pext", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Pint", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"ai", "=", "1"}], ",", 
         RowBox[{"ai", "<", 
          RowBox[{
           RowBox[{"Length", "[", "Xlist", "]"}], "+", "1"}]}], ",", 
         RowBox[{"ai", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"xb", ",", 
              RowBox[{"Xlist", "[", 
               RowBox[{"[", "ai", "]"}], "]"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Pext", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"Pext", ",", 
                RowBox[{"{", "ai", "}"}]}], "]"}]}], ";"}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{
             RowBox[{"Pint", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"Pint", ",", 
                RowBox[{"{", "ai", "}"}]}], "]"}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Now", " ", "we", " ", "know", " ", "which", " ", "rows", " ", "we", 
         " ", "need", " ", "to", " ", "select", " ", "from", " ", "P"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"moduliP", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Xmoduli", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"ji", "=", "1"}], ",", 
         RowBox[{"ji", "<", 
          RowBox[{
           RowBox[{"Length", "[", "Pext", "]"}], "+", "1"}]}], ",", 
         RowBox[{"ji", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"moduliP", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"moduliP", ",", 
             RowBox[{"Take", "[", 
              RowBox[{"P", ",", 
               RowBox[{"{", 
                RowBox[{"Pext", "[", 
                 RowBox[{"[", "ji", "]"}], "]"}], "}"}]}], "]"}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"Xmoduli", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"Xmoduli", ",", 
             RowBox[{"Take", "[", 
              RowBox[{"Xlist", ",", 
               RowBox[{"{", 
                RowBox[{"Pext", "[", 
                 RowBox[{"[", "ji", "]"}], "]"}], "}"}]}], "]"}]}], "]"}]}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"moduliP", "\[Equal]", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{
          RowBox[{"moduliP", "=", 
           RowBox[{"{", 
            RowBox[{"{", "}"}], "}"}]}], ";"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"remainingP", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Xremain", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"jir", "=", "1"}], ",", 
         RowBox[{"jir", "<", 
          RowBox[{
           RowBox[{"Length", "[", "Pint", "]"}], "+", "1"}]}], ",", 
         RowBox[{"jir", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"remainingP", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"remainingP", ",", 
             RowBox[{"Take", "[", 
              RowBox[{"P", ",", 
               RowBox[{"{", 
                RowBox[{"Pint", "[", 
                 RowBox[{"[", "jir", "]"}], "]"}], "}"}]}], "]"}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"Xremain", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"Xremain", ",", 
             RowBox[{"Take", "[", 
              RowBox[{"Xlist", ",", 
               RowBox[{"{", 
                RowBox[{"Pint", "[", 
                 RowBox[{"[", "jir", "]"}], "]"}], "}"}]}], "]"}]}], "]"}]}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"remainingP", "\[Equal]", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{
          RowBox[{"remainingP", "=", 
           RowBox[{"{", 
            RowBox[{"{", "}"}], "}"}]}], ";"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"P", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"remainingP", ",", "moduliP"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Xlist", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"Xremain", ",", "Xmoduli"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", "\"\<-------------------------------------\>\"", "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Now", " ", "make", " ", "the", " ", "perfect", " ", "matchings", " ",
          "in", " ", "plist", " ", "manifestly", " ", "positive"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"signs", "=", 
        RowBox[{"plist", "/.", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Xlist", "[", 
             RowBox[{"[", "ii", "]"}], "]"}], "\[Rule]", "1"}], ",", 
           RowBox[{"{", 
            RowBox[{"ii", ",", 
             RowBox[{"Length", "[", "Xlist", "]"}]}], "}"}]}], "]"}]}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"plist", "=", 
        RowBox[{"plist", "*", "signs"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", 
        "\"\<Variables are 'perf'=determinant of Kasteleyn matrix; \
'plist'=list of perfect matchings; 'P'=perfect matching matrix; \
'Xlist'=fields corresponding to the rows of P; 'moduliP'=P but only with rows \
corresponding to external \!\(\*SubscriptBox[\(X\), \(i, j\)]\)'s; \
'remainingP'=P but only with rows corresponding to internal \
\!\(\*SubscriptBox[\(X\), \(i, j\)]\)'s; similarly for Xremain and Xmoduli; \
'xb'=list of external fields;\>\"", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", "\"\<-------------------------------------\>\"", "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "In", " ", "case", " ", "we", " ", "had", " ", "zero", " ", 
         "boundaries"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"moduliP", "\[Equal]", 
          RowBox[{"{", 
           RowBox[{"{", "}"}], "}"}]}], ",", 
         RowBox[{
          RowBox[{"moduliP", "=", 
           RowBox[{"{", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"0", ",", 
              RowBox[{
               RowBox[{"Dimensions", "[", "remainingP", "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "}"}]}], ";", 
          RowBox[{"P", "=", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{"P", ",", 
             RowBox[{"{", "}"}]}], "]"}]}], ";"}]}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"DONE", ",", " ", 
    RowBox[{"NOW", " ", "CALLED", " ", 
     RowBox[{"perfectMatchings", ".", " ", "SOME"}], " ", "FUNCTIONALITY", 
     " ", "IS", " ", "IN", " ", "getPmatrix", " ", "AND", " ", 
     RowBox[{"matroidPolytope", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Calculates", " ", "the", " ", "moduli", " ", "space", " ", "using", " ", 
    "Gauging", " ", "2", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"using", " ", "the", " ", "superslick", " ", "method"}], ")"}], 
     "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"moduliGauging2", "[", 
     RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"kasteleyn", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Gmaster", "=", 
       RowBox[{"DeleteCases", "[", 
        RowBox[{
         RowBox[{"RowReduce", "[", "P", "]"}], ",", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", 
           RowBox[{
            RowBox[{"Dimensions", "[", "P", "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<The Master space is \>\"", ",", 
        RowBox[{"BFTdim", "[", "Gmaster", "]"}], ",", 
        "\"\<-dimensional. (NB This is the dimension of its toric \
diagram!).\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Gmoduli", "=", "moduliP"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<G = \>\"", ",", 
        RowBox[{"Gmoduli", "//", "MatrixForm"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<The moduli space is \>\"", ",", 
        RowBox[{"BFTdim", "[", "Gmoduli", "]"}], ",", 
        "\"\<-dimensional. (NB This is the dimension of its toric \
diagram!).\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Now", " ", "group", " ", "the", " ", "multiplicities", " ", "of", " ",
         "G", " ", 
        RowBox[{"together", "."}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Gshort", "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"Transpose", "[", "Gmoduli", "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Multmatrix", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Dimensions", "[", 
           RowBox[{
            RowBox[{"Gather", "[", 
             RowBox[{"Transpose", "[", "Gmoduli", "]"}], "]"}], "[", 
            RowBox[{"[", "y", "]"}], "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"y", ",", 
           RowBox[{
            RowBox[{"Dimensions", "[", 
             RowBox[{"Gather", "[", 
              RowBox[{"Transpose", "[", "Gmoduli", "]"}], "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
      "Print", "[", "\"\<-------------------------------------\>\"", "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
      "Print", "[", 
       "\"\<Variables are 'Gmaster'=master space; 'Gmoduli'=moduli space; \
'Gshort'=moduli space where doubles have been removed; \
'Multmatrix'=moultiplicity of each point in Gshort;\>\"", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
      "Print", "[", "\"\<-------------------------------------\>\"", "]"}], 
      ";"}], "\[IndentingNewLine]", ")"}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"DONE", " ", 
     RowBox[{"(", 
      RowBox[{"SIMILAR", " ", "BUT", " ", "DIFFERENT"}], ")"}]}], ",", " ", 
    RowBox[{"NOW", " ", "CALLED", " ", 
     RowBox[{"matroidPolytope", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Compares", " ", "Gauging", " ", "2", " ", "calculated", " ", "using", " ",
     "the", " ", "superslick", " ", "method", " ", "with", " ", "the", " ", 
    "old", " ", "method", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"using", " ", "charge", " ", "matrices"}], ")"}], "."}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"compareGauging2", "[", 
     RowBox[{"addgauge_", ",", "zed_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "IF", ",", "NF", ",", "i", ",", "j", ",", "k", ",", "mem", ",", "memz",
         ",", "Delta", ",", "QDT", ",", "QDTlist", ",", "solution", ",", 
        "newQDTlist", ",", "Q", ",", "subtract", ",", "transGmoduliold", ",", 
        "multold", ",", "temp"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"QF", "=", 
        RowBox[{"NullSpace", "[", "P", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"NF", "=", 
        RowBox[{"totFaces", "[", 
         RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"IF", "=", 
        RowBox[{"internalFaces", "[", 
         RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<\!\(\*SubscriptBox[\(Q\), \(F\)]\) = \>\"", ",", 
          RowBox[{"QF", "//", "MatrixForm"}]}], "]"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"First", " ", "make", " ", "Delta"}], ",", " ", 
         RowBox[{
          RowBox[{"then", " ", "plug", " ", "in", " ", "the", " ", "non"}], 
          "-", 
          RowBox[{"zero", " ", 
           RowBox[{"numbers", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Delta", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{"Length", "[", "Xlist", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", 
            RowBox[{"IF", "+", 
             RowBox[{"Length", "[", "addgauge", "]"}], "+", 
             RowBox[{"Length", "[", "zed", "]"}]}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Now", " ", "fill", " ", "in", " ", "the", " ", "non"}], "=", 
         RowBox[{"zero", " ", "numbers"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{"NF", "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "<", 
             RowBox[{"NF", "+", "1"}]}], ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"Take", " ", "a", " ", "specific", " ", 
              SubscriptBox["X", 
               RowBox[{"i", ",", "j"}]], " ", "or", " ", 
              SubscriptBox["Y", 
               RowBox[{"i", ",", "j"}]], " ", 
              RowBox[{"etc", ".", " ", "and"}], " ", "check", " ", "if", " ", 
              RowBox[{"it", "'"}], "s", " ", "in", " ", 
              RowBox[{"Xlist", "."}]}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"i", "\[NotEqual]", "j"}], ",", " ", 
               RowBox[{"(*", 
                RowBox[{
                 SubscriptBox["X", 
                  RowBox[{"i", ",", "i"}]], " ", 
                 RowBox[{"shouldn", "'"}], "t", " ", "be", " ", "nonzero"}], 
                "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"k", "=", "1"}], ",", 
                  RowBox[{"k", "<", 
                   RowBox[{
                    RowBox[{"Length", "[", "Xlist", "]"}], "+", "1"}]}], ",", 
                  RowBox[{"k", "++"}], ",", " ", 
                  RowBox[{"(*", 
                   RowBox[{
                   "Run", " ", "through", " ", "the", " ", "whole", " ", 
                    "Xlist"}], "*)"}], "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["X", 
                    RowBox[{"i", ",", "j"}]], "\[Equal]", 
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "&&", 
                    RowBox[{"i", "\[NotEqual]", "j"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i"}], "]"}], "]"}], "=", "1"}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"j", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{"-", "1"}]}], ";"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Check", " ", "whether", " ", "i", " ", "is", " ", "in", 
                    " ", "any", " ", "of", " ", "the", " ", "additional", " ",
                     "gaugings"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"mem", "=", "1"}], ",", 
                    RowBox[{"mem", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "1"}]}], 
                    ",", 
                    RowBox[{"mem", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"addgauge", "[", 
                    RowBox[{"[", "mem", "]"}], "]"}], ",", "i"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "+", "1"}]}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"addgauge", "[", 
                    RowBox[{"[", "mem", "]"}], "]"}], ",", "j"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "-", "1"}]}], 
                    ";"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Now", " ", "sort", " ", "out", " ", "the", " ", "zed", 
                    " ", "gaugings"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"memz", "=", "1"}], ",", 
                    RowBox[{"memz", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", "zed", "]"}], "+", "1"}]}], ",", 
                    RowBox[{"memz", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}], "]"}], ",", 
                    SubscriptBox["X", 
                    RowBox[{"i", ",", "j"}]]}], "]"}], ",", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{
                    "if", " ", "the", " ", "field", " ", "is", " ", "in", " ",
                     "the", " ", "zigzag"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"it", "'"}], "s"}], " ", "-", 
                    RowBox[{
                    "1", " ", "if", " ", "it", " ", "appears", " ", "on", " ",
                     "top", " ", "and"}], " ", "+", 
                    RowBox[{
                    "1", " ", "if", " ", "it", " ", "appears", " ", "on", " ",
                     "the", " ", "bottom"}]}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}], ",", 
                    SubscriptBox["X", 
                    RowBox[{"i", ",", "j"}]]}], "]"}], 
                    SubscriptBox["X", 
                    RowBox[{"i", ",", "j"}]]}], "\[Equal]", 
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}]}], ",", 
                    RowBox[{"(*", 
                    RowBox[{"appears", " ", "on", " ", "top"}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "-", "1"}]}], ";"}], ",", "True", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "+", "1"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["Y", 
                    RowBox[{"i", ",", "j"}]], "\[Equal]", 
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "&&", 
                    RowBox[{"i", "\[NotEqual]", "j"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i"}], "]"}], "]"}], "=", "1"}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"j", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{"-", "1"}]}], ";"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Check", " ", "whether", " ", "i", " ", "is", " ", "in", 
                    " ", "any", " ", "of", " ", "the", " ", "additional", " ",
                     "gaugings"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"mem", "=", "1"}], ",", 
                    RowBox[{"mem", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "1"}]}], 
                    ",", 
                    RowBox[{"mem", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"addgauge", "[", 
                    RowBox[{"[", "mem", "]"}], "]"}], ",", "i"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "+", "1"}]}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"addgauge", "[", 
                    RowBox[{"[", "mem", "]"}], "]"}], ",", "j"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "-", "1"}]}], 
                    ";"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Now", " ", "sort", " ", "out", " ", "the", " ", "zed", 
                    " ", "gaugings"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"memz", "=", "1"}], ",", 
                    RowBox[{"memz", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", "zed", "]"}], "+", "1"}]}], ",", 
                    RowBox[{"memz", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}], "]"}], ",", 
                    SubscriptBox["Y", 
                    RowBox[{"i", ",", "j"}]]}], "]"}], ",", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{
                    "if", " ", "the", " ", "field", " ", "is", " ", "in", " ",
                     "the", " ", "zigzag"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"it", "'"}], "s"}], " ", "-", 
                    RowBox[{
                    "1", " ", "if", " ", "it", " ", "appears", " ", "on", " ",
                     "top", " ", "and"}], " ", "+", 
                    RowBox[{"1", " ", "if", " ", "it", " ", "appears", " ", 
                    "on", " ", "the", " ", "bottom"}]}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}], ",", 
                    SubscriptBox["Y", 
                    RowBox[{"i", ",", "j"}]]}], "]"}], 
                    SubscriptBox["Y", 
                    RowBox[{"i", ",", "j"}]]}], "\[Equal]", 
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}]}], ",", 
                    RowBox[{"(*", 
                    RowBox[{"appears", " ", "on", " ", "top"}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "-", "1"}]}], ";"}], ",", "True", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "+", "1"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["Z", 
                    RowBox[{"i", ",", "j"}]], "\[Equal]", 
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "&&", 
                    RowBox[{"i", "\[NotEqual]", "j"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i"}], "]"}], "]"}], "=", "1"}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"j", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{"-", "1"}]}], ";"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Check", " ", "whether", " ", "i", " ", "is", " ", "in", 
                    " ", "any", " ", "of", " ", "the", " ", "additional", " ",
                     "gaugings"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"mem", "=", "1"}], ",", 
                    RowBox[{"mem", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "1"}]}], 
                    ",", 
                    RowBox[{"mem", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"addgauge", "[", 
                    RowBox[{"[", "mem", "]"}], "]"}], ",", "i"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "+", "1"}]}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"addgauge", "[", 
                    RowBox[{"[", "mem", "]"}], "]"}], ",", "j"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "-", "1"}]}], 
                    ";"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Now", " ", "sort", " ", "out", " ", "the", " ", "zed", 
                    " ", "gaugings"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"memz", "=", "1"}], ",", 
                    RowBox[{"memz", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", "zed", "]"}], "+", "1"}]}], ",", 
                    RowBox[{"memz", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}], "]"}], ",", 
                    SubscriptBox["Z", 
                    RowBox[{"i", ",", "j"}]]}], "]"}], ",", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{
                    "if", " ", "the", " ", "field", " ", "is", " ", "in", " ",
                     "the", " ", "zigzag"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"it", "'"}], "s"}], " ", "-", 
                    RowBox[{
                    "1", " ", "if", " ", "it", " ", "appears", " ", "on", " ",
                     "top", " ", "and"}], " ", "+", 
                    RowBox[{
                    "1", " ", "if", " ", "it", " ", "appears", " ", "on", " ",
                     "the", " ", "bottom"}]}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}], ",", 
                    SubscriptBox["Z", 
                    RowBox[{"i", ",", "j"}]]}], "]"}], 
                    SubscriptBox["Z", 
                    RowBox[{"i", ",", "j"}]]}], "\[Equal]", 
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}]}], ",", 
                    RowBox[{"(*", 
                    RowBox[{"appears", " ", "on", " ", "top"}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "-", "1"}]}], ";"}], ",", "True", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "+", "1"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["W", 
                    RowBox[{"i", ",", "j"}]], "\[Equal]", 
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "&&", 
                    RowBox[{"i", "\[NotEqual]", "j"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i"}], "]"}], "]"}], "=", "1"}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"j", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{"-", "1"}]}], ";"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Check", " ", "whether", " ", "i", " ", "is", " ", "in", 
                    " ", "any", " ", "of", " ", "the", " ", "additional", " ",
                     "gaugings"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"mem", "=", "1"}], ",", 
                    RowBox[{"mem", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "1"}]}], 
                    ",", 
                    RowBox[{"mem", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"addgauge", "[", 
                    RowBox[{"[", "mem", "]"}], "]"}], ",", "i"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "+", "1"}]}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"addgauge", "[", 
                    RowBox[{"[", "mem", "]"}], "]"}], ",", "j"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "-", "1"}]}], 
                    ";"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Now", " ", "sort", " ", "out", " ", "the", " ", "zed", 
                    " ", "gaugings"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"memz", "=", "1"}], ",", 
                    RowBox[{"memz", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", "zed", "]"}], "+", "1"}]}], ",", 
                    RowBox[{"memz", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}], "]"}], ",", 
                    SubscriptBox["W", 
                    RowBox[{"i", ",", "j"}]]}], "]"}], ",", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{
                    "if", " ", "the", " ", "field", " ", "is", " ", "in", " ",
                     "the", " ", "zigzag"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"it", "'"}], "s"}], " ", "-", 
                    RowBox[{
                    "1", " ", "if", " ", "it", " ", "appears", " ", "on", " ",
                     "top", " ", "and"}], " ", "+", 
                    RowBox[{
                    "1", " ", "if", " ", "it", " ", "appears", " ", "on", " ",
                     "the", " ", "bottom"}]}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}], ",", 
                    SubscriptBox["W", 
                    RowBox[{"i", ",", "j"}]]}], "]"}], 
                    SubscriptBox["W", 
                    RowBox[{"i", ",", "j"}]]}], "\[Equal]", 
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}]}], ",", 
                    RowBox[{"(*", 
                    RowBox[{"appears", " ", "on", " ", "top"}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "-", "1"}]}], ";"}], ",", "True", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "+", "1"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["V", 
                    RowBox[{"i", ",", "j"}]], "\[Equal]", 
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "&&", 
                    RowBox[{"i", "\[NotEqual]", "j"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i"}], "]"}], "]"}], "=", "1"}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"j", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{"-", "1"}]}], ";"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Check", " ", "whether", " ", "i", " ", "is", " ", "in", 
                    " ", "any", " ", "of", " ", "the", " ", "additional", " ",
                     "gaugings"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"mem", "=", "1"}], ",", 
                    RowBox[{"mem", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "1"}]}], 
                    ",", 
                    RowBox[{"mem", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"addgauge", "[", 
                    RowBox[{"[", "mem", "]"}], "]"}], ",", "i"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "+", "1"}]}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"addgauge", "[", 
                    RowBox[{"[", "mem", "]"}], "]"}], ",", "j"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "-", "1"}]}], 
                    ";"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Now", " ", "sort", " ", "out", " ", "the", " ", "zed", 
                    " ", "gaugings"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"memz", "=", "1"}], ",", 
                    RowBox[{"memz", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", "zed", "]"}], "+", "1"}]}], ",", 
                    RowBox[{"memz", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}], "]"}], ",", 
                    SubscriptBox["V", 
                    RowBox[{"i", ",", "j"}]]}], "]"}], ",", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{
                    "if", " ", "the", " ", "field", " ", "is", " ", "in", " ",
                     "the", " ", "zigzag"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"it", "'"}], "s"}], " ", "-", 
                    RowBox[{
                    "1", " ", "if", " ", "it", " ", "appears", " ", "on", " ",
                     "top", " ", "and"}], " ", "+", 
                    RowBox[{
                    "1", " ", "if", " ", "it", " ", "appears", " ", "on", " ",
                     "the", " ", "bottom"}]}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}], ",", 
                    SubscriptBox["V", 
                    RowBox[{"i", ",", "j"}]]}], "]"}], 
                    SubscriptBox["V", 
                    RowBox[{"i", ",", "j"}]]}], "\[Equal]", 
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}]}], ",", 
                    RowBox[{"(*", 
                    RowBox[{"appears", " ", "on", " ", "top"}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "-", "1"}]}], ";"}], ",", "True", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "+", "1"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["UU", 
                    RowBox[{"i", ",", "j"}]], "\[Equal]", 
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "&&", 
                    RowBox[{"i", "\[NotEqual]", "j"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i"}], "]"}], "]"}], "=", "1"}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"j", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{"-", "1"}]}], ";"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Check", " ", "whether", " ", "i", " ", "is", " ", "in", 
                    " ", "any", " ", "of", " ", "the", " ", "additional", " ",
                     "gaugings"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"mem", "=", "1"}], ",", 
                    RowBox[{"mem", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "1"}]}], 
                    ",", 
                    RowBox[{"mem", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"addgauge", "[", 
                    RowBox[{"[", "mem", "]"}], "]"}], ",", "i"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "+", "1"}]}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"addgauge", "[", 
                    RowBox[{"[", "mem", "]"}], "]"}], ",", "j"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "-", "1"}]}], 
                    ";"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Now", " ", "sort", " ", "out", " ", "the", " ", "zed", 
                    " ", "gaugings"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"memz", "=", "1"}], ",", 
                    RowBox[{"memz", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", "zed", "]"}], "+", "1"}]}], ",", 
                    RowBox[{"memz", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}], "]"}], ",", 
                    SubscriptBox["UU", 
                    RowBox[{"i", ",", "j"}]]}], "]"}], ",", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{
                    "if", " ", "the", " ", "field", " ", "is", " ", "in", " ",
                     "the", " ", "zigzag"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"it", "'"}], "s"}], " ", "-", 
                    RowBox[{
                    "1", " ", "if", " ", "it", " ", "appears", " ", "on", " ",
                     "top", " ", "and"}], " ", "+", 
                    RowBox[{
                    "1", " ", "if", " ", "it", " ", "appears", " ", "on", " ",
                     "the", " ", "bottom"}]}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}], ",", 
                    SubscriptBox["UU", 
                    RowBox[{"i", ",", "j"}]]}], "]"}], 
                    SubscriptBox["UU", 
                    RowBox[{"i", ",", "j"}]]}], "\[Equal]", 
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}]}], ",", 
                    RowBox[{"(*", 
                    RowBox[{"appears", " ", "on", " ", "top"}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "-", "1"}]}], ";"}], ",", "True", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "+", "1"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["XX", 
                    RowBox[{"i", ",", "j"}]], "\[Equal]", 
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "&&", 
                    RowBox[{"i", "\[NotEqual]", "j"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i"}], "]"}], "]"}], "=", "1"}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"j", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{"-", "1"}]}], ";"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Check", " ", "whether", " ", "i", " ", "is", " ", "in", 
                    " ", "any", " ", "of", " ", "the", " ", "additional", " ",
                     "gaugings"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"mem", "=", "1"}], ",", 
                    RowBox[{"mem", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "1"}]}], 
                    ",", 
                    RowBox[{"mem", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"addgauge", "[", 
                    RowBox[{"[", "mem", "]"}], "]"}], ",", "i"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "+", "1"}]}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"addgauge", "[", 
                    RowBox[{"[", "mem", "]"}], "]"}], ",", "j"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "-", "1"}]}], 
                    ";"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Now", " ", "sort", " ", "out", " ", "the", " ", "zed", 
                    " ", "gaugings"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"memz", "=", "1"}], ",", 
                    RowBox[{"memz", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", "zed", "]"}], "+", "1"}]}], ",", 
                    RowBox[{"memz", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}], "]"}], ",", 
                    SubscriptBox["XX", 
                    RowBox[{"i", ",", "j"}]]}], "]"}], ",", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{
                    "if", " ", "the", " ", "field", " ", "is", " ", "in", " ",
                     "the", " ", "zigzag"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"it", "'"}], "s"}], " ", "-", 
                    RowBox[{
                    "1", " ", "if", " ", "it", " ", "appears", " ", "on", " ",
                     "top", " ", "and"}], " ", "+", 
                    RowBox[{
                    "1", " ", "if", " ", "it", " ", "appears", " ", "on", " ",
                     "the", " ", "bottom"}]}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}], ",", 
                    SubscriptBox["XX", 
                    RowBox[{"i", ",", "j"}]]}], "]"}], 
                    SubscriptBox["XX", 
                    RowBox[{"i", ",", "j"}]]}], "\[Equal]", 
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}]}], ",", 
                    RowBox[{"(*", 
                    RowBox[{"appears", " ", "on", " ", "top"}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "-", "1"}]}], ";"}], ",", "True", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "+", "1"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["YY", 
                    RowBox[{"i", ",", "j"}]], "\[Equal]", 
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "&&", 
                    RowBox[{"i", "\[NotEqual]", "j"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i"}], "]"}], "]"}], "=", "1"}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"j", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{"-", "1"}]}], ";"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Check", " ", "whether", " ", "i", " ", "is", " ", "in", 
                    " ", "any", " ", "of", " ", "the", " ", "additional", " ",
                     "gaugings"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"mem", "=", "1"}], ",", 
                    RowBox[{"mem", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "1"}]}], 
                    ",", 
                    RowBox[{"mem", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"addgauge", "[", 
                    RowBox[{"[", "mem", "]"}], "]"}], ",", "i"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "+", "1"}]}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"addgauge", "[", 
                    RowBox[{"[", "mem", "]"}], "]"}], ",", "j"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", "mem"}]}], "]"}], "]"}], "-", "1"}]}], 
                    ";"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Now", " ", "sort", " ", "out", " ", "the", " ", "zed", 
                    " ", "gaugings"}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"memz", "=", "1"}], ",", 
                    RowBox[{"memz", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", "zed", "]"}], "+", "1"}]}], ",", 
                    RowBox[{"memz", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}], "]"}], ",", 
                    SubscriptBox["YY", 
                    RowBox[{"i", ",", "j"}]]}], "]"}], ",", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{
                    "if", " ", "the", " ", "field", " ", "is", " ", "in", " ",
                     "the", " ", "zigzag"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"it", "'"}], "s"}], " ", "-", 
                    RowBox[{
                    "1", " ", "if", " ", "it", " ", "appears", " ", "on", " ",
                     "top", " ", "and"}], " ", "+", 
                    RowBox[{
                    "1", " ", "if", " ", "it", " ", "appears", " ", "on", " ",
                     "the", " ", "bottom"}]}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}], ",", 
                    SubscriptBox["YY", 
                    RowBox[{"i", ",", "j"}]]}], "]"}], 
                    SubscriptBox["YY", 
                    RowBox[{"i", ",", "j"}]]}], "\[Equal]", 
                    RowBox[{"zed", "[", 
                    RowBox[{"[", "memz", "]"}], "]"}]}], ",", 
                    RowBox[{"(*", 
                    RowBox[{"appears", " ", "on", " ", "top"}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "-", "1"}]}], ";"}], ",", "True", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"IF", "+", 
                    RowBox[{"Length", "[", "addgauge", "]"}], "+", "memz"}]}],
                     "]"}], "]"}], "+", "1"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<\[CapitalDelta] = \>\"", ",", 
           RowBox[{"Delta", "//", "MatrixForm"}]}], "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Make", " ", "the", " ", "variables", " ", "that", " ", "go", " ", 
         "into", " ", "QDT"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"QDT", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          SubscriptBox["y", 
           RowBox[{"m", ",", "n"}]], ",", 
          RowBox[{"{", 
           RowBox[{"m", ",", 
            RowBox[{"Length", "[", "plist", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", 
            RowBox[{"IF", "+", 
             RowBox[{"Length", "[", "addgauge", "]"}], "+", 
             RowBox[{"Length", "[", "zed", "]"}]}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Put", " ", "all", " ", "the", " ", "elements", " ", 
          SubscriptBox["y", 
           RowBox[{"m", ",", "n"}]], " ", "in", " ", "a", " ", "long", " ", 
          "list"}], ",", " ", 
         RowBox[{
         "so", " ", "that", " ", "we", " ", "can", " ", "solve", " ", "for", 
          " ", "the", " ", 
          RowBox[{"list", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"QDTlist", "=", 
        RowBox[{"Flatten", "[", "QDT", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"solution", "=", 
        RowBox[{"Solve", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"P", ".", "QDT"}], "\[Equal]", "Delta"}], ",", "QDTlist"}],
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"newQDTlist", "=", 
        RowBox[{"QDTlist", "/.", "solution"}]}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{
        "Plug", " ", "in", " ", "solution", " ", "into", " ", "a", " ", 
         "matrix"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Now", " ", "need", " ", "to", " ", "put", " ", "the", " ", 
         "elements", " ", "back", " ", "into", " ", "QDT"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"temp", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", "plist", "]"}], "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "<", 
             RowBox[{"IF", "+", 
              RowBox[{"Length", "[", "addgauge", "]"}], "+", 
              RowBox[{"Length", "[", "zed", "]"}], "+", "1"}]}], ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"QDT", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
              RowBox[{"newQDTlist", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "temp"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"temp", "=", 
              RowBox[{"temp", "+", "1"}]}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"QD", "=", 
        RowBox[{"Transpose", "[", "QDT", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<\!\(\*SubscriptBox[\(Q\), \(D\)]\)= \>\"", ",", 
           RowBox[{"QD", "//", "MatrixForm"}]}], "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Q", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"QF", ",", "QD"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Gmoduliold", "=", 
        RowBox[{"NullSpace", "[", "Q", "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"RowReduce", "[", "Gmoduli", "]"}], "\[Equal]", 
          RowBox[{"RowReduce", "[", "Gmoduliold", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "Print", "[", "\"\<The two MATRICES ARE THE SAME!\>\"", "]"}], 
          ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{
          RowBox[{
          "Print", "[", 
           "\"\<The two matrices are different... Maybe they are the same \
space after a translation...\>\"", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"subtract", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Transpose", "[", "Gmoduliold", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "-", 
            RowBox[{
             RowBox[{"Transpose", "[", "Gmoduli", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"transGmoduliold", "=", 
           RowBox[{"RowReduce", "[", 
            RowBox[{"Gmoduliold", "-", 
             RowBox[{"Transpose", "[", 
              RowBox[{"Table", "[", 
               RowBox[{"subtract", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Dimensions", "[", "Gmoduliold", "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "}"}]}], "]"}], "]"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"RowReduce", "[", "Gmoduli", "]"}], "\[Equal]", 
             RowBox[{"RowReduce", "[", "transGmoduliold", "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
             "Print", "[", 
              "\"\<After a translation, the two matrices are INDEED THE SAME!\
\>\"", "]"}], ";"}], "\[IndentingNewLine]", ",", 
            RowBox[{
             RowBox[{
             "Print", "[", 
              "\"\<The two MATRICES ARE DIFFERENT even after the translation. \
Look at the multiplicities.\>\"", "]"}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"multold", "=", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Dimensions", "[", 
                  RowBox[{
                   RowBox[{"Gather", "[", 
                    RowBox[{"Transpose", "[", "Gmoduliold", "]"}], "]"}], "[", 
                   RowBox[{"[", "y", "]"}], "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "1"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"y", ",", 
                  RowBox[{
                   RowBox[{"Dimensions", "[", 
                    RowBox[{"Gather", "[", 
                    RowBox[{"Transpose", "[", "Gmoduliold", "]"}], "]"}], 
                    "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Print", "[", 
              RowBox[{"\"\<multiplicity = \>\"", ",", 
               RowBox[{"multold", "//", "MatrixForm"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Print", "[", 
              RowBox[{"\"\<Multmatrix = \>\"", ",", 
               RowBox[{"Multmatrix", "//", "MatrixForm"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"multold", "\[Equal]", "Multmatrix"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                "Print", "[", 
                 "\"\<The multiplicities of each point are EXACTLY the same! \
Indication that the spaces are actually the same.\>\"", "]"}], ";"}], 
               "\[IndentingNewLine]", ",", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"Sort", "[", 
                    RowBox[{
                    RowBox[{"multold", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "Greater"}], "]"}], 
                    "}"}], "\[Equal]", 
                   RowBox[{"{", 
                    RowBox[{"Sort", "[", 
                    RowBox[{
                    RowBox[{"Multmatrix", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "Greater"}], "]"}], 
                    "}"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                   "Print", "[", 
                    "\"\<The multiplicity matrices are the same, only after \
reordering the columns.\>\"", "]"}], ";"}], "\[IndentingNewLine]", ",", 
                  RowBox[{
                   RowBox[{
                   "Print", "[", 
                    "\"\<The multiplicites are actually different... At best, \
the two moduli spaces are different phases of the same CY. But they naively \
seem DIFFERENT.\>\"", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", "\"\<-------------------------------------\>\"", "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", 
        "\"\<Variables are 'QF'=redundancies (F-term charge matrix); \
'QD'=D-term charge matrix; 'Gmoduliold'=moduli space using the old \
method;\>\"", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", "\"\<-------------------------------------\>\"", "]"}], 
       ";"}]}], "\[IndentingNewLine]", "]"}]}], "*)"}], "\[IndentingNewLine]",
   "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"SKIPPED", ",", " ", 
    RowBox[{"NO", " ", "NEED", " ", "FOR", " ", 
     RowBox[{"IT", "!"}]}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Finds", " ", "all", " ", "reductions", " ", "to", " ", "a", " ", 
      RowBox[{"graph", ".", " ", "It"}], " ", "needs", " ", "the", " ", 
      "moduli", " ", "space", " ", "and", " ", "the", " ", "perfect", " ", 
      "matching", " ", "matrix", " ", 
      RowBox[{"P", ".", " ", "Give"}], " ", "it", " ", "num"}], "=", 
     RowBox[{
     "1", " ", "if", " ", "you", " ", "are", " ", "considering", " ", 
      "Xlist"}]}], ",", " ", 
    RowBox[{
     RowBox[{"and", " ", "num"}], "=", 
     RowBox[{"2", " ", "if", " ", "you", " ", "are", " ", "considering", " ", 
      RowBox[{"Xlisthiggs", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"whichnum", "[", 
      RowBox[{"gi_", ",", "lev_"}], "]"}], ":=", 
     RowBox[{
      SubscriptBox["kills", "lev"], "[", 
      RowBox[{"[", "gi", "]"}], "]"}]}], ";", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
      "whichnum", " ", "and", " ", "Xs", " ", "are", " ", "auxiliary", " ", 
       "functions"}], ",", " ", 
      RowBox[{"useful", " ", "later"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "whichnum", " ", "translates", " ", "a", " ", "try", " ", "number", " ", 
      "to", " ", "which", " ", "pms", " ", "are", " ", "actually", " ", 
      "killed"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Xs", "[", "numb_", "]"}], ":=", 
     RowBox[{"Xlist", "[", 
      RowBox[{"[", "numb", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Xshigg", "[", "numb_", "]"}], ":=", 
     RowBox[{"Xlisthiggs", "[", 
      RowBox[{"[", "numb", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"reduction", "[", 
      RowBox[{"P_", ",", "Gmoduli_", ",", "num_"}], "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "level", ",", "try", ",", "die", ",", "hig", ",", "kil", ",", "el", 
         ",", "Gnew", ",", "dum", ",", "Gshorta", ",", "newGshort", ",", 
         "remSets", ",", "Xlista", ",", "Gnewtrans"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"num", "\[Equal]", "1"}], ",", 
          RowBox[{
           RowBox[{"Xlista", "=", "Xlist"}], ";"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"num", "\[Equal]", "2"}], ",", 
          RowBox[{
           RowBox[{"Xlista", "=", "Xlisthiggs"}], ";"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"level", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Gshorta", "=", 
         RowBox[{"Transpose", "[", 
          RowBox[{"DeleteDuplicates", "[", 
           RowBox[{"Transpose", "[", "Gmoduli", "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{"True", ",", 
          RowBox[{"(*", 
           RowBox[{"keep", " ", "going", " ", "until", " ", 
            RowBox[{"we", "'"}], "re", " ", "finished", " ", "Higgsing"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"level", "=", 
            RowBox[{"level", "+", "1"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            SubscriptBox["higgs", "level"], "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"level", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               SubscriptBox["kills", "level"], "=", 
               RowBox[{"Transpose", "[", 
                RowBox[{"{", 
                 RowBox[{"Range", "[", 
                  RowBox[{"Length", "[", "Xlista", "]"}], "]"}], "}"}], 
                "]"}]}], ";"}], 
             RowBox[{"(*", 
              RowBox[{"Higgs", " ", "for", " ", "level", " ", "1"}], "*)"}], 
             "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               SubscriptBox["kills", "level"], "=", 
               RowBox[{"Subsets", "[", 
                RowBox[{
                 SubscriptBox["higgs", "1"], ",", 
                 RowBox[{"{", "level", "}"}]}], "]"}]}], ";"}]}], 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{
              "These", " ", "are", " ", "the", " ", "sets", " ", "of", " ", 
               "fields", " ", "we", " ", "are", " ", "going", " ", "to", " ", 
               "try", " ", "and", " ", 
               RowBox[{"kill", ".", " ", "For"}], " ", 
               SubscriptBox["higgs", "1"]}], ",", 
              RowBox[{
               RowBox[{"Xlist", "[", 
                RowBox[{"[", 
                 RowBox[{
                  SubscriptBox["higgs", "1"], "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], " ", "makes", 
               " ", "sense"}], ",", " ", 
              RowBox[{
               SubscriptBox["higgs", "1"], " ", "happens", " ", "to", " ", 
               "actually", " ", "refer", " ", "to", " ", "the", " ", 
               "\"\<try\>\"", " ", "number", " ", "as", " ", "well", " ", 
               "as", " ", "the", " ", "number", " ", "of", " ", "the", " ", 
               "higgsed", " ", 
               RowBox[{"leg", "."}]}]}], "*)"}], "\[IndentingNewLine]", "]"}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<Level is \>\"", ",", "level", ",", 
             "\"\< and we have to check \>\"", ",", 
             RowBox[{"Length", "[", 
              SubscriptBox["kills", "level"], "]"}], ",", "\"\< guys.\>\""}], 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"try", "=", "1"}], ",", 
             RowBox[{"try", "<", 
              RowBox[{
               RowBox[{"Length", "[", 
                SubscriptBox["kills", "level"], "]"}], "+", "1"}]}], ",", 
             RowBox[{"try", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"die", "=", 
               RowBox[{"{", "}"}]}], ";", 
              RowBox[{"(*", 
               RowBox[{
               "Will", " ", "contains", " ", "the", " ", "list", " ", "of", 
                " ", "which", " ", "columns", " ", "die"}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"hig", "=", "1"}], ",", 
                RowBox[{"hig", "<", 
                 RowBox[{"level", "+", "1"}]}], ",", 
                RowBox[{"hig", "++"}], ",", 
                RowBox[{"(*", 
                 RowBox[{
                 "We", " ", "are", " ", "higgsing", " ", "\"\<level\>\"", " ",
                   "number", " ", "of", " ", "fields"}], "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"kil", "=", 
                  RowBox[{
                   SubscriptBox["kills", "level"], "[", 
                   RowBox[{"[", 
                    RowBox[{"try", ",", "hig"}], "]"}], "]"}]}], ";", 
                 RowBox[{"(*", 
                  RowBox[{"We", " ", "now", " ", "kill", " ", 
                   RowBox[{"Xlista", "[", 
                    RowBox[{"[", "kil", "]"}], "]"}]}], "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{"For", "[", 
                  RowBox[{
                   RowBox[{"el", "=", "1"}], ",", 
                   RowBox[{"el", "<", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Dimensions", "[", "P", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "+", "1"}]}], ",", 
                   RowBox[{"el", "++"}], ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"P", "[", 
                    RowBox[{"[", 
                    RowBox[{"kil", ",", "el"}], "]"}], "]"}], "\[Equal]", 
                    "1"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"die", "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{"die", ",", 
                    RowBox[{"{", "el", "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"die", "=", 
               RowBox[{"DeleteDuplicates", "[", "die", "]"}]}], ";", 
              RowBox[{"(*", 
               RowBox[{
               "These", " ", "are", " ", "the", " ", "columns", " ", "that", 
                " ", "must", " ", "be", " ", "removed", " ", "from", " ", 
                "Gmoduli"}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"Gnewtrans", "=", 
               RowBox[{"Delete", "[", 
                RowBox[{
                 RowBox[{"Transpose", "[", "Gmoduli", "]"}], ",", 
                 RowBox[{"Transpose", "[", 
                  RowBox[{"{", "die", "}"}], "]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{"Finished", " ", "killing", " ", "perfect", " ", 
                RowBox[{"matchings", "!"}]}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
               "Now", " ", "check", " ", "if", " ", "Gshorta", " ", "has", 
                " ", "same", " ", "number", " ", "of", " ", "points", " ", 
                "as", " ", 
                RowBox[{"before", "."}]}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"Gnewtrans", "\[Equal]", 
                 RowBox[{"{", "}"}]}], ",", 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{
                  "if", " ", "Gnew", " ", "has", " ", "been", " ", "killed", 
                   " ", "completely"}], ",", 
                  RowBox[{
                   RowBox[{"i", ".", "e", ".", " ", "we"}], " ", "killed", 
                   " ", "all", " ", 
                   RowBox[{"pm", "'"}], "s"}], ",", " ", 
                  RowBox[{
                   RowBox[{"say", " ", "newGshort"}], "=", "Gnew"}]}], "*)"}],
                 "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"newGshort", "=", 
                  RowBox[{"Table", "[", 
                   RowBox[{"0", ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", 
                    RowBox[{
                    RowBox[{"Dimensions", "[", "Gshorta", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"y", ",", "0"}], "}"}]}], "]"}]}], ";"}], 
                "\[IndentingNewLine]", ",", 
                RowBox[{
                 RowBox[{"Gnew", "=", 
                  RowBox[{"Transpose", "[", "Gnewtrans", "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"newGshort", "=", 
                  RowBox[{"Transpose", "[", 
                   RowBox[{"DeleteDuplicates", "[", "Gnewtrans", "]"}], 
                   "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Dimensions", "[", "newGshort", "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "==", 
                 RowBox[{
                  RowBox[{"Dimensions", "[", "Gshorta", "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  SubscriptBox["higgs", "level"], "=", 
                  RowBox[{"Join", "[", 
                   RowBox[{
                    SubscriptBox["higgs", "level"], ",", 
                    RowBox[{"{", "try", "}"}]}], "]"}]}], ";"}]}], 
               RowBox[{"(*", 
                RowBox[{
                "remebers", " ", "which", " ", "of", " ", "the", " ", 
                 "subsets", " ", "was", " ", "good", " ", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"doesn", "'"}], "t", " ", "know", " ", "what", 
                    " ", "the", " ", "subset", " ", "looks", " ", 
                    RowBox[{"like", ".", " ", 
                    RowBox[{"That", "'"}]}], "s", " ", "what", " ", 
                    "whichnum", " ", "is", " ", "for"}], ")"}], "."}]}], 
                "*)"}], "\[IndentingNewLine]", "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", 
           RowBox[{"(*", 
            RowBox[{"Close", " ", "for", " ", "try"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               SubscriptBox["higgs", "level"], "\[Equal]", 
               RowBox[{"{", "}"}]}], "||", 
              RowBox[{"level", "\[Equal]", 
               RowBox[{"Length", "[", "Xlista", "]"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"level", "\[Equal]", "1"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Print", "[", "\"\<No reductions!\>\"", "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", 
               "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"remSets", "=", 
               RowBox[{"MapThread", "[", 
                RowBox[{"whichnum", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   SubscriptBox["higgs", 
                    RowBox[{"level", "-", "1"}]], ",", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"level", "-", "1"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["higgs", 
                    RowBox[{"level", "-", "1"}]], "]"}], "}"}]}], "]"}]}], 
                  "}"}]}], "]"}]}], ";", " ", 
              RowBox[{"(*", 
               RowBox[{"evaluates", " ", 
                RowBox[{"whichnum", "[", 
                 RowBox[{"x", ",", 
                  RowBox[{"level", "-", "1"}]}], "]"}], " ", "for", " ", 
                "all", " ", "elements", " ", "in", " ", 
                SubscriptBox["higgs", 
                 RowBox[{"level", "-", "1"}]]}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"num", "\[Equal]", "1"}], ",", 
                RowBox[{
                 RowBox[{"higgslist", "=", 
                  RowBox[{"MapThread", "[", 
                   RowBox[{"Xs", ",", 
                    RowBox[{"{", "remSets", "}"}], ",", "2"}], "]"}]}], 
                 ";"}]}], "]"}], ";", " ", 
              RowBox[{"(*", 
               RowBox[{"turns", " ", "numbers", " ", "into", " ", 
                SubscriptBox["X", 
                 RowBox[{"i", ",", "j"}]], " ", "fields"}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"num", "\[Equal]", "2"}], ",", 
                RowBox[{
                 RowBox[{"higgslist", "=", 
                  RowBox[{"MapThread", "[", 
                   RowBox[{"Xshigg", ",", 
                    RowBox[{"{", "remSets", "}"}], ",", "2"}], "]"}]}], 
                 ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"higgslist", "=", 
               RowBox[{"DeleteDuplicates", "[", 
                RowBox[{"Map", "[", 
                 RowBox[{"Sort", ",", "higgslist"}], "]"}], "]"}]}], ";", 
              RowBox[{"(*", 
               RowBox[{
               "Make", " ", "sure", " ", "there", " ", "are", " ", "no", " ", 
                "Higgsings", " ", "that", " ", "are", " ", "actually", " ", 
                "the", " ", "same"}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"Print", "[", 
               RowBox[{"\"\<Can remove \>\"", ",", 
                RowBox[{"level", "-", "1"}], ",", "\"\< legs in \>\"", ",", 
                RowBox[{"Length", "[", "higgslist", "]"}], ",", 
                "\"\< different ways.\>\""}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<Sets of legs that can be Higgsed are 'higgslist'= \>\"", 
                ",", "higgslist"}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
      RowBox[{"(*", 
       RowBox[{"Close", " ", "while"}], "*)"}], "\[IndentingNewLine]", 
      "]"}]}]}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"DONE", ",", " ", 
    RowBox[{"NOW", " ", "CALLED", " ", "reductionGraphBFT"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Higgses", " ", "a", " ", "field"}], ",", " ", 
    RowBox[{
    "giving", " ", "the", " ", "new", " ", "P", " ", "matrix", " ", "and", 
     " ", "the", " ", "higgsed", " ", "moduli", " ", 
     RowBox[{"space", ".", " ", "Assumes"}], " ", "that", " ", "P", " ", 
     "and", " ", "Xlist", " ", "are", " ", "already", " ", 
     RowBox[{"known", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"higgs", "[", 
     RowBox[{"field_", ",", "Xlist_", ",", "P_", ",", "Gmoduli_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"num", ",", "killist", ",", "rowhiggs"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"num", "=", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"Xlist", ",", "field"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"killist", "=", 
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"P", "[", 
           RowBox[{"[", "num", "]"}], "]"}], ",", "1"}], "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "These", " ", "are", " ", "the", " ", "perfect", " ", "matchings", 
         " ", "that", " ", "die"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "We", " ", "also", " ", "have", " ", "to", " ", "higgs", " ", "any", 
         " ", "row", " ", "that", " ", "is", " ", "identical", " ", "to", " ",
          "the", " ", "one", " ", "we", " ", "removed"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"rowhiggs", "=", 
        RowBox[{"Position", "[", 
         RowBox[{"P", ",", 
          RowBox[{"P", "[", 
           RowBox[{"[", "num", "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Phiggs", "=", 
        RowBox[{"Delete", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"Delete", "[", 
            RowBox[{
             RowBox[{"Transpose", "[", "P", "]"}], ",", "killist"}], "]"}], 
           "]"}], ",", "rowhiggs"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "We", " ", "have", " ", "to", " ", "also", " ", "change", " ", "the", 
         " ", "moduli", " ", "space"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Gmodulihiggs", "=", 
        RowBox[{"Transpose", "[", 
         RowBox[{"Delete", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", "Gmoduli", "]"}], ",", "killist"}], 
          "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Gmodulihiggs", "=", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{"Gmodulihiggs", ",", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", 
            RowBox[{
             RowBox[{"Dimensions", "[", "Gmodulihiggs", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "This", " ", "is", " ", "the", " ", "space", " ", "we", " ", "get", 
         " ", "after", " ", "having", " ", "killed", " ", "the", " ", 
         RowBox[{"field", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Gmodulihiggs", "\[Equal]", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{
          RowBox[{"Gmodulihiggs", "=", 
           RowBox[{"{", 
            RowBox[{"{", "0", "}"}], "}"}]}], ";"}]}], "]"}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{
        "In", " ", "case", " ", "we", " ", "accidentally", " ", "killed", " ",
          "too", " ", "much"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Xlisthiggs", "=", 
        RowBox[{"Delete", "[", 
         RowBox[{"Xlist", ",", "rowhiggs"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<After killing \>\"", ",", "field", ",", 
         "\"\< the Master space has dimension \>\"", ",", 
         RowBox[{"BFTdim", "[", "Phiggs", "]"}], ",", 
         "\"\< and the moduli space has dimension \>\"", ",", 
         RowBox[{
          RowBox[{"BFTdim", "[", "Gmodulihiggs", "]"}], "\"\<.\>\""}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", 
        "\"\<The new P matrix is saved under 'Phiggs'. New moduli space under \
'Gmodulihiggs'. New Xlist under 'Xlisthiggs'.\>\"", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"reducibility", "[", 
          RowBox[{"Phiggs", ",", "Gmodulihiggs"}], "]"}], ",", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<The space is now reducible!\>\"", "]"}], 
          ";"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"SKIPPED", ",", " ", 
    RowBox[{
    "THIS", " ", "IS", " ", "DONE", " ", "IN", " ", "THREE", " ", "LINES", 
     " ", "IN", " ", "removableEdges"}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Does", " ", "the", " ", "exact", " ", "same", " ", "as", " ", 
     RowBox[{"higgs", "[", 
      RowBox[{"field", ",", "Xlist", ",", "P", ",", "Gmoduli"}], "]"}]}], ",",
     " ", 
    RowBox[{"but", " ", 
     RowBox[{"doesn", "'"}], "t", " ", "print", " ", "out", " ", "lots", " ", 
     "of", " ", 
     RowBox[{"text", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"higgsquiet", "[", 
     RowBox[{"field_", ",", "Xlist_", ",", "P_", ",", "Gmoduli_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"num", ",", "killist", ",", "rowhiggs"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"num", "=", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"Xlist", ",", "field"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"killist", "=", 
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"P", "[", 
           RowBox[{"[", "num", "]"}], "]"}], ",", "1"}], "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "These", " ", "are", " ", "the", " ", "perfect", " ", "matchings", 
         " ", "that", " ", "die"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "We", " ", "also", " ", "have", " ", "to", " ", "higgs", " ", "any", 
         " ", "row", " ", "that", " ", "is", " ", "identical", " ", "to", " ",
          "the", " ", "one", " ", "we", " ", "removed"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"rowhiggs", "=", 
        RowBox[{"Position", "[", 
         RowBox[{"P", ",", 
          RowBox[{"P", "[", 
           RowBox[{"[", "num", "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Phiggs", "=", 
        RowBox[{"Delete", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"Delete", "[", 
            RowBox[{
             RowBox[{"Transpose", "[", "P", "]"}], ",", "killist"}], "]"}], 
           "]"}], ",", "rowhiggs"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "We", " ", "have", " ", "to", " ", "also", " ", "change", " ", "the", 
         " ", "moduli", " ", "space"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Gmodulihiggs", "=", 
        RowBox[{"Transpose", "[", 
         RowBox[{"Delete", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", "Gmoduli", "]"}], ",", "killist"}], 
          "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Gmodulihiggs", "=", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{"Gmodulihiggs", ",", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", 
            RowBox[{
             RowBox[{"Dimensions", "[", "Gmodulihiggs", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "This", " ", "is", " ", "the", " ", "space", " ", "we", " ", "get", 
         " ", "after", " ", "having", " ", "killed", " ", "the", " ", 
         RowBox[{"field", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Gmodulihiggs", "\[Equal]", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{
          RowBox[{"Gmodulihiggs", "=", 
           RowBox[{"{", 
            RowBox[{"{", "0", "}"}], "}"}]}], ";"}]}], "]"}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{
        "In", " ", "case", " ", "we", " ", "accidentally", " ", "killed", " ",
          "too", " ", "much"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Xlisthiggs", "=", 
        RowBox[{"Delete", "[", 
         RowBox[{"Xlist", ",", "rowhiggs"}], "]"}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"SKIPPED", ",", " ", 
    RowBox[{"NOT", " ", "NEEDED"}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Gives", " ", "a", " ", "list", " ", "of", " ", "the", " ", "removable", 
    " ", 
    RowBox[{"legs", ".", " ", "Assumes"}], " ", "that", " ", "P", " ", "and", 
    " ", "Xlist", " ", "are", " ", "already", " ", 
    RowBox[{"known", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"removable", "[", 
     RowBox[{"Xlist_", ",", "P_", ",", "Gmoduli_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "la", ",", "field", ",", "killist", ",", "Ptry", ",", "Gmodulitry", 
        ",", "rowhiggs", ",", "skip"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Now", " ", "calculate", " ", "dimension", " ", "of", " ", "master", 
        " ", "space", " ", "after", " ", "killing", " ", "an", " ", 
        SubscriptBox["X", 
         RowBox[{"i", ",", "j"}]]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"remlegs", "=", 
        RowBox[{"{", "}"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{"lists", " ", "the", " ", "removable", " ", "edges"}], "*)"}],
        "\[IndentingNewLine]", 
       RowBox[{"skip", "=", 
        RowBox[{"{", "}"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "We", " ", "will", " ", "need", " ", "to", " ", "skip", " ", "rows", 
         " ", "that", " ", "are", " ", "identical", " ", "to", " ", "rows", 
         " ", 
         RowBox[{"we", "'"}], "ve", " ", "already", " ", "considered"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"la", "=", "1"}], ",", 
         RowBox[{"la", "<", 
          RowBox[{
           RowBox[{"Length", "[", "P", "]"}], "+", "1"}]}], ",", 
         RowBox[{"la", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"FreeQ", "[", 
             RowBox[{"skip", ",", "la"}], "]"}], ",", 
            RowBox[{"(*", 
             RowBox[{
             "If", " ", "the", " ", "row", " ", "we", " ", "consider", " ", 
              "is", " ", "not", " ", "one", " ", 
              RowBox[{"we", "'"}], "ve", " ", "already", " ", "considered", 
              " ", 
              RowBox[{"(", 
               RowBox[{
               "and", " ", "hence", " ", "been", " ", "told", " ", "to", " ", 
                "skip"}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"field", "=", 
              RowBox[{"Xlist", "[", 
               RowBox[{"[", "la", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"killist", "=", 
              RowBox[{"Position", "[", 
               RowBox[{
                RowBox[{"P", "[", 
                 RowBox[{"[", "la", "]"}], "]"}], ",", "1"}], "]"}]}], ";", 
             RowBox[{"(*", 
              RowBox[{
              "These", " ", "are", " ", "the", " ", "perfect", " ", 
               "matchings", " ", "that", " ", "die"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"rowhiggs", "=", 
              RowBox[{"Position", "[", 
               RowBox[{"P", ",", 
                RowBox[{"P", "[", 
                 RowBox[{"[", "la", "]"}], "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", "rowhiggs", "]"}], ">", "1"}], ",", 
               RowBox[{"skip", "=", 
                RowBox[{"Join", "[", 
                 RowBox[{"skip", ",", 
                  RowBox[{
                   RowBox[{"Transpose", "[", 
                    RowBox[{"Delete", "[", 
                    RowBox[{"rowhiggs", ",", "1"}], "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", "killist", "]"}], "<", 
                RowBox[{
                 RowBox[{"Dimensions", "[", "P", "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", 
               RowBox[{"(*", 
                RowBox[{
                "Only", " ", "kill", " ", "if", " ", "there", " ", "will", 
                 " ", "be", " ", "some", " ", "survivors"}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Ptry", "=", 
                 RowBox[{"Delete", "[", 
                  RowBox[{
                   RowBox[{"Transpose", "[", 
                    RowBox[{"Delete", "[", 
                    RowBox[{
                    RowBox[{"Transpose", "[", "P", "]"}], ",", "killist"}], 
                    "]"}], "]"}], ",", "rowhiggs"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"Gmodulitry", "=", 
                 RowBox[{"Transpose", "[", 
                  RowBox[{"Delete", "[", 
                   RowBox[{
                    RowBox[{"Transpose", "[", "Gmoduli", "]"}], ",", 
                    "killist"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"Gmodulitry", "=", 
                 RowBox[{"DeleteCases", "[", 
                  RowBox[{"Gmodulitry", ",", 
                   RowBox[{"ConstantArray", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{
                    RowBox[{"Dimensions", "[", "Gmodulitry", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"Gmodulitry", "\[Equal]", 
                   RowBox[{"{", "}"}]}], ",", 
                  RowBox[{
                   RowBox[{"Gmodulitry", "=", 
                    RowBox[{"{", 
                    RowBox[{"{", "0", "}"}], "}"}]}], ";"}]}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"!", 
                   RowBox[{"reducibility", "[", 
                    RowBox[{"Ptry", ",", "Gmodulitry"}], "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"remlegs", "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{"remlegs", ",", 
                    RowBox[{"{", "field", "}"}]}], "]"}]}], ";"}]}], "]"}], 
                ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "remlegs", "]"}], "\[NotEqual]", "0"}], ",", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<The removable legs are 'remlegs'=\>\"", ",", "remlegs"}], 
           "]"}], ";"}], ",", 
         RowBox[{
         "Print", "[", "\"\<There are no removable legs!\>\"", "]"}]}], "]"}],
        ";"}]}], "\[IndentingNewLine]", "]"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"DONE", ",", " ", 
    RowBox[{
    "THIS", " ", "IS", " ", "NOW", " ", "PART", " ", "OF", " ", 
     "removableEdges"}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Same", " ", "as", " ", 
     RowBox[{"removable", "[", 
      RowBox[{"Xlist", ",", "P", ",", "Gmoduli"}], "]"}]}], ",", " ", 
    RowBox[{"but", " ", 
     RowBox[{"doesn", "'"}], "t", " ", "print", " ", "any", " ", 
     RowBox[{"text", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"removablequiet", "[", 
     RowBox[{"Xlist_", ",", "P_", ",", "Gmoduli_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "la", ",", "field", ",", "killist", ",", "Ptry", ",", "Gmodulitry", 
        ",", "rowhiggs", ",", "skip"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Now", " ", "calculate", " ", "dimension", " ", "of", " ", "master", 
        " ", "space", " ", "after", " ", "killing", " ", "an", " ", 
        SubscriptBox["X", 
         RowBox[{"i", ",", "j"}]]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"remlegs", "=", 
        RowBox[{"{", "}"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{"lists", " ", "the", " ", "removable", " ", "edges"}], "*)"}],
        "\[IndentingNewLine]", 
       RowBox[{"skip", "=", 
        RowBox[{"{", "}"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "We", " ", "will", " ", "need", " ", "to", " ", "skip", " ", "rows", 
         " ", "that", " ", "are", " ", "identical", " ", "to", " ", "rows", 
         " ", 
         RowBox[{"we", "'"}], "ve", " ", "already", " ", "considered"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"la", "=", "1"}], ",", 
         RowBox[{"la", "<", 
          RowBox[{
           RowBox[{"Length", "[", "P", "]"}], "+", "1"}]}], ",", 
         RowBox[{"la", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"FreeQ", "[", 
             RowBox[{"skip", ",", "la"}], "]"}], ",", 
            RowBox[{"(*", 
             RowBox[{
             "If", " ", "the", " ", "row", " ", "we", " ", "consider", " ", 
              "is", " ", "not", " ", "one", " ", 
              RowBox[{"we", "'"}], "ve", " ", "already", " ", "considered", 
              " ", 
              RowBox[{"(", 
               RowBox[{
               "and", " ", "hence", " ", "been", " ", "told", " ", "to", " ", 
                "skip"}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"field", "=", 
              RowBox[{"Xlist", "[", 
               RowBox[{"[", "la", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"killist", "=", 
              RowBox[{"Position", "[", 
               RowBox[{
                RowBox[{"P", "[", 
                 RowBox[{"[", "la", "]"}], "]"}], ",", "1"}], "]"}]}], ";", 
             RowBox[{"(*", 
              RowBox[{
              "These", " ", "are", " ", "the", " ", "perfect", " ", 
               "matchings", " ", "that", " ", "die"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"rowhiggs", "=", 
              RowBox[{"Position", "[", 
               RowBox[{"P", ",", 
                RowBox[{"P", "[", 
                 RowBox[{"[", "la", "]"}], "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", "rowhiggs", "]"}], ">", "1"}], ",", 
               RowBox[{"skip", "=", 
                RowBox[{"Join", "[", 
                 RowBox[{"skip", ",", 
                  RowBox[{
                   RowBox[{"Transpose", "[", 
                    RowBox[{"Delete", "[", 
                    RowBox[{"rowhiggs", ",", "1"}], "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", "killist", "]"}], "<", 
                RowBox[{
                 RowBox[{"Dimensions", "[", "P", "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", 
               RowBox[{"(*", 
                RowBox[{
                "Only", " ", "kill", " ", "if", " ", "there", " ", "will", 
                 " ", "be", " ", "some", " ", "survivors"}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Ptry", "=", 
                 RowBox[{"Delete", "[", 
                  RowBox[{
                   RowBox[{"Transpose", "[", 
                    RowBox[{"Delete", "[", 
                    RowBox[{
                    RowBox[{"Transpose", "[", "P", "]"}], ",", "killist"}], 
                    "]"}], "]"}], ",", "rowhiggs"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"Gmodulitry", "=", 
                 RowBox[{"Transpose", "[", 
                  RowBox[{"Delete", "[", 
                   RowBox[{
                    RowBox[{"Transpose", "[", "Gmoduli", "]"}], ",", 
                    "killist"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"Gmodulitry", "=", 
                 RowBox[{"DeleteCases", "[", 
                  RowBox[{"Gmodulitry", ",", 
                   RowBox[{"ConstantArray", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{
                    RowBox[{"Dimensions", "[", "Gmodulitry", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"Gmodulitry", "\[Equal]", 
                   RowBox[{"{", "}"}]}], ",", 
                  RowBox[{
                   RowBox[{"Gmodulitry", "=", 
                    RowBox[{"{", 
                    RowBox[{"{", "0", "}"}], "}"}]}], ";"}]}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"!", 
                   RowBox[{"reducibility", "[", 
                    RowBox[{"Ptry", ",", "Gmodulitry"}], "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"remlegs", "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{"remlegs", ",", 
                    RowBox[{"{", "field", "}"}]}], "]"}]}], ";"}]}], "]"}], 
                ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"SKIPPED", ",", " ", 
    RowBox[{"THIS", " ", "IS", " ", "DONE", " ", "ALREADY"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Checks", " ", "whether", " ", "the", " ", "points", " ", "that", " ", 
     "survive", " ", "after", " ", "killist", " ", "has", " ", "killed", " ", 
     "the", " ", "corresponding", " ", "columns", " ", "are", " ", "indeed", 
     " ", "a", " ", "boundary", " ", "of", " ", "the", " ", 
     RowBox[{"space", ".", " ", "It"}], " ", "checks", " ", "by", " ", 
     "spanning", " ", "a", " ", "hyperplane", " ", "with", " ", "the", " ", 
     "surviving", " ", "points"}], ",", " ", 
    RowBox[{
    "and", " ", "checks", " ", "whether", " ", "the", " ", "dead", " ", 
     "points", " ", "were", " ", "all", " ", "on", " ", "one", " ", "side", 
     " ", "of", " ", "the", " ", "plane", " ", "or", " ", "on", " ", "both", 
     " ", 
     RowBox[{"sides", ".", " ", "Returns"}], " ", "True", " ", "or", " ", 
     RowBox[{"False", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"checkBoundary", "[", 
     RowBox[{"P_", ",", "killist_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "newmat", ",", "gi", ",", "allpoints", ",", "compl", ",", "face", ",", 
        "points", ",", "otherpoints", ",", "co", ",", "plane", ",", "rep", 
        ",", "equ1", ",", "equ2", ",", "equ3", ",", "aa", ",", "bb", ",", 
        "xx", ",", "i", ",", "cor", ",", "try", ",", "below", ",", "on", ",", 
        "above", ",", "check"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", "P", "]"}], ",", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0", ",", 
             RowBox[{"Length", "[", "P", "]"}]}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"newmat", "=", "P"}], ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{
          RowBox[{"newmat", "=", "P"}], ";", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"gi", "=", "1"}], ",", 
            RowBox[{"gi", "<", 
             RowBox[{
              RowBox[{
               RowBox[{"Dimensions", "[", "P", "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", "1"}]}], ",", 
            RowBox[{"gi", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"newmat", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "gi"}], "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{"newmat", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "gi"}], "]"}], "]"}], "-", 
               RowBox[{"P", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"allpoints", "=", 
        RowBox[{"Transpose", "[", "newmat", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"compl", "=", 
        RowBox[{
         RowBox[{"Transpose", "[", "killist", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{"These", " ", "are", " ", "the", " ", 
         RowBox[{"pm", "'"}], "s", " ", "that", " ", "die"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"face", "=", 
        RowBox[{"Complement", "[", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{
            RowBox[{"Dimensions", "[", "newmat", "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", "compl"}], "]"}]}], 
       ";", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "These", " ", "are", " ", "the", " ", "ones", " ", "that", " ", 
          "live"}], ",", " ", 
         RowBox[{"and", " ", "span", " ", "a", " ", "hyperplane"}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"points", "=", 
        RowBox[{"{", "}"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "Now", " ", "make", " ", "a", " ", "list", " ", "with", " ", "all", 
         " ", "the", " ", "surviving", " ", "coordinates"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"fa", "=", "1"}], ",", 
         RowBox[{"fa", "<", 
          RowBox[{
           RowBox[{"Length", "[", "face", "]"}], "+", "1"}]}], ",", 
         RowBox[{"fa", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"points", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"points", ",", 
             RowBox[{"{", 
              RowBox[{"allpoints", "[", 
               RowBox[{"[", 
                RowBox[{"face", "[", 
                 RowBox[{"[", "fa", "]"}], "]"}], "]"}], "]"}], "}"}]}], 
            "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"otherpoints", "=", 
        RowBox[{"{", "}"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "These", " ", "are", " ", "the", " ", "dead", " ", "coordinates"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"co", "=", "1"}], ",", 
         RowBox[{"co", "<", 
          RowBox[{
           RowBox[{"Length", "[", "compl", "]"}], "+", "1"}]}], ",", 
         RowBox[{"co", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"otherpoints", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"otherpoints", ",", 
             RowBox[{"{", 
              RowBox[{"allpoints", "[", 
               RowBox[{"[", 
                RowBox[{"compl", "[", 
                 RowBox[{"[", "co", "]"}], "]"}], "]"}], "]"}], "}"}]}], 
            "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"plane", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          SubscriptBox["aa", 
           RowBox[{"i", ",", "j"}]], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"Length", "[", "newmat", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"rep", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"FindInstance", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"plane", ".", 
               RowBox[{"Transpose", "[", "points", "]"}]}], "]"}], "\[Equal]", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{"bb", ",", 
               RowBox[{"Length", "[", "face", "]"}]}], "]"}]}], ",", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"Flatten", "[", "plane", "]"}], ",", 
              RowBox[{"{", "bb", "}"}]}], "]"}], ",", "Reals", ",", "2"}], 
           "]"}], ")"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"equ1", "=", 
        RowBox[{"Simplify", "[", 
         RowBox[{"equ1", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"plane", ".", 
                RowBox[{"Transpose", "[", 
                 RowBox[{"{", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    SubscriptBox["xx", "i"], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "newmat", "]"}]}], "}"}]}], "]"}], 
                  "}"}], "]"}]}], ")"}], "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}], "<", "bb"}], ")"}], "/.",
            "rep"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"equ2", "=", 
        RowBox[{"Simplify", "[", 
         RowBox[{"equ2", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"plane", ".", 
                RowBox[{"Transpose", "[", 
                 RowBox[{"{", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    SubscriptBox["xx", "i"], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "newmat", "]"}]}], "}"}]}], "]"}], 
                  "}"}], "]"}]}], ")"}], "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}], "\[Equal]", "bb"}], 
            ")"}], "/.", "rep"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"equ3", "=", 
        RowBox[{"Simplify", "[", 
         RowBox[{"equ3", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"plane", ".", 
                RowBox[{"Transpose", "[", 
                 RowBox[{"{", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    SubscriptBox["xx", "i"], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "newmat", "]"}]}], "}"}]}], "]"}], 
                  "}"}], "]"}]}], ")"}], "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}], ">", "bb"}], ")"}], "/.",
            "rep"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "We", " ", "have", " ", "the", " ", "equation", " ", "of", " ", "the",
          " ", 
         RowBox[{"hyperplane", "!"}]}], "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"below", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"on", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"above", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", "compl", "]"}], "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", 
         RowBox[{"(*", 
          RowBox[{
          "Now", " ", "try", " ", "each", " ", "of", " ", "the", " ", 
           "points", " ", "that", " ", "died", "  ", "and", " ", "see", " ", 
           "if", " ", "they", " ", "live", " ", "above", " ", "or", " ", 
           "below", " ", "the", " ", "plane"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           SubscriptBox["try", "i"], "=", 
           RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"cor", "=", "1"}], ",", 
            RowBox[{"cor", "<", 
             RowBox[{
              RowBox[{"Length", "[", "newmat", "]"}], "+", "1"}]}], ",", 
            RowBox[{"cor", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              SubscriptBox["try", "i"], "=", 
              RowBox[{"Join", "[", 
               RowBox[{
                SubscriptBox["try", "i"], ",", 
                RowBox[{"{", 
                 RowBox[{
                  SubscriptBox["xx", "cor"], "\[Rule]", 
                  RowBox[{"otherpoints", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "cor"}], "]"}], "]"}]}], "}"}]}], 
               "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"equ1", "/.", 
             SubscriptBox["try", "i"]}], ",", 
            RowBox[{
             RowBox[{"below", "=", 
              RowBox[{"below", "+", "1"}]}], ";"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"equ2", "/.", 
             SubscriptBox["try", "i"]}], ",", 
            RowBox[{
             RowBox[{"on", "=", 
              RowBox[{"on", "+", "1"}]}], ";"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"equ3", "/.", 
             SubscriptBox["try", "i"]}], ",", 
            RowBox[{
             RowBox[{"above", "=", 
              RowBox[{"above", "+", "1"}]}], ";"}]}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"below", "\[Equal]", "0"}], "||", 
          RowBox[{"above", "\[Equal]", "0"}]}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"on", "\[Equal]", "0"}], ",", 
           RowBox[{
            RowBox[{"check", "=", "True"}], ";"}], "\[IndentingNewLine]", ",", 
           RowBox[{
            RowBox[{"check", "=", "True"}], ";", "\[IndentingNewLine]", 
            RowBox[{
            "Print", "[", 
             "\"\<This COULD be a true boundary. Some points that were \
Higgsed were on the boundary. If they were internal in the boundary, then we \
have only Higgsed away perfect matchings that takes us to a true boundary. If \
they were external in the boundary, what we have now is not the actual \
boundary.\>\"", "]"}], ";"}]}], "]"}], "\[IndentingNewLine]", ",", 
         RowBox[{
          RowBox[{"check", "=", "False"}], ";"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "check"}]}], "\[IndentingNewLine]", "]"}]}], 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"SKIPPED", ",", " ", 
    RowBox[{"NO", " ", "NEED", " ", "FOR", " ", 
     RowBox[{"IT", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Calculates", " ", "the", " ", "moduli", " ", "space", " ", "using", " ", 
    "Gauging", " ", "1", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"using", " ", "charge", " ", "matrices"}], ")"}], "."}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"moduliGauging1", "[", 
     RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "IF", ",", "NF", ",", "Delta", ",", "i", ",", "j", ",", "k", ",", 
        "QDT", ",", "QDTlist", ",", "solution", ",", "newQDTlist", ",", 
        "temp", ",", "Q"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"kasteleyn", "[", 
        RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"IF", "=", 
        RowBox[{"internalFaces", "[", 
         RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"NF", "=", 
        RowBox[{"totFaces", "[", 
         RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Gmaster", "=", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{
          RowBox[{"RowReduce", "[", "P", "]"}], ",", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", 
            RowBox[{
             RowBox[{"Dimensions", "[", "P", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<The Master space is \>\"", ",", 
         RowBox[{"BFTdim", "[", "Gmaster", "]"}], ",", 
         "\"\<-dimensional. (NB This is the dimension of its toric diagram!).\
\>\""}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"QF", "=", 
        RowBox[{"NullSpace", "[", "P", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<\!\(\*SubscriptBox[\(Q\), \(F\)]\) = \>\"", ",", 
          RowBox[{"QF", "//", "MatrixForm"}]}], "]"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"First", " ", "make", " ", "Delta"}], ",", " ", 
         RowBox[{
          RowBox[{"then", " ", "plug", " ", "in", " ", "the", " ", "non"}], 
          "-", 
          RowBox[{"zero", " ", 
           RowBox[{"numbers", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Delta", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{"Length", "[", "Xlist", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", "IF"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Now", " ", "fill", " ", "in", " ", "the", " ", "non"}], "=", 
         RowBox[{"zero", " ", "numbers"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{"NF", "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "<", 
             RowBox[{"NF", "+", "1"}]}], ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"Take", " ", "a", " ", "specific", " ", 
              SubscriptBox["X", 
               RowBox[{"i", ",", "j"}]], " ", "or", " ", 
              SubscriptBox["Y", 
               RowBox[{"i", ",", "j"}]], " ", 
              RowBox[{"etc", ".", " ", "and"}], " ", "check", " ", "if", " ", 
              RowBox[{"it", "'"}], "s", " ", "in", " ", 
              RowBox[{"Xlist", "."}]}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"i", "\[NotEqual]", "j"}], ",", " ", 
               RowBox[{"(*", 
                RowBox[{
                 SubscriptBox["X", 
                  RowBox[{"i", ",", "i"}]], " ", 
                 RowBox[{"shouldn", "'"}], "t", " ", "be", " ", "nonzero"}], 
                "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"k", "=", "1"}], ",", 
                  RowBox[{"k", "<", 
                   RowBox[{
                    RowBox[{"Length", "[", "Xlist", "]"}], "+", "1"}]}], ",", 
                  RowBox[{"k", "++"}], ",", " ", 
                  RowBox[{"(*", 
                   RowBox[{
                   "Run", " ", "through", " ", "the", " ", "whole", " ", 
                    "Xlist"}], "*)"}], "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["X", 
                    RowBox[{"i", ",", "j"}]], "\[Equal]", 
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "&&", 
                    RowBox[{"i", "\[NotEqual]", "j"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i"}], "]"}], "]"}], "=", "1"}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"j", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{"-", "1"}]}], ";"}]}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["Y", 
                    RowBox[{"i", ",", "j"}]], "\[Equal]", 
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "&&", 
                    RowBox[{"i", "\[NotEqual]", "j"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i"}], "]"}], "]"}], "=", "1"}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"j", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{"-", "1"}]}], ";"}]}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["Z", 
                    RowBox[{"i", ",", "j"}]], "\[Equal]", 
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "&&", 
                    RowBox[{"i", "\[NotEqual]", "j"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i"}], "]"}], "]"}], "=", "1"}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"j", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{"-", "1"}]}], ";"}]}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["W", 
                    RowBox[{"i", ",", "j"}]], "\[Equal]", 
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "&&", 
                    RowBox[{"i", "\[NotEqual]", "j"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i"}], "]"}], "]"}], "=", "1"}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"j", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{"-", "1"}]}], ";"}]}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["V", 
                    RowBox[{"i", ",", "j"}]], "\[Equal]", 
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "&&", 
                    RowBox[{"i", "\[NotEqual]", "j"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i"}], "]"}], "]"}], "=", "1"}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"j", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{"-", "1"}]}], ";"}]}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["UU", 
                    RowBox[{"i", ",", "j"}]], "\[Equal]", 
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "&&", 
                    RowBox[{"i", "\[NotEqual]", "j"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i"}], "]"}], "]"}], "=", "1"}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"j", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{"-", "1"}]}], ";"}]}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["XX", 
                    RowBox[{"i", ",", "j"}]], "\[Equal]", 
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "&&", 
                    RowBox[{"i", "\[NotEqual]", "j"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i"}], "]"}], "]"}], "=", "1"}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"j", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{"-", "1"}]}], ";"}]}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["YY", 
                    RowBox[{"i", ",", "j"}]], "\[Equal]", 
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "&&", 
                    RowBox[{"i", "\[NotEqual]", "j"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"i", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "i"}], "]"}], "]"}], "=", "1"}], 
                    ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"j", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Delta", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{"-", "1"}]}], ";"}]}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<\[CapitalDelta] = \>\"", ",", 
           RowBox[{"Delta", "//", "MatrixForm"}]}], "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Make", " ", "the", " ", "variables", " ", "that", " ", "go", " ", 
         "into", " ", "QDT"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"QDT", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          SubscriptBox["y", 
           RowBox[{"m", ",", "n"}]], ",", 
          RowBox[{"{", 
           RowBox[{"m", ",", 
            RowBox[{"Length", "[", "plist", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "IF"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Put", " ", "all", " ", "the", " ", "elements", " ", 
          SubscriptBox["y", 
           RowBox[{"m", ",", "n"}]], " ", "in", " ", "a", " ", "long", " ", 
          "list"}], ",", " ", 
         RowBox[{
         "so", " ", "that", " ", "we", " ", "can", " ", "solve", " ", "for", 
          " ", "the", " ", 
          RowBox[{"list", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"QDTlist", "=", 
        RowBox[{"Flatten", "[", "QDT", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"solution", "=", 
        RowBox[{"Solve", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"P", ".", "QDT"}], "==", "Delta"}], ",", "QDTlist"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"newQDTlist", "=", 
        RowBox[{"QDTlist", "/.", "solution"}]}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{
        "Plug", " ", "in", " ", "solution", " ", "into", " ", "a", " ", 
         "matrix"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Now", " ", "need", " ", "to", " ", "put", " ", "the", " ", 
         "elements", " ", "back", " ", "into", " ", "QDT"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"temp", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", "plist", "]"}], "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "<", 
             RowBox[{"IF", "+", "1"}]}], ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"QDT", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
              RowBox[{"newQDTlist", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "temp"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"temp", "=", 
              RowBox[{"temp", "+", "1"}]}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"QD", "=", 
        RowBox[{"Transpose", "[", "QDT", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<\!\(\*SubscriptBox[\(Q\), \(D\)]\)= \>\"", ",", 
           RowBox[{"QD", "//", "MatrixForm"}]}], "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Q", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"QF", ",", "QD"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Q = \>\"", ",", 
           RowBox[{"Q", "//", "MatrixForm"}]}], "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Gmoduli", "=", 
        RowBox[{"NullSpace", "[", "Q", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<G = \>\"", ",", 
         RowBox[{"Gmoduli", "//", "MatrixForm"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<The moduli space is \>\"", ",", 
         RowBox[{"BFTdim", "[", "Gmoduli", "]"}], ",", 
         "\"\<-dimensional. (NB This is the dimension of its toric diagram!).\
\>\""}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Gshort", "=", 
        RowBox[{"Transpose", "[", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Transpose", "[", "Gmoduli", "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Multmatrix", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Dimensions", "[", 
            RowBox[{
             RowBox[{"Gather", "[", 
              RowBox[{"Transpose", "[", "Gmoduli", "]"}], "]"}], "[", 
             RowBox[{"[", "y", "]"}], "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", 
            RowBox[{
             RowBox[{"Dimensions", "[", 
              RowBox[{"Gather", "[", 
               RowBox[{"Transpose", "[", "Gmoduli", "]"}], "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", "\"\<-------------------------------------\>\"", "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", 
        "\"\<Variables are 'Gmaster'=master space; 'Gmoduli'=moduli space; \
'Gshort'=moduli space where doubles have been removed; \
'Multmatrix'=moultiplicity of each point in Gshort; 'QF'=redundancies (F-term \
charge matrix); 'QD'=D-term charge matrix;\>\"", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", "\"\<-------------------------------------\>\"", "]"}], 
       ";"}]}], "\[IndentingNewLine]", "]"}]}], "*)"}], "\[IndentingNewLine]",
   "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"DONE", ",", " ", 
    RowBox[{"NOW", " ", "CALLED", " ", "moduliSpaceBFT"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Finds", " ", "the", " ", "zig"}], "-", 
    RowBox[{
    "zag", " ", "paths", " ", "expressed", " ", "as", " ", "a", " ", 
     "product", " ", "and", " ", "division", " ", "of", " ", "fields", " ", 
     SubscriptBox["X", 
      RowBox[{"i", ",", "j"}]], " ", 
     RowBox[{"etc", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"sub1", "[", "field_", "]"}], ":=", 
     RowBox[{"field", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"sub2", "[", "field_", "]"}], ":=", 
     RowBox[{"field", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"makeZigzags", "[", 
      RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "K0full", ",", "bvar", ",", "cvar", ",", "ci", ",", "field", ",", 
         "rowpos", ",", "colpos", ",", "column", ",", "row", ",", "j"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "Print", "[", 
         "\"\<zig-zags are stored under \!\(\*SubscriptBox[\(zig\), \
\(i\)]\)=...  and zigzag={list of all \!\(\*SubscriptBox[\(zig\), \(i\)]\)}\>\
\"", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"K0full", "=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{"a", ",", "c"}], "]"}], ",", 
           RowBox[{"Join", "[", 
            RowBox[{"b", ",", "d"}], "]"}], ",", "2"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"bvar", "=", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", "b", "]"}], ",", "0"}], "]"}]}], ";", 
        RowBox[{"(*", 
         RowBox[{"Variables", " ", "in", " ", "b"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"cvar", "=", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", "c", "]"}], ",", "0"}], "]"}]}], ";", 
        RowBox[{"(*", 
         RowBox[{"Variables", " ", "in", " ", "c"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"zigzag", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"First", " ", "go", " ", "throgh", " ", "the", " ", "zig"}],
           "-", 
          RowBox[{
          "zags", " ", "starting", " ", "from", " ", "white", " ", "nodes", 
           " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"i", ".", "e", ".", " ", "starting"}], " ", "from", " ", 
             "fields", " ", "in", " ", "the", "  ", "matrix", " ", 
             "c"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"ci", "=", "1"}], ",", 
          RowBox[{"ci", "<", 
           RowBox[{
            RowBox[{"Length", "[", "c", "]"}], "+", "1"}]}], ",", 
          RowBox[{"ci", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"field", "=", 
            RowBox[{
             RowBox[{"DeleteCases", "[", 
              RowBox[{
               RowBox[{"c", "[", 
                RowBox[{"[", "ci", "]"}], "]"}], ",", "0"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            SubscriptBox["zig", "ci"], "=", "field"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"rowpos", "=", 
            RowBox[{
             RowBox[{"Length", "[", "a", "]"}], "+", "ci"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"While", "[", 
            RowBox[{"True", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"colpos", "=", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{
                  RowBox[{"K0full", "[", 
                   RowBox[{"[", "rowpos", "]"}], "]"}], ",", "field"}], "]"}],
                 "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
              RowBox[{"(*", 
               RowBox[{
               "colpos", " ", "is", " ", "the", " ", "column", " ", "number", 
                " ", "this", " ", "field", " ", "is", " ", "in"}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
               "Now", " ", "look", " ", "for", " ", "its", " ", "partner", 
                " ", "in", " ", "the", " ", "column"}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"column", "=", 
               RowBox[{"DeleteCases", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Transpose", "[", "K0full", "]"}], "[", 
                  RowBox[{"[", "colpos", "]"}], "]"}], ",", "0"}], "]"}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"j", "=", "1"}], ",", 
                RowBox[{"j", "<", 
                 RowBox[{
                  RowBox[{"Length", "[", "column", "]"}], "+", "1"}]}], ",", 
                RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"sub1", "[", 
                    RowBox[{"column", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}], "\[Equal]", 
                    RowBox[{"sub2", "[", "field", "]"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["zig", "ci"], "=", 
                    RowBox[{
                    SubscriptBox["zig", "ci"], "/", 
                    RowBox[{"column", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"field", "=", 
                    RowBox[{"column", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", 
                  "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"If", " ", 
                 RowBox[{"we", "'"}], "ve", " ", "ended", " ", "up", " ", 
                 "inside", " ", "c"}], ",", " ", 
                RowBox[{
                 RowBox[{
                 "this", " ", "is", " ", "the", " ", "end", " ", "of", " ", 
                  "the", " ", "zig"}], "-", "zag"}]}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"MemberQ", "[", 
                 RowBox[{"cvar", ",", "field"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{
                   RowBox[{"Subscript", "[", 
                    RowBox[{"\"\<zig\>\"", ",", "ci"}], "]"}], ",", 
                   "\"\< = \>\"", ",", 
                   SubscriptBox["zig", "ci"]}], "]"}], ";", 
                 RowBox[{"zigzag", "=", 
                  RowBox[{"Join", "[", 
                   RowBox[{"zigzag", ",", 
                    RowBox[{"{", 
                    SubscriptBox["zig", "ci"], "}"}]}], "]"}]}], ";", 
                 RowBox[{"Break", "[", "]"}]}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
               "Find", " ", "which", " ", "row", " ", "number", " ", "this", 
                " ", "new", " ", "field", " ", "has"}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"rowpos", "=", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Transpose", "[", "K0full", "]"}], "[", 
                   RowBox[{"[", "colpos", "]"}], "]"}], ",", "field"}], "]"}],
                 "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
               "Now", " ", "look", " ", "for", " ", "its", " ", "partner", 
                " ", "in", " ", "the", " ", "row"}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"row", "=", 
               RowBox[{"DeleteCases", "[", 
                RowBox[{
                 RowBox[{"K0full", "[", 
                  RowBox[{"[", "rowpos", "]"}], "]"}], ",", "0"}], "]"}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"j", "=", "1"}], ",", 
                RowBox[{"j", "<", 
                 RowBox[{
                  RowBox[{"Length", "[", "row", "]"}], "+", "1"}]}], ",", 
                RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"sub1", "[", 
                    RowBox[{"row", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}], "\[Equal]", 
                    RowBox[{"sub2", "[", "field", "]"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["zig", "ci"], "=", 
                    RowBox[{
                    SubscriptBox["zig", "ci"], 
                    RowBox[{"row", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"field", "=", 
                    RowBox[{"row", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", 
                  "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"If", " ", 
                 RowBox[{"we", "'"}], "ve", " ", "ended", " ", "up", " ", 
                 "inside", " ", "b"}], ",", " ", 
                RowBox[{
                 RowBox[{
                 "this", " ", "is", " ", "the", " ", "end", " ", "of", " ", 
                  "the", " ", "zig"}], "-", "zag"}]}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"MemberQ", "[", 
                 RowBox[{"bvar", ",", "field"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{
                   RowBox[{"Subscript", "[", 
                    RowBox[{"\"\<zig\>\"", ",", "ci"}], "]"}], ",", 
                   "\"\< = \>\"", ",", 
                   SubscriptBox["zig", "ci"]}], "]"}], ";", 
                 RowBox[{"zigzag", "=", 
                  RowBox[{"Join", "[", 
                   RowBox[{"zigzag", ",", 
                    RowBox[{"{", 
                    SubscriptBox["zig", "ci"], "}"}]}], "]"}]}], ";", 
                 RowBox[{"Break", "[", "]"}]}]}], "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Now", " ", "go", " ", "throgh", " ", "the", " ", "zig"}], 
          "-", 
          RowBox[{
          "zags", " ", "starting", " ", "from", " ", "black", " ", "nodes", 
           " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"i", ".", "e", ".", " ", "starting"}], " ", "from", " ", 
             "fields", " ", "in", " ", "the", "  ", "matrix", " ", 
             "b"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"bi", "=", "1"}], ",", 
          RowBox[{"bi", "<", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Transpose", "[", "b", "]"}], "]"}], "+", "1"}]}], ",", 
          RowBox[{"bi", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"field", "=", 
            RowBox[{
             RowBox[{"DeleteCases", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Transpose", "[", "b", "]"}], "[", 
                RowBox[{"[", "bi", "]"}], "]"}], ",", "0"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            SubscriptBox["zig", 
             RowBox[{
              RowBox[{"Length", "[", "c", "]"}], "+", "bi"}]], "=", 
            RowBox[{"1", "/", "field"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"colpos", "=", 
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"Transpose", "[", "a", "]"}], "]"}], "+", "bi"}]}], ";",
            "\[IndentingNewLine]", 
           RowBox[{"While", "[", 
            RowBox[{"True", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"rowpos", "=", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Transpose", "[", "K0full", "]"}], "[", 
                   RowBox[{"[", "colpos", "]"}], "]"}], ",", "field"}], "]"}],
                 "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
               "Now", " ", "look", " ", "for", " ", "its", " ", "partner", 
                " ", "in", " ", "the", " ", "row"}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"row", "=", 
               RowBox[{"DeleteCases", "[", 
                RowBox[{
                 RowBox[{"K0full", "[", 
                  RowBox[{"[", "rowpos", "]"}], "]"}], ",", "0"}], "]"}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"j", "=", "1"}], ",", 
                RowBox[{"j", "<", 
                 RowBox[{
                  RowBox[{"Length", "[", "row", "]"}], "+", "1"}]}], ",", 
                RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"sub1", "[", 
                    RowBox[{"row", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}], "\[Equal]", 
                    RowBox[{"sub2", "[", "field", "]"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["zig", 
                    RowBox[{
                    RowBox[{"Length", "[", "c", "]"}], "+", "bi"}]], "=", 
                    RowBox[{
                    SubscriptBox["zig", 
                    RowBox[{
                    RowBox[{"Length", "[", "c", "]"}], "+", "bi"}]], 
                    RowBox[{"row", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"field", "=", 
                    RowBox[{"row", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", 
                  "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"If", " ", 
                 RowBox[{"we", "'"}], "ve", " ", "ended", " ", "up", " ", 
                 "inside", " ", "b"}], ",", " ", 
                RowBox[{
                 RowBox[{
                 "this", " ", "is", " ", "the", " ", "end", " ", "of", " ", 
                  "the", " ", "zig"}], "-", "zag"}]}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"MemberQ", "[", 
                 RowBox[{"bvar", ",", "field"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{
                   RowBox[{"Subscript", "[", 
                    RowBox[{"\"\<zig\>\"", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "c", "]"}], "+", "bi"}]}], "]"}], 
                   ",", "\"\< = \>\"", ",", 
                   SubscriptBox["zig", 
                    RowBox[{
                    RowBox[{"Length", "[", "c", "]"}], "+", "bi"}]]}], "]"}], 
                 ";", 
                 RowBox[{"zigzag", "=", 
                  RowBox[{"Join", "[", 
                   RowBox[{"zigzag", ",", 
                    RowBox[{"{", 
                    SubscriptBox["zig", 
                    RowBox[{
                    RowBox[{"Length", "[", "c", "]"}], "+", "bi"}]], "}"}]}], 
                   "]"}]}], ";", 
                 RowBox[{"Break", "[", "]"}]}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
               "Find", " ", "out", " ", "which", " ", "column", " ", "number",
                 " ", "this", " ", "new", " ", "field", " ", "has"}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"colpos", "=", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{
                  RowBox[{"K0full", "[", 
                   RowBox[{"[", "rowpos", "]"}], "]"}], ",", "field"}], "]"}],
                 "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
               "Now", " ", "look", " ", "for", " ", "its", " ", "partner", 
                " ", "in", " ", "the", " ", "column"}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"column", "=", 
               RowBox[{"DeleteCases", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Transpose", "[", "K0full", "]"}], "[", 
                  RowBox[{"[", "colpos", "]"}], "]"}], ",", "0"}], "]"}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"j", "=", "1"}], ",", 
                RowBox[{"j", "<", 
                 RowBox[{
                  RowBox[{"Length", "[", "column", "]"}], "+", "1"}]}], ",", 
                RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"sub1", "[", 
                    RowBox[{"column", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}], "\[Equal]", 
                    RowBox[{"sub2", "[", "field", "]"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["zig", 
                    RowBox[{
                    RowBox[{"Length", "[", "c", "]"}], "+", "bi"}]], "=", 
                    RowBox[{
                    SubscriptBox["zig", 
                    RowBox[{
                    RowBox[{"Length", "[", "c", "]"}], "+", "bi"}]], "/", 
                    RowBox[{"column", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"field", "=", 
                    RowBox[{"column", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Break", "[", "]"}]}]}], "\[IndentingNewLine]", 
                  "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"If", " ", 
                 RowBox[{"we", "'"}], "ve", " ", "ended", " ", "up", " ", 
                 "inside", " ", "c"}], ",", " ", 
                RowBox[{
                 RowBox[{
                 "this", " ", "is", " ", "the", " ", "end", " ", "of", " ", 
                  "the", " ", "zig"}], "-", "zag"}]}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"MemberQ", "[", 
                 RowBox[{"cvar", ",", "field"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{
                   RowBox[{"Subscript", "[", 
                    RowBox[{"\"\<zig\>\"", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "c", "]"}], "+", "bi"}]}], "]"}], 
                   ",", "\"\< = \>\"", ",", 
                   SubscriptBox["zig", 
                    RowBox[{
                    RowBox[{"Length", "[", "c", "]"}], "+", "bi"}]]}], "]"}], 
                 ";", 
                 RowBox[{"zigzag", "=", 
                  RowBox[{"Join", "[", 
                   RowBox[{"zigzag", ",", 
                    RowBox[{"{", 
                    SubscriptBox["zig", 
                    RowBox[{
                    RowBox[{"Length", "[", "c", "]"}], "+", "bi"}]], "}"}]}], 
                   "]"}]}], ";", 
                 RowBox[{"Break", "[", "]"}]}]}], "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"DONE", "!"}], " ", "NOW", " ", "CALLED", " ", "makeZigZags"}], 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Tells", " ", "you", " ", "which", " ", "two", " ", "perfect", " ", 
    "matchings", " ", "produce", " ", "a", " ", "given", " ", 
    RowBox[{"zigzag", ".", " ", "'"}], 
    RowBox[{"zigzag", "'"}], " ", "should", " ", "be", " ", "given", " ", 
    "as", " ", "the", " ", "product", " ", "and", " ", "division", " ", "of", 
    " ", 
    RowBox[{
     SubscriptBox["X", 
      RowBox[{"i", ",", "j"}]], "'"}], 
    RowBox[{"s", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"zigzagPerfMatchings", "[", "zigzag_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "i", ",", "ja", ",", "ia", ",", "ib", ",", "signs", ",", 
        "positiveplist"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"signs", "=", 
        RowBox[{"plist", "/.", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Xlist", "[", 
             RowBox[{"[", "ii", "]"}], "]"}], "\[Rule]", "1"}], ",", 
           RowBox[{"{", 
            RowBox[{"ii", ",", 
             RowBox[{"Length", "[", "Xlist", "]"}]}], "}"}]}], "]"}]}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"positiveplist", "=", 
        RowBox[{"plist", "*", "signs"}]}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{
        "Make", " ", "a", " ", "list", " ", "of", " ", "perfect", " ", 
         "matchings", " ", "all", " ", "with", " ", "positive", " ", "signs", 
         " ", 
         RowBox[{"(", 
          RowBox[{
          "Kasteleyn", " ", "sometimes", " ", "gives", " ", "negative", " ", 
           "signs"}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"ja", "=", "1"}], ",", 
         RowBox[{"ja", "<", 
          RowBox[{
           RowBox[{"Length", "[", "zigzag", "]"}], "+", "1"}]}], ",", 
         RowBox[{"ja", "++"}], ",", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Go", " ", "through", " ", "the", " ", "zig"}], "-", 
           "zags"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"ia", "=", "1"}], ",", 
            RowBox[{"ia", "<", 
             RowBox[{
              RowBox[{"Length", "[", "positiveplist", "]"}], "+", "1"}]}], 
            ",", 
            RowBox[{"ia", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"ib", "=", "1"}], ",", 
               RowBox[{"ib", "<", 
                RowBox[{
                 RowBox[{"Length", "[", "positiveplist", "]"}], "+", "1"}]}], 
               ",", 
               RowBox[{"ib", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"zigzag", "[", 
                    RowBox[{"[", "ja", "]"}], "]"}], "\[Equal]", 
                   RowBox[{
                    RowBox[{"positiveplist", "[", 
                    RowBox[{"[", "ia", "]"}], "]"}], "/", 
                    RowBox[{"positiveplist", "[", 
                    RowBox[{"[", "ib", "]"}], "]"}]}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<zig-zag \>\"", ",", "ja", ",", "\"\< = pm[[\>\"", 
                    ",", "ia", ",", "\"\<]]/pm[[\>\"", ",", "ib", ",", 
                    "\"\<]]\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", 
                 "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"DONE", "!"}], " ", "NOW", " ", "CALLED", " ", 
    "zigZagsAsPerfectMatchings"}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Checks", " ", "whether", " ", "the", " ", "inputed", " ", 
     "\"\<matroida\>\""}], "=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "b", ",", "c", ",", ".."}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"d", ",", "e", ",", "f", ",", ".."}], "}"}], ",", "..."}], 
      "}"}], "is", " ", "indeed", " ", "a", " ", 
     RowBox[{"matroid", ".", " ", "Returns"}], " ", "True", " ", "or", " ", 
     "False"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"matroidcheck", "[", "matroida_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "matroid", ",", "win", ",", "i", ",", "j", ",", "pairscore", ",", "k", 
        ",", "el", ",", "trial", ",", "success", ",", "matr"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"matroid", "=", 
        RowBox[{"Map", "[", 
         RowBox[{"Sort", ",", "matroida"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"win", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", "matroid", "]"}], "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "<", 
             RowBox[{
              RowBox[{"Length", "[", "matroid", "]"}], "+", "1"}]}], ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"i", "\[NotEqual]", "j"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"pairscore", "=", "1"}], ";", "\[IndentingNewLine]", 
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"k", "=", "1"}], ",", 
                  RowBox[{"k", "<", 
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"matroid", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "+", "1"}]}], ",", 
                  RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"el", "=", "1"}], ",", 
                    RowBox[{"el", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"matroid", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}], "+", "1"}]}], ",", 
                    RowBox[{"el", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"trial", "=", 
                    RowBox[{"Sort", "[", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"Delete", "[", 
                    RowBox[{
                    RowBox[{"matroid", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "k"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"matroid", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "el"}], "]"}], "]"}], "}"}]}], "]"}], 
                    "]"}]}], ";", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Try", " ", "exchanging", " ", "with", " ", "each", " ", 
                    "element", " ", "of", " ", 
                    RowBox[{"J", "."}]}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"matroid", ",", "trial"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"success", "=", "1"}], ";", 
                    RowBox[{"Break", "[", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"success", "=", "0"}], ";"}]}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"success", "\[Equal]", "0"}], ",", 
                    RowBox[{
                    RowBox[{"pairscore", "=", "0"}], ";"}]}], "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"pairscore", "\[Equal]", "0"}], ",", 
               RowBox[{
                RowBox[{"win", "=", "0"}], ";"}]}], "]"}]}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"win", "\[Equal]", "1"}], ",", 
         RowBox[{"matr", "=", "True"}], ",", 
         RowBox[{"matr", "=", "False"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "matr"}]}], "\[IndentingNewLine]", "]"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"DONE", ",", " ", 
    RowBox[{"NOW", " ", "CALLED", " ", "matroidQ"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Does", " ", "the", " ", "same", " ", "as", " ", "matroidcheck"}],
     ",", " ", 
    RowBox[{
    "but", " ", "instead", " ", "or", " ", "returning", " ", "True", " ", 
     "or", " ", "False"}], ",", " ", 
    RowBox[{
    "it", " ", "prints", " ", "out", " ", "all", " ", "the", " ", 
     "failures"}], ",", " ", 
    RowBox[{"or", " ", "whether", " ", "you", " ", "have", " ", "a", " ", 
     RowBox[{"success", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"matroidcheckwrite", "[", "matroida_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "matroid", ",", "win", ",", "i", ",", "j", ",", "pairscore", ",", "k", 
        ",", "el", ",", "trial", ",", "success"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"matroid", "=", 
        RowBox[{"Map", "[", 
         RowBox[{"Sort", ",", "matroida"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"win", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", "matroid", "]"}], "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "<", 
             RowBox[{
              RowBox[{"Length", "[", "matroid", "]"}], "+", "1"}]}], ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"i", "\[NotEqual]", "j"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"pairscore", "=", "1"}], ";", "\[IndentingNewLine]", 
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"k", "=", "1"}], ",", 
                  RowBox[{"k", "<", 
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"matroid", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "+", "1"}]}], ",", 
                  RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"el", "=", "1"}], ",", 
                    RowBox[{"el", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"matroid", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}], "+", "1"}]}], ",", 
                    RowBox[{"el", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"trial", "=", 
                    RowBox[{"Sort", "[", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"Delete", "[", 
                    RowBox[{
                    RowBox[{"matroid", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "k"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"matroid", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "el"}], "]"}], "]"}], "}"}]}], "]"}], 
                    "]"}]}], ";", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Try", " ", "exchanging", " ", "with", " ", "each", " ", 
                    "element", " ", "of", " ", 
                    RowBox[{"J", "."}]}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"matroid", ",", "trial"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"success", "=", "1"}], ";", 
                    RowBox[{"Break", "[", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"success", "=", "0"}], ";"}]}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"success", "\[Equal]", "0"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"pairscore", "=", "0"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Print", "[", 
                    RowBox[{"\"\<Failed! This is I=\>\"", ",", 
                    RowBox[{"matroid", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\"\< and J=\>\"", 
                    ",", 
                    RowBox[{"matroid", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", "\"\< where \>\"", 
                    ",", 
                    RowBox[{"matroid", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "k"}], "]"}], "]"}], ",", 
                    "\"\<\[Element]I cannot be exchanged with anyone in \
J\>\""}], "]"}], ";"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
                ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"pairscore", "\[Equal]", "0"}], ",", 
               RowBox[{
                RowBox[{"win", "=", "0"}], ";"}]}], "]"}]}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"win", "\[Equal]", "1"}], ",", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<It is a matroid!\>\"", "]"}], ";"}]}], 
        "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"DONE", ",", " ", 
    RowBox[{"NOW", " ", "CALLED", " ", "matroidViolationCheck"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Finds", " ", "all", " ", "Plucker", " ", "relations", " ", "for", " ", 
    "the", " ", "Pluckers", " ", "of", " ", "Gr", 
    RowBox[{"(", 
     RowBox[{"k", ",", "n"}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"pluckerRelations", "[", 
     RowBox[{"k_", ",", "n_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "aa", ",", "bb", ",", "conditions", ",", "\[CapitalDelta]", ",", "i", 
        ",", "j", ",", "relations", ",", "todel", ",", "ii", ",", "jj"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"bb", "=", 
        RowBox[{"Subsets", "[", 
         RowBox[{
          RowBox[{"Range", "[", "n", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", "-", "1"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"aa", "=", 
        RowBox[{"Subsets", "[", 
         RowBox[{
          RowBox[{"Range", "[", "n", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", "+", "1"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"relations", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"conditions", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Rule", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"MapThread", "[", 
             RowBox[{"Subscript", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"ConstantArray", "[", 
                 RowBox[{"\[CapitalDelta]", ",", 
                  RowBox[{"Length", "[", "bb", "]"}]}], "]"}], ",", "bb"}], 
               "}"}]}], "]"}], ",", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"0", ",", 
              RowBox[{"Length", "[", "bb", "]"}]}], "]"}]}], "}"}]}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", "bb", "]"}], "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "<", 
             RowBox[{
              RowBox[{"Length", "[", "aa", "]"}], "+", "1"}]}], ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"relations", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"relations", ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], 
                    RowBox[{"dum", "-", "1"}]], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], 
                    RowBox[{
                    RowBox[{"PermutationOrder", "[", 
                    RowBox[{"Ordering", "[", 
                    RowBox[{"DeleteDuplicates", "[", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"bb", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"aa", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "dum"}], "]"}], "]"}], "}"}]}], "]"}], 
                    "]"}], "]"}], "]"}], "-", "1"}]], 
                    SubscriptBox["\[CapitalDelta]", 
                    RowBox[{"Union", "[", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"bb", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"aa", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "dum"}], "]"}], "]"}], "}"}]}], "]"}], 
                    "]"}]], 
                    SubscriptBox["\[CapitalDelta]", 
                    RowBox[{"Complement", "[", 
                    RowBox[{
                    RowBox[{"aa", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"aa", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "dum"}], "]"}], "]"}], "}"}]}], 
                    "]"}]]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"dum", ",", 
                    RowBox[{"k", "+", "1"}]}], "}"}]}], "]"}], "\[Equal]", 
                   "0"}], "}"}], "/.", "conditions"}]}], "]"}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"relations", "=", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{"relations", ",", "True"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<We have \>\"", ",", 
           RowBox[{"Length", "[", "relations", "]"}], ",", 
           "\"\< Plucker relations:\>\""}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"relations", "//", "MatrixForm"}], "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Remove", " ", "the", " ", "ones", " ", "that", " ", "are", " ", 
         "duplicate", " ", "up", " ", "to", " ", "a", " ", "minus", " ", 
         "sign"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"todel", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"ii", "=", "1"}], ",", 
         RowBox[{"ii", "<", 
          RowBox[{
           RowBox[{"Length", "[", "relations", "]"}], "+", "1"}]}], ",", 
         RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"jj", "=", 
             RowBox[{"ii", "+", "1"}]}], ",", 
            RowBox[{"jj", "<", 
             RowBox[{
              RowBox[{"Length", "[", "relations", "]"}], "+", "1"}]}], ",", 
            RowBox[{"jj", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"relations", "[", 
                  RowBox[{"[", "ii", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
                RowBox[{"-", 
                 RowBox[{
                  RowBox[{"relations", "[", 
                   RowBox[{"[", "jj", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"todel", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{"todel", ",", 
                   RowBox[{"{", 
                    RowBox[{"{", "ii", "}"}], "}"}]}], "]"}]}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"relations", "=", 
        RowBox[{"Delete", "[", 
         RowBox[{"relations", ",", "todel"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "relations"}]}], "\[IndentingNewLine]", "]"}]}],
    "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"DONE", ",", " ", 
    RowBox[{"SAME", " ", "NAME"}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Gives", " ", "you", " ", "the", " ", "replacement", " ", "list", " ", 
    "for", " ", "perfect", " ", "matching", " ", "going", " ", "to", " ", 
    "their", " ", "source", " ", 
    RowBox[{"set", ".", " ", "You"}], " ", "need", " ", "to", " ", "run", " ",
     "moduliGaugingX", " ", 
    RowBox[{"first", ".", " ", "The"}], " ", "ordering", " ", "is", " ", 
    "given", " ", "in", " ", "the", " ", "form", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"2", ",", "3"}]], "\[Rule]", "1"}], ",", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"4", ",", "5"}]], "\[Rule]", "3"}], ",", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"2", ",", "5"}]], "\[Rule]", "4"}], ",", 
       RowBox[{
        SubscriptBox["X", 
         RowBox[{"4", ",", "3"}]], "\[Rule]", "2"}]}], "}"}], "."}]}], "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"pmsourcesOrderingByHand", "[", 
     RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_", ",", "ordering_"}], "]"}],
     ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "flatb", ",", "flatc", ",", "toplu", ",", "pflow", ",", "k", ",", "j", 
        ",", "guys", ",", "i"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"ordering", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Rule", ",", 
           RowBox[{"{", 
            RowBox[{"xb", ",", 
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", "xb", "]"}], "]"}]}], "}"}]}], "]"}]}], 
        ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"ordering", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"2", ",", "3"}]], "\[Rule]", "1"}], ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"4", ",", "5"}]], "\[Rule]", "3"}], ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"2", ",", "5"}]], "\[Rule]", "4"}], ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"4", ",", "3"}]], "\[Rule]", "2"}]}], "}"}]}], ";"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"flatb", "=", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", "b", "]"}], ",", "0"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"flatc", "=", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", "c", "]"}], ",", "0"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"toplu", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "<", 
          RowBox[{
           RowBox[{"Length", "[", "plist", "]"}], "+", "1"}]}], ",", 
         RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           SubscriptBox["pflow", "j"], "=", 
           RowBox[{"{", "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"k", "=", "1"}], ",", 
         RowBox[{"k", "<", 
          RowBox[{
           RowBox[{"Length", "[", "xb", "]"}], "+", "1"}]}], ",", 
         RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"flatb", ",", 
              RowBox[{"xb", "[", 
               RowBox[{"[", "k", "]"}], "]"}]}], "]"}], ",", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Gli", " ", "Uni", " ", "sono", " ", "sorgent"}], ",", 
              " ", 
              RowBox[{
              "se", " ", "no", " ", "gli", " ", "zero", " ", "sono", " ", 
               "sorgenti"}]}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"guys", "=", 
              RowBox[{
               RowBox[{"Transpose", "[", 
                RowBox[{"Position", "[", 
                 RowBox[{
                  RowBox[{"P", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{"Xlist", ",", 
                    RowBox[{"xb", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "]"}], ",", 
                  "1"}], "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"i", "=", "1"}], ",", 
               RowBox[{"i", "<", 
                RowBox[{
                 RowBox[{"Length", "[", "guys", "]"}], "+", "1"}]}], ",", 
               RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 SubscriptBox["pflow", 
                  RowBox[{"guys", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]], "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{
                   SubscriptBox["pflow", 
                    RowBox[{"guys", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]], ",", 
                   RowBox[{"{", 
                    RowBox[{"xb", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "}"}]}], "]"}]}], ";"}]}],
               "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"flatc", ",", 
              RowBox[{"xb", "[", 
               RowBox[{"[", "k", "]"}], "]"}]}], "]"}], ",", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Gli", " ", "Uni", " ", "sono", " ", "sorgent"}], ",", 
              " ", 
              RowBox[{
              "se", " ", "no", " ", "gli", " ", "zero", " ", "sono", " ", 
               "sorgenti"}]}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"guys", "=", 
              RowBox[{
               RowBox[{"Transpose", "[", 
                RowBox[{"Position", "[", 
                 RowBox[{
                  RowBox[{"P", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{"Xlist", ",", 
                    RowBox[{"xb", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "]"}], ",", 
                  "0"}], "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"i", "=", "1"}], ",", 
               RowBox[{"i", "<", 
                RowBox[{
                 RowBox[{"Length", "[", "guys", "]"}], "+", "1"}]}], ",", 
               RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 SubscriptBox["pflow", 
                  RowBox[{"guys", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]], "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{
                   SubscriptBox["pflow", 
                    RowBox[{"guys", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]], ",", 
                   RowBox[{"{", 
                    RowBox[{"xb", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "}"}]}], "]"}]}], ";"}]}],
               "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "<", 
          RowBox[{
           RowBox[{"Length", "[", "plist", "]"}], "+", "1"}]}], ",", 
         RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           SubscriptBox["pflow", "j"], "=", 
           RowBox[{"Sort", "[", 
            RowBox[{
             SubscriptBox["pflow", "j"], "/.", "ordering"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"toplu", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"toplu", ",", 
             RowBox[{"{", 
              RowBox[{"j", "\[Rule]", 
               SubscriptBox["pflow", "j"]}], "}"}]}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "toplu"}]}],
      "\[IndentingNewLine]", "]"}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"SKIPPED", ",", " ", 
    RowBox[{"NOT", " ", "USEFUL"}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Gives", " ", "you", " ", "the", " ", "path", " ", "matrix", " ", "of", 
    " ", "a", " ", 
    RowBox[{"BFT", ".", " ", "You"}], " ", "have", " ", "to", " ", "first", 
    " ", "run", " ", 
    RowBox[{"moduliGaugingX", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"pathmatrix", "[", 
     RowBox[{
     "a_", ",", "b_", ",", "c_", ",", "d_", ",", "pmref_", ",", "order_"}], 
     "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "kast", ",", "sources", ",", "cond", ",", "i", ",", "j", ",", 
        "kastduo", ",", "cond3", ",", "kasttrio", ",", "bigguy", ",", "inv"}],
        "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"kast", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{"a", ",", "c"}], "]"}], ",", 
          RowBox[{"Join", "[", 
           RowBox[{"b", ",", "d"}], "]"}], ",", "2"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"sources", "=", 
        RowBox[{"findSources", "[", 
         RowBox[{
         "a", ",", "b", ",", "c", ",", "d", ",", "order", ",", "pmref"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"cond", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"Variables", "[", "pmref", "]"}], "]"}], "+", "1"}]}], 
         ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"cond", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"cond", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"Variables", "[", "pmref", "]"}], "[", 
                RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", "0"}], "}"}]}], 
            "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"kastduo", "=", 
        RowBox[{"kast", "/.", "cond"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"cond3", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", "Xlist", "]"}], "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"FreeQ", "[", 
             RowBox[{
              RowBox[{"Variables", "[", "pmref", "]"}], ",", 
              RowBox[{"Xlist", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"cond3", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"cond3", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Xlist", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", "0"}], "}"}]}], 
               "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
            RowBox[{
             RowBox[{"cond3", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"cond3", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Xlist", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
                  RowBox[{"1", "/", 
                   RowBox[{"Xlist", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}]}], "]"}]}], 
             ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"kasttrio", "=", 
        RowBox[{"kast", "/.", "cond3"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"bigguy", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"IdentityMatrix", "[", 
             RowBox[{
              RowBox[{"Length", "[", "a", "]"}], "+", 
              RowBox[{"Length", "[", "c", "]"}]}], "]"}], ",", 
            RowBox[{"-", 
             RowBox[{"Transpose", "[", "kasttrio", "]"}]}]}], "]"}], ",", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"-", "kastduo"}], ",", 
            RowBox[{"IdentityMatrix", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Dimensions", "[", "a", "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "+", 
              RowBox[{
               RowBox[{"Dimensions", "[", "b", "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}], ",", "2"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"bigguy", "//", "MatrixForm"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"inv", "=", 
        RowBox[{"Inverse", "[", "bigguy", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"inv", "//", "MatrixForm"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"pathmat", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{"Length", "[", "sources", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", 
            RowBox[{"Length", "[", "order", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", "sources", "]"}], "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"j", "=", "1"}], ",", 
           RowBox[{"j", "<", 
            RowBox[{
             RowBox[{"Length", "[", "order", "]"}], "+", "1"}]}], ",", 
           RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"pathmat", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
             RowBox[{"inv", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"sources", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", 
                RowBox[{"order", "[", 
                 RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "]"}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pathmat", "=", 
        RowBox[{"Expand", "[", 
         RowBox[{"Simplify", "[", "pathmat", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"fullmatrix", "=", "inv"}], ";", "\[IndentingNewLine]", 
       RowBox[{"loops", "=", 
        RowBox[{"Expand", "[", 
         RowBox[{"Det", "[", "bigguy", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", 
        "\"\<The full path matrix is 'fullmatrix', the part that goes from \
sources to sinks is 'pathmat', the loop denominator is 'loops'.\>\"", 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"DONE", ",", " ", 
    RowBox[{"NOW", " ", "CALLED", " ", "pathMatrix"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Order", " ", "should", " ", "be", " ", 
     RowBox[{"e", ".", "g", ".", " ", 
      RowBox[{"{", 
       RowBox[{"7", ",", "12", ",", "6", ",", "4", ",", "5"}], "}"}], ".", 
      " ", "The"}], " ", "function", " ", "will", " ", "return", " ", "the", 
     " ", "sources"}], ",", " ", 
    RowBox[{"e", ".", "g", ".", " ", 
     RowBox[{"{", 
      RowBox[{"12", ",", "6", ",", "5"}], "}"}], "."}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"findSources", "[", 
     RowBox[{
     "a_", ",", "b_", ",", "c_", ",", "d_", ",", "order_", ",", "pmref_"}], 
     "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "darul", ",", "invrul", ",", "btra", ",", "xtonode", ",", "i", ",", 
        "sources"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"darul", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Rule", ",", 
          RowBox[{"{", 
           RowBox[{"order", ",", 
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "order", "]"}], "]"}]}], "}"}]}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"invrul", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Rule", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "order", "]"}], "]"}], ",", "order"}], 
           "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Now", " ", "translate", " ", "fields", " ", "into", " ", "node", " ",
          "numbers"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"btra", "=", 
        RowBox[{"Transpose", "[", "b", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"xtonode", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", "c", "]"}], "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"xtonode", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"xtonode", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"DeleteCases", "[", 
                 RowBox[{
                  RowBox[{"c", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", "0"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"i", "+", 
                 RowBox[{"Length", "[", "a", "]"}]}], ")"}]}], "}"}]}], 
            "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "<", 
          RowBox[{
           RowBox[{"Length", "[", "btra", "]"}], "+", "1"}]}], ",", 
         RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"xtonode", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"xtonode", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"DeleteCases", "[", 
                 RowBox[{
                  RowBox[{"btra", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], ",", "0"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"j", "+", 
                 RowBox[{"Length", "[", "a", "]"}], "+", 
                 RowBox[{"Length", "[", "c", "]"}], "+", 
                 RowBox[{
                  RowBox[{"Dimensions", "[", "a", "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}], "}"}]}], "]"}]}],
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"sources", "=", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Complement", "[", 
            RowBox[{
             RowBox[{"DeleteCases", "[", 
              RowBox[{
               RowBox[{"Flatten", "[", "c", "]"}], ",", "0"}], "]"}], ",", 
             RowBox[{"Intersection", "[", 
              RowBox[{
               RowBox[{"DeleteCases", "[", 
                RowBox[{
                 RowBox[{"Flatten", "[", "c", "]"}], ",", "0"}], "]"}], ",", 
               RowBox[{"Variables", "[", "pmref", "]"}]}], "]"}]}], "]"}], 
           ",", 
           RowBox[{"Intersection", "[", 
            RowBox[{
             RowBox[{"DeleteCases", "[", 
              RowBox[{
               RowBox[{"Flatten", "[", "b", "]"}], ",", "0"}], "]"}], ",", 
             RowBox[{"Variables", "[", "pmref", "]"}]}], "]"}]}], "]"}], "/.",
          "xtonode"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"sources", "=", 
        RowBox[{
         RowBox[{"Sort", "[", 
          RowBox[{"sources", "/.", "darul"}], "]"}], "/.", "invrul"}]}], ";", 
       "\[IndentingNewLine]", "sources"}]}], "\[IndentingNewLine]", "]"}]}], 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"DONE", ",", " ", 
    RowBox[{
    "SAME", " ", "NAME", " ", "BUT", " ", "USES", " ", "DIFFERENT", " ", 
     "INPUT", " ", "AND", " ", "OUTPUT"}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Order", " ", "should", " ", "be", " ", 
     RowBox[{"e", ".", "g", ".", " ", 
      RowBox[{"{", 
       RowBox[{"7", ",", "12", ",", "6", ",", "4", ",", "5"}], "}"}], ".", 
      " ", "The"}], " ", "function", " ", "will", " ", "return", " ", "the", 
     " ", "sinks"}], ",", " ", 
    RowBox[{"e", ".", "g", ".", " ", 
     RowBox[{"{", 
      RowBox[{"7", ",", "4"}], "}"}], "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"findSinks", "[", 
     RowBox[{
     "a_", ",", "b_", ",", "c_", ",", "d_", ",", "order_", ",", "pmref_"}], 
     "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "darul", ",", "invrul", ",", "btra", ",", "xtonode", ",", "i", ",", 
        "sinks"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"darul", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Rule", ",", 
          RowBox[{"{", 
           RowBox[{"order", ",", 
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "order", "]"}], "]"}]}], "}"}]}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"invrul", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Rule", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "order", "]"}], "]"}], ",", "order"}], 
           "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Now", " ", "translate", " ", "fields", " ", "into", " ", "node", " ",
          "numbers"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"btra", "=", 
        RowBox[{"Transpose", "[", "b", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"xtonode", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", "c", "]"}], "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"xtonode", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"xtonode", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"DeleteCases", "[", 
                 RowBox[{
                  RowBox[{"c", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", "0"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"i", "+", 
                 RowBox[{"Length", "[", "a", "]"}]}], ")"}]}], "}"}]}], 
            "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "<", 
          RowBox[{
           RowBox[{"Length", "[", "btra", "]"}], "+", "1"}]}], ",", 
         RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"xtonode", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"xtonode", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"DeleteCases", "[", 
                 RowBox[{
                  RowBox[{"btra", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], ",", "0"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"j", "+", 
                 RowBox[{"Length", "[", "a", "]"}], "+", 
                 RowBox[{"Length", "[", "c", "]"}], "+", 
                 RowBox[{
                  RowBox[{"Dimensions", "[", "a", "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}], "}"}]}], "]"}]}],
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"sinks", "=", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Intersection", "[", 
            RowBox[{
             RowBox[{"DeleteCases", "[", 
              RowBox[{
               RowBox[{"Flatten", "[", "c", "]"}], ",", "0"}], "]"}], ",", 
             RowBox[{"Variables", "[", "pmref", "]"}]}], "]"}], ",", 
           RowBox[{"Complement", "[", 
            RowBox[{
             RowBox[{"DeleteCases", "[", 
              RowBox[{
               RowBox[{"Flatten", "[", "b", "]"}], ",", "0"}], "]"}], ",", 
             RowBox[{"Intersection", "[", 
              RowBox[{
               RowBox[{"DeleteCases", "[", 
                RowBox[{
                 RowBox[{"Flatten", "[", "b", "]"}], ",", "0"}], "]"}], ",", 
               RowBox[{"Variables", "[", "pmref", "]"}]}], "]"}]}], "]"}]}], 
          "]"}], "/.", "xtonode"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"sinks", "=", 
        RowBox[{
         RowBox[{"Sort", "[", 
          RowBox[{"sinks", "/.", "darul"}], "]"}], "/.", "invrul"}]}], ";", 
       "\[IndentingNewLine]", "sinks"}]}], "\[IndentingNewLine]", "]"}]}], 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"DONE", ",", " ", 
    RowBox[{
    "SAME", " ", "NAME", " ", "BUT", " ", "USES", " ", "DIFFERENT", " ", 
     "INPUT", " ", "AND", " ", "OUTPUT"}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Need", " ", "to", " ", "first", " ", "run", " ", 
      RowBox[{
       RowBox[{"moduliGaugingX", "[", 
        RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], ".", " ", "It"}], 
      " ", "works", " ", "only", " ", "GENUS", " ", "0", " ", 
      RowBox[{"embeddings", "!"}], " ", 
      RowBox[{"E", ".", "g", ".", " ", "pmref"}]}], "=", 
     RowBox[{"plist", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
    RowBox[{"order", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "9", ",", "10", ",", "7", ",", "8", ",", "11", ",", "19", ",", "6"}], 
       "}"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
        "assumes", " ", "you", " ", "first", " ", "label", " ", "all", " ", 
         "the", " ", "internal", " ", "white", " ", "nodes"}], ",", " ", 
        RowBox[{
        "then", " ", "all", " ", "external", " ", "white", " ", "nodes"}], 
        ",", " ", 
        RowBox[{"then", " ", "internal", " ", "black", " ", "nodes"}], ",", 
        " ", 
        RowBox[{"then", " ", "external", " ", "black", " ", "nodes"}]}], 
       ")"}]}]}], ",", " ", 
    RowBox[{"cuts", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          SubscriptBox["X", 
           RowBox[{"7", ",", "2"}]], "\[Rule]", 
          RowBox[{"-", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "2"}]]}]}], ",", 
         RowBox[{
          SubscriptBox["X", 
           RowBox[{"2", ",", "9"}]], "\[Rule]", 
          RowBox[{"-", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "9"}]]}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["X", 
          RowBox[{"4", ",", "10"}]], "\[Rule]", 
         RowBox[{"-", 
          SubscriptBox["X", 
           RowBox[{"4", ",", "10"}]]}]}], "}"}]}], "}"}]}], ",", " ", 
    RowBox[{"boundaries", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"9", ",", "10", ",", "11"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"7", ",", "8"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"19", ",", "6"}], "}"}]}], "}"}]}], ",", " ", 
    RowBox[{"boundarycuts", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}], "\[Rule]", 
        RowBox[{"cuts", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"2", ",", "3"}], "}"}], "\[Rule]", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"cuts", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"cuts", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "3"}], "}"}], "\[Rule]", 
        RowBox[{"cuts", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"kastToGrass", "[", 
     RowBox[{
     "a_", ",", "b_", ",", "c_", ",", "d_", ",", "pmref_", ",", "order_", ",",
       "boundaries_", ",", "boundarycuts_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "sources", ",", "sinks", ",", "therule", ",", "inverserule", ",", 
        "repl", ",", "newnumberrule", ",", "newsource", ",", "looprep", ",", 
        "invlooprep", ",", "loopflip", ",", "looplist", ",", "dummy", ",", 
        "i", ",", "l", ",", "loop", ",", "j", ",", "count", ",", "k", ",", 
        "terms", ",", "postnikovpathloop", ",", "numtoorder", ",", 
        "postgekhtmatrixloop", ",", "bguys", ",", "tempmat", ",", "pmloops", 
        ",", "kmat", ",", "btra", ",", "xtonum", ",", "xorder", ",", 
        "ordering", ",", "subs", ",", "compare", ",", "guys", ",", "compa", 
        ",", "change"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"pathmatrix", "[", 
        RowBox[{
        "a", ",", "b", ",", "c", ",", "d", ",", "pmref", ",", "order"}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", "\"\<This is the path matrix 'pathmat':\>\"", "]"}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"pathmat", "//", "MatrixForm"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"sources", "=", 
        RowBox[{"findSources", "[", 
         RowBox[{
         "a", ",", "b", ",", "c", ",", "d", ",", "order", ",", "pmref"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"sinks", "=", 
        RowBox[{"findSinks", "[", 
         RowBox[{
         "a", ",", "b", ",", "c", ",", "d", ",", "order", ",", "pmref"}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Now", " ", "make", " ", "it", " ", "nicer", " ", "and", " ", "plug", 
         " ", "in", " ", 
         RowBox[{"Postnikov", "'"}], "s", " ", "signs"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"First", " ", "make", " ", "the", " ", "replacement", " ", 
         RowBox[{"lists", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"therule", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Rule", ",", 
          RowBox[{"{", 
           RowBox[{"plist", ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              SubscriptBox["pp", "i"], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Length", "[", "plist", "]"}]}], "}"}]}], "]"}]}], 
           "}"}]}], "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "To", " ", "recognize", " ", "stuff", " ", "as", " ", "perfect", " ", 
         "matchings"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"inverserule", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Rule", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              SubscriptBox["pp", "i"], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Length", "[", "plist", "]"}]}], "}"}]}], "]"}], ",", 
            RowBox[{"plist", "/", "pmref"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"repl", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Rule", ",", 
          RowBox[{"{", 
           RowBox[{"Xlist", ",", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"1", ",", 
              RowBox[{"Length", "[", "Xlist", "]"}]}], "]"}]}], "}"}]}], 
         "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "This", " ", "is", " ", "needed", " ", "to", " ", "get", " ", "the", 
         " ", "signs", " ", "right"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"This", " ", "is", " ", "for", " ", 
         RowBox[{"Postnikov", "'"}], "s", " ", "signs"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"newnumberrule", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Rule", ",", 
          RowBox[{"{", 
           RowBox[{"order", ",", 
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "order", "]"}], "]"}]}], "}"}]}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"newsource", "=", 
        RowBox[{"sources", "/.", "newnumberrule"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Make", " ", "the", " ", "rule", " ", "for", " ", "the", " ", 
         "replacement", " ", "of", " ", "loops", " ", "with", " ", 
         "variables", " ", 
         SubscriptBox["loop", "i"]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"looprep", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"invlooprep", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"loopflip", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"looplist", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Times", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"MonomialList", "[", 
                RowBox[{"Expand", "[", 
                 RowBox[{"loops", " ", "pmref"}], "]"}], "]"}], "/", 
               "pmref"}], ")"}], "/.", "repl"}], ",", 
            RowBox[{
             RowBox[{"MonomialList", "[", 
              RowBox[{"Expand", "[", 
               RowBox[{"loops", " ", "pmref"}], "]"}], "]"}], "/", 
             "pmref"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dummy", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", "looplist", "]"}], "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"looplist", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "1"}], ",", "True", 
            ",", "True", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              SubscriptBox["l", "dummy"], "=", 
              RowBox[{"looplist", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"looprep", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"looprep", ",", 
                RowBox[{"{", 
                 RowBox[{
                  SubscriptBox["l", "dummy"], "\[Rule]", 
                  SubscriptBox["loop", "dummy"]}], "}"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"invlooprep", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"invlooprep", ",", 
                RowBox[{"{", 
                 RowBox[{
                  SubscriptBox["loop", "dummy"], "\[Rule]", 
                  SubscriptBox["l", "dummy"]}], "}"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"loopflip", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"loopflip", ",", 
                RowBox[{"{", 
                 RowBox[{
                  SubscriptBox["loop", "dummy"], "\[Rule]", 
                  RowBox[{"-", 
                   SubscriptBox["loop", "dummy"]}]}], "}"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"dummy", "=", 
              RowBox[{"dummy", "+", "1"}]}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"postnikovpath", "=", "pathmat"}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "this", " ", "will", " ", "be", " ", "the", " ", "path", " ", 
         "matrix", " ", "with", " ", 
         RowBox[{"postnikov", "'"}], "s", " ", "signs", " ", "incorporated"}],
         "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", "sources", "]"}], "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", 
         RowBox[{"(*", 
          RowBox[{"Rows", " ", "of", " ", "the", " ", "sign", " ", "matrix"}],
           "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "<", 
             RowBox[{
              RowBox[{"Length", "[", "order", "]"}], "+", "1"}]}], ",", 
            RowBox[{"j", "++"}], ",", 
            RowBox[{"(*", 
             RowBox[{
             "Columns", " ", "of", " ", "the", " ", "sign", " ", "matrix"}], 
             "*)"}], "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"This", " ", "is", " ", "to", " ", "get", " ", 
              RowBox[{"Postnikov", "'"}], "s", " ", "signs"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"count", "=", "0"}], ";", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"k", "=", "1"}], ",", 
               RowBox[{"k", "<", 
                RowBox[{
                 RowBox[{"Length", "[", "sources", "]"}], "+", "1"}]}], ",", 
               RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"newsource", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "j"}], "]"}], "<", 
                    RowBox[{"newsource", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "&&", 
                   RowBox[{
                    RowBox[{"newsource", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "<", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"newsource", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "j"}], "]"}]}]}], 
                  ",", 
                  RowBox[{
                   RowBox[{"count", "=", 
                    RowBox[{"count", "+", "1"}]}], ";"}]}], "]"}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{
               "This", " ", "is", " ", "to", " ", "make", " ", "it", " ", 
                "look", " ", "nice"}], ",", " ", 
               RowBox[{
               "and", " ", "plug", " ", "in", " ", "the", " ", "overall", " ", 
                RowBox[{"signs", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"pathmat", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j"}], "]"}], "]"}], "\[Equal]", "1"}], "||", 
                RowBox[{
                 RowBox[{"pathmat", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j"}], "]"}], "]"}], "\[Equal]", "0"}]}],
                ",", "True", ",", "True", ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Denominator", "[", 
                    RowBox[{"pathmat", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], "\[Equal]", 
                   "1"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{"we", " ", "have", " ", "multiple", " ", "terms"}],
                    "*)"}], "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"terms", "=", 
                    RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
                   RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"k", "=", "1"}], ",", 
                    RowBox[{"k", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"pathmat", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], "+", 
                    "1"}]}], ",", 
                    RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"MonomialList", "[", 
                    RowBox[{"Denominator", "[", 
                    RowBox[{
                    RowBox[{"pathmat", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "]"}], "]"}], "]"}], ">", 
                    "1"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"If", " ", "we", " ", "have", " ", "loops"}], 
                    "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"terms", "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{"terms", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Expand", "[", 
                    RowBox[{"Simplify", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"pathmat", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "loops"}], "]"}], "]"}], 
                    "/", "loops"}], "}"}]}], "]"}]}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"terms", "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{"terms", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"pathmat", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "}"}]}], "]"}]}], ";"}]}], 
                    RowBox[{"(*", 
                    RowBox[{"If", " ", "we", " ", 
                    RowBox[{"don", "'"}], "t", " ", "have", " ", "loops"}], 
                    "*)"}], "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"postnikovpath", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"Total", "[", "terms", "]"}], 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], "count"]}]}], ";"}], 
                  "\[IndentingNewLine]", ",", "True", ",", 
                  RowBox[{"(*", 
                   RowBox[{
                   "we", " ", "have", " ", "only", " ", "one", " ", "term"}], 
                   "*)"}], "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"MonomialList", "[", 
                    RowBox[{"Denominator", "[", 
                    RowBox[{"pathmat", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], "]"}], 
                    "]"}], ">", "1"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "If", " ", "the", " ", "term", " ", "has", " ", "loops"}],
                     "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"postnikovpath", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], "count"], 
                    RowBox[{
                    RowBox[{"Expand", "[", 
                    RowBox[{"Simplify", "[", 
                    RowBox[{
                    RowBox[{"pathmat", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "loops"}], "]"}], 
                    "]"}], "/", "loops"}]}]}], ";"}], "\[IndentingNewLine]", 
                    ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"postnikovpath", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], "count"], 
                    RowBox[{"pathmat", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";"}]}], "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Done", " ", "looking", " ", "nice"}], ",", " ", 
             RowBox[{"and", " ", "overall", " ", 
              RowBox[{"signs", "!"}]}]}], "*)"}], "\[IndentingNewLine]", 
           "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"postnikovpathloop", "=", "postnikovpath"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Now", " ", "replace", " ", "loops", " ", "in", " ", 
         "postnikovpathloop", " ", "with", " ", 
         SubscriptBox["loop", "i"], " ", "variables"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"change", "=", "1"}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "Keeps", " ", "track", " ", "of", " ", "whether", " ", 
         "postnikovpathloop", " ", "changed", " ", "when", " ", "we", " ", 
         "gave", " ", "it", " ", "loopreplacements"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"compa", "=", "postnikovpathloop"}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "This", " ", "is", " ", "what", " ", "we", " ", "compare", " ", 
         "with"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{"change", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"postnikovpathloop", "=", 
           RowBox[{"postnikovpathloop", "/.", "looprep"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"compa", "\[Equal]", "postnikovpathloop"}], ",", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{
              "if", " ", "putting", " ", "in", " ", "loop", " ", 
               "replacement", " ", "changed", " ", "nothing"}], ",", " ", 
              RowBox[{
               RowBox[{"we", "'"}], "ve", " ", "replaced", " ", "all", " ", 
               "the", " ", "loops", " ", "that", " ", "can", " ", "be", " ", 
               "replaced"}]}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"change", "=", "0"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"compa", "=", "postnikovpathloop"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"postnikovpathloop", "=", 
        RowBox[{"postnikovpathloop", "/.", "loopflip"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"postnikovpath", "=", 
        RowBox[{"postnikovpathloop", "/.", "invlooprep"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", 
        "\"\<Path matrix with Postnikov's overall signs, and signs for loops \
'postnikovpath':\>\"", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"postnikovpath", "//", "MatrixForm"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"postnikovpathloop", "//", "MatrixForm"}], "]"}], ";"}], 
        "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Now", " ", "plug", "  ", "in", " ", 
         RowBox[{"Gekhtman", "'"}], "s", " ", "signs"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"numtoorder", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Rule", ",", 
          RowBox[{"{", 
           RowBox[{"order", ",", 
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "order", "]"}], "]"}]}], "}"}]}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"postgekhtmatrixloop", "=", "postnikovpathloop"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", "sources", "]"}], "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", 
         RowBox[{"(*", 
          RowBox[{"Rows", " ", "of", " ", "the", " ", "matrix"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "<", 
             RowBox[{
              RowBox[{"Length", "[", "order", "]"}], "+", "1"}]}], ",", 
            RowBox[{"j", "++"}], ",", 
            RowBox[{"(*", 
             RowBox[{"Columns", " ", "of", " ", "the", " ", "matrix"}], 
             "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"postnikovpathloop", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j"}], "]"}], "]"}], "\[Equal]", "1"}], "||", 
                RowBox[{
                 RowBox[{"postnikovpathloop", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j"}], "]"}], "]"}], "\[Equal]", "0"}]}],
                ",", "True", ",", "True", ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"bguys", "=", 
                 RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                 "Now", " ", "find", " ", "out", " ", "which", " ", 
                  "boundaries", " ", "this", " ", "entries", " ", "goes", " ", 
                  RowBox[{"between", "."}]}], "*)"}], "\[IndentingNewLine]", 
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"k", "=", "1"}], ",", 
                  RowBox[{"k", "<", 
                   RowBox[{
                    RowBox[{"Length", "[", "boundaries", "]"}], "+", "1"}]}], 
                  ",", 
                  RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"boundaries", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], ",", 
                    RowBox[{"sources", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "||", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"boundaries", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], ",", 
                    RowBox[{"order", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"bguys", "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{"bguys", ",", 
                    RowBox[{"{", "k", "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"bguys", "=", 
                 RowBox[{"Sort", "[", "bguys", "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"i", "\[Equal]", "1"}], "&&", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"j", "\[Equal]", "5"}], "||", 
                    RowBox[{"j", "\[Equal]", "4"}]}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{"\"\<bguys=\>\"", ",", "bguys"}], "]"}], ";"}]}], 
                   "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "[", "bguys", "]"}], "\[Equal]", "2"}], 
                  ",", 
                  RowBox[{"(*", 
                   RowBox[{
                   "Only", " ", "do", " ", "it", " ", "if", " ", "we", " ", 
                    "re", " ", "going", " ", "between", " ", "different", " ",
                     "boundaries"}], "*)"}], "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"postgekhtmatrixloop", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"postnikovpathloop", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "/.", 
                    RowBox[{"(", 
                    RowBox[{"bguys", "/.", "boundarycuts"}], ")"}]}]}], 
                   ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"postgekhtmatrix", "=", 
        RowBox[{"postgekhtmatrixloop", "/.", "invlooprep"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", 
        "\"\<This is the matrix with also include Gekhtmans's signs \
'postgekhtmatrix':\>\"", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"postgekhtmatrix", "//", "MatrixForm"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Now", " ", "write", " ", "it", " ", "up", " ", "nicely", " ", "in", 
         " ", "terms", " ", "of", " ", 
         RowBox[{"pms", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"tempmat", "=", 
        RowBox[{"Expand", "[", 
         RowBox[{"Simplify", "[", "postgekhtmatrix", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pmpostgekhtmatrix", "=", "postgekhtmatrix"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pmloops", "=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Total", "[", 
             RowBox[{"looplist", " ", "pmref"}], "]"}], "/.", "therule"}], 
           ")"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["pp", 
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{"plist", ",", "pmref"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}]], "\[Rule]", "1"}], 
           "}"}]}], ")"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", "sources", "]"}], "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", 
         RowBox[{"(*", 
          RowBox[{"Rows", " ", "of", " ", "the", " ", "sign", " ", "matrix"}],
           "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "<", 
             RowBox[{
              RowBox[{"Length", "[", "order", "]"}], "+", "1"}]}], ",", 
            RowBox[{"j", "++"}], ",", 
            RowBox[{"(*", 
             RowBox[{
             "Columns", " ", "of", " ", "the", " ", "sign", " ", "matrix"}], 
             "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"tempmat", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j"}], "]"}], "]"}], "\[Equal]", "1"}], "||", 
                RowBox[{
                 RowBox[{"tempmat", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j"}], "]"}], "]"}], "\[Equal]", "0"}]}],
                ",", "True", ",", "True", ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Denominator", "[", 
                    RowBox[{"tempmat", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], "\[Equal]", 
                   "1"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{"we", " ", "have", " ", "multiple", " ", "terms"}],
                    "*)"}], "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"terms", "=", 
                    RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
                   RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"k", "=", "1"}], ",", 
                    RowBox[{"k", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"tempmat", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], "+", 
                    "1"}]}], ",", 
                    RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"MonomialList", "[", 
                    RowBox[{"Denominator", "[", 
                    RowBox[{
                    RowBox[{"tempmat", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "]"}], "]"}], "]"}], ">", 
                    "1"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"If", " ", "we", " ", "have", " ", "loops"}], 
                    "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"terms", "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{"terms", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Expand", "[", 
                    RowBox[{"Simplify", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"tempmat", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "k", "]"}], "]"}], 
                    RowBox[{"Total", "[", "looplist", "]"}]}], "]"}], "]"}], 
                    "pmref"}], ")"}], "/.", "therule"}], ")"}], "/", 
                    "pmloops"}], "}"}]}], "]"}]}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"terms", "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{"terms", ",", 
                    RowBox[{"{", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"tempmat", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "pmref"}], ")"}], "/.", 
                    "therule"}], ")"}], "}"}]}], "]"}]}], ";"}]}], 
                    RowBox[{"(*", 
                    RowBox[{"If", " ", "we", " ", 
                    RowBox[{"don", "'"}], "t", " ", "have", " ", "loops"}], 
                    "*)"}], "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"pmpostgekhtmatrix", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{"Total", "[", "terms", "]"}]}], ";"}], 
                  "\[IndentingNewLine]", ",", "True", ",", 
                  RowBox[{"(*", 
                   RowBox[{
                   "we", " ", "have", " ", "only", " ", "one", " ", "term"}], 
                   "*)"}], "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"MonomialList", "[", 
                    RowBox[{"Denominator", "[", 
                    RowBox[{"tempmat", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], "]"}], 
                    "]"}], ">", "1"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "If", " ", "the", " ", "term", " ", "has", " ", "loops"}],
                     "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"pmpostgekhtmatrix", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Expand", "[", 
                    RowBox[{"Simplify", "[", 
                    RowBox[{
                    RowBox[{"tempmat", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], 
                    RowBox[{"Total", "[", "looplist", "]"}]}], "]"}], "]"}], 
                    " ", "pmref"}], ")"}], "/.", "therule"}], ")"}], "/", 
                    "pmloops"}]}], ";"}], "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"pmpostgekhtmatrix", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"tempmat", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], " ", "pmref"}], 
                    ")"}], "/.", "therule"}], ")"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";"}]}], "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Done", " ", "looking", " ", "nice"}], ",", " ", 
             RowBox[{"and", " ", "overall", " ", 
              RowBox[{"signs", "!"}]}]}], "*)"}], "\[IndentingNewLine]", 
           "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", 
        "\"\<The Grassmannian matrix in terms of perfect matchings is \
'pmpostgekhtmatrix':\>\"", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"pmpostgekhtmatrix", "//", "MatrixForm"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Now", " ", "calculate", " ", "the", " ", 
         RowBox[{"Pluckers", "!"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"plucker", "=", 
        RowBox[{"Expand", "[", 
         RowBox[{"Simplify", "[", 
          RowBox[{
           RowBox[{"Minors", "[", 
            RowBox[{"postgekhtmatrix", ",", 
             RowBox[{"Length", "[", "sources", "]"}]}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", "\"\<These are the Pluckers 'plucker':\>\"", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"plucker", "//", "MatrixForm"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Now", " ", "make", " ", "the", " ", "Pluckers", " ", "look", " ", 
         "nice"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"niceplucker", "=", "plucker"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", "plucker", "]"}], "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", 
         RowBox[{"(*", 
          RowBox[{"Rows", " ", "of", " ", "the", " ", "sign", " ", "matrix"}],
           "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"plucker", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "1"}], ",", "True", 
            ",", "True", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Denominator", "[", 
                 RowBox[{"plucker", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}], "\[Equal]", "1"}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{"we", " ", "have", " ", "multiple", " ", "terms"}], 
                "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"terms", "=", 
                 RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"k", "=", "1"}], ",", 
                  RowBox[{"k", "<", 
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"plucker", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "+", "1"}]}], ",", 
                  RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"MonomialList", "[", 
                    RowBox[{"Denominator", "[", 
                    RowBox[{
                    RowBox[{"plucker", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "]"}], "]"}], "]"}], ">", 
                    "1"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"If", " ", "we", " ", "have", " ", "loops"}], 
                    "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"terms", "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{"terms", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Expand", "[", 
                    RowBox[{"Simplify", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"plucker", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "k", "]"}], "]"}], 
                    RowBox[{"Total", "[", "looplist", "]"}]}], "]"}], "]"}], 
                    "pmref"}], ")"}], "/.", "therule"}], ")"}], "/", 
                    "pmloops"}], "}"}]}], "]"}]}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"terms", "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{"terms", ",", 
                    RowBox[{"{", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"plucker", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "pmref"}], ")"}], "/.", 
                    "therule"}], ")"}], "}"}]}], "]"}]}], ";"}]}], 
                    RowBox[{"(*", 
                    RowBox[{"If", " ", "we", " ", 
                    RowBox[{"don", "'"}], "t", " ", "have", " ", "loops"}], 
                    "*)"}], "\[IndentingNewLine]", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"niceplucker", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "=", 
                 RowBox[{"Total", "[", "terms", "]"}]}], ";"}], 
               "\[IndentingNewLine]", ",", "True", ",", 
               RowBox[{"(*", 
                RowBox[{
                "we", " ", "have", " ", "only", " ", "one", " ", "term"}], 
                "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "[", 
                    RowBox[{"MonomialList", "[", 
                    RowBox[{"Denominator", "[", 
                    RowBox[{"plucker", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "]"}], ">", 
                   "1"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{
                   "If", " ", "the", " ", "term", " ", "has", " ", "loops"}], 
                   "*)"}], "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"niceplucker", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Expand", "[", 
                    RowBox[{"Simplify", "[", 
                    RowBox[{
                    RowBox[{"plucker", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], 
                    RowBox[{"Total", "[", "looplist", "]"}]}], "]"}], "]"}], 
                    " ", "pmref"}], ")"}], "/.", "therule"}], ")"}], "/", 
                    "pmloops"}]}], ";"}], "\[IndentingNewLine]", ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"niceplucker", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "=", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"plucker", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], " ", "pmref"}], ")"}], "/.",
                     "therule"}], ")"}]}], ";"}]}], "\[IndentingNewLine]", 
                 "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Done", " ", "looking", " ", "nice"}], ",", " ", 
          RowBox[{"and", " ", "overall", " ", 
           RowBox[{"signs", "!"}]}]}], "*)"}], "\[IndentingNewLine]", "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", 
        "\"\<Pluckers written in terms of perfect matchings \
'niceplucker':\>\"", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"niceplucker", "//", "MatrixForm"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"realplucker", "=", 
        RowBox[{
         RowBox[{"Expand", "[", 
          RowBox[{"Simplify", "[", 
           RowBox[{"plucker", " ", 
            RowBox[{"Total", "[", "looplist", "]"}], "pmref"}], "]"}], "]"}], 
         "/.", "therule"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", 
        "\"\<Real map between Pluckers and perfect matchings 'realplucker':\>\
\"", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"realplucker", "//", "MatrixForm"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "Now", " ", "check", " ", "that", " ", "the", " ", "Pluckers", " ", 
          "are", " ", "correct"}], ",", " ", 
         RowBox[{
          RowBox[{"i", ".", "e", ".", " ", "that"}], " ", "they", " ", "all", 
          " ", "have", " ", "the", " ", "correct", " ", "source", " ", 
          RowBox[{"set", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"kmat", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{"a", ",", "c"}], "]"}], ",", 
          RowBox[{"Join", "[", 
           RowBox[{"b", ",", "d"}], "]"}], ",", "2"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"btra", "=", 
        RowBox[{"Transpose", "[", "b", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"xtonum", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", "c", "]"}], "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"xtonum", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"xtonum", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"i", "+", 
                 RowBox[{"Length", "[", "a", "]"}]}], ")"}], "\[Rule]", 
               RowBox[{
                RowBox[{"DeleteCases", "[", 
                 RowBox[{
                  RowBox[{"c", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", "0"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "<", 
          RowBox[{
           RowBox[{"Length", "[", "btra", "]"}], "+", "1"}]}], ",", 
         RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"xtonum", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"xtonum", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"j", "+", 
                 RowBox[{"Length", "[", "a", "]"}], "+", 
                 RowBox[{"Length", "[", "c", "]"}], "+", 
                 RowBox[{
                  RowBox[{"Dimensions", "[", "a", "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "\[Rule]", 
               RowBox[{
                RowBox[{"DeleteCases", "[", 
                 RowBox[{
                  RowBox[{"btra", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], ",", "0"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"xorder", "=", 
        RowBox[{"order", "/.", "xtonum"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ordering", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Rule", ",", 
          RowBox[{"{", 
           RowBox[{"xorder", ",", 
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "order", "]"}], "]"}]}], "}"}]}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Done", " ", "with", " ", "the", " ", "first", " ", 
          RowBox[{"part", "!"}], " ", "Now", " ", "check", " ", "source", " ",
           "sets"}], "..."}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"subs", "=", 
        RowBox[{"Subsets", "[", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "order", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"Length", "[", "sources", "]"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"compare", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", 
          RowBox[{
           RowBox[{"Length", "[", "realplucker", "]"}], "+", "1"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"guys", "=", 
           RowBox[{"MapThread", "[", 
            RowBox[{"Times", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"MonomialList", "[", 
                 RowBox[{"realplucker", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}], "/.", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{
                   SubscriptBox["pp", "x"], "\[Rule]", "1"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"x", ",", 
                    RowBox[{"Length", "[", "plist", "]"}]}], "}"}]}], "]"}]}],
                ",", 
               RowBox[{"MonomialList", "[", 
                RowBox[{"realplucker", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "<", 
             RowBox[{
              RowBox[{"Length", "[", "guys", "]"}], "+", "1"}]}], ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"compare", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"compare", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"guys", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "\[Rule]", 
                  RowBox[{"subs", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "]"}]}], 
             ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"compare", "=", 
        RowBox[{"Sort", "[", "compare", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"compare", "\[Equal]", 
          RowBox[{"pmsourcesOrderingByHand", "[", 
           RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "ordering"}], 
           "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "Print", "[", 
           "\"\<Checked that the source set for these perfect matchings is \
indeed the Plucker coordiate in question, OK!\>\"", "]"}], ";"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{
          RowBox[{
          "Print", "[", 
           "\"\<It seems like the source set of some of these perfect \
matchings is NOT the correct Plucker coordinate...CHECK IT!\>\"", "]"}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"DONE", ",", " ", 
    RowBox[{"NOW", " ", "CALLED", " ", "getGrassmannian"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
     "Gives", " ", "the", " ", "master", " ", "and", " ", "moduli", " ", 
      "spaces", " ", "in", " ", "terms", " ", "of", " ", "loop", " ", 
      RowBox[{"variables", ".", " ", "You"}], " ", "need", " ", "to", " ", 
      "give", " ", "it", " ", "the", " ", "high"}], "-", 
     RowBox[{"genus", " ", "information", " ", "\"\<genusedges\>\""}]}], ",", 
    " ", 
    RowBox[{
     RowBox[{
      RowBox[{"e", ".", "g", ".", " ", "zeds"}], "=", 
      RowBox[{"{", 
       RowBox[{
        FractionBox[
         RowBox[{
          SubscriptBox["X", 
           RowBox[{"9", ",", "6"}]], 
          SubscriptBox["X", 
           RowBox[{"5", ",", "8"}]]}], 
         RowBox[{
          SubscriptBox["X", 
           RowBox[{"8", ",", "9"}]], 
          SubscriptBox["Y", 
           RowBox[{"6", ",", "5"}]], " "}]], ",", 
        FractionBox[
         RowBox[{
          SubscriptBox["X", 
           RowBox[{"6", ",", "8"}]], 
          SubscriptBox["X", 
           RowBox[{"5", ",", "8"}]], 
          SubscriptBox["X", 
           RowBox[{"5", ",", "14"}]]}], 
         RowBox[{
          SubscriptBox["X", 
           RowBox[{"8", ",", "9"}]], 
          SubscriptBox["Y", 
           RowBox[{"6", ",", "5"}]], " ", 
          SubscriptBox["X", 
           RowBox[{"14", ",", "6"}]]}]], ",", 
        FractionBox[
         RowBox[{
          SubscriptBox["X", 
           RowBox[{"14", ",", "14"}]], 
          SubscriptBox["X", 
           RowBox[{"8", ",", "14"}]]}], 
         RowBox[{" ", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"14", ",", "6"}]], 
           SubscriptBox["X", 
            RowBox[{"15", ",", "8"}]]}]}]], ",", 
        FractionBox[
         RowBox[{
          SubscriptBox["X", 
           RowBox[{"16", ",", "14"}]], 
          SubscriptBox["X", 
           RowBox[{"1", ",", "14"}]], 
          SubscriptBox["X", 
           RowBox[{"10", ",", "9"}]]}], 
         RowBox[{
          SubscriptBox["X", 
           RowBox[{"15", ",", "16"}]], 
          SubscriptBox["X", 
           RowBox[{"14", ",", "2"}]], " ", 
          SubscriptBox["X", 
           RowBox[{"9", ",", "1"}]]}]]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"genusedges", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"9", ",", "6"}]], ",", "\"\<b\>\""}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"9", ",", "5"}]], ",", "\"\<w\>\""}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"6", ",", "5"}]], ",", "\"\<b\>\""}], "}"}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"7", ",", "6"}]], ",", "\"\<b\>\""}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"8", ",", "7"}]], ",", "\"\<b\>\""}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"6", ",", "8"}]], ",", "\"\<b\>\""}], "}"}]}], "}"}]}], 
       "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
     "where", " ", "the", " ", "list", " ", "contains", " ", "the", " ", 
      "edges", " ", "going", " ", "through", " ", "each", " ", "of", " ", 
      "the", " ", "nontrivial", " ", "directions", " ", "in", " ", "the", " ", 
      RowBox[{"graph", ".", " ", "The"}], " ", "letter", " ", "after", " ", 
      "each", " ", "edge", " ", "refers", " ", "to", " ", "the", " ", "color",
       " ", "of", " ", "the", " ", "node", " ", "next", " ", "to", " ", "the",
       " ", "border", " ", "of", " ", "the", " ", "unit", " ", 
      RowBox[{"cell", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"newLoopVarModuli", "[", 
      RowBox[{
      "a_", ",", "b_", ",", "c_", ",", "d_", ",", "zeds_", ",", "genusedges_",
        ",", "refpm_", ",", "gauging_"}], "]"}], ":=", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "xbindices", ",", "boundaryindices", ",", "tempbs", ",", 
         "boundarygroups", ",", "edgevectors", ",", "bgs", ",", "inedges", 
         ",", "outedges", ",", "tovecin", ",", "tovecout", ",", "boundinout", 
         ",", "splitintonumdenom", ",", "numerators", ",", "denominators", 
         ",", "extzsinout", ",", "genusflowvecs", ",", "zis", ",", "inout", 
         ",", "intzsinout", ",", "IF", ",", "NF", ",", "NZ", ",", "fa", ",", 
         "li", ",", "fb", ",", "aia", ",", "fail", ",", "allexpressions", ",",
          "pmnumber", ",", "extZdirection", ",", "intZdirection", ",", 
         "intZcontrib", ",", "extZcontrib", ",", "zeroguessexpr", ",", 
         "zeroguess", ",", "nextface", ",", "dafacevars", ",", "time", ",", 
         "deletelist", ",", "tulplists", ",", "bo", ",", "boundinds", ",", 
         "alsodelete", ",", "numb"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"kasteleyn", "[", 
         RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "First", " ", "find", " ", "the", " ", "contributions", " ", "of", 
          " ", "the", " ", 
          RowBox[{
           SubscriptBox["z", "i"], "'"}], "s", " ", "that", " ", "stretch", 
          " ", "between", " ", "different", " ", 
          RowBox[{"boundaries", ".", " ", "For"}], " ", "this", " ", 
          RowBox[{"we", "'"}], "ll", " ", "now", " ", "find", " ", "whether", 
          " ", "each", " ", "edge", " ", "goes", " ", "in", " ", "or", " ", 
          "out", " ", "of", " ", "each", " ", "respective", " ", "boundary"}],
          "*)"}], "\[IndentingNewLine]", 
        RowBox[{
        "Print", "[", 
         "\"\<We're now going to look for which edges belong to which \
boundaries.\>\"", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"xbindices", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"sub1", "[", "#", "]"}], ",", 
              RowBox[{"sub2", "[", "#", "]"}]}], "}"}], "&"}], ",", "xb"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"boundaryindices", "=", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Sort", "[", 
              RowBox[{"Cases", "[", 
               RowBox[{"xbindices", ",", 
                RowBox[{"zz_", "/;", 
                 RowBox[{
                  RowBox[{"Intersection", "[", 
                   RowBox[{"zz", ",", "#"}], "]"}], "\[NotEqual]", 
                  RowBox[{"{", "}"}]}]}]}], "]"}], "]"}], "&"}], ",", 
            "xbindices"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{"True", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"tempbs", "=", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"DeleteDuplicates", "[", 
                 RowBox[{"Join", "@@", 
                  RowBox[{"Cases", "[", 
                   RowBox[{"boundaryindices", ",", 
                    RowBox[{"zz_", "/;", 
                    RowBox[{
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"Union", "@@", "zz"}], ",", 
                    RowBox[{"Union", "@@", "#"}]}], "]"}], "\[NotEqual]", 
                    RowBox[{"{", "}"}]}]}]}], "]"}]}], "]"}], "&"}], ",", 
               "boundaryindices"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"tempbs", "\[NotEqual]", "boundaryindices"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"boundaryindices", "=", "tempbs"}], ";"}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{
              RowBox[{"Break", "[", "]"}], ";"}]}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"boundaryindices", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Union", "[", 
             RowBox[{"Flatten", "[", "#", "]"}], "]"}], "&"}], ",", 
           "boundaryindices"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"boundarygroups", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{"xb", ",", 
              RowBox[{"zz_", "/;", 
               RowBox[{
                RowBox[{"Intersection", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"sub1", "[", "zz", "]"}], ",", 
                    RowBox[{"sub2", "[", "zz", "]"}]}], "}"}], ",", "#"}], 
                 "]"}], "\[NotEqual]", 
                RowBox[{"{", "}"}]}]}]}], "]"}], "&"}], ",", 
           "boundaryindices"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Done, the boundaries are \>\"", ",", "boundarygroups"}],
          "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"edgevectors", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"bgs", "=", "1"}], ",", 
          RowBox[{"bgs", "<", 
           RowBox[{
            RowBox[{"Length", "[", "boundarygroups", "]"}], "+", "1"}]}], ",", 
          RowBox[{"bgs", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"inedges", "=", 
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"boundarygroups", "[", 
               RowBox[{"[", "bgs", "]"}], "]"}], ",", 
              RowBox[{"zz_", "/;", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"MemberQ", "[", 
                   RowBox[{
                    RowBox[{"Variables", "[", "b", "]"}], ",", "zz"}], "]"}], 
                  "&&", 
                  RowBox[{"FreeQ", "[", 
                   RowBox[{
                    RowBox[{"Variables", "[", 
                    RowBox[{"plist", "[", 
                    RowBox[{"[", "refpm", "]"}], "]"}], "]"}], ",", "zz"}], 
                   "]"}]}], ")"}], "||", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"MemberQ", "[", 
                   RowBox[{
                    RowBox[{"Variables", "[", "c", "]"}], ",", "zz"}], "]"}], 
                  "&&", 
                  RowBox[{"MemberQ", "[", 
                   RowBox[{
                    RowBox[{"Variables", "[", 
                    RowBox[{"plist", "[", 
                    RowBox[{"[", "refpm", "]"}], "]"}], "]"}], ",", "zz"}], 
                   "]"}]}], ")"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"outedges", "=", 
            RowBox[{"Complement", "[", 
             RowBox[{
              RowBox[{"boundarygroups", "[", 
               RowBox[{"[", "bgs", "]"}], "]"}], ",", "inedges"}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"tovecin", "=", 
            RowBox[{"-", 
             RowBox[{"UnitVector", "[", 
              RowBox[{
               RowBox[{"Length", "[", "boundarygroups", "]"}], ",", "bgs"}], 
              "]"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"tovecout", "=", 
            RowBox[{"UnitVector", "[", 
             RowBox[{
              RowBox[{"Length", "[", "boundarygroups", "]"}], ",", "bgs"}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"edgevectors", "=", 
            RowBox[{"Join", "[", 
             RowBox[{"edgevectors", ",", 
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "\[Rule]", "tovecin"}], "&"}], ",", 
                  "inedges"}], "]"}], ",", 
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "\[Rule]", "tovecout"}], "&"}], ",", 
                  "outedges"}], "]"}]}], "]"}]}], "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Now", " ", "we", " ", "know", " ", "which", " ", "edges", " ", 
          "flow", " ", "in", " ", "or", " ", "out", " ", "of", " ", "each", 
          " ", "boundary", " ", "ACCORDING", " ", "TO", " ", "THE", " ", 
          "PERFECT", " ", 
          RowBox[{"ORIENTATION", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Now", " ", "need", " ", "to", " ", "find", " ", "out", " ", "if", 
           " ", "the", " ", 
           RowBox[{
            SubscriptBox["z", "i"], "'"}], "s", " ", "flow", " ", "in", " ", 
           "or", " ", "out", " ", "each", " ", "boundary"}], ",", " ", 
          RowBox[{"ACCORDING", " ", "TO", " ", "HOW", " ", 
           RowBox[{"THEY", "'"}], "VE", " ", "BEEN", " ", 
           RowBox[{"DEFINED", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"boundinout", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"MapThread", "[", 
           RowBox[{"Rule", ",", 
            RowBox[{"{", 
             RowBox[{"boundarygroups", ",", 
              RowBox[{"MapThread", "[", 
               RowBox[{"ReplaceAll", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"Variables", "[", "c", "]"}], ",", "#"}], "]"}], 
                    "&"}], ",", "boundarygroups", ",", 
                    RowBox[{"{", "2", "}"}]}], "]"}], ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"True", "\[Rule]", "#"}], ",", 
                    RowBox[{"False", "\[Rule]", 
                    RowBox[{"-", "#"}]}]}], "}"}], "&"}], ",", 
                    RowBox[{"IdentityMatrix", "[", 
                    RowBox[{"Length", "[", "boundarygroups", "]"}], "]"}]}], 
                   "]"}]}], "}"}]}], "]"}]}], "}"}], ",", "2"}], "]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"splitintonumdenom", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Intersection", "[", 
             RowBox[{"xb", ",", "#"}], "]"}], "&"}], ",", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Variables", "[", 
                 RowBox[{"Numerator", "[", "#", "]"}], "]"}], ",", 
                RowBox[{"Variables", "[", 
                 RowBox[{"Denominator", "[", "#", "]"}], "]"}]}], "}"}], 
              "&"}], ",", 
             RowBox[{"zeds", "[", 
              RowBox[{"[", 
               RowBox[{"Range", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", "genusedges", "]"}], "+", "1"}], ",", 
                 RowBox[{"Length", "[", "zeds", "]"}]}], "]"}], "]"}], 
              "]"}]}], "]"}], ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"numerators", "=", 
         RowBox[{
          RowBox[{"Transpose", "[", "splitintonumdenom", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"denominators", "=", 
         RowBox[{
          RowBox[{"Transpose", "[", "splitintonumdenom", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"extzsinout", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Plus", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Map", "[", 
              RowBox[{"Total", ",", 
               RowBox[{"(", 
                RowBox[{"numerators", "/.", "boundinout"}], ")"}]}], "]"}], 
             ",", 
             RowBox[{"Map", "[", 
              RowBox[{"Total", ",", 
               RowBox[{"-", 
                RowBox[{"(", 
                 RowBox[{"denominators", "/.", "boundinout"}], ")"}]}]}], 
              "]"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Done", "!"}], " ", "Now", " ", "we", " ", "know", " ", 
          "which", " ", "way", " ", "each", " ", "external", " ", 
          SubscriptBox["z", "i"], " ", "is", " ", 
          RowBox[{"going", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Now", " ", "find", " ", "the", " ", "contributions", " ", "of", 
           " ", "the", " ", 
           RowBox[{
            SubscriptBox["z", "i"], "'"}], "s", " ", "that", " ", "go", " ", 
           "around", " ", "nontrivial", " ", 
           RowBox[{"loops", ".", " ", "For"}], " ", "this", " ", 
           RowBox[{"we", "'"}], "ll", " ", "now", " ", "find", " ", "whether",
            " ", "each", " ", "edge", " ", "goes", " ", "in", " ", "or", " ", 
           "out", " ", "of", " ", "the", " ", "graph"}], ",", " ", 
          RowBox[{
          "as", " ", "seen", " ", "from", " ", "a", " ", "given", " ", 
           "border", " ", "of", " ", "the", " ", "unit", " ", 
           RowBox[{"cell", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "These", " ", "are", " ", "the", " ", "edges", " ", "whose", " ", 
          "perfect", " ", "orientation", " ", "flows", " ", "into", " ", 
          "the", " ", "graph"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"inedges", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"DeleteCases", "[", 
               RowBox[{
                RowBox[{"Cases", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{"{", 
                   RowBox[{"___", ",", "\"\<b\>\""}], "}"}]}], "]"}], ",", 
                RowBox[{"zz_", "/;", 
                 RowBox[{"MemberQ", "[", 
                  RowBox[{
                   RowBox[{"Variables", "[", 
                    RowBox[{"plist", "[", 
                    RowBox[{"[", "refpm", "]"}], "]"}], "]"}], ",", 
                   RowBox[{"zz", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "]"}], "&"}],
              ",", "genusedges"}], "]"}], ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"outedges", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Complement", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", "genusedges", 
               ",", 
               RowBox[{"{", "2", "}"}]}], "]"}], ",", "inedges"}], "}"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"genusflowvecs", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"zis", "=", "1"}], ",", 
          RowBox[{"zis", "<", 
           RowBox[{
            RowBox[{"Length", "[", "genusedges", "]"}], "+", "1"}]}], ",", 
          RowBox[{"zis", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"genusflowvecs", "=", 
            RowBox[{"Join", "[", 
             RowBox[{"genusflowvecs", ",", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "\[Rule]", 
                  RowBox[{"UnitVector", "[", 
                   RowBox[{
                    RowBox[{"Length", "[", "genusedges", "]"}], ",", "zis"}], 
                   "]"}]}], "&"}], ",", 
                RowBox[{"inedges", "[", 
                 RowBox[{"[", "zis", "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "\[Rule]", 
                  RowBox[{"-", 
                   RowBox[{"UnitVector", "[", 
                    RowBox[{
                    RowBox[{"Length", "[", "genusedges", "]"}], ",", "zis"}], 
                    "]"}]}]}], "&"}], ",", 
                RowBox[{"outedges", "[", 
                 RowBox[{"[", "zis", "]"}], "]"}]}], "]"}]}], "]"}]}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Now", " ", "we", " ", "know", " ", "which", " ", "edges", " ", 
          "flow", " ", "in", " ", "or", " ", "out", " ", "of", " ", "the", 
          " ", "graph", " ", "ACCORDING", " ", "TO", " ", "THE", " ", 
          "PERFECT", " ", 
          RowBox[{"ORIENTATION", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Now", " ", "need", " ", "to", " ", "find", " ", "out", " ", "if", 
           " ", "the", " ", 
           RowBox[{
            SubscriptBox["z", "i"], "'"}], "s", " ", "flow", " ", "in", " ", 
           "or", " ", "out", " ", "of", " ", "the", " ", "graph"}], ",", " ", 
          RowBox[{"ACCORDING", " ", "TO", " ", "HOW", " ", 
           RowBox[{"THEY", "'"}], "VE", " ", "BEEN", " ", 
           RowBox[{"DEFINED", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"splitintonumdenom", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Intersection", "[", 
             RowBox[{
              RowBox[{"DeleteCases", "[", 
               RowBox[{
                RowBox[{"Flatten", "[", "genusedges", "]"}], ",", 
                RowBox[{"\"\<b\>\"", "|", "\"\<w\>\""}]}], "]"}], ",", "#"}], 
             "]"}], "&"}], ",", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Variables", "[", 
                 RowBox[{"Numerator", "[", "#", "]"}], "]"}], ",", 
                RowBox[{"Variables", "[", 
                 RowBox[{"Denominator", "[", "#", "]"}], "]"}]}], "}"}], 
              "&"}], ",", 
             RowBox[{"zeds", "[", 
              RowBox[{"[", 
               RowBox[{"Range", "[", 
                RowBox[{"Length", "[", "genusedges", "]"}], "]"}], "]"}], 
              "]"}]}], "]"}], ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"numerators", "=", 
         RowBox[{
          RowBox[{"Transpose", "[", "splitintonumdenom", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"denominators", "=", 
         RowBox[{
          RowBox[{"Transpose", "[", "splitintonumdenom", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"inout", "=", 
         RowBox[{"Join", "@@", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"genusedges", "[", 
               RowBox[{"[", "#", "]"}], "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"zz_", ",", "\"\<b\>\""}], "}"}], "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{"zz", "\[Rule]", 
                   RowBox[{"UnitVector", "[", 
                    RowBox[{
                    RowBox[{"Length", "[", "genusedges", "]"}], ",", "#"}], 
                    "]"}]}], ")"}]}], ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"zzz_", ",", "\"\<w\>\""}], "}"}], "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{"zzz", "\[Rule]", 
                   RowBox[{"-", 
                    RowBox[{"UnitVector", "[", 
                    RowBox[{
                    RowBox[{"Length", "[", "genusedges", "]"}], ",", "#"}], 
                    "]"}]}]}], ")"}]}]}], "}"}]}], "&"}], ",", 
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", "genusedges", "]"}], "]"}]}], "]"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"intzsinout", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Plus", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Map", "[", 
              RowBox[{"Total", ",", 
               RowBox[{"(", 
                RowBox[{"numerators", "/.", "inout"}], ")"}]}], "]"}], ",", 
             RowBox[{"Map", "[", 
              RowBox[{"Total", ",", 
               RowBox[{"-", 
                RowBox[{"(", 
                 RowBox[{"denominators", "/.", "inout"}], ")"}]}]}], "]"}]}], 
            "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Done", "!"}], " ", "Now", " ", "we", " ", "know", " ", 
          "which", " ", "way", " ", "each", " ", 
          SubscriptBox["z", "i"], " ", "is", " ", 
          RowBox[{"going", ".", " ", "This"}], " ", "even", " ", "allows", 
          " ", "for", " ", "the", " ", "possibility", " ", "of", " ", "a", 
          " ", 
          SubscriptBox["z", "i"], " ", "looping", " ", "around", " ", "both", 
          " ", "nontrivial", " ", 
          RowBox[{"directions", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Here", " ", "is", " ", "old", " ", "code", " ", "that", " ", 
           "creates", " ", "the", " ", "faces", " ", 
           SubscriptBox["w", "i"], "and", " ", 
           SubscriptBox["z", "j"], " ", "paths"}], ",", " ", 
          RowBox[{"but", " ", "now", " ", "we", " ", "also", " ", "form", " ", 
           RowBox[{
            SubscriptBox["w", "NF"], "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"IF", "=", 
         RowBox[{"internalFaces", "[", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"NF", "=", 
         RowBox[{
          RowBox[{"externalFaces", "[", 
           RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "+", "IF"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"First", " ", "make", " ", "the", " ", 
          SubscriptBox["w", "i"], " ", "variables"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"NZ", "=", 
         RowBox[{"Length", "[", "zeds", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"fa", "=", "1"}], ",", 
          RowBox[{"fa", "<", 
           RowBox[{"NF", "+", "1"}]}], ",", 
          RowBox[{"fa", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            SubscriptBox["w", "fa"], "=", "1"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"li", "=", "1"}], ",", 
          RowBox[{"li", "<", 
           RowBox[{
            RowBox[{"Length", "[", "Xlist", "]"}], "+", "1"}]}], ",", 
          RowBox[{"li", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"fa", "=", "1"}], ",", 
             RowBox[{"fa", "<", 
              RowBox[{"NF", "+", "1"}]}], ",", 
             RowBox[{"fa", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"fb", "=", "1"}], ",", 
                RowBox[{"fb", "<", 
                 RowBox[{"NF", "+", "1"}]}], ",", 
                RowBox[{"fb", "++"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}], "\[Equal]", 
                    SubscriptBox["X", 
                    RowBox[{"fa", ",", "fb"}]]}], "||", 
                    RowBox[{
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}], "\[Equal]", 
                    SubscriptBox["Y", 
                    RowBox[{"fa", ",", "fb"}]]}], "||", 
                    RowBox[{
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}], "\[Equal]", 
                    SubscriptBox["Z", 
                    RowBox[{"fa", ",", "fb"}]]}], "||", 
                    RowBox[{
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}], "\[Equal]", 
                    SubscriptBox["W", 
                    RowBox[{"fa", ",", "fb"}]]}], "||", 
                    RowBox[{
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}], "\[Equal]", 
                    SubscriptBox["V", 
                    RowBox[{"fa", ",", "fb"}]]}], "||", 
                    RowBox[{
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}], "\[Equal]", 
                    SubscriptBox["UU", 
                    RowBox[{"fa", ",", "fb"}]]}], "||", 
                    RowBox[{
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}], "\[Equal]", 
                    SubscriptBox["XX", 
                    RowBox[{"fa", ",", "fb"}]]}], "||", 
                    RowBox[{
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}], "\[Equal]", 
                    SubscriptBox["YY", 
                    RowBox[{"fa", ",", "fb"}]]}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["w", "fa"], "=", 
                    RowBox[{
                    SubscriptBox["w", "fa"], "/", 
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["w", "fb"], "=", 
                    RowBox[{
                    SubscriptBox["w", "fb"], 
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}]}]}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Now", " ", "label", " ", "the", " ", 
          RowBox[{"z", "'"}], "s"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"aia", "=", "1"}], ",", 
          RowBox[{"aia", "<", 
           RowBox[{
            RowBox[{"Length", "[", "zeds", "]"}], "+", "1"}]}], ",", 
          RowBox[{"aia", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            SubscriptBox["z", "aia"], "=", 
            RowBox[{"zeds", "[", 
             RowBox[{"[", "aia", "]"}], "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "This", " ", "finds", " ", "the", " ", "contribution", " ", "from", 
          " ", "all", " ", 
          RowBox[{"z", "'"}], "s", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
            "both", " ", "those", " ", "between", " ", "boundaries", " ", 
             "and", " ", "those", " ", "around", " ", "nontrivial", " ", 
             "loops"}], ")"}], "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"fail", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"allexpressions", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"pmnumber", "=", "1"}], ",", 
          RowBox[{"pmnumber", "<", 
           RowBox[{
            RowBox[{"Length", "[", "plist", "]"}], "+", "1"}]}], ",", 
          RowBox[{"pmnumber", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"\"\<pmnumber = \>\"", ",", "pmnumber"}], "]"}], ";"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"extZdirection", "=", 
            RowBox[{"Total", "[", 
             RowBox[{
              RowBox[{"Intersection", "[", 
               RowBox[{"xb", ",", 
                RowBox[{"Variables", "[", 
                 RowBox[{
                  RowBox[{"plist", "[", 
                   RowBox[{"[", "pmnumber", "]"}], "]"}], "/", 
                  RowBox[{"plist", "[", 
                   RowBox[{"[", "refpm", "]"}], "]"}]}], "]"}]}], "]"}], "/.",
               "edgevectors"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"intZdirection", "=", 
            RowBox[{"Total", "[", 
             RowBox[{
              RowBox[{"Intersection", "[", 
               RowBox[{
                RowBox[{"DeleteCases", "[", 
                 RowBox[{
                  RowBox[{"Flatten", "[", "genusedges", "]"}], ",", 
                  RowBox[{"\"\<b\>\"", "|", "\"\<w\>\""}]}], "]"}], ",", 
                RowBox[{"Variables", "[", 
                 RowBox[{
                  RowBox[{"plist", "[", 
                   RowBox[{"[", "pmnumber", "]"}], "]"}], "/", 
                  RowBox[{"plist", "[", 
                   RowBox[{"[", "refpm", "]"}], "]"}]}], "]"}]}], "]"}], "/.",
               "genusflowvecs"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"intZcontrib", "=", 
            RowBox[{"Times", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Solve", "[", 
                 RowBox[{
                  RowBox[{"Total", "[", 
                   RowBox[{"MapThread", "[", 
                    RowBox[{"Times", ",", 
                    RowBox[{"{", 
                    RowBox[{"intzsinout", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    SubscriptBox["zz", "iii"], ",", 
                    RowBox[{"{", 
                    RowBox[{"iii", ",", 
                    RowBox[{"Length", "[", "genusedges", "]"}]}], "}"}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}], "\[Equal]", 
                  "intZdirection"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "/.", 
               RowBox[{"Rule", "\[Rule]", "Power"}]}], ")"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"extZcontrib", "=", 
            RowBox[{"Times", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Solve", "[", 
                 RowBox[{
                  RowBox[{"Total", "[", 
                   RowBox[{"MapThread", "[", 
                    RowBox[{"Times", ",", 
                    RowBox[{"{", 
                    RowBox[{"extzsinout", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    SubscriptBox["zz", "iii"], ",", 
                    RowBox[{"{", 
                    RowBox[{"iii", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "genusedges", "]"}], "+", "1"}], 
                    ",", 
                    RowBox[{"Length", "[", "zeds", "]"}]}], "}"}]}], "]"}]}], 
                    "}"}]}], "]"}], "]"}], "\[Equal]", "extZdirection"}], 
                 "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "/.", 
               RowBox[{"Rule", "\[Rule]", "Power"}]}], ")"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"zeroguessexpr", "=", 
            RowBox[{"intZcontrib", " ", "extZcontrib"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"zeroguess", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"plist", "[", 
                RowBox[{"[", "pmnumber", "]"}], "]"}], "/", 
               RowBox[{"plist", "[", 
                RowBox[{"[", "refpm", "]"}], "]"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{"zeroguessexpr", "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"zz", "\[Rule]", "z"}], ",", 
                 RowBox[{"ww", "\[Rule]", "w"}]}], "}"}]}], ")"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"Found", " ", "the", " ", "correct", " ", 
             RowBox[{"expression", ".", " ", "What"}], " ", "remains", " ", 
             "in", " ", "\"\<zeroguess\>\"", " ", "is", " ", "guaranteed", 
             " ", "to", " ", "be", " ", "equal", " ", "to", " ", "some", " ", 
             "product", " ", "of", " ", 
             RowBox[{"faces", "."}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"Now", " ", 
             RowBox[{"we", "'"}], "ll", " ", "find", " ", "the", " ", 
             "expression", " ", "for", " ", "the", " ", "faces"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"TimeConstrained", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"While", "[", 
               RowBox[{
                RowBox[{"zeroguess", "=!=", "1"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"nextface", "=", 
                  RowBox[{"sub2", "[", 
                   RowBox[{
                    RowBox[{"Variables", "[", 
                    RowBox[{"Numerator", "[", "zeroguess", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"zeroguess", "=", 
                  RowBox[{"zeroguess", "/", 
                   SubscriptBox["w", "nextface"]}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"zeroguessexpr", "=", 
                  RowBox[{"zeroguessexpr", " ", 
                   SubscriptBox["ww", "nextface"]}]}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"zeroguessexpr", "=", 
               RowBox[{"zeroguessexpr", "/.", 
                RowBox[{
                 SubscriptBox["ww", "NF"], "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{"1", "/", 
                   RowBox[{"Times", "@@", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    SubscriptBox["ww", "iii"], ",", 
                    RowBox[{"{", 
                    RowBox[{"iii", ",", 
                    RowBox[{"NF", "-", "1"}]}], "}"}]}], "]"}]}]}], 
                  ")"}]}]}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"allexpressions", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"allexpressions", ",", "zeroguessexpr"}], "]"}]}], 
              ";"}], "\[IndentingNewLine]", ",", "20", ",", 
             RowBox[{
              RowBox[{"fail", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"fail", ",", "pmnumber"}], "]"}]}], ";", 
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<Number \>\"", ",", "pmnumber", ",", "\"\< failed!\>\""}], 
               "]"}], ";"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Done", "!"}], " ", 
          RowBox[{"We", "'"}], "ve", " ", "found", " ", "all", " ", 
          RowBox[{"expressions", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Now", " ", 
          RowBox[{"we", "'"}], "ll", " ", "make", " ", "Gmaster"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"dafacevars", "=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"MapThread", "[", 
            RowBox[{"Subscript", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"ConstantArray", "[", 
                RowBox[{"zz", ",", 
                 RowBox[{"Length", "[", "zeds", "]"}]}], "]"}], ",", 
               RowBox[{"Range", "[", 
                RowBox[{"Length", "[", "zeds", "]"}], "]"}]}], "}"}]}], "]"}],
            ",", 
           RowBox[{"MapThread", "[", 
            RowBox[{"Subscript", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"ConstantArray", "[", 
                RowBox[{"ww", ",", 
                 RowBox[{"NF", "-", "1"}]}], "]"}], ",", 
               RowBox[{"Range", "[", 
                RowBox[{"NF", "-", "1"}], "]"}]}], "}"}]}], "]"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Gmaster", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"allexpressions", "/.", 
              RowBox[{"Times", "\[Rule]", "Plus"}]}], ")"}], "/.", 
            RowBox[{"Power", "\[Rule]", "Times"}]}], ")"}], "/.", 
          RowBox[{"MapThread", "[", 
           RowBox[{"Rule", ",", 
            RowBox[{"{", 
             RowBox[{"dafacevars", ",", 
              RowBox[{"IdentityMatrix", "[", 
               RowBox[{"Length", "[", "dafacevars", "]"}], "]"}]}], "}"}]}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"Position", "[", 
             RowBox[{
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "===", "1"}], "&"}], ",", "allexpressions"}], 
               "]"}], ",", "True"}], "]"}], "]"}], "===", 
           RowBox[{"{", "refpm", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Gmaster", "[", 
             RowBox[{"[", "refpm", "]"}], "]"}], "=", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"0", ",", 
              RowBox[{"Length", "[", "dafacevars", "]"}]}], "]"}]}], ";"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{
           RowBox[{
           "Print", "[", 
            "\"\<There is some problem! It seems like multiple expressions \
are identically equal to 1!!!!\>\"", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Gmaster", "=", 
         RowBox[{"Transpose", "[", "Gmaster", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "This", " ", "is", " ", "old", " ", "code", " ", "that", " ", 
          "makes", " ", "the", " ", "moduli", " ", "space", " ", 
          RowBox[{"etc", ".", " ", "and"}], " ", "all", " ", "the", " ", 
          "printouts"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
        "Print", "[", "\"\<---------------------------------------------\>\"",
          "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Failed \>\"", ",", 
          RowBox[{"Length", "[", "fail", "]"}], ",", "\"\< times: \>\"", ",", 
          "fail"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Computation time: \>\"", ",", 
          RowBox[{
           RowBox[{"TimeUsed", "[", "]"}], "-", "time"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"time", "=", 
         RowBox[{"TimeUsed", "[", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Gmaster = \>\"", ",", 
          RowBox[{"Gmaster", "//", "MatrixForm"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mastermult", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Dimensions", "[", 
             RowBox[{
              RowBox[{"Gather", "[", 
               RowBox[{"Transpose", "[", "Gmaster", "]"}], "]"}], "[", 
              RowBox[{"[", "y", "]"}], "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"y", ",", 
             RowBox[{
              RowBox[{"Dimensions", "[", 
               RowBox[{"Gather", "[", 
                RowBox[{"Transpose", "[", "Gmaster", "]"}], "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"DeleteDuplicates", "[", 
             RowBox[{"mastermult", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ">", "1"}], ",", 
          RowBox[{
           RowBox[{
           "Print", "[", 
            "\"\<ERROR!!! THERE ARE SEVERAL PERFECT MATCHINGS WITH THE SAME \
EXPRESSION!\>\"", "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{
        "Print", "[", 
         "\"\<The order of the coordinates for Gmaster is: \
\!\(\*SubscriptBox[\(z\), \(i\)]\)'s, then faces (starting from face 1 to \
face NF-1).\>\"", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"gauging", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Gmoduli", "=", 
           RowBox[{"Delete", "[", 
            RowBox[{"Gmaster", ",", 
             RowBox[{"Transpose", "[", 
              RowBox[{"{", 
               RowBox[{"Table", "[", 
                RowBox[{"i", ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", 
                   RowBox[{"NZ", "+", "1"}], ",", 
                   RowBox[{"NZ", "+", "IF"}]}], "}"}]}], "]"}], "}"}], 
              "]"}]}], "]"}]}], "\[IndentingNewLine]", ",", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"gauging", "\[Equal]", "2"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"deletelist", "=", 
               RowBox[{"Range", "[", 
                RowBox[{"Length", "[", "genusedges", "]"}], "]"}]}], ";", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{
                 RowBox[{
                 "Here", " ", "we", " ", "also", " ", "dauge", " ", "the", 
                  " ", "internal", " ", "zig"}], "-", "zags"}], ",", " ", 
                RowBox[{
                "as", " ", "well", " ", "as", " ", "delete", " ", "all", " ", 
                 "internal", " ", "faces"}]}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"Gmoduli", "=", "Gmaster"}], ";", "\[IndentingNewLine]", 
              RowBox[{"tulplists", "=", 
               RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"bo", "=", "1"}], ",", 
                RowBox[{"bo", "<", 
                 RowBox[{
                  RowBox[{"Length", "[", "boundarygroups", "]"}], "+", 
                  "1"}]}], ",", 
                RowBox[{"bo", "++"}], ",", 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{
                  "Each", " ", "time", " ", "we", " ", "have", " ", 
                   "external", " ", "guys", " ", "going", " ", "around", " ", 
                   "a", " ", "boundary", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    "hence", " ", "are", " ", "completely", " ", "internal"}],
                     ")"}]}], ",", " ", 
                  RowBox[{
                  "we", " ", "have", " ", "to", " ", "subtract", " ", "the", 
                   " ", "value", " ", "of", " ", "one", " ", "row", " ", 
                   "from", " ", "all", " ", "the", " ", "others"}], ",", " ", 
                  RowBox[{
                  "and", " ", "then", " ", "gauge", " ", "this", " ", 
                   "row"}]}], "*)"}], "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"boundinds", "=", 
                  RowBox[{"Union", "@@", 
                   RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"sub1", "[", "#", "]"}], ",", 
                    RowBox[{"sub2", "[", "#", "]"}]}], "}"}], "&"}], ",", 
                    RowBox[{"boundarygroups", "[", 
                    RowBox[{"[", "bo", "]"}], "]"}]}], "]"}]}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"MemberQ", "[", 
                    RowBox[{"boundinds", ",", "NF"}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"boundinds", "=", 
                    RowBox[{"Complement", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", "NF", "]"}], ",", "boundinds"}], 
                    "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"tulplists", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"tulplists", ",", "boundinds"}], "]"}]}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"alsodelete", "=", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "+", 
                   RowBox[{"Length", "[", "zeds", "]"}]}], "&"}], ",", 
                 RowBox[{
                  RowBox[{"Cases", "[", 
                   RowBox[{
                    RowBox[{"Tuples", "[", "tulplists", "]"}], ",", 
                    RowBox[{"zz_", "/;", 
                    RowBox[{
                    RowBox[{"Union", "[", "zz", "]"}], "\[Equal]", 
                    RowBox[{"Sort", "[", "zz", "]"}]}]}]}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"bo", "=", "1"}], ",", 
                RowBox[{"bo", "<", 
                 RowBox[{
                  RowBox[{"Length", "[", "tulplists", "]"}], "+", "1"}]}], 
                ",", 
                RowBox[{"bo", "++"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"For", "[", 
                  RowBox[{
                   RowBox[{"numb", "=", "1"}], ",", 
                   RowBox[{"numb", "<", 
                    RowBox[{"Length", "[", 
                    RowBox[{"tulplists", "[", 
                    RowBox[{"[", "bo", "]"}], "]"}], "]"}]}], ",", 
                   RowBox[{"numb", "++"}], ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Gmoduli", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Length", "[", "zeds", "]"}], "+", 
                    RowBox[{"tulplists", "[", 
                    RowBox[{"[", 
                    RowBox[{"bo", ",", "numb"}], "]"}], "]"}]}], "]"}], "]"}],
                     "=", 
                    RowBox[{
                    RowBox[{"Gmoduli", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Length", "[", "zeds", "]"}], "+", 
                    RowBox[{"tulplists", "[", 
                    RowBox[{"[", 
                    RowBox[{"bo", ",", "numb"}], "]"}], "]"}]}], "]"}], "]"}],
                     "-", 
                    RowBox[{"Gmoduli", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Length", "[", "zeds", "]"}], "+", 
                    RowBox[{"alsodelete", "[", 
                    RowBox[{"[", "bo", "]"}], "]"}]}], "]"}], "]"}]}]}], 
                    ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"deletelist", "=", 
               RowBox[{"Sort", "[", 
                RowBox[{"Join", "[", 
                 RowBox[{"deletelist", ",", "alsodelete"}], "]"}], "]"}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"Gmoduli", "=", 
               RowBox[{"Delete", "[", 
                RowBox[{"Gmoduli", ",", 
                 RowBox[{"Transpose", "[", 
                  RowBox[{"{", "deletelist", "}"}], "]"}]}], "]"}]}], ";"}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{
              RowBox[{
              "Print", "[", 
               "\"\<Invalid value for 'gauging'. Need to specify either \
'gauging'=1 or 'gauging'=2.\>\"", "]"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Now", " ", "group", " ", "the", " ", "multiplicities", " ", "of", 
          " ", "G", " ", 
          RowBox[{"together", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Gshort", "=", 
         RowBox[{"Transpose", "[", 
          RowBox[{"DeleteDuplicates", "[", 
           RowBox[{"Transpose", "[", "Gmoduli", "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Multmatrix", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Dimensions", "[", 
             RowBox[{
              RowBox[{"Gather", "[", 
               RowBox[{"Transpose", "[", "Gmoduli", "]"}], "]"}], "[", 
              RowBox[{"[", "y", "]"}], "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"y", ",", 
             RowBox[{
              RowBox[{"Dimensions", "[", 
               RowBox[{"Gather", "[", 
                RowBox[{"Transpose", "[", "Gmoduli", "]"}], "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Gshort = \>\"", ",", 
          RowBox[{"Gshort", "//", "MatrixForm"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Multipl = \>\"", ",", 
          RowBox[{"Multmatrix", "//", "MatrixForm"}]}], "]"}], ";"}]}], " ", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Gives", " ", "the", " ", "toric", " ", "diagram", " ", "of", " ", "the", 
     " ", "moduli", " ", "space", " ", "using", " ", "the", " ", 
     SubscriptBox["w", "i"], " ", 
     RowBox[{"variables", ".", " ", "You"}], " ", "need", " ", "to", " ", 
     "specify", " ", "whether", " ", "you", " ", "want", " ", "gauging", " ", 
     "1", " ", "or", " ", "gauging", " ", "2."}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"loopVariableModuli", "[", 
     RowBox[{
     "a_", ",", "b_", ",", "c_", ",", "d_", ",", "zeds_", ",", "patience_", 
      ",", "gauging_", ",", "referencenum_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "IF", ",", "NF", ",", "fa", ",", "li", ",", "fb", ",", "NZ", ",", 
        "NZI", ",", "temp", ",", "kk", ",", "check", ",", "jj", ",", "jk", 
        ",", "wext", ",", "allint", ",", "zext", ",", "ref", ",", "allext", 
        ",", "extsubs", ",", "intsubs", ",", "newint", ",", "numm", ",", 
        "tryshift", ",", "wpower", ",", "wpow", ",", 
        RowBox[{"(*", 
         RowBox[{"wshift", ","}], "*)"}], "ki", ",", "wtrya", ",", "el", ",", 
        "masterspace", ",", "fail", ",", "guess", ",", "k", ",", "darn", ",", 
        "retry", ",", "consider", ",", "expression", ",", "zexpression", ",", 
        "considervar", ",", "j", ",", "count", ",", "done", ",", "wextcont", 
        ",", "ranw", ",", "ranz", ",", "i", ",", "ii", ",", "save", ",", "jz",
         ",", "zextcont", ",", "save2", ",", "ij", ",", "ji", ",", 
        "senttointernal", ",", "sentexpression", ",", "zsentexpression", ",", 
        "zintcont", ",", "jsh", ",", "wshiftcont", ",", "save3", ",", 
        "wintcont", ",", "powers", ",", "tem", ",", "score", ",", "bore", ",",
         "cha", ",", "pow", ",", "inw", ",", "ad", ",", "powarray", ",", "om",
         ",", "show", ",", "wfa", ",", "mastercoords", ",", "ei", ",", "ai", 
        ",", "nice", ",", "compare", ",", "mastermult", ",", "bonudaries", 
        ",", "deletelist", ",", "bo", ",", "numb", ",", "intz", ",", "aia", 
        ",", "boundaries"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"kasteleyn", "[", 
        RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"IF", "=", 
        RowBox[{"internalFaces", "[", 
         RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"NF", "=", 
        RowBox[{
         RowBox[{"externalFaces", "[", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "+", "IF"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"First", " ", "make", " ", "the", " ", 
         SubscriptBox["w", "i"], " ", "variables"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"NZ", "=", 
        RowBox[{"Length", "[", "zeds", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"fa", "=", "1"}], ",", 
         RowBox[{"fa", "<", "NF"}], ",", 
         RowBox[{"fa", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           SubscriptBox["w", "fa"], "=", "1"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"li", "=", "1"}], ",", 
         RowBox[{"li", "<", 
          RowBox[{
           RowBox[{"Length", "[", "Xlist", "]"}], "+", "1"}]}], ",", 
         RowBox[{"li", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"fa", "=", "1"}], ",", 
            RowBox[{"fa", "<", 
             RowBox[{"NF", "+", "1"}]}], ",", 
            RowBox[{"fa", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"fb", "=", "1"}], ",", 
               RowBox[{"fb", "<", 
                RowBox[{"NF", "+", "1"}]}], ",", 
               RowBox[{"fb", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}], "\[Equal]", 
                    SubscriptBox["X", 
                    RowBox[{"fa", ",", "fb"}]]}], "||", 
                   RowBox[{
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}], "\[Equal]", 
                    SubscriptBox["Y", 
                    RowBox[{"fa", ",", "fb"}]]}], "||", 
                   RowBox[{
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}], "\[Equal]", 
                    SubscriptBox["Z", 
                    RowBox[{"fa", ",", "fb"}]]}], "||", 
                   RowBox[{
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}], "\[Equal]", 
                    SubscriptBox["W", 
                    RowBox[{"fa", ",", "fb"}]]}], "||", 
                   RowBox[{
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}], "\[Equal]", 
                    SubscriptBox["V", 
                    RowBox[{"fa", ",", "fb"}]]}], "||", 
                   RowBox[{
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}], "\[Equal]", 
                    SubscriptBox["UU", 
                    RowBox[{"fa", ",", "fb"}]]}], "||", 
                   RowBox[{
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}], "\[Equal]", 
                    SubscriptBox["XX", 
                    RowBox[{"fa", ",", "fb"}]]}], "||", 
                   RowBox[{
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}], "\[Equal]", 
                    SubscriptBox["YY", 
                    RowBox[{"fa", ",", "fb"}]]}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"fa", "\[NotEqual]", "NF"}], ",", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["w", "fa"], "=", 
                    RowBox[{
                    SubscriptBox["w", "fa"], "/", 
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}]}]}], ";"}]}], "]"}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"fb", "\[NotEqual]", "NF"}], ",", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["w", "fb"], "=", 
                    RowBox[{
                    SubscriptBox["w", "fb"], 
                    RowBox[{"Xlist", "[", 
                    RowBox[{"[", "li", "]"}], "]"}]}]}], ";"}]}], "]"}], 
                   ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Now", " ", "label", " ", "the", " ", 
         RowBox[{"z", "'"}], "s"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"aia", "=", "1"}], ",", 
         RowBox[{"aia", "<", 
          RowBox[{
           RowBox[{"Length", "[", "zeds", "]"}], "+", "1"}]}], ",", 
         RowBox[{"aia", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           SubscriptBox["z", "aia"], "=", 
           RowBox[{"zeds", "[", 
            RowBox[{"[", "aia", "]"}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Make", " ", "the", " ", 
          SubscriptBox["wext", "i"], " ", "and", " ", 
          SubscriptBox["zext", "i"]}], ",", " ", 
         RowBox[{
          RowBox[{"i", ".", "e", ".", " ", "removing"}], " ", "all", " ", 
          "internal", " ", 
          RowBox[{"edges", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"NZI", "=", "0"}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "Number", " ", "of", " ", "z", " ", "lines", " ", "that", " ", "only",
          " ", "have", " ", "internal", " ", 
         RowBox[{"edges", ".", " ", "We"}], " ", "will", " ", "now", " ", 
         "count", " ", 
         RowBox[{"them", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"temp", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"First", " ", "do", " ", "the", " ", 
         SubscriptBox["wext", "i"]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"kk", "=", "1"}], ",", 
         RowBox[{"kk", "<", "NF"}], ",", 
         RowBox[{"kk", "++"}], ",", 
         RowBox[{"(*", 
          RowBox[{"kk", " ", "is", " ", "the", " ", "the", " ", "face"}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           SubscriptBox["wext", "kk"], "=", 
           SubscriptBox["w", "kk"]}], ";", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"jj", "=", "1"}], ",", 
            RowBox[{"jj", "<", 
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"Variables", "[", 
                SubscriptBox["w", "kk"], "]"}], "]"}], "+", "1"}]}], ",", 
            RowBox[{"jj", "++"}], ",", 
            RowBox[{"(*", 
             RowBox[{
             "jj", " ", "is", " ", "the", " ", "variable", " ", "of", " ", 
              "the", " ", "the", " ", "face"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"check", "=", "0"}], ";", " ", 
             RowBox[{"(*", 
              RowBox[{
              "Check", " ", "whether", " ", "this", " ", "variable", " ", 
               "is", " ", "an", " ", "external", " ", "one"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"jk", "=", "1"}], ",", 
               RowBox[{"jk", "<", 
                RowBox[{
                 RowBox[{"Length", "[", "xb", "]"}], "+", "1"}]}], ",", 
               RowBox[{"jk", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["w", "kk"], "]"}], "[", 
                    RowBox[{"[", "jj", "]"}], "]"}], "\[Equal]", 
                   RowBox[{"xb", "[", 
                    RowBox[{"[", "jk", "]"}], "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"check", "=", "1"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"check", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"If", " ", 
                  RowBox[{"it", "'"}], "s", " ", "an", " ", "internal", " ", 
                  "one"}], ",", " ", 
                 RowBox[{"find", " ", "out", " ", "if", " ", 
                  RowBox[{"it", "'"}], "s", " ", "in", " ", "the", " ", "top",
                   " ", "or", " ", 
                  RowBox[{"bottom", ".", " ", "Then"}], " ", "remove", " ", 
                  RowBox[{"it", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["w", "kk"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["w", "kk"], "]"}], "[", 
                    RowBox[{"[", "jj", "]"}], "]"}]}], "]"}], "\[Equal]", 
                   "0"}], ",", " ", "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{
                    RowBox[{
                    "If", " ", "the", " ", "variable", " ", "is", " ", "in", 
                    " ", "the", " ", "denomianator", " ", 
                    RowBox[{"(", 
                    RowBox[{"ie", " ", "\[Equal]", "0"}], ")"}]}], ",", " ", 
                    RowBox[{"multiply", " ", "it", " ", 
                    RowBox[{"in", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["wext", "kk"], "=", 
                    RowBox[{
                    SubscriptBox["wext", "kk"], " ", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["w", "kk"], "]"}], "[", 
                    RowBox[{"[", "jj", "]"}], "]"}]}]}], ";"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["wext", "kk"], "=", 
                    RowBox[{
                    SubscriptBox["wext", "kk"], "/", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["w", "kk"], "]"}], "[", 
                    RowBox[{"[", "jj", "]"}], "]"}]}]}], ";"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["wext", "kk"], "=", 
                    RowBox[{
                    SubscriptBox["wext", "kk"], "/", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["w", "kk"], "]"}], "[", 
                    RowBox[{"[", "jj", "]"}], "]"}]}]}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"temp", "=", 
                 RowBox[{"temp", " ", 
                  RowBox[{
                   RowBox[{"Variables", "[", 
                    SubscriptBox["w", "kk"], "]"}], "[", 
                   RowBox[{"[", "jj", "]"}], "]"}]}]}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"allint", "=", 
        RowBox[{"Variables", "[", "temp", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Now", " ", "do", " ", "the", " ", 
         SubscriptBox["zext", "i"]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"intz", "=", 
        RowBox[{"{", "}"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{"Remembers", " ", "which", " ", 
         RowBox[{"z", "'"}], "s", " ", "are", " ", "internal"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"kk", "=", "1"}], ",", 
         RowBox[{"kk", "<", 
          RowBox[{"NZ", "+", "1"}]}], ",", 
         RowBox[{"kk", "++"}], ",", 
         RowBox[{"(*", 
          RowBox[{"kk", " ", "is", " ", "the", " ", "the", " ", 
           SubscriptBox["z", "k"], " ", "path"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           SubscriptBox["zext", "kk"], "=", 
           SubscriptBox["z", "kk"]}], ";", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"jj", "=", "1"}], ",", 
            RowBox[{"jj", "<", 
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"Variables", "[", 
                SubscriptBox["z", "kk"], "]"}], "]"}], "+", "1"}]}], ",", 
            RowBox[{"jj", "++"}], ",", 
            RowBox[{"(*", 
             RowBox[{
             "jj", " ", "is", " ", "the", " ", "variable", " ", "of", " ", 
              "the", " ", "the", " ", "path"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"check", "=", "0"}], ";", " ", 
             RowBox[{"(*", 
              RowBox[{
              "Check", " ", "whether", " ", "this", " ", "variable", " ", 
               "is", " ", "an", " ", "external", " ", "one"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"jk", "=", "1"}], ",", 
               RowBox[{"jk", "<", 
                RowBox[{
                 RowBox[{"Length", "[", "xb", "]"}], "+", "1"}]}], ",", 
               RowBox[{"jk", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["z", "kk"], "]"}], "[", 
                    RowBox[{"[", "jj", "]"}], "]"}], "\[Equal]", 
                   RowBox[{"xb", "[", 
                    RowBox[{"[", "jk", "]"}], "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"check", "=", "1"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"check", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"If", " ", 
                  RowBox[{"it", "'"}], "s", " ", "an", " ", "internal", " ", 
                  "one"}], ",", " ", 
                 RowBox[{"find", " ", "out", " ", "if", " ", 
                  RowBox[{"it", "'"}], "s", " ", "in", " ", "the", " ", "top",
                   " ", "or", " ", 
                  RowBox[{"bottom", ".", " ", "Then"}], " ", "remove", " ", 
                  RowBox[{"it", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["z", "kk"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["z", "kk"], "]"}], "[", 
                    RowBox[{"[", "jj", "]"}], "]"}]}], "]"}], "\[Equal]", 
                   "0"}], ",", " ", "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{
                    RowBox[{
                    "If", " ", "the", " ", "variable", " ", "is", " ", "in", 
                    " ", "the", " ", "denomianator", " ", 
                    RowBox[{"(", 
                    RowBox[{"ie", " ", "\[Equal]", "0"}], ")"}]}], ",", " ", 
                    RowBox[{"multiply", " ", "it", " ", 
                    RowBox[{"in", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["zext", "kk"], "=", 
                    RowBox[{
                    SubscriptBox["zext", "kk"], " ", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["z", "kk"], "]"}], "[", 
                    RowBox[{"[", "jj", "]"}], "]"}]}]}], ";"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["zext", "kk"], "=", 
                    RowBox[{
                    SubscriptBox["zext", "kk"], "/", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["z", "kk"], "]"}], "[", 
                    RowBox[{"[", "jj", "]"}], "]"}]}]}], ";"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["zext", "kk"], "=", 
                    RowBox[{
                    SubscriptBox["zext", "kk"], "/", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["z", "kk"], "]"}], "[", 
                    RowBox[{"[", "jj", "]"}], "]"}]}]}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             SubscriptBox["zext", "kk"], "\[Equal]", "1"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"NZI", "=", 
              RowBox[{"NZI", "+", "1"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"intz", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"intz", ",", "kk"}], "]"}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Now", " ", "we", " ", "have", " ", "the", " ", 
          SubscriptBox["wext", "i"]}], ",", " ", 
         RowBox[{
          SubscriptBox["zext", "i"], " ", "and", " ", "the", " ", "internal", 
          " ", 
          RowBox[{"lines", "!"}]}]}], "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"ref", "=", 
        RowBox[{
         RowBox[{"MonomialList", "[", "perf", "]"}], "[", 
         RowBox[{"[", "referencenum", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Make", " ", "a", " ", "list", " ", "with", " ", "all", " ", 
         "external", " ", "variables"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"allext", "=", "xb"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Create", " ", "\"\<shift operators\>\""}], ",", 
         RowBox[{
          RowBox[{"i", ".", "e", ".", " ", "products"}], " ", "of", " ", 
          "external", " ", 
          RowBox[{"w", "'"}], "s", " ", "that", " ", "end", " ", "up", " ", 
          "being", " ", "internal"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"extsubs", "=", 
        RowBox[{"Subsets", "[", 
         RowBox[{"Range", "[", 
          RowBox[{
           RowBox[{"IF", "+", "1"}], ",", 
           RowBox[{"NF", "-", "1"}]}], "]"}], "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "All", " ", "the", " ", "subsets", " ", "of", " ", "the", " ", 
         "external", " ", "faces"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"intsubs", "=", 
        RowBox[{"Subsets", "[", 
         RowBox[{"Range", "[", 
          RowBox[{"1", ",", "IF"}], "]"}], "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "All", " ", "the", " ", "subsets", " ", "of", " ", "the", " ", 
         "external", " ", "faces"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"newint", "=", "0"}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "The", " ", "label", " ", "of", " ", "the", " ", "new", " ", 
         "internal", " ", "variables"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"boundaries", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"numm", "=", "1"}], ",", 
         RowBox[{"numm", "<", 
          RowBox[{
           RowBox[{
            RowBox[{"Dimensions", "[", "extsubs", "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], ",", 
         RowBox[{"numm", "++"}], ",", 
         RowBox[{"(*", 
          RowBox[{
          "Go", " ", "through", " ", "all", " ", "the", " ", "subsets"}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Multiply", " ", "together", " ", "the", " ", "variables", " ", 
           "belonging", " ", "to", " ", "a", " ", "specific", " ", "subset"}],
           "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tryshift", "=", 
           RowBox[{"Product", "[", 
            RowBox[{
             SubscriptBox["w", 
              RowBox[{"extsubs", "[", 
               RowBox[{"[", 
                RowBox[{"numm", ",", "demax"}], "]"}], "]"}]], ",", 
             RowBox[{"{", 
              RowBox[{"demax", ",", 
               RowBox[{"Length", "[", 
                RowBox[{"extsubs", "[", 
                 RowBox[{"[", "numm", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"wpower", "=", 
           RowBox[{"extsubs", "[", 
            RowBox[{"[", "numm", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"check", "=", "0"}], ";", " ", 
          RowBox[{"(*", 
           RowBox[{
           "Check", " ", "whether", " ", "this", " ", "variable", " ", "is", 
            " ", "an", " ", "external", " ", "one"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"jj", "=", "1"}], ",", 
            RowBox[{"jj", "<", 
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"Variables", "[", "tryshift", "]"}], "]"}], "+", 
              "1"}]}], ",", 
            RowBox[{"jj", "++"}], ",", 
            RowBox[{"(*", 
             RowBox[{
             "go", " ", "through", " ", "the", " ", "tryshift", " ", 
              "variables"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"jk", "=", "1"}], ",", 
               RowBox[{"jk", "<", 
                RowBox[{
                 RowBox[{"Length", "[", "xb", "]"}], "+", "1"}]}], ",", 
               RowBox[{"jk", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Variables", "[", "tryshift", "]"}], "[", 
                    RowBox[{"[", "jj", "]"}], "]"}], "\[Equal]", 
                   RowBox[{"xb", "[", 
                    RowBox[{"[", "jk", "]"}], "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"check", "=", "1"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"check", "\[Equal]", "0"}], ",", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"If", " ", 
               RowBox[{"it", "'"}], "s", " ", "purely", " ", "internal"}], 
              ",", " ", 
              RowBox[{
              "record", " ", "a", " ", "\"\<new internal variable\>\""}], ",",
               " ", 
              RowBox[{"and", " ", "its", " ", 
               RowBox[{"powers", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              SubscriptBox["wshift", "newint"], "=", "tryshift"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              SubscriptBox["wpow", "newint"], "=", "wpower"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"boundaries", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"boundaries", ",", 
                RowBox[{"{", "wpower", "}"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"newint", "=", 
              RowBox[{"newint", "+", "1"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "Now", " ", "have", " ", "to", " ", "check", " ", "whether", 
               " ", "taking", " ", "this", " ", "internal", " ", "path", " ", 
               "made", " ", "up", " ", "of", " ", "external", " ", "faces", 
               " ", "can", " ", "be", " ", "shifted", " ", "without", " ", 
               "making", " ", "it", " ", 
               RowBox[{"longer", ".", " ", "Then"}], " ", "we", " ", "have", 
               " ", "a", " ", "new", " ", 
               RowBox[{"wshift", "."}]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"ki", "=", "2"}], ",", 
               RowBox[{"ki", "<", 
                RowBox[{
                 RowBox[{"Length", "[", "intsubs", "]"}], "+", "1"}]}], ",", 
               RowBox[{"ki", "++"}], ",", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{
                 "The", " ", "first", " ", "subset", " ", "is", " ", "the", 
                  " ", "zero", " ", "subset"}], ",", " ", 
                 RowBox[{"so", " ", "ignore", " ", "it"}]}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"wtrya", "=", "tryshift"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"el", "=", "1"}], ",", 
                  RowBox[{"el", "<", 
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"intsubs", "[", 
                    RowBox[{"[", "ki", "]"}], "]"}], "]"}], "+", "1"}]}], ",", 
                  RowBox[{"el", "++"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"wtrya", "=", 
                    RowBox[{"wtrya", " ", 
                    SubscriptBox["w", 
                    RowBox[{"intsubs", "[", 
                    RowBox[{"[", 
                    RowBox[{"ki", ",", "el"}], "]"}], "]"}]]}]}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                 "Now", " ", "we", " ", "have", " ", "a", " ", "trial", " ", 
                  RowBox[{"wshift", ".", " ", 
                   RowBox[{"Let", "'"}]}], "s", " ", "check", " ", "that", 
                  " ", "it", " ", "does", " ", "indeed", " ", "act", " ", 
                  "as", " ", "a", " ", "shift", " ", 
                  RowBox[{"operator", "."}]}], "*)"}], "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", "wtrya", "]"}], "]"}], 
                   "\[LessEqual]", 
                   RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", "tryshift", "]"}], "]"}]}], ",",
                   "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["wshift", "newint"], "=", "wtrya"}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    SubscriptBox["wpow", "newint"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{"wpower", ",", 
                    RowBox[{"intsubs", "[", 
                    RowBox[{"[", "ki", "]"}], "]"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"newint", "=", 
                    RowBox[{"newint", "+", "1"}]}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";"}]}], 
           RowBox[{"(*", 
            RowBox[{"Close", " ", "for", " ", "ki"}], "*)"}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Close", " ", "if", " ", "check"}], "\[Equal]", "0"}], 
         "*)"}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"masterspace", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{"NZ", "+", "NF", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", "0"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"fail", "=", "0"}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "The", " ", "number", " ", "of", " ", "cases", " ", "that", " ", 
         "fail"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"guess", "=", "0"}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{
        "The", " ", "number", " ", "of", " ", "times", " ", "we", " ", "had", 
         " ", "to", " ", "guess"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"k", "=", "1"}], ",", 
         RowBox[{"k", "<", 
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"MonomialList", "[", "perf", "]"}], "]"}], "+", "1"}]}], 
         ",", 
         RowBox[{"k", "++"}], ",", " ", 
         RowBox[{"(*", 
          RowBox[{
          "Go", " ", "through", " ", "all", " ", "perfect", " ", 
           "matchings"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"darn", "=", "0"}], ";", 
          RowBox[{"(*", 
           RowBox[{
           "Tells", " ", "you", " ", "whether", " ", "you", " ", "were", " ", 
            "successful", " ", "or", " ", "not"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"retry", "=", "0"}], ";", " ", 
          RowBox[{"(*", 
           RowBox[{
           "Keeps", " ", "track", " ", "of", " ", "whether", " ", "this", " ",
             "is", " ", "the", " ", "first", " ", "time", " ", "or", " ", 
            "not", " ", 
            RowBox[{
             RowBox[{"(", "Goto", ")"}], "."}]}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           SubscriptBox["consider", "k"], "=", 
           RowBox[{
            RowBox[{
             RowBox[{"MonomialList", "[", "perf", "]"}], "[", 
             RowBox[{"[", "k", "]"}], "]"}], "/", "ref"}]}], ";", " ", 
          RowBox[{"(*", 
           RowBox[{"The", " ", "term", " ", "under", " ", "consideration"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{
          "Print", "[", 
           "\"\<---------------------------------------------\>\"", "]"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<k = \>\"", ",", "k", ",", "\"\< , considering \>\"", ",", 
            SubscriptBox["consider", "k"]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Label", "[", "beginext", "]"}], ";", " ", 
          RowBox[{"(*", 
           RowBox[{"For", " ", "the", " ", "Goto", " ", "command"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"Label", "[", "beginagain", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           SubscriptBox["expression", "k"], "=", 
           RowBox[{"{", "}"}]}], ";", " ", 
          RowBox[{"(*", 
           RowBox[{
           "Will", " ", "keep", " ", "track", " ", "of", " ", "which", " ", 
            RowBox[{"w", "'"}], "s", " ", "go", " ", "into", " ", "the", " ", 
            "expression"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           SubscriptBox["zexpression", "k"], "=", 
           RowBox[{"{", "}"}]}], ";", " ", 
          RowBox[{"(*", 
           RowBox[{
           "Will", " ", "keep", " ", "track", " ", "of", " ", "which", " ", 
            RowBox[{"z", "'"}], "s", " ", "go", " ", "into", " ", "the", " ", 
            "expression"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           SubscriptBox["consider", "k"], "=", 
           RowBox[{
            RowBox[{
             RowBox[{"MonomialList", "[", "perf", "]"}], "[", 
             RowBox[{"[", "k", "]"}], "]"}], "/", "ref"}]}], ";", " ", 
          RowBox[{"(*", 
           RowBox[{
           "must", " ", "repeat", " ", "this", " ", "becuase", " ", "of", " ",
             "the", " ", "Labels"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           SubscriptBox["considervar", "k"], "=", 
           RowBox[{"Variables", "[", 
            SubscriptBox["consider", "k"], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "Now", " ", "find", " ", "out", " ", "what", " ", "the", " ", 
            "external", " ", "faces", " ", "and", " ", "external", " ", 
            RowBox[{
             SubscriptBox["z", "i"], "'"}], "s", " ", "are"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<Start external!\>\"", "]"}], ";"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"count", "=", "0"}], ";", " ", 
          RowBox[{"(*", 
           RowBox[{
           "Counter", " ", "needed", " ", "in", " ", "the", " ", "while", " ",
             "loop"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"done", "=", "0"}], ";", " ", 
          RowBox[{"(*", 
           RowBox[{
           "Tells", " ", "you", " ", "when", " ", "to", " ", "quit", " ", 
            "the", " ", "while", " ", "loop"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"done", "==", "0"}], " ", "&&", " ", 
             RowBox[{"IF", "\[NotEqual]", "NF"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"j", "=", 
              RowBox[{
               RowBox[{"Mod", "[", 
                RowBox[{"count", ",", 
                 RowBox[{"NF", "-", "IF", "-", "1"}]}], "]"}], "+", "IF", "+",
                "1"}]}], ";", 
             RowBox[{"(*", 
              RowBox[{"j", " ", "is", " ", "the", " ", 
               SubscriptBox["w", "j"], " ", "under", " ", "consideration"}], 
              "*)"}], "\[IndentingNewLine]", 
             RowBox[{
              SubscriptBox["wextcont", "j"], "=", "0"}], ";", " ", 
             RowBox[{"(*", 
              RowBox[{"Keeps", " ", "track", " ", "of", " ", "whether", " ", 
               SubscriptBox["w", "j"], " ", "is", " ", "included", " ", "or", 
               " ", "not"}], "*)"}], "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 SubscriptBox["consider", "k"], "==", "1"}], " ", "||", 
                RowBox[{
                 SubscriptBox["consider", "k"], "\[Equal]", 
                 RowBox[{"-", "1"}]}]}], " ", ",", " ", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"If", " ", "the", " ", "term", " ", "is", " ", "1"}],
                  ",", " ", 
                 RowBox[{"we", " ", "are", " ", "done"}]}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"darn", "=", "0"}], ";", "\[IndentingNewLine]", 
                RowBox[{"Break", "[", "]"}], ";"}]}], " ", 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"retry", "\[GreaterEqual]", 
                RowBox[{"(", 
                 RowBox[{"6", "patience"}], ")"}]}], ",", 
               RowBox[{"(*", 
                RowBox[{"give", " ", "up"}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"darn", "=", "1"}], ";", "\[IndentingNewLine]", 
                RowBox[{"Break", "[", "]"}], ";"}]}], "\[IndentingNewLine]", 
              "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"retry", ">", "0"}], ",", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"If", " ", 
                  RowBox[{"it", "'"}], "s", " ", "not", " ", "the", " ", 
                  "first", " ", "try", " ", "at", " ", "the", " ", "external",
                   " ", "guys"}], ",", " ", 
                 RowBox[{"mix", " ", "things", " ", "up", " ", "a", " ", 
                  RowBox[{"little", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"EvenQ", "[", "retry", "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", "/", 
                    RowBox[{"Product", "[", 
                    RowBox[{
                    SubscriptBox["w", "oio"], ",", 
                    RowBox[{"{", 
                    RowBox[{"oio", ",", 
                    RowBox[{"NF", "-", "1"}]}], "}"}]}], "]"}]}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"Range", "[", 
                    RowBox[{"NF", "-", "1"}], "]"}]}], "]"}]}], ";"}], 
                  "\[IndentingNewLine]", ",", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    RowBox[{"Product", "[", 
                    RowBox[{
                    SubscriptBox["w", "oio"], ",", 
                    RowBox[{"{", 
                    RowBox[{"oio", ",", 
                    RowBox[{"NF", "-", "1"}]}], "}"}]}], "]"}]}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"-", 
                    RowBox[{"Range", "[", 
                    RowBox[{"NF", "-", "1"}], "]"}]}]}], "]"}]}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                 "Pick", " ", "a", " ", "random", " ", "z", " ", "and", " ", 
                  "a", " ", "random", " ", "w", " ", "and", " ", "plug", " ", 
                  "it", " ", 
                  RowBox[{"in", "."}]}], "*)"}], "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"retry", ">", "2"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"ranw", "=", 
                    RowBox[{"RandomInteger", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"IF", "+", "1"}], ",", 
                    RowBox[{"NF", "-", "1"}]}], "}"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["w", "ranw"]}]}], ";", "\[IndentingNewLine]", 
                   RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "ranw"}], "}"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"NZ", "-", "NZI"}], ">", "0"}], ",", 
                    RowBox[{
                    RowBox[{"ranz", "=", 
                    RowBox[{"RandomInteger", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"NZI", "+", "1"}], ",", "NZ"}], "}"}], "]"}]}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["z", "ranz"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "ranz"}], "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{
                    SubscriptBox["considervar", "k"], "=", 
                    RowBox[{"Variables", "[", 
                    SubscriptBox["consider", "k"], "]"}]}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"count", "\[Equal]", "0"}], ",", 
                  RowBox[{
                   RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<Retried \>\"", ",", "retry", ",", 
                    "\"\< times.\>\""}], "]"}], ";"}]}], "]"}], ";"}], "*)"}],
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"count", "\[Equal]", "300"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{
                 "Print", "[", 
                  "\"\<Start over - even external faces failed.\>\"", "]"}], 
                 ";"}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"retry", "=", 
                 RowBox[{"retry", "+", "1"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"Goto", "[", "beginagain", "]"}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{
               "Check", " ", "if", " ", "wext", " ", "fits", " ", "into", " ", 
                SubscriptBox["consider", "k"]}], ",", " ", 
               RowBox[{
               "by", " ", "checking", " ", "whether", " ", "any", " ", "of", 
                " ", "the", " ", "variables", " ", "in", " ", "wext", " ", 
                "is", " ", "in", " ", 
                RowBox[{
                 SubscriptBox["consider", "k"], "."}]}]}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"i", "=", "1"}], ",", 
               RowBox[{"i", "<", 
                RowBox[{
                 RowBox[{"Length", "[", 
                  SubscriptBox["considervar", "k"], "]"}], "+", "1"}]}], ",", 
               RowBox[{"i", "++"}], ",", 
               RowBox[{"(*", 
                RowBox[{
                "Go", " ", "through", " ", "all", " ", "the", " ", 
                 "variables", " ", "of", " ", 
                 SubscriptBox["consider", "k"]}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"ii", "=", "1"}], ",", 
                  RowBox[{"ii", "<", 
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    SubscriptBox["wext", "j"], "]"}], "]"}], "+", "1"}]}], 
                  ",", 
                  RowBox[{"ii", "++"}], ",", " ", 
                  RowBox[{"(*", 
                   RowBox[{
                   "Go", " ", "through", " ", "all", " ", "the", " ", 
                    "variables", " ", "of", " ", "wext"}], "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["wext", "j"], "]"}], "[", 
                    RowBox[{"[", "ii", "]"}], "]"}], "==", 
                    RowBox[{
                    SubscriptBox["considervar", "k"], "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["wextcont", "j"], "=", "1"}], ";", " ", 
                    RowBox[{"(*", 
                    RowBox[{"It", " ", "is", " ", 
                    RowBox[{"contained", "!"}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"save", "=", "ii"}], ";"}]}], " ", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Remember", " ", "which", " ", "variable", " ", "was", 
                    " ", "contained"}], "*)"}], "\[IndentingNewLine]", "]"}], 
                   ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                SubscriptBox["wextcont", "j"], "==", "1"}], ",", " ", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"Now", " ", "remove", " ", "the", " ", 
                  SubscriptBox["w", "j"], " ", "from", " ", 
                  SubscriptBox["consider", "k"]}], ",", " ", 
                 RowBox[{"and", " ", "record", " ", "this", " ", "into", " ", 
                  SubscriptBox["expression", "k"]}]}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                "Decide", " ", "whether", " ", "to", " ", "divide", " ", "or",
                  " ", 
                 RowBox[{"multiply", "."}]}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["wext", "j"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["wext", "j"], "]"}], "[", 
                    RowBox[{"[", "save", "]"}], "]"}]}], "]"}], "\[Equal]", 
                   "0"}], ",", " ", "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{
                    RowBox[{
                    "If", " ", "the", " ", "variable", " ", "is", " ", "in", 
                    " ", "the", " ", "denomianator", " ", 
                    RowBox[{"(", 
                    RowBox[{"ie", " ", "\[Equal]", "0"}], ")"}]}], ",", " ", 
                    RowBox[{"do", " ", 
                    RowBox[{"\"\<the opposite\>\"", ".", " ", "Otherwise"}]}],
                     ",", " ", 
                    RowBox[{"act", " ", 
                    RowBox[{"\"\<as normal\>\"", "."}]}]}], "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["wext", "j"], "]"}], "[", 
                    RowBox[{"[", "save", "]"}], "]"}]}], "]"}], "\[Equal]", 
                    "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"Here", " ", "is", " ", "the", " ", 
                    RowBox[{"opposite", "!"}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["w", "j"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"{", "j", "}"}]}], "]"}]}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["w", "j"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "j"}], "}"}]}], "]"}]}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["w", "j"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "j"}], "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["wext", "j"], "]"}], "[", 
                    RowBox[{"[", "save", "]"}], "]"}]}], "]"}], "\[Equal]", 
                    "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"Here", " ", "is", " ", "the", " ", 
                    RowBox[{"normal", "!"}]}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["w", "j"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "j"}], "}"}]}], "]"}]}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["w", "j"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"{", "j", "}"}]}], "]"}]}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["w", "j"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"{", "j", "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["wext", "j"], "]"}], "[", 
                    RowBox[{"[", "save", "]"}], "]"}]}], "]"}], "\[Equal]", 
                    "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"Here", " ", "is", " ", "the", " ", 
                    RowBox[{"normal", "!"}]}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["w", "j"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "j"}], "}"}]}], "]"}]}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["w", "j"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"{", "j", "}"}]}], "]"}]}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["w", "j"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"{", "j", "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{
                 SubscriptBox["considervar", "k"], "=", 
                 RowBox[{"Variables", "[", 
                  SubscriptBox["consider", "k"], "]"}]}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";", " ", 
             RowBox[{"(*", 
              RowBox[{"Close", " ", "If"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"Finished", " ", "recording", " ", "the", " ", 
               RowBox[{"operation", "!"}]}], "*)"}], "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"NZ", "-", "NZI"}], ">", "0"}], ",", " ", 
               RowBox[{"(*", 
                RowBox[{
                "If", " ", "we", " ", "have", " ", "external", " ", "z", " ", 
                 "paths"}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"jz", "=", 
                 RowBox[{
                  RowBox[{"Mod", "[", 
                   RowBox[{"count", ",", "NZ"}], "]"}], "+", "1"}]}], ";", 
                RowBox[{"(*", 
                 RowBox[{"jz", " ", "is", " ", "the", " ", 
                  SubscriptBox["z", "jz"], " ", "under", " ", 
                  "consideration"}], "*)"}], "\[IndentingNewLine]", 
                RowBox[{
                 SubscriptBox["zextcont", "jz"], "=", "0"}], ";", " ", 
                RowBox[{"(*", 
                 RowBox[{
                 "Keeps", " ", "track", " ", "of", " ", "whether", " ", 
                  SubscriptBox["z", "j"], " ", "is", " ", "included", " ", 
                  "or", " ", "not"}], "*)"}], "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                 "Now", " ", "check", " ", "if", " ", "zext", " ", "fits", 
                  " ", "into", " ", 
                  RowBox[{
                   SubscriptBox["consider", "k"], "."}]}], "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"i", "=", "1"}], ",", 
                  RowBox[{"i", "<", 
                   RowBox[{
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}], "+", "1"}]}], 
                  ",", 
                  RowBox[{"i", "++"}], ",", 
                  RowBox[{"(*", 
                   RowBox[{
                   "Go", " ", "through", " ", "all", " ", "the", " ", 
                    "variables", " ", "of", " ", 
                    SubscriptBox["consider", "k"]}], "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"ii", "=", "1"}], ",", 
                    RowBox[{"ii", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    SubscriptBox["zext", "jz"], "]"}], "]"}], "+", "1"}]}], 
                    ",", 
                    RowBox[{"ii", "++"}], ",", " ", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Go", " ", "through", " ", "all", " ", "the", " ", 
                    "variables", " ", "of", " ", "zext"}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["zext", "jz"], "]"}], "[", 
                    RowBox[{"[", "ii", "]"}], "]"}], "==", 
                    RowBox[{
                    SubscriptBox["considervar", "k"], "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["zextcont", "jz"], "=", "1"}], ";", " ", 
                    RowBox[{"(*", 
                    RowBox[{"It", " ", "is", " ", 
                    RowBox[{"contained", "!"}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"save2", "=", "ii"}], ";"}]}], " ", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Remember", " ", "which", " ", "variable", " ", "was", 
                    " ", "contained"}], "*)"}], "\[IndentingNewLine]", "]"}], 
                    ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", 
                RowBox[{"a", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["zextcont", "jz"], "==", "1"}], ",", " ", 
                   RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"Now", " ", "remove", " ", "the", " ", 
                    SubscriptBox["z", "jz"], " ", "from", " ", 
                    SubscriptBox["consider", "k"]}], ",", " ", 
                    RowBox[{
                    "and", " ", "record", " ", "this", " ", "into", " ", 
                    SubscriptBox["zexpression", "k"]}]}], "*)"}], 
                   "\[IndentingNewLine]", 
                   RowBox[{"(*", 
                    RowBox[{
                    "Decide", " ", "whether", " ", "to", " ", "divide", " ", 
                    "or", " ", 
                    RowBox[{"multiply", "."}]}], "*)"}], 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["zext", "jz"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["zext", "jz"], "]"}], "[", 
                    RowBox[{"[", "save2", "]"}], "]"}]}], "]"}], "\[Equal]", 
                    "0"}], ",", " ", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{
                    "If", " ", "the", " ", "variable", " ", "is", " ", "in", 
                    " ", "the", " ", "denomianator", " ", 
                    RowBox[{"(", 
                    RowBox[{"ie", " ", "\[Equal]", "0"}], ")"}]}], ",", " ", 
                    RowBox[{"do", " ", 
                    RowBox[{"\"\<the opposite\>\"", ".", " ", "Otherwise"}]}],
                     ",", " ", 
                    RowBox[{"act", " ", 
                    RowBox[{"\"\<as normal\>\"", "."}]}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["zext", "jz"], "]"}], "[", 
                    RowBox[{"[", "save2", "]"}], "]"}]}], "]"}], "\[Equal]", 
                    "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"Here", " ", "is", " ", "the", " ", 
                    RowBox[{"opposite", "!"}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["z", "jz"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], ",", 
                    RowBox[{"{", "jz", "}"}]}], "]"}]}], ";"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["z", "jz"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "jz"}], "}"}]}], "]"}]}], ";"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["z", "jz"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "jz"}], "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["zext", "jz"], "]"}], "[", 
                    RowBox[{"[", "save2", "]"}], "]"}]}], "]"}], "\[Equal]", 
                    "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"Here", " ", "is", " ", "the", " ", 
                    RowBox[{"normal", "!"}]}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["z", "jz"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "jz"}], "}"}]}], "]"}]}], ";"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["z", "jz"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], ",", 
                    RowBox[{"{", "jz", "}"}]}], "]"}]}], ";"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["z", "jz"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], ",", 
                    RowBox[{"{", "jz", "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["zext", "jz"], "]"}], "[", 
                    RowBox[{"[", "save2", "]"}], "]"}]}], "]"}], "\[Equal]", 
                    "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"Here", " ", "is", " ", "the", " ", 
                    RowBox[{"normal", "!"}]}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["z", "jz"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "jz"}], "}"}]}], "]"}]}], ";"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["z", "jz"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], ",", 
                    RowBox[{"{", "jz", "}"}]}], "]"}]}], ";"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["z", "jz"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], ",", 
                    RowBox[{"{", "jz", "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["considervar", "k"], "=", 
                    RowBox[{"Variables", "[", 
                    SubscriptBox["consider", "k"], "]"}]}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}]}], ";"}]}], " ", 
              RowBox[{"(*", 
               RowBox[{"Close", " ", "If"}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{"Finished", " ", "recording", " ", "the", " ", 
                RowBox[{"operation", "!"}]}], "*)"}], "\[IndentingNewLine]", 
              "]"}], ";", " ", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{
                RowBox[{"Close", " ", "if", " ", "NZ"}], "-", "NZI"}], ">", 
               "0"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{
               "If", " ", "there", " ", "are", " ", "no", " ", "more", " ", 
                "wext", " ", "to", " ", "fit", " ", "in"}], ",", " ", 
               RowBox[{"we", " ", "are", " ", 
                RowBox[{"done", ".", " ", "Check"}], " ", 
                RowBox[{"this", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"done", "=", "1"}], ";", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"ij", "=", "1"}], ",", 
               RowBox[{"ij", "<", 
                RowBox[{
                 RowBox[{"Length", "[", "allext", "]"}], "+", "1"}]}], ",", 
               RowBox[{"ij", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"ji", "=", "1"}], ",", 
                  RowBox[{"ji", "<", 
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    SubscriptBox["consider", "k"], "]"}], "]"}], "+", "1"}]}],
                   ",", 
                  RowBox[{"ji", "++"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"allext", "[", 
                    RowBox[{"[", "ij", "]"}], "]"}], "\[Equal]", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["consider", "k"], "]"}], "[", 
                    RowBox[{"[", "ji", "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"done", "=", "0"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "Now", " ", "we", " ", "know", " ", "if", " ", "we", " ", "are",
                " ", "done", " ", "or", " ", "not"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"count", "=", 
              RowBox[{"count", "+", "1"}]}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";", " ", 
          RowBox[{"(*", 
           RowBox[{"Close", " ", "while", " ", "loop"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "Now", " ", "we", " ", "have", " ", "the", " ", "external", " ", 
            RowBox[{"faces", "!"}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"senttointernal", "=", 
           SubscriptBox["consider", "k"]}], ";", 
          RowBox[{"(*", 
           RowBox[{
           "Record", " ", "what", " ", "we", " ", "sent", " ", "to", " ", 
            "the", " ", "internal", " ", 
            RowBox[{"faces", "."}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"sentexpression", "=", 
           SubscriptBox["expression", "k"]}], ";", "\[IndentingNewLine]", 
          RowBox[{"zsentexpression", "=", 
           SubscriptBox["zexpression", "k"]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "Now", " ", "find", " ", "out", " ", "what", " ", "the", " ", 
            "internal", " ", "faces", " ", "and", " ", "internal", " ", 
            RowBox[{
             SubscriptBox["z", "i"], "'"}], "s", " ", "are"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<Start internal!\>\"", "]"}], ";"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"count", "=", "0"}], ";", " ", 
          RowBox[{"(*", 
           RowBox[{
           "Counter", " ", "needed", " ", "in", " ", "the", " ", "while", " ",
             "loop"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"IF", ">", "0"}], "||", 
             RowBox[{"NZI", ">", "0"}], "||", 
             RowBox[{"newint", ">", "1"}]}], ",", 
            RowBox[{"(*", 
             RowBox[{
             "Keeps", " ", "going", " ", "until", " ", "we", " ", "get", " ", 
              "1."}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 SubscriptBox["consider", "k"], "==", "1"}], " ", "||", 
                RowBox[{
                 SubscriptBox["consider", "k"], "\[Equal]", 
                 RowBox[{"-", "1"}]}]}], " ", ",", " ", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"If", " ", "the", " ", "term", " ", "is", " ", "1"}],
                  ",", " ", 
                 RowBox[{"we", " ", "are", " ", "done"}]}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"count", "\[NotEqual]", "300"}], ",", 
                  RowBox[{
                   RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<Found after \>\"", ",", "count", ",", 
                    "\"\< operations.\>\""}], "]"}], ";"}]}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"darn", "=", "0"}], ";", "\[IndentingNewLine]", 
                RowBox[{"Break", "[", "]"}], ";"}]}], " ", 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "Now", " ", "check", " ", "if", " ", "z", " ", "fits", " ", 
               "into", " ", 
               RowBox[{
                SubscriptBox["consider", "k"], "."}]}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"NZI", ">", "0"}], ",", 
               RowBox[{"(*", 
                RowBox[{"Check", " ", "internal", " ", 
                 RowBox[{
                  SubscriptBox["z", "i"], "'"}], "s"}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"jz", "=", 
                 RowBox[{
                  RowBox[{"Mod", "[", 
                   RowBox[{"count", ",", "NZI"}], "]"}], "+", "1"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 SubscriptBox["zintcont", "jz"], "=", "0"}], ";", " ", 
                RowBox[{"(*", 
                 RowBox[{
                 "Keeps", " ", "track", " ", "of", " ", "whether", " ", 
                  SubscriptBox["z", "j"], " ", "is", " ", "included", " ", 
                  "or", " ", "not"}], "*)"}], "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    SubscriptBox["consider", "k"], "==", "1"}], " ", "||", 
                   RowBox[{
                    SubscriptBox["consider", "k"], "\[Equal]", 
                    RowBox[{"-", "1"}]}]}], " ", ",", " ", 
                  RowBox[{"(*", 
                   RowBox[{
                    RowBox[{
                    "If", " ", "the", " ", "term", " ", "is", " ", "1"}], ",",
                     " ", 
                    RowBox[{"we", " ", "are", " ", "done"}]}], "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"darn", "=", "0"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"Break", "[", "]"}], ";"}]}], " ", 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"ii", "=", "1"}], ",", 
                  RowBox[{"ii", "<", 
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    SubscriptBox["z", "jz"], "]"}], "]"}], "+", "1"}]}], ",", 
                  RowBox[{"ii", "++"}], ",", " ", 
                  RowBox[{"(*", 
                   RowBox[{
                   "Go", " ", "through", " ", "all", " ", "the", " ", 
                    "variables", " ", "of", " ", 
                    SubscriptBox["z", "j"]}], "*)"}], "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"i", "=", "1"}], ",", 
                    RowBox[{"i", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}], "+", "1"}]}], 
                    ",", 
                    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Go", " ", "through", " ", "all", " ", "the", " ", 
                    "variables", " ", "of", " ", 
                    SubscriptBox["consider", "k"]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["z", "jz"], "]"}], "[", 
                    RowBox[{"[", "ii", "]"}], "]"}], "==", 
                    RowBox[{
                    SubscriptBox["considervar", "k"], "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["zintcont", "jz"], "=", "1"}], ";", " ", 
                    RowBox[{"(*", 
                    RowBox[{"It", " ", "is", " ", 
                    RowBox[{"contained", "!"}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"save2", "=", "ii"}], ";"}]}], " ", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Remember", " ", "which", " ", "variable", " ", "was", 
                    " ", "contained"}], "*)"}], "\[IndentingNewLine]", "]"}], 
                    ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   SubscriptBox["zintcont", "jz"], "==", "1"}], ",", " ", 
                  RowBox[{"(*", 
                   RowBox[{
                    RowBox[{"Now", " ", "remove", " ", "the", " ", 
                    SubscriptBox["z", "jz"], " ", "from", " ", 
                    SubscriptBox["consider", "k"]}], ",", " ", 
                    RowBox[{
                    "and", " ", "record", " ", "this", " ", "into", " ", 
                    SubscriptBox["expression", "k"]}]}], "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{
                   "Decide", " ", "whether", " ", "to", " ", "divide", " ", 
                    "or", " ", 
                    RowBox[{"multiply", "."}]}], "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["z", "jz"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["z", "jz"], "]"}], "[", 
                    RowBox[{"[", "save2", "]"}], "]"}]}], "]"}], "\[Equal]", 
                    "0"}], ",", " ", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{
                    "If", " ", "the", " ", "variable", " ", "is", " ", "in", 
                    " ", "the", " ", "denomianator", " ", 
                    RowBox[{"(", 
                    RowBox[{"ie", " ", "\[Equal]", "0"}], ")"}]}], ",", " ", 
                    RowBox[{"do", " ", 
                    RowBox[{"\"\<the opposite\>\"", ".", " ", "Otherwise"}]}],
                     ",", " ", 
                    RowBox[{"act", " ", 
                    RowBox[{"\"\<as normal\>\"", "."}]}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["z", "jz"], "]"}], "[", 
                    RowBox[{"[", "save2", "]"}], "]"}]}], "]"}], "\[Equal]", 
                    "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"Here", " ", "is", " ", "the", " ", 
                    RowBox[{"opposite", "!"}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["z", "jz"]}], "]"}], "]"}], "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["z", "jz"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], ",", 
                    RowBox[{"{", "jz", "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["z", "jz"]}], "]"}], "]"}], "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["z", "jz"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "jz"}], "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["z", "jz"]}], "]"}], "]"}], "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["z", "jz"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "jz"}], "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["z", "jz"], "]"}], "[", 
                    RowBox[{"[", "save2", "]"}], "]"}]}], "]"}], "\[Equal]", 
                    "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"Here", " ", "is", " ", "the", " ", 
                    RowBox[{"normal", "!"}]}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["z", "jz"]}], "]"}], "]"}], "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["z", "jz"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "jz"}], "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["z", "jz"]}], "]"}], "]"}], "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["z", "jz"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], ",", 
                    RowBox[{"{", "jz", "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["z", "jz"]}], "]"}], "]"}], "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["z", "jz"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], ",", 
                    RowBox[{"{", "jz", "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["z", "jz"], "]"}], "[", 
                    RowBox[{"[", "save2", "]"}], "]"}]}], "]"}], "\[Equal]", 
                    "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"Here", " ", "is", " ", "the", " ", 
                    RowBox[{"normal", "!"}]}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["z", "jz"]}], "]"}], "]"}], "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["z", "jz"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "jz"}], "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["z", "jz"]}], "]"}], "]"}], "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["z", "jz"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], ",", 
                    RowBox[{"{", "jz", "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["z", "jz"]}], "]"}], "]"}], "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["z", "jz"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], ",", 
                    RowBox[{"{", "jz", "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{
                    SubscriptBox["considervar", "k"], "=", 
                    RowBox[{"Variables", "[", 
                    SubscriptBox["consider", "k"], "]"}]}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], " ", 
              RowBox[{"(*", 
               RowBox[{"Close", " ", "If"}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{"Finished", " ", "recording", " ", "the", " ", 
                RowBox[{"operation", "!"}]}], "*)"}], "\[IndentingNewLine]", 
              "]"}], ";", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"Close", " ", "if", " ", "NZI"}], ">", "0"}], "*)"}], 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 SubscriptBox["consider", "k"], "==", "1"}], " ", "||", 
                RowBox[{
                 SubscriptBox["consider", "k"], "\[Equal]", 
                 RowBox[{"-", "1"}]}]}], " ", ",", " ", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"If", " ", "the", " ", "term", " ", "is", " ", "1"}],
                  ",", " ", 
                 RowBox[{"we", " ", "are", " ", "done"}]}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{
                 "\"\<Found after \>\"", ",", "count", ",", 
                  "\"\< operations.\>\""}], "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"darn", "=", "0"}], ";", "\[IndentingNewLine]", 
                RowBox[{"Break", "[", "]"}], ";"}]}], " ", 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "Now", " ", "check", " ", "if", " ", "wshift", " ", "fits", " ",
                "into", " ", 
               RowBox[{
                SubscriptBox["consider", "k"], "."}]}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"newint", ">", "1"}], ",", 
               RowBox[{"(*", 
                RowBox[{
                "If", " ", "we", " ", "have", " ", "any", " ", "wshift", " ", 
                 "to", " ", "consider"}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"jsh", "=", 
                 RowBox[{
                  RowBox[{"Mod", "[", 
                   RowBox[{"count", ",", 
                    RowBox[{"newint", "-", "1"}]}], "]"}], "+", "1"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 SubscriptBox["wshiftcont", "jsh"], "=", "0"}], ";", " ", 
                RowBox[{"(*", 
                 RowBox[{
                 "Keeps", " ", "track", " ", "of", " ", "whether", " ", 
                  SubscriptBox["wshift", "j"], " ", "is", " ", "included", 
                  " ", "or", " ", "not"}], "*)"}], "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    SubscriptBox["consider", "k"], "==", "1"}], " ", "||", 
                   RowBox[{
                    SubscriptBox["consider", "k"], "\[Equal]", 
                    RowBox[{"-", "1"}]}]}], " ", ",", " ", 
                  RowBox[{"(*", 
                   RowBox[{
                    RowBox[{
                    "If", " ", "the", " ", "term", " ", "is", " ", "1"}], ",",
                     " ", 
                    RowBox[{"we", " ", "are", " ", "done"}]}], "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"darn", "=", "0"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"Break", "[", "]"}], ";"}]}], " ", 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"ii", "=", "1"}], ",", 
                  RowBox[{"ii", "<", 
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    SubscriptBox["wshift", "jsh"], "]"}], "]"}], "+", "1"}]}],
                   ",", 
                  RowBox[{"ii", "++"}], ",", " ", 
                  RowBox[{"(*", 
                   RowBox[{
                   "Go", " ", "through", " ", "all", " ", "the", " ", 
                    "variables", " ", "of", " ", 
                    SubscriptBox["wshift", "j"]}], "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"i", "=", "1"}], ",", 
                    RowBox[{"i", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}], "+", "1"}]}], 
                    ",", 
                    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Go", " ", "through", " ", "all", " ", "the", " ", 
                    "variables", " ", "of", " ", 
                    SubscriptBox["consider", "k"]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["wshift", "jsh"], "]"}], "[", 
                    RowBox[{"[", "ii", "]"}], "]"}], "==", 
                    RowBox[{
                    SubscriptBox["considervar", "k"], "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["wshiftcont", "jsh"], "=", "1"}], ";", " ", 
                    RowBox[{"(*", 
                    RowBox[{"It", " ", "is", " ", 
                    RowBox[{"contained", "!"}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"save3", "=", "ii"}], ";"}]}], " ", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Remember", " ", "which", " ", "variable", " ", "was", 
                    " ", "contained"}], "*)"}], "\[IndentingNewLine]", "]"}], 
                    ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   SubscriptBox["wshiftcont", "jsh"], "==", "1"}], ",", " ", 
                  RowBox[{"(*", 
                   RowBox[{
                    RowBox[{"Now", " ", "remove", " ", "the", " ", 
                    SubscriptBox["wshift", "jz"], " ", "from", " ", 
                    SubscriptBox["consider", "k"]}], ",", " ", 
                    RowBox[{
                    "and", " ", "record", " ", "this", " ", "into", " ", 
                    SubscriptBox["expression", "k"]}]}], "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{
                   "Decide", " ", "whether", " ", "to", " ", "divide", " ", 
                    "or", " ", 
                    RowBox[{"multiply", "."}]}], "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["wshift", "jsh"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["wshift", "jsh"], "]"}], "[", 
                    RowBox[{"[", "save3", "]"}], "]"}]}], "]"}], "\[Equal]", 
                    "0"}], ",", " ", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{
                    "If", " ", "the", " ", "variable", " ", "is", " ", "in", 
                    " ", "the", " ", "denomianator", " ", 
                    RowBox[{"(", 
                    RowBox[{"ie", " ", "\[Equal]", "0"}], ")"}]}], ",", " ", 
                    RowBox[{"do", " ", 
                    RowBox[{"\"\<the opposite\>\"", ".", " ", "Otherwise"}]}],
                     ",", " ", 
                    RowBox[{"act", " ", 
                    RowBox[{"\"\<as normal\>\"", "."}]}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["wshift", "jsh"], "]"}], "[", 
                    RowBox[{"[", "save3", "]"}], "]"}]}], "]"}], "\[Equal]", 
                    "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"Here", " ", "is", " ", "the", " ", 
                    RowBox[{"opposite", "!"}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["wshift", "jsh"]}], "]"}], "]"}], 
                    "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["wshift", "jsh"]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    SubscriptBox["wpow", "jsh"]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["wshift", "jsh"]}], "]"}], "]"}], 
                    "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["wshift", "jsh"]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"-", 
                    SubscriptBox["wpow", "jsh"]}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["wshift", "jsh"]}], "]"}], "]"}], 
                    "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["wshift", "jsh"]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"-", 
                    SubscriptBox["wpow", "jsh"]}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["wshift", "jz"], "]"}], "[", 
                    RowBox[{"[", "save3", "]"}], "]"}]}], "]"}], "\[Equal]", 
                    "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"Here", " ", "is", " ", "the", " ", 
                    RowBox[{"normal", "!"}]}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["wshift", "jsh"]}], "]"}], "]"}], 
                    "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["wshift", "jsh"]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"-", 
                    SubscriptBox["wpow", "jsh"]}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["wshift", "jsh"]}], "]"}], "]"}], 
                    "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["wshift", "jsh"]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    SubscriptBox["wpow", "jsh"]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["wshift", "jsh"]}], "]"}], "]"}], 
                    "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["wshift", "jsh"]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    SubscriptBox["wpow", "jsh"]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["wshift", "jsh"], "]"}], "[", 
                    RowBox[{"[", "save3", "]"}], "]"}]}], "]"}], "\[Equal]", 
                    "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"Here", " ", "is", " ", "the", " ", 
                    RowBox[{"normal", "!"}]}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["wshift", "jsh"]}], "]"}], "]"}], 
                    "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["wshift", "jsh"]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"-", 
                    SubscriptBox["wpow", "jsh"]}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["wshift", "jsh"]}], "]"}], "]"}], 
                    "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["wshift", "jsh"]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    SubscriptBox["wpow", "jsh"]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["wshift", "jsh"]}], "]"}], "]"}], 
                    "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["wshift", "jsh"]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    SubscriptBox["wpow", "jsh"]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
                    "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{
                    SubscriptBox["considervar", "k"], "=", 
                    RowBox[{"Variables", "[", 
                    SubscriptBox["consider", "k"], "]"}]}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], " ", 
              RowBox[{"(*", 
               RowBox[{"Close", " ", "If"}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{"Finished", " ", "recording", " ", "the", " ", 
                RowBox[{"operation", "!"}]}], "*)"}], "\[IndentingNewLine]", 
              "]"}], ";", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"Close", " ", "if", " ", "newint"}], ">", "0"}], 
              "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 SubscriptBox["consider", "k"], "==", "1"}], " ", "||", 
                RowBox[{
                 SubscriptBox["consider", "k"], "\[Equal]", 
                 RowBox[{"-", "1"}]}]}], " ", ",", " ", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"If", " ", "the", " ", "term", " ", "is", " ", "1"}],
                  ",", " ", 
                 RowBox[{"we", " ", "are", " ", "done"}]}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{
                 "\"\<Found after \>\"", ",", "count", ",", 
                  "\"\< operations.\>\""}], "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"darn", "=", "0"}], ";", "\[IndentingNewLine]", 
                RowBox[{"Break", "[", "]"}], ";"}]}], " ", 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"IF", ">", "0"}], ",", " ", 
               RowBox[{"(*", 
                RowBox[{"Check", " ", "internal", " ", "faces"}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"j", "=", 
                 RowBox[{
                  RowBox[{"Mod", "[", 
                   RowBox[{"count", ",", "IF"}], "]"}], "+", "1"}]}], ";", 
                RowBox[{"(*", 
                 RowBox[{"j", " ", "is", " ", "the", " ", 
                  SubscriptBox["w", "j"], " ", "under", " ", 
                  "consideration"}], "*)"}], "\[IndentingNewLine]", 
                RowBox[{
                 SubscriptBox["wintcont", "j"], "=", "0"}], ";", " ", 
                RowBox[{"(*", 
                 RowBox[{
                 "Keeps", " ", "track", " ", "of", " ", "whether", " ", 
                  SubscriptBox["w", "j"], " ", "is", " ", "included", " ", 
                  "or", " ", "not"}], "*)"}], "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{
                  "Check", " ", "if", " ", "w", " ", "fits", " ", "into", " ", 
                   SubscriptBox["consider", "k"]}], ",", " ", 
                  RowBox[{
                  "by", " ", "checking", " ", "whether", " ", "any", " ", 
                   "of", " ", "the", " ", "variables", " ", "in", " ", 
                   SubscriptBox["w", "j"], " ", "is", " ", "in", " ", 
                   RowBox[{
                    SubscriptBox["consider", "k"], "."}]}]}], "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"i", "=", "1"}], ",", 
                  RowBox[{"i", "<", 
                   RowBox[{
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}], "+", "1"}]}], 
                  ",", 
                  RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"ii", "=", "1"}], ",", 
                    RowBox[{"ii", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    SubscriptBox["w", "j"], "]"}], "]"}], "+", "1"}]}], ",", 
                    RowBox[{"ii", "++"}], ",", " ", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Go", " ", "through", " ", "all", " ", "the", " ", 
                    "variables", " ", "of", " ", 
                    SubscriptBox["w", "j"]}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Go", " ", "through", " ", "all", " ", "the", " ", 
                    "variables", " ", "of", " ", 
                    SubscriptBox["consider", "k"]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["w", "j"], "]"}], "[", 
                    RowBox[{"[", "ii", "]"}], "]"}], "==", 
                    RowBox[{
                    SubscriptBox["considervar", "k"], "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["wintcont", "j"], "=", "1"}], ";", " ", 
                    RowBox[{"(*", 
                    RowBox[{"It", " ", "is", " ", 
                    RowBox[{"contained", "!"}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"save", "=", "ii"}], ";"}]}], " ", 
                    RowBox[{"(*", 
                    RowBox[{
                    "Remember", " ", "which", " ", "variable", " ", "was", 
                    " ", "contained"}], "*)"}], "\[IndentingNewLine]", "]"}], 
                    ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   SubscriptBox["wintcont", "j"], "==", "1"}], ",", " ", 
                  RowBox[{"(*", 
                   RowBox[{
                    RowBox[{"Now", " ", "remove", " ", "the", " ", 
                    SubscriptBox["w", "j"], " ", "from", " ", 
                    SubscriptBox["consider", "k"]}], ",", " ", 
                    RowBox[{
                    "and", " ", "record", " ", "this", " ", "into", " ", 
                    SubscriptBox["expression", "k"]}]}], "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{
                   "Decide", " ", "whether", " ", "to", " ", "divide", " ", 
                    "or", " ", 
                    RowBox[{"multiply", "."}]}], "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["w", "j"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["w", "j"], "]"}], "[", 
                    RowBox[{"[", "save", "]"}], "]"}]}], "]"}], "\[Equal]", 
                    "0"}], ",", " ", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{
                    "If", " ", "the", " ", "variable", " ", "is", " ", "in", 
                    " ", "the", " ", "denomianator", " ", 
                    RowBox[{"(", 
                    RowBox[{"ie", " ", "\[Equal]", "0"}], ")"}]}], ",", " ", 
                    RowBox[{"do", " ", 
                    RowBox[{"\"\<the opposite\>\"", ".", " ", "Otherwise"}]}],
                     ",", " ", 
                    RowBox[{"act", " ", 
                    RowBox[{"\"\<as normal\>\"", "."}]}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["w", "j"], "]"}], "[", 
                    RowBox[{"[", "save", "]"}], "]"}]}], "]"}], "\[Equal]", 
                    "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"Here", " ", "is", " ", "the", " ", 
                    RowBox[{"opposite", "!"}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["w", "j"]}], "]"}], "]"}], "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["w", "j"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"{", "j", "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["w", "j"]}], "]"}], "]"}], "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["w", "j"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "j"}], "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["w", "j"]}], "]"}], "]"}], "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["w", "j"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "j"}], "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["w", "j"], "]"}], "[", 
                    RowBox[{"[", "save", "]"}], "]"}]}], "]"}], "\[Equal]", 
                    "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"Here", " ", "is", " ", "the", " ", 
                    RowBox[{"normal", "!"}]}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["w", "j"]}], "]"}], "]"}], "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["w", "j"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "j"}], "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["w", "j"]}], "]"}], "]"}], "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["w", "j"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"{", "j", "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["w", "j"]}], "]"}], "]"}], "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["w", "j"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"{", "j", "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    SubscriptBox["w", "j"], "]"}], "[", 
                    RowBox[{"[", "save", "]"}], "]"}]}], "]"}], "\[Equal]", 
                    "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"Here", " ", "is", " ", "the", " ", 
                    RowBox[{"normal", "!"}]}], "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["w", "j"]}], "]"}], "]"}], "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SubscriptBox["w", "j"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{"-", "j"}], "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["w", "j"]}], "]"}], "]"}], "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["w", "j"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"{", "j", "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["w", "j"]}], "]"}], "]"}], "\[LessEqual]", 
                    RowBox[{"Length", "[", 
                    SubscriptBox["considervar", "k"], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "/", 
                    SubscriptBox["w", "j"]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"{", "j", "}"}]}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{
                    SubscriptBox["considervar", "k"], "=", 
                    RowBox[{"Variables", "[", 
                    SubscriptBox["consider", "k"], "]"}]}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], " ", 
              RowBox[{"(*", 
               RowBox[{"Close", " ", "If"}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{"Finished", " ", "recording", " ", "the", " ", 
                RowBox[{"operation", "!"}]}], "*)"}], "\[IndentingNewLine]", 
              "]"}], ";", " ", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"Close", " ", "if", " ", "IF"}], ">", "0"}], "*)"}], 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"count", "=", 
              RowBox[{"count", "+", "1"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"count", "\[Equal]", "300"}], "&&", 
                RowBox[{"retry", "<", 
                 RowBox[{"(", 
                  RowBox[{"6", "patience"}], ")"}]}]}], ",", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{
                 "If", " ", "it", " ", "failed", " ", "but", " ", "it", " ", 
                  "could", " ", "be", " ", "our", " ", "fault"}], ",", " ", 
                 RowBox[{"try", " ", "to", " ", "guess", " ", "it", " ", 
                  RowBox[{"randomly", "."}]}]}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"powers", "=", 
                 RowBox[{"Array", "[", 
                  RowBox[{"tem", ",", 
                   RowBox[{"IF", "+", "NZI"}]}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                 "The", " ", "list", " ", "that", " ", "contains", " ", "all",
                   " ", "the", " ", "powers"}], "*)"}], "\[IndentingNewLine]", 
                RowBox[{"score", "=", "0"}], ";", "\[IndentingNewLine]", 
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"bore", "=", "1"}], ",", 
                  RowBox[{"bore", "<", 
                   RowBox[{
                    SuperscriptBox["10", 
                    RowBox[{"(", 
                    RowBox[{"patience", "+", "1"}], ")"}]], "+", "1"}]}], ",", 
                  RowBox[{"bore", "++"}], ",", 
                  RowBox[{"(*", 
                   RowBox[{"Try", " ", "lots", " ", "of", " ", "times"}], 
                   "*)"}], "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["consider", "k"], "=", "senttointernal"}], 
                   ";", 
                   RowBox[{"(*", 
                    RowBox[{
                    "Each", " ", "time", " ", "start", " ", "again", " ", 
                    "with", " ", "what", " ", "we", " ", "were", " ", 
                    "given"}], "*)"}], "\[IndentingNewLine]", 
                   RowBox[{
                    SubscriptBox["expression", "k"], "=", "sentexpression"}], 
                   ";", "\[IndentingNewLine]", 
                   RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    "zsentexpression"}], ";", "\[IndentingNewLine]", 
                   "\[IndentingNewLine]", 
                   RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"cha", "=", "1"}], ",", 
                    RowBox[{"cha", "<", 
                    RowBox[{"IF", "+", "NZI", "+", "1"}]}], ",", 
                    RowBox[{"cha", "++"}], ",", 
                    RowBox[{"(*", 
                    RowBox[{"Assign", " ", "random", " ", "powers"}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"powers", "[", 
                    RowBox[{"[", "cha", "]"}], "]"}], "=", 
                    RowBox[{"RandomInteger", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "2"}], ",", "2"}], "}"}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"pow", "=", "1"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"(*", 
                    RowBox[{
                    "Use", " ", "the", " ", "powers", " ", "for", " ", "the", 
                    " ", 
                    RowBox[{"w", "'"}], "s"}], "*)"}], "\[IndentingNewLine]", 
                   RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"inw", "=", "1"}], ",", 
                    RowBox[{"inw", "<", 
                    RowBox[{"IF", "+", "1"}]}], ",", 
                    RowBox[{"inw", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SuperscriptBox[
                    SubscriptBox["w", "inw"], 
                    RowBox[{"powers", "[", 
                    RowBox[{"[", "pow", "]"}], "]"}]]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"ad", "=", "1"}], ",", 
                    RowBox[{"ad", "<", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"powers", "[", 
                    RowBox[{"[", "pow", "]"}], "]"}], "]"}], "+", "1"}]}], 
                    ",", 
                    RowBox[{"ad", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "inw"}], " ", 
                    RowBox[{"Sign", "[", 
                    RowBox[{"powers", "[", 
                    RowBox[{"[", "pow", "]"}], "]"}], "]"}]}], "}"}]}], 
                    "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"pow", "=", 
                    RowBox[{"pow", "+", "1"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"(*", 
                    RowBox[{
                    "Use", " ", "the", " ", "powers", " ", "for", " ", "the", 
                    " ", 
                    RowBox[{"z", "'"}], "s"}], "*)"}], "\[IndentingNewLine]", 
                   RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"inw", "=", "1"}], ",", 
                    RowBox[{"inw", "<", 
                    RowBox[{"NZI", "+", "1"}]}], ",", 
                    RowBox[{"inw", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SuperscriptBox[
                    SubscriptBox["z", "inw"], 
                    RowBox[{"powers", "[", 
                    RowBox[{"[", "pow", "]"}], "]"}]]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"ad", "=", "1"}], ",", 
                    RowBox[{"ad", "<", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"powers", "[", 
                    RowBox[{"[", "pow", "]"}], "]"}], "]"}], "+", "1"}]}], 
                    ",", 
                    RowBox[{"ad", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "inw"}], " ", 
                    RowBox[{"Sign", "[", 
                    RowBox[{"powers", "[", 
                    RowBox[{"[", "pow", "]"}], "]"}], "]"}]}], "}"}]}], 
                    "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"pow", "=", 
                    RowBox[{"pow", "+", "1"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["consider", "k"], "==", "1"}], " ", "||", 
                    RowBox[{
                    SubscriptBox["consider", "k"], "\[Equal]", 
                    RowBox[{"-", "1"}]}]}], " ", ",", " ", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{
                    "If", " ", "the", " ", "term", " ", "is", " ", "1"}], ",",
                     " ", 
                    RowBox[{"we", " ", "are", " ", "done"}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<Guessed it! Attempted \>\"", ",", "bore", ",", 
                    "\"\< times.\>\""}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"darn", "=", "0"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"guess", "=", 
                    RowBox[{"guess", "+", "1"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"score", "=", "1"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"Break", "[", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"score", "\[Equal]", "0"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"retry", "=", 
                    RowBox[{"retry", "+", "1"}]}], ";", "\[IndentingNewLine]", 
                   RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"Print", "[", "\"\<Sent it away!\>\"", "]"}], 
                    ";"}], "*)"}], "\[IndentingNewLine]", 
                   RowBox[{"Goto", "[", "beginext", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"count", "\[Equal]", "300"}], "&&", 
                RowBox[{"retry", "\[GreaterEqual]", 
                 RowBox[{"(", 
                  RowBox[{"6", "patience"}], ")"}]}]}], ",", 
               RowBox[{"(*", 
                RowBox[{
                "If", " ", "it", " ", "really", " ", "fails", " ", "just", 
                 " ", "give", " ", "up"}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                "Print", "[", 
                 "\"\<Failed methodically, failed to guess it.\>\"", "]"}], 
                ";", "\[IndentingNewLine]", 
                RowBox[{"darn", "=", "1"}], ";", "\[IndentingNewLine]", 
                RowBox[{"Break", "[", "]"}], ";"}]}], "\[IndentingNewLine]", 
              "]"}], ";"}]}], " ", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", "]"}], ";", " ", 
          RowBox[{"(*", 
           RowBox[{"Close", " ", "while", " ", "loop"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "Now", " ", "we", " ", "have", " ", "the", " ", "internal", " ", 
            "faces", " ", "and", " ", 
            RowBox[{
             SubscriptBox["z", "i"], "'"}], 
            RowBox[{"s", " ", "!"}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"darn", "\[Equal]", "1"}], "&&", 
             RowBox[{"patience", "\[GreaterEqual]", "4"}]}], ",", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"If", " ", "the", " ", "guess", " ", "fails"}], ",", 
              " ", 
              RowBox[{"do", " ", "it", " ", "methodically"}]}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
             "Print", "[", 
              "\"\<Since patience\[GreaterEqual]4 , try exhausting all \
possibilities (within reason).\>\"", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"powarray", "=", 
              RowBox[{"Tuples", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "0", ",", "1"}], "}"}], ",", 
                RowBox[{"NZ", "+", "NF", "-", "1"}]}], "]"}]}], ";", " ", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{
               "contains", " ", "all", " ", "the", " ", "possibilities"}], 
               ",", " ", 
               RowBox[{
                RowBox[{"with", " ", "powers", " ", "between"}], " ", "-", 
                RowBox[{"1", " ", "and", " ", "1."}]}]}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"om", "=", "1"}], ",", 
               RowBox[{"om", "<", 
                RowBox[{
                 SuperscriptBox["3", 
                  RowBox[{"NZ", "+", "NF", "-", "1"}]], "+", "1"}]}], ",", 
               RowBox[{"om", "++"}], ",", " ", 
               RowBox[{"(*", 
                RowBox[{
                "Try", " ", "all", " ", "the", " ", "different", " ", 
                 "scenarios"}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 SubscriptBox["consider", "k"], "=", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"MonomialList", "[", "perf", "]"}], "[", 
                   RowBox[{"[", "k", "]"}], "]"}], "/", "ref"}]}], ";", 
                RowBox[{"(*", 
                 RowBox[{
                 "Each", " ", "time", " ", "start", " ", "from", " ", "the", 
                  " ", "beginning"}], "*)"}], "\[IndentingNewLine]", 
                RowBox[{
                 SubscriptBox["expression", "k"], "=", 
                 RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{
                 SubscriptBox["zexpression", "k"], "=", 
                 RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"pow", "=", "1"}], ";", "\[IndentingNewLine]", 
                RowBox[{"show", "=", "1"}], ";", "\[IndentingNewLine]", 
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"wfa", "=", "1"}], ",", 
                  RowBox[{"wfa", "<", "NF"}], ",", 
                  RowBox[{"wfa", "++"}], ",", 
                  RowBox[{"(*", 
                   RowBox[{
                   "Use", " ", "the", " ", "powers", " ", "for", " ", "the", 
                    " ", 
                    RowBox[{"w", "'"}], "s"}], "*)"}], "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], 
                    SuperscriptBox[
                    SubscriptBox["w", "wfa"], 
                    RowBox[{"powarray", "[", 
                    RowBox[{"[", 
                    RowBox[{"om", ",", "pow"}], "]"}], "]"}]]}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"show", "=", 
                    RowBox[{"show", " ", 
                    SuperscriptBox[
                    SubscriptBox["ww", "wfa"], 
                    RowBox[{"-", 
                    RowBox[{"powarray", "[", 
                    RowBox[{"[", 
                    RowBox[{"om", ",", "pow"}], "]"}], "]"}]}]]}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"ad", "=", "1"}], ",", 
                    RowBox[{"ad", "<", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"powarray", "[", 
                    RowBox[{"[", 
                    RowBox[{"om", ",", "pow"}], "]"}], "]"}], "]"}], "+", 
                    "1"}]}], ",", 
                    RowBox[{"ad", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["expression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "wfa"}], " ", 
                    RowBox[{"Sign", "[", 
                    RowBox[{"powarray", "[", 
                    RowBox[{"[", 
                    RowBox[{"om", ",", "pow"}], "]"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
                   ";", "\[IndentingNewLine]", 
                   RowBox[{"pow", "=", 
                    RowBox[{"pow", "+", "1"}]}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"inw", "=", "1"}], ",", 
                  RowBox[{"inw", "<", 
                   RowBox[{"NZ", "+", "1"}]}], ",", 
                  RowBox[{"inw", "++"}], ",", 
                  RowBox[{"(*", 
                   RowBox[{
                   "Use", " ", "the", " ", "powers", " ", "for", " ", "the", 
                    " ", 
                    RowBox[{"z", "'"}], "s"}], "*)"}], "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["consider", "k"], "=", 
                    RowBox[{
                    SubscriptBox["consider", "k"], " ", 
                    SuperscriptBox[
                    SubscriptBox["z", "inw"], 
                    RowBox[{"powarray", "[", 
                    RowBox[{"[", 
                    RowBox[{"om", ",", "pow"}], "]"}], "]"}]]}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"show", "=", 
                    RowBox[{"show", " ", 
                    SuperscriptBox[
                    SubscriptBox["zz", "inw"], 
                    RowBox[{"-", 
                    RowBox[{"powarray", "[", 
                    RowBox[{"[", 
                    RowBox[{"om", ",", "pow"}], "]"}], "]"}]}]]}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"ad", "=", "1"}], ",", 
                    RowBox[{"ad", "<", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"powarray", "[", 
                    RowBox[{"[", 
                    RowBox[{"om", ",", "pow"}], "]"}], "]"}], "]"}], "+", 
                    "1"}]}], ",", 
                    RowBox[{"ad", "++"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "inw"}], " ", 
                    RowBox[{"Sign", "[", 
                    RowBox[{"powarray", "[", 
                    RowBox[{"[", 
                    RowBox[{"om", ",", "pow"}], "]"}], "]"}], "]"}]}], 
                    "}"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
                   ";", "\[IndentingNewLine]", 
                   RowBox[{"pow", "=", 
                    RowBox[{"pow", "+", "1"}]}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    SubscriptBox["consider", "k"], "==", "1"}], " ", "||", 
                   RowBox[{
                    SubscriptBox["consider", "k"], "\[Equal]", 
                    RowBox[{"-", "1"}]}]}], " ", ",", " ", 
                  RowBox[{"(*", 
                   RowBox[{
                    RowBox[{
                    "If", " ", "the", " ", "term", " ", "is", " ", "1"}], ",",
                     " ", 
                    RowBox[{"we", " ", "are", " ", "done"}]}], "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<Found it on the \>\"", ",", "om", ",", 
                    "\"\<th try.\>\""}], "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"guess", "=", 
                    RowBox[{"guess", "+", "1"}]}], ";", "\[IndentingNewLine]", 
                   RowBox[{"darn", "=", "0"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"Break", "[", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
          RowBox[{"(*", 
           RowBox[{"Close", " ", "if"}], "*)"}], "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"darn", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
             "Now", " ", "turn", " ", "this", " ", "into", " ", "toric", " ", 
              "diagram", " ", "coordinates"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"mastercoords", "=", 
              RowBox[{"Table", "[", 
               RowBox[{"0", ",", 
                RowBox[{"{", 
                 RowBox[{"x", ",", 
                  RowBox[{"NZ", "+", "NF", "-", "1"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"y", ",", "1"}], "}"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"ei", "=", "1"}], ",", 
               RowBox[{"ei", "<", 
                RowBox[{"NZ", "+", "1"}]}], ",", 
               RowBox[{"ei", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"ai", "=", "1"}], ",", 
                  RowBox[{"ai", "<", 
                   RowBox[{
                    RowBox[{"Length", "[", 
                    SubscriptBox["zexpression", "k"], "]"}], "+", "1"}]}], 
                  ",", 
                  RowBox[{"ai", "++"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "[", 
                    RowBox[{"[", "ai", "]"}], "]"}], "\[Equal]", "ei"}], "||", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "[", 
                    RowBox[{"[", "ai", "]"}], "]"}], "\[Equal]", 
                    RowBox[{"-", "ei"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"mastercoords", "[", 
                    RowBox[{"[", 
                    RowBox[{"ei", ",", "1"}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"mastercoords", "[", 
                    RowBox[{"[", 
                    RowBox[{"ei", ",", "1"}], "]"}], "]"}], "+", 
                    RowBox[{"Sign", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "[", 
                    RowBox[{"[", "ai", "]"}], "]"}], "]"}]}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"ei", "=", "1"}], ",", 
               RowBox[{"ei", "<", "NF"}], ",", 
               RowBox[{"ei", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"ai", "=", "1"}], ",", 
                  RowBox[{"ai", "<", 
                   RowBox[{
                    RowBox[{"Length", "[", 
                    SubscriptBox["expression", "k"], "]"}], "+", "1"}]}], ",", 
                  RowBox[{"ai", "++"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["expression", "k"], "[", 
                    RowBox[{"[", "ai", "]"}], "]"}], "\[Equal]", "ei"}], "||", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["expression", "k"], "[", 
                    RowBox[{"[", "ai", "]"}], "]"}], "\[Equal]", 
                    RowBox[{"-", "ei"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"mastercoords", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"NZ", "+", "ei"}], ",", "1"}], "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"mastercoords", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"NZ", "+", "ei"}], ",", "1"}], "]"}], "]"}], "+", 
                    RowBox[{"Sign", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "[", 
                    RowBox[{"[", "ai", "]"}], "]"}], "]"}]}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"masterspace", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"masterspace", ",", "mastercoords", ",", "2"}], 
               "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"Make", " ", "the", " ", "expression", " ", "nice"}], 
              "*)"}], "\[IndentingNewLine]", 
             RowBox[{"nice", "=", "1"}], ";", "\[IndentingNewLine]", 
             RowBox[{"compare", "=", "1"}], ";", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"ei", "=", "1"}], ",", 
               RowBox[{"ei", "<", "NF"}], ",", 
               RowBox[{"ei", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"ai", "=", "1"}], ",", 
                  RowBox[{"ai", "<", 
                   RowBox[{
                    RowBox[{"Length", "[", 
                    SubscriptBox["expression", "k"], "]"}], "+", "1"}]}], ",", 
                  RowBox[{"ai", "++"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["expression", "k"], "[", 
                    RowBox[{"[", "ai", "]"}], "]"}], "\[Equal]", "ei"}], "||", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["expression", "k"], "[", 
                    RowBox[{"[", "ai", "]"}], "]"}], "\[Equal]", 
                    RowBox[{"-", "ei"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"nice", "=", 
                    RowBox[{"nice", " ", 
                    SuperscriptBox[
                    SubscriptBox["ww", "ei"], 
                    RowBox[{"Sign", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "[", 
                    RowBox[{"[", "ai", "]"}], "]"}], "]"}]]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"compare", "=", 
                    RowBox[{"compare", " ", 
                    SuperscriptBox[
                    SubscriptBox["w", "ei"], 
                    RowBox[{"Sign", "[", 
                    RowBox[{
                    SubscriptBox["expression", "k"], "[", 
                    RowBox[{"[", "ai", "]"}], "]"}], "]"}]]}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"ei", "=", "1"}], ",", 
               RowBox[{"ei", "<", 
                RowBox[{"NZ", "+", "1"}]}], ",", 
               RowBox[{"ei", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"ai", "=", "1"}], ",", 
                  RowBox[{"ai", "<", 
                   RowBox[{
                    RowBox[{"Length", "[", 
                    SubscriptBox["zexpression", "k"], "]"}], "+", "1"}]}], 
                  ",", 
                  RowBox[{"ai", "++"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "[", 
                    RowBox[{"[", "ai", "]"}], "]"}], "\[Equal]", "ei"}], "||", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "[", 
                    RowBox[{"[", "ai", "]"}], "]"}], "\[Equal]", 
                    RowBox[{"-", "ei"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"nice", "=", 
                    RowBox[{"nice", " ", 
                    SuperscriptBox[
                    SubscriptBox["zz", "ei"], 
                    RowBox[{"Sign", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "[", 
                    RowBox[{"[", "ai", "]"}], "]"}], "]"}]]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"compare", "=", 
                    RowBox[{"compare", " ", 
                    SuperscriptBox[
                    SubscriptBox["z", "ei"], 
                    RowBox[{"Sign", "[", 
                    RowBox[{
                    SubscriptBox["zexpression", "k"], "[", 
                    RowBox[{"[", "ai", "]"}], "]"}], "]"}]]}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"compare", "===", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"MonomialList", "[", "perf", "]"}], "[", 
                   RowBox[{"[", "k", "]"}], "]"}], "/", "ref"}]}], "||", 
                RowBox[{"compare", "===", 
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{
                    RowBox[{"MonomialList", "[", "perf", "]"}], "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "/", "ref"}]}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{"nice", ",", "\"\< = \>\"", ",", "compare"}], "]"}], 
                ";", "\[IndentingNewLine]", 
                RowBox[{
                 SubscriptBox["pm", "k"], "=", "nice"}], ";"}], " ", 
               RowBox[{"(*", 
                RowBox[{"Saves", " ", "the", " ", "expression"}], "*)"}], 
               "\[IndentingNewLine]", ",", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{
                 "\"\<Somehow this didn't work! Bug in the code. Do it by \
hand: \>\"", ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"MonomialList", "[", "perf", "]"}], "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "/", "ref"}]}], "]"}], 
                ";", "\[IndentingNewLine]", 
                RowBox[{"fail", "=", 
                 RowBox[{"fail", "+", "1"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"masterspace", "=", 
                 RowBox[{"Drop", "[", 
                  RowBox[{"masterspace", ",", "None", ",", 
                   RowBox[{"-", "1"}]}], "]"}]}], ";"}]}], 
              RowBox[{"(*", 
               RowBox[{
               "Remove", " ", "the", " ", "column", " ", "we", " ", "just", 
                " ", "added"}], "*)"}], "\[IndentingNewLine]", "]"}], ";"}], 
            "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{"\"\<All attempts failed. Do it by hand: \>\"", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"MonomialList", "[", "perf", "]"}], "[", 
                 RowBox[{"[", "k", "]"}], "]"}], "/", "ref"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"fail", "=", 
              RowBox[{"fail", "+", "1"}]}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";"}]}], 
        RowBox[{"(*", 
         RowBox[{"Close", " ", "if"}], "*)"}], "\[IndentingNewLine]", "]"}], 
       ";", 
       RowBox[{"(*", 
        RowBox[{"Close", " ", "for", " ", "k"}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", "\"\<---------------------------------------------\>\"", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<Failed \>\"", ",", "fail", ",", "\"\< times. Guessed \>\"", ",", 
         "guess", ",", "\"\< times.\>\""}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Computation time: \>\"", ",", 
         RowBox[{
          RowBox[{"TimeUsed", "[", "]"}], "-", "time"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"time", "=", 
        RowBox[{"TimeUsed", "[", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Gmaster", "=", "masterspace"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Gmaster = \>\"", ",", 
         RowBox[{"masterspace", "//", "MatrixForm"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"mastermult", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Dimensions", "[", 
            RowBox[{
             RowBox[{"Gather", "[", 
              RowBox[{"Transpose", "[", "masterspace", "]"}], "]"}], "[", 
             RowBox[{"[", "y", "]"}], "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", 
            RowBox[{
             RowBox[{"Dimensions", "[", 
              RowBox[{"Gather", "[", 
               RowBox[{"Transpose", "[", "masterspace", "]"}], "]"}], "]"}], 
             "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"DeleteDuplicates", "[", 
            RowBox[{"mastermult", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ">", "1"}], ",", 
         RowBox[{
          RowBox[{
          "Print", "[", 
           "\"\<ERROR!!! THERE ARE SEVERAL PERFECT MATCHINGS WITH THE SAME \
EXPRESSION!\>\"", "]"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
       "Print", "[", 
        "\"\<The order of the coordinates for Gmaster is: \!\(\*SubscriptBox[\
\(z\), \(i\)]\)'s, then faces (starting from face 1 to face NF-1).\>\"", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"gauging", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Gmoduli", "=", 
          RowBox[{"Delete", "[", 
           RowBox[{"Gmaster", ",", 
            RowBox[{"Transpose", "[", 
             RowBox[{"{", 
              RowBox[{"Table", "[", 
               RowBox[{"i", ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", 
                  RowBox[{"NZ", "+", "1"}], ",", 
                  RowBox[{"NZ", "+", "IF"}]}], "}"}]}], "]"}], "}"}], "]"}]}],
            "]"}]}], "\[IndentingNewLine]", ",", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"gauging", "\[Equal]", "2"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"deletelist", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"intz", ",", 
                RowBox[{"Table", "[", 
                 RowBox[{"i", ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{"NZ", "+", "1"}], ",", 
                    RowBox[{"NZ", "+", "IF"}]}], "}"}]}], "]"}]}], "]"}]}], 
             ";", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{
                RowBox[{
                "Here", " ", "we", " ", "also", " ", "dauge", " ", "the", " ",
                  "internal", " ", "zig"}], "-", "zags"}], ",", " ", 
               RowBox[{
               "as", " ", "well", " ", "as", " ", "delete", " ", "all", " ", 
                "internal", " ", "faces"}]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"Print", "[", 
                RowBox[{"\"\<deletelist=\>\"", ",", "deletelist"}], "]"}], 
               ";"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"boundaries", "=", 
              RowBox[{"Delete", "[", 
               RowBox[{"boundaries", ",", "1"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"bo", "=", "1"}], ",", 
               RowBox[{"bo", "<", 
                RowBox[{
                 RowBox[{"Length", "[", "boundaries", "]"}], "+", "1"}]}], 
               ",", 
               RowBox[{"bo", "++"}], ",", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{
                 "Each", " ", "time", " ", "we", " ", "have", " ", "external",
                   " ", "guys", " ", "going", " ", "around", " ", "a", " ", 
                  "boundary", " ", 
                  RowBox[{"(", 
                   RowBox[{
                   "hence", " ", "are", " ", "completely", " ", "internal"}], 
                   ")"}]}], ",", " ", 
                 RowBox[{
                 "we", " ", "have", " ", "to", " ", "subtract", " ", "the", 
                  " ", "value", " ", "of", " ", "one", " ", "row", " ", 
                  "from", " ", "all", " ", "the", " ", "others"}], ",", " ", 
                 RowBox[{
                 "and", " ", "then", " ", "gauge", " ", "this", " ", 
                  "row"}]}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"numb", "=", "1"}], ",", 
                  RowBox[{"numb", "<", 
                   RowBox[{"Length", "[", 
                    RowBox[{"boundaries", "[", 
                    RowBox[{"[", "bo", "]"}], "]"}], "]"}]}], ",", 
                  RowBox[{"numb", "++"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"masterspace", "[", 
                    RowBox[{"[", 
                    RowBox[{"boundaries", "[", 
                    RowBox[{"[", 
                    RowBox[{"bo", ",", "numb"}], "]"}], "]"}], "]"}], "]"}], 
                    "=", 
                    RowBox[{
                    RowBox[{"masterspace", "[", 
                    RowBox[{"[", 
                    RowBox[{"boundaries", "[", 
                    RowBox[{"[", 
                    RowBox[{"bo", ",", "numb"}], "]"}], "]"}], "]"}], "]"}], 
                    "-", 
                    RowBox[{"masterspace", "[", 
                    RowBox[{"[", 
                    RowBox[{"boundaries", "[", 
                    RowBox[{"[", 
                    RowBox[{"bo", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"boundaries", "[", 
                    RowBox[{"[", "bo", "]"}], "]"}], "]"}]}], "]"}], "]"}], 
                    "]"}], "]"}]}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
                ";", "\[IndentingNewLine]", 
                RowBox[{"deletelist", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{"deletelist", ",", 
                   RowBox[{"{", 
                    RowBox[{"NZ", "+", 
                    RowBox[{"boundaries", "[", 
                    RowBox[{"[", 
                    RowBox[{"bo", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"boundaries", "[", 
                    RowBox[{"[", "bo", "]"}], "]"}], "]"}]}], "]"}], "]"}]}], 
                    "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"Print", "[", 
                 RowBox[{"\"\<deletelist=\>\"", ",", "deletelist"}], "]"}], 
                ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Gmoduli", "=", 
              RowBox[{"Delete", "[", 
               RowBox[{"masterspace", ",", 
                RowBox[{"Transpose", "[", 
                 RowBox[{"{", "deletelist", "}"}], "]"}]}], "]"}]}], ";"}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{
             RowBox[{
             "Print", "[", 
              "\"\<Invalid value for 'gauging'. Need to specify either \
'gauging'=1 or 'gauging'=2.\>\"", "]"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]\
}]}]}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Now", " ", "group", " ", "the", " ", "multiplicities", " ", "of", 
         " ", "G", " ", 
         RowBox[{"together", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Gshort", "=", 
        RowBox[{"Transpose", "[", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Transpose", "[", "Gmoduli", "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Multmatrix", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Dimensions", "[", 
            RowBox[{
             RowBox[{"Gather", "[", 
              RowBox[{"Transpose", "[", "Gmoduli", "]"}], "]"}], "[", 
             RowBox[{"[", "y", "]"}], "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", 
            RowBox[{
             RowBox[{"Dimensions", "[", 
              RowBox[{"Gather", "[", 
               RowBox[{"Transpose", "[", "Gmoduli", "]"}], "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Gshort = \>\"", ",", 
         RowBox[{"Gshort", "//", "MatrixForm"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Multipl = \>\"", ",", 
         RowBox[{"Multmatrix", "//", "MatrixForm"}]}], "]"}], ";"}]}], " ", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.576148817912237*^9, 3.576148928127171*^9}, {
   3.5761489689338007`*^9, 3.576149056150631*^9}, {3.5761492056310883`*^9, 
   3.576149274306745*^9}, {3.576149312465382*^9, 3.576149386752533*^9}, {
   3.576149491359613*^9, 3.57614949465446*^9}, {3.576149723190949*^9, 
   3.5761499230628767`*^9}, {3.576149977995221*^9, 3.576150164376753*^9}, {
   3.5761502098411922`*^9, 3.576150230668911*^9}, {3.5761502663387747`*^9, 
   3.576150318274827*^9}, {3.576150357542122*^9, 3.576150377096726*^9}, {
   3.5761504792596483`*^9, 3.5761506110021687`*^9}, {3.576150781148217*^9, 
   3.5761508537488527`*^9}, {3.576150927902979*^9, 3.57615095784647*^9}, {
   3.576151019012793*^9, 3.5761510254763803`*^9}, {3.5761510998536043`*^9, 
   3.576151315617023*^9}, {3.5761513965588703`*^9, 3.576151511071175*^9}, {
   3.5761515622068157`*^9, 3.57615157040322*^9}, {3.576151738724861*^9, 
   3.5761519506830807`*^9}, {3.5761519973722*^9, 3.576152038638912*^9}, {
   3.576152086187725*^9, 3.576152387554825*^9}, {3.576152460932548*^9, 
   3.576152466723721*^9}, {3.576152819389801*^9, 3.576152863530302*^9}, {
   3.576152899182455*^9, 3.576152934339652*^9}, {3.5761529864215593`*^9, 
   3.576153028855031*^9}, {3.576153107663233*^9, 3.576153122449911*^9}, {
   3.576153186977137*^9, 3.576153235746182*^9}, {3.576153322263803*^9, 
   3.5761533903371162`*^9}, {3.576153552252083*^9, 3.576153650326581*^9}, {
   3.576153782422483*^9, 3.576153973026595*^9}, {3.576154104509305*^9, 
   3.57615423728615*^9}, {3.5761547492353563`*^9, 3.576154749602059*^9}, {
   3.576154780179575*^9, 3.576154843122892*^9}, {3.5761549401111403`*^9, 
   3.576154988794104*^9}, {3.5761550298214703`*^9, 3.57615511679346*^9}, {
   3.5761553125133953`*^9, 3.576155329449048*^9}, {3.576155677776223*^9, 
   3.57615570035149*^9}, {3.5761557544205513`*^9, 3.57615580109277*^9}, {
   3.576155841504397*^9, 3.57615584351921*^9}, {3.5761559302250347`*^9, 
   3.576155930836429*^9}, 3.576156046147732*^9, {3.576156078253046*^9, 
   3.576156257075591*^9}, {3.576156481224762*^9, 3.576156496728744*^9}, {
   3.576156533245408*^9, 3.576156540113902*^9}, {3.576156723067902*^9, 
   3.576156746349201*^9}, {3.5761570742722263`*^9, 3.576157074970343*^9}, {
   3.5761571154587812`*^9, 3.576157133207965*^9}, {3.576157183315496*^9, 
   3.576157190293767*^9}, {3.57615736615119*^9, 3.576157395970818*^9}, {
   3.576158238330205*^9, 3.576158250499261*^9}, {3.576158283006201*^9, 
   3.5761583185151463`*^9}, {3.576158372480467*^9, 3.5761583746699266`*^9}, {
   3.576158435297688*^9, 3.576158563068829*^9}, {3.576158637401432*^9, 
   3.5761586660870943`*^9}, {3.576158708921126*^9, 3.576158906534074*^9}, {
   3.576158985725052*^9, 3.576159008650741*^9}, {3.576159067842807*^9, 
   3.5761592417473497`*^9}, {3.576159289206572*^9, 3.5761594186680727`*^9}, {
   3.5761596283971443`*^9, 3.576159650763504*^9}, {3.576159728368107*^9, 
   3.576159736948764*^9}, 3.576159891409306*^9, {3.576160248109364*^9, 
   3.576160253555657*^9}, {3.576160322563739*^9, 3.576160629640267*^9}, {
   3.576160678384303*^9, 3.576160709739375*^9}, {3.576160778857377*^9, 
   3.5761608154750843`*^9}, {3.576160900640486*^9, 3.576160909270117*^9}, {
   3.576160957749383*^9, 3.5761610207898617`*^9}, {3.576161347858952*^9, 
   3.576161436836183*^9}, {3.576161474928699*^9, 3.576161499347949*^9}, {
   3.5761616599899607`*^9, 3.576161661723804*^9}, {3.576161695145748*^9, 
   3.576161729201323*^9}, {3.576161775276593*^9, 3.576161787108982*^9}, {
   3.576161830273356*^9, 3.576161874556169*^9}, {3.576161940060336*^9, 
   3.576162113241889*^9}, {3.5762130920845633`*^9, 3.576213264998011*^9}, {
   3.576213315237341*^9, 3.576213326456188*^9}, {3.576213739622857*^9, 
   3.576213774958535*^9}, {3.57621451930411*^9, 3.576214693140319*^9}, {
   3.576214880402701*^9, 3.5762149263815403`*^9}, {3.576215270457015*^9, 
   3.5762152787058563`*^9}, {3.5762153412229433`*^9, 
   3.5762154758390512`*^9}, {3.576215507016677*^9, 3.576215518239626*^9}, {
   3.576215884260626*^9, 3.57621588549268*^9}, {3.576215927476409*^9, 
   3.576215941311426*^9}, {3.576215990105167*^9, 3.576216026156105*^9}, {
   3.576216064836007*^9, 3.576216065572057*^9}, {3.576217343783297*^9, 
   3.5762173444531*^9}, {3.5762173846284513`*^9, 3.576217385551711*^9}, {
   3.5762174222228928`*^9, 3.576217430317565*^9}, {3.576217832250169*^9, 
   3.576217837178451*^9}, {3.57621794282905*^9, 3.576217973236252*^9}, {
   3.576218059943801*^9, 3.5762180796658297`*^9}, {3.576218129360798*^9, 
   3.5762181407909822`*^9}, {3.576218238735223*^9, 3.57621823959406*^9}, {
   3.576218345371663*^9, 3.576218396823381*^9}, {3.576218450354456*^9, 
   3.576218458681058*^9}, {3.5762184931780167`*^9, 3.576218511618184*^9}, {
   3.576218650819393*^9, 3.576218668954953*^9}, {3.576218746538669*^9, 
   3.5762187970303097`*^9}, {3.576218951885481*^9, 3.576219002099832*^9}, {
   3.576219094461447*^9, 3.576219109658538*^9}, {3.5762191681944942`*^9, 
   3.5762191694169283`*^9}, {3.576219310139923*^9, 3.576219329169121*^9}, {
   3.576219367940628*^9, 3.576219415079692*^9}, {3.57621957183788*^9, 
   3.5762196218929358`*^9}, {3.5762196561788883`*^9, 3.576219663874861*^9}, {
   3.57622004812449*^9, 3.57622006234896*^9}, {3.576220116278512*^9, 
   3.5762202215698442`*^9}, {3.5762204816330233`*^9, 
   3.5762206250606117`*^9}, {3.576220662712875*^9, 3.576220663298085*^9}, {
   3.57622070557204*^9, 3.5762207835089083`*^9}, {3.576222275914914*^9, 
   3.576222318320671*^9}, {3.5762225668968697`*^9, 3.576222621162245*^9}, {
   3.5762226619101458`*^9, 3.576222662618107*^9}, {3.576222706464882*^9, 
   3.576222709084803*^9}, {3.576223104740198*^9, 3.5762231524902*^9}, {
   3.57622318645471*^9, 3.5762233100827847`*^9}, 3.57622334192253*^9, 
   3.5762234396522217`*^9, {3.576223473303012*^9, 3.576223477030285*^9}, {
   3.5762235384548388`*^9, 3.576223762190958*^9}, {3.5762238000976458`*^9, 
   3.576223813337001*^9}, {3.57622387617663*^9, 3.576223914001708*^9}, 
   3.5762239468861*^9, {3.5762240226616297`*^9, 3.576224177345602*^9}, {
   3.576224289448222*^9, 3.576224304651845*^9}, {3.576224419628501*^9, 
   3.576224468256078*^9}, {3.576224534599208*^9, 3.576224666883749*^9}, {
   3.576224805137806*^9, 3.5762248485039043`*^9}, {3.57622489628125*^9, 
   3.576224924313299*^9}, {3.576225277477585*^9, 3.576225301346291*^9}, {
   3.5762253418954887`*^9, 3.576225427579772*^9}, {3.5762317892931337`*^9, 
   3.576231790750937*^9}, {3.5762347778229847`*^9, 3.5762347918481503`*^9}, {
   3.576237237668058*^9, 3.5762372379744463`*^9}, {3.57623757001749*^9, 
   3.57623759725576*^9}, {3.576241960357307*^9, 3.5762419691405582`*^9}, {
   3.5762420073014593`*^9, 3.57624206121124*^9}, {3.5762422606565638`*^9, 
   3.576242306139943*^9}, {3.576242603671438*^9, 3.576242624566773*^9}, {
   3.576243746727086*^9, 3.576243751658803*^9}, {3.576243789635613*^9, 
   3.576243856417708*^9}, {3.576243886511959*^9, 3.576243973027932*^9}, {
   3.576244030042775*^9, 3.576244042303115*^9}, {3.5762441099807043`*^9, 
   3.5762441158048697`*^9}, {3.576303134179438*^9, 3.5763031652114*^9}, {
   3.576306985933362*^9, 3.576307087347661*^9}, {3.576307129380207*^9, 
   3.576307131646267*^9}, 3.576307194322825*^9, {3.5763074782027617`*^9, 
   3.57630755749109*^9}, {3.57630777874529*^9, 3.576307788047255*^9}, {
   3.576307855328994*^9, 3.576307922487919*^9}, {3.576308166645566*^9, 
   3.5763082136985273`*^9}, {3.576308255487319*^9, 3.576308280433248*^9}, {
   3.576315948705303*^9, 3.576316018295106*^9}, {3.576321798611573*^9, 
   3.576321848975234*^9}, {3.576321885051893*^9, 3.5763218858461943`*^9}, {
   3.576321953819397*^9, 3.576322049280579*^9}, {3.5763220914106913`*^9, 
   3.576322188775498*^9}, {3.5763223107799873`*^9, 3.576322397723781*^9}, {
   3.5763230685411882`*^9, 3.576323125880866*^9}, {3.576323917013579*^9, 
   3.57632395693712*^9}, {3.576324069582636*^9, 3.576324072321229*^9}, {
   3.576324489087204*^9, 3.576324504816905*^9}, {3.576325086157404*^9, 
   3.5763252000775023`*^9}, {3.576325232449173*^9, 3.576325237474349*^9}, {
   3.57632654401924*^9, 3.5763266127831087`*^9}, {3.576326810903273*^9, 
   3.576326839613799*^9}, {3.5763268783459187`*^9, 3.576327015702446*^9}, {
   3.576327207225713*^9, 3.5763273171696863`*^9}, {3.576328224119501*^9, 
   3.5763283083866577`*^9}, {3.576328342482373*^9, 3.576328365082905*^9}, {
   3.576328404400139*^9, 3.576328421796439*^9}, {3.576328472109136*^9, 
   3.576328472591237*^9}, {3.576328690205551*^9, 3.5763287245216722`*^9}, 
   3.576328940673818*^9, {3.576328978539794*^9, 3.576329006481028*^9}, {
   3.576843606027224*^9, 3.576843732040822*^9}, {3.5768437911828327`*^9, 
   3.576843818835994*^9}, {3.576843858923519*^9, 3.5768439465760107`*^9}, {
   3.5768439793713093`*^9, 3.5768439839894333`*^9}, {3.576846751762249*^9, 
   3.576846789633905*^9}, {3.576846836233926*^9, 3.576846855828642*^9}, {
   3.576847354836813*^9, 3.57684735590871*^9}, {3.577615393056913*^9, 
   3.57761551732902*^9}, {3.579342501719387*^9, 3.579342574952606*^9}, {
   3.579430856806521*^9, 3.579430924655119*^9}, {3.5794348961123667`*^9, 
   3.5794349349297132`*^9}, {3.5794349681689*^9, 3.579435298437531*^9}, {
   3.5794353491425943`*^9, 3.579435389039843*^9}, 3.579435546228895*^9, {
   3.5794356407750397`*^9, 3.57943564193216*^9}, {3.5794365885887737`*^9, 
   3.579436669189198*^9}, {3.5794372716166058`*^9, 3.579437277415022*^9}, {
   3.579607212601417*^9, 3.579607224518353*^9}, {3.5796073729528913`*^9, 
   3.5796074742978077`*^9}, {3.57967723439417*^9, 3.579677246553935*^9}, {
   3.579678832924945*^9, 3.5796788630068617`*^9}, {3.579685685406399*^9, 
   3.579685930230878*^9}, {3.5796891250330143`*^9, 3.579689127902423*^9}, {
   3.579690335401519*^9, 3.5796903808716288`*^9}, {3.579694233680674*^9, 
   3.579694352811335*^9}, {3.579694407182583*^9, 3.579694439498666*^9}, {
   3.5796945387428293`*^9, 3.579694599241303*^9}, {3.579694653822867*^9, 
   3.579694749139868*^9}, {3.5799555231161337`*^9, 3.579955553319438*^9}, {
   3.579955639743621*^9, 3.5799556659212914`*^9}, {3.5799584998838263`*^9, 
   3.5799586635957193`*^9}, {3.57995878588316*^9, 3.5799588931155157`*^9}, {
   3.580025237936866*^9, 3.5800252463420486`*^9}, {3.5817594826515617`*^9, 
   3.5817594923051977`*^9}, {3.5820299306252127`*^9, 3.582029948157402*^9}, {
   3.582030041865552*^9, 3.582030166465983*^9}, {3.582030269924653*^9, 
   3.5820302832691183`*^9}, 3.5820303265370626`*^9, {3.582030649795182*^9, 
   3.5820306796249027`*^9}, {3.5823512648998218`*^9, 3.582351299120349*^9}, {
   3.5823513537178106`*^9, 3.5823513597024975`*^9}, {3.582351423174545*^9, 
   3.5823514750366073`*^9}, {3.582973670258151*^9, 3.582973753778205*^9}, {
   3.5829768786502476`*^9, 3.582976895197998*^9}, {3.5829769282622538`*^9, 
   3.582976929981089*^9}, {3.58297718318867*^9, 3.582977211596422*^9}, {
   3.5855625840936613`*^9, 3.585562617671673*^9}, {3.5855632189114113`*^9, 
   3.58556322219191*^9}, {3.585563485291739*^9, 3.585563560661895*^9}, {
   3.585564752745022*^9, 3.5855647564780493`*^9}, {3.5855651289920073`*^9, 
   3.585565187075713*^9}, {3.585565252388776*^9, 3.585565278968121*^9}, {
   3.5855653275826187`*^9, 3.585565382603629*^9}, {3.5856394130686617`*^9, 
   3.585639434780405*^9}, {3.585639483326973*^9, 3.585639483629096*^9}, {
   3.585998392322534*^9, 3.585998398990336*^9}, {3.585998431222661*^9, 
   3.585998432590322*^9}, {3.585998632135688*^9, 3.585998655329258*^9}, {
   3.5866074448685913`*^9, 3.586607447018503*^9}, {3.5866074832775793`*^9, 
   3.5866074983497133`*^9}, {3.58686369618256*^9, 3.58686370909735*^9}, {
   3.586863841645384*^9, 3.586863842627022*^9}, {3.586864321000414*^9, 
   3.586864324895154*^9}, 3.586864366985751*^9, {3.586866755485326*^9, 
   3.5868668326806726`*^9}, {3.586869604190463*^9, 3.586869650198533*^9}, 
   3.586870433161932*^9, {3.587288656869013*^9, 3.587288659770417*^9}, {
   3.587293047912929*^9, 3.5872930496851187`*^9}, {3.587297226221148*^9, 
   3.587297264147582*^9}, {3.587301528775989*^9, 3.58730159462719*^9}, {
   3.587302767336502*^9, 3.58730283675079*^9}, {3.58730291731569*^9, 
   3.587302927909011*^9}, {3.587302999945421*^9, 3.587303199136139*^9}, {
   3.587304074510716*^9, 3.58730407496367*^9}, {3.5873046767098503`*^9, 
   3.587304687083124*^9}, {3.587359191878787*^9, 3.587359200442801*^9}, {
   3.587359874448225*^9, 3.587359934878413*^9}, {3.587359991205307*^9, 
   3.587360001821693*^9}, 3.587362504390326*^9, {3.587362544510345*^9, 
   3.587362545088139*^9}, {3.5873641863803177`*^9, 3.5873642065333*^9}, {
   3.587364285738385*^9, 3.587364305648054*^9}, {3.5873644161632233`*^9, 
   3.5873644530265713`*^9}, {3.587364543543462*^9, 3.5873646200314293`*^9}, {
   3.587364762939116*^9, 3.587364766194523*^9}, {3.587371269648548*^9, 
   3.587371280182069*^9}, {3.587371590413313*^9, 3.58737159650354*^9}, {
   3.587380233102644*^9, 3.587380348185586*^9}, {3.5873804147469254`*^9, 
   3.5873804598906384`*^9}, {3.587380570721362*^9, 3.587380624739603*^9}, {
   3.58738067062362*^9, 3.587380671314478*^9}, {3.587380722940173*^9, 
   3.587380747938287*^9}, {3.587380784273748*^9, 3.587380788271497*^9}, {
   3.5873839583509197`*^9, 3.587383986025703*^9}, {3.5873840516580067`*^9, 
   3.587384078907852*^9}, {3.587387282952498*^9, 3.58738728384243*^9}, {
   3.5873874850659103`*^9, 3.587387486332459*^9}, {3.587395448354924*^9, 
   3.587395451630028*^9}, {3.5873965849923487`*^9, 3.5873965862635117`*^9}, {
   3.587456187847877*^9, 3.587456191319253*^9}, {3.587542841997992*^9, 
   3.587542921400832*^9}, {3.5875430458073587`*^9, 3.587543059638785*^9}, {
   3.587819763896347*^9, 3.587819831668365*^9}, {3.587820909914227*^9, 
   3.5878209110812674`*^9}, {3.588487170587174*^9, 3.588487257187992*^9}, {
   3.590140318650488*^9, 3.590140365572927*^9}, {3.590140398712254*^9, 
   3.5901404009343452`*^9}, {3.5901404477877197`*^9, 
   3.5901405441101713`*^9}, {3.590140613382791*^9, 3.5901406194401093`*^9}, {
   3.590140655894506*^9, 3.5901406566250257`*^9}, {3.590140695224309*^9, 
   3.590140711446439*^9}, {3.591604666175776*^9, 3.591604699106963*^9}, {
   3.5986113588283157`*^9, 3.598611417271028*^9}, {3.598611491759286*^9, 
   3.598611502274373*^9}, {3.59861153749197*^9, 3.598611620850712*^9}, {
   3.5986117294906683`*^9, 3.598611743080658*^9}, {3.60585898088905*^9, 
   3.605858983043676*^9}, {3.620393024411577*^9, 3.620393033110076*^9}, {
   3.620393122534042*^9, 3.6203931521918507`*^9}, {3.6203932381511393`*^9, 
   3.620393284410076*^9}, {3.620393457241973*^9, 3.620393458825295*^9}, 
   3.6203934975661573`*^9, {3.620393719979827*^9, 3.620393813847763*^9}, 
   3.6203938667338*^9, {3.620393915093884*^9, 3.620393925979841*^9}, {
   3.620393973998962*^9, 3.620394008328063*^9}, {3.62039419115679*^9, 
   3.6203941919469213`*^9}, 3.620394486832745*^9, 3.620394630337385*^9, {
   3.620394790039661*^9, 3.6203948195114193`*^9}, 3.620395160103352*^9, 
   3.620395530280422*^9, {3.62039559813708*^9, 3.620395598814912*^9}, 
   3.620395639772415*^9, {3.6203957040907793`*^9, 3.6203957045281057`*^9}, {
   3.62039574397104*^9, 3.620395773839658*^9}, {3.620396005149191*^9, 
   3.6203960972862988`*^9}, {3.6203962349589033`*^9, 3.620396257293078*^9}, {
   3.620981465708709*^9, 3.620981556019998*^9}, {3.620981657138266*^9, 
   3.620981663497663*^9}, 3.620991241287923*^9, {3.620994812327745*^9, 
   3.620994900945229*^9}, {3.6209949381741543`*^9, 3.620994950028591*^9}, {
   3.62099538290107*^9, 3.6209954091060133`*^9}, {3.620995439181106*^9, 
   3.620995462683921*^9}, {3.620995494750704*^9, 3.620995496866028*^9}, 
   3.6209955716547956`*^9, {3.620996011272813*^9, 3.620996121557342*^9}, {
   3.620996155475589*^9, 3.620996211669683*^9}, {3.647327741096159*^9, 
   3.6473279004942007`*^9}, 3.6616868958526716`*^9, 3.6616913515181503`*^9, {
   3.6616913971847754`*^9, 3.6616914572889447`*^9}, 3.6617517258379326`*^9, {
   3.661751761045849*^9, 3.6617517629723654`*^9}, {3.6617522676333666`*^9, 
   3.6617522908079767`*^9}, {3.6617531086276145`*^9, 
   3.6617531135398755`*^9}, {3.661753153477132*^9, 3.6617531627600293`*^9}, {
   3.6617591224922295`*^9, 3.66175913476531*^9}, {3.661766060571831*^9, 
   3.6617660749719133`*^9}, {3.661775588198186*^9, 3.661775624496746*^9}, {
   3.661775772728195*^9, 3.6617758522627964`*^9}, {3.661854582867503*^9, 
   3.661854603581808*^9}, {3.6621161309735107`*^9, 3.6621162083981752`*^9}, 
   3.6621170377989798`*^9, {3.6621171151769876`*^9, 3.6621171396140523`*^9}, {
   3.6621171753239584`*^9, 3.662117209899497*^9}, {3.6621241004004955`*^9, 
   3.662124117260113*^9}, {3.6621253957044916`*^9, 3.6621254266957207`*^9}, {
   3.6621881481600285`*^9, 3.66218817452687*^9}, {3.662201740242825*^9, 
   3.6622017597209077`*^9}, {3.662203784992427*^9, 3.6622037899330816`*^9}, {
   3.662287726843808*^9, 3.662287785972896*^9}, {3.66244364371959*^9, 
   3.6624436726703053`*^9}, {3.6624437086683054`*^9, 3.662443763291527*^9}, {
   3.6624440679968176`*^9, 3.6624440955020547`*^9}, {3.6627344413853006`*^9, 
   3.6627344506490607`*^9}, {3.662819441897256*^9, 3.6628194522809496`*^9}, {
   3.6628945315192575`*^9, 3.662894574587954*^9}, {3.6629001963256254`*^9, 
   3.6629002126733947`*^9}, {3.6639206332743454`*^9, 3.6639206438645053`*^9}, 
   3.6639207806741037`*^9, {3.6645204323055563`*^9, 3.6645204745161104`*^9}}]
}, Closed]]
},
Evaluator->"Local2",
WindowSize->{1362, 685},
WindowMargins->{{Automatic, -4}, {Automatic, 0}},
FrontEndVersion->"10.2 for Microsoft Windows (64-bit) (July 7, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 332, 7, 52, "Input"],
Cell[CellGroupData[{
Cell[915, 31, 835, 25, 31, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1753, 58, 33485, 758, 2132, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[35241, 818, 19374, 430, 1352, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]],
Cell[CellGroupData[{
Cell[54652, 1253, 826, 24, 25, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.}],
Cell[55481, 1279, 277166, 7890, 15108, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.}]
}, Closed]],
Cell[332662, 9172, 96, 1, 25, "Input"],
Cell[CellGroupData[{
Cell[332783, 9177, 3295, 83, 375, "Input"],
Cell[CellGroupData[{
Cell[336103, 9264, 186, 5, 23, "Print"],
Cell[336292, 9271, 188, 5, 23, "Print"],
Cell[336483, 9278, 188, 5, 23, "Print"],
Cell[336674, 9285, 186, 5, 23, "Print"]
}, Open  ]],
Cell[336875, 9293, 465, 10, 21, "Message"],
Cell[337343, 9305, 467, 10, 21, "Message"],
Cell[337813, 9317, 467, 10, 21, "Message"],
Cell[338283, 9329, 528, 11, 21, "Message"],
Cell[338814, 9342, 507, 10, 21, "Message"],
Cell[339324, 9354, 498, 10, 21, "Message"],
Cell[339825, 9366, 505, 10, 21, "Message"],
Cell[340333, 9378, 496, 10, 21, "Message"],
Cell[340832, 9390, 505, 10, 21, "Message"],
Cell[341340, 9402, 528, 11, 21, "Message"],
Cell[341871, 9415, 496, 10, 21, "Message"],
Cell[342370, 9427, 530, 11, 21, "Message"],
Cell[342903, 9440, 1788, 29, 39, "Message"],
Cell[CellGroupData[{
Cell[344716, 9473, 460, 10, 23, "Print"],
Cell[345179, 9485, 186, 5, 23, "Print"]
}, Open  ]],
Cell[345380, 9493, 516, 10, 21, "Message"],
Cell[345899, 9505, 641, 12, 21, "Message"],
Cell[346543, 9519, 514, 10, 21, "Message"],
Cell[347060, 9531, 514, 10, 21, "Message"],
Cell[347577, 9543, 536, 11, 21, "Message"],
Cell[348116, 9556, 644, 12, 21, "Message"],
Cell[348763, 9570, 644, 12, 21, "Message"],
Cell[349410, 9584, 539, 11, 21, "Message"],
Cell[349952, 9597, 186, 5, 23, "Print"],
Cell[350141, 9604, 444, 9, 21, "Message"],
Cell[350588, 9615, 444, 9, 21, "Message"],
Cell[351035, 9626, 442, 9, 21, "Message"],
Cell[351480, 9637, 531, 11, 21, "Message"],
Cell[352014, 9650, 9163, 144, 73, "Message"],
Cell[CellGroupData[{
Cell[361202, 9798, 460, 10, 23, "Print"],
Cell[361665, 9810, 188, 5, 23, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[361902, 9821, 3318, 92, 152, "Input"],
Cell[365223, 9915, 834, 20, 49, "Output"],
Cell[366060, 9937, 1892, 58, 31, "Output"],
Cell[367955, 9997, 1924, 59, 31, "Output"],
Cell[369882, 10058, 1546, 46, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[371465, 10109, 8875, 204, 592, "Input"],
Cell[CellGroupData[{
Cell[380365, 10317, 732, 12, 23, "Print"],
Cell[381100, 10331, 811, 13, 23, "Print"],
Cell[381914, 10346, 587, 8, 23, "Print"],
Cell[382504, 10356, 625, 8, 23, "Print"],
Cell[383132, 10366, 730, 12, 23, "Print"],
Cell[383865, 10380, 809, 13, 23, "Print"],
Cell[384677, 10395, 588, 8, 23, "Print"],
Cell[385268, 10405, 627, 8, 23, "Print"],
Cell[385898, 10415, 732, 12, 23, "Print"],
Cell[386633, 10429, 811, 13, 23, "Print"],
Cell[387447, 10444, 588, 8, 23, "Print"],
Cell[388038, 10454, 625, 8, 23, "Print"],
Cell[388666, 10464, 730, 12, 23, "Print"],
Cell[389399, 10478, 809, 13, 23, "Print"],
Cell[390211, 10493, 588, 8, 23, "Print"],
Cell[390802, 10503, 625, 8, 23, "Print"],
Cell[391430, 10513, 732, 12, 23, "Print"],
Cell[392165, 10527, 811, 13, 23, "Print"],
Cell[392979, 10542, 590, 8, 23, "Print"],
Cell[393572, 10552, 627, 8, 23, "Print"],
Cell[394202, 10562, 730, 12, 23, "Print"],
Cell[394935, 10576, 811, 13, 23, "Print"],
Cell[395749, 10591, 590, 8, 23, "Print"],
Cell[396342, 10601, 627, 8, 23, "Print"],
Cell[396972, 10611, 732, 12, 23, "Print"],
Cell[397707, 10625, 811, 13, 23, "Print"]
}, Open  ]],
Cell[398533, 10641, 562, 12, 21, "Message"],
Cell[399098, 10655, 500, 10, 21, "Message"],
Cell[399601, 10667, 502, 10, 21, "Message"],
Cell[400106, 10679, 2247, 36, 90, "Message"],
Cell[402356, 10717, 1078, 18, 24, "Message"],
Cell[403437, 10737, 941, 16, 23, "Print"],
Cell[404381, 10755, 563, 12, 21, "Message"],
Cell[404947, 10769, 502, 10, 21, "Message"],
Cell[405452, 10781, 530, 11, 21, "Message"],
Cell[405985, 10794, 2247, 36, 107, "Message"],
Cell[408235, 10832, 1079, 18, 24, "Message"],
Cell[409317, 10852, 941, 16, 23, "Print"],
Cell[410261, 10870, 565, 12, 21, "Message"],
Cell[410829, 10884, 539, 11, 21, "Message"],
Cell[411371, 10897, 2247, 36, 107, "Message"],
Cell[413621, 10935, 536, 11, 21, "Message"],
Cell[414160, 10948, 1079, 18, 24, "Message"],
Cell[415242, 10968, 532, 11, 21, "Message"],
Cell[CellGroupData[{
Cell[415799, 10983, 941, 16, 23, "Print"],
Cell[416743, 11001, 590, 8, 23, "Print"],
Cell[417336, 11011, 625, 8, 23, "Print"],
Cell[417964, 11021, 732, 12, 23, "Print"],
Cell[418699, 11035, 811, 13, 23, "Print"],
Cell[419513, 11050, 941, 16, 23, "Print"],
Cell[420457, 11068, 943, 16, 23, "Print"],
Cell[421403, 11086, 941, 16, 23, "Print"],
Cell[422347, 11104, 941, 16, 23, "Print"],
Cell[423291, 11122, 590, 8, 23, "Print"],
Cell[423884, 11132, 625, 8, 23, "Print"],
Cell[424512, 11142, 730, 12, 23, "Print"],
Cell[425245, 11156, 813, 13, 23, "Print"],
Cell[426061, 11171, 588, 8, 23, "Print"],
Cell[426652, 11181, 627, 8, 23, "Print"]
}, Open  ]]
}, Open  ]],
Cell[427306, 11193, 6421, 150, 452, "Input"],
Cell[CellGroupData[{
Cell[433752, 11347, 3342, 88, 232, "Input"],
Cell[437097, 11437, 571, 13, 31, "Output"],
Cell[437671, 11452, 569, 13, 31, "Output"],
Cell[438243, 11467, 91583, 2794, 1796, "Output"]
}, Open  ]],
Cell[529841, 14264, 94, 1, 31, "Input"],
Cell[529938, 14267, 69511, 1716, 3508, "Input"],
Cell[CellGroupData[{
Cell[599474, 15987, 475, 6, 30, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[599952, 15995, 789947, 18897, 49681, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]]
}
]
*)

(* End of internal cache information *)
