(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[   1561949,      36753]
NotebookOptionsPosition[   1525718,      35937]
NotebookOutlinePosition[   1526081,      35953]
CellTagsIndexPosition[   1526038,      35950]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "bipartiteSUSY.m"}]}], "Input",
 CellChangeTimes->{{3.6616922986967053`*^9, 3.661692334211833*^9}, 
   3.6645297915320587`*^9, {3.664542240753628*^9, 3.6645422474264593`*^9}, 
   3.680582773489525*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"These", " ", "functions", " ", "are", " ", 
   RowBox[{"NEW", ":", "           ", 
    RowBox[{
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", "--"}]}]}], ">", "     ", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", "--"}]}]}], ">", "     ", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", "--"}]}]}], ">", "     ", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", "--"}]}]}], ">", "     ", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", "--"}]}]}], ">", "     ", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", "--"}]}]}], ">"}]}]}], "  ", "*)"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.662277791653617*^9, 3.6622778116713*^9}, 
   3.6622901088542557`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"These", " ", "are", " ", "ALL", " ", "the", " ", 
   RowBox[{"Kasteleyns", ":", "           ", 
    RowBox[{
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", "--"}]}]}], ">", "     ", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", "--"}]}]}], ">", "     ", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", "--"}]}]}], ">", "     ", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", "--"}]}]}], ">", "     ", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", "--"}]}]}], ">", "     ", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", "--"}]}]}], ">"}]}]}], "  ", "*)"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 CellChangeTimes->{{3.6647096906820107`*^9, 3.6647097227226796`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "There", " ", "are", " ", "currently", " ", "110", " ", "different", " ", 
     "examples", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"highest", " ", "is", " ", 
        SubscriptBox["bft", "110"]}], ")"}], ".", " ", "If"}], " ", "you", 
     " ", "introduce", " ", "any", " ", "more"}], ",", " ", 
    RowBox[{"call", " ", "the", " ", "next", " ", "one", " ", "111"}], ",", 
    " ", 
    RowBox[{"and", " ", "update", " ", "this", " ", 
     RowBox[{"number", "!"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Rules", ":", " ", 
     RowBox[{"'", 
      RowBox[{"a", "'"}], " ", "is", " ", "the", " ", "upper", " ", "left", 
      " ", "matrix"}]}], ",", " ", 
    RowBox[{"'", 
     RowBox[{"b", "'"}], " ", "is", " ", "the", " ", "upper", " ", "right"}], 
    ",", " ", 
    RowBox[{"'", 
     RowBox[{"c", "'"}], " ", "is", " ", "the", " ", "lower", " ", "left"}], 
    ",", " ", 
    RowBox[{"'", 
     RowBox[{"d", "'"}], " ", "is", " ", "the", " ", "lower", " ", 
     RowBox[{"right", ".", " ", "You"}], " ", "have", " ", "to", " ", "label",
      " ", "the", " ", "internal", " ", "faces", " ", "first"}], ",", " ", 
    RowBox[{"Then", " ", "external", " ", 
     RowBox[{"ones", ".", " ", "You"}], " ", "have", " ", "to", " ", "label", 
     " ", "First", " ", "the", " ", "internal", " ", "white", " ", "nodes"}], 
    ",", " ", 
    RowBox[{"then", " ", "external", " ", "white", " ", "nodes"}], ",", " ", 
    RowBox[{"then", " ", "internal", " ", "black", " ", "nodes"}], ",", " ", 
    RowBox[{"then", " ", "external", " ", "black", " ", 
     RowBox[{"nodes", "."}]}]}], "  ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"-", "GENUS"}]}]}]}]}]}]}]}]}]}]}], " ", "ZERO"}], ",",
     " ", 
    RowBox[{"ONE", " ", "BOUNDARY", " ", "CASES"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"I", ".", "E", ".", " ", "THE"}], " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"DISK", "--"}], "--"}], "--"}], "--"}], "--"}], "--"}]}], 
     "-", 
     RowBox[{"-", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", "-"}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Normal", " ", "square", " ", 
    RowBox[{"box", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    SubscriptBox["bft", "1"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"5", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "5"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "5"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Square", " ", "box", " ", "with", " ", "crossed", " ", "legs"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "2"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "1"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "1"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "4"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Double", " ", "square", " ", "box"}], ",", " ", 
     RowBox[{
      RowBox[{"i", ".", "e", ".", " ", "the"}], " ", "unreduced", " ", "Gr", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"2", ",", "4"}], ")"}], "."}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "3"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "1"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "5"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "2"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "5"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"5", ",", "6"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "6"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Double", " ", "square", " ", "box", " ", "with", " ", 
     SubscriptBox["X", 
      RowBox[{"6", ",", "2"}]], " ", 
     RowBox[{"Higgsed", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "4"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"5", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "5"}]], ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "5"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"5", ",", "2"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Double", " ", "square", " ", "box"}], ",", " ", 
     RowBox[{
     "with", " ", "face", " ", "2", " ", "being", " ", "a", " ", 
      "confinement", " ", 
      RowBox[{"bubble", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "5"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"6", ",", "2"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"2", ",", "1"}]]}], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "5"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "1"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"5", ",", "6"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "4"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "6"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "4"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Normal", " ", "planar", " ", "Gr", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"3", ",", "5"}], ")"}], "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "6"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"5", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "6"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "2"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "5"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"6", ",", "7"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "7"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"6", ",", "5"}]], ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Normal", " ", "planar", " ", "Gr", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2", ",", "5"}], ")"}], "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "73"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"7", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "6"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "7"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "5"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"6", ",", "7"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "5"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"2", " ", "gluon"}], ",", " ", 
     RowBox[{
      RowBox[{"2", " ", "loop", " ", "on", " ", "a", " ", 
       RowBox[{"disk", ".", " ", "CONTAINS"}], " ", "SELF"}], "-", 
      RowBox[{"INTERSECTING", " ", 
       RowBox[{"ZIGZAGS", "!"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "7"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["X", 
           RowBox[{"3", ",", "1"}]], "+", 
          SubscriptBox["X", 
           RowBox[{"1", ",", "2"}]], "+", 
          SubscriptBox["X", 
           RowBox[{"2", ",", "4"}]]}], "}"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         SubscriptBox["X", 
          RowBox[{"4", ",", "3"}]], "}"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         SubscriptBox["Y", 
          RowBox[{"4", ",", "3"}]], "}"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{"{", "0", "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"3", " ", "gluon"}], ",", " ", 
     RowBox[{
      RowBox[{"3", " ", "loop", " ", "on", " ", "a", " ", 
       RowBox[{"disk", ".", " ", "CONTAINS"}], " ", "SELF"}], "-", 
      RowBox[{"INTERSECTING", " ", 
       RowBox[{"ZIGZAGS", "!"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "8"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "5"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"5", ",", "3"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "5"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["X", 
           RowBox[{"4", ",", "3"}]], ",", "0"}], "}"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Top", " ", "cell", " ", "of", " ", "Gr", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2", ",", "6"}], ")"}], "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "9"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"9", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "8"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "7"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "6"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "3"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"8", ",", "9"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "8"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "7"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "5"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"4", ",", "9"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "5"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Top", " ", "cell", " ", "of", " ", "Gr", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"3", ",", "6"}], ")"}], "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "10"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"5", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "10"}]], ",", "0", ",", "0", ",", "0", ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "6"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "1"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "6"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "3"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "1"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "8"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"10", ",", "1"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "10"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "8"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "4"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"10", ",", "5"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "7"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "9"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"6", ",", "5"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "7"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"10", ",", "9"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"7", "-", 
     RowBox[{"dimensional", " ", "Gr", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"3", ",", "6"}], ")"}], "."}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "11"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "8"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "5"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "2"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "6"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "1"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"8", ",", "3"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "6"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "7"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "4"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "7"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Top", " ", "cell", " ", "of", " ", "Gr", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2", ",", "7"}], ")"}], "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "12"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"11", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "10"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"10", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "9"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "8"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "7"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "5"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "4"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"10", ",", "11"}]], ",", "0", ",", "0", ",", "0", ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "10"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "9"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "8"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "6"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"5", ",", "11"}]], ",", "0", ",", "0", ",", "0", ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "6"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], 
        "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Top", " ", "cell", " ", "of", " ", "Gr", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"3", ",", "7"}], ")"}], "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "13"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "7"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "3"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"13", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "13"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "5"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "4"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "6"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "5"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"12", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "11"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"11", ",", "5"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "10"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "9"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"10", ",", "6"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "8"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"11", ",", "12"}]], ",", "0", ",", "0", ",", "0"}], "}"}],
          ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"10", ",", "11"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "10"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"7", ",", "13"}]], ",", "0", ",", "0", ",", "0", ",", "0",
            ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "8"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"13", ",", "12"}]], ",", "0", ",", "0"}], "}"}]}], 
        "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Permutation", " ", 
     RowBox[{"{", 
      RowBox[{"4", ",", "5", ",", "6", ",", "7", ",", "8", ",", "9"}], "}"}], 
     " ", 
     RowBox[{"(", "bipartite", ")"}], " ", "under", " ", "scheme", " ", 
     "0."}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "14"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"6", ",", "2"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "5"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "7"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "8"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"10", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "9"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"5", ",", "6"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "9"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "10"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"7", ",", "6"}]], ",", "0", ",", "0", ",", "0", ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "7"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "10"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Permutation", " ", 
     RowBox[{"{", 
      RowBox[{"4", ",", "5", ",", "6", ",", "7", ",", "8", ",", "9"}], "}"}], 
     " ", 
     RowBox[{"(", "bipartite", ")"}], " ", "under", " ", "scheme", " ", 
     "1."}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "15"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"6", ",", "2"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "5"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "7"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "8"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "1"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "4"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"10", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "10"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"5", ",", "6"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "9"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"10", ",", "9"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"7", ",", "6"}]], ",", "0", ",", "0", ",", "0", ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "7"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "10"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"-", "GENUS"}]}]}]}]}]}]}]}]}]}]}], " ", "ZERO"}], 
     ",", " ", 
     RowBox[{"MULTI", " ", "BOUNDARY", " ", "CASES"}], ",", " ", 
     RowBox[{
      RowBox[{"I", ".", "E", ".", " ", "NON"}], "-", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"PLANAR", "--"}], "--"}], "--"}], "--"}], "--"}], 
          "--"}], "--"}], "--"}], 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", "-"}]}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"G", 
       RowBox[{"(", 
        RowBox[{"3", ",", "6"}], ")"}], " ", "top"}], "-", 
      RowBox[{"dim", " ", "guy", " ", "with", " ", "B"}]}], "=", 
     RowBox[{"2", " ", "and", " ", "two", " ", "strange", " ", "poles"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "75"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"8", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "7"}]], ",", "0", ",", "0", ",", "0", ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "9"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "6"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "7"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "5"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"7", ",", "8"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "6"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"9", ",", "8"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "9"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "6"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "4"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"G", 
       RowBox[{"(", 
        RowBox[{"3", ",", "6"}], ")"}], " ", "top"}], "-", 
      RowBox[{"dim", " ", "guy", " ", "with", " ", "B"}]}], "=", 
     RowBox[{"2", " ", "and", " ", "one", " ", "strange", " ", "poles"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "76"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"9", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "5"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "9"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "6"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "2"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "2"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "4"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "5"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "7"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "2"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "3"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "8"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "5"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"5", ",", "4"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "9"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"6", ",", "9"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "6"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "7"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Standard", " ", "example", " ", "on", " ", "a", " ", "cylinder", " ", 
     "which", " ", "reduces", " ", "to", " ", "sums", " ", "of", " ", 
     "square", " ", 
     RowBox[{"boxes", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "16"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"5", ",", "1"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "2"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "4"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "5"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["X", 
           RowBox[{"3", ",", "5"}]], ",", "0", ",", "0"}], "}"}], "}"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Standard", " ", "example", " ", "on", " ", "a", " ", "cylinder"}], ",", 
     " ", 
     RowBox[{"after", " ", "a", " ", "flip", " ", 
      RowBox[{"manoever", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "17"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"5", ",", "1"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "2"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "4"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "5"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["X", 
           RowBox[{"3", ",", "5"}]], ",", "0", ",", "0"}], "}"}], "}"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Standard", " ", "example", " ", "on", " ", "a", " ", "cylinder"}], ",", 
     " ", 
     RowBox[{"with", " ", "massive", " ", "node", " ", "integrated", " ", 
      RowBox[{"out", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "18"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "5"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "1"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"5", ",", "3"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "5"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["X", 
           RowBox[{"4", ",", "3"}]], ",", "0"}], "}"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Standard", " ", "example", " ", "on", " ", "a", " ", "cylinder"}], ",", 
     " ", 
     RowBox[{
      RowBox[{
      "with", " ", "massive", " ", "node", " ", "integrated", " ", "out", " ",
        "and", " ", "a", " ", "flip", " ", "manoever"}], ".."}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "19"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "5"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "1"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"5", ",", "3"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "5"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["X", 
           RowBox[{"4", ",", "3"}]], ",", "0"}], "}"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Similar", " ", "to", " ", "standard", " ", "example"}], ",", 
     " ", 
     RowBox[{"this", " ", "is", " ", "a", " ", "6", " ", "gluon"}], ",", " ", 
     RowBox[{"1", " ", "loop", " ", "on", " ", "a", " ", 
      RowBox[{"cylinder", ".", " ", "It"}], " ", "is", " ", 
      RowBox[{"reduced", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "20"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "2"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "3"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"6", ",", "2"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "6"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "5"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "2"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "5"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"4", ",", "6"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "5"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Simpler", " ", "than", " ", "standard", " ", 
      RowBox[{"example", ":", " ", 
       RowBox[{"3", " ", "gluon"}]}]}], ",", " ", 
     RowBox[{"1", " ", "loop", " ", "on", " ", "a", " ", 
      RowBox[{"cylinder", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "21"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "2"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"5", ",", "2"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "4"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "4"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"4", ",", "5"}]], ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["X", 
           RowBox[{"3", ",", "5"}]], ",", "0", ",", "0"}], "}"}], "}"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Simplest", " ", "nonplanar", " ", "cylinder", " ", "guy", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"intrinsically", " ", "nonplanar"}], ")"}], "."}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "22"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"6", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "6"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "6"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "3"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "5"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", 
          SubscriptBox["X", 
           RowBox[{"5", ",", "4"}]], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "2"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "4"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "6"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "0", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Slightly", " ", "more", " ", "complicated", " ", "intrinsically", " ", 
     "nonplanar", " ", "guy", " ", "on", " ", "the", " ", 
     RowBox[{"cylinder", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "23"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "2"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "3"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"6", ",", "2"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "6"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "5"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "2"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "5"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"4", ",", "6"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "5"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Y2", ",", 
     RowBox[{
     "0", " ", "with", " ", "a", " ", "periodic", " ", "direction", " ", 
      "cut", " ", "out", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"i", ".", "e", ".", " ", "on"}], " ", "cylinder"}], ")"}], 
       "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "24"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"5", ",", "2"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"1", ",", "4"}]]}], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Y", 
            RowBox[{"2", ",", "1"}]], ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"3", ",", "2"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"1", ",", "6"}]]}]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "5"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"6", ",", "3"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["Y", 
            RowBox[{"6", ",", "3"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Y", 
            RowBox[{"4", ",", "5"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Y4", ",", 
     RowBox[{
     "0", " ", "with", " ", "a", " ", "periodic", " ", "direction", " ", 
      "cut", " ", "out", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"i", ".", "e", ".", " ", "on"}], " ", "cylinder"}], ")"}], 
       "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "25"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"7", ",", "1"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"4", ",", "8"}]]}], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Y", 
            RowBox[{"1", ",", "4"}]], ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"2", ",", "1"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"4", ",", "5"}]]}], ",", 
           SubscriptBox["Y", 
            RowBox[{"5", ",", "2"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "2"}]], ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"2", ",", "3"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"6", ",", "5"}]]}], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "6"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"3", ",", "6"}]], ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"9", ",", "3"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"6", ",", "10"}]]}]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"8", ",", "7"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"10", ",", "9"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Y", 
            RowBox[{"8", ",", "7"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"10", ",", "9"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"This", " ", "is", " ", "Y6"}], ",", 
     RowBox[{
     "0", " ", "with", " ", "one", " ", "periodic", " ", "direction", " ", 
      "cut", " ", "out", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"ie", " ", "on", " ", "cylinder"}], ")"}], "."}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "26"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"11", ",", "1"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"6", ",", "12"}]]}], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "6"}]], ",", "0", ",", "0", ",", "0", ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Y", 
            RowBox[{"1", ",", "6"}]], ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"2", ",", "1"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"6", ",", "7"}]]}], ",", 
           SubscriptBox["Y", 
            RowBox[{"7", ",", "2"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "2"}]], ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"2", ",", "3"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"8", ",", "7"}]]}], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "8"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"3", ",", "8"}]], ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"4", ",", "3"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"8", ",", "9"}]]}], ",", 
           SubscriptBox["Y", 
            RowBox[{"9", ",", "4"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "4"}]], ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"4", ",", "5"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"10", ",", "9"}]]}], ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "10"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"5", ",", "10"}]], ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"13", ",", "5"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"10", ",", "14"}]]}]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"12", ",", "11"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"14", ",", "13"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Y", 
            RowBox[{"12", ",", "11"}]], ",", "0", ",", "0", ",", "0", ",", 
           "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"14", ",", "13"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Reduction", " ", "of", " ", "square", " ", "torus", " ", "chopping", 
      " ", "THREE", " ", "lines"}], ",", " ", 
     RowBox[{
     "is", " ", "a", " ", "6", " ", "gluon", " ", "3", " ", "loops", " ", 
      "on", " ", "a", " ", 
      RowBox[{"cylinder", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "27"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "4"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "5"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "7"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"7", ",", "1"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "8"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"5", ",", "6"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "9"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "7"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "4"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "6"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "9"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Reduction", " ", "of", " ", "square", " ", "torus", " ", "chopping", 
      " ", "THREE", " ", "lines"}], ",", " ", 
     RowBox[{
      RowBox[{"and", " ", "Seiberg"}], "-", 
      RowBox[{"dualizing", " ", "face", " ", "2"}]}], ",", " ", 
     RowBox[{
     "is", " ", "a", " ", "6", " ", "gluon", " ", "3", " ", "loops", " ", 
      "on", " ", "a", " ", 
      RowBox[{"cylinder", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "28"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "4"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "5"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "1"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "7"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "3"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"7", ",", "1"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "8"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "3"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "6"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "9"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"5", ",", "6"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "9"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "7"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "4"}]], ",", "0", ",", "0", ",", "0", ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "6"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "9"}]], ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Rather", " ", "complicated", " ", "6", " ", "gluon"}], ",", " ", 
     RowBox[{"3", " ", "loop", " ", "on", " ", "a", " ", 
      RowBox[{"cylinder", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "29"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"4", ",", "1"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "6"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "2"}]], ",", "0", ",", "0", ",", "0", ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "5"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "3"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "7"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "8"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "9"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "3"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"6", ",", "4"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "5"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "6"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "7"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "8"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "9"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Another", " ", "6", " ", "gluon"}], ",", " ", 
     RowBox[{"3", " ", "loop", " ", "on", " ", "a", " ", 
      RowBox[{"cylinder", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "30"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "6"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "2"}]], ",", "0", ",", "0", ",", "0", ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "5"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "1"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "7"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "8"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "9"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "1"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"6", ",", "4"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "5"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "6"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "7"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "8"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "9"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Y", 
            RowBox[{"3", ",", "2"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", "0"}], "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Reduction", " ", "of", " ", "the", " ", "square", " ", "torus", " ", 
     "with", " ", "a", " ", "single", " ", "boundary", " ", "chopping", " ", 
     "THREE", " ", 
     RowBox[{"lines", ".", " ", "It"}], " ", "lives", " ", "on", " ", "a", 
     " ", 
     RowBox[{"cylinder", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "31"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"6", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "5"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "1"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "8"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "7"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "1"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"4", ",", "6"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "4"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "9"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"5", ",", "6"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "9"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "7"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Has", " ", "3", " ", "boundaries"}], ",", " ", 
     RowBox[{"but", " ", "is", " ", 
      RowBox[{"reducible", ".", " ", 
       RowBox[{"It", "'"}]}], "s", " ", "a", " ", "top", " ", "cell", " ", 
      "of", " ", "Gr", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"3", ",", "5"}], ")"}], ".", " ", 
       RowBox[{"It", "'"}]}], "s", " ", 
      RowBox[{"a", " ", "'"}], 
      RowBox[{"reduction", "'"}], " ", "of", " ", "the", " ", "monster", " ", 
      "guy", " ", 
      RowBox[{"below", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "69"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"7", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "6"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "7"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "4"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "5"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "8"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "5"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "7"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "2"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "7"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "3"}]], ",", "0", ",", "0", ",", "0", ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "6"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["Y", 
            RowBox[{"5", ",", "4"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "8"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", 
          SubscriptBox["X", 
           RowBox[{"5", ",", "4"}]], ",", "0", ",", "0"}], "}"}], "}"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
        "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Guy", " ", "with", " ", "intrinsically", " ", "3", " ", 
     RowBox[{"boundaries", ".", " ", 
      RowBox[{"It", "'"}]}], "s", " ", "a", " ", "top", " ", "cell", " ", 
     "of", " ", "Gr", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"3", ",", "5"}], ")"}], ".", " ", 
      RowBox[{"It", "'"}]}], "s", " ", 
     RowBox[{"a", " ", "'"}], 
     RowBox[{"reduction", "'"}], " ", "of", " ", "the", " ", "monster", " ", 
     "guy", " ", 
     RowBox[{"below", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "32"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"10", ",", "1"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "10"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "8"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "2"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "5"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "9"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "3"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "7"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "10"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"10", ",", "6"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "6"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "4"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", 
          SubscriptBox["X", 
           RowBox[{"4", ",", "5"}]], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "5"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "7"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "6"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"8", ",", "10"}]], ",", "0", ",", "0", ",", "0", ",", "0",
            ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "8"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"10", ",", "9"}]], ",", "0", ",", "0", ",", "0", ",", 
           "0"}], "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "0", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Monster", " ", "guy", " ", "with", " ", "intrinsically", " ", "3", " ", 
     RowBox[{"boundaries", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "33"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "7"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"11", ",", "2"}]], ",", "0", ",", "0", ",", "0", ",", "0",
            ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "11"}]], ",", "0", ",", "0", ",", "0", ",", "0",
            ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "1"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "11"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"11", ",", "4"}]], ",", "0", ",", "0", ",", "0", ",", "0",
            ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "5"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "1"}]], ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "11"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"11", ",", "6"}]], ",", "0", ",", "0", ",", "0", ",", "0",
            ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "2"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "8"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "3"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "4"}]], ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "9"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "5"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "6"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "10"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"10", ",", "7"}]], ",", "0", ",", "0", ",", "0", ",", "0",
            ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "11"}]], ",", "0", ",", "0", ",", "0", ",", "0",
            ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"12", ",", "8"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"11", ",", "12"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"11", ",", "8"}]], ",", "0", ",", "0", ",", "0", ",", "0",
            ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "13"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"13", ",", "11"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "11"}]], ",", "0", ",", "0", ",", "0", ",", "0",
            ",", 
           SubscriptBox["X", 
            RowBox[{"14", ",", "9"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"11", ",", "14"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"11", ",", "9"}]], ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "15"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"15", ",", "11"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", 
           SubscriptBox["X", 
            RowBox[{"10", ",", "11"}]], ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"16", ",", "10"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"11", ",", "16"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"11", ",", "10"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"10", ",", "17"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"17", ",", "11"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"13", ",", "12"}]], ",", "0", ",", "0", ",", "0", ",", 
           "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"12", ",", "13"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"15", ",", "14"}]], ",", "0", ",", "0", ",", "0", ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"14", ",", "15"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", "0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"17", ",", "16"}]], ",", "0", ",", "0", ",", "0"}], "}"}],
          ",", 
         RowBox[{"{", 
          RowBox[{
          "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
           "0", ",", 
           SubscriptBox["X", 
            RowBox[{"16", ",", "17"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"-", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", "HIGHER"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], 
      " ", "GENUS"}], ",", " ", 
     RowBox[{
      RowBox[{"ONE", " ", "BOUNDARY", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"CASES", "--"}], "--"}], "--"}], "--"}], "--"}], "--"}],
          "--"}], "--"}]}], "-", 
      RowBox[{"-", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"-", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"-", 
             RowBox[{"-", 
              RowBox[{"--", 
               RowBox[{"--", "-"}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Y2", ",", 
     RowBox[{
     "0", " ", "with", " ", "a", " ", "single", " ", "boundary", " ", 
      "cutting", " ", "ONE", " ", 
      RowBox[{"line", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "34"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"2", ",", "1"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"3", ",", "4"}]]}], ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"1", ",", "3"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"4", ",", "2"}]]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["Y", 
             RowBox[{"1", ",", "3"}]], "+", 
            SubscriptBox["Y", 
             RowBox[{"4", ",", "2"}]]}], ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "1"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", 
          SubscriptBox["Y", 
           RowBox[{"3", ",", "4"}]], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          SubscriptBox["Z", 
           RowBox[{"3", ",", "4"}]]}], "}"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{"{", "0", "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Y2", ",", 
     RowBox[{
     "2", " ", "with", " ", "a", " ", "single", " ", "boundary", " ", 
      "cutting", " ", "ONE", " ", 
      RowBox[{"line", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "35"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"4", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "3"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"3", ",", "1"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"1", ",", "4"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", 
          SubscriptBox["X", 
           RowBox[{"3", ",", "4"}]], "}"}], ",", 
         RowBox[{"{", "0", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["Y", 
           RowBox[{"3", ",", "4"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
        "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{"{", "0", "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Y2", ",", 
     RowBox[{
     "2", " ", "with", " ", "a", " ", "single", " ", "boundary", " ", 
      "cutting", " ", "TWO", " ", 
      RowBox[{"lines", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "36"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "5"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"4", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "4"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "3"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "2"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "4"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "4"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"5", ",", "4"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["Y", 
            RowBox[{"3", ",", "2"}]], ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"This", " ", "is", " ", "Y4"}], ",", 
     RowBox[{
     "0", " ", "with", " ", "a", " ", "single", " ", "boundary", " ", 
      "cutting", " ", "ONE", " ", 
      RowBox[{"line", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "37"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"5", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "6"}]], ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"1", ",", "2"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"6", ",", "5"}]]}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"4", ",", "8"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "3"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "4"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"1", ",", "4"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"8", ",", "5"}]]}], ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"5", ",", "1"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "8"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"3", ",", "2"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"6", ",", "7"}]]}], ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "6"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"7", ",", "3"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", 
          SubscriptBox["X", 
           RowBox[{"8", ",", "7"}]], "}"}], ",", 
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "0", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", 
          SubscriptBox["Y", 
           RowBox[{"8", ",", "7"}]]}], "}"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{"{", "0", "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Y4", ",", 
     RowBox[{
     "0", " ", "with", " ", "a", " ", "single", " ", "boundary", " ", 
      "cutting", " ", "TWO", " ", 
      RowBox[{"lines", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "38"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"6", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "7"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"4", ",", "5"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "3"}]], ",", "0", ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"3", ",", "4"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"5", ",", "8"}]]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"1", ",", "4"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"5", ",", "6"}]]}], ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"6", ",", "1"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "5"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "2"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "9"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"8", ",", "3"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"7", ",", "6"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "8"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "8"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "6"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Y6", ",", 
     RowBox[{
     "0", " ", "with", " ", "a", " ", "single", " ", "boundary", " ", 
      "cutting", " ", "ONE", " ", 
      RowBox[{"line", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "39"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"7", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "8"}]], ",", "0", ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"1", ",", "2"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"8", ",", "7"}]]}], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "10"}]], ",", "0", ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"3", ",", "4"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"10", ",", "9"}]]}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"6", ",", "12"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"11", ",", "5"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "6"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"1", ",", "6"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"12", ",", "7"}]]}], ",", "0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"7", ",", "1"}]], ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"6", ",", "12"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"3", ",", "2"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"8", ",", "9"}]]}], ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "8"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"9", ",", "3"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"5", ",", "4"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"10", ",", "11"}]]}], ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "10"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"11", ",", "5"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", 
          SubscriptBox["X", 
           RowBox[{"12", ",", "11"}]], "}"}], ",", 
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "0", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
          SubscriptBox["Y", 
           RowBox[{"12", ",", "11"}]]}], "}"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{"{", "0", "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Wider", "-", "by", "-", 
      RowBox[{"one", " ", "Y3"}]}], ",", "3", ",", " ", 
     RowBox[{
     "with", " ", "a", " ", "single", " ", "boundary", " ", "cutting", " ", 
      "TWO", " ", 
      RowBox[{"lines", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "40"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "6"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "2"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "5"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "1"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"6", ",", "4"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"10", ",", "6"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "10"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "6"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "8"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "5"}]], ",", "0", ",", "0", ",", "0", ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "5"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "7"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "4"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"10", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "9"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "7"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"10", ",", "7"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "10"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "3"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"9", ",", "10"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "9"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "10"}]], ",", "0", ",", "0", ",", "0", ",", "0",
            ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "8"}]], ",", "0", ",", "0", ",", "0", ",", 
           "0"}], "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Square", " ", "torus", " ", 
     RowBox[{"(", 
      RowBox[{"section", " ", "7.3"}], ")"}], " ", "with", " ", "a", " ", 
     "single", " ", "boundary", " ", "chopping", " ", "ONE", " ", 
     RowBox[{"line", ".", " ", "It"}], " ", "is", " ", 
     RowBox[{"reducible", "!"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "41"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"7", ",", "3"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "8"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "4"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "6"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "1"}]], ",", "0", ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"6", ",", "5"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"1", ",", "2"}]]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"6", ",", "7"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"3", ",", "2"}]]}], ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"7", ",", "3"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "6"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"8", ",", "5"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"1", ",", "4"}]]}], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "8"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"5", ",", "1"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          SubscriptBox["X", 
           RowBox[{"8", ",", "7"}]], "}"}], ",", 
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "0", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", 
          SubscriptBox["Y", 
           RowBox[{"8", ",", "7"}]], ",", "0"}], "}"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{"{", "0", "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"addgauge", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"7", ",", "8"}], "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"zed", "=", 
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "6"}]], 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "8"}]]}], 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"7", ",", "3"}]], 
           SubscriptBox["X", 
            RowBox[{"5", ",", "1"}]]}]], ",", 
         FractionBox[
          SubscriptBox["X", 
           RowBox[{"6", ",", "7"}]], 
          SubscriptBox["X", 
           RowBox[{"3", ",", "2"}]]]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Untwisted", " ", "square", " ", "torus", " ", 
     RowBox[{"(", 
      RowBox[{"section", " ", "7.3"}], ")"}], " ", "with", " ", "a", " ", 
     "single", " ", "boundary", " ", "chopping", " ", "ONE", " ", 
     RowBox[{"line", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "42"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"2", ",", "4"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"3", ",", "1"}]]}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Y", 
            RowBox[{"4", ",", "3"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"1", ",", "2"}]], ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "4"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["Z", 
             RowBox[{"2", ",", "4"}]], "+", 
            SubscriptBox["Z", 
             RowBox[{"3", ",", "1"}]]}], ",", "0", ",", 
           SubscriptBox["Z", 
            RowBox[{"4", ",", "3"}]], ",", 
           SubscriptBox["Z", 
            RowBox[{"1", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{
            SubscriptBox["W", 
             RowBox[{"2", ",", "4"}]], "+", 
            SubscriptBox["W", 
             RowBox[{"3", ",", "1"}]]}], ",", 
           SubscriptBox["W", 
            RowBox[{"1", ",", "2"}]], ",", 
           SubscriptBox["W", 
            RowBox[{"4", ",", "3"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", 
          SubscriptBox["Y", 
           RowBox[{"3", ",", "1"}]], "}"}], ",", 
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "0", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", 
          SubscriptBox["V", 
           RowBox[{"3", ",", "1"}]]}], "}"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{"{", "0", "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Square", " ", "torus", " ", 
     RowBox[{"(", 
      RowBox[{"section", " ", "7.3"}], ")"}], " ", "with", " ", "a", " ", 
     "single", " ", "boundary", " ", "chopping", " ", "TWO", " ", 
     RowBox[{"lines", ".", " ", "It"}], " ", "is", " ", 
     RowBox[{"reducible", "!"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "43"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"6", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "7"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"4", ",", "5"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "3"}]], ",", "0", ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"3", ",", "4"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"5", ",", "8"}]]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"1", ",", "4"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"5", ",", "6"}]]}], ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"6", ",", "1"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "5"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "2"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "9"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"8", ",", "3"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"7", ",", "6"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "8"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "8"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "6"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Untwisted", " ", "square", " ", "torus", " ", 
     RowBox[{"(", 
      RowBox[{"section", " ", "7.3"}], ")"}], " ", "with", " ", "a", " ", 
     "single", " ", "boundary", " ", "chopping", " ", "TWO", " ", 
     RowBox[{"lines", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "44"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["W", 
            RowBox[{"1", ",", "2"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "4"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["W", 
            RowBox[{"4", ",", "3"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"1", ",", "2"}]], ",", "0", ",", 
           RowBox[{
            SubscriptBox["Z", 
             RowBox[{"2", ",", "4"}]], "+", 
            SubscriptBox["Y", 
             RowBox[{"3", ",", "1"}]]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["Z", 
             RowBox[{"3", ",", "1"}]], "+", 
            SubscriptBox["W", 
             RowBox[{"2", ",", "4"}]]}], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", 
           SubscriptBox["Z", 
            RowBox[{"1", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["W", 
            RowBox[{"3", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", 
           SubscriptBox["Z", 
            RowBox[{"4", ",", "3"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["V", 
            RowBox[{"3", ",", "1"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "4"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["V", 
            RowBox[{"2", ",", "4"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Square", " ", "torus", " ", 
     RowBox[{"(", 
      RowBox[{"section", " ", "7.3"}], ")"}], " ", "with", " ", "a", " ", 
     "single", " ", "boundary", " ", "chopping", " ", "THREE", " ", 
     RowBox[{"lines", ".", " ", "It"}], " ", "is", " ", 
     RowBox[{"reducible", "!"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "45"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"6", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "7"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"4", ",", "5"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "3"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "4"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"1", ",", "4"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"5", ",", "6"}]]}], ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"6", ",", "1"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "5"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "2"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "9"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"10", ",", "3"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"7", ",", "6"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "8"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "10"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "8"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "6"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "10"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"addgauge", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"5", ",", "6", ",", "7", ",", "8", ",", "9", ",", "10"}], 
         "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"zed", "=", 
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "7"}]], 
           SubscriptBox["X", 
            RowBox[{"4", ",", "5"}]]}], 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"8", ",", "3"}]], 
           SubscriptBox["X", 
            RowBox[{"6", ",", "1"}]]}]], ",", 
         FractionBox[
          SubscriptBox["X", 
           RowBox[{"5", ",", "6"}]], 
          SubscriptBox["X", 
           RowBox[{"1", ",", "4"}]]]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Untwisted", " ", "square", " ", "torus", " ", 
     RowBox[{"(", 
      RowBox[{"section", " ", "7.3"}], ")"}], " ", "with", " ", "a", " ", 
     "single", " ", "boundary", " ", "chopping", " ", "THREE", " ", 
     RowBox[{"lines", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "46"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "5"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "4"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Y", 
            RowBox[{"4", ",", "3"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"6", ",", "2"}]], ",", "0", ",", 
           SubscriptBox["W", 
            RowBox[{"2", ",", "4"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["V", 
             RowBox[{"2", ",", "4"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"3", ",", "1"}]]}], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"1", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "6"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "2"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "5"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"5", ",", "1"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["Y", 
            RowBox[{"3", ",", "6"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "4"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["Z", 
            RowBox[{"2", ",", "4"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "6"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"5", ",", "1"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Torus", " ", "example", " ", "with", " ", "5", " ", "loops", " ", "and",
       " ", "4", " ", "external", " ", "legs"}], ",", " ", 
     RowBox[{"Seiberg", "-", 
      RowBox[{"dualized", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "47"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"6", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "7"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "8"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "4"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"4", ",", "6"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "5"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "5"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"5", ",", "4"}]], ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "8"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "6"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"6", ",", "1"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "2"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "9"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"8", ",", "3"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"7", ",", "6"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "8"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "8"}]], ",", "0", ",", "0", ",", "0", ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "6"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Example", " ", "on", " ", "genus", " ", "2"}], ",", " ", 
     RowBox[{"with", " ", "one", " ", 
      RowBox[{"boundary", ".", " ", 
       RowBox[{"(", 
        RowBox[{
        "Constructed", " ", "for", " ", "the", " ", "higher", " ", "genus", 
         " ", "boundary", " ", "measurement"}], ")"}], "."}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "74"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "5"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "4"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Y", 
            RowBox[{"4", ",", "3"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"6", ",", "2"}]], ",", "0", ",", 
           SubscriptBox["W", 
            RowBox[{"2", ",", "4"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["V", 
             RowBox[{"2", ",", "4"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"3", ",", "1"}]]}], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"1", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "6"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "2"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "5"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"5", ",", "1"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["Y", 
            RowBox[{"3", ",", "6"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "4"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["Z", 
            RowBox[{"2", ",", "4"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "6"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"5", ",", "1"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "106"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Y", 
            RowBox[{"1", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["Y", 
            RowBox[{"3", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Y", 
            RowBox[{"2", ",", "1"}]], ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"1", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "2"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Y", "[", 
           RowBox[{"1", ",", "1"}], "]"}], ",", "0", ",", "0", ",", "0"}], 
         "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{"{", "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "107"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Y", 
            RowBox[{"1", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["Y", 
            RowBox[{"3", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Y", 
            RowBox[{"2", ",", "1"}]], ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"1", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "2"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Y", "[", 
            RowBox[{"1", ",", "1"}], "]"}], ",", "0", ",", "0", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Z", "[", 
            RowBox[{"1", ",", "1"}], "]"}], ",", "0", ",", "0", ",", "0"}], 
          "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "108"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Y", 
            RowBox[{"1", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["Y", 
            RowBox[{"3", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Y", 
            RowBox[{"2", ",", "1"}]], ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"1", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "2"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          SubscriptBox["W", 
           RowBox[{"1", ",", "1"}]], "}"}], ",", 
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "0", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Y", "[", 
            RowBox[{"1", ",", "1"}], "]"}], ",", "0", ",", "0", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Z", "[", 
            RowBox[{"1", ",", "1"}], "]"}], ",", "0", ",", "0", ",", "0"}], 
          "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "0", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "110"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "1"}]], ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"1", ",", "2"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"2", ",", "1"}]]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["Y", 
             RowBox[{"1", ",", "2"}]], "+", 
            SubscriptBox["Y", 
             RowBox[{"2", ",", "1"}]]}], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "2"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["Y", 
           RowBox[{"1", ",", "1"}]], ",", "0"}], "}"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{"{", "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"-", "HIGHER"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], " ", 
      "GENUS"}], ",", " ", 
     RowBox[{
      RowBox[{"MULTI", " ", "BOUNDARY", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"CASES", "--"}], "--"}], "--"}], "--"}], "--"}], "--"}], 
        "--"}]}], "-", 
      RowBox[{"-", 
       RowBox[{"-", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"-", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"-", 
              RowBox[{"-", 
               RowBox[{"--", 
                RowBox[{"--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Y2", ",", 
     RowBox[{
     "0", " ", "with", " ", "TWO", " ", "boundaries", " ", "each", " ", 
      "cutting", " ", "ONE", " ", 
      RowBox[{"line", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "48"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"1", ",", "3"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"4", ",", "2"}]]}], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "4"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]], ",", 
           RowBox[{
            SubscriptBox["Y", 
             RowBox[{"1", ",", "3"}]], "+", 
            SubscriptBox["Y", 
             RowBox[{"4", ",", "2"}]]}]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Y", 
            RowBox[{"3", ",", "4"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Z", 
            RowBox[{"3", ",", "4"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["Z", 
            RowBox[{"2", ",", "1"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Relabeled", " ", "Y2"}], ",", 
     RowBox[{
     "0", " ", "with", " ", "TWO", " ", "boundaries", " ", "each", " ", 
      "cutting", " ", "ONE", " ", 
      RowBox[{"line", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "70"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"3", ",", "1"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"2", ",", "4"}]]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["Y", 
             RowBox[{"3", ",", "1"}]], "+", 
            SubscriptBox["Y", 
             RowBox[{"2", ",", "4"}]]}], ",", 
           SubscriptBox["Z", 
            RowBox[{"1", ",", "2"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["Z", 
            RowBox[{"4", ",", "3"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Y", 
            RowBox[{"1", ",", "2"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "3"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Y2", ",", 
     RowBox[{
     "2", " ", "with", " ", "TWO", " ", "boundaries", " ", "each", " ", 
      "cutting", " ", "ONE", " ", 
      RowBox[{"line", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "49"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "3"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"4", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "4"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"1", ",", "3"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"3", ",", "2"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "4"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "4"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Y", 
            RowBox[{"3", ",", "4"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["Z", 
            RowBox[{"3", ",", "2"}]], ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Y6", ",", 
     RowBox[{
     "0", " ", "with", " ", "TWO", " ", "boundaries", " ", "each", " ", 
      "cutting", " ", "ONE", " ", 
      RowBox[{"line", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "50"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"7", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "8"}]], ",", "0", ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"1", ",", "2"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"8", ",", "7"}]]}], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "10"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "4"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"6", ",", "12"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"11", ",", "5"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "6"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"1", ",", "6"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"12", ",", "7"}]]}], ",", "0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"7", ",", "1"}]], ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"6", ",", "12"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"3", ",", "2"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"8", ",", "9"}]]}], ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "8"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"9", ",", "3"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"5", ",", "4"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"10", ",", "11"}]]}], ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "10"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"11", ",", "5"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"10", ",", "9"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"12", ",", "11"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"12", ",", "11"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"10", ",", "9"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Y6", ",", 
     RowBox[{"0", " ", "with", " ", "TWO", " ", 
      RowBox[{"(", 
       RowBox[{"further", " ", "apart"}], ")"}], " ", "boundaries", " ", 
      "each", " ", "cutting", " ", "ONE", " ", 
      RowBox[{"line", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "51"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"7", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "10"}]], ",", "0", ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"1", ",", "2"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"10", ",", "7"}]]}], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "8"}]], ",", "0", ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"3", ",", "4"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"8", ",", "9"}]]}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"6", ",", "12"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"11", ",", "5"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "6"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"1", ",", "6"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"12", ",", "7"}]]}], ",", "0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"7", ",", "1"}]], ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"6", ",", "12"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "2"}]], ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "10"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"9", ",", "3"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"5", ",", "4"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"8", ",", "11"}]]}], ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "8"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"11", ",", "5"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"12", ",", "11"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"10", ",", "9"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"12", ",", "11"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["Y", 
            RowBox[{"10", ",", "9"}]], ",", "0", ",", "0", ",", "0", ",", 
           "0"}], "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Wider", "-", "by", "-", 
      RowBox[{"one", " ", "Y3"}]}], ",", "3", ",", " ", 
     RowBox[{
     "with", " ", "TWO", " ", "boundaries", " ", "each", " ", "cutting", " ", 
      "ONE", " ", 
      RowBox[{"line", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "52"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "7"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "2"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "6"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "1"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"7", ",", "4"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "7"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "9"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "8"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "6"}]], ",", "0", ",", "0", ",", "0", ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "6"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "5"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "4"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "8"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "8"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "5"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "5"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "9"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "3"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"6", ",", "7"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "9"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["Y", 
            RowBox[{"6", ",", "7"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"8", ",", "9"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", "0"}], "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Square", " ", "torus", " ", 
     RowBox[{"(", 
      RowBox[{"section", " ", "7.3"}], ")"}], " ", "with", " ", "two", " ", 
     "boundaries", " ", "each", " ", "chopping", " ", "each", " ", "ONE", " ", 
     RowBox[{"line", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "53"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Y", 
            RowBox[{"7", ",", "2"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"5", ",", "8"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "5"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Y", 
            RowBox[{"1", ",", "4"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"3", ",", "6"}]], ",", "0", ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"6", ",", "1"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"4", ",", "3"}]]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"4", ",", "7"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"2", ",", "1"}]]}], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "8"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "6"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"8", ",", "7"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "5"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"8", ",", "7"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["Y", 
            RowBox[{"6", ",", "5"}]], ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"addgauge", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"7", ",", "8"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"5", ",", "6"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"zed", "=", 
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{
           SubscriptBox["Y", 
            RowBox[{"1", ",", "4"}]], 
           SubscriptBox["Y", 
            RowBox[{"5", ",", "8"}]]}], 
          RowBox[{
           SubscriptBox["Y", 
            RowBox[{"7", ",", "2"}]], 
           SubscriptBox["Y", 
            RowBox[{"3", ",", "6"}]]}]], ",", 
         FractionBox[
          SubscriptBox["X", 
           RowBox[{"4", ",", "7"}]], 
          SubscriptBox["X", 
           RowBox[{"2", ",", "1"}]]]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", "HIGHER"}]}]}]}]}]}]}]}]}]}]}], " ", "GENUS"}], 
     ",", " ", 
     RowBox[{"ZERO", " ", "BOUNDARY", " ", "CASES"}], ",", " ", 
     RowBox[{
      RowBox[{"E", ".", "G", ".", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"DIMERS", "--"}], "--"}], "--"}], "--"}]}], 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", "-"}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Y2", ",", 
     RowBox[{"0", " ", "without", " ", 
      RowBox[{"boundaries", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "54"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"3", ",", "4"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"2", ",", "1"}]]}], ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"1", ",", "3"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"4", ",", "2"}]]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["Y", 
             RowBox[{"1", ",", "3"}]], "+", 
            SubscriptBox["Y", 
             RowBox[{"4", ",", "2"}]]}], ",", 
           RowBox[{
            SubscriptBox["Y", 
             RowBox[{"2", ",", "1"}]], "+", 
            SubscriptBox["Y", 
             RowBox[{"3", ",", "4"}]]}]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Y2", ",", 
     RowBox[{"2", " ", "without", " ", 
      RowBox[{"boundaries", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "55"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"4", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "4"}]], ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "3"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"3", ",", "1"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"1", ",", "4"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Untwisted", " ", "Y2"}], ",", 
     RowBox[{"2", " ", "without", " ", 
      RowBox[{"boundaries", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "56"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Y", 
            RowBox[{"3", ",", "1"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"1", ",", "2"}]], ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "3"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Z", 
            RowBox[{"2", ",", "3"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["W", 
            RowBox[{"2", ",", "3"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "2"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"3", ",", "4"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"addgauge", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"zed", "=", 
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]], 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "2"}]]}], 
          RowBox[{
           SubscriptBox["W", 
            RowBox[{"2", ",", "3"}]], 
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]]}]], ",", 
         FractionBox[
          RowBox[{
           SubscriptBox["W", 
            RowBox[{"2", ",", "3"}]], 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "3"}]]}], 
          RowBox[{
           SubscriptBox["Y", 
            RowBox[{"1", ",", "2"}]], 
           SubscriptBox["Y", 
            RowBox[{"3", ",", "4"}]]}]]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Y3", ",", 
     RowBox[{"3", " ", "without", " ", 
      RowBox[{"boundaries", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "57"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "5"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "2"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "1"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"6", ",", "3"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "6"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"5", ",", "6"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"3", ",", "5"}]], ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"6", ",", "3"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "5"}]], ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"5", ",", "2"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "4"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "4"}]], ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "1"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"1", ",", "6"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Untwisted", " ", "Y3"}], ",", 
     RowBox[{"3", " ", "without", " ", 
      RowBox[{"boundaries", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "58"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "3"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "2"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "1"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"1", ",", "3"}]], ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"3", ",", "2"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Z", 
            RowBox[{"1", ",", "3"}]], ",", "0", ",", 
           SubscriptBox["Z", 
            RowBox[{"2", ",", "1"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["Z", 
            RowBox[{"3", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["W", 
            RowBox[{"3", ",", "2"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "4"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["V", 
            RowBox[{"3", ",", "2"}]], ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "4"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "3"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["UU", 
            RowBox[{"3", ",", "2"}]], ",", "0", ",", 
           SubscriptBox["Z", 
            RowBox[{"2", ",", "4"}]], ",", 
           SubscriptBox["Z", 
            RowBox[{"4", ",", "3"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Y4", ",", 
     RowBox[{"4", " ", "without", " ", 
      RowBox[{"boundaries", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "59"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"4", ",", "7"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "3"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "4"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "6"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "2"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "5"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "1"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"8", ",", "4"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "8"}]], ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"7", ",", "8"}]], ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "7"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"8", ",", "4"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "7"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"7", ",", "3"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"3", ",", "6"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "6"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"6", ",", "2"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "5"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "5"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"5", ",", "1"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"1", ",", "8"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Untwisted", " ", "Y4"}], ",", 
     RowBox[{"4", " ", "without", " ", 
      RowBox[{"boundaries", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "60"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["Y", 
            RowBox[{"1", ",", "2"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"3", ",", "1"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "3"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["Z", 
            RowBox[{"1", ",", "2"}]], ",", 
           SubscriptBox["Z", 
            RowBox[{"3", ",", "1"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["Z", 
            RowBox[{"2", ",", "3"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["W", 
            RowBox[{"3", ",", "1"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["W", 
            RowBox[{"1", ",", "2"}]], ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["W", 
            RowBox[{"2", ",", "3"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["V", 
            RowBox[{"2", ",", "3"}]], ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "4"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["UU", 
            RowBox[{"2", ",", "3"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "2"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"3", ",", "4"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["XX", 
            RowBox[{"2", ",", "3"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["Z", 
            RowBox[{"4", ",", "2"}]], ",", 
           SubscriptBox["Z", 
            RowBox[{"3", ",", "4"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["YY", 
            RowBox[{"2", ",", "3"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["W", 
            RowBox[{"4", ",", "2"}]], ",", 
           SubscriptBox["W", 
            RowBox[{"3", ",", "4"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Y6", ",", 
     RowBox[{"0", " ", "with", " ", "no", " ", 
      RowBox[{"boundaries", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "61"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"7", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "8"}]], ",", "0", ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"8", ",", "7"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"1", ",", "2"}]]}], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "10"}]], ",", "0", ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"3", ",", "4"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"10", ",", "9"}]]}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"6", ",", "12"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"11", ",", "5"}]], ",", "0", ",", "0", ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"5", ",", "6"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"12", ",", "11"}]]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"12", ",", "7"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"1", ",", "6"}]]}], ",", "0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"7", ",", "1"}]], ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"6", ",", "12"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"3", ",", "2"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"8", ",", "9"}]]}], ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "8"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"9", ",", "3"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"10", ",", "11"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"5", ",", "4"}]]}], ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "10"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"11", ",", "5"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Wider", "-", "by", "-", 
      RowBox[{"one", " ", "Y3"}]}], ",", "3", ",", " ", 
     RowBox[{"without", " ", 
      RowBox[{"boundaries", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "62"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "5"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "2"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "1"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"6", ",", "3"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "6"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"5", ",", "6"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "5"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "9"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "5"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "8"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "4"}]], ",", "0", ",", "0", ",", "0", ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "4"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "7"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "6"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "9"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "8"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "8"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "7"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "7"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "9"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "3"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Square", " ", "torus", " ", 
     RowBox[{"(", 
      RowBox[{"section", " ", "7.3"}], ")"}], " ", "with", " ", "no", " ", 
     RowBox[{"boundaries", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "63"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"5", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "6"}]], ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"6", ",", "5"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"1", ",", "2"}]]}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"4", ",", "8"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "3"}]], ",", "0", ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"3", ",", "4"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"8", ",", "7"}]]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"1", ",", "4"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"8", ",", "5"}]]}], ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"5", ",", "1"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "8"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"3", ",", "2"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"6", ",", "7"}]]}], ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "6"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"7", ",", "3"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Untwisted", " ", "square", " ", "torus", " ", 
     RowBox[{"(", 
      RowBox[{"section", " ", "7.3"}], ")"}], " ", "without", " ", 
     RowBox[{"boundaries", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "64"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"2", ",", "4"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"3", ",", "1"}]]}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Z", 
            RowBox[{"4", ",", "3"}]], ",", 
           SubscriptBox["Z", 
            RowBox[{"1", ",", "2"}]], ",", "0", ",", 
           RowBox[{
            SubscriptBox["Z", 
             RowBox[{"2", ",", "4"}]], "+", 
            SubscriptBox["W", 
             RowBox[{"3", ",", "1"}]]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["W", 
             RowBox[{"2", ",", "4"}]], "+", 
            SubscriptBox["V", 
             RowBox[{"3", ",", "1"}]]}], ",", "0", ",", 
           SubscriptBox["W", 
            RowBox[{"4", ",", "3"}]], ",", 
           SubscriptBox["W", 
            RowBox[{"1", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{
            SubscriptBox["Y", 
             RowBox[{"2", ",", "4"}]], "+", 
            SubscriptBox["Z", 
             RowBox[{"3", ",", "1"}]]}], ",", 
           SubscriptBox["Y", 
            RowBox[{"1", ",", "2"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "3"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"L2", ",", "2", ",", 
     RowBox[{"2", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"no", " ", "boundaries"}], ")"}], "."}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "71"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"1", ",", "2"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"2", ",", "1"}]]}], ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"2", ",", "3"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"3", ",", "2"}]]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"1", ",", "4"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"4", ",", "1"}]]}], ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"4", ",", "3"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"3", ",", "4"}]]}]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"L2", ",", "2", ",", 
     RowBox[{"2", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"no", " ", "boundaries"}], ")"}], "."}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "72"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"1", ",", "2"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"2", ",", "1"}]]}], ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"2", ",", "3"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"3", ",", "2"}]]}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"3", ",", "4"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"4", ",", "3"}]]}], ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"4", ",", "5"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"5", ",", "4"}]]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"1", ",", "6"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"6", ",", "1"}]]}], ",", "0", ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"6", ",", "5"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"5", ",", "6"}]]}]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "105"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Y", 
            RowBox[{"1", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["Y", 
            RowBox[{"3", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Y", 
            RowBox[{"2", ",", "1"}]], ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"1", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "2"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "109"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "1"}]], ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"1", ",", "2"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"2", ",", "1"}]]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["Y", 
             RowBox[{"1", ",", "2"}]], "+", 
            SubscriptBox["Y", 
             RowBox[{"2", ",", "1"}]]}], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "2"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"UNCLASSIFIED", "--"}], "--"}], "--"}], "--"}], 
                    "--"}], "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], 
     "-", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"-", 
              RowBox[{"-", 
               RowBox[{"-", 
                RowBox[{"-", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Junk", " ", 
     RowBox[{"one", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "65"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"1", ",", "2"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"2", ",", "1"}]]}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "1"}]], ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"1", ",", "3"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"3", ",", "1"}]]}]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          SubscriptBox["X", 
           RowBox[{"2", ",", "2"}]], "}"}], ",", 
         RowBox[{"{", "0", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          SubscriptBox["X", 
           RowBox[{"3", ",", "3"}]]}], "}"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{"{", "0", "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Second", " ", "junk", " ", 
     RowBox[{"one", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "66"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "2"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "5"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "6"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "4"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "6"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "5"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Second", " ", "junk", " ", "one", " ", "with", " ", "an", " ", "extra", 
     " ", 
     RowBox[{"boundary", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "67"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "2"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "5"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "6"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "4"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "6"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "5"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "1"}]], ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Second", " ", "junk", " ", "one", " ", "with", " ", "two", " ", "extra", 
     " ", 
     RowBox[{"boundaries", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "68"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "2"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "5"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "6"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "4"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "6"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "5"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "1"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Y", 
            RowBox[{"1", ",", "2"}]], ",", "0", ",", "0", ",", "0"}], "}"}]}],
         "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      SubscriptBox["BFT", "ii"], " ", "WITH", " ", "SCRAMBLED", " ", 
      "FACES"}], ",", " ", 
     RowBox[{
      RowBox[{"WHERE", " ", "ii"}], "=", "18"}], ",", "58", ",", "26", ",", 
     "46", ",", "2", ",", "22", ",", "14", ",", "10", ",", "75", ",", "3", 
     ",", "56", ",", "4", ",", "16", ",", "25", ",", "49", ",", "44", ",", 
     "43", ",", "32", ",", "62", ",", "11", ",", "34", ",", "7", ",", "8", 
     ",", "36"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "77"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"5", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"4", ",", "5"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "4"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["X", 
           RowBox[{"2", ",", "5"}]], ",", "0"}], "}"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "78"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"4", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "2"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "1"}]], ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"1", ",", "4"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Z", 
            RowBox[{"2", ",", "1"}]], ",", "0", ",", 
           SubscriptBox["Z", 
            RowBox[{"4", ",", "2"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["Z", 
            RowBox[{"1", ",", "4"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["W", 
            RowBox[{"1", ",", "4"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["V", 
            RowBox[{"1", ",", "4"}]], ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "3"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"3", ",", "1"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["UU", 
            RowBox[{"1", ",", "4"}]], ",", "0", ",", 
           SubscriptBox["Z", 
            RowBox[{"4", ",", "3"}]], ",", 
           SubscriptBox["Z", 
            RowBox[{"3", ",", "1"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "79"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"1", ",", "5"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"4", ",", "3"}]]}], ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "4"}]], ",", "0", ",", "0", ",", "0", ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Y", 
            RowBox[{"5", ",", "4"}]], ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"4", ",", "12"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"9", ",", "5"}]]}], ",", 
           SubscriptBox["Y", 
            RowBox[{"12", ",", "9"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"12", ",", "9"}]], ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"9", ",", "13"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"10", ",", "12"}]]}], ",", 
           SubscriptBox["X", 
            RowBox[{"13", ",", "10"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"13", ",", "10"}]], ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"7", ",", "13"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"10", ",", "2"}]]}], ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "7"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "7"}]], ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"7", ",", "6"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"14", ",", "2"}]]}], ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "14"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"6", ",", "14"}]], ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"11", ",", "6"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"14", ",", "8"}]]}]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "11"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Y", 
            RowBox[{"3", ",", "1"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"8", ",", "11"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "80"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "5"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Y", 
            RowBox[{"5", ",", "6"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"1", ",", "3"}]], ",", "0", ",", 
           SubscriptBox["W", 
            RowBox[{"3", ",", "5"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["V", 
             RowBox[{"3", ",", "5"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"6", ",", "4"}]]}], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "6"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "3"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "3"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"5", ",", "2"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "4"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["Y", 
            RowBox[{"6", ",", "1"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"3", ",", "5"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["Z", 
            RowBox[{"3", ",", "5"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "1"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "4"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "81"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"4", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "4"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "3"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "82"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"5", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "5"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "5"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "2"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "3"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "6"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", 
          SubscriptBox["X", 
           RowBox[{"6", ",", "4"}]], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "4"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "5"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "0", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "83"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"6", ",", "7"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "10"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"7", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "7"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "9"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "5"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "5"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "3"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"10", ",", "6"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "3"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "8"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "6"}]], ",", "0", ",", "0", ",", "0", ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "2"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"10", ",", "8"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "84"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"9", ",", "8"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "7"}]], ",", "0", ",", "0", ",", "0", ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"8", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "8"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "6"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "4"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "6"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "6"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "10"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"10", ",", "7"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"10", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "10"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"7", ",", "9"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "5"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "9"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "5"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "1"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "85"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"7", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "9"}]], ",", "0", ",", "0", ",", "0", ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "4"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "8"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "6"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "4"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "8"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "9"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "1"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "8"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "5"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"9", ",", "7"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "6"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "7"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "3"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "6"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "2"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "86"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "5"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"5", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "5"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "6"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "4"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "6"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"6", ",", "2"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]], ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "87"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"4", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Y", 
            RowBox[{"3", ",", "4"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "2"}]], ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "3"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Z", 
            RowBox[{"2", ",", "3"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["W", 
            RowBox[{"2", ",", "3"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"1", ",", "2"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"3", ",", "1"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "88"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "4"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"5", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "5"}]], ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "5"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"5", ",", "2"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "89"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "1"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "5"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "2"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "5"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "3"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["X", 
           RowBox[{"4", ",", "3"}]], ",", "0", ",", "0"}], "}"}], "}"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "90"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"1", ",", "7"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"8", ",", "6"}]]}], ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "1"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Y", 
            RowBox[{"6", ",", "1"}]], ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"1", ",", "2"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"9", ",", "6"}]]}], ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "9"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "9"}]], ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"3", ",", "2"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"9", ",", "10"}]]}], ",", 
           SubscriptBox["X", 
            RowBox[{"10", ",", "3"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"10", ",", "3"}]], ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"3", ",", "4"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"5", ",", "10"}]]}]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"7", ",", "8"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "5"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Y", 
            RowBox[{"7", ",", "8"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "5"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "91"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "2"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "3"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"3", ",", "2"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "3"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "2"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "1"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"1", ",", "4"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "4"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Y", 
            RowBox[{"2", ",", "4"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["Z", 
            RowBox[{"2", ",", "1"}]], ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "92"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["W", 
            RowBox[{"4", ",", "1"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["W", 
            RowBox[{"2", ",", "3"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "1"}]], ",", "0", ",", 
           RowBox[{
            SubscriptBox["Y", 
             RowBox[{"3", ",", "4"}]], "+", 
            SubscriptBox["Z", 
             RowBox[{"1", ",", "2"}]]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["W", 
             RowBox[{"1", ",", "2"}]], "+", 
            SubscriptBox["Z", 
             RowBox[{"3", ",", "4"}]]}], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", 
           SubscriptBox["Z", 
            RowBox[{"4", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["W", 
            RowBox[{"3", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "1"}]], ",", 
           SubscriptBox["Z", 
            RowBox[{"2", ",", "3"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["V", 
            RowBox[{"3", ",", "4"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["Y", 
            RowBox[{"1", ",", "2"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["V", 
            RowBox[{"1", ",", "2"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "4"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "93"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"5", ",", "9"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "1"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"7", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "4"}]], ",", "0", ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"3", ",", "6"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"4", ",", "7"}]]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"3", ",", "5"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"9", ",", "7"}]]}], ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"5", ",", "9"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"7", ",", "3"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "1"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"1", ",", "8"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"6", ",", "4"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "5"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "6"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "6"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "5"}]], ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "94"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"7", ",", "4"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "6"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "7"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"4", ",", "10"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"10", ",", "8"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "5"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "9"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "2"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "8"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "7"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "1"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "6"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", 
          SubscriptBox["X", 
           RowBox[{"6", ",", "5"}]], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"6", ",", "5"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "3"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"10", ",", "7"}]], ",", "0", ",", "0", ",", "0", ",", "0",
            ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "10"}]], ",", "0", ",", "0", ",", "0", ",", "0",
            ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "9"}]], ",", "0", ",", "0", ",", "0", ",", 
           "0"}], "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "0", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "95"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"9", ",", "6"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "5"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "9"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "8"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "5"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"7", ",", "9"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "7"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "8"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"6", ",", "7"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "6"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "1"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "6"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "4"}]], ",", "0", ",", "0", ",", "0", ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "4"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "7"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "5"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "2"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "2"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "8"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "3"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "1"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "9"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "96"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "2"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "4"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "6"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"6", ",", "8"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "2"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "7"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "8"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "5"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "5"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "1"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"6", ",", "3"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "6"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "1"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "97"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"2", ",", "1"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"4", ",", "3"}]]}], ",", 
           RowBox[{
            SubscriptBox["X", 
             RowBox[{"1", ",", "4"}]], "+", 
            SubscriptBox["X", 
             RowBox[{"3", ",", "2"}]]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["Y", 
             RowBox[{"1", ",", "4"}]], "+", 
            SubscriptBox["Y", 
             RowBox[{"3", ",", "2"}]]}], ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "3"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", 
          SubscriptBox["Y", 
           RowBox[{"2", ",", "1"}]], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          SubscriptBox["Z", 
           RowBox[{"2", ",", "1"}]]}], "}"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{"{", "0", "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "98"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["X", 
           RowBox[{"1", ",", "3"}]], "+", 
          SubscriptBox["X", 
           RowBox[{"2", ",", "1"}]], "+", 
          SubscriptBox["X", 
           RowBox[{"3", ",", "4"}]]}], "}"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         SubscriptBox["X", 
          RowBox[{"4", ",", "2"}]], "}"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         SubscriptBox["Y", 
          RowBox[{"4", ",", "2"}]], "}"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{"{", "0", "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "99"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"4", ",", "5"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["X", 
           RowBox[{"5", ",", "2"}]], ",", "0"}], "}"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "100"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "5"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "3"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "4"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"3", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "1"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"1", ",", "3"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"5", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"5", ",", "3"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "1"}]], ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"SPECIAL", " ", "EXAMPLES"}], ",", " ", 
     RowBox[{"WITH", " ", "MISSING", " ", "EXTERNAL", " ", "EDGES"}], ",", 
     " ", 
     RowBox[{"NO", " ", "PERFECT", " ", "MATCHINGS"}], ",", " ", 
     RowBox[{"ETC", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "This", " ", "is", " ", "just", " ", "like", " ", "the", " ", 
      "nonplanar", " ", "G", 
      RowBox[{"(", 
       RowBox[{"3", ",", "6"}], ")"}], " ", 
      SubscriptBox["bft", "29"], " ", "but", " ", "where", " ", "we", " ", 
      "shut", " ", "off", " ", "the", " ", "external", " ", "edges", " ", 
      SubscriptBox["X", 
       RowBox[{"4", ",", "5"}]]}], ",", " ", 
     RowBox[{
      SubscriptBox["X", 
       RowBox[{"5", ",", "6"}]], " ", "and", " ", 
      SubscriptBox["X", 
       RowBox[{"7", ",", "8"}]]}], ",", " ", 
     RowBox[{
     "thus", " ", "leaving", " ", "some", " ", "external", " ", "nodes", " ", 
      "empty"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "101"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"4", ",", "1"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "2"}]], ",", "0", ",", "0", ",", "0", ",", 
           "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "7"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "7"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "9"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "3"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"4", ",", "4"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "7"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "9"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "This", " ", "is", " ", "just", " ", "like", " ", "the", " ", "dimer", 
     " ", 
     SubscriptBox["bft", "55"], " ", "but", " ", "with", " ", "two", " ", 
     "additional", " ", "empty", " ", "white", " ", "nodes"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "102"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"4", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "4"}]], ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "3"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"3", ",", "1"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"1", ",", "4"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "This", " ", "is", " ", "just", " ", "like", " ", "the", " ", "dimer", 
     " ", 
     SubscriptBox["bft", "55"], " ", "but", " ", "with", " ", "two", " ", 
     "additional", " ", "empty", " ", "white", " ", "nodes", " ", "and", " ", 
     "an", " ", "empty", " ", "black", " ", "node"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "103"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"2", ",", "3"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "1"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "2"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"4", ",", "2"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"1", ",", "4"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"2", ",", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"3", ",", "4"}]], ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"2", ",", "3"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "2"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"3", ",", "1"}]], ",", 
           SubscriptBox["Y", 
            RowBox[{"1", ",", "4"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "0", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "0", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"This", " ", "is", " ", "just", " ", "like", " ", 
      SubscriptBox["bft", "29"], " ", "but", " ", "where", " ", "we", " ", 
      "shut", " ", "off", " ", "the", " ", "external", " ", "edges", " ", 
      SubscriptBox["X", 
       RowBox[{"4", ",", "5"}]]}], ",", " ", 
     SubscriptBox["X", 
      RowBox[{"5", ",", "2"}]], ",", " ", 
     RowBox[{
      SubscriptBox["X", 
       RowBox[{"6", ",", "4"}]], " ", "and", " ", 
      SubscriptBox["X", 
       RowBox[{"1", ",", "6"}]], " ", "thus", " ", "leaving", " ", "us", " ", 
      "with", " ", "no", " ", "perfect", " ", "matchings", " ", 
      RowBox[{"(", 
       RowBox[{
       "as", " ", "well", " ", "as", " ", "empty", " ", "external", " ", 
        "nodes"}], ")"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox["bft", "104"], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["X", 
            RowBox[{"4", ",", "4"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Y", 
            RowBox[{"4", ",", "4"}]], ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "3"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["Z", 
            RowBox[{"4", ",", "4"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "7"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           SubscriptBox["Y", 
            RowBox[{"4", ",", "3"}]], ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"3", ",", "8"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["Y", 
            RowBox[{"3", ",", "4"}]], ",", 
           SubscriptBox["X", 
            RowBox[{"4", ",", "9"}]], ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "3"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           SubscriptBox["W", 
            RowBox[{"4", ",", "4"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"9", ",", "7"}]], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"7", ",", "8"}]], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
           SubscriptBox["X", 
            RowBox[{"8", ",", "9"}]]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"drawBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
     "\[IndentingNewLine]", ")"}]}]}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 CellChangeTimes->{{3.66470967834403*^9, 3.664709704091943*^9}, {
   3.667043194338788*^9, 3.6670433181483445`*^9}, {3.667047529242683*^9, 
   3.667047535130081*^9}, {3.667558447498929*^9, 3.667558477458411*^9}, {
   3.66755899666227*^9, 3.6675589990754614`*^9}, 3.667559047633154*^9, {
   3.6675591332762966`*^9, 3.667559186115571*^9}, {3.667559229546889*^9, 
   3.66755931748707*^9}, {3.667559407920476*^9, 3.6675594346837173`*^9}, {
   3.6675594938441157`*^9, 3.667559529756649*^9}, {3.667559576712284*^9, 
   3.667559590175333*^9}, {3.667559650008298*^9, 3.667559685398327*^9}, {
   3.6675597393195553`*^9, 3.667559858609982*^9}, {3.667822579205493*^9, 
   3.667822588609629*^9}, {3.672739123004881*^9, 3.6727391286212316`*^9}, {
   3.6727391671968155`*^9, 3.672739168490926*^9}, {3.6727392110799775`*^9, 
   3.6727392118066435`*^9}}]
}, Closed]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6670476081528406`*^9, 3.667047608527871*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Here", " ", "we", " ", "check", " ", "getNumberFaces"}], ",", " ",
    "getNumberExternalFaces", ",", " ", "getNumberInternalFaces", ",", " ", 
   "getInternalFaceLabels", ",", " ", "getExternalFaceLabels", ",", " ", 
   "getFaceLabels"}], "*)"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653194611906705`*^9, 3.665319470875516*^9}, 
   3.665319696162837*^9, 3.665319923129767*^9, {3.66532084581382*^9, 
   3.6653208558484077`*^9}, {3.6653212440300965`*^9, 3.665321252154738*^9}, 
   3.671543784128191*^9, 3.671543848989176*^9, 3.671543907673562*^9, 
   3.6715440071545014`*^9, 3.6715440568337636`*^9, 3.671544115105481*^9, {
   3.6809501116255746`*^9, 3.6809501126976857`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"formatrule", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["XX_", 
      RowBox[{"z1_", ",", "z2_"}]], "\[Rule]", 
     RowBox[{"XX", "[", 
      RowBox[{"z1", ",", "z2"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ii", "=", "1"}], ",", 
    RowBox[{"ii", "\[LessEqual]", "110"}], ",", 
    RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{"ii", ",", "10"}], "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<ii=\>\"", ",", "ii"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     SubscriptBox["bft", "ii"], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"a", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b", "=", 
      RowBox[{"b", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"c", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"d", "=", 
      RowBox[{"d", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ii", "\[NotEqual]", "104"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"getNumberFaces", "[", 
             RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "=!=", 
            RowBox[{
             RowBox[{"getNumberInternalFaces", "[", 
              RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "+", 
             RowBox[{"getNumberExternalFaces", "[", 
              RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}]}], "||", 
           RowBox[{
            RowBox[{
             RowBox[{"getNumberFaces", "[", 
              RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "-", "1"}], 
            ">", 
            RowBox[{"dimensionPolytope", "[", 
             RowBox[{"matchingPolytope", "[", 
              RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}]}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<ii=\>\"", ",", "ii", ",", 
             "\"\< : There's a problem with counting faces!\>\""}], "]"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Sort", "[", 
         RowBox[{"getFaceLabels", "[", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}], "=!=", 
        RowBox[{"Sort", "[", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"getInternalFaceLabels", "[", 
            RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], ",", 
           RowBox[{"getExternalFaceLabels", "[", 
            RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], "]"}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<ii=\>\"", ",", "ii", ",", 
          "\"\< : There's a problem with the face labels! The internal and \
external face lables do not togehter form all face labels\>\""}], "]"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.665318171181672*^9, 3.665318202704878*^9}, {
   3.6653183216068077`*^9, 3.6653183520994596`*^9}, {3.66531839215139*^9, 
   3.6653184111501756`*^9}, 3.6653192263125267`*^9, 3.6653192607611127`*^9, {
   3.665319433827194*^9, 3.665319470875516*^9}, {3.6653197007946744`*^9, 
   3.6653197104984245`*^9}, {3.6653202255463314`*^9, 3.665320244858407*^9}, {
   3.6653207815004144`*^9, 3.6653208951053333`*^9}, {3.6653209452862015`*^9, 
   3.66532097842157*^9}, {3.66532114223064*^9, 3.6653212337458715`*^9}, {
   3.66704338130023*^9, 3.667043381503721*^9}, {3.667560141366789*^9, 
   3.6675601415969386`*^9}, {3.6675603398850255`*^9, 3.667560348658775*^9}, 
   3.671543674547016*^9, {3.671543784950934*^9, 3.671543785426484*^9}, 
   3.6715438498559732`*^9, 3.671543908815857*^9, 3.6715440083647585`*^9, 
   3.671544058191126*^9, 3.671544116103181*^9, 3.671545367012191*^9, {
   3.672739340205943*^9, 3.672739341088646*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "10"}],
  SequenceForm["ii=", 10],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66532123509547*^9, {3.6653213974793797`*^9, 3.665321399024411*^9}, 
   3.6654040074458055`*^9, {3.667043384169386*^9, 3.6670434128731833`*^9}, 
   3.667048728462846*^9, 3.6675601425375657`*^9, 3.6675603511957083`*^9, 
   3.6676263306780815`*^9, 3.66765541091658*^9, 3.6700418852842216`*^9, 
   3.672739351332258*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "20"}],
  SequenceForm["ii=", 20],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66532123509547*^9, {3.6653213974793797`*^9, 3.665321399024411*^9}, 
   3.6654040074458055`*^9, {3.667043384169386*^9, 3.6670434128731833`*^9}, 
   3.667048728462846*^9, 3.6675601425375657`*^9, 3.6675603511957083`*^9, 
   3.6676263306780815`*^9, 3.66765541091658*^9, 3.6700418852842216`*^9, 
   3.6727393515805445`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "30"}],
  SequenceForm["ii=", 30],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66532123509547*^9, {3.6653213974793797`*^9, 3.665321399024411*^9}, 
   3.6654040074458055`*^9, {3.667043384169386*^9, 3.6670434128731833`*^9}, 
   3.667048728462846*^9, 3.6675601425375657`*^9, 3.6675603511957083`*^9, 
   3.6676263306780815`*^9, 3.66765541091658*^9, 3.6700418852842216`*^9, 
   3.672739351884661*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "40"}],
  SequenceForm["ii=", 40],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66532123509547*^9, {3.6653213974793797`*^9, 3.665321399024411*^9}, 
   3.6654040074458055`*^9, {3.667043384169386*^9, 3.6670434128731833`*^9}, 
   3.667048728462846*^9, 3.6675601425375657`*^9, 3.6675603511957083`*^9, 
   3.6676263306780815`*^9, 3.66765541091658*^9, 3.6700418852842216`*^9, 
   3.6727393530389123`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "50"}],
  SequenceForm["ii=", 50],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66532123509547*^9, {3.6653213974793797`*^9, 3.665321399024411*^9}, 
   3.6654040074458055`*^9, {3.667043384169386*^9, 3.6670434128731833`*^9}, 
   3.667048728462846*^9, 3.6675601425375657`*^9, 3.6675603511957083`*^9, 
   3.6676263306780815`*^9, 3.66765541091658*^9, 3.6700418852842216`*^9, 
   3.6727393532519274`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "60"}],
  SequenceForm["ii=", 60],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66532123509547*^9, {3.6653213974793797`*^9, 3.665321399024411*^9}, 
   3.6654040074458055`*^9, {3.667043384169386*^9, 3.6670434128731833`*^9}, 
   3.667048728462846*^9, 3.6675601425375657`*^9, 3.6675603511957083`*^9, 
   3.6676263306780815`*^9, 3.66765541091658*^9, 3.6700418852842216`*^9, 
   3.672739353568365*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "70"}],
  SequenceForm["ii=", 70],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66532123509547*^9, {3.6653213974793797`*^9, 3.665321399024411*^9}, 
   3.6654040074458055`*^9, {3.667043384169386*^9, 3.6670434128731833`*^9}, 
   3.667048728462846*^9, 3.6675601425375657`*^9, 3.6675603511957083`*^9, 
   3.6676263306780815`*^9, 3.66765541091658*^9, 3.6700418852842216`*^9, 
   3.6727393538207364`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "80"}],
  SequenceForm["ii=", 80],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66532123509547*^9, {3.6653213974793797`*^9, 3.665321399024411*^9}, 
   3.6654040074458055`*^9, {3.667043384169386*^9, 3.6670434128731833`*^9}, 
   3.667048728462846*^9, 3.6675601425375657`*^9, 3.6675603511957083`*^9, 
   3.6676263306780815`*^9, 3.66765541091658*^9, 3.6700418852842216`*^9, 
   3.6727393540589566`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "90"}],
  SequenceForm["ii=", 90],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66532123509547*^9, {3.6653213974793797`*^9, 3.665321399024411*^9}, 
   3.6654040074458055`*^9, {3.667043384169386*^9, 3.6670434128731833`*^9}, 
   3.667048728462846*^9, 3.6675601425375657`*^9, 3.6675603511957083`*^9, 
   3.6676263306780815`*^9, 3.66765541091658*^9, 3.6700418852842216`*^9, 
   3.672739354239027*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "100"}],
  SequenceForm["ii=", 100],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66532123509547*^9, {3.6653213974793797`*^9, 3.665321399024411*^9}, 
   3.6654040074458055`*^9, {3.667043384169386*^9, 3.6670434128731833`*^9}, 
   3.667048728462846*^9, 3.6675601425375657`*^9, 3.6675603511957083`*^9, 
   3.6676263306780815`*^9, 3.66765541091658*^9, 3.6700418852842216`*^9, 
   3.6727393544419117`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "110"}],
  SequenceForm["ii=", 110],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66532123509547*^9, {3.6653213974793797`*^9, 3.665321399024411*^9}, 
   3.6654040074458055`*^9, {3.667043384169386*^9, 3.6670434128731833`*^9}, 
   3.667048728462846*^9, 3.6675601425375657`*^9, 3.6675603511957083`*^9, 
   3.6676263306780815`*^9, 3.66765541091658*^9, 3.6700418852842216`*^9, 
   3.6727393544981976`*^9}]
}, Closed]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6653210130698175`*^9, 3.6653210135071173`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "Here", " ", "we", " ", "check", " ", "turnIntoWeightedAdjacencyMatrix"}], 
   ",", " ", "turnIntoAdjacencyMatrix", ",", " ", "turnIntoGraph"}], 
  "*)"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653194611906705`*^9, 3.665319470875516*^9}, 
   3.665319696162837*^9, 3.665319923129767*^9, {3.66532084581382*^9, 
   3.6653208558484077`*^9}, 3.66532141327155*^9, 3.6653872607352314`*^9, {
   3.6653878723812013`*^9, 3.665387872807293*^9}, {3.6653882181571608`*^9, 
   3.665388220760619*^9}, 3.6715442581426005`*^9, 3.6715443316718774`*^9, 
   3.671544947366967*^9, {3.6809501175918083`*^9, 3.6809501177168145`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"formatrule", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["XX_", 
      RowBox[{"z1_", ",", "z2_"}]], "\[Rule]", 
     RowBox[{"XX", "[", 
      RowBox[{"z1", ",", "z2"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ii", "=", "1"}], ",", 
    RowBox[{"ii", "\[LessEqual]", "110"}], ",", 
    RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{"ii", ",", "10"}], "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<ii=\>\"", ",", "ii"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     SubscriptBox["bft", "ii"], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"a", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b", "=", 
      RowBox[{"b", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"c", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"d", "=", 
      RowBox[{"d", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"WeightedGraphQ", "[", 
          RowBox[{"WeightedAdjacencyGraph", "[", 
           RowBox[{"turnIntoWeightedAdjacencyMatrix", "[", 
            RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}], "]"}], 
         "\[Equal]", "False"}], "||", 
        RowBox[{
         RowBox[{"GraphQ", "[", 
          RowBox[{"AdjacencyGraph", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"turnIntoWeightedAdjacencyMatrix", "[", 
               RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "/.", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "\[Rule]", "1"}], "&"}], ",", 
                RowBox[{"Variables", "[", 
                 RowBox[{"Join", "[", 
                  RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}]}],
                "]"}]}], ")"}], "/.", 
            RowBox[{"{", 
             RowBox[{"\[Infinity]", "\[Rule]", "0"}], "}"}]}], "]"}], "]"}], 
         "\[Equal]", "False"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<ii=\>\"", ",", "ii", ",", 
          "\"\< : There's a problem with the Weighted adjacency matrix! It \
does not form a valid weighted graph\>\""}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Dimensions", "[", 
         RowBox[{"turnIntoWeightedAdjacencyMatrix", "[", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}], "=!=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Total", "[", 
           RowBox[{"Dimensions", "[", 
            RowBox[{"joinupKasteleyn", "[", 
             RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}], "]"}],
           ",", 
          RowBox[{"Total", "[", 
           RowBox[{"Dimensions", "[", 
            RowBox[{"joinupKasteleyn", "[", 
             RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}], 
           "]"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<ii=\>\"", ",", "ii", ",", 
          "\"\< : There's a problem with the Weighted adjacency matrix! Its \
size is wrong\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"GraphQ", "[", 
         RowBox[{"AdjacencyGraph", "[", 
          RowBox[{"turnIntoAdjacencyMatrix", "[", 
           RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}], "]"}], 
        "\[Equal]", "False"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<ii=\>\"", ",", "ii", ",", 
          "\"\< : There's a problem with the normal adjacency matrix! It does \
not form a valid graph\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Dimensions", "[", 
         RowBox[{"turnIntoAdjacencyMatrix", "[", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}], "=!=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Total", "[", 
           RowBox[{"Dimensions", "[", 
            RowBox[{"joinupKasteleyn", "[", 
             RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}], "]"}],
           ",", 
          RowBox[{"Total", "[", 
           RowBox[{"Dimensions", "[", 
            RowBox[{"joinupKasteleyn", "[", 
             RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}], 
           "]"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<ii=\>\"", ",", "ii", ",", 
          "\"\< : There's a problem with the normal adjacency matrix! Its \
size is wrong\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"turnIntoWeightedAdjacencyMatrix", "[", 
             RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "/.", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "\[Rule]", "1"}], "&"}], ",", 
              RowBox[{"Variables", "[", 
               RowBox[{"Join", "[", 
                RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}]}], 
             "]"}]}], ")"}], "/.", 
          RowBox[{"{", 
           RowBox[{"\[Infinity]", "\[Rule]", "0"}], "}"}]}], ")"}], "=!=", 
        RowBox[{"turnIntoAdjacencyMatrix", "[", 
         RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<ii=\>\"", ",", "ii", ",", 
          "\"\< : There's a problem with the adjacency matrices! \
turnIntoWeightedAdjacencyMatrix doesn't correspond to turnIntoAdjacencyMatrix\
\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"graphwithedges", "=", 
      RowBox[{"turnIntoGraph", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"graphnoedges", "=", 
      RowBox[{"turnIntoGraph", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "False"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"GraphQ", "[", "graphwithedges", "]"}], "\[Equal]", 
         "False"}], "||", 
        RowBox[{
         RowBox[{"GraphQ", "[", "graphnoedges", "]"}], "\[Equal]", 
         "False"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<ii=\>\"", ",", "ii", ",", 
          "\"\< : There's a problem with turnIntoGraph! It doesn't produce a \
valid graph\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.665318171181672*^9, 3.665318202704878*^9}, {
   3.6653183216068077`*^9, 3.6653183520994596`*^9}, {3.66531839215139*^9, 
   3.6653184111501756`*^9}, 3.6653192263125267`*^9, 3.6653192607611127`*^9, {
   3.665319433827194*^9, 3.665319470875516*^9}, {3.6653197007946744`*^9, 
   3.6653197104984245`*^9}, {3.6653202255463314`*^9, 3.665320244858407*^9}, {
   3.6653207815004144`*^9, 3.6653208951053333`*^9}, {3.6653209452862015`*^9, 
   3.66532097842157*^9}, {3.6653210227354336`*^9, 3.6653211041830716`*^9}, {
   3.665321718658688*^9, 3.6653217820570545`*^9}, {3.6653218590977*^9, 
   3.665321920578185*^9}, {3.665322195244587*^9, 3.6653222033328075`*^9}, {
   3.6653223748763256`*^9, 3.6653224330165462`*^9}, {3.66532322955106*^9, 
   3.6653232390476637`*^9}, {3.6653238225077314`*^9, 3.665323879242934*^9}, {
   3.6653239159845405`*^9, 3.665324034040783*^9}, {3.6653257558168*^9, 
   3.6653257558748393`*^9}, 3.6653807684593163`*^9, 3.665382653447832*^9, {
   3.665382822865073*^9, 3.6653828563613834`*^9}, {3.665387578430645*^9, 
   3.6653876417433176`*^9}, {3.665387772827407*^9, 3.6653879319324636`*^9}, {
   3.665387975013636*^9, 3.6653880124958487`*^9}, {3.6653881161778917`*^9, 
   3.665388203398225*^9}, {3.665389094042616*^9, 3.665389094355131*^9}, {
   3.667043448778773*^9, 3.6670434490756645`*^9}, {3.6675603663022327`*^9, 
   3.6675603665173693`*^9}, {3.6715442597027664`*^9, 
   3.6715442629827957`*^9}, {3.6715443325015583`*^9, 3.67154433547572*^9}, {
   3.6715449485261765`*^9, 3.6715449501358657`*^9}, {3.6727393679353647`*^9, 
   3.672739384812338*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "110"}],
  SequenceForm["ii=", 110],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653238229370146`*^9, 3.6653238337534237`*^9}, 
   3.6653240430750847`*^9, 3.6653255613453426`*^9, 3.665325690274911*^9, 
   3.665325760656021*^9, 3.6653807692562304`*^9, 3.6653826542134953`*^9, 
   3.6653828427383046`*^9, 3.6653828787990274`*^9, 3.6653875860924587`*^9, 
   3.665387643643139*^9, 3.665387858861128*^9, 3.6653879341762657`*^9, 
   3.665388015732458*^9, 3.665388204578836*^9, 3.6654040093145647`*^9, {
   3.6670434436980658`*^9, 3.6670434494663897`*^9}, 3.6675603671464334`*^9, 
   3.6676263311480193`*^9, 3.667655414161992*^9, 3.6700418858465967`*^9, 
   3.6727393772686996`*^9}]
}, Closed]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.665318117879394*^9, 3.665318118113784*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Here", " ", "we", " ", "check", " ", "getDuplicateEdges"}], ",", 
   " ", "getEdgesBFTformQ"}], "*)"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653194611906705`*^9, 3.665319470875516*^9}, 
   3.665319696162837*^9, 3.665319923129767*^9, {3.66532084581382*^9, 
   3.6653208558484077`*^9}, 3.66532141327155*^9, 3.6653872607352314`*^9, {
   3.6653878723812013`*^9, 3.665387872807293*^9}, {3.6653882181571608`*^9, 
   3.665388220760619*^9}, {3.6653886771674967`*^9, 3.665388699256188*^9}, {
   3.6678226270810423`*^9, 3.667822627518563*^9}, 3.6715450076443825`*^9, 
   3.671545061955488*^9, {3.671688643504425*^9, 3.6716886441921606`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"formatrule", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["XX_", 
      RowBox[{"z1_", ",", "z2_"}]], "\[Rule]", 
     RowBox[{"XX", "[", 
      RowBox[{"z1", ",", "z2"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ii", "=", "1"}], ",", 
    RowBox[{"ii", "\[LessEqual]", "110"}], ",", 
    RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{"ii", ",", "10"}], "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<ii=\>\"", ",", "ii"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     SubscriptBox["bft", "ii"], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"getEdgesBFTformQ", "[", 
        RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<ii=\>\"", ",", "ii", ",", 
          "\"\< : There's a problem with getEdgesBFTformQ! It doesn't \
complain even when all the edges are \!\(\*SubscriptBox[\(X\), \(i, j\)]\) \
rather than X[i,j]\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"a", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b", "=", 
      RowBox[{"b", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"c", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"d", "=", 
      RowBox[{"d", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"messuprule", "=", 
      RowBox[{
       RowBox[{"Last", "[", 
        RowBox[{"Variables", "[", 
         RowBox[{"Join", "[", 
          RowBox[{"a", ",", "b", ",", "c"}], "]"}], "]"}], "]"}], "\[Rule]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Last", "[", 
          RowBox[{"Variables", "[", 
           RowBox[{"Join", "[", 
            RowBox[{"a", ",", "b", ",", "c"}], "]"}], "]"}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"xx_", "[", 
            RowBox[{"z1_", ",", "z2_"}], "]"}], "\[Rule]", 
           SubscriptBox["xx", 
            RowBox[{"z2", ",", "z2"}]]}], "}"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"getEdgesBFTformQ", "[", 
        RowBox[{
         RowBox[{"a", "/.", "messuprule"}], ",", 
         RowBox[{"b", "/.", "messuprule"}], ",", 
         RowBox[{"c", "/.", "messuprule"}], ",", 
         RowBox[{"d", "/.", "messuprule"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<ii=\>\"", ",", "ii", ",", 
          "\"\< : There's a problem with getEdgesBFTformQ! It doesn't \
complain even when an edge is \!\(\*SubscriptBox[\(X\), \(i, j\)]\) rather \
than X[i,j]\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"getEdgesBFTformQ", "[", 
         RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "\[Equal]", 
        "False"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<ii=\>\"", ",", "ii", ",", 
          "\"\< : There's a problem with getEdgesBFTformQ! It complains even \
though all the edges are of the form X[i,j]\>\""}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"getDuplicateEdges", "[", 
         RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "=!=", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<ii=\>\"", ",", "ii", ",", 
          "\"\< : There's a problem with getDuplicateEdges! It claims we have \
duplicate edges in this Kastelen\>\""}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"duplicatingrule", "=", 
      RowBox[{
       RowBox[{"First", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Variables", "[", "b", "]"}], ",", 
          RowBox[{"Variables", "[", "c", "]"}], ",", 
          RowBox[{"Variables", "[", "a", "]"}]}], "]"}], "]"}], "\[Rule]", 
       RowBox[{"Last", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Variables", "[", "b", "]"}], ",", 
          RowBox[{"Variables", "[", "c", "]"}], ",", 
          RowBox[{"Variables", "[", "a", "]"}]}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"getDuplicateEdges", "[", 
         RowBox[{
          RowBox[{"a", "/.", "duplicatingrule"}], ",", 
          RowBox[{"b", "/.", "duplicatingrule"}], ",", 
          RowBox[{"c", "/.", "duplicatingrule"}], ",", 
          RowBox[{"d", "/.", "duplicatingrule"}]}], "]"}], "=!=", 
        RowBox[{"{", 
         RowBox[{"Last", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"Variables", "[", "b", "]"}], ",", 
            RowBox[{"Variables", "[", "c", "]"}], ",", 
            RowBox[{"Variables", "[", "a", "]"}]}], "]"}], "]"}], "}"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<ii=\>\"", ",", "ii", ",", 
          "\"\< : There's a problem with getDuplicateEdges! It doesn't spot a \
duplicated edge\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"duplicatingrule", "=", 
      RowBox[{
       RowBox[{"First", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Variables", "[", "b", "]"}], ",", 
          RowBox[{"Variables", "[", "c", "]"}], ",", 
          RowBox[{"Variables", "[", "a", "]"}]}], "]"}], "]"}], "\[Rule]", 
       RowBox[{"Last", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Variables", "[", "b", "]"}], ",", 
          RowBox[{"Variables", "[", "a", "]"}], ",", 
          RowBox[{"Variables", "[", "c", "]"}]}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"getDuplicateEdges", "[", 
          RowBox[{
           RowBox[{"a", "/.", "duplicatingrule"}], ",", 
           RowBox[{"b", "/.", "duplicatingrule"}], ",", 
           RowBox[{"c", "/.", "duplicatingrule"}], ",", 
           RowBox[{"d", "/.", "duplicatingrule"}]}], "]"}], "=!=", 
         RowBox[{"{", 
          RowBox[{"Last", "[", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"Variables", "[", "b", "]"}], ",", 
             RowBox[{"Variables", "[", "a", "]"}], ",", 
             RowBox[{"Variables", "[", "c", "]"}]}], "]"}], "]"}], "}"}]}], "&&", 
        RowBox[{
         RowBox[{"duplicatingrule", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "=!=", 
         RowBox[{"duplicatingrule", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<ii=\>\"", ",", "ii", ",", 
          "\"\< : There's a problem with getDuplicateEdges! It doesn't spot a \
duplicated edge\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"getKasteleynConsistencyViolation", "[", 
         RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "=!=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "}"}], ",", 
          RowBox[{"{", "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<ii=\>\"", ",", "ii", ",", 
          "\"\< : There's a problem with getKasteleynConsistencyViolation! \
It's finding problems where there are none, by claimimng some rows or columns \
don't have the right cyclic structure\>\""}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"getKasteleynConsistencyViolation", "[", 
         RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "=!=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "}"}], ",", 
          RowBox[{"{", "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<ii=\>\"", ",", "ii", ",", 
          "\"\< : There's a problem with getKasteleynConsistencyViolation! \
It's finding problems where there are none, by claimimng some rows or columns \
don't have the right cyclic structure\>\""}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"messuprule", "=", 
      RowBox[{
       RowBox[{"First", "[", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{
          RowBox[{"Variables", "[", "a", "]"}], ",", 
          RowBox[{"zz_", "/;", 
           RowBox[{
            RowBox[{"zz", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
            RowBox[{"zz", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}]}], "]"}], "]"}], "\[Rule]", 
       RowBox[{
        RowBox[{"First", "[", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{
           RowBox[{"Variables", "[", "a", "]"}], ",", 
           RowBox[{"zz_", "/;", 
            RowBox[{
             RowBox[{"zz", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
             RowBox[{"zz", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}]}], "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"{", 
          RowBox[{"2", ",", "1"}], "}"}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Total", "[", 
         RowBox[{"Map", "[", 
          RowBox[{"Length", ",", 
           RowBox[{"getKasteleynConsistencyViolation", "[", 
            RowBox[{
             RowBox[{"a", "/.", "messuprule"}], ",", 
             RowBox[{"b", "/.", "messuprule"}], ",", 
             RowBox[{"c", "/.", "messuprule"}], ",", 
             RowBox[{"d", "/.", "messuprule"}]}], "]"}]}], "]"}], "]"}], 
        "\[LessEqual]", "1"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<ii=\>\"", ",", "ii", ",", 
          "\"\< : There's a problem with getKasteleynConsistencyViolation! \
It's finding problems where there are none, by claimimng some rows or columns \
don't have the right cyclic structure\>\""}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"getKasteleynCheckQ", "[", 
         RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "False"}], "]"}], 
        "\[Equal]", "False"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<ii=\>\"", ",", "ii", ",", 
          "\"\< : There's a problem with getKasteleynCheckQ! It claims there \
are duplicate edges in the Kasteleyn\>\""}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"getKasteleynCheckQ", "[", 
         RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "True"}], "]"}], 
        "\[Equal]", "False"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<ii=\>\"", ",", "ii", ",", 
          "\"\< : There's a problem with getKasteleynCheckQ! It claims \
there's something wrong with the Kasteleyn\>\""}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.665318171181672*^9, 3.665318202704878*^9}, {
   3.6653183216068077`*^9, 3.6653183520994596`*^9}, {3.66531839215139*^9, 
   3.6653184111501756`*^9}, 3.6653192263125267`*^9, 3.6653192607611127`*^9, {
   3.665319433827194*^9, 3.665319470875516*^9}, {3.6653197007946744`*^9, 
   3.6653197104984245`*^9}, {3.6653202255463314`*^9, 3.665320244858407*^9}, {
   3.6653207815004144`*^9, 3.6653208951053333`*^9}, {3.6653209452862015`*^9, 
   3.66532097842157*^9}, {3.6653210227354336`*^9, 3.6653211041830716`*^9}, {
   3.665321718658688*^9, 3.6653217820570545`*^9}, {3.6653218590977*^9, 
   3.665321920578185*^9}, {3.665322195244587*^9, 3.6653222033328075`*^9}, {
   3.6653223748763256`*^9, 3.6653224330165462`*^9}, {3.66532322955106*^9, 
   3.6653232390476637`*^9}, {3.6653238225077314`*^9, 3.665323879242934*^9}, {
   3.6653239159845405`*^9, 3.665324034040783*^9}, {3.6653257558168*^9, 
   3.6653257558748393`*^9}, 3.6653807684593163`*^9, 3.665382653447832*^9, {
   3.665382822865073*^9, 3.6653828563613834`*^9}, {3.665387578430645*^9, 
   3.6653876417433176`*^9}, {3.665387772827407*^9, 3.6653879319324636`*^9}, {
   3.665387975013636*^9, 3.6653880124958487`*^9}, {3.6653881161778917`*^9, 
   3.665388203398225*^9}, {3.665388418670115*^9, 3.6653884602207074`*^9}, {
   3.6653885272304087`*^9, 3.665388540956611*^9}, {3.6653885991701355`*^9, 
   3.6653886322947865`*^9}, {3.6653887029314117`*^9, 3.665388703056418*^9}, {
   3.665389018738357*^9, 3.665389158046074*^9}, {3.665389284500309*^9, 
   3.665389339919886*^9}, {3.6653897666302986`*^9, 3.6653898363558693`*^9}, {
   3.665389910163226*^9, 3.665389961631102*^9}, {3.6653901380930347`*^9, 
   3.665390149511369*^9}, {3.665390300980686*^9, 3.6653903028178134`*^9}, {
   3.6653903445906506`*^9, 3.6653904473908606`*^9}, {3.6670434574917946`*^9, 
   3.667043457703743*^9}, {3.6675609968727713`*^9, 3.66756099709518*^9}, {
   3.6715450084755116`*^9, 3.671545013715763*^9}, {3.6715450631328487`*^9, 
   3.6715450665887213`*^9}, {3.67154515713484*^9, 3.6715451608887157`*^9}, {
   3.671545281843939*^9, 3.671545285303831*^9}, {3.6727393918970795`*^9, 
   3.6727393939467916`*^9}, {3.6727399563446302`*^9, 3.6727399754430747`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "110"}],
  SequenceForm["ii=", 110],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653238229370146`*^9, 3.6653238337534237`*^9}, 
   3.6653240430750847`*^9, 3.6653255613453426`*^9, 3.665325690274911*^9, 
   3.665325760656021*^9, 3.6653807692562304`*^9, 3.6653826542134953`*^9, 
   3.6653828427383046`*^9, 3.6653828787990274`*^9, 3.6653875860924587`*^9, 
   3.665387643643139*^9, 3.665387858861128*^9, 3.6653879341762657`*^9, 
   3.665388015732458*^9, 3.665388204578836*^9, 3.6653884546726146`*^9, 
   3.6653886335070763`*^9, {3.665389077683243*^9, 3.6653890863215904`*^9}, 
   3.6653891608201995`*^9, 3.6653893405836864`*^9, 3.665389828029312*^9, 
   3.665390153071544*^9, 3.6653903041460037`*^9, 3.6653904769110584`*^9, 
   3.6654040114320126`*^9, 3.6670434591569376`*^9, 3.667560998637205*^9, 
   3.6676263333532267`*^9, 3.6676554163143244`*^9, 3.670041888354856*^9, 
   3.6727393957635565`*^9, 3.6727399715592184`*^9}]
}, Closed]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.665318117879394*^9, 3.665318118113784*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Here", " ", "we", " ", "check", " ", "perfectMatchings"}], ",", 
   " ", "matchingPolytope"}], "*)"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653194611906705`*^9, 3.665319470875516*^9}, 
   3.665319696162837*^9, 3.665319923129767*^9, {3.66532084581382*^9, 
   3.6653208558484077`*^9}, 3.66532141327155*^9, 3.6653872607352314`*^9, {
   3.6653878723812013`*^9, 3.665387872807293*^9}, {3.6653882181571608`*^9, 
   3.665388220760619*^9}, {3.6653886771674967`*^9, 3.665388699256188*^9}, {
   3.665394491044639*^9, 3.6653944995239697`*^9}, {3.6653959126545773`*^9, 
   3.6653959187590914`*^9}, 3.6715453677008524`*^9, {3.672749981361431*^9, 
   3.6727499814444113`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"formatrule", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["XX_", 
      RowBox[{"z1_", ",", "z2_"}]], "\[Rule]", 
     RowBox[{"XX", "[", 
      RowBox[{"z1", ",", "z2"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ii", "=", "1"}], ",", 
    RowBox[{"ii", "\[LessEqual]", "110"}], ",", 
    RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{"ii", ",", "10"}], "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<ii=\>\"", ",", "ii"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     SubscriptBox["bft", "ii"], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"a", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b", "=", 
      RowBox[{"b", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"c", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"d", "=", 
      RowBox[{"d", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"perfs", "=", 
      RowBox[{"perfectMatchings", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"matroidpoly", "=", 
      RowBox[{"matroidPolytope", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"moduligauging1", "=", 
      RowBox[{"moduliSpaceBFT", "[", 
       RowBox[{
       "a", ",", "b", ",", "c", ",", "d", ",", "1", ",", "False", ",", 
        "True"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"moduligauging2", "=", 
      RowBox[{"moduliSpaceBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "2"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"loopvarsgauging1", "=", 
      RowBox[{"loopVariablesBasis", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "True"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"loopvarsgauging2", "=", 
      RowBox[{"loopVariablesBasis", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "False"}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Dimensions", "[", "matroidpoly", "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], "=!=", 
        RowBox[{"Length", "[", "perfs", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<ii=\>\"", ",", "ii", ",", 
          "\"\< : There's a problem with the matroid polytope! Its number of \
columns is not equal to the number of perfect matchings\>\""}], "]"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ii", "\[NotEqual]", "104"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "106"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "107"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "110"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dimensionPolytope", "[", "matroidpoly", "]"}], "=!=", 
           RowBox[{"Length", "[", 
            RowBox[{"loopvarsgauging2", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<ii=\>\"", ",", "ii", ",", 
             
             "\"\< : There's a problem with the matroid polytope! Its \
dimension does not correspond to that obtained from the loop variable basis\>\
\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ii", "\[Equal]", "104"}], "&&", 
           RowBox[{
            RowBox[{"dimensionPolytope", "[", "matroidpoly", "]"}], "=!=", 
            "0"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<ii=\>\"", ",", "ii", ",", 
             "\"\< : There's a problem with the matroid polytope! Its \
dimension isn't correct\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"moduligauging2", "=!=", "matroidpoly"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<ii=\>\"", ",", "ii", ",", 
          "\"\< : There's a problem with the moduli space Gauging 2! It's not \
equal to the matroid polytope\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Dimensions", "[", "moduligauging1", "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], "=!=", 
        RowBox[{"Length", "[", "perfs", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<ii=\>\"", ",", "ii", ",", 
          "\"\< : There's a problem with the moduli space Gauging 1! Its \
number of columns is not equal to the number of perfect matchings\>\""}], 
         "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ii", "\[NotEqual]", "104"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "106"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "107"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "110"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dimensionPolytope", "[", "moduligauging1", "]"}], "=!=", 
           RowBox[{"Length", "[", 
            RowBox[{"loopvarsgauging1", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<ii=\>\"", ",", "ii", ",", 
             "\"\< : There's a problem with the moduli space Gauging 1! Its \
dimension dows not correspond to that obtained from the loop variable basis\>\
\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ii", "\[Equal]", "104"}], "&&", 
           RowBox[{
            RowBox[{"dimensionPolytope", "[", "moduligauging1", "]"}], "=!=", 
            "0"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<ii=\>\"", ",", "ii", ",", 
             "\"\< : There's a problem with the matroid polytope! Its \
dimension isn't correct\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"dim", "=", 
      RowBox[{"dimensionPolytope", "[", "moduligauging2", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ii", "\[NotEqual]", "104"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "106"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "107"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "110"}], "&&", 
        RowBox[{"dim", "=!=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"Variables", "[", 
               RowBox[{"Join", "[", 
                RowBox[{"b", ",", "c"}], "]"}], "]"}], "]"}], "-", 
             RowBox[{"Length", "[", 
              RowBox[{"DeleteCases", "[", 
               RowBox[{
                RowBox[{"ConnectedComponents", "[", 
                 RowBox[{"AdjacencyGraph", "[", 
                  RowBox[{"turnIntoAdjacencyMatrix", "[", 
                   RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}], 
                 "]"}], ",", 
                RowBox[{"Alternatives", "@@", 
                 RowBox[{"Transpose", "[", 
                  RowBox[{"{", 
                   RowBox[{"getOrderingExternalNodesDefault", "[", 
                    RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "}"}],
                   "]"}]}]}], "]"}], "]"}]}], ")"}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], "\[Rule]", "0"}], "}"}]}], ")"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<ii=\>\"", ",", "ii", ",", 
          "\"\< : There's a problem with dimensionPolytope!\>\""}], "]"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ii", "\[NotEqual]", "104"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{
             RowBox[{"turnIntoPolytope", "[", "matroidpoly", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}], ">", 
           RowBox[{"Length", "[", 
            RowBox[{"Subsets", "[", 
             RowBox[{
              RowBox[{"Range", "[", 
               RowBox[{
                RowBox[{"Length", "[", "c", "]"}], "+", 
                RowBox[{
                 RowBox[{"Dimensions", "[", "b", "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"Length", "[", 
                RowBox[{"getSourceEdges", "[", 
                 RowBox[{"b", ",", "c", ",", 
                  RowBox[{"perfs", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "}"}]}], 
             "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<ii=\>\"", ",", "ii", ",", 
             "\"\< : There's a problem with turnIntoPolytope! It claims that \
the matroid polytope has more points than Plucker coordinates\>\""}], "]"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Total", "[", 
            RowBox[{
             RowBox[{"turnIntoPolytope", "[", "matroidpoly", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}], "=!=", 
           RowBox[{
            RowBox[{"Dimensions", "[", "matroidpoly", "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<ii=\>\"", ",", "ii", ",", 
             "\"\< : There's a problem with turnIntoPolytope! The sum of \
multiplicities does not equal the number of point!\>\""}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"FreeQ", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Transpose", "[", 
              RowBox[{
               RowBox[{"turnIntoPolytope", "[", "matroidpoly", "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"Position", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"turnIntoPolytope", "[", "matroidpoly", "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                 RowBox[{"Min", "[", 
                  RowBox[{
                   RowBox[{"turnIntoPolytope", "[", "matroidpoly", "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}], "]"}], 
              "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"Transpose", "[", "matroidpoly", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"lowNumberLoopsPMpos", "[", 
               RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}], 
             "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<ii=\>\"", ",", "ii", ",", 
             "\"\< : There's a problem with lowNumberLoopsPMpos! It's not \
selecting the lowest possible number of loops\>\""}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Total", "[", 
            RowBox[{
             RowBox[{"turnIntoPolytope", "[", "moduligauging1", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}], "=!=", 
           RowBox[{
            RowBox[{"Dimensions", "[", "moduligauging1", "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<ii=\>\"", ",", "ii", ",", 
             "\"\< : There's a problem with the moduli space Gauging 1! The \
sum of multiplicities does not equal the number of point!\>\""}], "]"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Total", "[", 
            RowBox[{
             RowBox[{"turnIntoPolytope", "[", "moduligauging2", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}], "=!=", 
           RowBox[{
            RowBox[{"Dimensions", "[", "moduligauging2", "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<ii=\>\"", ",", "ii", ",", 
             "\"\< : There's a problem with the moduli space Gauging 2! The \
sum of multiplicities does not equal the number of point!\>\""}], "]"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.665318171181672*^9, 3.665318202704878*^9}, {
   3.6653183216068077`*^9, 3.6653183520994596`*^9}, {3.66531839215139*^9, 
   3.6653184111501756`*^9}, 3.6653192263125267`*^9, 3.6653192607611127`*^9, {
   3.665319433827194*^9, 3.665319470875516*^9}, {3.6653197007946744`*^9, 
   3.6653197104984245`*^9}, {3.6653202255463314`*^9, 3.665320244858407*^9}, {
   3.6653207815004144`*^9, 3.6653208951053333`*^9}, {3.6653209452862015`*^9, 
   3.66532097842157*^9}, {3.6653210227354336`*^9, 3.6653211041830716`*^9}, {
   3.665321718658688*^9, 3.6653217820570545`*^9}, {3.6653218590977*^9, 
   3.665321920578185*^9}, {3.665322195244587*^9, 3.6653222033328075`*^9}, {
   3.6653223748763256`*^9, 3.6653224330165462`*^9}, {3.66532322955106*^9, 
   3.6653232390476637`*^9}, {3.6653238225077314`*^9, 3.665323879242934*^9}, {
   3.6653239159845405`*^9, 3.665324034040783*^9}, {3.6653257558168*^9, 
   3.6653257558748393`*^9}, 3.6653807684593163`*^9, 3.665382653447832*^9, {
   3.665382822865073*^9, 3.6653828563613834`*^9}, {3.665387578430645*^9, 
   3.6653876417433176`*^9}, {3.665387772827407*^9, 3.6653879319324636`*^9}, {
   3.665387975013636*^9, 3.6653880124958487`*^9}, {3.6653881161778917`*^9, 
   3.665388203398225*^9}, {3.665388418670115*^9, 3.6653884602207074`*^9}, {
   3.6653885272304087`*^9, 3.665388540956611*^9}, {3.6653885991701355`*^9, 
   3.6653886322947865`*^9}, {3.6653887029314117`*^9, 3.665388703056418*^9}, {
   3.665389018738357*^9, 3.665389158046074*^9}, {3.665389284500309*^9, 
   3.665389339919886*^9}, {3.6653897666302986`*^9, 3.6653898363558693`*^9}, {
   3.665389910163226*^9, 3.665389961631102*^9}, {3.6653901380930347`*^9, 
   3.665390149511369*^9}, {3.665390300980686*^9, 3.6653903028178134`*^9}, {
   3.6653903445906506`*^9, 3.6653904473908606`*^9}, {3.6653945222132363`*^9, 
   3.6653945445009356`*^9}, 3.665394584118007*^9, {3.665394640528449*^9, 
   3.6653946583592005`*^9}, {3.665394756936673*^9, 3.665394939098732*^9}, {
   3.6653949871547394`*^9, 3.665394996124837*^9}, {3.6653950323304377`*^9, 
   3.6653951271812873`*^9}, {3.6653951719081173`*^9, 
   3.6653952161041775`*^9}, {3.6653952920676613`*^9, 
   3.6653953916260896`*^9}, {3.665395727510127*^9, 3.665395790959216*^9}, {
   3.665395874423108*^9, 3.6653958840790167`*^9}, {3.667043472896695*^9, 
   3.6670434732248583`*^9}, {3.667561011069772*^9, 3.6675610331953616`*^9}, {
   3.6675683705643673`*^9, 3.667568372444744*^9}, 3.6676533331215067`*^9, {
   3.6715436771272993`*^9, 3.671543681137492*^9}, 3.6715443363915234`*^9, {
   3.671545425662253*^9, 3.671545432037966*^9}, {3.6715455210817585`*^9, 
   3.6715455226717453`*^9}, 3.6715457983370934`*^9, 3.671545831968717*^9, {
   3.671687653202075*^9, 3.671687653879326*^9}, {3.6727399887330008`*^9, 
   3.672739990697439*^9}, {3.6727421263550673`*^9, 3.672742168143506*^9}, {
   3.6727422146222696`*^9, 3.6727423194137597`*^9}, 3.672742420889721*^9, {
   3.672742542057129*^9, 3.6727426039915247`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "10"}],
  SequenceForm["ii=", 10],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653238229370146`*^9, 3.6653238337534237`*^9}, 
   3.6653240430750847`*^9, 3.6653255613453426`*^9, 3.665325690274911*^9, 
   3.665325760656021*^9, 3.6653807692562304`*^9, 3.6653826542134953`*^9, 
   3.6653828427383046`*^9, 3.6653828787990274`*^9, 3.6653875860924587`*^9, 
   3.665387643643139*^9, 3.665387858861128*^9, 3.6653879341762657`*^9, 
   3.665388015732458*^9, 3.665388204578836*^9, 3.6653884546726146`*^9, 
   3.6653886335070763`*^9, {3.665389077683243*^9, 3.6653890863215904`*^9}, 
   3.6653891608201995`*^9, 3.6653893405836864`*^9, 3.665389828029312*^9, 
   3.665390153071544*^9, 3.6653903041460037`*^9, 3.6653904769110584`*^9, 
   3.6653945455791197`*^9, {3.665394631729479*^9, 3.665394659077984*^9}, {
   3.665394843806135*^9, 3.6653948508347178`*^9}, 3.665394939575779*^9, 
   3.6653949972498903`*^9, 3.6653951280720367`*^9, {3.665395224391192*^9, 
   3.665395232872293*^9}, 3.665395344222473*^9, 3.6653953921729913`*^9, {
   3.665395766562704*^9, 3.6653957935400486`*^9}, 3.665395885541156*^9, 
   3.6654040144814234`*^9, {3.667043466040807*^9, 3.6670434737493677`*^9}, {
   3.667561023997614*^9, 3.6675610352134266`*^9}, 3.667568379234228*^9, 
   3.6676263365603437`*^9, 3.6676554194593363`*^9, 3.6700418919697704`*^9, 
   3.672739991147246*^9, {3.6727422161821995`*^9, 3.67274229128926*^9}, 
   3.672742334144391*^9, 3.672742421343337*^9, {3.6727425700251513`*^9, 
   3.6727426056765957`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "20"}],
  SequenceForm["ii=", 20],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653238229370146`*^9, 3.6653238337534237`*^9}, 
   3.6653240430750847`*^9, 3.6653255613453426`*^9, 3.665325690274911*^9, 
   3.665325760656021*^9, 3.6653807692562304`*^9, 3.6653826542134953`*^9, 
   3.6653828427383046`*^9, 3.6653828787990274`*^9, 3.6653875860924587`*^9, 
   3.665387643643139*^9, 3.665387858861128*^9, 3.6653879341762657`*^9, 
   3.665388015732458*^9, 3.665388204578836*^9, 3.6653884546726146`*^9, 
   3.6653886335070763`*^9, {3.665389077683243*^9, 3.6653890863215904`*^9}, 
   3.6653891608201995`*^9, 3.6653893405836864`*^9, 3.665389828029312*^9, 
   3.665390153071544*^9, 3.6653903041460037`*^9, 3.6653904769110584`*^9, 
   3.6653945455791197`*^9, {3.665394631729479*^9, 3.665394659077984*^9}, {
   3.665394843806135*^9, 3.6653948508347178`*^9}, 3.665394939575779*^9, 
   3.6653949972498903`*^9, 3.6653951280720367`*^9, {3.665395224391192*^9, 
   3.665395232872293*^9}, 3.665395344222473*^9, 3.6653953921729913`*^9, {
   3.665395766562704*^9, 3.6653957935400486`*^9}, 3.665395885541156*^9, 
   3.6654040144814234`*^9, {3.667043466040807*^9, 3.6670434737493677`*^9}, {
   3.667561023997614*^9, 3.6675610352134266`*^9}, 3.667568379234228*^9, 
   3.6676263365603437`*^9, 3.6676554194593363`*^9, 3.6700418919697704`*^9, 
   3.672739991147246*^9, {3.6727422161821995`*^9, 3.67274229128926*^9}, 
   3.672742334144391*^9, 3.672742421343337*^9, {3.6727425700251513`*^9, 
   3.6727426065004053`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "30"}],
  SequenceForm["ii=", 30],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653238229370146`*^9, 3.6653238337534237`*^9}, 
   3.6653240430750847`*^9, 3.6653255613453426`*^9, 3.665325690274911*^9, 
   3.665325760656021*^9, 3.6653807692562304`*^9, 3.6653826542134953`*^9, 
   3.6653828427383046`*^9, 3.6653828787990274`*^9, 3.6653875860924587`*^9, 
   3.665387643643139*^9, 3.665387858861128*^9, 3.6653879341762657`*^9, 
   3.665388015732458*^9, 3.665388204578836*^9, 3.6653884546726146`*^9, 
   3.6653886335070763`*^9, {3.665389077683243*^9, 3.6653890863215904`*^9}, 
   3.6653891608201995`*^9, 3.6653893405836864`*^9, 3.665389828029312*^9, 
   3.665390153071544*^9, 3.6653903041460037`*^9, 3.6653904769110584`*^9, 
   3.6653945455791197`*^9, {3.665394631729479*^9, 3.665394659077984*^9}, {
   3.665394843806135*^9, 3.6653948508347178`*^9}, 3.665394939575779*^9, 
   3.6653949972498903`*^9, 3.6653951280720367`*^9, {3.665395224391192*^9, 
   3.665395232872293*^9}, 3.665395344222473*^9, 3.6653953921729913`*^9, {
   3.665395766562704*^9, 3.6653957935400486`*^9}, 3.665395885541156*^9, 
   3.6654040144814234`*^9, {3.667043466040807*^9, 3.6670434737493677`*^9}, {
   3.667561023997614*^9, 3.6675610352134266`*^9}, 3.667568379234228*^9, 
   3.6676263365603437`*^9, 3.6676554194593363`*^9, 3.6700418919697704`*^9, 
   3.672739991147246*^9, {3.6727422161821995`*^9, 3.67274229128926*^9}, 
   3.672742334144391*^9, 3.672742421343337*^9, {3.6727425700251513`*^9, 
   3.6727426074484396`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "40"}],
  SequenceForm["ii=", 40],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653238229370146`*^9, 3.6653238337534237`*^9}, 
   3.6653240430750847`*^9, 3.6653255613453426`*^9, 3.665325690274911*^9, 
   3.665325760656021*^9, 3.6653807692562304`*^9, 3.6653826542134953`*^9, 
   3.6653828427383046`*^9, 3.6653828787990274`*^9, 3.6653875860924587`*^9, 
   3.665387643643139*^9, 3.665387858861128*^9, 3.6653879341762657`*^9, 
   3.665388015732458*^9, 3.665388204578836*^9, 3.6653884546726146`*^9, 
   3.6653886335070763`*^9, {3.665389077683243*^9, 3.6653890863215904`*^9}, 
   3.6653891608201995`*^9, 3.6653893405836864`*^9, 3.665389828029312*^9, 
   3.665390153071544*^9, 3.6653903041460037`*^9, 3.6653904769110584`*^9, 
   3.6653945455791197`*^9, {3.665394631729479*^9, 3.665394659077984*^9}, {
   3.665394843806135*^9, 3.6653948508347178`*^9}, 3.665394939575779*^9, 
   3.6653949972498903`*^9, 3.6653951280720367`*^9, {3.665395224391192*^9, 
   3.665395232872293*^9}, 3.665395344222473*^9, 3.6653953921729913`*^9, {
   3.665395766562704*^9, 3.6653957935400486`*^9}, 3.665395885541156*^9, 
   3.6654040144814234`*^9, {3.667043466040807*^9, 3.6670434737493677`*^9}, {
   3.667561023997614*^9, 3.6675610352134266`*^9}, 3.667568379234228*^9, 
   3.6676263365603437`*^9, 3.6676554194593363`*^9, 3.6700418919697704`*^9, 
   3.672739991147246*^9, {3.6727422161821995`*^9, 3.67274229128926*^9}, 
   3.672742334144391*^9, 3.672742421343337*^9, {3.6727425700251513`*^9, 
   3.672742610176469*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "50"}],
  SequenceForm["ii=", 50],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653238229370146`*^9, 3.6653238337534237`*^9}, 
   3.6653240430750847`*^9, 3.6653255613453426`*^9, 3.665325690274911*^9, 
   3.665325760656021*^9, 3.6653807692562304`*^9, 3.6653826542134953`*^9, 
   3.6653828427383046`*^9, 3.6653828787990274`*^9, 3.6653875860924587`*^9, 
   3.665387643643139*^9, 3.665387858861128*^9, 3.6653879341762657`*^9, 
   3.665388015732458*^9, 3.665388204578836*^9, 3.6653884546726146`*^9, 
   3.6653886335070763`*^9, {3.665389077683243*^9, 3.6653890863215904`*^9}, 
   3.6653891608201995`*^9, 3.6653893405836864`*^9, 3.665389828029312*^9, 
   3.665390153071544*^9, 3.6653903041460037`*^9, 3.6653904769110584`*^9, 
   3.6653945455791197`*^9, {3.665394631729479*^9, 3.665394659077984*^9}, {
   3.665394843806135*^9, 3.6653948508347178`*^9}, 3.665394939575779*^9, 
   3.6653949972498903`*^9, 3.6653951280720367`*^9, {3.665395224391192*^9, 
   3.665395232872293*^9}, 3.665395344222473*^9, 3.6653953921729913`*^9, {
   3.665395766562704*^9, 3.6653957935400486`*^9}, 3.665395885541156*^9, 
   3.6654040144814234`*^9, {3.667043466040807*^9, 3.6670434737493677`*^9}, {
   3.667561023997614*^9, 3.6675610352134266`*^9}, 3.667568379234228*^9, 
   3.6676263365603437`*^9, 3.6676554194593363`*^9, 3.6700418919697704`*^9, 
   3.672739991147246*^9, {3.6727422161821995`*^9, 3.67274229128926*^9}, 
   3.672742334144391*^9, 3.672742421343337*^9, {3.6727425700251513`*^9, 
   3.6727426108195276`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "60"}],
  SequenceForm["ii=", 60],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653238229370146`*^9, 3.6653238337534237`*^9}, 
   3.6653240430750847`*^9, 3.6653255613453426`*^9, 3.665325690274911*^9, 
   3.665325760656021*^9, 3.6653807692562304`*^9, 3.6653826542134953`*^9, 
   3.6653828427383046`*^9, 3.6653828787990274`*^9, 3.6653875860924587`*^9, 
   3.665387643643139*^9, 3.665387858861128*^9, 3.6653879341762657`*^9, 
   3.665388015732458*^9, 3.665388204578836*^9, 3.6653884546726146`*^9, 
   3.6653886335070763`*^9, {3.665389077683243*^9, 3.6653890863215904`*^9}, 
   3.6653891608201995`*^9, 3.6653893405836864`*^9, 3.665389828029312*^9, 
   3.665390153071544*^9, 3.6653903041460037`*^9, 3.6653904769110584`*^9, 
   3.6653945455791197`*^9, {3.665394631729479*^9, 3.665394659077984*^9}, {
   3.665394843806135*^9, 3.6653948508347178`*^9}, 3.665394939575779*^9, 
   3.6653949972498903`*^9, 3.6653951280720367`*^9, {3.665395224391192*^9, 
   3.665395232872293*^9}, 3.665395344222473*^9, 3.6653953921729913`*^9, {
   3.665395766562704*^9, 3.6653957935400486`*^9}, 3.665395885541156*^9, 
   3.6654040144814234`*^9, {3.667043466040807*^9, 3.6670434737493677`*^9}, {
   3.667561023997614*^9, 3.6675610352134266`*^9}, 3.667568379234228*^9, 
   3.6676263365603437`*^9, 3.6676554194593363`*^9, 3.6700418919697704`*^9, 
   3.672739991147246*^9, {3.6727422161821995`*^9, 3.67274229128926*^9}, 
   3.672742334144391*^9, 3.672742421343337*^9, {3.6727425700251513`*^9, 
   3.67274261178203*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "70"}],
  SequenceForm["ii=", 70],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653238229370146`*^9, 3.6653238337534237`*^9}, 
   3.6653240430750847`*^9, 3.6653255613453426`*^9, 3.665325690274911*^9, 
   3.665325760656021*^9, 3.6653807692562304`*^9, 3.6653826542134953`*^9, 
   3.6653828427383046`*^9, 3.6653828787990274`*^9, 3.6653875860924587`*^9, 
   3.665387643643139*^9, 3.665387858861128*^9, 3.6653879341762657`*^9, 
   3.665388015732458*^9, 3.665388204578836*^9, 3.6653884546726146`*^9, 
   3.6653886335070763`*^9, {3.665389077683243*^9, 3.6653890863215904`*^9}, 
   3.6653891608201995`*^9, 3.6653893405836864`*^9, 3.665389828029312*^9, 
   3.665390153071544*^9, 3.6653903041460037`*^9, 3.6653904769110584`*^9, 
   3.6653945455791197`*^9, {3.665394631729479*^9, 3.665394659077984*^9}, {
   3.665394843806135*^9, 3.6653948508347178`*^9}, 3.665394939575779*^9, 
   3.6653949972498903`*^9, 3.6653951280720367`*^9, {3.665395224391192*^9, 
   3.665395232872293*^9}, 3.665395344222473*^9, 3.6653953921729913`*^9, {
   3.665395766562704*^9, 3.6653957935400486`*^9}, 3.665395885541156*^9, 
   3.6654040144814234`*^9, {3.667043466040807*^9, 3.6670434737493677`*^9}, {
   3.667561023997614*^9, 3.6675610352134266`*^9}, 3.667568379234228*^9, 
   3.6676263365603437`*^9, 3.6676554194593363`*^9, 3.6700418919697704`*^9, 
   3.672739991147246*^9, {3.6727422161821995`*^9, 3.67274229128926*^9}, 
   3.672742334144391*^9, 3.672742421343337*^9, {3.6727425700251513`*^9, 
   3.6727426125544133`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "80"}],
  SequenceForm["ii=", 80],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653238229370146`*^9, 3.6653238337534237`*^9}, 
   3.6653240430750847`*^9, 3.6653255613453426`*^9, 3.665325690274911*^9, 
   3.665325760656021*^9, 3.6653807692562304`*^9, 3.6653826542134953`*^9, 
   3.6653828427383046`*^9, 3.6653828787990274`*^9, 3.6653875860924587`*^9, 
   3.665387643643139*^9, 3.665387858861128*^9, 3.6653879341762657`*^9, 
   3.665388015732458*^9, 3.665388204578836*^9, 3.6653884546726146`*^9, 
   3.6653886335070763`*^9, {3.665389077683243*^9, 3.6653890863215904`*^9}, 
   3.6653891608201995`*^9, 3.6653893405836864`*^9, 3.665389828029312*^9, 
   3.665390153071544*^9, 3.6653903041460037`*^9, 3.6653904769110584`*^9, 
   3.6653945455791197`*^9, {3.665394631729479*^9, 3.665394659077984*^9}, {
   3.665394843806135*^9, 3.6653948508347178`*^9}, 3.665394939575779*^9, 
   3.6653949972498903`*^9, 3.6653951280720367`*^9, {3.665395224391192*^9, 
   3.665395232872293*^9}, 3.665395344222473*^9, 3.6653953921729913`*^9, {
   3.665395766562704*^9, 3.6653957935400486`*^9}, 3.665395885541156*^9, 
   3.6654040144814234`*^9, {3.667043466040807*^9, 3.6670434737493677`*^9}, {
   3.667561023997614*^9, 3.6675610352134266`*^9}, 3.667568379234228*^9, 
   3.6676263365603437`*^9, 3.6676554194593363`*^9, 3.6700418919697704`*^9, 
   3.672739991147246*^9, {3.6727422161821995`*^9, 3.67274229128926*^9}, 
   3.672742334144391*^9, 3.672742421343337*^9, {3.6727425700251513`*^9, 
   3.6727426134030685`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "90"}],
  SequenceForm["ii=", 90],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653238229370146`*^9, 3.6653238337534237`*^9}, 
   3.6653240430750847`*^9, 3.6653255613453426`*^9, 3.665325690274911*^9, 
   3.665325760656021*^9, 3.6653807692562304`*^9, 3.6653826542134953`*^9, 
   3.6653828427383046`*^9, 3.6653828787990274`*^9, 3.6653875860924587`*^9, 
   3.665387643643139*^9, 3.665387858861128*^9, 3.6653879341762657`*^9, 
   3.665388015732458*^9, 3.665388204578836*^9, 3.6653884546726146`*^9, 
   3.6653886335070763`*^9, {3.665389077683243*^9, 3.6653890863215904`*^9}, 
   3.6653891608201995`*^9, 3.6653893405836864`*^9, 3.665389828029312*^9, 
   3.665390153071544*^9, 3.6653903041460037`*^9, 3.6653904769110584`*^9, 
   3.6653945455791197`*^9, {3.665394631729479*^9, 3.665394659077984*^9}, {
   3.665394843806135*^9, 3.6653948508347178`*^9}, 3.665394939575779*^9, 
   3.6653949972498903`*^9, 3.6653951280720367`*^9, {3.665395224391192*^9, 
   3.665395232872293*^9}, 3.665395344222473*^9, 3.6653953921729913`*^9, {
   3.665395766562704*^9, 3.6653957935400486`*^9}, 3.665395885541156*^9, 
   3.6654040144814234`*^9, {3.667043466040807*^9, 3.6670434737493677`*^9}, {
   3.667561023997614*^9, 3.6675610352134266`*^9}, 3.667568379234228*^9, 
   3.6676263365603437`*^9, 3.6676554194593363`*^9, 3.6700418919697704`*^9, 
   3.672739991147246*^9, {3.6727422161821995`*^9, 3.67274229128926*^9}, 
   3.672742334144391*^9, 3.672742421343337*^9, {3.6727425700251513`*^9, 
   3.6727426140422945`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "100"}],
  SequenceForm["ii=", 100],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653238229370146`*^9, 3.6653238337534237`*^9}, 
   3.6653240430750847`*^9, 3.6653255613453426`*^9, 3.665325690274911*^9, 
   3.665325760656021*^9, 3.6653807692562304`*^9, 3.6653826542134953`*^9, 
   3.6653828427383046`*^9, 3.6653828787990274`*^9, 3.6653875860924587`*^9, 
   3.665387643643139*^9, 3.665387858861128*^9, 3.6653879341762657`*^9, 
   3.665388015732458*^9, 3.665388204578836*^9, 3.6653884546726146`*^9, 
   3.6653886335070763`*^9, {3.665389077683243*^9, 3.6653890863215904`*^9}, 
   3.6653891608201995`*^9, 3.6653893405836864`*^9, 3.665389828029312*^9, 
   3.665390153071544*^9, 3.6653903041460037`*^9, 3.6653904769110584`*^9, 
   3.6653945455791197`*^9, {3.665394631729479*^9, 3.665394659077984*^9}, {
   3.665394843806135*^9, 3.6653948508347178`*^9}, 3.665394939575779*^9, 
   3.6653949972498903`*^9, 3.6653951280720367`*^9, {3.665395224391192*^9, 
   3.665395232872293*^9}, 3.665395344222473*^9, 3.6653953921729913`*^9, {
   3.665395766562704*^9, 3.6653957935400486`*^9}, 3.665395885541156*^9, 
   3.6654040144814234`*^9, {3.667043466040807*^9, 3.6670434737493677`*^9}, {
   3.667561023997614*^9, 3.6675610352134266`*^9}, 3.667568379234228*^9, 
   3.6676263365603437`*^9, 3.6676554194593363`*^9, 3.6700418919697704`*^9, 
   3.672739991147246*^9, {3.6727422161821995`*^9, 3.67274229128926*^9}, 
   3.672742334144391*^9, 3.672742421343337*^9, {3.6727425700251513`*^9, 
   3.6727426147271595`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "110"}],
  SequenceForm["ii=", 110],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653238229370146`*^9, 3.6653238337534237`*^9}, 
   3.6653240430750847`*^9, 3.6653255613453426`*^9, 3.665325690274911*^9, 
   3.665325760656021*^9, 3.6653807692562304`*^9, 3.6653826542134953`*^9, 
   3.6653828427383046`*^9, 3.6653828787990274`*^9, 3.6653875860924587`*^9, 
   3.665387643643139*^9, 3.665387858861128*^9, 3.6653879341762657`*^9, 
   3.665388015732458*^9, 3.665388204578836*^9, 3.6653884546726146`*^9, 
   3.6653886335070763`*^9, {3.665389077683243*^9, 3.6653890863215904`*^9}, 
   3.6653891608201995`*^9, 3.6653893405836864`*^9, 3.665389828029312*^9, 
   3.665390153071544*^9, 3.6653903041460037`*^9, 3.6653904769110584`*^9, 
   3.6653945455791197`*^9, {3.665394631729479*^9, 3.665394659077984*^9}, {
   3.665394843806135*^9, 3.6653948508347178`*^9}, 3.665394939575779*^9, 
   3.6653949972498903`*^9, 3.6653951280720367`*^9, {3.665395224391192*^9, 
   3.665395232872293*^9}, 3.665395344222473*^9, 3.6653953921729913`*^9, {
   3.665395766562704*^9, 3.6653957935400486`*^9}, 3.665395885541156*^9, 
   3.6654040144814234`*^9, {3.667043466040807*^9, 3.6670434737493677`*^9}, {
   3.667561023997614*^9, 3.6675610352134266`*^9}, 3.667568379234228*^9, 
   3.6676263365603437`*^9, 3.6676554194593363`*^9, 3.6700418919697704`*^9, 
   3.672739991147246*^9, {3.6727422161821995`*^9, 3.67274229128926*^9}, 
   3.672742334144391*^9, 3.672742421343337*^9, {3.6727425700251513`*^9, 
   3.6727426150064487`*^9}}]
}, Closed]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.665318117879394*^9, 3.665318118113784*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Here", " ", "we", " ", "check", " ", "survivingPerfectMatchings"}],
   "*)"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653194611906705`*^9, 3.665319470875516*^9}, 
   3.665319696162837*^9, 3.665319923129767*^9, {3.66532084581382*^9, 
   3.6653208558484077`*^9}, 3.66532141327155*^9, 3.6653872607352314`*^9, {
   3.6653878723812013`*^9, 3.665387872807293*^9}, {3.6653882181571608`*^9, 
   3.665388220760619*^9}, {3.6653886771674967`*^9, 3.665388699256188*^9}, {
   3.665394491044639*^9, 3.6653944995239697`*^9}, {3.6653959126545773`*^9, 
   3.6653959300472593`*^9}, 3.6654043706184206`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CloseKernels", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LaunchKernels", "[", "4", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"formatrule", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["XX_", 
      RowBox[{"z1_", ",", "z2_"}]], "\[Rule]", 
     RowBox[{"XX", "[", 
      RowBox[{"z1", ",", "z2"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ii", "=", "1"}], ",", 
    RowBox[{"ii", "\[LessEqual]", "110"}], ",", 
    RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<ii=\>\"", ",", "ii"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Mod", "[", 
           RowBox[{"ii", ",", "10"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<ii=\>\"", ",", "ii"}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
     SubscriptBox["bft", "ii"], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"a", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b", "=", 
      RowBox[{"b", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"c", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"d", "=", 
      RowBox[{"d", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"tokillvars", "=", 
      RowBox[{"Subsets", "[", 
       RowBox[{
        RowBox[{"Variables", "[", 
         RowBox[{"Join", "[", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"Min", "[", 
          RowBox[{"{", 
           RowBox[{"3", ",", 
            RowBox[{"Floor", "[", 
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"Variables", "[", 
                RowBox[{"Join", "[", 
                 RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}], 
               "]"}], "/", "7"}], "]"}]}], "}"}], "]"}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "tokillvars", "]"}], ">", "5000"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tokillvars", "=", 
         RowBox[{"tokillvars", "[", 
          RowBox[{"[", 
           RowBox[{"Range", "[", "5000", "]"}], "]"}], "]"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"perfs", "=", 
      RowBox[{"perfectMatchings", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"survivorscheck", "=", 
      RowBox[{"ParallelMap", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Complement", "[", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{"Length", "[", "perfs", "]"}], "]"}], ",", 
           RowBox[{"Flatten", "[", 
            RowBox[{"Position", "[", 
             RowBox[{
              RowBox[{"perfs", "/.", "#"}], ",", "0"}], "]"}], "]"}]}], "]"}],
          "&"}], ",", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "\[Rule]", "0"}], "&"}], ",", "tokillvars", ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"survivors", "=", 
      RowBox[{"ParallelMap", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"survivingPerfectMatchings", "[", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "#"}], "]"}], "&"}],
         ",", "tokillvars"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"survivors", "=!=", "survivorscheck"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<ii=\>\"", ",", "ii", ",", 
          "\"\< : There's a problem with survivingPerfectMatchings! It's not \
determining the correct set of surviving perfect-matching numbers\>\""}], 
         "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.665318171181672*^9, 3.665318202704878*^9}, {
   3.6653183216068077`*^9, 3.6653183520994596`*^9}, {3.66531839215139*^9, 
   3.6653184111501756`*^9}, 3.6653192263125267`*^9, 3.6653192607611127`*^9, {
   3.665319433827194*^9, 3.665319470875516*^9}, {3.6653197007946744`*^9, 
   3.6653197104984245`*^9}, {3.6653202255463314`*^9, 3.665320244858407*^9}, {
   3.6653207815004144`*^9, 3.6653208951053333`*^9}, {3.6653209452862015`*^9, 
   3.66532097842157*^9}, {3.6653210227354336`*^9, 3.6653211041830716`*^9}, {
   3.665321718658688*^9, 3.6653217820570545`*^9}, {3.6653218590977*^9, 
   3.665321920578185*^9}, {3.665322195244587*^9, 3.6653222033328075`*^9}, {
   3.6653223748763256`*^9, 3.6653224330165462`*^9}, {3.66532322955106*^9, 
   3.6653232390476637`*^9}, {3.6653238225077314`*^9, 3.665323879242934*^9}, {
   3.6653239159845405`*^9, 3.665324034040783*^9}, {3.6653257558168*^9, 
   3.6653257558748393`*^9}, 3.6653807684593163`*^9, 3.665382653447832*^9, {
   3.665382822865073*^9, 3.6653828563613834`*^9}, {3.665387578430645*^9, 
   3.6653876417433176`*^9}, {3.665387772827407*^9, 3.6653879319324636`*^9}, {
   3.665387975013636*^9, 3.6653880124958487`*^9}, {3.6653881161778917`*^9, 
   3.665388203398225*^9}, {3.665388418670115*^9, 3.6653884602207074`*^9}, {
   3.6653885272304087`*^9, 3.665388540956611*^9}, {3.6653885991701355`*^9, 
   3.6653886322947865`*^9}, {3.6653887029314117`*^9, 3.665388703056418*^9}, {
   3.665389018738357*^9, 3.665389158046074*^9}, {3.665389284500309*^9, 
   3.665389339919886*^9}, {3.6653897666302986`*^9, 3.6653898363558693`*^9}, {
   3.665389910163226*^9, 3.665389961631102*^9}, {3.6653901380930347`*^9, 
   3.665390149511369*^9}, {3.665390300980686*^9, 3.6653903028178134`*^9}, {
   3.6653903445906506`*^9, 3.6653904473908606`*^9}, {3.6653945222132363`*^9, 
   3.6653945445009356`*^9}, 3.665394584118007*^9, {3.665394640528449*^9, 
   3.6653946583592005`*^9}, {3.665394756936673*^9, 3.665394939098732*^9}, {
   3.6653949871547394`*^9, 3.665394996124837*^9}, {3.6653950323304377`*^9, 
   3.6653951271812873`*^9}, {3.6653951719081173`*^9, 
   3.6653952161041775`*^9}, {3.6653952920676613`*^9, 
   3.6653953916260896`*^9}, {3.665395727510127*^9, 3.665395790959216*^9}, {
   3.665395874423108*^9, 3.6653958840790167`*^9}, {3.6653959360678654`*^9, 
   3.6653959424852996`*^9}, {3.6654007949831653`*^9, 3.66540083106148*^9}, 
   3.6654119448113413`*^9, {3.6654145105116434`*^9, 3.6654145393661566`*^9}, {
   3.6670434915526004`*^9, 3.667043491728428*^9}, {3.6675610499618826`*^9, 
   3.6675610754523*^9}, {3.6675684146282988`*^9, 3.667568428944084*^9}, {
   3.6701289198403873`*^9, 3.670128923827196*^9}, {3.6727429869035873`*^9, 
   3.6727430045481944`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "105"}],
  SequenceForm["ii=", 105],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653238229370146`*^9, 3.6653238337534237`*^9}, 
   3.6653240430750847`*^9, 3.6653255613453426`*^9, 3.665325690274911*^9, 
   3.665325760656021*^9, 3.6653807692562304`*^9, 3.6653826542134953`*^9, 
   3.6653828427383046`*^9, 3.6653828787990274`*^9, 3.6653875860924587`*^9, 
   3.665387643643139*^9, 3.665387858861128*^9, 3.6653879341762657`*^9, 
   3.665388015732458*^9, 3.665388204578836*^9, 3.6653884546726146`*^9, 
   3.6653886335070763`*^9, {3.665389077683243*^9, 3.6653890863215904`*^9}, 
   3.6653891608201995`*^9, 3.6653893405836864`*^9, 3.665389828029312*^9, 
   3.665390153071544*^9, 3.6653903041460037`*^9, 3.6653904769110584`*^9, 
   3.6653945455791197`*^9, {3.665394631729479*^9, 3.665394659077984*^9}, {
   3.665394843806135*^9, 3.6653948508347178`*^9}, 3.665394939575779*^9, 
   3.6653949972498903`*^9, 3.6653951280720367`*^9, {3.665395224391192*^9, 
   3.665395232872293*^9}, 3.665395344222473*^9, 3.6653953921729913`*^9, {
   3.665395766562704*^9, 3.6653957935400486`*^9}, 3.665395885541156*^9, {
   3.6654008250519047`*^9, 3.6654008485318317`*^9}, 3.6654119860820494`*^9, 
   3.665414587832021*^9, 3.667043498540284*^9, {3.667561064840459*^9, 
   3.667561081647563*^9}, 3.6675684180725603`*^9, 3.667626348590768*^9, 
   3.6676554318210573`*^9, 3.670041905440191*^9, 3.6727430002214518`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "106"}],
  SequenceForm["ii=", 106],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653238229370146`*^9, 3.6653238337534237`*^9}, 
   3.6653240430750847`*^9, 3.6653255613453426`*^9, 3.665325690274911*^9, 
   3.665325760656021*^9, 3.6653807692562304`*^9, 3.6653826542134953`*^9, 
   3.6653828427383046`*^9, 3.6653828787990274`*^9, 3.6653875860924587`*^9, 
   3.665387643643139*^9, 3.665387858861128*^9, 3.6653879341762657`*^9, 
   3.665388015732458*^9, 3.665388204578836*^9, 3.6653884546726146`*^9, 
   3.6653886335070763`*^9, {3.665389077683243*^9, 3.6653890863215904`*^9}, 
   3.6653891608201995`*^9, 3.6653893405836864`*^9, 3.665389828029312*^9, 
   3.665390153071544*^9, 3.6653903041460037`*^9, 3.6653904769110584`*^9, 
   3.6653945455791197`*^9, {3.665394631729479*^9, 3.665394659077984*^9}, {
   3.665394843806135*^9, 3.6653948508347178`*^9}, 3.665394939575779*^9, 
   3.6653949972498903`*^9, 3.6653951280720367`*^9, {3.665395224391192*^9, 
   3.665395232872293*^9}, 3.665395344222473*^9, 3.6653953921729913`*^9, {
   3.665395766562704*^9, 3.6653957935400486`*^9}, 3.665395885541156*^9, {
   3.6654008250519047`*^9, 3.6654008485318317`*^9}, 3.6654119860820494`*^9, 
   3.665414587832021*^9, 3.667043498540284*^9, {3.667561064840459*^9, 
   3.667561081647563*^9}, 3.6675684180725603`*^9, 3.667626348590768*^9, 
   3.6676554318210573`*^9, 3.670041905440191*^9, 3.672743000501614*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "107"}],
  SequenceForm["ii=", 107],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653238229370146`*^9, 3.6653238337534237`*^9}, 
   3.6653240430750847`*^9, 3.6653255613453426`*^9, 3.665325690274911*^9, 
   3.665325760656021*^9, 3.6653807692562304`*^9, 3.6653826542134953`*^9, 
   3.6653828427383046`*^9, 3.6653828787990274`*^9, 3.6653875860924587`*^9, 
   3.665387643643139*^9, 3.665387858861128*^9, 3.6653879341762657`*^9, 
   3.665388015732458*^9, 3.665388204578836*^9, 3.6653884546726146`*^9, 
   3.6653886335070763`*^9, {3.665389077683243*^9, 3.6653890863215904`*^9}, 
   3.6653891608201995`*^9, 3.6653893405836864`*^9, 3.665389828029312*^9, 
   3.665390153071544*^9, 3.6653903041460037`*^9, 3.6653904769110584`*^9, 
   3.6653945455791197`*^9, {3.665394631729479*^9, 3.665394659077984*^9}, {
   3.665394843806135*^9, 3.6653948508347178`*^9}, 3.665394939575779*^9, 
   3.6653949972498903`*^9, 3.6653951280720367`*^9, {3.665395224391192*^9, 
   3.665395232872293*^9}, 3.665395344222473*^9, 3.6653953921729913`*^9, {
   3.665395766562704*^9, 3.6653957935400486`*^9}, 3.665395885541156*^9, {
   3.6654008250519047`*^9, 3.6654008485318317`*^9}, 3.6654119860820494`*^9, 
   3.665414587832021*^9, 3.667043498540284*^9, {3.667561064840459*^9, 
   3.667561081647563*^9}, 3.6675684180725603`*^9, 3.667626348590768*^9, 
   3.6676554318210573`*^9, 3.670041905440191*^9, 3.672743000785296*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "108"}],
  SequenceForm["ii=", 108],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653238229370146`*^9, 3.6653238337534237`*^9}, 
   3.6653240430750847`*^9, 3.6653255613453426`*^9, 3.665325690274911*^9, 
   3.665325760656021*^9, 3.6653807692562304`*^9, 3.6653826542134953`*^9, 
   3.6653828427383046`*^9, 3.6653828787990274`*^9, 3.6653875860924587`*^9, 
   3.665387643643139*^9, 3.665387858861128*^9, 3.6653879341762657`*^9, 
   3.665388015732458*^9, 3.665388204578836*^9, 3.6653884546726146`*^9, 
   3.6653886335070763`*^9, {3.665389077683243*^9, 3.6653890863215904`*^9}, 
   3.6653891608201995`*^9, 3.6653893405836864`*^9, 3.665389828029312*^9, 
   3.665390153071544*^9, 3.6653903041460037`*^9, 3.6653904769110584`*^9, 
   3.6653945455791197`*^9, {3.665394631729479*^9, 3.665394659077984*^9}, {
   3.665394843806135*^9, 3.6653948508347178`*^9}, 3.665394939575779*^9, 
   3.6653949972498903`*^9, 3.6653951280720367`*^9, {3.665395224391192*^9, 
   3.665395232872293*^9}, 3.665395344222473*^9, 3.6653953921729913`*^9, {
   3.665395766562704*^9, 3.6653957935400486`*^9}, 3.665395885541156*^9, {
   3.6654008250519047`*^9, 3.6654008485318317`*^9}, 3.6654119860820494`*^9, 
   3.665414587832021*^9, 3.667043498540284*^9, {3.667561064840459*^9, 
   3.667561081647563*^9}, 3.6675684180725603`*^9, 3.667626348590768*^9, 
   3.6676554318210573`*^9, 3.670041905440191*^9, 3.672743001107831*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "109"}],
  SequenceForm["ii=", 109],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653238229370146`*^9, 3.6653238337534237`*^9}, 
   3.6653240430750847`*^9, 3.6653255613453426`*^9, 3.665325690274911*^9, 
   3.665325760656021*^9, 3.6653807692562304`*^9, 3.6653826542134953`*^9, 
   3.6653828427383046`*^9, 3.6653828787990274`*^9, 3.6653875860924587`*^9, 
   3.665387643643139*^9, 3.665387858861128*^9, 3.6653879341762657`*^9, 
   3.665388015732458*^9, 3.665388204578836*^9, 3.6653884546726146`*^9, 
   3.6653886335070763`*^9, {3.665389077683243*^9, 3.6653890863215904`*^9}, 
   3.6653891608201995`*^9, 3.6653893405836864`*^9, 3.665389828029312*^9, 
   3.665390153071544*^9, 3.6653903041460037`*^9, 3.6653904769110584`*^9, 
   3.6653945455791197`*^9, {3.665394631729479*^9, 3.665394659077984*^9}, {
   3.665394843806135*^9, 3.6653948508347178`*^9}, 3.665394939575779*^9, 
   3.6653949972498903`*^9, 3.6653951280720367`*^9, {3.665395224391192*^9, 
   3.665395232872293*^9}, 3.665395344222473*^9, 3.6653953921729913`*^9, {
   3.665395766562704*^9, 3.6653957935400486`*^9}, 3.665395885541156*^9, {
   3.6654008250519047`*^9, 3.6654008485318317`*^9}, 3.6654119860820494`*^9, 
   3.665414587832021*^9, 3.667043498540284*^9, {3.667561064840459*^9, 
   3.667561081647563*^9}, 3.6675684180725603`*^9, 3.667626348590768*^9, 
   3.6676554318210573`*^9, 3.670041905440191*^9, 3.6727430014555264`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "110"}],
  SequenceForm["ii=", 110],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653238229370146`*^9, 3.6653238337534237`*^9}, 
   3.6653240430750847`*^9, 3.6653255613453426`*^9, 3.665325690274911*^9, 
   3.665325760656021*^9, 3.6653807692562304`*^9, 3.6653826542134953`*^9, 
   3.6653828427383046`*^9, 3.6653828787990274`*^9, 3.6653875860924587`*^9, 
   3.665387643643139*^9, 3.665387858861128*^9, 3.6653879341762657`*^9, 
   3.665388015732458*^9, 3.665388204578836*^9, 3.6653884546726146`*^9, 
   3.6653886335070763`*^9, {3.665389077683243*^9, 3.6653890863215904`*^9}, 
   3.6653891608201995`*^9, 3.6653893405836864`*^9, 3.665389828029312*^9, 
   3.665390153071544*^9, 3.6653903041460037`*^9, 3.6653904769110584`*^9, 
   3.6653945455791197`*^9, {3.665394631729479*^9, 3.665394659077984*^9}, {
   3.665394843806135*^9, 3.6653948508347178`*^9}, 3.665394939575779*^9, 
   3.6653949972498903`*^9, 3.6653951280720367`*^9, {3.665395224391192*^9, 
   3.665395232872293*^9}, 3.665395344222473*^9, 3.6653953921729913`*^9, {
   3.665395766562704*^9, 3.6653957935400486`*^9}, 3.665395885541156*^9, {
   3.6654008250519047`*^9, 3.6654008485318317`*^9}, 3.6654119860820494`*^9, 
   3.665414587832021*^9, 3.667043498540284*^9, {3.667561064840459*^9, 
   3.667561081647563*^9}, 3.6675684180725603`*^9, 3.667626348590768*^9, 
   3.6676554318210573`*^9, 3.670041905440191*^9, 3.672743001740712*^9}]
}, Closed]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.665318117879394*^9, 3.665318118113784*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Here", " ", "we", " ", "check", " ", "matroidPolytope"}], ",", 
   " ", "moduliSpaceBFT", ",", " ", "turnIntoPolytope", ",", " ", 
   "dimensionPolytope", ",", " ", "lowNumberLoopsPMpos"}], "*)"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653194611906705`*^9, 3.665319470875516*^9}, 
   3.665319696162837*^9, 3.665319923129767*^9, {3.66532084581382*^9, 
   3.6653208558484077`*^9}, 3.66532141327155*^9, 3.6653872607352314`*^9, {
   3.6653878723812013`*^9, 3.665387872807293*^9}, {3.6653882181571608`*^9, 
   3.665388220760619*^9}, {3.6653886771674967`*^9, 3.665388699256188*^9}, {
   3.665394491044639*^9, 3.6653944995239697`*^9}, {3.6653959126545773`*^9, 
   3.6653959300472593`*^9}, {3.665401327082258*^9, 3.6654013337119846`*^9}, {
   3.6654026694601145`*^9, 3.6654026949367933`*^9}, {3.665403448317461*^9, 
   3.6654034488158073`*^9}, 3.671543681977443*^9, 3.671545432832715*^9, 
   3.6715455235215387`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"formatrule", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["XX_", 
      RowBox[{"z1_", ",", "z2_"}]], "\[Rule]", 
     RowBox[{"XX", "[", 
      RowBox[{"z1", ",", "z2"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ii", "=", "1"}], ",", 
    RowBox[{"ii", "\[LessEqual]", "110"}], ",", 
    RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{"ii", ",", "10"}], "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<ii=\>\"", ",", "ii"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     SubscriptBox["bft", "ii"], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"a", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b", "=", 
      RowBox[{"b", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"c", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"d", "=", 
      RowBox[{"d", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"perfs", "=", 
      RowBox[{"perfectMatchings", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"matroidpoly", "=", 
      RowBox[{"matroidPolytope", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"moduligauging1", "=", 
      RowBox[{"moduliSpaceBFT", "[", 
       RowBox[{
       "a", ",", "b", ",", "c", ",", "d", ",", "1", ",", "False", ",", 
        "True"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"moduligauging2", "=", 
      RowBox[{"moduliSpaceBFT", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "2"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"loopvarsgauging1", "=", 
      RowBox[{"loopVariablesBasis", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "True"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"loopvarsgauging2", "=", 
      RowBox[{"loopVariablesBasis", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "False"}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Dimensions", "[", "matroidpoly", "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], "=!=", 
        RowBox[{"Length", "[", "perfs", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<ii=\>\"", ",", "ii", ",", 
          "\"\< : There's a problem with the matroid polytope! Its number of \
columns is not equal to the number of perfect matchings\>\""}], "]"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ii", "\[NotEqual]", "104"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "106"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "107"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "110"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dimensionPolytope", "[", "matroidpoly", "]"}], "=!=", 
           RowBox[{"Length", "[", 
            RowBox[{"loopvarsgauging2", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<ii=\>\"", ",", "ii", ",", 
             
             "\"\< : There's a problem with the matroid polytope! Its \
dimension does not correspond to that obtained from the loop variable basis\>\
\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ii", "\[Equal]", "104"}], "&&", 
           RowBox[{
            RowBox[{"dimensionPolytope", "[", "matroidpoly", "]"}], "=!=", 
            "0"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<ii=\>\"", ",", "ii", ",", 
             "\"\< : There's a problem with the matroid polytope! Its \
dimension isn't correct\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"moduligauging2", "=!=", "matroidpoly"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<ii=\>\"", ",", "ii", ",", 
          "\"\< : There's a problem with the moduli space Gauging 2! It's not \
equal to the matroid polytope\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Dimensions", "[", "moduligauging1", "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], "=!=", 
        RowBox[{"Length", "[", "perfs", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<ii=\>\"", ",", "ii", ",", 
          "\"\< : There's a problem with the moduli space Gauging 1! Its \
number of columns is not equal to the number of perfect matchings\>\""}], 
         "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ii", "\[NotEqual]", "104"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "106"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "107"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "110"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"dimensionPolytope", "[", "moduligauging1", "]"}], "=!=", 
           RowBox[{"Length", "[", 
            RowBox[{"loopvarsgauging1", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<ii=\>\"", ",", "ii", ",", 
             "\"\< : There's a problem with the moduli space Gauging 1! Its \
dimension dows not correspond to that obtained from the loop variable basis\>\
\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ii", "\[Equal]", "104"}], "&&", 
           RowBox[{
            RowBox[{"dimensionPolytope", "[", "moduligauging1", "]"}], "=!=", 
            "0"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<ii=\>\"", ",", "ii", ",", 
             "\"\< : There's a problem with the matroid polytope! Its \
dimension isn't correct\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"dim", "=", 
      RowBox[{"dimensionPolytope", "[", "moduligauging2", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ii", "\[NotEqual]", "104"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "106"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "107"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "110"}], "&&", 
        RowBox[{"dim", "=!=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"Variables", "[", 
               RowBox[{"Join", "[", 
                RowBox[{"b", ",", "c"}], "]"}], "]"}], "]"}], "-", 
             RowBox[{"Length", "[", 
              RowBox[{"DeleteCases", "[", 
               RowBox[{
                RowBox[{"ConnectedComponents", "[", 
                 RowBox[{"AdjacencyGraph", "[", 
                  RowBox[{"turnIntoAdjacencyMatrix", "[", 
                   RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}], 
                 "]"}], ",", 
                RowBox[{"Alternatives", "@@", 
                 RowBox[{"Transpose", "[", 
                  RowBox[{"{", 
                   RowBox[{"getOrderingExternalNodesDefault", "[", 
                    RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "}"}],
                   "]"}]}]}], "]"}], "]"}]}], ")"}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], "\[Rule]", "0"}], "}"}]}], ")"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<ii=\>\"", ",", "ii", ",", 
          "\"\< : There's a problem with dimensionPolytope!\>\""}], "]"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ii", "\[NotEqual]", "104"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{
             RowBox[{"turnIntoPolytope", "[", "matroidpoly", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}], ">", 
           RowBox[{"Length", "[", 
            RowBox[{"Subsets", "[", 
             RowBox[{
              RowBox[{"Range", "[", 
               RowBox[{
                RowBox[{"Length", "[", "c", "]"}], "+", 
                RowBox[{
                 RowBox[{"Dimensions", "[", "b", "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"Length", "[", 
                RowBox[{"getSourceEdges", "[", 
                 RowBox[{"b", ",", "c", ",", 
                  RowBox[{"perfs", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "}"}]}], 
             "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<ii=\>\"", ",", "ii", ",", 
             "\"\< : There's a problem with turnIntoPolytope! It claims that \
the matroid polytope has more points than Plucker coordinates\>\""}], "]"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Total", "[", 
            RowBox[{
             RowBox[{"turnIntoPolytope", "[", "matroidpoly", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}], "=!=", 
           RowBox[{
            RowBox[{"Dimensions", "[", "matroidpoly", "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<ii=\>\"", ",", "ii", ",", 
             "\"\< : There's a problem with turnIntoPolytope! The sum of \
multiplicities does not equal the number of point!\>\""}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"FreeQ", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Transpose", "[", 
              RowBox[{
               RowBox[{"turnIntoPolytope", "[", "matroidpoly", "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"Position", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"turnIntoPolytope", "[", "matroidpoly", "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                 RowBox[{"Min", "[", 
                  RowBox[{
                   RowBox[{"turnIntoPolytope", "[", "matroidpoly", "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}], "]"}], 
              "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"Transpose", "[", "matroidpoly", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"lowNumberLoopsPMpos", "[", 
               RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}], 
             "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<ii=\>\"", ",", "ii", ",", 
             "\"\< : There's a problem with lowNumberLoopsPMpos! It's not \
selecting the lowest possible number of loops\>\""}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Total", "[", 
            RowBox[{
             RowBox[{"turnIntoPolytope", "[", "moduligauging1", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}], "=!=", 
           RowBox[{
            RowBox[{"Dimensions", "[", "moduligauging1", "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<ii=\>\"", ",", "ii", ",", 
             "\"\< : There's a problem with the moduli space Gauging 1! The \
sum of multiplicities does not equal the number of point!\>\""}], "]"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Total", "[", 
            RowBox[{
             RowBox[{"turnIntoPolytope", "[", "moduligauging2", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}], "=!=", 
           RowBox[{
            RowBox[{"Dimensions", "[", "moduligauging2", "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<ii=\>\"", ",", "ii", ",", 
             "\"\< : There's a problem with the moduli space Gauging 2! The \
sum of multiplicities does not equal the number of point!\>\""}], "]"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.665318171181672*^9, 3.665318202704878*^9}, {
   3.6653183216068077`*^9, 3.6653183520994596`*^9}, {3.66531839215139*^9, 
   3.6653184111501756`*^9}, 3.6653192263125267`*^9, 3.6653192607611127`*^9, {
   3.665319433827194*^9, 3.665319470875516*^9}, {3.6653197007946744`*^9, 
   3.6653197104984245`*^9}, {3.6653202255463314`*^9, 3.665320244858407*^9}, {
   3.6653207815004144`*^9, 3.6653208951053333`*^9}, {3.6653209452862015`*^9, 
   3.66532097842157*^9}, {3.6653210227354336`*^9, 3.6653211041830716`*^9}, {
   3.665321718658688*^9, 3.6653217820570545`*^9}, {3.6653218590977*^9, 
   3.665321920578185*^9}, {3.665322195244587*^9, 3.6653222033328075`*^9}, {
   3.6653223748763256`*^9, 3.6653224330165462`*^9}, {3.66532322955106*^9, 
   3.6653232390476637`*^9}, {3.6653238225077314`*^9, 3.665323879242934*^9}, {
   3.6653239159845405`*^9, 3.665324034040783*^9}, {3.6653257558168*^9, 
   3.6653257558748393`*^9}, 3.6653807684593163`*^9, 3.665382653447832*^9, {
   3.665382822865073*^9, 3.6653828563613834`*^9}, {3.665387578430645*^9, 
   3.6653876417433176`*^9}, {3.665387772827407*^9, 3.6653879319324636`*^9}, {
   3.665387975013636*^9, 3.6653880124958487`*^9}, {3.6653881161778917`*^9, 
   3.665388203398225*^9}, {3.665388418670115*^9, 3.6653884602207074`*^9}, {
   3.6653885272304087`*^9, 3.665388540956611*^9}, {3.6653885991701355`*^9, 
   3.6653886322947865`*^9}, {3.6653887029314117`*^9, 3.665388703056418*^9}, {
   3.665389018738357*^9, 3.665389158046074*^9}, {3.665389284500309*^9, 
   3.665389339919886*^9}, {3.6653897666302986`*^9, 3.6653898363558693`*^9}, {
   3.665389910163226*^9, 3.665389961631102*^9}, {3.6653901380930347`*^9, 
   3.665390149511369*^9}, {3.665390300980686*^9, 3.6653903028178134`*^9}, {
   3.6653903445906506`*^9, 3.6653904473908606`*^9}, {3.6653945222132363`*^9, 
   3.6653945445009356`*^9}, 3.665394584118007*^9, {3.665394640528449*^9, 
   3.6653946583592005`*^9}, {3.665394756936673*^9, 3.665394939098732*^9}, {
   3.6653949871547394`*^9, 3.665394996124837*^9}, {3.6653950323304377`*^9, 
   3.6653951271812873`*^9}, {3.6653951719081173`*^9, 
   3.6653952161041775`*^9}, {3.6653952920676613`*^9, 
   3.6653953916260896`*^9}, {3.665395727510127*^9, 3.665395790959216*^9}, {
   3.665395874423108*^9, 3.6653958840790167`*^9}, {3.6653959360678654`*^9, 
   3.6653959424852996`*^9}, {3.6654007949831653`*^9, 3.66540083106148*^9}, {
   3.6654009069753437`*^9, 3.6654009105454187`*^9}, {3.6654013375229006`*^9, 
   3.665401482683831*^9}, {3.665401561238573*^9, 3.6654016288056183`*^9}, {
   3.665401687238634*^9, 3.6654016978828316`*^9}, {3.6654017896515474`*^9, 
   3.665401801485676*^9}, {3.665401916667469*^9, 3.665401961526197*^9}, {
   3.6654020054559016`*^9, 3.665402074010955*^9}, {3.665402162489502*^9, 
   3.665402169178853*^9}, {3.6654024009734545`*^9, 3.6654024774373503`*^9}, {
   3.665402529270352*^9, 3.665402642512816*^9}, {3.665403238012495*^9, 
   3.6654032739968734`*^9}, 3.665403419921237*^9, {3.665404136392906*^9, 
   3.6654041914172354`*^9}, {3.6657781247002115`*^9, 3.665778124841084*^9}, {
   3.66577820027821*^9, 3.6657782254212904`*^9}, {3.667043874530384*^9, 
   3.6670439083159995`*^9}, {3.6670486600055265`*^9, 
   3.6670486619523535`*^9}, {3.667561099129181*^9, 3.667561107270088*^9}, {
   3.667562021188072*^9, 3.6675620261249943`*^9}, {3.667562085827159*^9, 
   3.667562085886198*^9}, {3.667568441327279*^9, 3.667568443999762*^9}, {
   3.6675690345936756`*^9, 3.667569041138467*^9}, 3.667653335154048*^9, {
   3.6715436825369473`*^9, 3.6715436854219856`*^9}, 3.671544337099547*^9, {
   3.671545433502116*^9, 3.6715454386326084`*^9}, {3.6715455245521793`*^9, 
   3.671545525366357*^9}, 3.6715457991215086`*^9, 3.671545838219162*^9, {
   3.67168765453564*^9, 3.6716876551113453`*^9}, {3.6727430128524404`*^9, 
   3.672743017443037*^9}, {3.6727430852744637`*^9, 3.6727431315108633`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "10"}],
  SequenceForm["ii=", 10],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653238229370146`*^9, 3.6653238337534237`*^9}, 
   3.6653240430750847`*^9, 3.6653255613453426`*^9, 3.665325690274911*^9, 
   3.665325760656021*^9, 3.6653807692562304`*^9, 3.6653826542134953`*^9, 
   3.6653828427383046`*^9, 3.6653828787990274`*^9, 3.6653875860924587`*^9, 
   3.665387643643139*^9, 3.665387858861128*^9, 3.6653879341762657`*^9, 
   3.665388015732458*^9, 3.665388204578836*^9, 3.6653884546726146`*^9, 
   3.6653886335070763`*^9, {3.665389077683243*^9, 3.6653890863215904`*^9}, 
   3.6653891608201995`*^9, 3.6653893405836864`*^9, 3.665389828029312*^9, 
   3.665390153071544*^9, 3.6653903041460037`*^9, 3.6653904769110584`*^9, 
   3.6653945455791197`*^9, {3.665394631729479*^9, 3.665394659077984*^9}, {
   3.665394843806135*^9, 3.6653948508347178`*^9}, 3.665394939575779*^9, 
   3.6653949972498903`*^9, 3.6653951280720367`*^9, {3.665395224391192*^9, 
   3.665395232872293*^9}, 3.665395344222473*^9, 3.6653953921729913`*^9, {
   3.665395766562704*^9, 3.6653957935400486`*^9}, 3.665395885541156*^9, {
   3.6654008250519047`*^9, 3.6654008485318317`*^9}, 3.665400911233347*^9, 
   3.665401432266692*^9, 3.6654016291188293`*^9, 3.6654016905138597`*^9, 
   3.6654019406916604`*^9, 3.665402056004485*^9, {3.665402163555895*^9, 
   3.6654021704067183`*^9}, 3.6654024822992334`*^9, 3.665402573053825*^9, 
   3.665402605704294*^9, 3.665402643226289*^9, 3.665403275548911*^9, 
   3.6654034225681562`*^9, 3.6654040648910847`*^9, {3.665404141063878*^9, 
   3.6654041659442315`*^9}, {3.667043890371055*^9, 3.6670439098098044`*^9}, 
   3.6675611077514086`*^9, 3.6675620269425354`*^9, 3.6675690363219886`*^9, 
   3.667626551872653*^9, 3.6676556647148037`*^9, 3.670042095678624*^9, 
   3.6727430177814074`*^9, {3.6727431280133176`*^9, 3.6727431323378134`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "20"}],
  SequenceForm["ii=", 20],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653238229370146`*^9, 3.6653238337534237`*^9}, 
   3.6653240430750847`*^9, 3.6653255613453426`*^9, 3.665325690274911*^9, 
   3.665325760656021*^9, 3.6653807692562304`*^9, 3.6653826542134953`*^9, 
   3.6653828427383046`*^9, 3.6653828787990274`*^9, 3.6653875860924587`*^9, 
   3.665387643643139*^9, 3.665387858861128*^9, 3.6653879341762657`*^9, 
   3.665388015732458*^9, 3.665388204578836*^9, 3.6653884546726146`*^9, 
   3.6653886335070763`*^9, {3.665389077683243*^9, 3.6653890863215904`*^9}, 
   3.6653891608201995`*^9, 3.6653893405836864`*^9, 3.665389828029312*^9, 
   3.665390153071544*^9, 3.6653903041460037`*^9, 3.6653904769110584`*^9, 
   3.6653945455791197`*^9, {3.665394631729479*^9, 3.665394659077984*^9}, {
   3.665394843806135*^9, 3.6653948508347178`*^9}, 3.665394939575779*^9, 
   3.6653949972498903`*^9, 3.6653951280720367`*^9, {3.665395224391192*^9, 
   3.665395232872293*^9}, 3.665395344222473*^9, 3.6653953921729913`*^9, {
   3.665395766562704*^9, 3.6653957935400486`*^9}, 3.665395885541156*^9, {
   3.6654008250519047`*^9, 3.6654008485318317`*^9}, 3.665400911233347*^9, 
   3.665401432266692*^9, 3.6654016291188293`*^9, 3.6654016905138597`*^9, 
   3.6654019406916604`*^9, 3.665402056004485*^9, {3.665402163555895*^9, 
   3.6654021704067183`*^9}, 3.6654024822992334`*^9, 3.665402573053825*^9, 
   3.665402605704294*^9, 3.665402643226289*^9, 3.665403275548911*^9, 
   3.6654034225681562`*^9, 3.6654040648910847`*^9, {3.665404141063878*^9, 
   3.6654041659442315`*^9}, {3.667043890371055*^9, 3.6670439098098044`*^9}, 
   3.6675611077514086`*^9, 3.6675620269425354`*^9, 3.6675690363219886`*^9, 
   3.667626551872653*^9, 3.6676556647148037`*^9, 3.670042095678624*^9, 
   3.6727430177814074`*^9, {3.6727431280133176`*^9, 3.6727431329387364`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "30"}],
  SequenceForm["ii=", 30],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653238229370146`*^9, 3.6653238337534237`*^9}, 
   3.6653240430750847`*^9, 3.6653255613453426`*^9, 3.665325690274911*^9, 
   3.665325760656021*^9, 3.6653807692562304`*^9, 3.6653826542134953`*^9, 
   3.6653828427383046`*^9, 3.6653828787990274`*^9, 3.6653875860924587`*^9, 
   3.665387643643139*^9, 3.665387858861128*^9, 3.6653879341762657`*^9, 
   3.665388015732458*^9, 3.665388204578836*^9, 3.6653884546726146`*^9, 
   3.6653886335070763`*^9, {3.665389077683243*^9, 3.6653890863215904`*^9}, 
   3.6653891608201995`*^9, 3.6653893405836864`*^9, 3.665389828029312*^9, 
   3.665390153071544*^9, 3.6653903041460037`*^9, 3.6653904769110584`*^9, 
   3.6653945455791197`*^9, {3.665394631729479*^9, 3.665394659077984*^9}, {
   3.665394843806135*^9, 3.6653948508347178`*^9}, 3.665394939575779*^9, 
   3.6653949972498903`*^9, 3.6653951280720367`*^9, {3.665395224391192*^9, 
   3.665395232872293*^9}, 3.665395344222473*^9, 3.6653953921729913`*^9, {
   3.665395766562704*^9, 3.6653957935400486`*^9}, 3.665395885541156*^9, {
   3.6654008250519047`*^9, 3.6654008485318317`*^9}, 3.665400911233347*^9, 
   3.665401432266692*^9, 3.6654016291188293`*^9, 3.6654016905138597`*^9, 
   3.6654019406916604`*^9, 3.665402056004485*^9, {3.665402163555895*^9, 
   3.6654021704067183`*^9}, 3.6654024822992334`*^9, 3.665402573053825*^9, 
   3.665402605704294*^9, 3.665402643226289*^9, 3.665403275548911*^9, 
   3.6654034225681562`*^9, 3.6654040648910847`*^9, {3.665404141063878*^9, 
   3.6654041659442315`*^9}, {3.667043890371055*^9, 3.6670439098098044`*^9}, 
   3.6675611077514086`*^9, 3.6675620269425354`*^9, 3.6675690363219886`*^9, 
   3.667626551872653*^9, 3.6676556647148037`*^9, 3.670042095678624*^9, 
   3.6727430177814074`*^9, {3.6727431280133176`*^9, 3.672743133643835*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "40"}],
  SequenceForm["ii=", 40],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653238229370146`*^9, 3.6653238337534237`*^9}, 
   3.6653240430750847`*^9, 3.6653255613453426`*^9, 3.665325690274911*^9, 
   3.665325760656021*^9, 3.6653807692562304`*^9, 3.6653826542134953`*^9, 
   3.6653828427383046`*^9, 3.6653828787990274`*^9, 3.6653875860924587`*^9, 
   3.665387643643139*^9, 3.665387858861128*^9, 3.6653879341762657`*^9, 
   3.665388015732458*^9, 3.665388204578836*^9, 3.6653884546726146`*^9, 
   3.6653886335070763`*^9, {3.665389077683243*^9, 3.6653890863215904`*^9}, 
   3.6653891608201995`*^9, 3.6653893405836864`*^9, 3.665389828029312*^9, 
   3.665390153071544*^9, 3.6653903041460037`*^9, 3.6653904769110584`*^9, 
   3.6653945455791197`*^9, {3.665394631729479*^9, 3.665394659077984*^9}, {
   3.665394843806135*^9, 3.6653948508347178`*^9}, 3.665394939575779*^9, 
   3.6653949972498903`*^9, 3.6653951280720367`*^9, {3.665395224391192*^9, 
   3.665395232872293*^9}, 3.665395344222473*^9, 3.6653953921729913`*^9, {
   3.665395766562704*^9, 3.6653957935400486`*^9}, 3.665395885541156*^9, {
   3.6654008250519047`*^9, 3.6654008485318317`*^9}, 3.665400911233347*^9, 
   3.665401432266692*^9, 3.6654016291188293`*^9, 3.6654016905138597`*^9, 
   3.6654019406916604`*^9, 3.665402056004485*^9, {3.665402163555895*^9, 
   3.6654021704067183`*^9}, 3.6654024822992334`*^9, 3.665402573053825*^9, 
   3.665402605704294*^9, 3.665402643226289*^9, 3.665403275548911*^9, 
   3.6654034225681562`*^9, 3.6654040648910847`*^9, {3.665404141063878*^9, 
   3.6654041659442315`*^9}, {3.667043890371055*^9, 3.6670439098098044`*^9}, 
   3.6675611077514086`*^9, 3.6675620269425354`*^9, 3.6675690363219886`*^9, 
   3.667626551872653*^9, 3.6676556647148037`*^9, 3.670042095678624*^9, 
   3.6727430177814074`*^9, {3.6727431280133176`*^9, 3.672743135187698*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "50"}],
  SequenceForm["ii=", 50],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653238229370146`*^9, 3.6653238337534237`*^9}, 
   3.6653240430750847`*^9, 3.6653255613453426`*^9, 3.665325690274911*^9, 
   3.665325760656021*^9, 3.6653807692562304`*^9, 3.6653826542134953`*^9, 
   3.6653828427383046`*^9, 3.6653828787990274`*^9, 3.6653875860924587`*^9, 
   3.665387643643139*^9, 3.665387858861128*^9, 3.6653879341762657`*^9, 
   3.665388015732458*^9, 3.665388204578836*^9, 3.6653884546726146`*^9, 
   3.6653886335070763`*^9, {3.665389077683243*^9, 3.6653890863215904`*^9}, 
   3.6653891608201995`*^9, 3.6653893405836864`*^9, 3.665389828029312*^9, 
   3.665390153071544*^9, 3.6653903041460037`*^9, 3.6653904769110584`*^9, 
   3.6653945455791197`*^9, {3.665394631729479*^9, 3.665394659077984*^9}, {
   3.665394843806135*^9, 3.6653948508347178`*^9}, 3.665394939575779*^9, 
   3.6653949972498903`*^9, 3.6653951280720367`*^9, {3.665395224391192*^9, 
   3.665395232872293*^9}, 3.665395344222473*^9, 3.6653953921729913`*^9, {
   3.665395766562704*^9, 3.6653957935400486`*^9}, 3.665395885541156*^9, {
   3.6654008250519047`*^9, 3.6654008485318317`*^9}, 3.665400911233347*^9, 
   3.665401432266692*^9, 3.6654016291188293`*^9, 3.6654016905138597`*^9, 
   3.6654019406916604`*^9, 3.665402056004485*^9, {3.665402163555895*^9, 
   3.6654021704067183`*^9}, 3.6654024822992334`*^9, 3.665402573053825*^9, 
   3.665402605704294*^9, 3.665402643226289*^9, 3.665403275548911*^9, 
   3.6654034225681562`*^9, 3.6654040648910847`*^9, {3.665404141063878*^9, 
   3.6654041659442315`*^9}, {3.667043890371055*^9, 3.6670439098098044`*^9}, 
   3.6675611077514086`*^9, 3.6675620269425354`*^9, 3.6675690363219886`*^9, 
   3.667626551872653*^9, 3.6676556647148037`*^9, 3.670042095678624*^9, 
   3.6727430177814074`*^9, {3.6727431280133176`*^9, 3.6727431358512115`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "60"}],
  SequenceForm["ii=", 60],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653238229370146`*^9, 3.6653238337534237`*^9}, 
   3.6653240430750847`*^9, 3.6653255613453426`*^9, 3.665325690274911*^9, 
   3.665325760656021*^9, 3.6653807692562304`*^9, 3.6653826542134953`*^9, 
   3.6653828427383046`*^9, 3.6653828787990274`*^9, 3.6653875860924587`*^9, 
   3.665387643643139*^9, 3.665387858861128*^9, 3.6653879341762657`*^9, 
   3.665388015732458*^9, 3.665388204578836*^9, 3.6653884546726146`*^9, 
   3.6653886335070763`*^9, {3.665389077683243*^9, 3.6653890863215904`*^9}, 
   3.6653891608201995`*^9, 3.6653893405836864`*^9, 3.665389828029312*^9, 
   3.665390153071544*^9, 3.6653903041460037`*^9, 3.6653904769110584`*^9, 
   3.6653945455791197`*^9, {3.665394631729479*^9, 3.665394659077984*^9}, {
   3.665394843806135*^9, 3.6653948508347178`*^9}, 3.665394939575779*^9, 
   3.6653949972498903`*^9, 3.6653951280720367`*^9, {3.665395224391192*^9, 
   3.665395232872293*^9}, 3.665395344222473*^9, 3.6653953921729913`*^9, {
   3.665395766562704*^9, 3.6653957935400486`*^9}, 3.665395885541156*^9, {
   3.6654008250519047`*^9, 3.6654008485318317`*^9}, 3.665400911233347*^9, 
   3.665401432266692*^9, 3.6654016291188293`*^9, 3.6654016905138597`*^9, 
   3.6654019406916604`*^9, 3.665402056004485*^9, {3.665402163555895*^9, 
   3.6654021704067183`*^9}, 3.6654024822992334`*^9, 3.665402573053825*^9, 
   3.665402605704294*^9, 3.665402643226289*^9, 3.665403275548911*^9, 
   3.6654034225681562`*^9, 3.6654040648910847`*^9, {3.665404141063878*^9, 
   3.6654041659442315`*^9}, {3.667043890371055*^9, 3.6670439098098044`*^9}, 
   3.6675611077514086`*^9, 3.6675620269425354`*^9, 3.6675690363219886`*^9, 
   3.667626551872653*^9, 3.6676556647148037`*^9, 3.670042095678624*^9, 
   3.6727430177814074`*^9, {3.6727431280133176`*^9, 3.672743136537266*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "70"}],
  SequenceForm["ii=", 70],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653238229370146`*^9, 3.6653238337534237`*^9}, 
   3.6653240430750847`*^9, 3.6653255613453426`*^9, 3.665325690274911*^9, 
   3.665325760656021*^9, 3.6653807692562304`*^9, 3.6653826542134953`*^9, 
   3.6653828427383046`*^9, 3.6653828787990274`*^9, 3.6653875860924587`*^9, 
   3.665387643643139*^9, 3.665387858861128*^9, 3.6653879341762657`*^9, 
   3.665388015732458*^9, 3.665388204578836*^9, 3.6653884546726146`*^9, 
   3.6653886335070763`*^9, {3.665389077683243*^9, 3.6653890863215904`*^9}, 
   3.6653891608201995`*^9, 3.6653893405836864`*^9, 3.665389828029312*^9, 
   3.665390153071544*^9, 3.6653903041460037`*^9, 3.6653904769110584`*^9, 
   3.6653945455791197`*^9, {3.665394631729479*^9, 3.665394659077984*^9}, {
   3.665394843806135*^9, 3.6653948508347178`*^9}, 3.665394939575779*^9, 
   3.6653949972498903`*^9, 3.6653951280720367`*^9, {3.665395224391192*^9, 
   3.665395232872293*^9}, 3.665395344222473*^9, 3.6653953921729913`*^9, {
   3.665395766562704*^9, 3.6653957935400486`*^9}, 3.665395885541156*^9, {
   3.6654008250519047`*^9, 3.6654008485318317`*^9}, 3.665400911233347*^9, 
   3.665401432266692*^9, 3.6654016291188293`*^9, 3.6654016905138597`*^9, 
   3.6654019406916604`*^9, 3.665402056004485*^9, {3.665402163555895*^9, 
   3.6654021704067183`*^9}, 3.6654024822992334`*^9, 3.665402573053825*^9, 
   3.665402605704294*^9, 3.665402643226289*^9, 3.665403275548911*^9, 
   3.6654034225681562`*^9, 3.6654040648910847`*^9, {3.665404141063878*^9, 
   3.6654041659442315`*^9}, {3.667043890371055*^9, 3.6670439098098044`*^9}, 
   3.6675611077514086`*^9, 3.6675620269425354`*^9, 3.6675690363219886`*^9, 
   3.667626551872653*^9, 3.6676556647148037`*^9, 3.670042095678624*^9, 
   3.6727430177814074`*^9, {3.6727431280133176`*^9, 3.672743137138837*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "80"}],
  SequenceForm["ii=", 80],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653238229370146`*^9, 3.6653238337534237`*^9}, 
   3.6653240430750847`*^9, 3.6653255613453426`*^9, 3.665325690274911*^9, 
   3.665325760656021*^9, 3.6653807692562304`*^9, 3.6653826542134953`*^9, 
   3.6653828427383046`*^9, 3.6653828787990274`*^9, 3.6653875860924587`*^9, 
   3.665387643643139*^9, 3.665387858861128*^9, 3.6653879341762657`*^9, 
   3.665388015732458*^9, 3.665388204578836*^9, 3.6653884546726146`*^9, 
   3.6653886335070763`*^9, {3.665389077683243*^9, 3.6653890863215904`*^9}, 
   3.6653891608201995`*^9, 3.6653893405836864`*^9, 3.665389828029312*^9, 
   3.665390153071544*^9, 3.6653903041460037`*^9, 3.6653904769110584`*^9, 
   3.6653945455791197`*^9, {3.665394631729479*^9, 3.665394659077984*^9}, {
   3.665394843806135*^9, 3.6653948508347178`*^9}, 3.665394939575779*^9, 
   3.6653949972498903`*^9, 3.6653951280720367`*^9, {3.665395224391192*^9, 
   3.665395232872293*^9}, 3.665395344222473*^9, 3.6653953921729913`*^9, {
   3.665395766562704*^9, 3.6653957935400486`*^9}, 3.665395885541156*^9, {
   3.6654008250519047`*^9, 3.6654008485318317`*^9}, 3.665400911233347*^9, 
   3.665401432266692*^9, 3.6654016291188293`*^9, 3.6654016905138597`*^9, 
   3.6654019406916604`*^9, 3.665402056004485*^9, {3.665402163555895*^9, 
   3.6654021704067183`*^9}, 3.6654024822992334`*^9, 3.665402573053825*^9, 
   3.665402605704294*^9, 3.665402643226289*^9, 3.665403275548911*^9, 
   3.6654034225681562`*^9, 3.6654040648910847`*^9, {3.665404141063878*^9, 
   3.6654041659442315`*^9}, {3.667043890371055*^9, 3.6670439098098044`*^9}, 
   3.6675611077514086`*^9, 3.6675620269425354`*^9, 3.6675690363219886`*^9, 
   3.667626551872653*^9, 3.6676556647148037`*^9, 3.670042095678624*^9, 
   3.6727430177814074`*^9, {3.6727431280133176`*^9, 3.6727431378403025`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "90"}],
  SequenceForm["ii=", 90],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653238229370146`*^9, 3.6653238337534237`*^9}, 
   3.6653240430750847`*^9, 3.6653255613453426`*^9, 3.665325690274911*^9, 
   3.665325760656021*^9, 3.6653807692562304`*^9, 3.6653826542134953`*^9, 
   3.6653828427383046`*^9, 3.6653828787990274`*^9, 3.6653875860924587`*^9, 
   3.665387643643139*^9, 3.665387858861128*^9, 3.6653879341762657`*^9, 
   3.665388015732458*^9, 3.665388204578836*^9, 3.6653884546726146`*^9, 
   3.6653886335070763`*^9, {3.665389077683243*^9, 3.6653890863215904`*^9}, 
   3.6653891608201995`*^9, 3.6653893405836864`*^9, 3.665389828029312*^9, 
   3.665390153071544*^9, 3.6653903041460037`*^9, 3.6653904769110584`*^9, 
   3.6653945455791197`*^9, {3.665394631729479*^9, 3.665394659077984*^9}, {
   3.665394843806135*^9, 3.6653948508347178`*^9}, 3.665394939575779*^9, 
   3.6653949972498903`*^9, 3.6653951280720367`*^9, {3.665395224391192*^9, 
   3.665395232872293*^9}, 3.665395344222473*^9, 3.6653953921729913`*^9, {
   3.665395766562704*^9, 3.6653957935400486`*^9}, 3.665395885541156*^9, {
   3.6654008250519047`*^9, 3.6654008485318317`*^9}, 3.665400911233347*^9, 
   3.665401432266692*^9, 3.6654016291188293`*^9, 3.6654016905138597`*^9, 
   3.6654019406916604`*^9, 3.665402056004485*^9, {3.665402163555895*^9, 
   3.6654021704067183`*^9}, 3.6654024822992334`*^9, 3.665402573053825*^9, 
   3.665402605704294*^9, 3.665402643226289*^9, 3.665403275548911*^9, 
   3.6654034225681562`*^9, 3.6654040648910847`*^9, {3.665404141063878*^9, 
   3.6654041659442315`*^9}, {3.667043890371055*^9, 3.6670439098098044`*^9}, 
   3.6675611077514086`*^9, 3.6675620269425354`*^9, 3.6675690363219886`*^9, 
   3.667626551872653*^9, 3.6676556647148037`*^9, 3.670042095678624*^9, 
   3.6727430177814074`*^9, {3.6727431280133176`*^9, 3.6727431387424927`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "100"}],
  SequenceForm["ii=", 100],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653238229370146`*^9, 3.6653238337534237`*^9}, 
   3.6653240430750847`*^9, 3.6653255613453426`*^9, 3.665325690274911*^9, 
   3.665325760656021*^9, 3.6653807692562304`*^9, 3.6653826542134953`*^9, 
   3.6653828427383046`*^9, 3.6653828787990274`*^9, 3.6653875860924587`*^9, 
   3.665387643643139*^9, 3.665387858861128*^9, 3.6653879341762657`*^9, 
   3.665388015732458*^9, 3.665388204578836*^9, 3.6653884546726146`*^9, 
   3.6653886335070763`*^9, {3.665389077683243*^9, 3.6653890863215904`*^9}, 
   3.6653891608201995`*^9, 3.6653893405836864`*^9, 3.665389828029312*^9, 
   3.665390153071544*^9, 3.6653903041460037`*^9, 3.6653904769110584`*^9, 
   3.6653945455791197`*^9, {3.665394631729479*^9, 3.665394659077984*^9}, {
   3.665394843806135*^9, 3.6653948508347178`*^9}, 3.665394939575779*^9, 
   3.6653949972498903`*^9, 3.6653951280720367`*^9, {3.665395224391192*^9, 
   3.665395232872293*^9}, 3.665395344222473*^9, 3.6653953921729913`*^9, {
   3.665395766562704*^9, 3.6653957935400486`*^9}, 3.665395885541156*^9, {
   3.6654008250519047`*^9, 3.6654008485318317`*^9}, 3.665400911233347*^9, 
   3.665401432266692*^9, 3.6654016291188293`*^9, 3.6654016905138597`*^9, 
   3.6654019406916604`*^9, 3.665402056004485*^9, {3.665402163555895*^9, 
   3.6654021704067183`*^9}, 3.6654024822992334`*^9, 3.665402573053825*^9, 
   3.665402605704294*^9, 3.665402643226289*^9, 3.665403275548911*^9, 
   3.6654034225681562`*^9, 3.6654040648910847`*^9, {3.665404141063878*^9, 
   3.6654041659442315`*^9}, {3.667043890371055*^9, 3.6670439098098044`*^9}, 
   3.6675611077514086`*^9, 3.6675620269425354`*^9, 3.6675690363219886`*^9, 
   3.667626551872653*^9, 3.6676556647148037`*^9, 3.670042095678624*^9, 
   3.6727430177814074`*^9, {3.6727431280133176`*^9, 3.6727431388916473`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "110"}],
  SequenceForm["ii=", 110],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653238229370146`*^9, 3.6653238337534237`*^9}, 
   3.6653240430750847`*^9, 3.6653255613453426`*^9, 3.665325690274911*^9, 
   3.665325760656021*^9, 3.6653807692562304`*^9, 3.6653826542134953`*^9, 
   3.6653828427383046`*^9, 3.6653828787990274`*^9, 3.6653875860924587`*^9, 
   3.665387643643139*^9, 3.665387858861128*^9, 3.6653879341762657`*^9, 
   3.665388015732458*^9, 3.665388204578836*^9, 3.6653884546726146`*^9, 
   3.6653886335070763`*^9, {3.665389077683243*^9, 3.6653890863215904`*^9}, 
   3.6653891608201995`*^9, 3.6653893405836864`*^9, 3.665389828029312*^9, 
   3.665390153071544*^9, 3.6653903041460037`*^9, 3.6653904769110584`*^9, 
   3.6653945455791197`*^9, {3.665394631729479*^9, 3.665394659077984*^9}, {
   3.665394843806135*^9, 3.6653948508347178`*^9}, 3.665394939575779*^9, 
   3.6653949972498903`*^9, 3.6653951280720367`*^9, {3.665395224391192*^9, 
   3.665395232872293*^9}, 3.665395344222473*^9, 3.6653953921729913`*^9, {
   3.665395766562704*^9, 3.6653957935400486`*^9}, 3.665395885541156*^9, {
   3.6654008250519047`*^9, 3.6654008485318317`*^9}, 3.665400911233347*^9, 
   3.665401432266692*^9, 3.6654016291188293`*^9, 3.6654016905138597`*^9, 
   3.6654019406916604`*^9, 3.665402056004485*^9, {3.665402163555895*^9, 
   3.6654021704067183`*^9}, 3.6654024822992334`*^9, 3.665402573053825*^9, 
   3.665402605704294*^9, 3.665402643226289*^9, 3.665403275548911*^9, 
   3.6654034225681562`*^9, 3.6654040648910847`*^9, {3.665404141063878*^9, 
   3.6654041659442315`*^9}, {3.667043890371055*^9, 3.6670439098098044`*^9}, 
   3.6675611077514086`*^9, 3.6675620269425354`*^9, 3.6675690363219886`*^9, 
   3.667626551872653*^9, 3.6676556647148037`*^9, 3.670042095678624*^9, 
   3.6727430177814074`*^9, {3.6727431280133176`*^9, 3.672743139112322*^9}}]
}, Closed]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.665318117879394*^9, 3.665318118113784*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Here", " ", "we", " ", "check", " ", "reducibilityBFTQ"}], ",", 
   " ", "reducibilityBFTedges"}], "*)"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653194611906705`*^9, 3.665319470875516*^9}, 
   3.665319696162837*^9, 3.665319923129767*^9, {3.66532084581382*^9, 
   3.6653208558484077`*^9}, 3.66532141327155*^9, 3.6653872607352314`*^9, {
   3.6653878723812013`*^9, 3.665387872807293*^9}, {3.6653882181571608`*^9, 
   3.665388220760619*^9}, {3.6653886771674967`*^9, 3.665388699256188*^9}, {
   3.665394491044639*^9, 3.6653944995239697`*^9}, {3.6653959126545773`*^9, 
   3.6653959300472593`*^9}, {3.665401327082258*^9, 3.6654013337119846`*^9}, {
   3.6654026694601145`*^9, 3.6654026949367933`*^9}, {3.6654027421141653`*^9, 
   3.665402742818636*^9}, {3.665404413579281*^9, 3.6654044182142487`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"formatrule", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["XX_", 
      RowBox[{"z1_", ",", "z2_"}]], "\[Rule]", 
     RowBox[{"XX", "[", 
      RowBox[{"z1", ",", "z2"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ii", "=", "1"}], ",", 
    RowBox[{"ii", "\[LessEqual]", "110"}], ",", 
    RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{"ii", ",", "10"}], "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<ii=\>\"", ",", "ii"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     SubscriptBox["bft", "ii"], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"a", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b", "=", 
      RowBox[{"b", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"c", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"d", "=", 
      RowBox[{"d", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", 
          RowBox[{"reducibilityBFTedges", "[", 
           RowBox[{
           "a", ",", "b", ",", "c", ",", "d", ",", "1", ",", "False", ",", 
            "True"}], "]"}], "]"}], "=!=", "List"}], "||", 
        RowBox[{
         RowBox[{"Head", "[", 
          RowBox[{"reducibilityBFTedges", "[", 
           RowBox[{
           "a", ",", "b", ",", "c", ",", "d", ",", "2", ",", "False", ",", 
            "False"}], "]"}], "]"}], "=!=", "List"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<ii=\>\"", ",", "ii", ",", 
          "\"\< : There's a problem with reducibilityBFTedges! It's not \
returning a list\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"reducibilityBFTQ", "[", 
        RowBox[{
        "a", ",", "b", ",", "c", ",", "d", ",", "1", ",", "False", ",", 
         "True"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"reducibilityBFTedges", "[", 
             RowBox[{
             "a", ",", "b", ",", "c", ",", "d", ",", "1", ",", "False", ",", 
              "True"}], "]"}], "]"}], "\[Equal]", "0"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<ii=\>\"", ",", "ii", ",", 
             "\"\< : There's a problem with reducibility! It claims \
reducibility without having any edges that can be removed\>\""}], "]"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"reducibilityBFTedges", "[", 
             RowBox[{
             "a", ",", "b", ",", "c", ",", "d", ",", "1", ",", "False", ",", 
              "True"}], "]"}], "]"}], "\[GreaterEqual]", "1"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<ii=\>\"", ",", "ii", ",", 
             "\"\< : There's a problem with reducibility! It claims that it's \
not reducible yet there are edges that can be removed without affecting the \
moduli space\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ii", "\[NotEqual]", "104"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"removeuselessedgesgauging1", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "\[Rule]", "0"}], "&"}], ",", 
           RowBox[{"reducibilityBFTedges", "[", 
            RowBox[{
            "a", ",", "b", ",", "c", ",", "d", ",", "1", ",", "False", ",", 
             "True"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"removeuselessedgesgauging2", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "\[Rule]", "0"}], "&"}], ",", 
           RowBox[{"reducibilityBFTedges", "[", 
            RowBox[{
            "a", ",", "b", ",", "c", ",", "d", ",", "2", ",", "False", ",", 
             "False"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{
             RowBox[{"turnIntoPolytope", "[", 
              RowBox[{"moduliSpaceBFT", "[", 
               RowBox[{
               "a", ",", "b", ",", "c", ",", "d", ",", "1", ",", "False", ",",
                 "True"}], "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}], "=!=", 
           RowBox[{"Length", "[", 
            RowBox[{
             RowBox[{"turnIntoPolytope", "[", 
              RowBox[{"Transpose", "[", 
               RowBox[{
                RowBox[{"Transpose", "[", 
                 RowBox[{"moduliSpaceBFT", "[", 
                  RowBox[{
                  "a", ",", "b", ",", "c", ",", "d", ",", "1", ",", "False", 
                   ",", "True"}], "]"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"survivingPerfectMatchings", "[", 
                  RowBox[{
                  "a", ",", "b", ",", "c", ",", "d", ",", 
                   "removeuselessedgesgauging1"}], "]"}], "]"}], "]"}], "]"}],
               "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<ii=\>\"", ",", "ii", ",", 
             "\"\< : There's a problem with reducibilityBFTedges using \
Gauging 1! Removing the edges that it says can be removed actually decreases \
the number of points in the moduli space\>\""}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{
             RowBox[{"turnIntoPolytope", "[", 
              RowBox[{"moduliSpaceBFT", "[", 
               RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "2"}], "]"}], 
              "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}], "=!=", 
           RowBox[{"Length", "[", 
            RowBox[{
             RowBox[{"turnIntoPolytope", "[", 
              RowBox[{"Transpose", "[", 
               RowBox[{
                RowBox[{"Transpose", "[", 
                 RowBox[{"moduliSpaceBFT", "[", 
                  RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "2"}], 
                  "]"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"survivingPerfectMatchings", "[", 
                  RowBox[{
                  "a", ",", "b", ",", "c", ",", "d", ",", 
                   "removeuselessedgesgauging2"}], "]"}], "]"}], "]"}], "]"}],
               "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<ii=\>\"", ",", "ii", ",", 
             "\"\< : There's a problem with reducibilityBFTedges using \
Gauging 2! Removing the edges that it says can be removed actually decreases \
the number of points in the moduli space\>\""}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"reducibilityBFTedges", "[", 
            RowBox[{
            "a", ",", "b", ",", "c", ",", "d", ",", "1", ",", "False", ",", 
             "True"}], "]"}], "=!=", 
           RowBox[{"Variables", "[", 
            RowBox[{"joinupKasteleyn", "[", 
             RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}]}], ",",
           "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<ii=\>\"", ",", "ii", ",", 
             "\"\< : There's a problem with reducibilityBFTedges using \
Gauging 1! When there are no perfect matchings it should match ALL \
edges\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"reducibilityBFTedges", "[", 
            RowBox[{
            "a", ",", "b", ",", "c", ",", "d", ",", "2", ",", "False", ",", 
             "False"}], "]"}], "=!=", 
           RowBox[{"Variables", "[", 
            RowBox[{"joinupKasteleyn", "[", 
             RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}]}], ",",
           "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<ii=\>\"", ",", "ii", ",", 
             "\"\< : There's a problem with reducibilityBFTedges using \
Gauging 2! When there are no perfect matchings it should match ALL \
edges\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.665318171181672*^9, 3.665318202704878*^9}, {
   3.6653183216068077`*^9, 3.6653183520994596`*^9}, {3.66531839215139*^9, 
   3.6653184111501756`*^9}, 3.6653192263125267`*^9, 3.6653192607611127`*^9, {
   3.665319433827194*^9, 3.665319470875516*^9}, {3.6653197007946744`*^9, 
   3.6653197104984245`*^9}, {3.6653202255463314`*^9, 3.665320244858407*^9}, {
   3.6653207815004144`*^9, 3.6653208951053333`*^9}, {3.6653209452862015`*^9, 
   3.66532097842157*^9}, {3.6653210227354336`*^9, 3.6653211041830716`*^9}, {
   3.665321718658688*^9, 3.6653217820570545`*^9}, {3.6653218590977*^9, 
   3.665321920578185*^9}, {3.665322195244587*^9, 3.6653222033328075`*^9}, {
   3.6653223748763256`*^9, 3.6653224330165462`*^9}, {3.66532322955106*^9, 
   3.6653232390476637`*^9}, {3.6653238225077314`*^9, 3.665323879242934*^9}, {
   3.6653239159845405`*^9, 3.665324034040783*^9}, {3.6653257558168*^9, 
   3.6653257558748393`*^9}, 3.6653807684593163`*^9, 3.665382653447832*^9, {
   3.665382822865073*^9, 3.6653828563613834`*^9}, {3.665387578430645*^9, 
   3.6653876417433176`*^9}, {3.665387772827407*^9, 3.6653879319324636`*^9}, {
   3.665387975013636*^9, 3.6653880124958487`*^9}, {3.6653881161778917`*^9, 
   3.665388203398225*^9}, {3.665388418670115*^9, 3.6653884602207074`*^9}, {
   3.6653885272304087`*^9, 3.665388540956611*^9}, {3.6653885991701355`*^9, 
   3.6653886322947865`*^9}, {3.6653887029314117`*^9, 3.665388703056418*^9}, {
   3.665389018738357*^9, 3.665389158046074*^9}, {3.665389284500309*^9, 
   3.665389339919886*^9}, {3.6653897666302986`*^9, 3.6653898363558693`*^9}, {
   3.665389910163226*^9, 3.665389961631102*^9}, {3.6653901380930347`*^9, 
   3.665390149511369*^9}, {3.665390300980686*^9, 3.6653903028178134`*^9}, {
   3.6653903445906506`*^9, 3.6653904473908606`*^9}, {3.6653945222132363`*^9, 
   3.6653945445009356`*^9}, 3.665394584118007*^9, {3.665394640528449*^9, 
   3.6653946583592005`*^9}, {3.665394756936673*^9, 3.665394939098732*^9}, {
   3.6653949871547394`*^9, 3.665394996124837*^9}, {3.6653950323304377`*^9, 
   3.6653951271812873`*^9}, {3.6653951719081173`*^9, 
   3.6653952161041775`*^9}, {3.6653952920676613`*^9, 
   3.6653953916260896`*^9}, {3.665395727510127*^9, 3.665395790959216*^9}, {
   3.665395874423108*^9, 3.6653958840790167`*^9}, {3.6653959360678654`*^9, 
   3.6653959424852996`*^9}, {3.6654007949831653`*^9, 3.66540083106148*^9}, {
   3.6654009069753437`*^9, 3.6654009105454187`*^9}, {3.6654013375229006`*^9, 
   3.665401482683831*^9}, {3.665401561238573*^9, 3.6654016288056183`*^9}, {
   3.665401687238634*^9, 3.6654016978828316`*^9}, {3.6654017896515474`*^9, 
   3.665401801485676*^9}, {3.665401916667469*^9, 3.665401961526197*^9}, {
   3.6654020054559016`*^9, 3.665402074010955*^9}, {3.665402162489502*^9, 
   3.665402169178853*^9}, {3.6654024009734545`*^9, 3.6654024774373503`*^9}, {
   3.665402529270352*^9, 3.665402642512816*^9}, {3.66540359456459*^9, 
   3.6654037344250402`*^9}, 3.665404705888384*^9, {3.6654056558030996`*^9, 
   3.6654057896821094`*^9}, {3.665405846774804*^9, 3.6654058795790367`*^9}, {
   3.66540592932271*^9, 3.665405970538746*^9}, {3.6654063124488544`*^9, 
   3.665406392345684*^9}, {3.66704394175465*^9, 3.667043942004657*^9}, {
   3.667048674228986*^9, 3.6670486812737207`*^9}, {3.667049041813013*^9, 
   3.6670490422036495`*^9}, {3.6670490769968853`*^9, 3.667049107449919*^9}, {
   3.66757013987818*^9, 3.66757015435376*^9}, {3.671545439288619*^9, 
   3.671545441111978*^9}, {3.672743150343443*^9, 3.6727431570977335`*^9}, {
   3.679911999100276*^9, 3.6799120596904607`*^9}, {3.6799120952698746`*^9, 
   3.6799121285672617`*^9}, {3.6799121933358097`*^9, 3.67991219635404*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "110"}],
  SequenceForm["ii=", 110],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653238229370146`*^9, 3.6653238337534237`*^9}, 
   3.6653240430750847`*^9, 3.6653255613453426`*^9, 3.665325690274911*^9, 
   3.665325760656021*^9, 3.6653807692562304`*^9, 3.6653826542134953`*^9, 
   3.6653828427383046`*^9, 3.6653828787990274`*^9, 3.6653875860924587`*^9, 
   3.665387643643139*^9, 3.665387858861128*^9, 3.6653879341762657`*^9, 
   3.665388015732458*^9, 3.665388204578836*^9, 3.6653884546726146`*^9, 
   3.6653886335070763`*^9, {3.665389077683243*^9, 3.6653890863215904`*^9}, 
   3.6653891608201995`*^9, 3.6653893405836864`*^9, 3.665389828029312*^9, 
   3.665390153071544*^9, 3.6653903041460037`*^9, 3.6653904769110584`*^9, 
   3.6653945455791197`*^9, {3.665394631729479*^9, 3.665394659077984*^9}, {
   3.665394843806135*^9, 3.6653948508347178`*^9}, 3.665394939575779*^9, 
   3.6653949972498903`*^9, 3.6653951280720367`*^9, {3.665395224391192*^9, 
   3.665395232872293*^9}, 3.665395344222473*^9, 3.6653953921729913`*^9, {
   3.665395766562704*^9, 3.6653957935400486`*^9}, 3.665395885541156*^9, {
   3.6654008250519047`*^9, 3.6654008485318317`*^9}, 3.665400911233347*^9, 
   3.665401432266692*^9, 3.6654016291188293`*^9, 3.6654016905138597`*^9, 
   3.6654019406916604`*^9, 3.665402056004485*^9, {3.665402163555895*^9, 
   3.6654021704067183`*^9}, 3.6654024822992334`*^9, 3.665402573053825*^9, 
   3.665402605704294*^9, 3.665402643226289*^9, 3.665403723217779*^9, 
   3.6654037539294252`*^9, 3.6654042185224657`*^9, 3.6654044220136323`*^9, 
   3.665405790396593*^9, 3.6654058897311215`*^9, 3.6654063943005123`*^9, {
   3.6670439277064457`*^9, 3.6670439425828104`*^9}, 3.6675701511020947`*^9, 
   3.667626559787416*^9, 3.6676556724212065`*^9, 3.670042102681892*^9, 
   3.672743153562826*^9}]
}, Closed]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.665318117879394*^9, 3.665318118113784*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Here", " ", "we", " ", "check", " ", "consistentEdgeRemoval"}], 
  "*)"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653194611906705`*^9, 3.665319470875516*^9}, 
   3.665319696162837*^9, 3.665319923129767*^9, {3.66532084581382*^9, 
   3.6653208558484077`*^9}, 3.66532141327155*^9, 3.6653872607352314`*^9, {
   3.6653878723812013`*^9, 3.665387872807293*^9}, {3.6653882181571608`*^9, 
   3.665388220760619*^9}, {3.6653886771674967`*^9, 3.665388699256188*^9}, {
   3.665394491044639*^9, 3.6653944995239697`*^9}, {3.6653959126545773`*^9, 
   3.6653959300472593`*^9}, {3.665401327082258*^9, 3.6654013337119846`*^9}, {
   3.6654026694601145`*^9, 3.6654026949367933`*^9}, {3.6654027421141653`*^9, 
   3.665402742818636*^9}, {3.665404413579281*^9, 3.6654044182142487`*^9}, {
   3.6654079097783484`*^9, 3.6654079121833377`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"formatrule", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["XX_", 
      RowBox[{"z1_", ",", "z2_"}]], "\[Rule]", 
     RowBox[{"XX", "[", 
      RowBox[{"z1", ",", "z2"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ii", "=", "1"}], ",", 
    RowBox[{"ii", "\[LessEqual]", "110"}], ",", 
    RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<ii=\>\"", ",", "ii"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Mod", "[", 
           RowBox[{"ii", ",", "10"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<ii=\>\"", ",", "ii"}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
     SubscriptBox["bft", "ii"], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"a", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b", "=", 
      RowBox[{"b", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"c", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"d", "=", 
      RowBox[{"d", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"tokillvars", "=", 
      RowBox[{"Subsets", "[", 
       RowBox[{
        RowBox[{"Variables", "[", 
         RowBox[{"Join", "[", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"Min", "[", 
          RowBox[{"{", 
           RowBox[{"3", ",", 
            RowBox[{"Floor", "[", 
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"Variables", "[", 
                RowBox[{"Join", "[", 
                 RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}], 
               "]"}], "/", "2"}], "]"}]}], "}"}], "]"}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "tokillvars", "]"}], ">", "5000"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tokillvars", "=", 
         RowBox[{"tokillvars", "[", 
          RowBox[{"[", 
           RowBox[{"Range", "[", "5000", "]"}], "]"}], "]"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"killededges", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"consistentEdgeRemoval", "[", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "#"}], "]"}], "&"}],
         ",", "tokillvars"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"extrakillpos", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"Position", "[", 
           RowBox[{"#", ",", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"0", ",", 
              RowBox[{
               RowBox[{"Dimensions", "[", "#", "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}], "]"}], "&"}],
         ",", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"matchingPolytope", "[", 
            RowBox[{
             RowBox[{"a", "/.", "#"}], ",", 
             RowBox[{"b", "/.", "#"}], ",", 
             RowBox[{"c", "/.", "#"}], ",", "d"}], "]"}], "&"}], ",", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "\[Rule]", "0"}], "&"}], ",", "tokillvars", ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"remainingvars", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Variables", "[", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"a", "/.", "#"}], ",", 
            RowBox[{"b", "/.", "#"}], ",", 
            RowBox[{"c", "/.", "#"}]}], "]"}], "]"}], "&"}], ",", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "\[Rule]", "0"}], "&"}], ",", "tokillvars", ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#1", "[", 
            RowBox[{"[", "#2", "]"}], "]"}], "&"}], ",", 
          RowBox[{"{", 
           RowBox[{"remainingvars", ",", "extrakillpos"}], "}"}]}], "]"}], "=!=", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Complement", ",", 
          RowBox[{"{", 
           RowBox[{"killededges", ",", "tokillvars"}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<ii=\>\"", ",", "ii", ",", 
          "\"\< : There's a problem with consistentEdgeRemoval! It doesn't \
seem to be adding the correc additional edges\>\""}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.665318171181672*^9, 3.665318202704878*^9}, {
   3.6653183216068077`*^9, 3.6653183520994596`*^9}, {3.66531839215139*^9, 
   3.6653184111501756`*^9}, 3.6653192263125267`*^9, 3.6653192607611127`*^9, {
   3.665319433827194*^9, 3.665319470875516*^9}, {3.6653197007946744`*^9, 
   3.6653197104984245`*^9}, {3.6653202255463314`*^9, 3.665320244858407*^9}, {
   3.6653207815004144`*^9, 3.6653208951053333`*^9}, {3.6653209452862015`*^9, 
   3.66532097842157*^9}, {3.6653210227354336`*^9, 3.6653211041830716`*^9}, {
   3.665321718658688*^9, 3.6653217820570545`*^9}, {3.6653218590977*^9, 
   3.665321920578185*^9}, {3.665322195244587*^9, 3.6653222033328075`*^9}, {
   3.6653223748763256`*^9, 3.6653224330165462`*^9}, {3.66532322955106*^9, 
   3.6653232390476637`*^9}, {3.6653238225077314`*^9, 3.665323879242934*^9}, {
   3.6653239159845405`*^9, 3.665324034040783*^9}, {3.6653257558168*^9, 
   3.6653257558748393`*^9}, 3.6653807684593163`*^9, 3.665382653447832*^9, {
   3.665382822865073*^9, 3.6653828563613834`*^9}, {3.665387578430645*^9, 
   3.6653876417433176`*^9}, {3.665387772827407*^9, 3.6653879319324636`*^9}, {
   3.665387975013636*^9, 3.6653880124958487`*^9}, {3.6653881161778917`*^9, 
   3.665388203398225*^9}, {3.665388418670115*^9, 3.6653884602207074`*^9}, {
   3.6653885272304087`*^9, 3.665388540956611*^9}, {3.6653885991701355`*^9, 
   3.6653886322947865`*^9}, {3.6653887029314117`*^9, 3.665388703056418*^9}, {
   3.665389018738357*^9, 3.665389158046074*^9}, {3.665389284500309*^9, 
   3.665389339919886*^9}, {3.6653897666302986`*^9, 3.6653898363558693`*^9}, {
   3.665389910163226*^9, 3.665389961631102*^9}, {3.6653901380930347`*^9, 
   3.665390149511369*^9}, {3.665390300980686*^9, 3.6653903028178134`*^9}, {
   3.6653903445906506`*^9, 3.6653904473908606`*^9}, {3.6653945222132363`*^9, 
   3.6653945445009356`*^9}, 3.665394584118007*^9, {3.665394640528449*^9, 
   3.6653946583592005`*^9}, {3.665394756936673*^9, 3.665394939098732*^9}, {
   3.6653949871547394`*^9, 3.665394996124837*^9}, {3.6653950323304377`*^9, 
   3.6653951271812873`*^9}, {3.6653951719081173`*^9, 
   3.6653952161041775`*^9}, {3.6653952920676613`*^9, 
   3.6653953916260896`*^9}, {3.665395727510127*^9, 3.665395790959216*^9}, {
   3.665395874423108*^9, 3.6653958840790167`*^9}, {3.6653959360678654`*^9, 
   3.6653959424852996`*^9}, {3.6654007949831653`*^9, 3.66540083106148*^9}, {
   3.6654009069753437`*^9, 3.6654009105454187`*^9}, {3.6654013375229006`*^9, 
   3.665401482683831*^9}, {3.665401561238573*^9, 3.6654016288056183`*^9}, {
   3.665401687238634*^9, 3.6654016978828316`*^9}, {3.6654017896515474`*^9, 
   3.665401801485676*^9}, {3.665401916667469*^9, 3.665401961526197*^9}, {
   3.6654020054559016`*^9, 3.665402074010955*^9}, {3.665402162489502*^9, 
   3.665402169178853*^9}, {3.6654024009734545`*^9, 3.6654024774373503`*^9}, {
   3.665402529270352*^9, 3.665402642512816*^9}, {3.66540359456459*^9, 
   3.6654037344250402`*^9}, 3.665404705888384*^9, {3.6654056558030996`*^9, 
   3.6654057896821094`*^9}, {3.665405846774804*^9, 3.6654058795790367`*^9}, {
   3.66540592932271*^9, 3.665405970538746*^9}, {3.6654063124488544`*^9, 
   3.665406392345684*^9}, {3.665407675135537*^9, 3.66540773921542*^9}, 
   3.665407786145232*^9, 3.6654119403721046`*^9, {3.6654223921726513`*^9, 
   3.6654223925403023`*^9}, {3.66704395225299*^9, 3.667043953616618*^9}, {
   3.6675702303249607`*^9, 3.667570230524967*^9}, 3.6715453684027324`*^9, {
   3.672743166197472*^9, 3.672743175893842*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "105"}],
  SequenceForm["ii=", 105],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653238229370146`*^9, 3.6653238337534237`*^9}, 
   3.6653240430750847`*^9, 3.6653255613453426`*^9, 3.665325690274911*^9, 
   3.665325760656021*^9, 3.6653807692562304`*^9, 3.6653826542134953`*^9, 
   3.6653828427383046`*^9, 3.6653828787990274`*^9, 3.6653875860924587`*^9, 
   3.665387643643139*^9, 3.665387858861128*^9, 3.6653879341762657`*^9, 
   3.665388015732458*^9, 3.665388204578836*^9, 3.6653884546726146`*^9, 
   3.6653886335070763`*^9, {3.665389077683243*^9, 3.6653890863215904`*^9}, 
   3.6653891608201995`*^9, 3.6653893405836864`*^9, 3.665389828029312*^9, 
   3.665390153071544*^9, 3.6653903041460037`*^9, 3.6653904769110584`*^9, 
   3.6653945455791197`*^9, {3.665394631729479*^9, 3.665394659077984*^9}, {
   3.665394843806135*^9, 3.6653948508347178`*^9}, 3.665394939575779*^9, 
   3.6653949972498903`*^9, 3.6653951280720367`*^9, {3.665395224391192*^9, 
   3.665395232872293*^9}, 3.665395344222473*^9, 3.6653953921729913`*^9, {
   3.665395766562704*^9, 3.6653957935400486`*^9}, 3.665395885541156*^9, {
   3.6654008250519047`*^9, 3.6654008485318317`*^9}, 3.665400911233347*^9, 
   3.665401432266692*^9, 3.6654016291188293`*^9, 3.6654016905138597`*^9, 
   3.6654019406916604`*^9, 3.665402056004485*^9, {3.665402163555895*^9, 
   3.6654021704067183`*^9}, 3.6654024822992334`*^9, 3.665402573053825*^9, 
   3.665402605704294*^9, 3.665402643226289*^9, 3.665403723217779*^9, 
   3.6654037539294252`*^9, 3.6654042185224657`*^9, 3.6654044220136323`*^9, 
   3.665405790396593*^9, 3.6654058897311215`*^9, 3.6654063943005123`*^9, {
   3.665407803579896*^9, 3.66540782282719*^9}, 3.6654215781483846`*^9, 
   3.6654224086789026`*^9, 3.6670439555130925`*^9, 3.667626570411331*^9, 
   3.667655682606973*^9, 3.6700421133799686`*^9, 3.672743168736261*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "106"}],
  SequenceForm["ii=", 106],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653238229370146`*^9, 3.6653238337534237`*^9}, 
   3.6653240430750847`*^9, 3.6653255613453426`*^9, 3.665325690274911*^9, 
   3.665325760656021*^9, 3.6653807692562304`*^9, 3.6653826542134953`*^9, 
   3.6653828427383046`*^9, 3.6653828787990274`*^9, 3.6653875860924587`*^9, 
   3.665387643643139*^9, 3.665387858861128*^9, 3.6653879341762657`*^9, 
   3.665388015732458*^9, 3.665388204578836*^9, 3.6653884546726146`*^9, 
   3.6653886335070763`*^9, {3.665389077683243*^9, 3.6653890863215904`*^9}, 
   3.6653891608201995`*^9, 3.6653893405836864`*^9, 3.665389828029312*^9, 
   3.665390153071544*^9, 3.6653903041460037`*^9, 3.6653904769110584`*^9, 
   3.6653945455791197`*^9, {3.665394631729479*^9, 3.665394659077984*^9}, {
   3.665394843806135*^9, 3.6653948508347178`*^9}, 3.665394939575779*^9, 
   3.6653949972498903`*^9, 3.6653951280720367`*^9, {3.665395224391192*^9, 
   3.665395232872293*^9}, 3.665395344222473*^9, 3.6653953921729913`*^9, {
   3.665395766562704*^9, 3.6653957935400486`*^9}, 3.665395885541156*^9, {
   3.6654008250519047`*^9, 3.6654008485318317`*^9}, 3.665400911233347*^9, 
   3.665401432266692*^9, 3.6654016291188293`*^9, 3.6654016905138597`*^9, 
   3.6654019406916604`*^9, 3.665402056004485*^9, {3.665402163555895*^9, 
   3.6654021704067183`*^9}, 3.6654024822992334`*^9, 3.665402573053825*^9, 
   3.665402605704294*^9, 3.665402643226289*^9, 3.665403723217779*^9, 
   3.6654037539294252`*^9, 3.6654042185224657`*^9, 3.6654044220136323`*^9, 
   3.665405790396593*^9, 3.6654058897311215`*^9, 3.6654063943005123`*^9, {
   3.665407803579896*^9, 3.66540782282719*^9}, 3.6654215781483846`*^9, 
   3.6654224086789026`*^9, 3.6670439555130925`*^9, 3.667626570411331*^9, 
   3.667655682606973*^9, 3.6700421133799686`*^9, 3.672743169105204*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "107"}],
  SequenceForm["ii=", 107],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653238229370146`*^9, 3.6653238337534237`*^9}, 
   3.6653240430750847`*^9, 3.6653255613453426`*^9, 3.665325690274911*^9, 
   3.665325760656021*^9, 3.6653807692562304`*^9, 3.6653826542134953`*^9, 
   3.6653828427383046`*^9, 3.6653828787990274`*^9, 3.6653875860924587`*^9, 
   3.665387643643139*^9, 3.665387858861128*^9, 3.6653879341762657`*^9, 
   3.665388015732458*^9, 3.665388204578836*^9, 3.6653884546726146`*^9, 
   3.6653886335070763`*^9, {3.665389077683243*^9, 3.6653890863215904`*^9}, 
   3.6653891608201995`*^9, 3.6653893405836864`*^9, 3.665389828029312*^9, 
   3.665390153071544*^9, 3.6653903041460037`*^9, 3.6653904769110584`*^9, 
   3.6653945455791197`*^9, {3.665394631729479*^9, 3.665394659077984*^9}, {
   3.665394843806135*^9, 3.6653948508347178`*^9}, 3.665394939575779*^9, 
   3.6653949972498903`*^9, 3.6653951280720367`*^9, {3.665395224391192*^9, 
   3.665395232872293*^9}, 3.665395344222473*^9, 3.6653953921729913`*^9, {
   3.665395766562704*^9, 3.6653957935400486`*^9}, 3.665395885541156*^9, {
   3.6654008250519047`*^9, 3.6654008485318317`*^9}, 3.665400911233347*^9, 
   3.665401432266692*^9, 3.6654016291188293`*^9, 3.6654016905138597`*^9, 
   3.6654019406916604`*^9, 3.665402056004485*^9, {3.665402163555895*^9, 
   3.6654021704067183`*^9}, 3.6654024822992334`*^9, 3.665402573053825*^9, 
   3.665402605704294*^9, 3.665402643226289*^9, 3.665403723217779*^9, 
   3.6654037539294252`*^9, 3.6654042185224657`*^9, 3.6654044220136323`*^9, 
   3.665405790396593*^9, 3.6654058897311215`*^9, 3.6654063943005123`*^9, {
   3.665407803579896*^9, 3.66540782282719*^9}, 3.6654215781483846`*^9, 
   3.6654224086789026`*^9, 3.6670439555130925`*^9, 3.667626570411331*^9, 
   3.667655682606973*^9, 3.6700421133799686`*^9, 3.672743169606527*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "108"}],
  SequenceForm["ii=", 108],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653238229370146`*^9, 3.6653238337534237`*^9}, 
   3.6653240430750847`*^9, 3.6653255613453426`*^9, 3.665325690274911*^9, 
   3.665325760656021*^9, 3.6653807692562304`*^9, 3.6653826542134953`*^9, 
   3.6653828427383046`*^9, 3.6653828787990274`*^9, 3.6653875860924587`*^9, 
   3.665387643643139*^9, 3.665387858861128*^9, 3.6653879341762657`*^9, 
   3.665388015732458*^9, 3.665388204578836*^9, 3.6653884546726146`*^9, 
   3.6653886335070763`*^9, {3.665389077683243*^9, 3.6653890863215904`*^9}, 
   3.6653891608201995`*^9, 3.6653893405836864`*^9, 3.665389828029312*^9, 
   3.665390153071544*^9, 3.6653903041460037`*^9, 3.6653904769110584`*^9, 
   3.6653945455791197`*^9, {3.665394631729479*^9, 3.665394659077984*^9}, {
   3.665394843806135*^9, 3.6653948508347178`*^9}, 3.665394939575779*^9, 
   3.6653949972498903`*^9, 3.6653951280720367`*^9, {3.665395224391192*^9, 
   3.665395232872293*^9}, 3.665395344222473*^9, 3.6653953921729913`*^9, {
   3.665395766562704*^9, 3.6653957935400486`*^9}, 3.665395885541156*^9, {
   3.6654008250519047`*^9, 3.6654008485318317`*^9}, 3.665400911233347*^9, 
   3.665401432266692*^9, 3.6654016291188293`*^9, 3.6654016905138597`*^9, 
   3.6654019406916604`*^9, 3.665402056004485*^9, {3.665402163555895*^9, 
   3.6654021704067183`*^9}, 3.6654024822992334`*^9, 3.665402573053825*^9, 
   3.665402605704294*^9, 3.665402643226289*^9, 3.665403723217779*^9, 
   3.6654037539294252`*^9, 3.6654042185224657`*^9, 3.6654044220136323`*^9, 
   3.665405790396593*^9, 3.6654058897311215`*^9, 3.6654063943005123`*^9, {
   3.665407803579896*^9, 3.66540782282719*^9}, 3.6654215781483846`*^9, 
   3.6654224086789026`*^9, 3.6670439555130925`*^9, 3.667626570411331*^9, 
   3.667655682606973*^9, 3.6700421133799686`*^9, 3.6727431703084116`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "109"}],
  SequenceForm["ii=", 109],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653238229370146`*^9, 3.6653238337534237`*^9}, 
   3.6653240430750847`*^9, 3.6653255613453426`*^9, 3.665325690274911*^9, 
   3.665325760656021*^9, 3.6653807692562304`*^9, 3.6653826542134953`*^9, 
   3.6653828427383046`*^9, 3.6653828787990274`*^9, 3.6653875860924587`*^9, 
   3.665387643643139*^9, 3.665387858861128*^9, 3.6653879341762657`*^9, 
   3.665388015732458*^9, 3.665388204578836*^9, 3.6653884546726146`*^9, 
   3.6653886335070763`*^9, {3.665389077683243*^9, 3.6653890863215904`*^9}, 
   3.6653891608201995`*^9, 3.6653893405836864`*^9, 3.665389828029312*^9, 
   3.665390153071544*^9, 3.6653903041460037`*^9, 3.6653904769110584`*^9, 
   3.6653945455791197`*^9, {3.665394631729479*^9, 3.665394659077984*^9}, {
   3.665394843806135*^9, 3.6653948508347178`*^9}, 3.665394939575779*^9, 
   3.6653949972498903`*^9, 3.6653951280720367`*^9, {3.665395224391192*^9, 
   3.665395232872293*^9}, 3.665395344222473*^9, 3.6653953921729913`*^9, {
   3.665395766562704*^9, 3.6653957935400486`*^9}, 3.665395885541156*^9, {
   3.6654008250519047`*^9, 3.6654008485318317`*^9}, 3.665400911233347*^9, 
   3.665401432266692*^9, 3.6654016291188293`*^9, 3.6654016905138597`*^9, 
   3.6654019406916604`*^9, 3.665402056004485*^9, {3.665402163555895*^9, 
   3.6654021704067183`*^9}, 3.6654024822992334`*^9, 3.665402573053825*^9, 
   3.665402605704294*^9, 3.665402643226289*^9, 3.665403723217779*^9, 
   3.6654037539294252`*^9, 3.6654042185224657`*^9, 3.6654044220136323`*^9, 
   3.665405790396593*^9, 3.6654058897311215`*^9, 3.6654063943005123`*^9, {
   3.665407803579896*^9, 3.66540782282719*^9}, 3.6654215781483846`*^9, 
   3.6654224086789026`*^9, 3.6670439555130925`*^9, 3.667626570411331*^9, 
   3.667655682606973*^9, 3.6700421133799686`*^9, 3.67274317174206*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "110"}],
  SequenceForm["ii=", 110],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653238229370146`*^9, 3.6653238337534237`*^9}, 
   3.6653240430750847`*^9, 3.6653255613453426`*^9, 3.665325690274911*^9, 
   3.665325760656021*^9, 3.6653807692562304`*^9, 3.6653826542134953`*^9, 
   3.6653828427383046`*^9, 3.6653828787990274`*^9, 3.6653875860924587`*^9, 
   3.665387643643139*^9, 3.665387858861128*^9, 3.6653879341762657`*^9, 
   3.665388015732458*^9, 3.665388204578836*^9, 3.6653884546726146`*^9, 
   3.6653886335070763`*^9, {3.665389077683243*^9, 3.6653890863215904`*^9}, 
   3.6653891608201995`*^9, 3.6653893405836864`*^9, 3.665389828029312*^9, 
   3.665390153071544*^9, 3.6653903041460037`*^9, 3.6653904769110584`*^9, 
   3.6653945455791197`*^9, {3.665394631729479*^9, 3.665394659077984*^9}, {
   3.665394843806135*^9, 3.6653948508347178`*^9}, 3.665394939575779*^9, 
   3.6653949972498903`*^9, 3.6653951280720367`*^9, {3.665395224391192*^9, 
   3.665395232872293*^9}, 3.665395344222473*^9, 3.6653953921729913`*^9, {
   3.665395766562704*^9, 3.6653957935400486`*^9}, 3.665395885541156*^9, {
   3.6654008250519047`*^9, 3.6654008485318317`*^9}, 3.665400911233347*^9, 
   3.665401432266692*^9, 3.6654016291188293`*^9, 3.6654016905138597`*^9, 
   3.6654019406916604`*^9, 3.665402056004485*^9, {3.665402163555895*^9, 
   3.6654021704067183`*^9}, 3.6654024822992334`*^9, 3.665402573053825*^9, 
   3.665402605704294*^9, 3.665402643226289*^9, 3.665403723217779*^9, 
   3.6654037539294252`*^9, 3.6654042185224657`*^9, 3.6654044220136323`*^9, 
   3.665405790396593*^9, 3.6654058897311215`*^9, 3.6654063943005123`*^9, {
   3.665407803579896*^9, 3.66540782282719*^9}, 3.6654215781483846`*^9, 
   3.6654224086789026`*^9, 3.6670439555130925`*^9, 3.667626570411331*^9, 
   3.667655682606973*^9, 3.6700421133799686`*^9, 3.672743171773313*^9}]
}, Closed]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.665318117879394*^9, 3.665318118113784*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Here", " ", "we", " ", "check", " ", "reductionGraphBFT"}], 
  "*)"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653194611906705`*^9, 3.665319470875516*^9}, 
   3.665319696162837*^9, 3.665319923129767*^9, {3.66532084581382*^9, 
   3.6653208558484077`*^9}, 3.66532141327155*^9, 3.6653872607352314`*^9, {
   3.6653878723812013`*^9, 3.665387872807293*^9}, {3.6653882181571608`*^9, 
   3.665388220760619*^9}, {3.6653886771674967`*^9, 3.665388699256188*^9}, {
   3.665394491044639*^9, 3.6653944995239697`*^9}, {3.6653959126545773`*^9, 
   3.6653959300472593`*^9}, {3.665401327082258*^9, 3.6654013337119846`*^9}, {
   3.6654026694601145`*^9, 3.6654026949367933`*^9}, {3.6654027421141653`*^9, 
   3.665402742818636*^9}, {3.665404413579281*^9, 3.6654044182142487`*^9}, {
   3.6654079097783484`*^9, 3.6654079121833377`*^9}, {3.6654082527535963`*^9, 
   3.6654082558298464`*^9}, 3.6655642359994807`*^9, {3.6657542065432377`*^9, 
   3.6657542078608522`*^9}, {3.6657559168596*^9, 3.665755919401446*^9}, {
   3.666540812777212*^9, 3.6665408147704124`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"formatrule", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["XX_", 
      RowBox[{"z1_", ",", "z2_"}]], "\[Rule]", 
     RowBox[{"XX", "[", 
      RowBox[{"z1", ",", "z2"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ii", "=", "1"}], ",", 
    RowBox[{"ii", "\[LessEqual]", "110"}], ",", 
    RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{"\"\<ii=\>\"", ",", "ii"}], "]"}], ";"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{"ii", ",", "10"}], "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<ii=\>\"", ",", "ii"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     SubscriptBox["bft", "ii"], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"a", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b", "=", 
      RowBox[{"b", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"c", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"d", "=", 
      RowBox[{"d", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"reductiongauging1", "=", 
      RowBox[{"reductionGraphBFT", "[", 
       RowBox[{
       "a", ",", "b", ",", "c", ",", "d", ",", "1", ",", "False", ",", 
        "True"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"moduligauging1", "=", 
      RowBox[{"moduliSpaceBFT", "[", 
       RowBox[{
       "a", ",", "b", ",", "c", ",", "d", ",", "1", ",", "False", ",", 
        "True"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"reducibilityBFTQ", "[", 
        RowBox[{
        "a", ",", "b", ",", "c", ",", "d", ",", "1", ",", "False", ",", 
         "True"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"reductiongauging1", "===", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<ii=\>\"", ",", "ii", ",", 
             "\"\< : There's a problem with reductionGraphBFT under Gauging \
1! The graph is reducible and yet reductionGraphBFT returns an empty \
list\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"reductiongauging1", "=!=", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<ii=\>\"", ",", "ii", ",", 
             "\"\< : There's a problem with reductionGraphBFT under Gauging \
1! The graph is not reducible and yet reductionGraphBFT does not return an \
empty list\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ii", "\[NotEqual]", "104"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"And", "@@", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", 
                  RowBox[{
                   RowBox[{"turnIntoPolytope", "[", 
                    RowBox[{"moduligauging1", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"survivingPerfectMatchings", "[", 
                    RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "#"}], 
                    "]"}]}], "]"}], "]"}], "]"}], "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "]"}], "===", 
                 RowBox[{"Length", "[", 
                  RowBox[{
                   RowBox[{"turnIntoPolytope", "[", "moduligauging1", "]"}], 
                   "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "&"}], ",", 
               "reductiongauging1"}], "]"}]}], ")"}], "===", "False"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<ii=\>\"", ",", "ii", ",", 
             "\"\< : There's a problem with reductionGraphBFT under Gauging \
1! Acting out on the reduction decreases the number of points in the moduli \
space\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"ii", "\[NotEqual]", "33"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "39"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "40"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "50"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "51"}]}], "*)"}], 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"reducibilityBFTedges", "[", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}], 
        "\[LessEqual]", "14"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"reductiongauging2", "=", 
         RowBox[{"reductionGraphBFT", "[", 
          RowBox[{
          "a", ",", "b", ",", "c", ",", "d", ",", "2", ",", "False", ",", 
           "True"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"moduligauging2", "=", 
         RowBox[{"moduliSpaceBFT", "[", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "2"}], "]"}]}], ";",
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"reducibilityBFTQ", "[", 
           RowBox[{
           "a", ",", "b", ",", "c", ",", "d", ",", "2", ",", "False", ",", 
            "True"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"reductiongauging2", "===", 
              RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<ii=\>\"", ",", "ii", ",", 
                "\"\< : There's a problem with reductionGraphBFT under \
Gauging 1! The graph is reducible and yet reductionGraphBFT returns an empty \
list\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"reductiongauging2", "=!=", 
              RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<ii=\>\"", ",", "ii", ",", 
                "\"\< : There's a problem with reductionGraphBFT under \
Gauging 1! The graph is not reducible and yet reductionGraphBFT does not \
return an empty list\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ii", "\[NotEqual]", "104"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"And", "@@", 
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{"turnIntoPolytope", "[", 
                    RowBox[{"moduligauging2", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"survivingPerfectMatchings", "[", 
                    RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "#"}], 
                    "]"}]}], "]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "===", 
                    RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{"turnIntoPolytope", "[", "moduligauging2", "]"}], 
                    "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "&"}], ",", 
                  "reductiongauging2"}], "]"}]}], ")"}], "===", "False"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<ii=\>\"", ",", "ii", ",", 
                "\"\< : There's a problem with reductionGraphBFT under \
Gauging 2! Acting out on the reduction decreases the number of points in the \
moduli space\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], 
  ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.665318171181672*^9, 3.665318202704878*^9}, {
   3.6653183216068077`*^9, 3.6653183520994596`*^9}, {3.66531839215139*^9, 
   3.6653184111501756`*^9}, 3.6653192263125267`*^9, 3.6653192607611127`*^9, {
   3.665319433827194*^9, 3.665319470875516*^9}, {3.6653197007946744`*^9, 
   3.6653197104984245`*^9}, {3.6653202255463314`*^9, 3.665320244858407*^9}, {
   3.6653207815004144`*^9, 3.6653208951053333`*^9}, {3.6653209452862015`*^9, 
   3.66532097842157*^9}, {3.6653210227354336`*^9, 3.6653211041830716`*^9}, {
   3.665321718658688*^9, 3.6653217820570545`*^9}, {3.6653218590977*^9, 
   3.665321920578185*^9}, {3.665322195244587*^9, 3.6653222033328075`*^9}, {
   3.6653223748763256`*^9, 3.6653224330165462`*^9}, {3.66532322955106*^9, 
   3.6653232390476637`*^9}, {3.6653238225077314`*^9, 3.665323879242934*^9}, {
   3.6653239159845405`*^9, 3.665324034040783*^9}, {3.6653257558168*^9, 
   3.6653257558748393`*^9}, 3.6653807684593163`*^9, 3.665382653447832*^9, {
   3.665382822865073*^9, 3.6653828563613834`*^9}, {3.665387578430645*^9, 
   3.6653876417433176`*^9}, {3.665387772827407*^9, 3.6653879319324636`*^9}, {
   3.665387975013636*^9, 3.6653880124958487`*^9}, {3.6653881161778917`*^9, 
   3.665388203398225*^9}, {3.665388418670115*^9, 3.6653884602207074`*^9}, {
   3.6653885272304087`*^9, 3.665388540956611*^9}, {3.6653885991701355`*^9, 
   3.6653886322947865`*^9}, {3.6653887029314117`*^9, 3.665388703056418*^9}, {
   3.665389018738357*^9, 3.665389158046074*^9}, {3.665389284500309*^9, 
   3.665389339919886*^9}, {3.6653897666302986`*^9, 3.6653898363558693`*^9}, {
   3.665389910163226*^9, 3.665389961631102*^9}, {3.6653901380930347`*^9, 
   3.665390149511369*^9}, {3.665390300980686*^9, 3.6653903028178134`*^9}, {
   3.6653903445906506`*^9, 3.6653904473908606`*^9}, {3.6653945222132363`*^9, 
   3.6653945445009356`*^9}, 3.665394584118007*^9, {3.665394640528449*^9, 
   3.6653946583592005`*^9}, {3.665394756936673*^9, 3.665394939098732*^9}, {
   3.6653949871547394`*^9, 3.665394996124837*^9}, {3.6653950323304377`*^9, 
   3.6653951271812873`*^9}, {3.6653951719081173`*^9, 
   3.6653952161041775`*^9}, {3.6653952920676613`*^9, 
   3.6653953916260896`*^9}, {3.665395727510127*^9, 3.665395790959216*^9}, {
   3.665395874423108*^9, 3.6653958840790167`*^9}, {3.6653959360678654`*^9, 
   3.6653959424852996`*^9}, {3.6654007949831653`*^9, 3.66540083106148*^9}, {
   3.6654009069753437`*^9, 3.6654009105454187`*^9}, {3.6654013375229006`*^9, 
   3.665401482683831*^9}, {3.665401561238573*^9, 3.6654016288056183`*^9}, {
   3.665401687238634*^9, 3.6654016978828316`*^9}, {3.6654017896515474`*^9, 
   3.665401801485676*^9}, {3.665401916667469*^9, 3.665401961526197*^9}, {
   3.6654020054559016`*^9, 3.665402074010955*^9}, {3.665402162489502*^9, 
   3.665402169178853*^9}, {3.6654024009734545`*^9, 3.6654024774373503`*^9}, {
   3.665402529270352*^9, 3.665402642512816*^9}, {3.66540359456459*^9, 
   3.6654037344250402`*^9}, 3.665404705888384*^9, {3.6654056558030996`*^9, 
   3.6654057896821094`*^9}, {3.665405846774804*^9, 3.6654058795790367`*^9}, {
   3.66540592932271*^9, 3.665405970538746*^9}, {3.6654063124488544`*^9, 
   3.665406392345684*^9}, {3.665407675135537*^9, 3.66540773921542*^9}, 
   3.665407786145232*^9, {3.6654080927312875`*^9, 3.665408227129405*^9}, {
   3.6654083274136167`*^9, 3.6654083284889407`*^9}, {3.6654088334270926`*^9, 
   3.665408843793948*^9}, {3.6654282095953865`*^9, 3.6654282106110644`*^9}, 
   3.665563808834973*^9, {3.6655639629368896`*^9, 3.6655640292403436`*^9}, {
   3.665564553334504*^9, 3.66556457418468*^9}, {3.6655860664666176`*^9, 
   3.665586141971321*^9}, {3.665586760242421*^9, 3.6655867720421567`*^9}, {
   3.6655869026729374`*^9, 3.665586912935709*^9}, {3.6655870771957684`*^9, 
   3.6655872014757233`*^9}, {3.6657795519084992`*^9, 3.665779573812171*^9}, {
   3.665779667073408*^9, 3.66577966718278*^9}, {3.6657873410704875`*^9, 
   3.665787387940646*^9}, {3.6657889526686296`*^9, 3.665788976622202*^9}, {
   3.6657890432441397`*^9, 3.6657890473598976`*^9}, {3.667043962814228*^9, 
   3.667043962986588*^9}, 3.6670487729477997`*^9, {3.667570859972359*^9, 
   3.66757086720671*^9}, {3.667571300244153*^9, 3.6675713040972576`*^9}, 
   3.667571419200635*^9, {3.6715454418898735`*^9, 3.6715454439924*^9}, {
   3.672743181039838*^9, 3.6727432084766207`*^9}, {3.679912208081085*^9, 
   3.67991223213721*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "110"}],
  SequenceForm["ii=", 110],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653238229370146`*^9, 3.6653238337534237`*^9}, 
   3.6653240430750847`*^9, 3.6653255613453426`*^9, 3.665325690274911*^9, 
   3.665325760656021*^9, 3.6653807692562304`*^9, 3.6653826542134953`*^9, 
   3.6653828427383046`*^9, 3.6653828787990274`*^9, 3.6653875860924587`*^9, 
   3.665387643643139*^9, 3.665387858861128*^9, 3.6653879341762657`*^9, 
   3.665388015732458*^9, 3.665388204578836*^9, 3.6653884546726146`*^9, 
   3.6653886335070763`*^9, {3.665389077683243*^9, 3.6653890863215904`*^9}, 
   3.6653891608201995`*^9, 3.6653893405836864`*^9, 3.665389828029312*^9, 
   3.665390153071544*^9, 3.6653903041460037`*^9, 3.6653904769110584`*^9, 
   3.6653945455791197`*^9, {3.665394631729479*^9, 3.665394659077984*^9}, {
   3.665394843806135*^9, 3.6653948508347178`*^9}, 3.665394939575779*^9, 
   3.6653949972498903`*^9, 3.6653951280720367`*^9, {3.665395224391192*^9, 
   3.665395232872293*^9}, 3.665395344222473*^9, 3.6653953921729913`*^9, {
   3.665395766562704*^9, 3.6653957935400486`*^9}, 3.665395885541156*^9, {
   3.6654008250519047`*^9, 3.6654008485318317`*^9}, 3.665400911233347*^9, 
   3.665401432266692*^9, 3.6654016291188293`*^9, 3.6654016905138597`*^9, 
   3.6654019406916604`*^9, 3.665402056004485*^9, {3.665402163555895*^9, 
   3.6654021704067183`*^9}, 3.6654024822992334`*^9, 3.665402573053825*^9, 
   3.665402605704294*^9, 3.665402643226289*^9, 3.665403723217779*^9, 
   3.6654037539294252`*^9, 3.6654042185224657`*^9, 3.6654044220136323`*^9, 
   3.665405790396593*^9, 3.6654058897311215`*^9, 3.6654063943005123`*^9, {
   3.665407803579896*^9, 3.66540782282719*^9}, 3.6654082282131276`*^9, 
   3.6654083320841923`*^9, 3.6655637380083303`*^9, 3.6655847836993055`*^9, {
   3.6655867746564302`*^9, 3.6655867916731043`*^9}, 3.6655869133469024`*^9, 
   3.6655871207631307`*^9, 3.6655872032615557`*^9, 3.665778715056032*^9, 
   3.665779574171558*^9, 3.6657872541766157`*^9, 3.665787388753446*^9, {
   3.665788958477269*^9, 3.6657889777406015`*^9}, 3.6657890488490596`*^9, 
   3.6665368475769033`*^9, 3.6670465591850977`*^9, 3.667570867814785*^9, 
   3.6676292378526897`*^9, 3.6676583066846476`*^9, 3.67004487522956*^9, 
   3.6727431969928145`*^9}]
}, Closed]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.665318117879394*^9, 3.665318118113784*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Here", " ", "we", " ", "check", " ", 
    RowBox[{"edgeOrderings", ".", " ", "NB"}], " ", "the", " ", "function", 
    " ", "must", " ", "be", " ", "copied", " ", "from", " ", "the", " ", 
    "package"}], ",", " ", 
   RowBox[{"because", " ", 
    RowBox[{"it", "'"}], "s", " ", "currently", " ", "in", " ", "the", " ", 
    "Private", " ", 
    RowBox[{"context", "!"}]}]}], "*)"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653194611906705`*^9, 3.665319470875516*^9}, 
   3.665319696162837*^9, 3.665319923129767*^9, {3.66532084581382*^9, 
   3.6653208558484077`*^9}, 3.66532141327155*^9, 3.6653872607352314`*^9, {
   3.6653878723812013`*^9, 3.665387872807293*^9}, {3.6653882181571608`*^9, 
   3.665388220760619*^9}, {3.6653886771674967`*^9, 3.665388699256188*^9}, {
   3.665394491044639*^9, 3.6653944995239697`*^9}, {3.6653959126545773`*^9, 
   3.6653959300472593`*^9}, {3.665401327082258*^9, 3.6654013337119846`*^9}, {
   3.6654026694601145`*^9, 3.6654026949367933`*^9}, {3.6654027421141653`*^9, 
   3.665402742818636*^9}, {3.665404413579281*^9, 3.6654044182142487`*^9}, {
   3.6654079097783484`*^9, 3.6654079121833377`*^9}, {3.6654082527535963`*^9, 
   3.6654082558298464`*^9}, 3.6655642359994807`*^9, {3.6657542065432377`*^9, 
   3.6657542078608522`*^9}, 3.6657559359339447`*^9, {3.671536929482605*^9, 
   3.6715369618089743`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"edgeOrderings", "[", 
     RowBox[{"edges_", ",", "currentedge_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"orderings", ",", "ii"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Start", " ", "with", " ", "our", " ", "current", " ", 
        RowBox[{"edge", "."}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"orderings", "=", 
         RowBox[{"{", 
          RowBox[{"Cases", "[", 
           RowBox[{"edges", ",", "currentedge"}], "]"}], "}"}]}], ";"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"orderings", "=", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"edges", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "}"}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "The", " ", "next", " ", "edge", " ", "should", " ", "have", " ", 
          "the", " ", "structure", " ", 
          RowBox[{
           RowBox[{"_", "[", 
            RowBox[{
             RowBox[{"currentedge", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", "_"}], "]"}], ".", " ", 
           "There"}], " ", "may", " ", "however", " ", "be", " ", "multiple", 
          " ", "alternatives", " ", "of", " ", "this", " ", "type"}], ",", 
         " ", 
         RowBox[{
         "and", " ", "not", " ", "all", " ", "of", " ", "them", " ", "are", 
          " ", "viable", " ", "edge", " ", "orderings", " ", "that", " ", 
          "all", " ", "match", " ", 
          RowBox[{"up", ".", " ", "For"}], " ", "for", " ", "each", " ", 
          "alternative"}], ",", " ", 
         RowBox[{
         "try", " ", "it", " ", "out", " ", "by", " ", "adding", " ", "this", 
          " ", "alternative", " ", "onto", " ", 
          RowBox[{
           RowBox[{"{", "currentedge", "}"}], ".", " ", "Ultimately"}], " ", 
          "we", " ", "only", " ", "want", " ", "to", " ", "keep", " ", 
          "those", " ", "alternatives", " ", "that", " ", "match", " ", 
          RowBox[{"up", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"ii", "=", "1"}], ",", 
         RowBox[{"ii", "<", 
          RowBox[{"Length", "[", "edges", "]"}]}], ",", 
         RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "orderings", " ", "contains", " ", "a", " ", "list", " ", "of", 
            " ", 
            RowBox[{"orderings", ".", " ", "In"}], " ", "each", " ", "case"}],
            ",", " ", 
           RowBox[{
           "try", " ", "and", " ", "tag", " ", "on", " ", "another", " ", 
            "edge", " ", "that", " ", "makes", " ", 
            RowBox[{"sense", ".", " ", "If"}], " ", "there", " ", "are", " ", 
            "none", " ", "that", " ", "make", " ", "sense"}], ",", " ", 
           RowBox[{"this", " ", "chain", " ", "of", " ", "edges", " ", 
            RowBox[{"wasn", "'"}], "t", " ", "a", " ", "viable", " ", 
            "option", " ", "for", " ", "edge", " ", "orderings"}], ",", " ", 
           RowBox[{
           "and", " ", "this", " ", "thread", " ", "will", " ", "get", " ", 
            "killed", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
               "because", " ", "the", " ", "MapThread", " ", "function", " ", 
                "will", " ", "take", " ", "an", " ", "empty", " ", "list"}], 
               ",", " ", 
               RowBox[{
               "and", " ", "it", " ", "will", " ", "Map", " ", "a", " ", 
                "Join", " ", "function", " ", "on", " ", "each", " ", 
                "element", " ", "of", " ", "the", " ", "empty", " ", "list"}],
                ",", " ", 
               RowBox[{"which", " ", "returns", " ", "an", " ", "empty", " ", 
                RowBox[{"list", ".", " ", "\"\<Sequence\>\""}], " ", "then", 
                " ", "destroys", " ", "it"}]}], ")"}], "."}]}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"orderings", "=", 
           RowBox[{"MapThread", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Sequence", "@@", 
               RowBox[{
                RowBox[{"Function", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"input1", ",", "input2"}], "}"}], ",", 
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Join", "[", 
                    RowBox[{"input1", ",", 
                    RowBox[{"{", "#", "}"}]}], "]"}], "&"}], ",", "input2"}], 
                   "]"}]}], "]"}], "[", 
                RowBox[{"#1", ",", "#2"}], "]"}]}], "&"}], ",", 
             RowBox[{"{", 
              RowBox[{"orderings", ",", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Cases", "[", 
                   RowBox[{
                    RowBox[{"Complement", "[", 
                    RowBox[{"edges", ",", "#"}], "]"}], ",", 
                    RowBox[{"_", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Last", "[", "#", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "_"}], "]"}]}], 
                   "]"}], "&"}], ",", "orderings"}], "]"}]}], "}"}]}], 
            "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"orderings", "=", 
          RowBox[{"Map", "[", 
           RowBox[{"RotateLeft", ",", "orderings"}], "]"}]}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"orderings", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"RotateLeft", "[", 
            RowBox[{"#", ",", 
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{"#", ",", "currentedge"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "]"}], "&"}], ",", 
          "orderings"}], "]"}]}], ";", "\[IndentingNewLine]", "orderings"}]}],
      "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"formatrule", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["XX_", 
      RowBox[{"z1_", ",", "z2_"}]], "\[Rule]", 
     RowBox[{"XX", "[", 
      RowBox[{"z1", ",", "z2"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ii", "=", "1"}], ",", 
    RowBox[{"ii", "\[LessEqual]", "110"}], ",", 
    RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{"ii", ",", "10"}], "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<ii=\>\"", ",", "ii"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     SubscriptBox["bft", "ii"], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"a", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b", "=", 
      RowBox[{"b", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"c", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"d", "=", 
      RowBox[{"d", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"kasteleyn", "=", 
      RowBox[{"joinupKasteleyn", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"And", "@@", 
           RowBox[{"MapThread", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"#1", "\[Equal]", 
               RowBox[{"ConstantArray", "[", 
                RowBox[{
                 RowBox[{"Length", "[", 
                  RowBox[{"Variables", "[", "#2", "]"}], "]"}], ",", 
                 RowBox[{"Length", "[", "#1", "]"}]}], "]"}]}], "&"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Map", "[", 
                RowBox[{"Length", ",", 
                 RowBox[{"Map", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"edgeOrderings", "[", 
                    RowBox[{
                    RowBox[{"Variables", "[", "#", "]"}], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", "#", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "&"}], ",", 
                   RowBox[{"Cases", "[", 
                    RowBox[{"kasteleyn", ",", 
                    RowBox[{"{", 
                    RowBox[{"___", ",", 
                    RowBox[{"Except", "[", "0", "]"}], ",", "___"}], "}"}]}], 
                    "]"}]}], "]"}], ",", 
                 RowBox[{"{", "2", "}"}]}], "]"}], ",", 
               RowBox[{"Cases", "[", 
                RowBox[{"kasteleyn", ",", 
                 RowBox[{"{", 
                  RowBox[{"___", ",", 
                   RowBox[{"Except", "[", "0", "]"}], ",", "___"}], "}"}]}], 
                "]"}]}], "}"}]}], "]"}]}], ")"}], "\[Equal]", "False"}], "||", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"And", "@@", 
           RowBox[{"MapThread", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"#1", "\[Equal]", 
               RowBox[{"ConstantArray", "[", 
                RowBox[{
                 RowBox[{"Length", "[", 
                  RowBox[{"Variables", "[", "#2", "]"}], "]"}], ",", 
                 RowBox[{"Length", "[", "#1", "]"}]}], "]"}]}], "&"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Map", "[", 
                RowBox[{"Length", ",", 
                 RowBox[{"Map", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"edgeOrderings", "[", 
                    RowBox[{
                    RowBox[{"Variables", "[", "#", "]"}], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", "#", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "&"}], ",", 
                   RowBox[{"Cases", "[", 
                    RowBox[{
                    RowBox[{"Transpose", "[", "kasteleyn", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"___", ",", 
                    RowBox[{"Except", "[", "0", "]"}], ",", "___"}], "}"}]}], 
                    "]"}]}], "]"}], ",", 
                 RowBox[{"{", "2", "}"}]}], "]"}], ",", 
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{"Transpose", "[", "kasteleyn", "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"___", ",", 
                   RowBox[{"Except", "[", "0", "]"}], ",", "___"}], "}"}]}], 
                "]"}]}], "}"}]}], "]"}]}], ")"}], "\[Equal]", "False"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<ii=\>\"", ",", "ii", ",", 
          "\"\< : There's a problem with edgeOrderings! It returns a list \
which doesn't have the right length\>\""}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"And", "@@", 
           RowBox[{"Flatten", "[", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Sum", "[", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], "iii"], 
                   RowBox[{"#", "[", 
                    RowBox[{"[", "iii", "]"}], "]"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"iii", ",", 
                    RowBox[{"Length", "[", "#", "]"}]}], "}"}]}], "]"}], 
                "\[Equal]", "0"}], "&"}], ",", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Sequence", "@@", "#"}], "&"}], ",", 
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"edgeOrderings", "[", 
                    RowBox[{
                    RowBox[{"Variables", "[", "#", "]"}], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", "#", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "&"}], ",", 
                  RowBox[{"kasteleyn", "[", 
                   RowBox[{"[", 
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "[", "a", "]"}], "]"}], "]"}], "]"}]}], 
                 "]"}], ",", 
                RowBox[{"{", "3", "}"}]}], "]"}], ",", 
              RowBox[{"{", "2", "}"}]}], "]"}], "]"}]}], ")"}], "\[Equal]", 
         "False"}], "||", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"And", "@@", 
           RowBox[{"Flatten", "[", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Sum", "[", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], "iii"], 
                   RowBox[{"#", "[", 
                    RowBox[{"[", "iii", "]"}], "]"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"iii", ",", 
                    RowBox[{"Length", "[", "#", "]"}]}], "}"}]}], "]"}], 
                "\[Equal]", "0"}], "&"}], ",", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Sequence", "@@", "#"}], "&"}], ",", 
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"edgeOrderings", "[", 
                    RowBox[{
                    RowBox[{"Variables", "[", "#", "]"}], ",", 
                    RowBox[{
                    RowBox[{"Variables", "[", "#", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "&"}], ",", 
                  RowBox[{
                   RowBox[{"Transpose", "[", "kasteleyn", "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"Dimensions", "[", "a", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "]"}]}], 
                 "]"}], ",", 
                RowBox[{"{", "3", "}"}]}], "]"}], ",", 
              RowBox[{"{", "2", "}"}]}], "]"}], "]"}]}], ")"}], "\[Equal]", 
         "False"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<ii=\>\"", ",", "ii", ",", 
          "\"\< : There's a problem with edgeOrderings! The index structure \
in the lists doesn't make sense\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]",
       "]"}], ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], 
  ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.665318171181672*^9, 3.665318202704878*^9}, {
   3.6653183216068077`*^9, 3.6653183520994596`*^9}, {3.66531839215139*^9, 
   3.6653184111501756`*^9}, 3.6653192263125267`*^9, 3.6653192607611127`*^9, {
   3.665319433827194*^9, 3.665319470875516*^9}, {3.6653197007946744`*^9, 
   3.6653197104984245`*^9}, {3.6653202255463314`*^9, 3.665320244858407*^9}, {
   3.6653207815004144`*^9, 3.6653208951053333`*^9}, {3.6653209452862015`*^9, 
   3.66532097842157*^9}, {3.6653210227354336`*^9, 3.6653211041830716`*^9}, {
   3.665321718658688*^9, 3.6653217820570545`*^9}, {3.6653218590977*^9, 
   3.665321920578185*^9}, {3.665322195244587*^9, 3.6653222033328075`*^9}, {
   3.6653223748763256`*^9, 3.6653224330165462`*^9}, {3.66532322955106*^9, 
   3.6653232390476637`*^9}, {3.6653238225077314`*^9, 3.665323879242934*^9}, {
   3.6653239159845405`*^9, 3.665324034040783*^9}, {3.6653257558168*^9, 
   3.6653257558748393`*^9}, 3.6653807684593163`*^9, 3.665382653447832*^9, {
   3.665382822865073*^9, 3.6653828563613834`*^9}, {3.665387578430645*^9, 
   3.6653876417433176`*^9}, {3.665387772827407*^9, 3.6653879319324636`*^9}, {
   3.665387975013636*^9, 3.6653880124958487`*^9}, {3.6653881161778917`*^9, 
   3.665388203398225*^9}, {3.665388418670115*^9, 3.6653884602207074`*^9}, {
   3.6653885272304087`*^9, 3.665388540956611*^9}, {3.6653885991701355`*^9, 
   3.6653886322947865`*^9}, {3.6653887029314117`*^9, 3.665388703056418*^9}, {
   3.665389018738357*^9, 3.665389158046074*^9}, {3.665389284500309*^9, 
   3.665389339919886*^9}, {3.6653897666302986`*^9, 3.6653898363558693`*^9}, {
   3.665389910163226*^9, 3.665389961631102*^9}, {3.6653901380930347`*^9, 
   3.665390149511369*^9}, {3.665390300980686*^9, 3.6653903028178134`*^9}, {
   3.6653903445906506`*^9, 3.6653904473908606`*^9}, {3.6653945222132363`*^9, 
   3.6653945445009356`*^9}, 3.665394584118007*^9, {3.665394640528449*^9, 
   3.6653946583592005`*^9}, {3.665394756936673*^9, 3.665394939098732*^9}, {
   3.6653949871547394`*^9, 3.665394996124837*^9}, {3.6653950323304377`*^9, 
   3.6653951271812873`*^9}, {3.6653951719081173`*^9, 
   3.6653952161041775`*^9}, {3.6653952920676613`*^9, 
   3.6653953916260896`*^9}, {3.665395727510127*^9, 3.665395790959216*^9}, {
   3.665395874423108*^9, 3.6653958840790167`*^9}, {3.6653959360678654`*^9, 
   3.6653959424852996`*^9}, {3.6654007949831653`*^9, 3.66540083106148*^9}, {
   3.6654009069753437`*^9, 3.6654009105454187`*^9}, {3.6654013375229006`*^9, 
   3.665401482683831*^9}, {3.665401561238573*^9, 3.6654016288056183`*^9}, {
   3.665401687238634*^9, 3.6654016978828316`*^9}, {3.6654017896515474`*^9, 
   3.665401801485676*^9}, {3.665401916667469*^9, 3.665401961526197*^9}, {
   3.6654020054559016`*^9, 3.665402074010955*^9}, {3.665402162489502*^9, 
   3.665402169178853*^9}, {3.6654024009734545`*^9, 3.6654024774373503`*^9}, {
   3.665402529270352*^9, 3.665402642512816*^9}, {3.66540359456459*^9, 
   3.6654037344250402`*^9}, 3.665404705888384*^9, {3.6654056558030996`*^9, 
   3.6654057896821094`*^9}, {3.665405846774804*^9, 3.6654058795790367`*^9}, {
   3.66540592932271*^9, 3.665405970538746*^9}, {3.6654063124488544`*^9, 
   3.665406392345684*^9}, {3.665407675135537*^9, 3.66540773921542*^9}, 
   3.665407786145232*^9, {3.6654080927312875`*^9, 3.665408227129405*^9}, {
   3.6654083274136167`*^9, 3.6654083284889407`*^9}, {3.6654088334270926`*^9, 
   3.665408843793948*^9}, {3.6654282095953865`*^9, 3.6654282106110644`*^9}, 
   3.665563808834973*^9, {3.6655639629368896`*^9, 3.6655640292403436`*^9}, {
   3.665564553334504*^9, 3.66556457418468*^9}, {3.6655860664666176`*^9, 
   3.665586141971321*^9}, {3.665586760242421*^9, 3.6655867720421567`*^9}, {
   3.6655869026729374`*^9, 3.665586912935709*^9}, {3.6655870771957684`*^9, 
   3.6655872014757233`*^9}, {3.665755447616467*^9, 3.665755522012611*^9}, {
   3.665755881266376*^9, 3.665755881566531*^9}, {3.667046833550001*^9, 
   3.667046833737506*^9}, {3.6675714350392127`*^9, 3.66757145118416*^9}, {
   3.671536926105946*^9, 3.671536926661165*^9}, {3.672743218473771*^9, 
   3.6727432624238963`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "10"}],
  SequenceForm["ii=", 10],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653238229370146`*^9, 3.6653238337534237`*^9}, 
   3.6653240430750847`*^9, 3.6653255613453426`*^9, 3.665325690274911*^9, 
   3.665325760656021*^9, 3.6653807692562304`*^9, 3.6653826542134953`*^9, 
   3.6653828427383046`*^9, 3.6653828787990274`*^9, 3.6653875860924587`*^9, 
   3.665387643643139*^9, 3.665387858861128*^9, 3.6653879341762657`*^9, 
   3.665388015732458*^9, 3.665388204578836*^9, 3.6653884546726146`*^9, 
   3.6653886335070763`*^9, {3.665389077683243*^9, 3.6653890863215904`*^9}, 
   3.6653891608201995`*^9, 3.6653893405836864`*^9, 3.665389828029312*^9, 
   3.665390153071544*^9, 3.6653903041460037`*^9, 3.6653904769110584`*^9, 
   3.6653945455791197`*^9, {3.665394631729479*^9, 3.665394659077984*^9}, {
   3.665394843806135*^9, 3.6653948508347178`*^9}, 3.665394939575779*^9, 
   3.6653949972498903`*^9, 3.6653951280720367`*^9, {3.665395224391192*^9, 
   3.665395232872293*^9}, 3.665395344222473*^9, 3.6653953921729913`*^9, {
   3.665395766562704*^9, 3.6653957935400486`*^9}, 3.665395885541156*^9, {
   3.6654008250519047`*^9, 3.6654008485318317`*^9}, 3.665400911233347*^9, 
   3.665401432266692*^9, 3.6654016291188293`*^9, 3.6654016905138597`*^9, 
   3.6654019406916604`*^9, 3.665402056004485*^9, {3.665402163555895*^9, 
   3.6654021704067183`*^9}, 3.6654024822992334`*^9, 3.665402573053825*^9, 
   3.665402605704294*^9, 3.665402643226289*^9, 3.665403723217779*^9, 
   3.6654037539294252`*^9, 3.6654042185224657`*^9, 3.6654044220136323`*^9, 
   3.665405790396593*^9, 3.6654058897311215`*^9, 3.6654063943005123`*^9, {
   3.665407803579896*^9, 3.66540782282719*^9}, 3.6654082282131276`*^9, 
   3.6654083320841923`*^9, 3.6655637380083303`*^9, 3.6655847836993055`*^9, {
   3.6655867746564302`*^9, 3.6655867916731043`*^9}, 3.6655869133469024`*^9, 
   3.6655871207631307`*^9, 3.6655872032615557`*^9, 3.6657554769691753`*^9, 
   3.665755522544571*^9, 3.665755882999752*^9, 3.6670468377251225`*^9, 
   3.6675714489114695`*^9, 3.667629385593334*^9, 3.6676584557358885`*^9, 
   3.6700450338930597`*^9, 3.672743230411939*^9, 3.672743269002137*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "20"}],
  SequenceForm["ii=", 20],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653238229370146`*^9, 3.6653238337534237`*^9}, 
   3.6653240430750847`*^9, 3.6653255613453426`*^9, 3.665325690274911*^9, 
   3.665325760656021*^9, 3.6653807692562304`*^9, 3.6653826542134953`*^9, 
   3.6653828427383046`*^9, 3.6653828787990274`*^9, 3.6653875860924587`*^9, 
   3.665387643643139*^9, 3.665387858861128*^9, 3.6653879341762657`*^9, 
   3.665388015732458*^9, 3.665388204578836*^9, 3.6653884546726146`*^9, 
   3.6653886335070763`*^9, {3.665389077683243*^9, 3.6653890863215904`*^9}, 
   3.6653891608201995`*^9, 3.6653893405836864`*^9, 3.665389828029312*^9, 
   3.665390153071544*^9, 3.6653903041460037`*^9, 3.6653904769110584`*^9, 
   3.6653945455791197`*^9, {3.665394631729479*^9, 3.665394659077984*^9}, {
   3.665394843806135*^9, 3.6653948508347178`*^9}, 3.665394939575779*^9, 
   3.6653949972498903`*^9, 3.6653951280720367`*^9, {3.665395224391192*^9, 
   3.665395232872293*^9}, 3.665395344222473*^9, 3.6653953921729913`*^9, {
   3.665395766562704*^9, 3.6653957935400486`*^9}, 3.665395885541156*^9, {
   3.6654008250519047`*^9, 3.6654008485318317`*^9}, 3.665400911233347*^9, 
   3.665401432266692*^9, 3.6654016291188293`*^9, 3.6654016905138597`*^9, 
   3.6654019406916604`*^9, 3.665402056004485*^9, {3.665402163555895*^9, 
   3.6654021704067183`*^9}, 3.6654024822992334`*^9, 3.665402573053825*^9, 
   3.665402605704294*^9, 3.665402643226289*^9, 3.665403723217779*^9, 
   3.6654037539294252`*^9, 3.6654042185224657`*^9, 3.6654044220136323`*^9, 
   3.665405790396593*^9, 3.6654058897311215`*^9, 3.6654063943005123`*^9, {
   3.665407803579896*^9, 3.66540782282719*^9}, 3.6654082282131276`*^9, 
   3.6654083320841923`*^9, 3.6655637380083303`*^9, 3.6655847836993055`*^9, {
   3.6655867746564302`*^9, 3.6655867916731043`*^9}, 3.6655869133469024`*^9, 
   3.6655871207631307`*^9, 3.6655872032615557`*^9, 3.6657554769691753`*^9, 
   3.665755522544571*^9, 3.665755882999752*^9, 3.6670468377251225`*^9, 
   3.6675714489114695`*^9, 3.667629385593334*^9, 3.6676584557358885`*^9, 
   3.6700450338930597`*^9, 3.672743230411939*^9, 3.672743269049017*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "30"}],
  SequenceForm["ii=", 30],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653238229370146`*^9, 3.6653238337534237`*^9}, 
   3.6653240430750847`*^9, 3.6653255613453426`*^9, 3.665325690274911*^9, 
   3.665325760656021*^9, 3.6653807692562304`*^9, 3.6653826542134953`*^9, 
   3.6653828427383046`*^9, 3.6653828787990274`*^9, 3.6653875860924587`*^9, 
   3.665387643643139*^9, 3.665387858861128*^9, 3.6653879341762657`*^9, 
   3.665388015732458*^9, 3.665388204578836*^9, 3.6653884546726146`*^9, 
   3.6653886335070763`*^9, {3.665389077683243*^9, 3.6653890863215904`*^9}, 
   3.6653891608201995`*^9, 3.6653893405836864`*^9, 3.665389828029312*^9, 
   3.665390153071544*^9, 3.6653903041460037`*^9, 3.6653904769110584`*^9, 
   3.6653945455791197`*^9, {3.665394631729479*^9, 3.665394659077984*^9}, {
   3.665394843806135*^9, 3.6653948508347178`*^9}, 3.665394939575779*^9, 
   3.6653949972498903`*^9, 3.6653951280720367`*^9, {3.665395224391192*^9, 
   3.665395232872293*^9}, 3.665395344222473*^9, 3.6653953921729913`*^9, {
   3.665395766562704*^9, 3.6653957935400486`*^9}, 3.665395885541156*^9, {
   3.6654008250519047`*^9, 3.6654008485318317`*^9}, 3.665400911233347*^9, 
   3.665401432266692*^9, 3.6654016291188293`*^9, 3.6654016905138597`*^9, 
   3.6654019406916604`*^9, 3.665402056004485*^9, {3.665402163555895*^9, 
   3.6654021704067183`*^9}, 3.6654024822992334`*^9, 3.665402573053825*^9, 
   3.665402605704294*^9, 3.665402643226289*^9, 3.665403723217779*^9, 
   3.6654037539294252`*^9, 3.6654042185224657`*^9, 3.6654044220136323`*^9, 
   3.665405790396593*^9, 3.6654058897311215`*^9, 3.6654063943005123`*^9, {
   3.665407803579896*^9, 3.66540782282719*^9}, 3.6654082282131276`*^9, 
   3.6654083320841923`*^9, 3.6655637380083303`*^9, 3.6655847836993055`*^9, {
   3.6655867746564302`*^9, 3.6655867916731043`*^9}, 3.6655869133469024`*^9, 
   3.6655871207631307`*^9, 3.6655872032615557`*^9, 3.6657554769691753`*^9, 
   3.665755522544571*^9, 3.665755882999752*^9, 3.6670468377251225`*^9, 
   3.6675714489114695`*^9, 3.667629385593334*^9, 3.6676584557358885`*^9, 
   3.6700450338930597`*^9, 3.672743230411939*^9, 3.6727432691024103`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "40"}],
  SequenceForm["ii=", 40],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653238229370146`*^9, 3.6653238337534237`*^9}, 
   3.6653240430750847`*^9, 3.6653255613453426`*^9, 3.665325690274911*^9, 
   3.665325760656021*^9, 3.6653807692562304`*^9, 3.6653826542134953`*^9, 
   3.6653828427383046`*^9, 3.6653828787990274`*^9, 3.6653875860924587`*^9, 
   3.665387643643139*^9, 3.665387858861128*^9, 3.6653879341762657`*^9, 
   3.665388015732458*^9, 3.665388204578836*^9, 3.6653884546726146`*^9, 
   3.6653886335070763`*^9, {3.665389077683243*^9, 3.6653890863215904`*^9}, 
   3.6653891608201995`*^9, 3.6653893405836864`*^9, 3.665389828029312*^9, 
   3.665390153071544*^9, 3.6653903041460037`*^9, 3.6653904769110584`*^9, 
   3.6653945455791197`*^9, {3.665394631729479*^9, 3.665394659077984*^9}, {
   3.665394843806135*^9, 3.6653948508347178`*^9}, 3.665394939575779*^9, 
   3.6653949972498903`*^9, 3.6653951280720367`*^9, {3.665395224391192*^9, 
   3.665395232872293*^9}, 3.665395344222473*^9, 3.6653953921729913`*^9, {
   3.665395766562704*^9, 3.6653957935400486`*^9}, 3.665395885541156*^9, {
   3.6654008250519047`*^9, 3.6654008485318317`*^9}, 3.665400911233347*^9, 
   3.665401432266692*^9, 3.6654016291188293`*^9, 3.6654016905138597`*^9, 
   3.6654019406916604`*^9, 3.665402056004485*^9, {3.665402163555895*^9, 
   3.6654021704067183`*^9}, 3.6654024822992334`*^9, 3.665402573053825*^9, 
   3.665402605704294*^9, 3.665402643226289*^9, 3.665403723217779*^9, 
   3.6654037539294252`*^9, 3.6654042185224657`*^9, 3.6654044220136323`*^9, 
   3.665405790396593*^9, 3.6654058897311215`*^9, 3.6654063943005123`*^9, {
   3.665407803579896*^9, 3.66540782282719*^9}, 3.6654082282131276`*^9, 
   3.6654083320841923`*^9, 3.6655637380083303`*^9, 3.6655847836993055`*^9, {
   3.6655867746564302`*^9, 3.6655867916731043`*^9}, 3.6655869133469024`*^9, 
   3.6655871207631307`*^9, 3.6655872032615557`*^9, 3.6657554769691753`*^9, 
   3.665755522544571*^9, 3.665755882999752*^9, 3.6670468377251225`*^9, 
   3.6675714489114695`*^9, 3.667629385593334*^9, 3.6676584557358885`*^9, 
   3.6700450338930597`*^9, 3.672743230411939*^9, 3.67274326914929*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "50"}],
  SequenceForm["ii=", 50],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653238229370146`*^9, 3.6653238337534237`*^9}, 
   3.6653240430750847`*^9, 3.6653255613453426`*^9, 3.665325690274911*^9, 
   3.665325760656021*^9, 3.6653807692562304`*^9, 3.6653826542134953`*^9, 
   3.6653828427383046`*^9, 3.6653828787990274`*^9, 3.6653875860924587`*^9, 
   3.665387643643139*^9, 3.665387858861128*^9, 3.6653879341762657`*^9, 
   3.665388015732458*^9, 3.665388204578836*^9, 3.6653884546726146`*^9, 
   3.6653886335070763`*^9, {3.665389077683243*^9, 3.6653890863215904`*^9}, 
   3.6653891608201995`*^9, 3.6653893405836864`*^9, 3.665389828029312*^9, 
   3.665390153071544*^9, 3.6653903041460037`*^9, 3.6653904769110584`*^9, 
   3.6653945455791197`*^9, {3.665394631729479*^9, 3.665394659077984*^9}, {
   3.665394843806135*^9, 3.6653948508347178`*^9}, 3.665394939575779*^9, 
   3.6653949972498903`*^9, 3.6653951280720367`*^9, {3.665395224391192*^9, 
   3.665395232872293*^9}, 3.665395344222473*^9, 3.6653953921729913`*^9, {
   3.665395766562704*^9, 3.6653957935400486`*^9}, 3.665395885541156*^9, {
   3.6654008250519047`*^9, 3.6654008485318317`*^9}, 3.665400911233347*^9, 
   3.665401432266692*^9, 3.6654016291188293`*^9, 3.6654016905138597`*^9, 
   3.6654019406916604`*^9, 3.665402056004485*^9, {3.665402163555895*^9, 
   3.6654021704067183`*^9}, 3.6654024822992334`*^9, 3.665402573053825*^9, 
   3.665402605704294*^9, 3.665402643226289*^9, 3.665403723217779*^9, 
   3.6654037539294252`*^9, 3.6654042185224657`*^9, 3.6654044220136323`*^9, 
   3.665405790396593*^9, 3.6654058897311215`*^9, 3.6654063943005123`*^9, {
   3.665407803579896*^9, 3.66540782282719*^9}, 3.6654082282131276`*^9, 
   3.6654083320841923`*^9, 3.6655637380083303`*^9, 3.6655847836993055`*^9, {
   3.6655867746564302`*^9, 3.6655867916731043`*^9}, 3.6655869133469024`*^9, 
   3.6655871207631307`*^9, 3.6655872032615557`*^9, 3.6657554769691753`*^9, 
   3.665755522544571*^9, 3.665755882999752*^9, 3.6670468377251225`*^9, 
   3.6675714489114695`*^9, 3.667629385593334*^9, 3.6676584557358885`*^9, 
   3.6700450338930597`*^9, 3.672743230411939*^9, 3.6727432692022266`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "60"}],
  SequenceForm["ii=", 60],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653238229370146`*^9, 3.6653238337534237`*^9}, 
   3.6653240430750847`*^9, 3.6653255613453426`*^9, 3.665325690274911*^9, 
   3.665325760656021*^9, 3.6653807692562304`*^9, 3.6653826542134953`*^9, 
   3.6653828427383046`*^9, 3.6653828787990274`*^9, 3.6653875860924587`*^9, 
   3.665387643643139*^9, 3.665387858861128*^9, 3.6653879341762657`*^9, 
   3.665388015732458*^9, 3.665388204578836*^9, 3.6653884546726146`*^9, 
   3.6653886335070763`*^9, {3.665389077683243*^9, 3.6653890863215904`*^9}, 
   3.6653891608201995`*^9, 3.6653893405836864`*^9, 3.665389828029312*^9, 
   3.665390153071544*^9, 3.6653903041460037`*^9, 3.6653904769110584`*^9, 
   3.6653945455791197`*^9, {3.665394631729479*^9, 3.665394659077984*^9}, {
   3.665394843806135*^9, 3.6653948508347178`*^9}, 3.665394939575779*^9, 
   3.6653949972498903`*^9, 3.6653951280720367`*^9, {3.665395224391192*^9, 
   3.665395232872293*^9}, 3.665395344222473*^9, 3.6653953921729913`*^9, {
   3.665395766562704*^9, 3.6653957935400486`*^9}, 3.665395885541156*^9, {
   3.6654008250519047`*^9, 3.6654008485318317`*^9}, 3.665400911233347*^9, 
   3.665401432266692*^9, 3.6654016291188293`*^9, 3.6654016905138597`*^9, 
   3.6654019406916604`*^9, 3.665402056004485*^9, {3.665402163555895*^9, 
   3.6654021704067183`*^9}, 3.6654024822992334`*^9, 3.665402573053825*^9, 
   3.665402605704294*^9, 3.665402643226289*^9, 3.665403723217779*^9, 
   3.6654037539294252`*^9, 3.6654042185224657`*^9, 3.6654044220136323`*^9, 
   3.665405790396593*^9, 3.6654058897311215`*^9, 3.6654063943005123`*^9, {
   3.665407803579896*^9, 3.66540782282719*^9}, 3.6654082282131276`*^9, 
   3.6654083320841923`*^9, 3.6655637380083303`*^9, 3.6655847836993055`*^9, {
   3.6655867746564302`*^9, 3.6655867916731043`*^9}, 3.6655869133469024`*^9, 
   3.6655871207631307`*^9, 3.6655872032615557`*^9, 3.6657554769691753`*^9, 
   3.665755522544571*^9, 3.665755882999752*^9, 3.6670468377251225`*^9, 
   3.6675714489114695`*^9, 3.667629385593334*^9, 3.6676584557358885`*^9, 
   3.6700450338930597`*^9, 3.672743230411939*^9, 3.6727432692491055`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "70"}],
  SequenceForm["ii=", 70],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653238229370146`*^9, 3.6653238337534237`*^9}, 
   3.6653240430750847`*^9, 3.6653255613453426`*^9, 3.665325690274911*^9, 
   3.665325760656021*^9, 3.6653807692562304`*^9, 3.6653826542134953`*^9, 
   3.6653828427383046`*^9, 3.6653828787990274`*^9, 3.6653875860924587`*^9, 
   3.665387643643139*^9, 3.665387858861128*^9, 3.6653879341762657`*^9, 
   3.665388015732458*^9, 3.665388204578836*^9, 3.6653884546726146`*^9, 
   3.6653886335070763`*^9, {3.665389077683243*^9, 3.6653890863215904`*^9}, 
   3.6653891608201995`*^9, 3.6653893405836864`*^9, 3.665389828029312*^9, 
   3.665390153071544*^9, 3.6653903041460037`*^9, 3.6653904769110584`*^9, 
   3.6653945455791197`*^9, {3.665394631729479*^9, 3.665394659077984*^9}, {
   3.665394843806135*^9, 3.6653948508347178`*^9}, 3.665394939575779*^9, 
   3.6653949972498903`*^9, 3.6653951280720367`*^9, {3.665395224391192*^9, 
   3.665395232872293*^9}, 3.665395344222473*^9, 3.6653953921729913`*^9, {
   3.665395766562704*^9, 3.6653957935400486`*^9}, 3.665395885541156*^9, {
   3.6654008250519047`*^9, 3.6654008485318317`*^9}, 3.665400911233347*^9, 
   3.665401432266692*^9, 3.6654016291188293`*^9, 3.6654016905138597`*^9, 
   3.6654019406916604`*^9, 3.665402056004485*^9, {3.665402163555895*^9, 
   3.6654021704067183`*^9}, 3.6654024822992334`*^9, 3.665402573053825*^9, 
   3.665402605704294*^9, 3.665402643226289*^9, 3.665403723217779*^9, 
   3.6654037539294252`*^9, 3.6654042185224657`*^9, 3.6654044220136323`*^9, 
   3.665405790396593*^9, 3.6654058897311215`*^9, 3.6654063943005123`*^9, {
   3.665407803579896*^9, 3.66540782282719*^9}, 3.6654082282131276`*^9, 
   3.6654083320841923`*^9, 3.6655637380083303`*^9, 3.6655847836993055`*^9, {
   3.6655867746564302`*^9, 3.6655867916731043`*^9}, 3.6655869133469024`*^9, 
   3.6655871207631307`*^9, 3.6655872032615557`*^9, 3.6657554769691753`*^9, 
   3.665755522544571*^9, 3.665755882999752*^9, 3.6670468377251225`*^9, 
   3.6675714489114695`*^9, 3.667629385593334*^9, 3.6676584557358885`*^9, 
   3.6700450338930597`*^9, 3.672743230411939*^9, 3.672743269302702*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "80"}],
  SequenceForm["ii=", 80],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653238229370146`*^9, 3.6653238337534237`*^9}, 
   3.6653240430750847`*^9, 3.6653255613453426`*^9, 3.665325690274911*^9, 
   3.665325760656021*^9, 3.6653807692562304`*^9, 3.6653826542134953`*^9, 
   3.6653828427383046`*^9, 3.6653828787990274`*^9, 3.6653875860924587`*^9, 
   3.665387643643139*^9, 3.665387858861128*^9, 3.6653879341762657`*^9, 
   3.665388015732458*^9, 3.665388204578836*^9, 3.6653884546726146`*^9, 
   3.6653886335070763`*^9, {3.665389077683243*^9, 3.6653890863215904`*^9}, 
   3.6653891608201995`*^9, 3.6653893405836864`*^9, 3.665389828029312*^9, 
   3.665390153071544*^9, 3.6653903041460037`*^9, 3.6653904769110584`*^9, 
   3.6653945455791197`*^9, {3.665394631729479*^9, 3.665394659077984*^9}, {
   3.665394843806135*^9, 3.6653948508347178`*^9}, 3.665394939575779*^9, 
   3.6653949972498903`*^9, 3.6653951280720367`*^9, {3.665395224391192*^9, 
   3.665395232872293*^9}, 3.665395344222473*^9, 3.6653953921729913`*^9, {
   3.665395766562704*^9, 3.6653957935400486`*^9}, 3.665395885541156*^9, {
   3.6654008250519047`*^9, 3.6654008485318317`*^9}, 3.665400911233347*^9, 
   3.665401432266692*^9, 3.6654016291188293`*^9, 3.6654016905138597`*^9, 
   3.6654019406916604`*^9, 3.665402056004485*^9, {3.665402163555895*^9, 
   3.6654021704067183`*^9}, 3.6654024822992334`*^9, 3.665402573053825*^9, 
   3.665402605704294*^9, 3.665402643226289*^9, 3.665403723217779*^9, 
   3.6654037539294252`*^9, 3.6654042185224657`*^9, 3.6654044220136323`*^9, 
   3.665405790396593*^9, 3.6654058897311215`*^9, 3.6654063943005123`*^9, {
   3.665407803579896*^9, 3.66540782282719*^9}, 3.6654082282131276`*^9, 
   3.6654083320841923`*^9, 3.6655637380083303`*^9, 3.6655847836993055`*^9, {
   3.6655867746564302`*^9, 3.6655867916731043`*^9}, 3.6655869133469024`*^9, 
   3.6655871207631307`*^9, 3.6655872032615557`*^9, 3.6657554769691753`*^9, 
   3.665755522544571*^9, 3.665755882999752*^9, 3.6670468377251225`*^9, 
   3.6675714489114695`*^9, 3.667629385593334*^9, 3.6676584557358885`*^9, 
   3.6700450338930597`*^9, 3.672743230411939*^9, 3.672743269333954*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "90"}],
  SequenceForm["ii=", 90],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653238229370146`*^9, 3.6653238337534237`*^9}, 
   3.6653240430750847`*^9, 3.6653255613453426`*^9, 3.665325690274911*^9, 
   3.665325760656021*^9, 3.6653807692562304`*^9, 3.6653826542134953`*^9, 
   3.6653828427383046`*^9, 3.6653828787990274`*^9, 3.6653875860924587`*^9, 
   3.665387643643139*^9, 3.665387858861128*^9, 3.6653879341762657`*^9, 
   3.665388015732458*^9, 3.665388204578836*^9, 3.6653884546726146`*^9, 
   3.6653886335070763`*^9, {3.665389077683243*^9, 3.6653890863215904`*^9}, 
   3.6653891608201995`*^9, 3.6653893405836864`*^9, 3.665389828029312*^9, 
   3.665390153071544*^9, 3.6653903041460037`*^9, 3.6653904769110584`*^9, 
   3.6653945455791197`*^9, {3.665394631729479*^9, 3.665394659077984*^9}, {
   3.665394843806135*^9, 3.6653948508347178`*^9}, 3.665394939575779*^9, 
   3.6653949972498903`*^9, 3.6653951280720367`*^9, {3.665395224391192*^9, 
   3.665395232872293*^9}, 3.665395344222473*^9, 3.6653953921729913`*^9, {
   3.665395766562704*^9, 3.6653957935400486`*^9}, 3.665395885541156*^9, {
   3.6654008250519047`*^9, 3.6654008485318317`*^9}, 3.665400911233347*^9, 
   3.665401432266692*^9, 3.6654016291188293`*^9, 3.6654016905138597`*^9, 
   3.6654019406916604`*^9, 3.665402056004485*^9, {3.665402163555895*^9, 
   3.6654021704067183`*^9}, 3.6654024822992334`*^9, 3.665402573053825*^9, 
   3.665402605704294*^9, 3.665402643226289*^9, 3.665403723217779*^9, 
   3.6654037539294252`*^9, 3.6654042185224657`*^9, 3.6654044220136323`*^9, 
   3.665405790396593*^9, 3.6654058897311215`*^9, 3.6654063943005123`*^9, {
   3.665407803579896*^9, 3.66540782282719*^9}, 3.6654082282131276`*^9, 
   3.6654083320841923`*^9, 3.6655637380083303`*^9, 3.6655847836993055`*^9, {
   3.6655867746564302`*^9, 3.6655867916731043`*^9}, 3.6655869133469024`*^9, 
   3.6655871207631307`*^9, 3.6655872032615557`*^9, 3.6657554769691753`*^9, 
   3.665755522544571*^9, 3.665755882999752*^9, 3.6670468377251225`*^9, 
   3.6675714489114695`*^9, 3.667629385593334*^9, 3.6676584557358885`*^9, 
   3.6700450338930597`*^9, 3.672743230411939*^9, 3.67274326938735*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "100"}],
  SequenceForm["ii=", 100],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653238229370146`*^9, 3.6653238337534237`*^9}, 
   3.6653240430750847`*^9, 3.6653255613453426`*^9, 3.665325690274911*^9, 
   3.665325760656021*^9, 3.6653807692562304`*^9, 3.6653826542134953`*^9, 
   3.6653828427383046`*^9, 3.6653828787990274`*^9, 3.6653875860924587`*^9, 
   3.665387643643139*^9, 3.665387858861128*^9, 3.6653879341762657`*^9, 
   3.665388015732458*^9, 3.665388204578836*^9, 3.6653884546726146`*^9, 
   3.6653886335070763`*^9, {3.665389077683243*^9, 3.6653890863215904`*^9}, 
   3.6653891608201995`*^9, 3.6653893405836864`*^9, 3.665389828029312*^9, 
   3.665390153071544*^9, 3.6653903041460037`*^9, 3.6653904769110584`*^9, 
   3.6653945455791197`*^9, {3.665394631729479*^9, 3.665394659077984*^9}, {
   3.665394843806135*^9, 3.6653948508347178`*^9}, 3.665394939575779*^9, 
   3.6653949972498903`*^9, 3.6653951280720367`*^9, {3.665395224391192*^9, 
   3.665395232872293*^9}, 3.665395344222473*^9, 3.6653953921729913`*^9, {
   3.665395766562704*^9, 3.6653957935400486`*^9}, 3.665395885541156*^9, {
   3.6654008250519047`*^9, 3.6654008485318317`*^9}, 3.665400911233347*^9, 
   3.665401432266692*^9, 3.6654016291188293`*^9, 3.6654016905138597`*^9, 
   3.6654019406916604`*^9, 3.665402056004485*^9, {3.665402163555895*^9, 
   3.6654021704067183`*^9}, 3.6654024822992334`*^9, 3.665402573053825*^9, 
   3.665402605704294*^9, 3.665402643226289*^9, 3.665403723217779*^9, 
   3.6654037539294252`*^9, 3.6654042185224657`*^9, 3.6654044220136323`*^9, 
   3.665405790396593*^9, 3.6654058897311215`*^9, 3.6654063943005123`*^9, {
   3.665407803579896*^9, 3.66540782282719*^9}, 3.6654082282131276`*^9, 
   3.6654083320841923`*^9, 3.6655637380083303`*^9, 3.6655847836993055`*^9, {
   3.6655867746564302`*^9, 3.6655867916731043`*^9}, 3.6655869133469024`*^9, 
   3.6655871207631307`*^9, 3.6655872032615557`*^9, 3.6657554769691753`*^9, 
   3.665755522544571*^9, 3.665755882999752*^9, 3.6670468377251225`*^9, 
   3.6675714489114695`*^9, 3.667629385593334*^9, 3.6676584557358885`*^9, 
   3.6700450338930597`*^9, 3.672743230411939*^9, 3.6727432694342313`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "110"}],
  SequenceForm["ii=", 110],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653238229370146`*^9, 3.6653238337534237`*^9}, 
   3.6653240430750847`*^9, 3.6653255613453426`*^9, 3.665325690274911*^9, 
   3.665325760656021*^9, 3.6653807692562304`*^9, 3.6653826542134953`*^9, 
   3.6653828427383046`*^9, 3.6653828787990274`*^9, 3.6653875860924587`*^9, 
   3.665387643643139*^9, 3.665387858861128*^9, 3.6653879341762657`*^9, 
   3.665388015732458*^9, 3.665388204578836*^9, 3.6653884546726146`*^9, 
   3.6653886335070763`*^9, {3.665389077683243*^9, 3.6653890863215904`*^9}, 
   3.6653891608201995`*^9, 3.6653893405836864`*^9, 3.665389828029312*^9, 
   3.665390153071544*^9, 3.6653903041460037`*^9, 3.6653904769110584`*^9, 
   3.6653945455791197`*^9, {3.665394631729479*^9, 3.665394659077984*^9}, {
   3.665394843806135*^9, 3.6653948508347178`*^9}, 3.665394939575779*^9, 
   3.6653949972498903`*^9, 3.6653951280720367`*^9, {3.665395224391192*^9, 
   3.665395232872293*^9}, 3.665395344222473*^9, 3.6653953921729913`*^9, {
   3.665395766562704*^9, 3.6653957935400486`*^9}, 3.665395885541156*^9, {
   3.6654008250519047`*^9, 3.6654008485318317`*^9}, 3.665400911233347*^9, 
   3.665401432266692*^9, 3.6654016291188293`*^9, 3.6654016905138597`*^9, 
   3.6654019406916604`*^9, 3.665402056004485*^9, {3.665402163555895*^9, 
   3.6654021704067183`*^9}, 3.6654024822992334`*^9, 3.665402573053825*^9, 
   3.665402605704294*^9, 3.665402643226289*^9, 3.665403723217779*^9, 
   3.6654037539294252`*^9, 3.6654042185224657`*^9, 3.6654044220136323`*^9, 
   3.665405790396593*^9, 3.6654058897311215`*^9, 3.6654063943005123`*^9, {
   3.665407803579896*^9, 3.66540782282719*^9}, 3.6654082282131276`*^9, 
   3.6654083320841923`*^9, 3.6655637380083303`*^9, 3.6655847836993055`*^9, {
   3.6655867746564302`*^9, 3.6655867916731043`*^9}, 3.6655869133469024`*^9, 
   3.6655871207631307`*^9, 3.6655872032615557`*^9, 3.6657554769691753`*^9, 
   3.665755522544571*^9, 3.665755882999752*^9, 3.6670468377251225`*^9, 
   3.6675714489114695`*^9, 3.667629385593334*^9, 3.6676584557358885`*^9, 
   3.6700450338930597`*^9, 3.672743230411939*^9, 3.6727432694654784`*^9}]
}, Closed]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6657559000059958`*^9, 3.665755900660797*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "Here", " ", "we", " ", "check", " ", "zigZagNumeratorsDenominators"}], 
   ",", " ", "zigZags", ",", " ", "selfIntersectingZigZagsQ", ",", " ", 
   "badDoubleCrossingZigZagPairs", ",", " ", "badDoubleCrossingZigZagQ", ",", 
   " ", 
   RowBox[{
    RowBox[{"zigZagsAsPerfectMatchings", ".", " ", "MAKE"}], " ", "SURE", " ",
     "threadJointheLists", " ", "IS", " ", "UP", " ", "TO", " ", "DATE", " ", 
    "IN", " ", "THIS", " ", 
    RowBox[{"CELL", "!"}]}]}], "*)"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653194611906705`*^9, 3.665319470875516*^9}, 
   3.665319696162837*^9, 3.665319923129767*^9, {3.66532084581382*^9, 
   3.6653208558484077`*^9}, 3.66532141327155*^9, 3.6653872607352314`*^9, {
   3.6653878723812013`*^9, 3.665387872807293*^9}, {3.6653882181571608`*^9, 
   3.665388220760619*^9}, {3.6653886771674967`*^9, 3.665388699256188*^9}, {
   3.665394491044639*^9, 3.6653944995239697`*^9}, {3.6653959126545773`*^9, 
   3.6653959300472593`*^9}, {3.665401327082258*^9, 3.6654013337119846`*^9}, {
   3.6654026694601145`*^9, 3.6654026949367933`*^9}, {3.6654027421141653`*^9, 
   3.665402742818636*^9}, {3.665404413579281*^9, 3.6654044182142487`*^9}, {
   3.6654079097783484`*^9, 3.6654079121833377`*^9}, {3.6654082527535963`*^9, 
   3.6654082558298464`*^9}, 3.6655642359994807`*^9, {3.6657542065432377`*^9, 
   3.6657542078608522`*^9}, 3.6657559537603436`*^9, {3.665756691105117*^9, 
   3.6657566984852705`*^9}, {3.665762984537682*^9, 3.665762988625573*^9}, {
   3.6657731455748577`*^9, 3.6657731586830006`*^9}, {3.6657785046990433`*^9, 
   3.665778521769369*^9}, 3.67168741409168*^9, 3.6716874859230504`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"formatrule", "=", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["XX_", 
       RowBox[{"z1_", ",", "z2_"}]], "\[Rule]", 
      RowBox[{"XX", "[", 
       RowBox[{"z1", ",", "z2"}], "]"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "threadJointheLists", " ", "IS", " ", "TAKEN", " ", "FROM", " ", 
     "badDoubleCrossingZigZagPairs"}], ",", " ", 
    RowBox[{
    "AND", " ", "WE", " ", "NEED", " ", "TO", " ", "MAKE", " ", "SURE", " ", 
     RowBox[{"IT", "'"}], "S", " ", "EXACTLY", " ", "THE", " ", "SAME", " ", 
     "BEFORE", " ", "EVALUATING", " ", "THIS", " ", 
     RowBox[{
      RowBox[{"CELL", "!!"}], "!"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"--", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"-", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"threadJointheLists", "=", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"numerator", ",", "denominator"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"list1", ",", "list2"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "numerator", "]"}], "\[GreaterEqual]", 
            RowBox[{"Length", "[", "denominator", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"list1", "=", 
             RowBox[{"Flatten", "[", 
              RowBox[{"Transpose", "[", 
               RowBox[{"{", 
                RowBox[{"numerator", ",", "numerator"}], "}"}], "]"}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"list2", "=", "denominator"}], ";"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{
            RowBox[{"list1", "=", 
             RowBox[{"Flatten", "[", 
              RowBox[{"Transpose", "[", 
               RowBox[{"{", 
                RowBox[{"denominator", ",", "denominator"}], "}"}], "]"}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"list2", "=", "numerator"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Interweave", " ", "the", " ", "two", " ", "lists"}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"list1", "[", 
           RowBox[{"[", 
            RowBox[{"Range", "[", 
             RowBox[{"2", ",", 
              RowBox[{"2", 
               RowBox[{"Length", "[", "list2", "]"}]}], ",", "2"}], "]"}], 
            "]"}], "]"}], "=", "list2"}], ";", "\[IndentingNewLine]", 
         RowBox[{"list1", "=", 
          RowBox[{"PadRight", "[", 
           RowBox[{"list1", ",", 
            RowBox[{
             RowBox[{"Length", "[", "numerator", "]"}], "+", 
             RowBox[{"Length", "[", "denominator", "]"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "If", " ", "the", " ", "numerator", " ", "and", " ", "the", " ", 
            "denominator", " ", "had", " ", "the", " ", "same", " ", 
            "numnber", " ", "of", " ", "edges"}], ",", " ", 
           RowBox[{"we", " ", 
            RowBox[{"don", "'"}], "t", " ", "know", " ", "which", " ", "edge",
             " ", "should", " ", "come", " ", "first"}], ",", " ", 
           RowBox[{"so", " ", 
            RowBox[{"we", "'"}], "ll", " ", "need", " ", "to", " ", "check", 
            " ", "that", " ", "the", " ", "index", " ", "structure", " ", 
            "is", " ", "all", " ", "correct"}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "numerator", "]"}], "\[Equal]", 
            RowBox[{"Length", "[", "denominator", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"And", "@@", 
                 RowBox[{"Map", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Equal", "@@", "#"}], "&"}], ",", 
                   RowBox[{"Partition", "[", 
                    RowBox[{
                    RowBox[{"Drop", "[", 
                    RowBox[{
                    RowBox[{"Drop", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"List", "@@", "#"}], "&"}], ",", "list1"}], "]"}],
                     "]"}], ",", "1"}], "]"}], ",", 
                    RowBox[{"-", "1"}]}], "]"}], ",", "2"}], "]"}]}], "]"}]}],
                 ")"}], "\[Equal]", "False"}], ",", "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"The", " ", "index", " ", "structure", " ", 
                 RowBox[{"wasn", "'"}], "t", " ", "correct"}], ",", " ", 
                RowBox[{
                "and", " ", "we", " ", "should", " ", "have", " ", "started", 
                 " ", "with", " ", "the", " ", "first", " ", "edge", " ", 
                 "in", " ", "the", " ", "denominator"}]}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{
                "Print", "[", "\"\<had to do it the opposite way!\>\"", "]"}],
                 ";"}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"list1", "=", 
                RowBox[{"Flatten", "[", 
                 RowBox[{"Transpose", "[", 
                  RowBox[{"{", 
                   RowBox[{"numerator", ",", "numerator"}], "}"}], "]"}], 
                 "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"list2", "=", "denominator"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"list1", "[", 
                 RowBox[{"[", 
                  RowBox[{"Range", "[", 
                   RowBox[{"1", ",", 
                    RowBox[{"2", 
                    RowBox[{"Length", "[", "list2", "]"}]}], ",", "2"}], 
                   "]"}], "]"}], "]"}], "=", "list2"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"list1", "=", 
                RowBox[{"PadRight", "[", 
                 RowBox[{"list1", ",", 
                  RowBox[{
                   RowBox[{"Length", "[", "numerator", "]"}], "+", 
                   RowBox[{"Length", "[", "list2", "]"}]}]}], "]"}]}], 
               ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"And", "@@", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Equal", "@@", "#"}], "&"}], ",", 
                RowBox[{"Partition", "[", 
                 RowBox[{
                  RowBox[{"Drop", "[", 
                   RowBox[{
                    RowBox[{"Drop", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"List", "@@", "#"}], "&"}], ",", "list1"}], "]"}],
                     "]"}], ",", "1"}], "]"}], ",", 
                    RowBox[{"-", "1"}]}], "]"}], ",", "2"}], "]"}]}], "]"}]}],
              ")"}], "\[Equal]", "False"}], ",", 
           RowBox[{
            RowBox[{
            "Print", "[", "\"\<We somehow still messed up!\>\"", "]"}], 
            ";"}]}], "]"}], ";", "\[IndentingNewLine]", "list1"}]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ii", "=", "1"}], ",", 
    RowBox[{"ii", "\[LessEqual]", "110"}], ",", 
    RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{"ii", ",", "10"}], "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<ii=\>\"", ",", "ii"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     SubscriptBox["bft", "ii"], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"a", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b", "=", 
      RowBox[{"b", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"c", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"d", "=", 
      RowBox[{"d", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"zigzagnumdenom", "=", 
      RowBox[{"zigZagNumeratorsDenominators", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"zigzags", "=", 
      RowBox[{"zigZags", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Times", "[", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"Power", "[", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", 
               RowBox[{"-", "1"}]}], "]"}]}], "]"}], "&"}], ",", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Times", "@@", "#"}], "&"}], ",", "zigzagnumdenom", ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], "=!=", "zigzags"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<ii=\>\"", ",", "ii", ",", 
          "\"\< : There's a problem! The zig-zags from \
zigZagNumeratorsDenominators and zigZags don't match each other!\>\""}], 
         "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ii", "\[NotEqual]", "106"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"And", "@@", 
             RowBox[{"MapThread", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"MemberQ", "[", 
                 RowBox[{
                  RowBox[{"Join", "[", 
                   RowBox[{"#1", ",", "#2"}], "]"}], ",", "#3"}], "]"}], 
                "&"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Map", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Product", "[", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"#", "[", 
                    RowBox[{"[", "iii", "]"}], "]"}], 
                    RowBox[{
                    RowBox[{"2", 
                    RowBox[{"Mod", "[", 
                    RowBox[{"iii", ",", "2"}], "]"}]}], "-", "1"}]], ",", 
                    RowBox[{"{", 
                    RowBox[{"iii", ",", 
                    RowBox[{"Length", "[", "#", "]"}]}], "}"}]}], "]"}], 
                    "&"}], ",", 
                   RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"cyclicEdgeOrderings", "[", 
                    RowBox[{
                    RowBox[{"Join", "@@", "#"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "]"}], "&"}], 
                    ",", "zigzagnumdenom"}], "]"}], ",", 
                   RowBox[{"{", "2", "}"}]}], "]"}], ",", 
                 RowBox[{"Map", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Product", "[", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"#", "[", 
                    RowBox[{"[", "iii", "]"}], "]"}], 
                    RowBox[{
                    RowBox[{"2", 
                    RowBox[{"Mod", "[", 
                    RowBox[{
                    RowBox[{"iii", "+", "1"}], ",", "2"}], "]"}]}], "-", 
                    "1"}]], ",", 
                    RowBox[{"{", 
                    RowBox[{"iii", ",", 
                    RowBox[{"Length", "[", "#", "]"}]}], "}"}]}], "]"}], 
                    "&"}], ",", 
                   RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"cyclicEdgeOrderings", "[", 
                    RowBox[{
                    RowBox[{"Join", "@@", "#"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "]"}], "&"}], 
                    ",", "zigzagnumdenom"}], "]"}], ",", 
                   RowBox[{"{", "2", "}"}]}], "]"}], ",", "zigzags"}], 
                "}"}]}], "]"}]}], ")"}], "\[Equal]", "False"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<ii=\>\"", ",", "ii", ",", 
             "\"\< : There's a problem with zigZagNumeratorsDenominators! The \
index structure of the zig-zags is not consistent\>\""}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Sort", "[", 
           RowBox[{"Join", "@@", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", 
              "zigzagnumdenom"}], "]"}]}], "]"}], "===", 
          RowBox[{"Sort", "[", 
           RowBox[{"Join", "@@", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "&"}], ",", 
              "zigzagnumdenom"}], "]"}]}], "]"}], "===", 
          RowBox[{"Variables", "[", 
           RowBox[{"joinupKasteleyn", "[", 
            RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}]}], 
         ")"}], "=!=", "True"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<ii=\>\"", ",", "ii", ",", 
          "\"\< : There's a problem with zigZagNumeratorsDenominators! Some \
edges are missing from the numerator or the denominator\>\""}], "]"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Times", "@@", "zigzags"}], ")"}], "=!=", "1"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<ii=\>\"", ",", "ii", ",", 
         "\"\< : There's a problem with zigZags! The product of all zig-zags \
does not equal one\>\""}], "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"selfIntersectingZigZagsQ", "[", 
         RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "=!=", 
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"Intersection", "@@", "#"}], "]"}], "&"}], ",", 
            "zigzagnumdenom"}], "]"}], ",", 
          RowBox[{"zz_", "/;", 
           RowBox[{"zz", ">", "0"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<ii=\>\"", ",", "ii", ",", 
          "\"\< : There's a problem with selfIntersectingZigZagsQ! It claims \
that there are self-intersecting zig-zags even though no zig-zags run over \
the same edge twice (in opposite directions)\>\""}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"And", "@@", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Function", "[", 
               RowBox[{
                RowBox[{"{", "input", "}"}], ",", 
                RowBox[{
                 RowBox[{"Length", "[", 
                  RowBox[{"Intersection", "@@", 
                   RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Tuples", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", "2", "}"}]}], "]"}], "&"}], ",", "input"}], 
                    "]"}]}], "]"}], ">", "0"}]}], "]"}], "[", "#", "]"}], 
             "&"}], ",", 
            RowBox[{"badDoubleCrossingZigZagPairs", "[", 
             RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], "]"}]}], 
         ")"}], "\[Equal]", "False"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<ii=\>\"", ",", "ii", ",", 
          "\"\< : There's a problem with badDoubleCrossingZigZagPairs! It \
returns a pair of zig-zags that do not have a bad double crossing\>\""}], 
         "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"allzigs", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"threadJointheLists", "[", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}], ",", 
        "zigzagnumdenom"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ii", "\[NotEqual]", "106"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"And", "@@", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"MemberQ", "[", 
                 RowBox[{
                  RowBox[{"cyclicEdgeOrderings", "[", 
                   RowBox[{"#", ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", "#"}], 
                 "]"}], "&"}], ",", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"threadJointheLists", "[", 
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}], ",", 
                 "zigzagnumdenom"}], "]"}]}], "]"}]}], ")"}], "\[Equal]", 
           "False"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<ii=\>\"", ",", "ii", ",", 
             "\"\< : There's a problem with threadJointheLists! It's making \
zig-zags with a bad cyclic index structure!\>\""}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"allzigs", "=", 
      RowBox[{"allzigs", "/.", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "\[Rule]", 
           RowBox[{"Join", "[", 
            RowBox[{"#", ",", "#"}], "]"}]}], "&"}], ",", 
         RowBox[{"Cases", "[", 
          RowBox[{"allzigs", ",", 
           RowBox[{"zz_", "/;", 
            RowBox[{
             RowBox[{"Intersection", "[", 
              RowBox[{"zz", ",", 
               RowBox[{"Variables", "[", 
                RowBox[{"Join", "[", 
                 RowBox[{"b", ",", "c"}], "]"}], "]"}]}], "]"}], "===", 
             RowBox[{"{", "}"}]}]}]}], "]"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{"Subsets", "[", 
           RowBox[{"allzigs", ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], ",", 
          RowBox[{"zz_", "/;", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Intersection", "[", 
              RowBox[{
               RowBox[{"Subsets", "[", 
                RowBox[{
                 RowBox[{"zz", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"{", "2", "}"}]}], "]"}], ",", 
               RowBox[{"Subsets", "[", 
                RowBox[{
                 RowBox[{"zz", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                 RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], "]"}], ">", 
            "0"}]}]}], "]"}], "=!=", 
        RowBox[{"badDoubleCrossingZigZagPairs", "[", 
         RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<ii=\>\"", ",", "ii", ",", 
          "\"\< : There's a problem with badDoubleCrossingZigZagPairs! It \
doesn't find all possible bad-double-crossing pairs\>\""}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"badDoubleCrossingZigZagPairs", "[", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}], ">", 
        "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"badDoubleCrossingZigZagQ", "[", 
            RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "\[Equal]", 
           "False"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<ii=\>\"", ",", "ii", ",", 
             "\"\< : There's a problem with badDoubleCrossingZigZagQ! We have \
double-crossing pairs from badDoubleCrossingZigZagPairs, though \
badDoubleCrossingZigZagQ returns False\>\""}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"badDoubleCrossingZigZagQ", "[", 
           RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<ii=\>\"", ",", "ii", ",", 
             "\"\< : There's a problem with badDoubleCrossingZigZagQ! We do \
not have double-crossing pairs from badDoubleCrossingZigZagPairs, though \
badDoubleCrossingZigZagQ returns True\>\""}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Map", "[", 
            RowBox[{"Length", ",", 
             RowBox[{"zigZagsAsPerfectMatchings", "[", 
              RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], ",", 
             RowBox[{"{", "2", "}"}]}], "]"}], "]"}], "]"}], "=!=", 
         RowBox[{"{", "2", "}"}]}], "&&", 
        RowBox[{
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Map", "[", 
            RowBox[{"Length", ",", 
             RowBox[{"zigZagsAsPerfectMatchings", "[", 
              RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], ",", 
             RowBox[{"{", "2", "}"}]}], "]"}], "]"}], "]"}], "=!=", 
         RowBox[{"{", "}"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<ii=\>\"", ",", "ii", ",", 
          "\"\< : There's a problem with zigZagsAsPerfectMatchings! It should \
return two perfect matchings for each zig-zag, but here it doesn't always do \
this\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"yieldedzigzags", "=", 
      RowBox[{"Map", "[", 
       RowBox[{"DeleteDuplicates", ",", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "/", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "&"}], ",", 
          RowBox[{"zigZagsAsPerfectMatchings", "[", 
           RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"And", "@@", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", "#", "]"}], "\[Equal]", "1"}], "||", 
               RowBox[{
                RowBox[{"Length", "[", "#", "]"}], "\[Equal]", "0"}]}], ")"}],
              "&"}], ",", "yieldedzigzags"}], "]"}]}], ")"}], "\[Equal]", 
        "False"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<ii=\>\"", ",", "ii", ",", 
          "\"\< : There's a problem with zigZagsAsPerfectMatchings! The \
prefect matchings, when taken their ratio, do not always give the same \
expression for the zig-zag\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"And", "@@", 
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"#1", "===", "#2"}], "||", 
              RowBox[{"#1", "===", 
               RowBox[{"{", "}"}]}]}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{"yieldedzigzags", ",", 
              RowBox[{"Transpose", "[", 
               RowBox[{"{", "zigzags", "}"}], "]"}]}], "}"}]}], "]"}]}], 
         ")"}], "\[Equal]", "False"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<ii=\>\"", ",", "ii", ",", 
          "\"\< : There's a problem with zigZagsAsPerfectMatchings! The \
prefect matchings, when taken their ratio, do not equal the expression for \
the zig-zag\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.665318171181672*^9, 3.665318202704878*^9}, {
   3.6653183216068077`*^9, 3.6653183520994596`*^9}, {3.66531839215139*^9, 
   3.6653184111501756`*^9}, 3.6653192263125267`*^9, 3.6653192607611127`*^9, {
   3.665319433827194*^9, 3.665319470875516*^9}, {3.6653197007946744`*^9, 
   3.6653197104984245`*^9}, {3.6653202255463314`*^9, 3.665320244858407*^9}, {
   3.6653207815004144`*^9, 3.6653208951053333`*^9}, {3.6653209452862015`*^9, 
   3.66532097842157*^9}, {3.6653210227354336`*^9, 3.6653211041830716`*^9}, {
   3.665321718658688*^9, 3.6653217820570545`*^9}, {3.6653218590977*^9, 
   3.665321920578185*^9}, {3.665322195244587*^9, 3.6653222033328075`*^9}, {
   3.6653223748763256`*^9, 3.6653224330165462`*^9}, {3.66532322955106*^9, 
   3.6653232390476637`*^9}, {3.6653238225077314`*^9, 3.665323879242934*^9}, {
   3.6653239159845405`*^9, 3.665324034040783*^9}, {3.6653257558168*^9, 
   3.6653257558748393`*^9}, 3.6653807684593163`*^9, 3.665382653447832*^9, {
   3.665382822865073*^9, 3.6653828563613834`*^9}, {3.665387578430645*^9, 
   3.6653876417433176`*^9}, {3.665387772827407*^9, 3.6653879319324636`*^9}, {
   3.665387975013636*^9, 3.6653880124958487`*^9}, {3.6653881161778917`*^9, 
   3.665388203398225*^9}, {3.665388418670115*^9, 3.6653884602207074`*^9}, {
   3.6653885272304087`*^9, 3.665388540956611*^9}, {3.6653885991701355`*^9, 
   3.6653886322947865`*^9}, {3.6653887029314117`*^9, 3.665388703056418*^9}, {
   3.665389018738357*^9, 3.665389158046074*^9}, {3.665389284500309*^9, 
   3.665389339919886*^9}, {3.6653897666302986`*^9, 3.6653898363558693`*^9}, {
   3.665389910163226*^9, 3.665389961631102*^9}, {3.6653901380930347`*^9, 
   3.665390149511369*^9}, {3.665390300980686*^9, 3.6653903028178134`*^9}, {
   3.6653903445906506`*^9, 3.6653904473908606`*^9}, {3.6653945222132363`*^9, 
   3.6653945445009356`*^9}, 3.665394584118007*^9, {3.665394640528449*^9, 
   3.6653946583592005`*^9}, {3.665394756936673*^9, 3.665394939098732*^9}, {
   3.6653949871547394`*^9, 3.665394996124837*^9}, {3.6653950323304377`*^9, 
   3.6653951271812873`*^9}, {3.6653951719081173`*^9, 
   3.6653952161041775`*^9}, {3.6653952920676613`*^9, 
   3.6653953916260896`*^9}, {3.665395727510127*^9, 3.665395790959216*^9}, {
   3.665395874423108*^9, 3.6653958840790167`*^9}, {3.6653959360678654`*^9, 
   3.6653959424852996`*^9}, {3.6654007949831653`*^9, 3.66540083106148*^9}, {
   3.6654009069753437`*^9, 3.6654009105454187`*^9}, {3.6654013375229006`*^9, 
   3.665401482683831*^9}, {3.665401561238573*^9, 3.6654016288056183`*^9}, {
   3.665401687238634*^9, 3.6654016978828316`*^9}, {3.6654017896515474`*^9, 
   3.665401801485676*^9}, {3.665401916667469*^9, 3.665401961526197*^9}, {
   3.6654020054559016`*^9, 3.665402074010955*^9}, {3.665402162489502*^9, 
   3.665402169178853*^9}, {3.6654024009734545`*^9, 3.6654024774373503`*^9}, {
   3.665402529270352*^9, 3.665402642512816*^9}, {3.66540359456459*^9, 
   3.6654037344250402`*^9}, 3.665404705888384*^9, {3.6654056558030996`*^9, 
   3.6654057896821094`*^9}, {3.665405846774804*^9, 3.6654058795790367`*^9}, {
   3.66540592932271*^9, 3.665405970538746*^9}, {3.6654063124488544`*^9, 
   3.665406392345684*^9}, {3.665407675135537*^9, 3.66540773921542*^9}, 
   3.665407786145232*^9, {3.6654080927312875`*^9, 3.665408227129405*^9}, {
   3.6654083274136167`*^9, 3.6654083284889407`*^9}, {3.6654088334270926`*^9, 
   3.665408843793948*^9}, {3.6654282095953865`*^9, 3.6654282106110644`*^9}, 
   3.665563808834973*^9, {3.6655639629368896`*^9, 3.6655640292403436`*^9}, {
   3.665564553334504*^9, 3.66556457418468*^9}, {3.6655860664666176`*^9, 
   3.665586141971321*^9}, {3.665586760242421*^9, 3.6655867720421567`*^9}, {
   3.6655869026729374`*^9, 3.665586912935709*^9}, {3.6655870771957684`*^9, 
   3.6655872014757233`*^9}, {3.665755447616467*^9, 3.665755522012611*^9}, {
   3.665755881266376*^9, 3.665755881566531*^9}, 3.6657559584354715`*^9, {
   3.6657570327714057`*^9, 3.665757066821344*^9}, {3.6657578986288195`*^9, 
   3.6657579139488*^9}, {3.6657589490612884`*^9, 3.6657589941896358`*^9}, {
   3.6657624352516565`*^9, 3.6657624509199886`*^9}, {3.665762913802496*^9, 
   3.6657629727154913`*^9}, {3.665764996278462*^9, 3.665765037399931*^9}, 
   3.6657657117868457`*^9, {3.6657664262941136`*^9, 3.665766427110667*^9}, {
   3.6657681668683424`*^9, 3.6657682044507933`*^9}, 3.6657690403178425`*^9, 
   3.6657693809269595`*^9, {3.665771618484439*^9, 3.665771618916459*^9}, {
   3.665771956677828*^9, 3.6657719916413436`*^9}, {3.6657724171666565`*^9, 
   3.6657724255757256`*^9}, {3.6657725337609415`*^9, 
   3.6657725366621485`*^9}, {3.6657730552725725`*^9, 
   3.6657731315256133`*^9}, {3.665773186863716*^9, 3.665773187895018*^9}, {
   3.6657732505414066`*^9, 3.6657732940232325`*^9}, {3.66577337300392*^9, 
   3.6657734115124035`*^9}, {3.6657736979753256`*^9, 
   3.6657737612178783`*^9}, {3.6657739201849737`*^9, 
   3.6657739596378183`*^9}, {3.6657739996714706`*^9, 
   3.6657740207617655`*^9}, {3.6657742138489976`*^9, 
   3.6657742267986727`*^9}, {3.6657775597820487`*^9, 3.665777667034822*^9}, {
   3.6657778514968486`*^9, 3.665777878974495*^9}, {3.6657785513198876`*^9, 
   3.66577855213276*^9}, {3.667046847990699*^9, 3.667046848397174*^9}, {
   3.667478562147012*^9, 3.6674785626987596`*^9}, {3.66747885038112*^9, 
   3.667478884768914*^9}, {3.667478993789521*^9, 3.667479019863452*^9}, {
   3.667480283145218*^9, 3.6674802877374125`*^9}, {3.667483947518401*^9, 
   3.6674839505332255`*^9}, {3.667536542537237*^9, 3.6675365446248417`*^9}, 
   3.667538199002701*^9, {3.667538580326229*^9, 3.6675385830851707`*^9}, {
   3.667571530216511*^9, 3.6675715423837624`*^9}, {3.6716874147635565`*^9, 
   3.6716874167251186`*^9}, {3.6716874864861126`*^9, 3.67168748819405*^9}, {
   3.6727432934689894`*^9, 3.6727432966199255`*^9}, {3.672744549220705*^9, 
   3.6727445729869556`*^9}, {3.672744635418029*^9, 3.6727446517836323`*^9}, 
   3.6727447260850563`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "10"}],
  SequenceForm["ii=", 10],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.672744712263847*^9, 3.6727447457655783`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "20"}],
  SequenceForm["ii=", 20],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.672744712263847*^9, 3.6727447457655783`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "30"}],
  SequenceForm["ii=", 30],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.672744712263847*^9, 3.6727447585453176`*^9, 
  3.6727450117187243`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "40"}],
  SequenceForm["ii=", 40],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.672744712263847*^9, 3.6727448661005945`*^9, 
  3.672745011719222*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "50"}],
  SequenceForm["ii=", 50],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.672744712263847*^9, 3.672744870925542*^9, 
  3.672745011719222*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "60"}],
  SequenceForm["ii=", 60],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.672744712263847*^9, 3.6727448891234226`*^9, 
  3.672745011719222*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "70"}],
  SequenceForm["ii=", 70],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.672744712263847*^9, 3.672744902440062*^9, 
  3.672745011719725*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "80"}],
  SequenceForm["ii=", 80],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.672744712263847*^9, 3.6727449232934475`*^9, 
  3.672745011719725*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "90"}],
  SequenceForm["ii=", 90],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.672744712263847*^9, 3.6727449262673097`*^9, 
  3.672745011719725*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "100"}],
  SequenceForm["ii=", 100],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.672744712263847*^9, 3.672744933678796*^9, 
  3.672745011719725*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "110"}],
  SequenceForm["ii=", 110],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.672744712263847*^9, {3.6727449989605703`*^9, 3.672745011719725*^9}}]
}, Closed]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6657559000059958`*^9, 3.665755900660797*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Here", " ", "we", " ", "check", " ", "loopVariablesBasis"}], 
  "*)"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6647893950303826`*^9, 3.6647894076633363`*^9}, {
   3.667049585039831*^9, 3.667049586467121*^9}, 3.6716876558089514`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"formatrule", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["XX_", 
      RowBox[{"z1_", ",", "z2_"}]], "\[Rule]", 
     RowBox[{"XX", "[", 
      RowBox[{"z1", ",", "z2"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ii", "=", "1"}], ",", 
    RowBox[{"ii", "\[LessEqual]", "110"}], ",", 
    RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{"ii", ",", "10"}], "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<ii=\>\"", ",", "ii"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ii", "\[NotEqual]", "104"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "107"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        SubscriptBox["bft", "ii"], ";", "\[IndentingNewLine]", 
        RowBox[{"a", "=", 
         RowBox[{"a", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"b", "=", 
         RowBox[{"b", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"c", "=", 
         RowBox[{"c", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"d", "=", 
         RowBox[{"d", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"GAUGING", " ", "2"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"traditionalmodulispace", "=", 
         RowBox[{"moduliSpaceBFT", "[", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "2"}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"basis", "=", 
         RowBox[{"loopVariablesBasis", "[", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", "basis", "]"}], "]"}], "=!=", 
            RowBox[{"dimensionPolytope", "[", 
             RowBox[{"matchingPolytope", "[", 
              RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}]}], "||", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"basis", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], "=!=", 
            RowBox[{
            "dimensionPolytope", "[", "traditionalmodulispace", "]"}]}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<ii=\>\"", ",", "ii", ",", 
             "\"\< : There's a problem with the loop variable basis! \
loopVariablesBasis doesn't give the right number of basis variables for \
gauging 2!\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"GAUGING", " ", "1"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"traditionalmodulispace", "=", 
         RowBox[{"moduliSpaceBFT", "[", 
          RowBox[{
          "a", ",", "b", ",", "c", ",", "d", ",", "1", ",", "False", ",", 
           "True"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"basis", "=", 
         RowBox[{"loopVariablesBasis", "[", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "True"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"indepinternalfaces", "=", 
         RowBox[{"getNumberInternalFaces", "[", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"getNumberExternalFaces", "[", 
            RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "\[Equal]", 
           "0"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"indepinternalfaces", "=", 
            RowBox[{"indepinternalfaces", "-", "1"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Flatten", "[", "basis", "]"}], "]"}], "=!=", 
            RowBox[{"dimensionPolytope", "[", 
             RowBox[{"matchingPolytope", "[", 
              RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}]}], "||", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"basis", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "=!=", 
            "indepinternalfaces"}], "||", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"basis", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], "=!=", 
            RowBox[{
            "dimensionPolytope", "[", "traditionalmodulispace", "]"}]}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<ii=\>\"", ",", "ii", ",", 
             "\"\< : There's a problem with the loop variable basis! \
loopVariablesBasis doesn't give the right number of basis variables for \
gauging 1!\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.664781819710851*^9, 3.66478198207829*^9}, {
   3.6647820277729077`*^9, 3.6647820661125183`*^9}, 3.6647822947623367`*^9, {
   3.664782367011778*^9, 3.664782405137395*^9}, {3.66478245916627*^9, 
   3.664782540993922*^9}, 3.6647827017368417`*^9, {3.6647828039884424`*^9, 
   3.664782898580064*^9}, {3.6647829297236333`*^9, 3.6647829520229616`*^9}, 
   3.664782983955406*^9, {3.66478439381633*^9, 3.664784454309479*^9}, {
   3.6647844865795813`*^9, 3.6647845167036495`*^9}, {3.664784914565*^9, 
   3.6647849834988747`*^9}, {3.6647893830056033`*^9, 
   3.6647894076633363`*^9}, {3.6670474671026745`*^9, 3.6670474672901683`*^9}, 
   3.667048782777152*^9, {3.667571624499669*^9, 3.6675716441876526`*^9}, {
   3.6715436860077944`*^9, 3.671543687966806*^9}, 3.6715438510860353`*^9, 
   3.671543914854987*^9, {3.6715453690806117`*^9, 3.671545369602677*^9}, {
   3.67168765648083*^9, 3.671687658610564*^9}, {3.672745018790925*^9, 
   3.6727450527081*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "10"}],
  SequenceForm["ii=", 10],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.664781893433448*^9, 3.664781937304242*^9, {3.6647819826876907`*^9, 
   3.664781996784952*^9}, {3.66478206975687*^9, 3.664782082324217*^9}, 
   3.664782298702592*^9, 3.66478240682498*^9, 3.664782541635577*^9, 
   3.6647825782164555`*^9, 3.6647827030895567`*^9, 3.664782899714386*^9, {
   3.6647829411565075`*^9, 3.664782954422804*^9}, {3.664784376502406*^9, 
   3.6647844228232546`*^9}, 3.6647844557413445`*^9, {3.6647844874014573`*^9, 
   3.664784517243841*^9}, {3.6647849165273724`*^9, 3.66478495057613*^9}, 
   3.664784989152258*^9, 3.664788930629736*^9, 3.6647889840914183`*^9, {
   3.6647894076633363`*^9, 3.664789411119904*^9}, 3.6647901015743666`*^9, 
   3.6648007703212833`*^9, 3.6652391290223165`*^9, 3.6657891017850113`*^9, 
   3.6671282652729073`*^9, 3.667128309132491*^9, 3.6675400587872753`*^9, 
   3.6675716419719577`*^9, 3.667629562263208*^9, 3.6676586342248936`*^9, 
   3.670041341699813*^9, 3.670047728556472*^9, {3.6727450250457273`*^9, 
   3.6727450539814014`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "20"}],
  SequenceForm["ii=", 20],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.664781893433448*^9, 3.664781937304242*^9, {3.6647819826876907`*^9, 
   3.664781996784952*^9}, {3.66478206975687*^9, 3.664782082324217*^9}, 
   3.664782298702592*^9, 3.66478240682498*^9, 3.664782541635577*^9, 
   3.6647825782164555`*^9, 3.6647827030895567`*^9, 3.664782899714386*^9, {
   3.6647829411565075`*^9, 3.664782954422804*^9}, {3.664784376502406*^9, 
   3.6647844228232546`*^9}, 3.6647844557413445`*^9, {3.6647844874014573`*^9, 
   3.664784517243841*^9}, {3.6647849165273724`*^9, 3.66478495057613*^9}, 
   3.664784989152258*^9, 3.664788930629736*^9, 3.6647889840914183`*^9, {
   3.6647894076633363`*^9, 3.664789411119904*^9}, 3.6647901015743666`*^9, 
   3.6648007703212833`*^9, 3.6652391290223165`*^9, 3.6657891017850113`*^9, 
   3.6671282652729073`*^9, 3.667128309132491*^9, 3.6675400587872753`*^9, 
   3.6675716419719577`*^9, 3.667629562263208*^9, 3.6676586342248936`*^9, 
   3.670041341699813*^9, 3.670047728556472*^9, {3.6727450250457273`*^9, 
   3.672745054637992*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "30"}],
  SequenceForm["ii=", 30],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.664781893433448*^9, 3.664781937304242*^9, {3.6647819826876907`*^9, 
   3.664781996784952*^9}, {3.66478206975687*^9, 3.664782082324217*^9}, 
   3.664782298702592*^9, 3.66478240682498*^9, 3.664782541635577*^9, 
   3.6647825782164555`*^9, 3.6647827030895567`*^9, 3.664782899714386*^9, {
   3.6647829411565075`*^9, 3.664782954422804*^9}, {3.664784376502406*^9, 
   3.6647844228232546`*^9}, 3.6647844557413445`*^9, {3.6647844874014573`*^9, 
   3.664784517243841*^9}, {3.6647849165273724`*^9, 3.66478495057613*^9}, 
   3.664784989152258*^9, 3.664788930629736*^9, 3.6647889840914183`*^9, {
   3.6647894076633363`*^9, 3.664789411119904*^9}, 3.6647901015743666`*^9, 
   3.6648007703212833`*^9, 3.6652391290223165`*^9, 3.6657891017850113`*^9, 
   3.6671282652729073`*^9, 3.667128309132491*^9, 3.6675400587872753`*^9, 
   3.6675716419719577`*^9, 3.667629562263208*^9, 3.6676586342248936`*^9, 
   3.670041341699813*^9, 3.670047728556472*^9, {3.6727450250457273`*^9, 
   3.672745055368373*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "40"}],
  SequenceForm["ii=", 40],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.664781893433448*^9, 3.664781937304242*^9, {3.6647819826876907`*^9, 
   3.664781996784952*^9}, {3.66478206975687*^9, 3.664782082324217*^9}, 
   3.664782298702592*^9, 3.66478240682498*^9, 3.664782541635577*^9, 
   3.6647825782164555`*^9, 3.6647827030895567`*^9, 3.664782899714386*^9, {
   3.6647829411565075`*^9, 3.664782954422804*^9}, {3.664784376502406*^9, 
   3.6647844228232546`*^9}, 3.6647844557413445`*^9, {3.6647844874014573`*^9, 
   3.664784517243841*^9}, {3.6647849165273724`*^9, 3.66478495057613*^9}, 
   3.664784989152258*^9, 3.664788930629736*^9, 3.6647889840914183`*^9, {
   3.6647894076633363`*^9, 3.664789411119904*^9}, 3.6647901015743666`*^9, 
   3.6648007703212833`*^9, 3.6652391290223165`*^9, 3.6657891017850113`*^9, 
   3.6671282652729073`*^9, 3.667128309132491*^9, 3.6675400587872753`*^9, 
   3.6675716419719577`*^9, 3.667629562263208*^9, 3.6676586342248936`*^9, 
   3.670041341699813*^9, 3.670047728556472*^9, {3.6727450250457273`*^9, 
   3.6727450569087286`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "50"}],
  SequenceForm["ii=", 50],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.664781893433448*^9, 3.664781937304242*^9, {3.6647819826876907`*^9, 
   3.664781996784952*^9}, {3.66478206975687*^9, 3.664782082324217*^9}, 
   3.664782298702592*^9, 3.66478240682498*^9, 3.664782541635577*^9, 
   3.6647825782164555`*^9, 3.6647827030895567`*^9, 3.664782899714386*^9, {
   3.6647829411565075`*^9, 3.664782954422804*^9}, {3.664784376502406*^9, 
   3.6647844228232546`*^9}, 3.6647844557413445`*^9, {3.6647844874014573`*^9, 
   3.664784517243841*^9}, {3.6647849165273724`*^9, 3.66478495057613*^9}, 
   3.664784989152258*^9, 3.664788930629736*^9, 3.6647889840914183`*^9, {
   3.6647894076633363`*^9, 3.664789411119904*^9}, 3.6647901015743666`*^9, 
   3.6648007703212833`*^9, 3.6652391290223165`*^9, 3.6657891017850113`*^9, 
   3.6671282652729073`*^9, 3.667128309132491*^9, 3.6675400587872753`*^9, 
   3.6675716419719577`*^9, 3.667629562263208*^9, 3.6676586342248936`*^9, 
   3.670041341699813*^9, 3.670047728556472*^9, {3.6727450250457273`*^9, 
   3.672745057574822*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "60"}],
  SequenceForm["ii=", 60],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.664781893433448*^9, 3.664781937304242*^9, {3.6647819826876907`*^9, 
   3.664781996784952*^9}, {3.66478206975687*^9, 3.664782082324217*^9}, 
   3.664782298702592*^9, 3.66478240682498*^9, 3.664782541635577*^9, 
   3.6647825782164555`*^9, 3.6647827030895567`*^9, 3.664782899714386*^9, {
   3.6647829411565075`*^9, 3.664782954422804*^9}, {3.664784376502406*^9, 
   3.6647844228232546`*^9}, 3.6647844557413445`*^9, {3.6647844874014573`*^9, 
   3.664784517243841*^9}, {3.6647849165273724`*^9, 3.66478495057613*^9}, 
   3.664784989152258*^9, 3.664788930629736*^9, 3.6647889840914183`*^9, {
   3.6647894076633363`*^9, 3.664789411119904*^9}, 3.6647901015743666`*^9, 
   3.6648007703212833`*^9, 3.6652391290223165`*^9, 3.6657891017850113`*^9, 
   3.6671282652729073`*^9, 3.667128309132491*^9, 3.6675400587872753`*^9, 
   3.6675716419719577`*^9, 3.667629562263208*^9, 3.6676586342248936`*^9, 
   3.670041341699813*^9, 3.670047728556472*^9, {3.6727450250457273`*^9, 
   3.6727450582644296`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "70"}],
  SequenceForm["ii=", 70],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.664781893433448*^9, 3.664781937304242*^9, {3.6647819826876907`*^9, 
   3.664781996784952*^9}, {3.66478206975687*^9, 3.664782082324217*^9}, 
   3.664782298702592*^9, 3.66478240682498*^9, 3.664782541635577*^9, 
   3.6647825782164555`*^9, 3.6647827030895567`*^9, 3.664782899714386*^9, {
   3.6647829411565075`*^9, 3.664782954422804*^9}, {3.664784376502406*^9, 
   3.6647844228232546`*^9}, 3.6647844557413445`*^9, {3.6647844874014573`*^9, 
   3.664784517243841*^9}, {3.6647849165273724`*^9, 3.66478495057613*^9}, 
   3.664784989152258*^9, 3.664788930629736*^9, 3.6647889840914183`*^9, {
   3.6647894076633363`*^9, 3.664789411119904*^9}, 3.6647901015743666`*^9, 
   3.6648007703212833`*^9, 3.6652391290223165`*^9, 3.6657891017850113`*^9, 
   3.6671282652729073`*^9, 3.667128309132491*^9, 3.6675400587872753`*^9, 
   3.6675716419719577`*^9, 3.667629562263208*^9, 3.6676586342248936`*^9, 
   3.670041341699813*^9, 3.670047728556472*^9, {3.6727450250457273`*^9, 
   3.6727450588491335`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "80"}],
  SequenceForm["ii=", 80],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.664781893433448*^9, 3.664781937304242*^9, {3.6647819826876907`*^9, 
   3.664781996784952*^9}, {3.66478206975687*^9, 3.664782082324217*^9}, 
   3.664782298702592*^9, 3.66478240682498*^9, 3.664782541635577*^9, 
   3.6647825782164555`*^9, 3.6647827030895567`*^9, 3.664782899714386*^9, {
   3.6647829411565075`*^9, 3.664782954422804*^9}, {3.664784376502406*^9, 
   3.6647844228232546`*^9}, 3.6647844557413445`*^9, {3.6647844874014573`*^9, 
   3.664784517243841*^9}, {3.6647849165273724`*^9, 3.66478495057613*^9}, 
   3.664784989152258*^9, 3.664788930629736*^9, 3.6647889840914183`*^9, {
   3.6647894076633363`*^9, 3.664789411119904*^9}, 3.6647901015743666`*^9, 
   3.6648007703212833`*^9, 3.6652391290223165`*^9, 3.6657891017850113`*^9, 
   3.6671282652729073`*^9, 3.667128309132491*^9, 3.6675400587872753`*^9, 
   3.6675716419719577`*^9, 3.667629562263208*^9, 3.6676586342248936`*^9, 
   3.670041341699813*^9, 3.670047728556472*^9, {3.6727450250457273`*^9, 
   3.6727450595589676`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "90"}],
  SequenceForm["ii=", 90],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.664781893433448*^9, 3.664781937304242*^9, {3.6647819826876907`*^9, 
   3.664781996784952*^9}, {3.66478206975687*^9, 3.664782082324217*^9}, 
   3.664782298702592*^9, 3.66478240682498*^9, 3.664782541635577*^9, 
   3.6647825782164555`*^9, 3.6647827030895567`*^9, 3.664782899714386*^9, {
   3.6647829411565075`*^9, 3.664782954422804*^9}, {3.664784376502406*^9, 
   3.6647844228232546`*^9}, 3.6647844557413445`*^9, {3.6647844874014573`*^9, 
   3.664784517243841*^9}, {3.6647849165273724`*^9, 3.66478495057613*^9}, 
   3.664784989152258*^9, 3.664788930629736*^9, 3.6647889840914183`*^9, {
   3.6647894076633363`*^9, 3.664789411119904*^9}, 3.6647901015743666`*^9, 
   3.6648007703212833`*^9, 3.6652391290223165`*^9, 3.6657891017850113`*^9, 
   3.6671282652729073`*^9, 3.667128309132491*^9, 3.6675400587872753`*^9, 
   3.6675716419719577`*^9, 3.667629562263208*^9, 3.6676586342248936`*^9, 
   3.670041341699813*^9, 3.670047728556472*^9, {3.6727450250457273`*^9, 
   3.672745060088722*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "100"}],
  SequenceForm["ii=", 100],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.664781893433448*^9, 3.664781937304242*^9, {3.6647819826876907`*^9, 
   3.664781996784952*^9}, {3.66478206975687*^9, 3.664782082324217*^9}, 
   3.664782298702592*^9, 3.66478240682498*^9, 3.664782541635577*^9, 
   3.6647825782164555`*^9, 3.6647827030895567`*^9, 3.664782899714386*^9, {
   3.6647829411565075`*^9, 3.664782954422804*^9}, {3.664784376502406*^9, 
   3.6647844228232546`*^9}, 3.6647844557413445`*^9, {3.6647844874014573`*^9, 
   3.664784517243841*^9}, {3.6647849165273724`*^9, 3.66478495057613*^9}, 
   3.664784989152258*^9, 3.664788930629736*^9, 3.6647889840914183`*^9, {
   3.6647894076633363`*^9, 3.664789411119904*^9}, 3.6647901015743666`*^9, 
   3.6648007703212833`*^9, 3.6652391290223165`*^9, 3.6657891017850113`*^9, 
   3.6671282652729073`*^9, 3.667128309132491*^9, 3.6675400587872753`*^9, 
   3.6675716419719577`*^9, 3.667629562263208*^9, 3.6676586342248936`*^9, 
   3.670041341699813*^9, 3.670047728556472*^9, {3.6727450250457273`*^9, 
   3.6727450606385736`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "110"}],
  SequenceForm["ii=", 110],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.664781893433448*^9, 3.664781937304242*^9, {3.6647819826876907`*^9, 
   3.664781996784952*^9}, {3.66478206975687*^9, 3.664782082324217*^9}, 
   3.664782298702592*^9, 3.66478240682498*^9, 3.664782541635577*^9, 
   3.6647825782164555`*^9, 3.6647827030895567`*^9, 3.664782899714386*^9, {
   3.6647829411565075`*^9, 3.664782954422804*^9}, {3.664784376502406*^9, 
   3.6647844228232546`*^9}, 3.6647844557413445`*^9, {3.6647844874014573`*^9, 
   3.664784517243841*^9}, {3.6647849165273724`*^9, 3.66478495057613*^9}, 
   3.664784989152258*^9, 3.664788930629736*^9, 3.6647889840914183`*^9, {
   3.6647894076633363`*^9, 3.664789411119904*^9}, 3.6647901015743666`*^9, 
   3.6648007703212833`*^9, 3.6652391290223165`*^9, 3.6657891017850113`*^9, 
   3.6671282652729073`*^9, 3.667128309132491*^9, 3.6675400587872753`*^9, 
   3.6675716419719577`*^9, 3.667629562263208*^9, 3.6676586342248936`*^9, 
   3.670041341699813*^9, 3.670047728556472*^9, {3.6727450250457273`*^9, 
   3.67274506081938*^9}}]
}, Closed]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.664789436718484*^9, 3.6647894369997573`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Here", " ", "we", " ", "check", " ", "moduliLoopVariablesBFT"}], 
  "*)"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6647894413002005`*^9, 3.664789445380827*^9}, {
  3.665406467213009*^9, 3.665406474376487*^9}, {3.665828805454653*^9, 
  3.6658288066396823`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"formatrule", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["XX_", 
      RowBox[{"z1_", ",", "z2_"}]], "\[Rule]", 
     RowBox[{"XX", "[", 
      RowBox[{"z1", ",", "z2"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ii", "=", "1"}], ",", 
    RowBox[{"ii", "\[LessEqual]", "110"}], ",", 
    RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{"ii", ",", "10"}], "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<ii=\>\"", ",", "ii"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     SubscriptBox["bft", "ii"], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"a", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b", "=", 
      RowBox[{"b", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"c", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"d", "=", 
      RowBox[{"d", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ii", "\[NotEqual]", "104"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "107"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"GAUGING", " ", "2"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "loopvarmasterspace", ",", "loopvarmodulispace", ",", 
           "loopvarbasis"}], "}"}], "=", 
         RowBox[{"moduliLoopVariablesBFT", "[", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "2"}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"loopvarmodulispace", "=", 
         RowBox[{"loopvarmodulispace", "-", 
          RowBox[{"loopvarmodulispace", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"traditionalmodulispace", "=", 
         RowBox[{"moduliSpaceBFT", "[", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "2"}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"traditionalmodulispace", "=", 
         RowBox[{"traditionalmodulispace", "-", 
          RowBox[{"traditionalmodulispace", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"loopperfs", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Times", "@@", 
             RowBox[{"Power", "[", 
              RowBox[{"loopvarbasis", ",", "#"}], "]"}]}], "&"}], ",", 
           RowBox[{"Transpose", "[", "loopvarmasterspace", "]"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"realperfs", "=", 
         RowBox[{"perfectMatchings", "[", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"realperfs", "=", 
         RowBox[{"realperfs", "/", 
          RowBox[{"realperfs", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{"Position", "[", 
                RowBox[{"loopperfs", ",", "1"}], "]"}], ",", 
               RowBox[{"{", "_", "}"}]}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"loopperfs", "=!=", "realperfs"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<ii=\>\"", ",", "ii", ",", 
             "\"\< : There's a problem with moduliLoopVariablesBFT! The loop \
variable basis, when matched with the master space, doesn't give the correct \
(ratios of) perfect matchings!\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"loopvarmasterspace", "=", 
         RowBox[{"RowReduce", "[", 
          RowBox[{"loopvarmasterspace", "-", 
           RowBox[{"loopvarmasterspace", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"pmatrix", "=", 
         RowBox[{"matchingPolytope", "[", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"pmatrix", "=", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{
           RowBox[{"RowReduce", "[", 
            RowBox[{"pmatrix", "-", 
             RowBox[{"pmatrix", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0", ",", 
             RowBox[{
              RowBox[{"Dimensions", "[", "pmatrix", "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"pmatrix", "=!=", "loopvarmasterspace"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<ii=\>\"", ",", "ii", ",", 
             "\"\< : There's a problem with moduliLoopVariablesBFT! The \
resulting master space is different from the one given by the P \
matrix!\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"DeleteCases", "[", 
            RowBox[{
             RowBox[{"RowReduce", "[", "traditionalmodulispace", "]"}], ",", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{"0", ",", 
               RowBox[{
                RowBox[{"Dimensions", "[", "traditionalmodulispace", "]"}], 
                "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}], "=!=", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{
             RowBox[{"RowReduce", "[", "loopvarmodulispace", "]"}], ",", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{"0", ",", 
               RowBox[{
                RowBox[{"Dimensions", "[", "loopvarmodulispace", "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<ii=\>\"", ",", "ii", ",", 
             "\"\< : There's a problem with the moduli spaces! moduliSpaceBFT \
and moduliLoopVariablesBFT give different results under gauging 2!\>\""}], 
            "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"GAUGING", " ", "1"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "loopvarmasterspace", ",", "loopvarmodulispace", ",", 
           "loopvarbasis"}], "}"}], "=", 
         RowBox[{"moduliLoopVariablesBFT", "[", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "1"}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"loopvarmodulispace", "=", 
         RowBox[{"loopvarmodulispace", "-", 
          RowBox[{"loopvarmodulispace", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"traditionalmodulispace", "=", 
         RowBox[{"moduliSpaceBFT", "[", 
          RowBox[{
          "a", ",", "b", ",", "c", ",", "d", ",", "1", ",", "False", ",", 
           "True"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"traditionalmodulispace", "=", 
         RowBox[{"traditionalmodulispace", "-", 
          RowBox[{"traditionalmodulispace", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"DeleteCases", "[", 
            RowBox[{
             RowBox[{"RowReduce", "[", "traditionalmodulispace", "]"}], ",", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{"0", ",", 
               RowBox[{
                RowBox[{"Dimensions", "[", "traditionalmodulispace", "]"}], 
                "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}], "=!=", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{
             RowBox[{"RowReduce", "[", "loopvarmodulispace", "]"}], ",", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{"0", ",", 
               RowBox[{
                RowBox[{"Dimensions", "[", "loopvarmodulispace", "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<ii=\>\"", ",", "ii", ",", 
             "\"\< : There's a problem with the moduli spaces! moduliSpaceBFT \
and moduliLoopVariablesBFT give different results under gauging 1!\>\""}], 
            "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
       "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ii", "\[Equal]", "104"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "loopvarmasterspace", ",", "loopvarmodulispace", ",", 
              "loopvarbasis"}], "}"}], "=", 
            RowBox[{"moduliLoopVariablesBFT", "[", 
             RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "2"}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Dimensions", "[", "loopvarmasterspace", "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], "=!=", "0"}], "||", 
              RowBox[{
               RowBox[{
                RowBox[{"Dimensions", "[", "loopvarmodulispace", "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], "=!=", "0"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<ii=\>\"", ",", "ii", ",", 
                "\"\< : There's a problem with the moduli spaces under \
gauging 2! moduliLoopVariablesBFT should have 0 columns when there are no \
perfect matchings\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "loopvarmasterspace", ",", "loopvarmodulispace", ",", 
              "loopvarbasis"}], "}"}], "=", 
            RowBox[{"moduliLoopVariablesBFT", "[", 
             RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "1"}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Dimensions", "[", "loopvarmasterspace", "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], "=!=", "0"}], "||", 
              RowBox[{
               RowBox[{
                RowBox[{"Dimensions", "[", "loopvarmodulispace", "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], "=!=", "0"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<ii=\>\"", ",", "ii", ",", 
                "\"\< : There's a problem with the moduli spaces under \
gauging 1! moduliLoopVariablesBFT should have 0 columns when there are no \
perfect matchings\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.662284700602398*^9, 3.662458016607738*^9, {3.664709815805024*^9, 
   3.664709833541993*^9}, {3.6647099087711387`*^9, 3.6647099198175707`*^9}, 
   3.6647890459262257`*^9, {3.664789115529844*^9, 3.664789280022565*^9}, {
   3.664789320583434*^9, 3.6647893266426153`*^9}, 3.6647894413002005`*^9, {
   3.6654042776320896`*^9, 3.6654043186249323`*^9}, {3.665789183215288*^9, 
   3.6657891843185606`*^9}, {3.6658256643886204`*^9, 3.665825694487666*^9}, {
   3.6658275304408216`*^9, 3.665827544612713*^9}, {3.665827985048356*^9, 
   3.6658279891535873`*^9}, {3.6658280399435973`*^9, 
   3.6658280679296136`*^9}, {3.66582830782227*^9, 3.6658283646635275`*^9}, {
   3.665828691187254*^9, 3.66582877229502*^9}, {3.6670474771189017`*^9, 
   3.667047477384549*^9}, 3.6670487943016005`*^9, {3.6675717600256796`*^9, 
   3.6675719125660305`*^9}, 3.6715453703326225`*^9, {3.6727450871588836`*^9, 
   3.6727451091185226`*^9}, {3.672745146335911*^9, 3.672745160049509*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "110"}],
  SequenceForm["ii=", 110],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.664709922838109*^9, 3.6647890486945434`*^9, 3.6647891451556087`*^9, 
   3.6647892869414625`*^9, 3.6647893348989406`*^9, {3.6647894413002005`*^9, 
   3.664789452033094*^9}, 3.6648007838833065`*^9, 3.665239143134882*^9, {
   3.665825688000389*^9, 3.6658257071483607`*^9}, 3.665826230590783*^9, 
   3.6658275461923747`*^9, 3.6658279903216767`*^9, 3.6658280957543693`*^9, 
   3.6658287742038918`*^9, 3.667128325231409*^9, 3.6675400727850113`*^9, 
   3.667571908597537*^9, 3.6676295701813993`*^9, 3.6676586421516285`*^9, 
   3.6700413674042287`*^9, 3.6700477422934933`*^9, {3.6727450899949913`*^9, 
   3.6727451573237514`*^9}}]
}, Closed]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6647895171812615`*^9, 3.664789517415655*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Here", " ", "we", " ", "check", " ", "planarityQ"}], 
  "*)"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653194611906705`*^9, 3.665319470875516*^9}, 
   3.665319696162837*^9, 3.665319923129767*^9, {3.66532084581382*^9, 
   3.6653208558484077`*^9}, 3.66532141327155*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"This", " ", "is", " ", "the", " ", "correct", " ", "answer"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"allplanaritiesCheckedByHand", "=", 
     RowBox[{"{", 
      RowBox[{
      "True", ",", "True", ",", "True", ",", "True", ",", "True", ",", "True",
        ",", "True", ",", "True", ",", "True", ",", "True", ",", "True", ",", 
       "True", ",", "True", ",", "True", ",", "True", ",", "False", ",", 
       "False", ",", "False", ",", "False", ",", "False", ",", "False", ",", 
       "False", ",", "False", ",", "True", ",", "True", ",", "True", ",", 
       "False", ",", "False", ",", "False", ",", "False", ",", "False", ",", 
       "False", ",", "False", ",", "True", ",", "True", ",", "False", ",", 
       "True", ",", "True", ",", "True", ",", "False", ",", "True", ",", 
       "True", ",", "True", ",", "True", ",", "False", ",", "False", ",", 
       "True", ",", "True", ",", "False", ",", "False", ",", "False", ",", 
       "False", ",", "True", ",", "True", ",", "True", ",", "True", ",", 
       "True", ",", "True", ",", "True", ",", "True", ",", "True", ",", 
       "False", ",", "True", ",", "True", ",", "True", ",", "False", ",", 
       "True", ",", "True", ",", "False", ",", "True", ",", "True", ",", 
       "True", ",", "True", ",", "False", ",", "False", ",", "False", ",", 
       "False", ",", "True", ",", "True", ",", "False", ",", "True", ",", 
       "False", ",", "True", ",", "True", ",", "False", ",", "True", ",", 
       "True", ",", "True", ",", "False", ",", "True", ",", "False", ",", 
       "True", ",", "True", ",", "False", ",", "False", ",", "True", ",", 
       "True", ",", "True", ",", "True", ",", "False", ",", "False", ",", 
       "True", ",", "True", ",", "True", ",", "True", ",", "True", ",", 
       "True", ",", "True", ",", "True", ",", "True"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"formatrule", "=", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["XX_", 
        RowBox[{"z1_", ",", "z2_"}]], "\[Rule]", 
       RowBox[{"XX", "[", 
        RowBox[{"z1", ",", "z2"}], "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"ii", "=", "1"}], ",", 
      RowBox[{"ii", "\[LessEqual]", "110"}], ",", 
      RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Mod", "[", 
           RowBox[{"ii", ",", "10"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<ii=\>\"", ",", "ii"}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       SubscriptBox["bft", "ii"], ";", "\[IndentingNewLine]", 
       RowBox[{"a", "=", 
        RowBox[{"a", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"b", "=", 
        RowBox[{"b", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"c", "=", 
        RowBox[{"c", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"d", "=", 
        RowBox[{"d", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"planarityQ", "[", 
           RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "=!=", 
          RowBox[{"allplanaritiesCheckedByHand", "[", 
           RowBox[{"[", "ii", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<ii=\>\"", ",", "ii", ",", 
            "\"\< : There's a problem with planarityQ! It doesn't give the \
correct answer.\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}],
      "\[IndentingNewLine]", "]"}], ";"}]}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.665318171181672*^9, 3.665318202704878*^9}, {
   3.6653183216068077`*^9, 3.6653183520994596`*^9}, {3.66531839215139*^9, 
   3.6653184111501756`*^9}, 3.6653192263125267`*^9, 3.6653192607611127`*^9, {
   3.665319433827194*^9, 3.665319470875516*^9}, {3.6653197007946744`*^9, 
   3.6653197104984245`*^9}, {3.6653202255463314`*^9, 3.665320244858407*^9}, {
   3.6653207815004144`*^9, 3.6653208951053333`*^9}, {3.6653209452862015`*^9, 
   3.66532097842157*^9}, {3.6653210227354336`*^9, 3.6653211041830716`*^9}, {
   3.665321718658688*^9, 3.6653217820570545`*^9}, {3.6653218590977*^9, 
   3.665321920578185*^9}, {3.665322195244587*^9, 3.6653222033328075`*^9}, {
   3.6653223748763256`*^9, 3.6653224330165462`*^9}, {3.66532322955106*^9, 
   3.6653232390476637`*^9}, {3.6653238225077314`*^9, 3.665323879242934*^9}, {
   3.6653239159845405`*^9, 3.665324034040783*^9}, {3.6653257558168*^9, 
   3.6653257558748393`*^9}, 3.6653807684593163`*^9, 3.665382653447832*^9, {
   3.665382822865073*^9, 3.6653828563613834`*^9}, {3.66582909427794*^9, 
   3.6658292597094507`*^9}, {3.667047486144788*^9, 3.6670474863479137`*^9}, {
   3.6676262305924115`*^9, 3.6676262308619413`*^9}, {3.669037425856103*^9, 
   3.669037520905081*^9}, 3.670908785237027*^9, {3.6727452131453266`*^9, 
   3.6727452237674923`*^9}, {3.672745308331731*^9, 3.6727453386164107`*^9}, {
   3.6727453785960937`*^9, 3.672745385925666*^9}, {3.6799115902486067`*^9, 
   3.679911590607997*^9}, 3.6799834950631137`*^9, 3.6799835434412704`*^9, {
   3.6799835882891035`*^9, 3.6799835932764645`*^9}, {3.6799840171264973`*^9, 
   3.6799840225897717`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "10"}],
  SequenceForm["ii=", 10],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653238229370146`*^9, 3.6653238337534237`*^9}, 
   3.6653240430750847`*^9, 3.6653255613453426`*^9, 3.665325690274911*^9, 
   3.665325760656021*^9, 3.6653807692562304`*^9, 3.6653826542134953`*^9, 
   3.6653828427383046`*^9, 3.6653828787990274`*^9, 3.6658289321199245`*^9, 
   3.6658292117203865`*^9, 3.665829261923831*^9, 3.6676262313927703`*^9, 
   3.667629601295189*^9, 3.6676586731667433`*^9, 3.669037499435566*^9, 
   3.672745227341462*^9, 3.6727453396378*^9, 3.6727453869661617`*^9, 
   3.679911246184723*^9, 3.67991159387665*^9, {3.6799834799511447`*^9, 
   3.6799834957438335`*^9}, {3.6799835680631733`*^9, 3.679983622759241*^9}, 
   3.6805942652192955`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "20"}],
  SequenceForm["ii=", 20],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653238229370146`*^9, 3.6653238337534237`*^9}, 
   3.6653240430750847`*^9, 3.6653255613453426`*^9, 3.665325690274911*^9, 
   3.665325760656021*^9, 3.6653807692562304`*^9, 3.6653826542134953`*^9, 
   3.6653828427383046`*^9, 3.6653828787990274`*^9, 3.6658289321199245`*^9, 
   3.6658292117203865`*^9, 3.665829261923831*^9, 3.6676262313927703`*^9, 
   3.667629601295189*^9, 3.6676586731667433`*^9, 3.669037499435566*^9, 
   3.672745227341462*^9, 3.6727453396378*^9, 3.6727453869661617`*^9, 
   3.679911246184723*^9, 3.67991159387665*^9, {3.6799834799511447`*^9, 
   3.6799834957438335`*^9}, {3.6799835680631733`*^9, 3.679983622759241*^9}, 
   3.6805942655789537`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "30"}],
  SequenceForm["ii=", 30],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653238229370146`*^9, 3.6653238337534237`*^9}, 
   3.6653240430750847`*^9, 3.6653255613453426`*^9, 3.665325690274911*^9, 
   3.665325760656021*^9, 3.6653807692562304`*^9, 3.6653826542134953`*^9, 
   3.6653828427383046`*^9, 3.6653828787990274`*^9, 3.6658289321199245`*^9, 
   3.6658292117203865`*^9, 3.665829261923831*^9, 3.6676262313927703`*^9, 
   3.667629601295189*^9, 3.6676586731667433`*^9, 3.669037499435566*^9, 
   3.672745227341462*^9, 3.6727453396378*^9, 3.6727453869661617`*^9, 
   3.679911246184723*^9, 3.67991159387665*^9, {3.6799834799511447`*^9, 
   3.6799834957438335`*^9}, {3.6799835680631733`*^9, 3.679983622759241*^9}, 
   3.6805942657820907`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "40"}],
  SequenceForm["ii=", 40],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653238229370146`*^9, 3.6653238337534237`*^9}, 
   3.6653240430750847`*^9, 3.6653255613453426`*^9, 3.665325690274911*^9, 
   3.665325760656021*^9, 3.6653807692562304`*^9, 3.6653826542134953`*^9, 
   3.6653828427383046`*^9, 3.6653828787990274`*^9, 3.6658289321199245`*^9, 
   3.6658292117203865`*^9, 3.665829261923831*^9, 3.6676262313927703`*^9, 
   3.667629601295189*^9, 3.6676586731667433`*^9, 3.669037499435566*^9, 
   3.672745227341462*^9, 3.6727453396378*^9, 3.6727453869661617`*^9, 
   3.679911246184723*^9, 3.67991159387665*^9, {3.6799834799511447`*^9, 
   3.6799834957438335`*^9}, {3.6799835680631733`*^9, 3.679983622759241*^9}, 
   3.6805942685493135`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "50"}],
  SequenceForm["ii=", 50],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653238229370146`*^9, 3.6653238337534237`*^9}, 
   3.6653240430750847`*^9, 3.6653255613453426`*^9, 3.665325690274911*^9, 
   3.665325760656021*^9, 3.6653807692562304`*^9, 3.6653826542134953`*^9, 
   3.6653828427383046`*^9, 3.6653828787990274`*^9, 3.6658289321199245`*^9, 
   3.6658292117203865`*^9, 3.665829261923831*^9, 3.6676262313927703`*^9, 
   3.667629601295189*^9, 3.6676586731667433`*^9, 3.669037499435566*^9, 
   3.672745227341462*^9, 3.6727453396378*^9, 3.6727453869661617`*^9, 
   3.679911246184723*^9, 3.67991159387665*^9, {3.6799834799511447`*^9, 
   3.6799834957438335`*^9}, {3.6799835680631733`*^9, 3.679983622759241*^9}, 
   3.6805942687055707`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "60"}],
  SequenceForm["ii=", 60],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653238229370146`*^9, 3.6653238337534237`*^9}, 
   3.6653240430750847`*^9, 3.6653255613453426`*^9, 3.665325690274911*^9, 
   3.665325760656021*^9, 3.6653807692562304`*^9, 3.6653826542134953`*^9, 
   3.6653828427383046`*^9, 3.6653828787990274`*^9, 3.6658289321199245`*^9, 
   3.6658292117203865`*^9, 3.665829261923831*^9, 3.6676262313927703`*^9, 
   3.667629601295189*^9, 3.6676586731667433`*^9, 3.669037499435566*^9, 
   3.672745227341462*^9, 3.6727453396378*^9, 3.6727453869661617`*^9, 
   3.679911246184723*^9, 3.67991159387665*^9, {3.6799834799511447`*^9, 
   3.6799834957438335`*^9}, {3.6799835680631733`*^9, 3.679983622759241*^9}, 
   3.680594268736827*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "70"}],
  SequenceForm["ii=", 70],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653238229370146`*^9, 3.6653238337534237`*^9}, 
   3.6653240430750847`*^9, 3.6653255613453426`*^9, 3.665325690274911*^9, 
   3.665325760656021*^9, 3.6653807692562304`*^9, 3.6653826542134953`*^9, 
   3.6653828427383046`*^9, 3.6653828787990274`*^9, 3.6658289321199245`*^9, 
   3.6658292117203865`*^9, 3.665829261923831*^9, 3.6676262313927703`*^9, 
   3.667629601295189*^9, 3.6676586731667433`*^9, 3.669037499435566*^9, 
   3.672745227341462*^9, 3.6727453396378*^9, 3.6727453869661617`*^9, 
   3.679911246184723*^9, 3.67991159387665*^9, {3.6799834799511447`*^9, 
   3.6799834957438335`*^9}, {3.6799835680631733`*^9, 3.679983622759241*^9}, 
   3.680594268986831*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "80"}],
  SequenceForm["ii=", 80],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653238229370146`*^9, 3.6653238337534237`*^9}, 
   3.6653240430750847`*^9, 3.6653255613453426`*^9, 3.665325690274911*^9, 
   3.665325760656021*^9, 3.6653807692562304`*^9, 3.6653826542134953`*^9, 
   3.6653828427383046`*^9, 3.6653828787990274`*^9, 3.6658289321199245`*^9, 
   3.6658292117203865`*^9, 3.665829261923831*^9, 3.6676262313927703`*^9, 
   3.667629601295189*^9, 3.6676586731667433`*^9, 3.669037499435566*^9, 
   3.672745227341462*^9, 3.6727453396378*^9, 3.6727453869661617`*^9, 
   3.679911246184723*^9, 3.67991159387665*^9, {3.6799834799511447`*^9, 
   3.6799834957438335`*^9}, {3.6799835680631733`*^9, 3.679983622759241*^9}, 
   3.6805942691274633`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "90"}],
  SequenceForm["ii=", 90],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653238229370146`*^9, 3.6653238337534237`*^9}, 
   3.6653240430750847`*^9, 3.6653255613453426`*^9, 3.665325690274911*^9, 
   3.665325760656021*^9, 3.6653807692562304`*^9, 3.6653826542134953`*^9, 
   3.6653828427383046`*^9, 3.6653828787990274`*^9, 3.6658289321199245`*^9, 
   3.6658292117203865`*^9, 3.665829261923831*^9, 3.6676262313927703`*^9, 
   3.667629601295189*^9, 3.6676586731667433`*^9, 3.669037499435566*^9, 
   3.672745227341462*^9, 3.6727453396378*^9, 3.6727453869661617`*^9, 
   3.679911246184723*^9, 3.67991159387665*^9, {3.6799834799511447`*^9, 
   3.6799834957438335`*^9}, {3.6799835680631733`*^9, 3.679983622759241*^9}, 
   3.6805942693618507`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "100"}],
  SequenceForm["ii=", 100],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653238229370146`*^9, 3.6653238337534237`*^9}, 
   3.6653240430750847`*^9, 3.6653255613453426`*^9, 3.665325690274911*^9, 
   3.665325760656021*^9, 3.6653807692562304`*^9, 3.6653826542134953`*^9, 
   3.6653828427383046`*^9, 3.6653828787990274`*^9, 3.6658289321199245`*^9, 
   3.6658292117203865`*^9, 3.665829261923831*^9, 3.6676262313927703`*^9, 
   3.667629601295189*^9, 3.6676586731667433`*^9, 3.669037499435566*^9, 
   3.672745227341462*^9, 3.6727453396378*^9, 3.6727453869661617`*^9, 
   3.679911246184723*^9, 3.67991159387665*^9, {3.6799834799511447`*^9, 
   3.6799834957438335`*^9}, {3.6799835680631733`*^9, 3.679983622759241*^9}, 
   3.6805942697525835`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "110"}],
  SequenceForm["ii=", 110],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653238229370146`*^9, 3.6653238337534237`*^9}, 
   3.6653240430750847`*^9, 3.6653255613453426`*^9, 3.665325690274911*^9, 
   3.665325760656021*^9, 3.6653807692562304`*^9, 3.6653826542134953`*^9, 
   3.6653828427383046`*^9, 3.6653828787990274`*^9, 3.6658289321199245`*^9, 
   3.6658292117203865`*^9, 3.665829261923831*^9, 3.6676262313927703`*^9, 
   3.667629601295189*^9, 3.6676586731667433`*^9, 3.669037499435566*^9, 
   3.672745227341462*^9, 3.6727453396378*^9, 3.6727453869661617`*^9, 
   3.679911246184723*^9, 3.67991159387665*^9, {3.6799834799511447`*^9, 
   3.6799834957438335`*^9}, {3.6799835680631733`*^9, 3.679983622759241*^9}, 
   3.6805942698307157`*^9}]
}, Closed]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.665318117879394*^9, 3.665318118113784*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "Here", " ", "we", " ", "check", " ", "getOrderingExternalEdgesDefault"}], 
   ",", " ", "getSourceEdges", ",", " ", "getSinkEdges", ",", " ", 
   "getExternalEdgeNodeNumbers"}], "*)"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653194611906705`*^9, 3.665319470875516*^9}, 
   3.665319696162837*^9, 3.665319923129767*^9, {3.66532084581382*^9, 
   3.6653208558484077`*^9}, 3.66532141327155*^9, 3.665829906274736*^9, {
   3.665831295184313*^9, 3.6658313043666134`*^9}, 3.6676533410424924`*^9, 
   3.667653374985734*^9, 3.6676535278431044`*^9, 3.6715455845875454`*^9, 
   3.6715458394454403`*^9, 3.67168705818513*^9, 3.6716872549721994`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"formatrule", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["XX_", 
      RowBox[{"z1_", ",", "z2_"}]], "\[Rule]", 
     RowBox[{"XX", "[", 
      RowBox[{"z1", ",", "z2"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ii", "=", "1"}], ",", 
    RowBox[{"ii", "\[LessEqual]", "110"}], ",", 
    RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{"ii", ",", "10"}], "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<ii=\>\"", ",", "ii"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     SubscriptBox["bft", "ii"], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"a", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b", "=", 
      RowBox[{"b", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"c", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"d", "=", 
      RowBox[{"d", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", 
          RowBox[{"getOrderingExternalEdgesDefault", "[", 
           RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], "]"}], "=!=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"DeleteCases", "[", 
            RowBox[{"c", ",", "0", ",", 
             RowBox[{"{", "2", "}"}]}], "]"}], ",", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{
             RowBox[{"Transpose", "[", "b", "]"}], ",", "0", ",", 
             RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<ii=\>\"", ",", "ii", ",", 
          "\"\< : There's a problem with getOrderingExternalEdgesDefault! It \
doesn't give the right edges in the right order\>\""}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"perfs", "=", 
      RowBox[{"perfectMatchings", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sources", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"getSourceEdges", "[", 
          RowBox[{"b", ",", "c", ",", "#"}], "]"}], "&"}], ",", "perfs"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sourcetally", "=", 
      RowBox[{"Tally", "[", "sources", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sinks", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"getSinkEdges", "[", 
          RowBox[{"b", ",", "c", ",", "#"}], "]"}], "&"}], ",", "perfs"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sinktally", "=", 
      RowBox[{"Tally", "[", "sinks", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"matroidtally", "=", 
      RowBox[{"Tally", "[", 
       RowBox[{"Transpose", "[", 
        RowBox[{"matroidPolytope", "[", 
         RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{"sourcetally", ",", 
              RowBox[{"{", 
               RowBox[{"#", ",", "_"}], "}"}]}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}], "&"}], ",", "sources"}], 
         "]"}], "=!=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{"matroidtally", ",", 
              RowBox[{"{", 
               RowBox[{"#", ",", "_"}], "}"}]}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}], "&"}], ",", 
          RowBox[{"Transpose", "[", 
           RowBox[{"matroidPolytope", "[", 
            RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}]}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<ii=\>\"", ",", "ii", ",", 
          "\"\< : There's a problem with getSourceEdges! It doesn't \
correspond with the perfect -matching multiplicities given by the matroid \
polytope\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{"sinktally", ",", 
              RowBox[{"{", 
               RowBox[{"#", ",", "_"}], "}"}]}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}], "&"}], ",", "sinks"}], 
         "]"}], "=!=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{"matroidtally", ",", 
              RowBox[{"{", 
               RowBox[{"#", ",", "_"}], "}"}]}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}], "&"}], ",", 
          RowBox[{"Transpose", "[", 
           RowBox[{"matroidPolytope", "[", 
            RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}]}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<ii=\>\"", ",", "ii", ",", 
          "\"\< : There's a problem with getSinkEdges! It doesn't correspond \
with the perfect -matching multiplicities given by the matroid \
polytope\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"kasteleyn", "=", 
      RowBox[{"joinupKasteleyn", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Variables", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{"kasteleyn", ",", 
            RowBox[{"Transpose", "[", "kasteleyn", "]"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"getExternalEdgeNodeNumbers", "[", 
            RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", 
             RowBox[{"Variables", "[", 
              RowBox[{"Join", "[", 
               RowBox[{"b", ",", "c"}], "]"}], "]"}]}], "]"}], "]"}], "]"}], 
         "]"}], "=!=", 
        RowBox[{"Variables", "[", 
         RowBox[{"Join", "[", 
          RowBox[{"b", ",", "c"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<ii=\>\"", ",", "ii", ",", 
          "\"\< : There's a problem with getExternalEdgeNodeNumbers! It \
doesn't give the correct node numbers\>\""}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.665318171181672*^9, 3.665318202704878*^9}, {
   3.6653183216068077`*^9, 3.6653183520994596`*^9}, {3.66531839215139*^9, 
   3.6653184111501756`*^9}, 3.6653192263125267`*^9, 3.6653192607611127`*^9, {
   3.665319433827194*^9, 3.665319470875516*^9}, {3.6653197007946744`*^9, 
   3.6653197104984245`*^9}, {3.6653202255463314`*^9, 3.665320244858407*^9}, {
   3.6653207815004144`*^9, 3.6653208951053333`*^9}, {3.6653209452862015`*^9, 
   3.66532097842157*^9}, {3.6653210227354336`*^9, 3.6653211041830716`*^9}, {
   3.665321718658688*^9, 3.6653217820570545`*^9}, {3.6653218590977*^9, 
   3.665321920578185*^9}, {3.665322195244587*^9, 3.6653222033328075`*^9}, {
   3.6653223748763256`*^9, 3.6653224330165462`*^9}, {3.66532322955106*^9, 
   3.6653232390476637`*^9}, {3.6653238225077314`*^9, 3.665323879242934*^9}, {
   3.6653239159845405`*^9, 3.665324034040783*^9}, {3.6653257558168*^9, 
   3.6653257558748393`*^9}, 3.6653807684593163`*^9, 3.665382653447832*^9, {
   3.665382822865073*^9, 3.6653828563613834`*^9}, {3.66582909427794*^9, 
   3.6658292597094507`*^9}, {3.6658299234133587`*^9, 3.665829977618461*^9}, {
   3.6658308957020197`*^9, 3.6658310019404287`*^9}, {3.6658312045437026`*^9, 
   3.665831234129227*^9}, 3.667047494494334*^9, {3.6672028915002985`*^9, 
   3.6672028938376904`*^9}, {3.6676262833090296`*^9, 3.667626283572178*^9}, {
   3.6676522075904417`*^9, 3.6676522085819902`*^9}, {3.667653343359493*^9, 
   3.667653344361041*^9}, {3.667653376886984*^9, 3.6676533882969437`*^9}, {
   3.6676535291287947`*^9, 3.6676535304689245`*^9}, {3.6715455854506865`*^9, 
   3.6715455864614697`*^9}, {3.671545840229117*^9, 3.6715458409589043`*^9}, {
   3.6716870590445538`*^9, 3.671687059888685*^9}, {3.6716872556909757`*^9, 
   3.6716872563160124`*^9}, {3.672745418145709*^9, 3.6727454239259043`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "110"}],
  SequenceForm["ii=", 110],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.66582997833436*^9, 3.6658309479064755`*^9, 
  3.665831006625276*^9, 3.6658312350311737`*^9, 3.665831276370129*^9, 
  3.6672029005935183`*^9, 3.6676262845886016`*^9, 3.6676296014488444`*^9, 
  3.6676531253671846`*^9, 3.6676531857276173`*^9, 3.6676586778877096`*^9, 
  3.672745420958688*^9}]
}, Closed]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.665318117879394*^9, 3.665318118113784*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "Here", " ", "we", " ", "check", " ", "getOrderingExternalNodesDefault"}], 
   ",", " ", "getSourceNodes", ",", " ", "getSinkNodes"}], "*)"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653194611906705`*^9, 3.665319470875516*^9}, 
   3.665319696162837*^9, 3.665319923129767*^9, {3.66532084581382*^9, 
   3.6653208558484077`*^9}, 3.66532141327155*^9, 3.665829906274736*^9, {
   3.665831295184313*^9, 3.6658313043666134`*^9}, {3.667201852530363*^9, 
   3.667201866626546*^9}, {3.667201918485783*^9, 3.6672019187440047`*^9}, 
   3.6715457874998007`*^9, 3.6716871115700893`*^9, 3.671687157483079*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"formatrule", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["XX_", 
      RowBox[{"z1_", ",", "z2_"}]], "\[Rule]", 
     RowBox[{"XX", "[", 
      RowBox[{"z1", ",", "z2"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ii", "=", "1"}], ",", 
    RowBox[{"ii", "\[LessEqual]", "110"}], ",", 
    RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{"ii", ",", "10"}], "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<ii=\>\"", ",", "ii"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     SubscriptBox["bft", "ii"], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"a", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b", "=", 
      RowBox[{"b", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"c", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"d", "=", 
      RowBox[{"d", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"getOrderingExternalNodesDefault", "[", 
         RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "=!=", 
        RowBox[{"Union", "[", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "a", "]"}], "+", "1"}], ",", 
            RowBox[{"Length", "[", 
             RowBox[{"Join", "[", 
              RowBox[{"a", ",", "c"}], "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"Range", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Total", "[", 
              RowBox[{"Dimensions", "[", 
               RowBox[{"Join", "[", 
                RowBox[{"a", ",", "c"}], "]"}], "]"}], "]"}], "+", "1"}], ",", 
            RowBox[{
             RowBox[{"Total", "[", 
              RowBox[{"Dimensions", "[", 
               RowBox[{"Join", "[", 
                RowBox[{"a", ",", "c"}], "]"}], "]"}], "]"}], "+", 
             RowBox[{"Length", "[", 
              RowBox[{"Transpose", "[", "b", "]"}], "]"}]}]}], "]"}]}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<ii=\>\"", ",", "ii", ",", 
          "\"\< : There's a problem with getOrderingExternalNodesDefault! It \
doesn't give the right nodes in the right order!\>\""}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"perfs", "=", 
      RowBox[{"perfectMatchings", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sourcenodes", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"getSourceNodes", "[", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "#"}], "]"}], "&"}],
         ",", "perfs"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sourcetally", "=", 
      RowBox[{"Tally", "[", "sourcenodes", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sinknodes", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"getSinkNodes", "[", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "#"}], "]"}], "&"}],
         ",", "perfs"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sinktally", "=", 
      RowBox[{"Tally", "[", "sinknodes", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"matroidtally", "=", 
      RowBox[{"Tally", "[", 
       RowBox[{"Transpose", "[", 
        RowBox[{"matroidPolytope", "[", 
         RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{"sourcetally", ",", 
              RowBox[{"{", 
               RowBox[{"#", ",", "_"}], "}"}]}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}], "&"}], ",", 
          "sourcenodes"}], "]"}], "=!=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{"matroidtally", ",", 
              RowBox[{"{", 
               RowBox[{"#", ",", "_"}], "}"}]}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}], "&"}], ",", 
          RowBox[{"Transpose", "[", 
           RowBox[{"matroidPolytope", "[", 
            RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}]}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<ii=\>\"", ",", "ii", ",", 
          "\"\< : There's a problem with getSourceEdges! It doesn't \
correspond with the perfect -matching multiplicities given by the matroid \
polytope\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{"sinktally", ",", 
              RowBox[{"{", 
               RowBox[{"#", ",", "_"}], "}"}]}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}], "&"}], ",", "sinknodes"}],
          "]"}], "=!=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{"matroidtally", ",", 
              RowBox[{"{", 
               RowBox[{"#", ",", "_"}], "}"}]}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}], "&"}], ",", 
          RowBox[{"Transpose", "[", 
           RowBox[{"matroidPolytope", "[", 
            RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}]}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<ii=\>\"", ",", "ii", ",", 
          "\"\< : There's a problem with getSinkEdges! It doesn't correspond \
with the perfect -matching multiplicities given by the matroid \
polytope\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.665318171181672*^9, 3.665318202704878*^9}, {
   3.6653183216068077`*^9, 3.6653183520994596`*^9}, {3.66531839215139*^9, 
   3.6653184111501756`*^9}, 3.6653192263125267`*^9, 3.6653192607611127`*^9, {
   3.665319433827194*^9, 3.665319470875516*^9}, {3.6653197007946744`*^9, 
   3.6653197104984245`*^9}, {3.6653202255463314`*^9, 3.665320244858407*^9}, {
   3.6653207815004144`*^9, 3.6653208951053333`*^9}, {3.6653209452862015`*^9, 
   3.66532097842157*^9}, {3.6653210227354336`*^9, 3.6653211041830716`*^9}, {
   3.665321718658688*^9, 3.6653217820570545`*^9}, {3.6653218590977*^9, 
   3.665321920578185*^9}, {3.665322195244587*^9, 3.6653222033328075`*^9}, {
   3.6653223748763256`*^9, 3.6653224330165462`*^9}, {3.66532322955106*^9, 
   3.6653232390476637`*^9}, {3.6653238225077314`*^9, 3.665323879242934*^9}, {
   3.6653239159845405`*^9, 3.665324034040783*^9}, {3.6653257558168*^9, 
   3.6653257558748393`*^9}, 3.6653807684593163`*^9, 3.665382653447832*^9, {
   3.665382822865073*^9, 3.6653828563613834`*^9}, {3.66582909427794*^9, 
   3.6658292597094507`*^9}, {3.6658299234133587`*^9, 3.665829977618461*^9}, {
   3.6658308957020197`*^9, 3.6658310019404287`*^9}, {3.6658312045437026`*^9, 
   3.665831234129227*^9}, 3.667047494494334*^9, {3.667202087465727*^9, 
   3.667202100928111*^9}, {3.667202159785262*^9, 3.6672023988417125`*^9}, {
   3.6672026188957233`*^9, 3.667202653321845*^9}, {3.667202693347641*^9, 
   3.667202705484808*^9}, {3.6672029155793147`*^9, 3.667202963348774*^9}, {
   3.667626369838619*^9, 3.667626370090788*^9}, 3.667653345230297*^9, 
   3.667653388898249*^9, {3.6715457933795156`*^9, 3.67154579501972*^9}, 
   3.6715458415386143`*^9, 3.671687060550126*^9, 3.671687112418928*^9, 
   3.671687158186632*^9, {3.6727454309224896`*^9, 3.672745437645711*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "110"}],
  SequenceForm["ii=", 110],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66582997833436*^9, 3.6658309479064755`*^9, 3.665831006625276*^9, 
   3.6658312350311737`*^9, 3.665831276370129*^9, {3.667202283555311*^9, 
   3.6672023291245937`*^9}, {3.6672023701057243`*^9, 3.6672024001857586`*^9}, 
   3.6672026264166636`*^9, 3.6672027109934826`*^9, 3.6672028722395716`*^9, 
   3.6672029060967426`*^9, {3.667202949831189*^9, 3.667203001575183*^9}, 
   3.6676296022658305`*^9, 3.6676586787402177`*^9, 3.6727454340946383`*^9}]
}, Closed]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6672029889395123`*^9, 3.667202989205161*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Here", " ", "we", " ", "check", " ", "traditionalConnectivityMatrix"}], 
  "*)"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653194611906705`*^9, 3.665319470875516*^9}, 
   3.665319696162837*^9, 3.665319923129767*^9, {3.66532084581382*^9, 
   3.6653208558484077`*^9}, 3.66532141327155*^9, 3.665829906274736*^9, {
   3.6658312848720827`*^9, 3.6658313114351516`*^9}, {3.6665330774620624`*^9, 
   3.6665330778693357`*^9}, {3.666540835080023*^9, 3.6665408351581564`*^9}, {
   3.6678191034349537`*^9, 3.6678191169055986`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"alternativeConnectivityMat", "[", 
    RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_", ",", 
     RowBox[{"referencematching_:", "Null"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "perfmatchings", ",", "theperf", ",", "adjacencymat", ",", "kasteleyn", 
       ",", "perfpositions", ",", "jj", ",", "graph", ",", "cyclenodes", ",", 
       "turnIntoContributionNothingAdded", ",", "cycles", ",", "loopnodes", 
       ",", "extraloopnodes", ",", "toadd", ",", "loopcontributions", ",", 
       "turnIntoContribution", ",", "size", ",", "connectivitymat"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"referencematching", "===", "Null"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"perfmatchings", "=", 
          RowBox[{"perfectMatchings", "[", 
           RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"perfmatchings", "=!=", 
            RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"theperf", "=", 
             RowBox[{"perfmatchings", "[", 
              RowBox[{"[", 
               RowBox[{"lowNumberLoopsPMpos", "[", 
                RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}], 
              "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
           RowBox[{
            RowBox[{"theperf", "=", "0"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ";"}], "\[IndentingNewLine]", ",", 
        RowBox[{
         RowBox[{"theperf", "=", "referencematching"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"theperf", "=!=", "0"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"adjacencymat", "=", 
          RowBox[{"UpperTriangularize", "[", 
           RowBox[{"turnIntoAdjacencyMatrix", "[", 
            RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"kasteleyn", "=", 
          RowBox[{"joinupKasteleyn", "[", 
           RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"perfpositions", "=", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"{", 
                 RowBox[{"2", ",", "1"}], "}"}], "]"}], "]"}], "+", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Length", "[", "kasteleyn", "]"}], ",", "0"}], 
               "}"}]}], "&"}], ",", 
            RowBox[{"Position", "[", 
             RowBox[{"kasteleyn", ",", 
              RowBox[{"Alternatives", "@@", 
               RowBox[{"Variables", "[", "theperf", "]"}]}]}], "]"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"jj", "=", "1"}], ",", 
           RowBox[{"jj", "\[LessEqual]", 
            RowBox[{"Length", "[", "perfpositions", "]"}]}], ",", 
           RowBox[{"jj", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"adjacencymat", "[", 
              RowBox[{"[", 
               RowBox[{"Sequence", "@@", 
                RowBox[{"perfpositions", "[", 
                 RowBox[{"[", "jj", "]"}], "]"}]}], "]"}], "]"}], "=", "1"}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"adjacencymat", "[", 
              RowBox[{"[", 
               RowBox[{"Sequence", "@@", 
                RowBox[{"Reverse", "[", 
                 RowBox[{"perfpositions", "[", 
                  RowBox[{"[", "jj", "]"}], "]"}], "]"}]}], "]"}], "]"}], "=", 
             RowBox[{
              RowBox[{"adjacencymat", "[", 
               RowBox[{"[", 
                RowBox[{"Sequence", "@@", 
                 RowBox[{"Reverse", "[", 
                  RowBox[{"perfpositions", "[", 
                   RowBox[{"[", "jj", "]"}], "]"}], "]"}]}], "]"}], "]"}], 
              "-", "1"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"graph", "=", 
          RowBox[{"AdjacencyGraph", "[", "adjacencymat", "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"turnIntoContributionNothingAdded", "=", 
          RowBox[{"Function", "[", 
           RowBox[{
            RowBox[{"{", "pathnodes", "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
               "bigmatrix", ",", "edges", ",", "edgedirections", ",", 
                "giveContribution", ",", "totalcontrib"}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"bigmatrix", "=", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"Join", "[", 
                   RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{"{", 
                    RowBox[{"iii", ",", 
                    RowBox[{"Length", "[", "kasteleyn", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"jjj", ",", 
                    RowBox[{"Length", "[", "kasteleyn", "]"}]}], "}"}]}], 
                    "]"}], ",", 
                    RowBox[{"Transpose", "[", "kasteleyn", "]"}]}], "]"}], 
                  ",", 
                  RowBox[{"Join", "[", 
                   RowBox[{"kasteleyn", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{"{", 
                    RowBox[{"iii", ",", 
                    RowBox[{
                    RowBox[{"Dimensions", "[", "kasteleyn", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"jjj", ",", 
                    RowBox[{
                    RowBox[{"Dimensions", "[", "kasteleyn", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], "]"}],
                   ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"edges", "=", 
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"bigmatrix", "[", 
                    RowBox[{"[", 
                    RowBox[{"Sequence", "@@", "#"}], "]"}], "]"}], "&"}], ",", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"pathnodes", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"iii", ",", 
                    RowBox[{"iii", "+", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"iii", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "pathnodes", "]"}], "-", "1"}]}], 
                    "}"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"edgedirections", "=", 
                RowBox[{
                 RowBox[{"Map", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"Ordering", "[", "#", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"pathnodes", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"iii", ",", 
                    RowBox[{"iii", "+", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"iii", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "pathnodes", "]"}], "-", "1"}]}], 
                    "}"}]}], "]"}]}], "]"}], "/.", 
                 RowBox[{"{", 
                  RowBox[{"2", "\[Rule]", 
                   RowBox[{"-", "1"}]}], "}"}]}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"giveContribution", "=", 
                RowBox[{"Function", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"edges", ",", "sign"}], "}"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Block", "[", 
                   RowBox[{
                    RowBox[{"{", "contribution", "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"sign", "\[Equal]", "1"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"contribution", "=", 
                    RowBox[{"Total", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"Variables", "[", "edges", "]"}], ",", 
                    RowBox[{"Complement", "[", 
                    RowBox[{
                    RowBox[{"Variables", "[", "kasteleyn", "]"}], ",", 
                    RowBox[{"Variables", "[", "theperf", "]"}]}], "]"}]}], 
                    "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"contribution", "=", 
                    RowBox[{"Total", "[", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"1", "/", "#"}], "&"}], ",", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"Variables", "[", "edges", "]"}], ",", 
                    RowBox[{"Variables", "[", "theperf", "]"}]}], "]"}]}], 
                    "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
                    ";", "\[IndentingNewLine]", "contribution"}]}], "]"}]}], 
                 "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"totalcontrib", "=", 
                RowBox[{"Times", "@@", 
                 RowBox[{"MapThread", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"giveContribution", "[", 
                    RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"edges", ",", "edgedirections"}], "}"}]}], 
                  "]"}]}]}], ";", "\[IndentingNewLine]", "totalcontrib"}]}], 
             "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"cycles", "=", 
          RowBox[{
           RowBox[{"FindCycle", "[", 
            RowBox[{"graph", ",", "Infinity", ",", "All"}], "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{"DirectedEdge", "\[Rule]", "List"}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"loopnodes", "=", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", 
               RowBox[{"Append", "[", 
                RowBox[{
                 RowBox[{"Range", "[", 
                  RowBox[{"1", ",", 
                   RowBox[{"Length", "[", "#", "]"}], ",", "2"}], "]"}], ",", 
                 RowBox[{"Length", "[", "#", "]"}]}], "]"}], "]"}], "]"}], 
             "&"}], ",", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Join", "@@", "#"}], "&"}], ",", "cycles"}], "]"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"extraloopnodes", "=", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"jj", "=", "2"}], ",", 
           RowBox[{"jj", "\[LessEqual]", 
            RowBox[{"Length", "[", "loopnodes", "]"}]}], ",", 
           RowBox[{"jj", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"toadd", "=", 
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{"Subsets", "[", 
                RowBox[{"loopnodes", ",", 
                 RowBox[{"{", "jj", "}"}]}], "]"}], ",", 
               RowBox[{"zz_", "/;", 
                RowBox[{
                 RowBox[{"Join", "@@", 
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Intersection", "@@", "#"}], "&"}], ",", 
                    RowBox[{"Subsets", "[", 
                    RowBox[{"zz", ",", 
                    RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}]}], "===", 
                 RowBox[{"{", "}"}]}]}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"toadd", "===", 
               RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Break", "[", "]"}], ";"}]}], "\[IndentingNewLine]", 
             "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"extraloopnodes", "=", 
             RowBox[{"Join", "[", 
              RowBox[{"extraloopnodes", ",", "toadd"}], "]"}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"loopnodes", "=", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{"{", "loopnodes", "}"}], "]"}], ",", "extraloopnodes"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"loopcontributions", "=", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Power", "[", 
               RowBox[{
                RowBox[{"-", "1"}], ",", 
                RowBox[{
                 RowBox[{"Length", "[", "#", "]"}], "-", "1"}]}], "]"}], 
              RowBox[{"(", 
               RowBox[{"Times", "@@", "#"}], ")"}]}], "&"}], ",", 
            RowBox[{"Map", "[", 
             RowBox[{
             "turnIntoContributionNothingAdded", ",", "loopnodes", ",", 
              RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"cyclenodes", "=", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Union", "@@", "#"}], "&"}], ",", "loopnodes"}], "]"}]}],
          ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"turnIntoContribution", "=", 
          RowBox[{"Function", "[", 
           RowBox[{
            RowBox[{"{", "pathnodes", "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", "totalcontrib", "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"totalcontrib", "=", 
                RowBox[{
                "turnIntoContributionNothingAdded", "[", "pathnodes", "]"}]}],
                ";", "\[IndentingNewLine]", 
               RowBox[{"totalcontrib", "=", 
                RowBox[{"totalcontrib", "/", 
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"Total", "[", "loopcontributions", "]"}]}], 
                  ")"}]}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"totalcontrib", "=", 
                RowBox[{"totalcontrib", 
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"Total", "[", 
                    RowBox[{"loopcontributions", "[", 
                    RowBox[{"[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{"#", ",", "pathnodes"}], "]"}], "]"}], ">", "0"}],
                     "&"}], ",", "cyclenodes"}], "]"}], ",", "False"}], "]"}],
                     "]"}], "]"}], "]"}], "]"}]}], ")"}]}]}], ";", 
               "\[IndentingNewLine]", "totalcontrib"}]}], 
             "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"connectivitymat", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"FindPath", "[", 
             RowBox[{
             "graph", ",", "iii", ",", "jjj", ",", "Infinity", ",", "All"}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"iii", ",", 
              RowBox[{"Total", "[", 
               RowBox[{"Dimensions", "[", "kasteleyn", "]"}], "]"}]}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"jjj", ",", 
              RowBox[{"Total", "[", 
               RowBox[{"Dimensions", "[", "kasteleyn", "]"}], "]"}]}], 
             "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"connectivitymat", "=", 
          RowBox[{"MapThread", "[", 
           RowBox[{"Join", ",", 
            RowBox[{"{", 
             RowBox[{"connectivitymat", ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"DiagonalMatrix", "[", 
                  RowBox[{"Range", "[", 
                   RowBox[{"Total", "[", 
                    RowBox[{"Dimensions", "[", "kasteleyn", "]"}], "]"}], 
                   "]"}], "]"}], "/.", 
                 RowBox[{"{", 
                  RowBox[{"0", "\[Rule]", 
                   RowBox[{"{", "}"}]}], "}"}]}], ")"}], "/.", 
               RowBox[{"{", 
                RowBox[{"zz_Integer", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"{", "zz", "}"}], "}"}]}], "}"}]}]}], "}"}], ",", 
            "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"connectivitymat", "=", 
          RowBox[{"Map", "[", 
           RowBox[{"Total", ",", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"turnIntoContribution", "[", "#", "]"}], "&"}], ",", 
              "connectivitymat", ",", 
              RowBox[{"{", "3", "}"}]}], "]"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
        ",", 
        RowBox[{
         RowBox[{"size", "=", 
          RowBox[{"Total", "[", 
           RowBox[{"Dimensions", "[", 
            RowBox[{"joinupKasteleyn", "[", 
             RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"connectivitymat", "=", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{"0", ",", 
             RowBox[{"{", 
              RowBox[{"iii", ",", "size"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"jjj", ",", "size"}], "}"}]}], "]"}], "+", 
           RowBox[{"IdentityMatrix", "[", "size", "]"}]}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "connectivitymat"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.6665178617991943`*^9, {3.6675418714709144`*^9, 3.6675419682313147`*^9}, {
   3.667818885570492*^9, 3.6678188861798983`*^9}, {3.667819075397344*^9, 
   3.6678190760067515`*^9}, 3.671544337922127*^9, 3.6715455263221865`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"formatrule", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["XX_", 
      RowBox[{"z1_", ",", "z2_"}]], "\[Rule]", 
     RowBox[{"XX", "[", 
      RowBox[{"z1", ",", "z2"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ii", "=", "1"}], ",", 
    RowBox[{"ii", "\[LessEqual]", "110"}], ",", 
    RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ii", "\[NotEqual]", "33"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "39"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "50"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "51"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<ii=\>\"", ",", "ii"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Below", " ", "this", " ", "you", " ", 
          RowBox[{"don", "'"}], "t", " ", "need", " ", "to", " ", "touch"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"formatrule", "=", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["XX_", 
            RowBox[{"z1_", ",", "z2_"}]], "\[Rule]", 
           RowBox[{"XX", "[", 
            RowBox[{"z1", ",", "z2"}], "]"}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        SubscriptBox["bft", "ii"], ";", "\[IndentingNewLine]", 
        RowBox[{"a", "=", 
         RowBox[{"a", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"b", "=", 
         RowBox[{"b", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"c", "=", 
         RowBox[{"c", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"d", "=", 
         RowBox[{"d", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"perfs", "=", 
         RowBox[{"perfectMatchings", "[", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"srcs", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"getSourceNodes", "[", 
             RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "#"}], "]"}], 
            "&"}], ",", "perfs"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"multiplic", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Tally", "[", "srcs", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"#", ",", "2"}], "]"}], "]"}], "&"}], ",", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Position", "[", 
                RowBox[{
                 RowBox[{"Tally", "[", "srcs", "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"#", ",", "_"}], "}"}]}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], "&"}], ",", "srcs"}], 
            "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"equals", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"jj", "=", "1"}], ",", 
          RowBox[{"jj", "\[LessEqual]", 
           RowBox[{"Length", "[", "perfs", "]"}]}], ",", 
          RowBox[{"jj", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Mod", "[", 
               RowBox[{"jj", ",", "10"}], "]"}], "\[Equal]", "0"}], ",", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{"\"\<    jj=\>\"", ",", "jj"}], "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"multiplic", "[", 
               RowBox[{"[", "jj", "]"}], "]"}], "\[LessEqual]", "3"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"alternative", "=", 
               RowBox[{"alternativeConnectivityMat", "[", 
                RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", 
                 RowBox[{"perfs", "[", 
                  RowBox[{"[", "jj", "]"}], "]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"normal", "=", 
               RowBox[{"traditionalConnectivityMatrix", "[", 
                RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", 
                 RowBox[{"perfs", "[", 
                  RowBox[{"[", "jj", "]"}], "]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"equals", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"equals", ",", 
                 RowBox[{
                  RowBox[{"Simplify", "[", 
                   RowBox[{"alternative", "\[Equal]", "normal"}], "]"}], "===",
                   "True"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}],
            ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"And", "@@", "equals"}], "=!=", "True"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<ii=\>\"", ",", "ii", ",", 
             "\"\< : There's a problem with traditionalConnectivityMatrix! It \
doesn't seem to be equal to the connectivity matrix obtained using the \
alternative method\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
    "]"}], ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.665318171181672*^9, 3.665318202704878*^9}, {
   3.6653183216068077`*^9, 3.6653183520994596`*^9}, {3.66531839215139*^9, 
   3.6653184111501756`*^9}, 3.6653192263125267`*^9, 3.6653192607611127`*^9, {
   3.665319433827194*^9, 3.665319470875516*^9}, {3.6653197007946744`*^9, 
   3.6653197104984245`*^9}, {3.6653202255463314`*^9, 3.665320244858407*^9}, {
   3.6653207815004144`*^9, 3.6653208951053333`*^9}, {3.6653209452862015`*^9, 
   3.66532097842157*^9}, {3.6653210227354336`*^9, 3.6653211041830716`*^9}, {
   3.665321718658688*^9, 3.6653217820570545`*^9}, {3.6653218590977*^9, 
   3.665321920578185*^9}, {3.665322195244587*^9, 3.6653222033328075`*^9}, {
   3.6653223748763256`*^9, 3.6653224330165462`*^9}, {3.66532322955106*^9, 
   3.6653232390476637`*^9}, {3.6653238225077314`*^9, 3.665323879242934*^9}, {
   3.6653239159845405`*^9, 3.665324034040783*^9}, {3.6653257558168*^9, 
   3.6653257558748393`*^9}, 3.6653807684593163`*^9, 3.665382653447832*^9, {
   3.665382822865073*^9, 3.6653828563613834`*^9}, {3.66582909427794*^9, 
   3.6658292597094507`*^9}, {3.6658299234133587`*^9, 3.665829977618461*^9}, {
   3.6658308957020197`*^9, 3.6658310019404287`*^9}, {3.6658312045437026`*^9, 
   3.665831234129227*^9}, {3.6658313265717707`*^9, 3.6658313270928154`*^9}, {
   3.6664208553713064`*^9, 3.6664208778701353`*^9}, {3.66651792208259*^9, 
   3.666517930994763*^9}, 3.666517961471607*^9, {3.666517997380292*^9, 
   3.666518062931031*^9}, 3.6670474953472576`*^9, {3.667626576193415*^9, 
   3.667626576509848*^9}, 3.667653346462734*^9, 3.667653531516667*^9, {
   3.6678188454069405`*^9, 3.667818846048108*^9}, {3.6678189099465003`*^9, 
   3.66781891071243*^9}, {3.667819054132759*^9, 3.6678190576420317`*^9}, 
   3.667819120470701*^9, 3.6678197168336425`*^9, {3.6678199371128635`*^9, 
   3.6678199591841097`*^9}, 3.67168711318463*^9, {3.6727454474758577`*^9, 
   3.672745449673524*^9}, 3.6727455066293297`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "105"}],
  SequenceForm["ii=", 105],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66582997833436*^9, 3.6658309479064755`*^9, 3.665831006625276*^9, 
   3.6658312350311737`*^9, 3.665831276370129*^9, 3.6665369146778035`*^9, 
   3.667629603954303*^9, 3.6676586805923185`*^9, 3.667818270661164*^9, 
   3.667819126467693*^9, 3.6678197217902308`*^9, 3.6727454503134375`*^9, {
   3.672745493246952*^9, 3.672745501121812*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "106"}],
  SequenceForm["ii=", 106],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66582997833436*^9, 3.6658309479064755`*^9, 3.665831006625276*^9, 
   3.6658312350311737`*^9, 3.665831276370129*^9, 3.6665369146778035`*^9, 
   3.667629603954303*^9, 3.6676586805923185`*^9, 3.667818270661164*^9, 
   3.667819126467693*^9, 3.6678197217902308`*^9, 3.6727454503134375`*^9, {
   3.672745493246952*^9, 3.672745501137433*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "107"}],
  SequenceForm["ii=", 107],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66582997833436*^9, 3.6658309479064755`*^9, 3.665831006625276*^9, 
   3.6658312350311737`*^9, 3.665831276370129*^9, 3.6665369146778035`*^9, 
   3.667629603954303*^9, 3.6676586805923185`*^9, 3.667818270661164*^9, 
   3.667819126467693*^9, 3.6678197217902308`*^9, 3.6727454503134375`*^9, {
   3.672745493246952*^9, 3.6727455011439433`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "108"}],
  SequenceForm["ii=", 108],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66582997833436*^9, 3.6658309479064755`*^9, 3.665831006625276*^9, 
   3.6658312350311737`*^9, 3.665831276370129*^9, 3.6665369146778035`*^9, 
   3.667629603954303*^9, 3.6676586805923185`*^9, 3.667818270661164*^9, 
   3.667819126467693*^9, 3.6678197217902308`*^9, 3.6727454503134375`*^9, {
   3.672745493246952*^9, 3.6727455011439433`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    jj=\"\>", "\[InvisibleSpace]", "10"}],
  SequenceForm["    jj=", 10],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66582997833436*^9, 3.6658309479064755`*^9, 3.665831006625276*^9, 
   3.6658312350311737`*^9, 3.665831276370129*^9, 3.6665369146778035`*^9, 
   3.667629603954303*^9, 3.6676586805923185`*^9, 3.667818270661164*^9, 
   3.667819126467693*^9, 3.6678197217902308`*^9, 3.6727454503134375`*^9, {
   3.672745493246952*^9, 3.6727455012911034`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "109"}],
  SequenceForm["ii=", 109],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66582997833436*^9, 3.6658309479064755`*^9, 3.665831006625276*^9, 
   3.6658312350311737`*^9, 3.665831276370129*^9, 3.6665369146778035`*^9, 
   3.667629603954303*^9, 3.6676586805923185`*^9, 3.667818270661164*^9, 
   3.667819126467693*^9, 3.6678197217902308`*^9, 3.6727454503134375`*^9, {
   3.672745493246952*^9, 3.6727455015919085`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "110"}],
  SequenceForm["ii=", 110],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66582997833436*^9, 3.6658309479064755`*^9, 3.665831006625276*^9, 
   3.6658312350311737`*^9, 3.665831276370129*^9, 3.6665369146778035`*^9, 
   3.667629603954303*^9, 3.6676586805923185`*^9, 3.667818270661164*^9, 
   3.667819126467693*^9, 3.6678197217902308`*^9, 3.6727454503134375`*^9, {
   3.672745493246952*^9, 3.6727455016075354`*^9}}]
}, Closed]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.665318117879394*^9, 3.665318118113784*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Here", " ", "we", " ", "check", " ", "connectivityMatrix"}], 
  "*)"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653194611906705`*^9, 3.665319470875516*^9}, 
   3.665319696162837*^9, 3.665319923129767*^9, {3.66532084581382*^9, 
   3.6653208558484077`*^9}, 3.66532141327155*^9, 3.665829906274736*^9, {
   3.6658312848720827`*^9, 3.6658313114351516`*^9}, {3.6665330774620624`*^9, 
   3.6665330778693357`*^9}, {3.666540835080023*^9, 3.6665408351581564`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"alternativeConnectivityMat", "[", 
    RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_", ",", 
     RowBox[{"referencematching_:", "Null"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "perfmatchings", ",", "theperf", ",", "adjacencymat", ",", "kasteleyn", 
       ",", "perfpositions", ",", "jj", ",", "graph", ",", "cyclenodes", ",", 
       "turnIntoContributionNothingAdded", ",", "cycles", ",", "loopnodes", 
       ",", "extraloopnodes", ",", "toadd", ",", "loopcontributions", ",", 
       "turnIntoContribution", ",", "size", ",", "connectivitymat"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"referencematching", "===", "Null"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"perfmatchings", "=", 
          RowBox[{"perfectMatchings", "[", 
           RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"perfmatchings", "=!=", 
            RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"theperf", "=", 
             RowBox[{"perfmatchings", "[", 
              RowBox[{"[", 
               RowBox[{"lowNumberLoopsPMpos", "[", 
                RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}], 
              "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
           RowBox[{
            RowBox[{"theperf", "=", "0"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ";"}], "\[IndentingNewLine]", ",", 
        RowBox[{
         RowBox[{"theperf", "=", "referencematching"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"theperf", "=!=", "0"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"adjacencymat", "=", 
          RowBox[{"UpperTriangularize", "[", 
           RowBox[{"turnIntoAdjacencyMatrix", "[", 
            RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"kasteleyn", "=", 
          RowBox[{"joinupKasteleyn", "[", 
           RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"perfpositions", "=", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"{", 
                 RowBox[{"2", ",", "1"}], "}"}], "]"}], "]"}], "+", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Length", "[", "kasteleyn", "]"}], ",", "0"}], 
               "}"}]}], "&"}], ",", 
            RowBox[{"Position", "[", 
             RowBox[{"kasteleyn", ",", 
              RowBox[{"Alternatives", "@@", 
               RowBox[{"Variables", "[", "theperf", "]"}]}]}], "]"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"jj", "=", "1"}], ",", 
           RowBox[{"jj", "\[LessEqual]", 
            RowBox[{"Length", "[", "perfpositions", "]"}]}], ",", 
           RowBox[{"jj", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"adjacencymat", "[", 
              RowBox[{"[", 
               RowBox[{"Sequence", "@@", 
                RowBox[{"perfpositions", "[", 
                 RowBox[{"[", "jj", "]"}], "]"}]}], "]"}], "]"}], "=", "1"}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"adjacencymat", "[", 
              RowBox[{"[", 
               RowBox[{"Sequence", "@@", 
                RowBox[{"Reverse", "[", 
                 RowBox[{"perfpositions", "[", 
                  RowBox[{"[", "jj", "]"}], "]"}], "]"}]}], "]"}], "]"}], "=", 
             RowBox[{
              RowBox[{"adjacencymat", "[", 
               RowBox[{"[", 
                RowBox[{"Sequence", "@@", 
                 RowBox[{"Reverse", "[", 
                  RowBox[{"perfpositions", "[", 
                   RowBox[{"[", "jj", "]"}], "]"}], "]"}]}], "]"}], "]"}], 
              "-", "1"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"graph", "=", 
          RowBox[{"AdjacencyGraph", "[", "adjacencymat", "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"turnIntoContributionNothingAdded", "=", 
          RowBox[{"Function", "[", 
           RowBox[{
            RowBox[{"{", "pathnodes", "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
               "bigmatrix", ",", "edges", ",", "edgedirections", ",", 
                "giveContribution", ",", "totalcontrib"}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"bigmatrix", "=", 
                RowBox[{"Join", "[", 
                 RowBox[{
                  RowBox[{"Join", "[", 
                   RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{"{", 
                    RowBox[{"iii", ",", 
                    RowBox[{"Length", "[", "kasteleyn", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"jjj", ",", 
                    RowBox[{"Length", "[", "kasteleyn", "]"}]}], "}"}]}], 
                    "]"}], ",", 
                    RowBox[{"Transpose", "[", "kasteleyn", "]"}]}], "]"}], 
                  ",", 
                  RowBox[{"Join", "[", 
                   RowBox[{"kasteleyn", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{"{", 
                    RowBox[{"iii", ",", 
                    RowBox[{
                    RowBox[{"Dimensions", "[", "kasteleyn", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"jjj", ",", 
                    RowBox[{
                    RowBox[{"Dimensions", "[", "kasteleyn", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], "]"}],
                   ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"edges", "=", 
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"bigmatrix", "[", 
                    RowBox[{"[", 
                    RowBox[{"Sequence", "@@", "#"}], "]"}], "]"}], "&"}], ",", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"pathnodes", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"iii", ",", 
                    RowBox[{"iii", "+", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"iii", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "pathnodes", "]"}], "-", "1"}]}], 
                    "}"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"edgedirections", "=", 
                RowBox[{
                 RowBox[{"Map", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"Ordering", "[", "#", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"pathnodes", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"iii", ",", 
                    RowBox[{"iii", "+", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"iii", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "pathnodes", "]"}], "-", "1"}]}], 
                    "}"}]}], "]"}]}], "]"}], "/.", 
                 RowBox[{"{", 
                  RowBox[{"2", "\[Rule]", 
                   RowBox[{"-", "1"}]}], "}"}]}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"giveContribution", "=", 
                RowBox[{"Function", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"edges", ",", "sign"}], "}"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Block", "[", 
                   RowBox[{
                    RowBox[{"{", "contribution", "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"sign", "\[Equal]", "1"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"contribution", "=", 
                    RowBox[{"Total", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"Variables", "[", "edges", "]"}], ",", 
                    RowBox[{"Complement", "[", 
                    RowBox[{
                    RowBox[{"Variables", "[", "kasteleyn", "]"}], ",", 
                    RowBox[{"Variables", "[", "theperf", "]"}]}], "]"}]}], 
                    "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"contribution", "=", 
                    RowBox[{"Total", "[", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"1", "/", "#"}], "&"}], ",", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"Variables", "[", "edges", "]"}], ",", 
                    RowBox[{"Variables", "[", "theperf", "]"}]}], "]"}]}], 
                    "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
                    ";", "\[IndentingNewLine]", "contribution"}]}], "]"}]}], 
                 "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"totalcontrib", "=", 
                RowBox[{"Times", "@@", 
                 RowBox[{"MapThread", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"giveContribution", "[", 
                    RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"edges", ",", "edgedirections"}], "}"}]}], 
                  "]"}]}]}], ";", "\[IndentingNewLine]", "totalcontrib"}]}], 
             "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"cycles", "=", 
          RowBox[{
           RowBox[{"FindCycle", "[", 
            RowBox[{"graph", ",", "Infinity", ",", "All"}], "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{"DirectedEdge", "\[Rule]", "List"}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"loopnodes", "=", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", 
               RowBox[{"Append", "[", 
                RowBox[{
                 RowBox[{"Range", "[", 
                  RowBox[{"1", ",", 
                   RowBox[{"Length", "[", "#", "]"}], ",", "2"}], "]"}], ",", 
                 RowBox[{"Length", "[", "#", "]"}]}], "]"}], "]"}], "]"}], 
             "&"}], ",", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Join", "@@", "#"}], "&"}], ",", "cycles"}], "]"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"extraloopnodes", "=", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"jj", "=", "2"}], ",", 
           RowBox[{"jj", "\[LessEqual]", 
            RowBox[{"Length", "[", "loopnodes", "]"}]}], ",", 
           RowBox[{"jj", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"toadd", "=", 
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{"Subsets", "[", 
                RowBox[{"loopnodes", ",", 
                 RowBox[{"{", "jj", "}"}]}], "]"}], ",", 
               RowBox[{"zz_", "/;", 
                RowBox[{
                 RowBox[{"Join", "@@", 
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Intersection", "@@", "#"}], "&"}], ",", 
                    RowBox[{"Subsets", "[", 
                    RowBox[{"zz", ",", 
                    RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}]}], "===", 
                 RowBox[{"{", "}"}]}]}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"toadd", "===", 
               RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Break", "[", "]"}], ";"}]}], "\[IndentingNewLine]", 
             "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"extraloopnodes", "=", 
             RowBox[{"Join", "[", 
              RowBox[{"extraloopnodes", ",", "toadd"}], "]"}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"loopnodes", "=", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{"{", "loopnodes", "}"}], "]"}], ",", "extraloopnodes"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"loopcontributions", "=", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Power", "[", 
               RowBox[{
                RowBox[{"-", "1"}], ",", 
                RowBox[{
                 RowBox[{"Length", "[", "#", "]"}], "-", "1"}]}], "]"}], 
              RowBox[{"(", 
               RowBox[{"Times", "@@", "#"}], ")"}]}], "&"}], ",", 
            RowBox[{"Map", "[", 
             RowBox[{
             "turnIntoContributionNothingAdded", ",", "loopnodes", ",", 
              RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"cyclenodes", "=", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Union", "@@", "#"}], "&"}], ",", "loopnodes"}], "]"}]}],
          ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"turnIntoContribution", "=", 
          RowBox[{"Function", "[", 
           RowBox[{
            RowBox[{"{", "pathnodes", "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", "totalcontrib", "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"totalcontrib", "=", 
                RowBox[{
                "turnIntoContributionNothingAdded", "[", "pathnodes", "]"}]}],
                ";", "\[IndentingNewLine]", 
               RowBox[{"totalcontrib", "=", 
                RowBox[{"totalcontrib", "/", 
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"Total", "[", "loopcontributions", "]"}]}], 
                  ")"}]}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"totalcontrib", "=", 
                RowBox[{"totalcontrib", 
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"Total", "[", 
                    RowBox[{"loopcontributions", "[", 
                    RowBox[{"[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{"#", ",", "pathnodes"}], "]"}], "]"}], ">", "0"}],
                     "&"}], ",", "cyclenodes"}], "]"}], ",", "False"}], "]"}],
                     "]"}], "]"}], "]"}], "]"}]}], ")"}]}]}], ";", 
               "\[IndentingNewLine]", "totalcontrib"}]}], 
             "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"connectivitymat", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"FindPath", "[", 
             RowBox[{
             "graph", ",", "iii", ",", "jjj", ",", "Infinity", ",", "All"}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"iii", ",", 
              RowBox[{"Total", "[", 
               RowBox[{"Dimensions", "[", "kasteleyn", "]"}], "]"}]}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"jjj", ",", 
              RowBox[{"Total", "[", 
               RowBox[{"Dimensions", "[", "kasteleyn", "]"}], "]"}]}], 
             "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"connectivitymat", "=", 
          RowBox[{"MapThread", "[", 
           RowBox[{"Join", ",", 
            RowBox[{"{", 
             RowBox[{"connectivitymat", ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"DiagonalMatrix", "[", 
                  RowBox[{"Range", "[", 
                   RowBox[{"Total", "[", 
                    RowBox[{"Dimensions", "[", "kasteleyn", "]"}], "]"}], 
                   "]"}], "]"}], "/.", 
                 RowBox[{"{", 
                  RowBox[{"0", "\[Rule]", 
                   RowBox[{"{", "}"}]}], "}"}]}], ")"}], "/.", 
               RowBox[{"{", 
                RowBox[{"zz_Integer", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"{", "zz", "}"}], "}"}]}], "}"}]}]}], "}"}], ",", 
            "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"connectivitymat", "=", 
          RowBox[{"Map", "[", 
           RowBox[{"Total", ",", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"turnIntoContribution", "[", "#", "]"}], "&"}], ",", 
              "connectivitymat", ",", 
              RowBox[{"{", "3", "}"}]}], "]"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
        ",", 
        RowBox[{
         RowBox[{"size", "=", 
          RowBox[{"Total", "[", 
           RowBox[{"Dimensions", "[", 
            RowBox[{"joinupKasteleyn", "[", 
             RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"connectivitymat", "=", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{"0", ",", 
             RowBox[{"{", 
              RowBox[{"iii", ",", "size"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"jjj", ",", "size"}], "}"}]}], "]"}], "+", 
           RowBox[{"IdentityMatrix", "[", "size", "]"}]}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "connectivitymat"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.6665178617991943`*^9, {3.6675418714709144`*^9, 3.6675419682313147`*^9}, {
   3.667818885570492*^9, 3.6678188861798983`*^9}, {3.667819075397344*^9, 
   3.6678190760067515`*^9}, 3.671544338491534*^9, 3.671545526991298*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"formatrule", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["XX_", 
      RowBox[{"z1_", ",", "z2_"}]], "\[Rule]", 
     RowBox[{"XX", "[", 
      RowBox[{"z1", ",", "z2"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ii", "=", "1"}], ",", 
    RowBox[{"ii", "\[LessEqual]", "110"}], ",", 
    RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<ii=\>\"", ",", "ii"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Below", " ", "this", " ", "you", " ", 
       RowBox[{"don", "'"}], "t", " ", "need", " ", "to", " ", "touch"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"formatrule", "=", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["XX_", 
         RowBox[{"z1_", ",", "z2_"}]], "\[Rule]", 
        RowBox[{"XX", "[", 
         RowBox[{"z1", ",", "z2"}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     SubscriptBox["bft", "ii"], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"a", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b", "=", 
      RowBox[{"b", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"c", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"d", "=", 
      RowBox[{"d", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"perfs", "=", 
      RowBox[{"perfectMatchings", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"srcs", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"getSourceNodes", "[", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "#"}], "]"}], "&"}],
         ",", "perfs"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"multiplic", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Tally", "[", "srcs", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"#", ",", "2"}], "]"}], "]"}], "&"}], ",", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{
              RowBox[{"Tally", "[", "srcs", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"#", ",", "_"}], "}"}]}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "&"}], ",", "srcs"}], 
         "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"equals", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"jj", "=", "1"}], ",", 
       RowBox[{"jj", "\[LessEqual]", 
        RowBox[{"Length", "[", "perfs", "]"}]}], ",", 
       RowBox[{"jj", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Mod", "[", 
            RowBox[{"jj", ",", "10"}], "]"}], "\[Equal]", "0"}], ",", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"\"\<    jj=\>\"", ",", "jj"}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"multiplic", "[", 
            RowBox[{"[", "jj", "]"}], "]"}], "\[LessEqual]", "10"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"alternative", "=", 
            RowBox[{"alternativeConnectivityMat", "[", 
             RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", 
              RowBox[{"perfs", "[", 
               RowBox[{"[", "jj", "]"}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"normal", "=", 
            RowBox[{"connectivityMatrix", "[", 
             RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", 
              RowBox[{"perfs", "[", 
               RowBox[{"[", "jj", "]"}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"equals", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"equals", ",", 
              RowBox[{
               RowBox[{"Simplify", "[", 
                RowBox[{"alternative", "\[Equal]", "normal"}], "]"}], "===", 
               "True"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"ii", "\[NotEqual]", "33"}], "&&", 
              RowBox[{"ii", "\[NotEqual]", "39"}], "&&", 
              RowBox[{"ii", "\[NotEqual]", "50"}], "&&", 
              RowBox[{"ii", "\[NotEqual]", "51"}], "&&", 
              RowBox[{"multiplic", "\[LessEqual]", "3"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"traditional", "=", 
               RowBox[{"traditionalConnectivityMatrix", "[", 
                RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", 
                 RowBox[{"perfs", "[", 
                  RowBox[{"[", "jj", "]"}], "]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"equals", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"equals", ",", 
                 RowBox[{
                  RowBox[{"Simplify", "[", 
                   RowBox[{"traditional", "\[Equal]", "normal"}], "]"}], "===",
                   "True"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}],
            ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"And", "@@", "equals"}], "=!=", "True"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<ii=\>\"", ",", "ii", ",", 
          "\"\< : There's a problem with connectivityMatrix! It doesn't seem \
to be equal to either the alternative method, or the traditional method \
involving the inverse (one of the two equalities was violated)\>\""}], "]"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
    "]"}], ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.665318171181672*^9, 3.665318202704878*^9}, {
   3.6653183216068077`*^9, 3.6653183520994596`*^9}, {3.66531839215139*^9, 
   3.6653184111501756`*^9}, 3.6653192263125267`*^9, 3.6653192607611127`*^9, {
   3.665319433827194*^9, 3.665319470875516*^9}, {3.6653197007946744`*^9, 
   3.6653197104984245`*^9}, {3.6653202255463314`*^9, 3.665320244858407*^9}, {
   3.6653207815004144`*^9, 3.6653208951053333`*^9}, {3.6653209452862015`*^9, 
   3.66532097842157*^9}, {3.6653210227354336`*^9, 3.6653211041830716`*^9}, {
   3.665321718658688*^9, 3.6653217820570545`*^9}, {3.6653218590977*^9, 
   3.665321920578185*^9}, {3.665322195244587*^9, 3.6653222033328075`*^9}, {
   3.6653223748763256`*^9, 3.6653224330165462`*^9}, {3.66532322955106*^9, 
   3.6653232390476637`*^9}, {3.6653238225077314`*^9, 3.665323879242934*^9}, {
   3.6653239159845405`*^9, 3.665324034040783*^9}, {3.6653257558168*^9, 
   3.6653257558748393`*^9}, 3.6653807684593163`*^9, 3.665382653447832*^9, {
   3.665382822865073*^9, 3.6653828563613834`*^9}, {3.66582909427794*^9, 
   3.6658292597094507`*^9}, {3.6658299234133587`*^9, 3.665829977618461*^9}, {
   3.6658308957020197`*^9, 3.6658310019404287`*^9}, {3.6658312045437026`*^9, 
   3.665831234129227*^9}, {3.6658313265717707`*^9, 3.6658313270928154`*^9}, {
   3.6664208553713064`*^9, 3.6664208778701353`*^9}, {3.66651792208259*^9, 
   3.666517930994763*^9}, 3.666517961471607*^9, {3.666517997380292*^9, 
   3.666518062931031*^9}, 3.6670474953472576`*^9, {3.667626576193415*^9, 
   3.667626576509848*^9}, 3.667653346462734*^9, 3.667653531516667*^9, {
   3.6678188454069405`*^9, 3.667818846048108*^9}, {3.6678189099465003`*^9, 
   3.66781891071243*^9}, {3.667819054132759*^9, 3.6678190576420317`*^9}, {
   3.667819157146982*^9, 3.667819179992326*^9}, {3.667819420173277*^9, 
   3.667819490792297*^9}, 3.667819733249298*^9, {3.6678199718110285`*^9, 
   3.667820018037493*^9}, 3.6716871139662027`*^9, {3.6727456361978283`*^9, 
   3.672745652970871*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "105"}],
  SequenceForm["ii=", 105],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66582997833436*^9, 3.6658309479064755`*^9, 3.665831006625276*^9, 
   3.6658312350311737`*^9, 3.665831276370129*^9, 3.6665369146778035`*^9, 
   3.667629603954303*^9, 3.6676586805923185`*^9, 3.667818270661164*^9, {
   3.6727456389722834`*^9, 3.672745643620957*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "106"}],
  SequenceForm["ii=", 106],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66582997833436*^9, 3.6658309479064755`*^9, 3.665831006625276*^9, 
   3.6658312350311737`*^9, 3.665831276370129*^9, 3.6665369146778035`*^9, 
   3.667629603954303*^9, 3.6676586805923185`*^9, 3.667818270661164*^9, {
   3.6727456389722834`*^9, 3.672745644504033*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "107"}],
  SequenceForm["ii=", 107],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66582997833436*^9, 3.6658309479064755`*^9, 3.665831006625276*^9, 
   3.6658312350311737`*^9, 3.665831276370129*^9, 3.6665369146778035`*^9, 
   3.667629603954303*^9, 3.6676586805923185`*^9, 3.667818270661164*^9, {
   3.6727456389722834`*^9, 3.6727456457506795`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "108"}],
  SequenceForm["ii=", 108],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66582997833436*^9, 3.6658309479064755`*^9, 3.665831006625276*^9, 
   3.6658312350311737`*^9, 3.665831276370129*^9, 3.6665369146778035`*^9, 
   3.667629603954303*^9, 3.6676586805923185`*^9, 3.667818270661164*^9, {
   3.6727456389722834`*^9, 3.6727456473704786`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    jj=\"\>", "\[InvisibleSpace]", "10"}],
  SequenceForm["    jj=", 10],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66582997833436*^9, 3.6658309479064755`*^9, 3.665831006625276*^9, 
   3.6658312350311737`*^9, 3.665831276370129*^9, 3.6665369146778035`*^9, 
   3.667629603954303*^9, 3.6676586805923185`*^9, 3.667818270661164*^9, {
   3.6727456389722834`*^9, 3.672745649042187*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "109"}],
  SequenceForm["ii=", 109],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66582997833436*^9, 3.6658309479064755`*^9, 3.665831006625276*^9, 
   3.6658312350311737`*^9, 3.665831276370129*^9, 3.6665369146778035`*^9, 
   3.667629603954303*^9, 3.6676586805923185`*^9, 3.667818270661164*^9, {
   3.6727456389722834`*^9, 3.6727456498729434`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "110"}],
  SequenceForm["ii=", 110],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66582997833436*^9, 3.6658309479064755`*^9, 3.665831006625276*^9, 
   3.6658312350311737`*^9, 3.665831276370129*^9, 3.6665369146778035`*^9, 
   3.667629603954303*^9, 3.6676586805923185`*^9, 3.667818270661164*^9, {
   3.6727456389722834`*^9, 3.672745650097561*^9}}]
}, Closed]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.665318117879394*^9, 3.665318118113784*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Here", " ", "we", " ", "check", " ", "loopDenominator"}], 
  "*)"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653194611906705`*^9, 3.665319470875516*^9}, 
   3.665319696162837*^9, 3.665319923129767*^9, {3.66532084581382*^9, 
   3.6653208558484077`*^9}, 3.66532141327155*^9, 3.665829906274736*^9, {
   3.6658312848720827`*^9, 3.6658313114351516`*^9}, {3.6665330774620624`*^9, 
   3.6665330778693357`*^9}, {3.666540835080023*^9, 3.6665408351581564`*^9}, {
   3.667819195437996*^9, 3.667819195734888*^9}, {3.66781959131479*^9, 
   3.667819602476207*^9}, 3.6716873369220123`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"formatrule", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["XX_", 
      RowBox[{"z1_", ",", "z2_"}]], "\[Rule]", 
     RowBox[{"XX", "[", 
      RowBox[{"z1", ",", "z2"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ii", "=", "1"}], ",", 
    RowBox[{"ii", "\[LessEqual]", "110"}], ",", 
    RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<ii=\>\"", ",", "ii"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Below", " ", "this", " ", "you", " ", 
       RowBox[{"don", "'"}], "t", " ", "need", " ", "to", " ", "touch"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"formatrule", "=", 
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["XX_", 
         RowBox[{"z1_", ",", "z2_"}]], "\[Rule]", 
        RowBox[{"XX", "[", 
         RowBox[{"z1", ",", "z2"}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     SubscriptBox["bft", "ii"], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"a", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b", "=", 
      RowBox[{"b", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"c", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"d", "=", 
      RowBox[{"d", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"perfs", "=", 
      RowBox[{"perfectMatchings", "[", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"srcs", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"getSourceNodes", "[", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "#"}], "]"}], "&"}],
         ",", "perfs"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"multiplic", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Tally", "[", "srcs", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"#", ",", "2"}], "]"}], "]"}], "&"}], ",", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{
              RowBox[{"Tally", "[", "srcs", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"#", ",", "_"}], "}"}]}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "&"}], ",", "srcs"}], 
         "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"equals", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"jj", "=", "1"}], ",", 
       RowBox[{"jj", "\[LessEqual]", 
        RowBox[{"Length", "[", "perfs", "]"}]}], ",", 
       RowBox[{"jj", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Mod", "[", 
            RowBox[{"jj", ",", "10"}], "]"}], "\[Equal]", "0"}], ",", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"\"\<    jj=\>\"", ",", "jj"}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"multiplic", "[", 
            RowBox[{"[", "jj", "]"}], "]"}], "\[LessEqual]", "10"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"traditionalmethod", "=", 
            RowBox[{"Expand", "[", 
             RowBox[{"1", "/", 
              RowBox[{"Expand", "[", 
               RowBox[{"Simplify", "[", 
                RowBox[{"Det", "[", 
                 RowBox[{"Simplify", "[", 
                  RowBox[{"connectivityMatrix", "[", 
                   RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", 
                    RowBox[{"perfs", "[", 
                    RowBox[{"[", "jj", "]"}], "]"}]}], "]"}], "]"}], "]"}], 
                "]"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"newmethod", "=", 
            RowBox[{"loopDenominator", "[", 
             RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", 
              RowBox[{"perfs", "[", 
               RowBox[{"[", "jj", "]"}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"equals", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"equals", ",", 
              RowBox[{
               RowBox[{"Simplify", "[", 
                RowBox[{"newmethod", "\[Equal]", "traditionalmethod"}], "]"}],
                "===", "True"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"And", "@@", "equals"}], "=!=", "True"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<ii=\>\"", ",", "ii", ",", 
          "\"\< : There's a problem with loopDenominator! It doesn't equal \
the result obtained from the determinant of the connectivity matrix\>\""}], 
         "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.665318171181672*^9, 3.665318202704878*^9}, {
   3.6653183216068077`*^9, 3.6653183520994596`*^9}, {3.66531839215139*^9, 
   3.6653184111501756`*^9}, 3.6653192263125267`*^9, 3.6653192607611127`*^9, {
   3.665319433827194*^9, 3.665319470875516*^9}, {3.6653197007946744`*^9, 
   3.6653197104984245`*^9}, {3.6653202255463314`*^9, 3.665320244858407*^9}, {
   3.6653207815004144`*^9, 3.6653208951053333`*^9}, {3.6653209452862015`*^9, 
   3.66532097842157*^9}, {3.6653210227354336`*^9, 3.6653211041830716`*^9}, {
   3.665321718658688*^9, 3.6653217820570545`*^9}, {3.6653218590977*^9, 
   3.665321920578185*^9}, {3.665322195244587*^9, 3.6653222033328075`*^9}, {
   3.6653223748763256`*^9, 3.6653224330165462`*^9}, {3.66532322955106*^9, 
   3.6653232390476637`*^9}, {3.6653238225077314`*^9, 3.665323879242934*^9}, {
   3.6653239159845405`*^9, 3.665324034040783*^9}, {3.6653257558168*^9, 
   3.6653257558748393`*^9}, 3.6653807684593163`*^9, 3.665382653447832*^9, {
   3.665382822865073*^9, 3.6653828563613834`*^9}, {3.66582909427794*^9, 
   3.6658292597094507`*^9}, {3.6658299234133587`*^9, 3.665829977618461*^9}, {
   3.6658308957020197`*^9, 3.6658310019404287`*^9}, {3.6658312045437026`*^9, 
   3.665831234129227*^9}, {3.6658313265717707`*^9, 3.6658313270928154`*^9}, {
   3.6664208553713064`*^9, 3.6664208778701353`*^9}, {3.66651792208259*^9, 
   3.666517930994763*^9}, 3.666517961471607*^9, {3.666517997380292*^9, 
   3.666518062931031*^9}, 3.6670474953472576`*^9, {3.667626576193415*^9, 
   3.667626576509848*^9}, 3.667653346462734*^9, 3.667653531516667*^9, {
   3.6678188454069405`*^9, 3.667818846048108*^9}, {3.6678189099465003`*^9, 
   3.66781891071243*^9}, {3.667819054132759*^9, 3.6678190576420317`*^9}, {
   3.667819620850654*^9, 3.6678196409064083`*^9}, {3.667819694134383*^9, 
   3.667819700130105*^9}, {3.6678197654834876`*^9, 3.6678198404429827`*^9}, {
   3.6678198795684114`*^9, 3.6678199007829895`*^9}, 3.6716871146739874`*^9, {
   3.6716873375939207`*^9, 3.6716873382502003`*^9}, {3.6727456592168736`*^9, 
   3.6727456611511574`*^9}, 3.6727462225051703`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "105"}],
  SequenceForm["ii=", 105],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.66582997833436*^9, 3.6658309479064755`*^9, 
  3.665831006625276*^9, 3.6658312350311737`*^9, 3.665831276370129*^9, 
  3.6665369146778035`*^9, 3.667629603954303*^9, 3.6676586805923185`*^9, 
  3.667818270661164*^9, 3.6678200328374352`*^9, 3.6727456673579245`*^9}]
}, Closed]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.665318117879394*^9, 3.665318118113784*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Here", " ", "we", " ", "check", " ", "pathMatrix"}], ",", " ", 
   "traditionalPathMatrix", ",", " ", "minorsAsPerfectMatchings"}], 
  "*)"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653194611906705`*^9, 3.665319470875516*^9}, 
   3.665319696162837*^9, 3.665319923129767*^9, {3.66532084581382*^9, 
   3.6653208558484077`*^9}, 3.66532141327155*^9, 3.665829906274736*^9, {
   3.6658312848720827`*^9, 3.6658313114351516`*^9}, 3.6664206176135726`*^9, {
   3.6664421517798457`*^9, 3.66644215206118*^9}, {3.666509501899232*^9, 
   3.666509508482244*^9}, {3.6678221086947823`*^9, 3.6678221145798483`*^9}, {
   3.672745989199212*^9, 3.672745989279896*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"giveMeLoopDenominator", "[", 
    RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_", ",", "theperf_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "adjacencymat", ",", "kasteleyn", ",", "perfpositions", ",", "jj", ",", 
       "graph", ",", "turnIntoContributionNothingAdded", ",", "cycles", ",", 
       "loopnodes", ",", "extraloopnodes", ",", "toadd", ",", 
       "loopcontributions"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"adjacencymat", "=", 
       RowBox[{"UpperTriangularize", "[", 
        RowBox[{"turnIntoAdjacencyMatrix", "[", 
         RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"kasteleyn", "=", 
       RowBox[{"joinupKasteleyn", "[", 
        RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"perfpositions", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{"{", 
              RowBox[{"2", ",", "1"}], "}"}], "]"}], "]"}], "+", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Length", "[", "kasteleyn", "]"}], ",", "0"}], "}"}]}], 
          "&"}], ",", 
         RowBox[{"Position", "[", 
          RowBox[{"kasteleyn", ",", 
           RowBox[{"Alternatives", "@@", 
            RowBox[{"Variables", "[", "theperf", "]"}]}]}], "]"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"jj", "=", "1"}], ",", 
        RowBox[{"jj", "\[LessEqual]", 
         RowBox[{"Length", "[", "perfpositions", "]"}]}], ",", 
        RowBox[{"jj", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"adjacencymat", "[", 
           RowBox[{"[", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"perfpositions", "[", 
              RowBox[{"[", "jj", "]"}], "]"}]}], "]"}], "]"}], "=", "1"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"adjacencymat", "[", 
           RowBox[{"[", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"Reverse", "[", 
              RowBox[{"perfpositions", "[", 
               RowBox[{"[", "jj", "]"}], "]"}], "]"}]}], "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{"adjacencymat", "[", 
            RowBox[{"[", 
             RowBox[{"Sequence", "@@", 
              RowBox[{"Reverse", "[", 
               RowBox[{"perfpositions", "[", 
                RowBox[{"[", "jj", "]"}], "]"}], "]"}]}], "]"}], "]"}], "-", 
           "1"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"graph", "=", 
       RowBox[{"AdjacencyGraph", "[", "adjacencymat", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"turnIntoContributionNothingAdded", "=", 
       RowBox[{"Function", "[", 
        RowBox[{
         RowBox[{"{", "pathnodes", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "bigmatrix", ",", "edges", ",", "edgedirections", ",", 
             "giveContribution", ",", "totalcontrib"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"bigmatrix", "=", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{"0", ",", 
                   RowBox[{"{", 
                    RowBox[{"iii", ",", 
                    RowBox[{"Length", "[", "kasteleyn", "]"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"jjj", ",", 
                    RowBox[{"Length", "[", "kasteleyn", "]"}]}], "}"}]}], 
                  "]"}], ",", 
                 RowBox[{"Transpose", "[", "kasteleyn", "]"}]}], "]"}], ",", 
               RowBox[{"Join", "[", 
                RowBox[{"kasteleyn", ",", 
                 RowBox[{"Table", "[", 
                  RowBox[{"0", ",", 
                   RowBox[{"{", 
                    RowBox[{"iii", ",", 
                    RowBox[{
                    RowBox[{"Dimensions", "[", "kasteleyn", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"jjj", ",", 
                    RowBox[{
                    RowBox[{"Dimensions", "[", "kasteleyn", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], "]"}],
                ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"edges", "=", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"bigmatrix", "[", 
                 RowBox[{"[", 
                  RowBox[{"Sequence", "@@", "#"}], "]"}], "]"}], "&"}], ",", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"pathnodes", "[", 
                  RowBox[{"[", 
                   RowBox[{"{", 
                    RowBox[{"iii", ",", 
                    RowBox[{"iii", "+", "1"}]}], "}"}], "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"iii", ",", 
                   RowBox[{
                    RowBox[{"Length", "[", "pathnodes", "]"}], "-", "1"}]}], 
                  "}"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"edgedirections", "=", 
             RowBox[{
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Ordering", "[", "#", "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"pathnodes", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"iii", ",", 
                    RowBox[{"iii", "+", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"iii", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "pathnodes", "]"}], "-", "1"}]}], 
                   "}"}]}], "]"}]}], "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{"2", "\[Rule]", 
                RowBox[{"-", "1"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"giveContribution", "=", 
             RowBox[{"Function", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"edges", ",", "sign"}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Block", "[", 
                RowBox[{
                 RowBox[{"{", "contribution", "}"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"sign", "\[Equal]", "1"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"contribution", "=", 
                    RowBox[{"Total", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"Variables", "[", "edges", "]"}], ",", 
                    RowBox[{"Complement", "[", 
                    RowBox[{
                    RowBox[{"Variables", "[", "kasteleyn", "]"}], ",", 
                    RowBox[{"Variables", "[", "theperf", "]"}]}], "]"}]}], 
                    "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"contribution", "=", 
                    RowBox[{"Total", "[", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"1", "/", "#"}], "&"}], ",", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"Variables", "[", "edges", "]"}], ",", 
                    RowBox[{"Variables", "[", "theperf", "]"}]}], "]"}]}], 
                    "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
                  ";", "\[IndentingNewLine]", "contribution"}]}], "]"}]}], 
              "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"totalcontrib", "=", 
             RowBox[{"Times", "@@", 
              RowBox[{"MapThread", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"giveContribution", "[", 
                  RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
                RowBox[{"{", 
                 RowBox[{"edges", ",", "edgedirections"}], "}"}]}], "]"}]}]}],
             ";", "\[IndentingNewLine]", "totalcontrib"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"cycles", "=", 
       RowBox[{
        RowBox[{"FindCycle", "[", 
         RowBox[{"graph", ",", "Infinity", ",", "All"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{"DirectedEdge", "\[Rule]", "List"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"loopnodes", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", 
            RowBox[{"Append", "[", 
             RowBox[{
              RowBox[{"Range", "[", 
               RowBox[{"1", ",", 
                RowBox[{"Length", "[", "#", "]"}], ",", "2"}], "]"}], ",", 
              RowBox[{"Length", "[", "#", "]"}]}], "]"}], "]"}], "]"}], "&"}],
          ",", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Join", "@@", "#"}], "&"}], ",", "cycles"}], "]"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"extraloopnodes", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"jj", "=", "2"}], ",", 
        RowBox[{"jj", "\[LessEqual]", 
         RowBox[{"Length", "[", "loopnodes", "]"}]}], ",", 
        RowBox[{"jj", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"toadd", "=", 
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"Subsets", "[", 
             RowBox[{"loopnodes", ",", 
              RowBox[{"{", "jj", "}"}]}], "]"}], ",", 
            RowBox[{"zz_", "/;", 
             RowBox[{
              RowBox[{"Join", "@@", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Intersection", "@@", "#"}], "&"}], ",", 
                 RowBox[{"Subsets", "[", 
                  RowBox[{"zz", ",", 
                   RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}]}], "===", 
              RowBox[{"{", "}"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"toadd", "===", 
            RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Break", "[", "]"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"extraloopnodes", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"extraloopnodes", ",", "toadd"}], "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"loopnodes", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"{", "loopnodes", "}"}], "]"}], ",", "extraloopnodes"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"loopcontributions", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Power", "[", 
            RowBox[{
             RowBox[{"-", "1"}], ",", 
             RowBox[{
              RowBox[{"Length", "[", "#", "]"}], "-", "1"}]}], "]"}], 
           RowBox[{"(", 
            RowBox[{"Times", "@@", "#"}], ")"}]}], "&"}], ",", 
         RowBox[{"Map", "[", 
          RowBox[{"turnIntoContributionNothingAdded", ",", "loopnodes", ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"Total", "[", "loopcontributions", "]"}]}], ")"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"alternativeConnectivityMat", "[", 
    RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_", ",", 
     RowBox[{"referencematching_:", "Null"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "theperf", ",", "adjacencymat", ",", "kasteleyn", ",", "perfpositions", 
       ",", "jj", ",", "graph", ",", "cyclenodes", ",", 
       "turnIntoContributionNothingAdded", ",", "cycles", ",", "loopnodes", 
       ",", "extraloopnodes", ",", "toadd", ",", "loopcontributions", ",", 
       "turnIntoContribution", ",", "connectivitymat"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"referencematching", "===", "Null"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"theperf", "=", 
          RowBox[{
           RowBox[{"perfectMatchings", "[", 
            RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"lowNumberLoopsPMpos", "[", 
             RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}], 
           "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
        RowBox[{
         RowBox[{"theperf", "=", "referencematching"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"adjacencymat", "=", 
       RowBox[{"UpperTriangularize", "[", 
        RowBox[{"turnIntoAdjacencyMatrix", "[", 
         RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"kasteleyn", "=", 
       RowBox[{"joinupKasteleyn", "[", 
        RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"perfpositions", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{"{", 
              RowBox[{"2", ",", "1"}], "}"}], "]"}], "]"}], "+", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Length", "[", "kasteleyn", "]"}], ",", "0"}], "}"}]}], 
          "&"}], ",", 
         RowBox[{"Position", "[", 
          RowBox[{"kasteleyn", ",", 
           RowBox[{"Alternatives", "@@", 
            RowBox[{"Variables", "[", "theperf", "]"}]}]}], "]"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"jj", "=", "1"}], ",", 
        RowBox[{"jj", "\[LessEqual]", 
         RowBox[{"Length", "[", "perfpositions", "]"}]}], ",", 
        RowBox[{"jj", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"adjacencymat", "[", 
           RowBox[{"[", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"perfpositions", "[", 
              RowBox[{"[", "jj", "]"}], "]"}]}], "]"}], "]"}], "=", "1"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"adjacencymat", "[", 
           RowBox[{"[", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"Reverse", "[", 
              RowBox[{"perfpositions", "[", 
               RowBox[{"[", "jj", "]"}], "]"}], "]"}]}], "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{"adjacencymat", "[", 
            RowBox[{"[", 
             RowBox[{"Sequence", "@@", 
              RowBox[{"Reverse", "[", 
               RowBox[{"perfpositions", "[", 
                RowBox[{"[", "jj", "]"}], "]"}], "]"}]}], "]"}], "]"}], "-", 
           "1"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"graph", "=", 
       RowBox[{"AdjacencyGraph", "[", "adjacencymat", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"turnIntoContributionNothingAdded", "=", 
       RowBox[{"Function", "[", 
        RowBox[{
         RowBox[{"{", "pathnodes", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "bigmatrix", ",", "edges", ",", "edgedirections", ",", 
             "giveContribution", ",", "totalcontrib"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"bigmatrix", "=", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{"0", ",", 
                   RowBox[{"{", 
                    RowBox[{"iii", ",", 
                    RowBox[{"Length", "[", "kasteleyn", "]"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"jjj", ",", 
                    RowBox[{"Length", "[", "kasteleyn", "]"}]}], "}"}]}], 
                  "]"}], ",", 
                 RowBox[{"Transpose", "[", "kasteleyn", "]"}]}], "]"}], ",", 
               RowBox[{"Join", "[", 
                RowBox[{"kasteleyn", ",", 
                 RowBox[{"Table", "[", 
                  RowBox[{"0", ",", 
                   RowBox[{"{", 
                    RowBox[{"iii", ",", 
                    RowBox[{
                    RowBox[{"Dimensions", "[", "kasteleyn", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"jjj", ",", 
                    RowBox[{
                    RowBox[{"Dimensions", "[", "kasteleyn", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], "]"}],
                ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"edges", "=", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"bigmatrix", "[", 
                 RowBox[{"[", 
                  RowBox[{"Sequence", "@@", "#"}], "]"}], "]"}], "&"}], ",", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"pathnodes", "[", 
                  RowBox[{"[", 
                   RowBox[{"{", 
                    RowBox[{"iii", ",", 
                    RowBox[{"iii", "+", "1"}]}], "}"}], "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"iii", ",", 
                   RowBox[{
                    RowBox[{"Length", "[", "pathnodes", "]"}], "-", "1"}]}], 
                  "}"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"edgedirections", "=", 
             RowBox[{
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Ordering", "[", "#", "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"pathnodes", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"iii", ",", 
                    RowBox[{"iii", "+", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"iii", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "pathnodes", "]"}], "-", "1"}]}], 
                   "}"}]}], "]"}]}], "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{"2", "\[Rule]", 
                RowBox[{"-", "1"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"giveContribution", "=", 
             RowBox[{"Function", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"edges", ",", "sign"}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Block", "[", 
                RowBox[{
                 RowBox[{"{", "contribution", "}"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"sign", "\[Equal]", "1"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"contribution", "=", 
                    RowBox[{"Total", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"Variables", "[", "edges", "]"}], ",", 
                    RowBox[{"Complement", "[", 
                    RowBox[{
                    RowBox[{"Variables", "[", "kasteleyn", "]"}], ",", 
                    RowBox[{"Variables", "[", "theperf", "]"}]}], "]"}]}], 
                    "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"contribution", "=", 
                    RowBox[{"Total", "[", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"1", "/", "#"}], "&"}], ",", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"Variables", "[", "edges", "]"}], ",", 
                    RowBox[{"Variables", "[", "theperf", "]"}]}], "]"}]}], 
                    "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
                  ";", "\[IndentingNewLine]", "contribution"}]}], "]"}]}], 
              "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"totalcontrib", "=", 
             RowBox[{"Times", "@@", 
              RowBox[{"MapThread", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"giveContribution", "[", 
                  RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
                RowBox[{"{", 
                 RowBox[{"edges", ",", "edgedirections"}], "}"}]}], "]"}]}]}],
             ";", "\[IndentingNewLine]", "totalcontrib"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"cycles", "=", 
       RowBox[{
        RowBox[{"FindCycle", "[", 
         RowBox[{"graph", ",", "Infinity", ",", "All"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{"DirectedEdge", "\[Rule]", "List"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"loopnodes", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", 
            RowBox[{"Append", "[", 
             RowBox[{
              RowBox[{"Range", "[", 
               RowBox[{"1", ",", 
                RowBox[{"Length", "[", "#", "]"}], ",", "2"}], "]"}], ",", 
              RowBox[{"Length", "[", "#", "]"}]}], "]"}], "]"}], "]"}], "&"}],
          ",", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Join", "@@", "#"}], "&"}], ",", "cycles"}], "]"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"extraloopnodes", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"jj", "=", "2"}], ",", 
        RowBox[{"jj", "\[LessEqual]", 
         RowBox[{"Length", "[", "loopnodes", "]"}]}], ",", 
        RowBox[{"jj", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"toadd", "=", 
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"Subsets", "[", 
             RowBox[{"loopnodes", ",", 
              RowBox[{"{", "jj", "}"}]}], "]"}], ",", 
            RowBox[{"zz_", "/;", 
             RowBox[{
              RowBox[{"Join", "@@", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Intersection", "@@", "#"}], "&"}], ",", 
                 RowBox[{"Subsets", "[", 
                  RowBox[{"zz", ",", 
                   RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}]}], "===", 
              RowBox[{"{", "}"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"toadd", "===", 
            RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Break", "[", "]"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"extraloopnodes", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"extraloopnodes", ",", "toadd"}], "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"loopnodes", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"{", "loopnodes", "}"}], "]"}], ",", "extraloopnodes"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"loopcontributions", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Power", "[", 
            RowBox[{
             RowBox[{"-", "1"}], ",", 
             RowBox[{
              RowBox[{"Length", "[", "#", "]"}], "-", "1"}]}], "]"}], 
           RowBox[{"(", 
            RowBox[{"Times", "@@", "#"}], ")"}]}], "&"}], ",", 
         RowBox[{"Map", "[", 
          RowBox[{"turnIntoContributionNothingAdded", ",", "loopnodes", ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"cyclenodes", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Union", "@@", "#"}], "&"}], ",", "loopnodes"}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"turnIntoContribution", "=", 
       RowBox[{"Function", "[", 
        RowBox[{
         RowBox[{"{", "pathnodes", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", "totalcontrib", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"totalcontrib", "=", 
             RowBox[{
             "turnIntoContributionNothingAdded", "[", "pathnodes", "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"totalcontrib", "=", 
             RowBox[{"totalcontrib", "/", 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"Total", "[", "loopcontributions", "]"}]}], ")"}]}]}],
             ";", "\[IndentingNewLine]", 
            RowBox[{"totalcontrib", "=", 
             RowBox[{"totalcontrib", 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"Total", "[", 
                 RowBox[{"loopcontributions", "[", 
                  RowBox[{"[", 
                   RowBox[{"Flatten", "[", 
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{"#", ",", "pathnodes"}], "]"}], "]"}], ">", "0"}],
                     "&"}], ",", "cyclenodes"}], "]"}], ",", "False"}], "]"}],
                     "]"}], "]"}], "]"}], "]"}]}], ")"}]}]}], ";", 
            "\[IndentingNewLine]", "totalcontrib"}]}], "\[IndentingNewLine]", 
          "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"connectivitymat", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"FindPath", "[", 
          RowBox[{
          "graph", ",", "iii", ",", "jjj", ",", "Infinity", ",", "All"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"iii", ",", 
           RowBox[{"Total", "[", 
            RowBox[{"Dimensions", "[", "kasteleyn", "]"}], "]"}]}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"jjj", ",", 
           RowBox[{"Total", "[", 
            RowBox[{"Dimensions", "[", "kasteleyn", "]"}], "]"}]}], "}"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"connectivitymat", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{"Join", ",", 
         RowBox[{"{", 
          RowBox[{"connectivitymat", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"DiagonalMatrix", "[", 
               RowBox[{"Range", "[", 
                RowBox[{"Total", "[", 
                 RowBox[{"Dimensions", "[", "kasteleyn", "]"}], "]"}], "]"}], 
               "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{"0", "\[Rule]", 
                RowBox[{"{", "}"}]}], "}"}]}], ")"}], "/.", 
            RowBox[{"{", 
             RowBox[{"zz_Integer", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"{", "zz", "}"}], "}"}]}], "}"}]}]}], "}"}], ",", 
         "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"connectivitymat", "=", 
       RowBox[{"Map", "[", 
        RowBox[{"Total", ",", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"turnIntoContribution", "[", "#", "]"}], "&"}], ",", 
           "connectivitymat", ",", 
           RowBox[{"{", "3", "}"}]}], "]"}], ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "connectivitymat"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.666509501899232*^9, 3.666509508482244*^9}, {
   3.6715443392916718`*^9, 3.6715443399114246`*^9}, 3.6715455279035425`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"formatrule", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["XX_", 
      RowBox[{"z1_", ",", "z2_"}]], "\[Rule]", 
     RowBox[{"XX", "[", 
      RowBox[{"z1", ",", "z2"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ii", "=", "1"}], ",", 
    RowBox[{"ii", "\[LessEqual]", "110"}], ",", 
    RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ii", "\[NotEqual]", "106"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "107"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "110"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<ii=\>\"", ",", "ii"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{"ii", ",", "10"}], "]"}], "\[Equal]", "0"}], ",", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{"\"\<ii=\>\"", ",", "ii"}], "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
        SubscriptBox["bft", "ii"], ";", "\[IndentingNewLine]", 
        RowBox[{"a", "=", 
         RowBox[{"a", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"b", "=", 
         RowBox[{"b", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"c", "=", 
         RowBox[{"c", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"d", "=", 
         RowBox[{"d", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"Transpose", "[", "b", "]"}], ",", "c"}], "]"}], "]"}], 
           "=!=", "0"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"perfs", "=", 
            RowBox[{"perfectMatchings", "[", 
             RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"srcs", "=", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"getSourceNodes", "[", 
                RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "#"}], "]"}], 
               "&"}], ",", "perfs"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"snks", "=", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"getSinkNodes", "[", 
                RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "#"}], "]"}], 
               "&"}], ",", "perfs"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"multiplic", "=", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Tally", "[", "srcs", "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"#", ",", "2"}], "]"}], "]"}], "&"}], ",", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Position", "[", 
                   RowBox[{
                    RowBox[{"Tally", "[", "srcs", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"#", ",", "_"}], "}"}]}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "1"}], "]"}], "]"}], "&"}], ",", 
                "srcs"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"jj", "=", "1"}], ",", 
             RowBox[{"jj", "\[LessEqual]", 
              RowBox[{"Length", "[", "perfs", "]"}]}], ",", 
             RowBox[{"jj", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Mod", "[", 
                  RowBox[{"jj", ",", "10"}], "]"}], "\[Equal]", "0"}], ",", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{"\"\<    jj=\>\"", ",", "jj"}], "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"multiplic", "[", 
                  RowBox[{"[", "jj", "]"}], "]"}], "\[LessEqual]", "9"}], ",",
                 "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"pathmat", "=", 
                  RowBox[{"pathMatrix", "[", 
                   RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", 
                    RowBox[{"perfs", "[", 
                    RowBox[{"[", "jj", "]"}], "]"}]}], "]"}]}], ";", 
                 "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"pathmat", "=!=", "Null"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"sources", "=", 
                    RowBox[{"srcs", "[", 
                    RowBox[{"[", "jj", "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"sinks", "=", 
                    RowBox[{"snks", "[", 
                    RowBox[{"[", "jj", "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Dimensions", "[", "pathmat", "]"}], "=!=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Length", "[", "sources", "]"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Join", "[", 
                    RowBox[{"sources", ",", "sinks"}], "]"}], "]"}]}], 
                    "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<ii=\>\"", ",", "ii", ",", 
                    "\"\< : There's a problem with the path matrix! Its size \
is not correct!\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"numberofdenomintaorterms", "=", 
                    RowBox[{"Sort", "[", 
                    RowBox[{"DeleteDuplicates", "[", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"{", "denom", "}"}], ",", 
                    RowBox[{"Block", "[", 
                    RowBox[{
                    RowBox[{"{", "output", "}"}], ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Head", "[", "denom", "]"}], "===", "Plus"}], ",", 
                    RowBox[{
                    RowBox[{"output", "=", 
                    RowBox[{"Length", "[", "denom", "]"}]}], ";"}], ",", 
                    RowBox[{
                    RowBox[{"output", "=", "1"}], ";"}]}], "]"}], ";", 
                    "output"}]}], "]"}]}], "]"}], "[", "#", "]"}], "&"}], ",", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"{", "terms", "}"}], ",", 
                    RowBox[{"Block", "[", 
                    RowBox[{
                    RowBox[{"{", "output", "}"}], ",", 
                    RowBox[{
                    RowBox[{"output", "=", 
                    RowBox[{"Expand", "[", "terms", "]"}]}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Head", "[", "output", "]"}], "===", "Plus"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"output", "=", 
                    RowBox[{"List", "@@", "output"}]}], ";"}], ",", 
                    RowBox[{
                    RowBox[{"output", "=", 
                    RowBox[{"{", "output", "}"}]}], ";"}]}], "]"}], ";", 
                    RowBox[{"output", "=", 
                    RowBox[{"Map", "[", 
                    RowBox[{"Expand", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{"Denominator", ",", "output"}], "]"}]}], "]"}]}], 
                    ";", "output"}]}], "]"}]}], "]"}], "[", "#", "]"}], "&"}],
                     ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", "pathmat", "]"}], ",", 
                    RowBox[{"0", "|", "1"}]}], "]"}]}], "]"}], "]"}]}], "]"}],
                     "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ii", "\[NotEqual]", "102"}], "&&", 
                    RowBox[{"ii", "\[NotEqual]", "103"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"numberofdenomintaorterms", "=!=", 
                    RowBox[{"{", 
                    RowBox[{"multiplic", "[", 
                    RowBox[{"[", "jj", "]"}], "]"}], "}"}]}], "&&", 
                    RowBox[{"numberofdenomintaorterms", "=!=", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"multiplic", "[", 
                    RowBox[{"[", "jj", "]"}], "]"}]}], "}"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<ii=\>\"", ",", "ii", ",", 
                    "\"\< : There's a problem with the path matrix! The \
denominators do not all have the right number of terms\>\""}], "]"}], ";"}]}],
                     "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"variablesmatrix", "=", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"Variables", "[", "#", "]"}], ",", 
                    RowBox[{"Variables", "[", 
                    RowBox[{"Join", "[", 
                    RowBox[{"b", ",", "c"}], "]"}], "]"}]}], "]"}], "&"}], 
                    ",", "pathmat", ",", 
                    RowBox[{"{", "2", "}"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"sourceedges", "=", 
                    RowBox[{"getSourceEdges", "[", 
                    RowBox[{"b", ",", "c", ",", 
                    RowBox[{"perfs", "[", 
                    RowBox[{"[", "jj", "]"}], "]"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"sinkedges", "=", 
                    RowBox[{"getSinkEdges", "[", 
                    RowBox[{"b", ",", "c", ",", 
                    RowBox[{"perfs", "[", 
                    RowBox[{"[", "jj", "]"}], "]"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sort", "[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"DeleteDuplicates", "[", 
                    RowBox[{"Join", "@@", "#"}], "]"}], "&"}], ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Intersection", "[", 
                    RowBox[{"#", ",", "sourceedges"}], "]"}], "&"}], ",", 
                    "variablesmatrix", ",", 
                    RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], "]"}], "]"}], "===", 
                    RowBox[{"Sort", "[", "sourceedges", "]"}]}], ")"}], "&&", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sort", "[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"DeleteDuplicates", "[", 
                    RowBox[{"Join", "@@", "#"}], "]"}], "&"}], ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Intersection", "[", 
                    RowBox[{"#", ",", "sinkedges"}], "]"}], "&"}], ",", 
                    RowBox[{"Transpose", "[", "variablesmatrix", "]"}], ",", 
                    RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], "]"}], "]"}], "===", 
                    RowBox[{"Sort", "[", "sinkedges", "]"}]}], ")"}]}], ")"}],
                     "=!=", "True"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<ii=\>\"", ",", "ii", ",", 
                    "\"\< : There's a problem with the path matrix! It \
doesn't seem to be going from sources to sinks\>\""}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"minors", "=", 
                    RowBox[{"Expand", "[", 
                    RowBox[{"Simplify", "[", 
                    RowBox[{
                    RowBox[{"Minors", "[", 
                    RowBox[{"pathmat", ",", 
                    RowBox[{"Length", "[", "pathmat", "]"}]}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{"minors", ",", 
                    RowBox[{
                    RowBox[{"Power", "[", 
                    RowBox[{"___", ",", "2"}], "]"}], "|", 
                    RowBox[{"Power", "[", 
                    RowBox[{"___", ",", "3"}], "]"}], "|", 
                    RowBox[{"Power", "[", 
                    RowBox[{"___", ",", "4"}], "]"}], "|", 
                    RowBox[{"Times", "[", 
                    RowBox[{"2", ",", "___"}], "]"}], "|", 
                    RowBox[{"Times", "[", 
                    RowBox[{"3", ",", "___"}], "]"}], "|", 
                    RowBox[{"Times", "[", 
                    RowBox[{"4", ",", "___"}], "]"}]}]}], "]"}], "=!=", 
                    RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<ii=\>\"", ",", "ii", ",", 
                    "\"\< : There's a problem with the path matrix! Its \
minors do not simplify\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
                    ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"multiplic", "[", 
                    RowBox[{"[", "jj", "]"}], "]"}], "\[LessEqual]", "3"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "NB", " ", "expecteddenominatorloops", " ", "SOMETIMES", 
                    " ", "HAS", " ", "POSITIVE", " ", "TERMS", " ", "AS", " ", 
                    RowBox[{"WELL", "!"}], " ", "This", " ", "only", " ", 
                    "works", " ", "for", " ", "small", " ", "numbers", " ", 
                    "of", " ", "loops", " ", "and", " ", 
                    RowBox[{"won", "'"}], "t", " ", "work", " ", "in", " ", 
                    RowBox[{
                    RowBox[{"general", "!!"}], "!"}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"expecteddenominatorloops", "=", 
                    RowBox[{
                    RowBox[{"perfs", "[", 
                    RowBox[{"[", "jj", "]"}], "]"}], "+", 
                    RowBox[{"Total", "[", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"perfs", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], "&"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cases", "[", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{"matroidPolytope", "[", 
                    RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}],
                     ",", "#"}], "]"}], "]"}], "&"}], ",", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"turnIntoPolytope", "[", 
                    RowBox[{"matroidPolytope", "[", 
                    RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}],
                     "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"___", ",", "jj", ",", "___"}], "}"}]}], "]"}], 
                    "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "jj"}], "]"}]}], 
                    "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"expecteddenominatorloops", "=", 
                    RowBox[{"Expand", "[", 
                    RowBox[{"Simplify", "[", 
                    RowBox[{
                    RowBox[{"perfs", "[", 
                    RowBox[{"[", "jj", "]"}], "]"}], 
                    RowBox[{"loopDenominator", "[", 
                    RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", 
                    RowBox[{"perfs", "[", 
                    RowBox[{"[", "jj", "]"}], "]"}]}], "]"}]}], "]"}], 
                    "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"niceminors", "=", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Expand", "[", 
                    RowBox[{"Simplify", "[", 
                    RowBox[{"minors", " ", "expecteddenominatorloops"}], 
                    "]"}], "]"}], "/.", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"perfs", "[", 
                    RowBox[{"[", "iii", "]"}], "]"}], "\[Rule]", 
                    RowBox[{"pp", "[", "iii", "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"iii", ",", 
                    RowBox[{"Length", "[", "perfs", "]"}]}], "}"}]}], "]"}]}],
                     ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"theperfsinminors", "=", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"{", "mino", "}"}], ",", 
                    RowBox[{"Block", "[", 
                    RowBox[{
                    RowBox[{"{", "output", "}"}], ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Head", "[", "mino", "]"}], "===", "Plus"}], ",", 
                    RowBox[{
                    RowBox[{"output", "=", 
                    RowBox[{"List", "@@", "mino"}]}], ";"}], ",", 
                    RowBox[{
                    RowBox[{"output", "=", 
                    RowBox[{"{", "mino", "}"}]}], ";"}]}], "]"}], ";", 
                    "output"}]}], "]"}]}], "]"}], "[", "#", "]"}], "&"}], ",",
                     "niceminors"}], "]"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"pp", "[", "zz_", "]"}]}], "\[Rule]", 
                    RowBox[{"pp", "[", "zz", "]"}]}], "}"}]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"And", "@@", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Head", "[", "#", "]"}], "===", "pp"}], "&"}], 
                    ",", 
                    RowBox[{"Flatten", "[", "theperfsinminors", "]"}]}], 
                    "]"}]}], ")"}], "\[Equal]", "False"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<ii=\>\"", ",", "ii", ",", 
                    "\"\< : There's a problem with the path matrix! Its \
minors are not equal to sums of perfect matchings\>\""}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"DeleteDuplicates", ",", 
                    RowBox[{"theperfsinminors", "/.", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"pp", "[", "iii", "]"}], "\[Rule]", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Sort", ",", 
                    RowBox[{"srcs", "/.", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"getOrderingExternalNodesDefault", "[", 
                    RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "[", 
                    RowBox[{"[", "jjj", "]"}], "]"}], "\[Rule]", "jjj"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"jjj", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"getOrderingExternalNodesDefault", "[", 
                    RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], 
                    "]"}]}], "}"}]}], "]"}]}]}], "]"}], "[", 
                    RowBox[{"[", "iii", "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"iii", ",", 
                    RowBox[{"Length", "[", "perfs", "]"}]}], "}"}]}], 
                    "]"}]}]}], "]"}], "=!=", 
                    RowBox[{"Delete", "[", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{"Subsets", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"Dimensions", "[", "pathmat", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Length", "[", "pathmat", "]"}], "}"}]}], "]"}], 
                    "}"}], "]"}], ",", 
                    RowBox[{"Position", "[", 
                    RowBox[{"minors", ",", "0"}], "]"}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<ii=\>\"", ",", "ii", ",", 
                    "\"\< : There's a problem with the path matrix! The \
perfect matchings contributing to each minor do not have the correct source \
sets\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"theperfsinminors", "=!=", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"{", "mino", "}"}], ",", 
                    RowBox[{"Block", "[", 
                    RowBox[{
                    RowBox[{"{", "output", "}"}], ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Head", "[", "mino", "]"}], "===", "Plus"}], ",", 
                    RowBox[{
                    RowBox[{"output", "=", 
                    RowBox[{"List", "@@", "mino"}]}], ";"}], ",", 
                    RowBox[{
                    RowBox[{"output", "=", 
                    RowBox[{"{", "mino", "}"}]}], ";"}]}], "]"}], ";", 
                    "output"}]}], "]"}]}], "]"}], "[", "#", "]"}], "&"}], ",", 
                    RowBox[{
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"minorsAsPerfectMatchings", "[", 
                    RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], ",", 
                    "0"}], "]"}], "/.", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"perfs", "[", 
                    RowBox[{"[", "iii", "]"}], "]"}], "\[Rule]", 
                    RowBox[{"pp", "[", "iii", "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"iii", ",", 
                    RowBox[{"Length", "[", "perfs", "]"}]}], "}"}]}], 
                    "]"}]}]}], "]"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"pp", "[", "zz_", "]"}]}], "\[Rule]", 
                    RowBox[{"pp", "[", "zz", "]"}]}], "}"}]}], ")"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<ii=\>\"", ",", "ii", ",", 
                    "\"\< : There's a problem with minorsAsPerfectMatchings! \
The perfect matchings contributing to each minor do not correspond to the \
calculation done directly by the path matrix\>\""}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"Now", " ", 
                    RowBox[{"we", "'"}], "ll", " ", "check", " ", "whether", 
                    " ", "minorsAsPerfectMatchings", " ", "is", " ", 
                    "completely", " ", "correct"}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"bigpathmatrix", "=", 
                    RowBox[{"connectivityMatrix", "[", 
                    RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", 
                    RowBox[{"perfs", "[", 
                    RowBox[{"[", "jj", "]"}], "]"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"externalrows", "=", 
                    RowBox[{"getSourceNodes", "[", 
                    RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", 
                    RowBox[{"perfs", "[", 
                    RowBox[{"[", "jj", "]"}], "]"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"externalcolumns", "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "a", "]"}], "+", "1"}], ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "a", "]"}], "+", 
                    RowBox[{"Length", "[", "c", "]"}]}]}], "]"}], ",", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"Dimensions", "[", "a", "]"}], "]"}], "+", 
                    RowBox[{"Length", "[", "c", "]"}], "+", "1"}], ",", 
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"Dimensions", "[", "a", "]"}], "]"}], "+", 
                    RowBox[{"Length", "[", "c", "]"}], "+", 
                    RowBox[{
                    RowBox[{"Dimensions", "[", "b", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}], "]"}]}], ";",
                     "\[IndentingNewLine]", 
                    RowBox[{"finalpathmatrix", "=", 
                    RowBox[{"Expand", "[", 
                    RowBox[{"Simplify", "[", 
                    RowBox[{"bigpathmatrix", "[", 
                    RowBox[{"[", 
                    RowBox[{"externalrows", ",", "externalcolumns"}], "]"}], 
                    "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Simplify", "[", 
                    RowBox[{"finalpathmatrix", "\[Equal]", "pathmat"}], "]"}],
                     "=!=", "True"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<ii=\>\"", ",", "ii", ",", "\"\< and jj=\>\"", ",", 
                    "jj", ",", 
                    "\"\< : There's a problem with the path matrix! It \
doesn't give the same result as what is found using the alternative method!\>\
\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"multiplic", "[", 
                    RowBox[{"[", "jj", "]"}], "]"}], "\[LessEqual]", "3"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"traditionalpathmat", "=", 
                    RowBox[{"Simplify", "[", 
                    RowBox[{"traditionalPathMatrix", "[", 
                    RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", 
                    RowBox[{"perfs", "[", 
                    RowBox[{"[", "jj", "]"}], "]"}]}], "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Simplify", "[", 
                    RowBox[{"finalpathmatrix", "\[Equal]", "pathmat"}], "]"}],
                     "=!=", "True"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<ii=\>\"", ",", "ii", ",", "\"\< and jj=\>\"", ",", 
                    "jj", ",", 
                    "\"\< : There's a problem with the path matrix! It \
doesn't give the same result as what is found using the traditional method!\>\
\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"minors", "=", 
                    RowBox[{
                    RowBox[{"Minors", "[", 
                    RowBox[{"finalpathmatrix", ",", 
                    RowBox[{"Length", "[", "finalpathmatrix", "]"}]}], "]"}], 
                    "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"loopdenominator", "=", 
                    RowBox[{"Expand", "[", 
                    RowBox[{
                    RowBox[{"perfs", "[", 
                    RowBox[{"[", "jj", "]"}], "]"}], " ", 
                    RowBox[{"giveMeLoopDenominator", "[", 
                    RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", 
                    RowBox[{"perfs", "[", 
                    RowBox[{"[", "jj", "]"}], "]"}]}], "]"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"truemapminortoperfmatch", "=", 
                    RowBox[{"Expand", "[", 
                    RowBox[{"Simplify", "[", 
                    RowBox[{"minors", " ", "loopdenominator"}], "]"}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"minorsAsPerfectMatchings", "[", 
                    RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", 
                    RowBox[{"perfs", "[", 
                    RowBox[{"[", "jj", "]"}], "]"}]}], "]"}], "=!=", 
                    "truemapminortoperfmatch"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<ii=\>\"", ",", "ii", ",", "\"\< and jj=\>\"", ",", 
                    "jj", ",", 
                    "\"\< : There's a problem with minorsAsPerfectMatchings! \
It doesn't give the same result as what is found using the alternative \
method!\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
                  "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], 
                 ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
            "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{
           RowBox[{"Print", "[", "\"\<We have a dimer\>\"", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.665318171181672*^9, 3.665318202704878*^9}, {
   3.6653183216068077`*^9, 3.6653183520994596`*^9}, {3.66531839215139*^9, 
   3.6653184111501756`*^9}, 3.6653192263125267`*^9, 3.6653192607611127`*^9, {
   3.665319433827194*^9, 3.665319470875516*^9}, {3.6653197007946744`*^9, 
   3.6653197104984245`*^9}, {3.6653202255463314`*^9, 3.665320244858407*^9}, {
   3.6653207815004144`*^9, 3.6653208951053333`*^9}, {3.6653209452862015`*^9, 
   3.66532097842157*^9}, {3.6653210227354336`*^9, 3.6653211041830716`*^9}, {
   3.665321718658688*^9, 3.6653217820570545`*^9}, {3.6653218590977*^9, 
   3.665321920578185*^9}, {3.665322195244587*^9, 3.6653222033328075`*^9}, {
   3.6653223748763256`*^9, 3.6653224330165462`*^9}, {3.66532322955106*^9, 
   3.6653232390476637`*^9}, {3.6653238225077314`*^9, 3.665323879242934*^9}, {
   3.6653239159845405`*^9, 3.665324034040783*^9}, {3.6653257558168*^9, 
   3.6653257558748393`*^9}, 3.6653807684593163`*^9, 3.665382653447832*^9, {
   3.665382822865073*^9, 3.6653828563613834`*^9}, {3.66582909427794*^9, 
   3.6658292597094507`*^9}, {3.6658299234133587`*^9, 3.665829977618461*^9}, {
   3.6658308957020197`*^9, 3.6658310019404287`*^9}, {3.6658312045437026`*^9, 
   3.665831234129227*^9}, {3.6658313265717707`*^9, 3.6658313270928154`*^9}, {
   3.6664209006025553`*^9, 3.666420911789469*^9}, {3.666420946453127*^9, 
   3.6664209490630703`*^9}, {3.6664210248920765`*^9, 3.666421041038001*^9}, {
   3.6664211336083674`*^9, 3.666421176556402*^9}, {3.6664236999746227`*^9, 
   3.666423787843773*^9}, {3.666441546109849*^9, 3.666441612861856*^9}, {
   3.666441741603876*^9, 3.666441783425001*^9}, {3.666442098130563*^9, 
   3.6664421425794935`*^9}, 3.66644312235295*^9, {3.666443555271324*^9, 
   3.66644357354395*^9}, {3.6664436252769184`*^9, 3.666443625401923*^9}, {
   3.6665056171716013`*^9, 3.666505664269188*^9}, {3.6665090224242725`*^9, 
   3.6665090512695103`*^9}, {3.6665094703980885`*^9, 
   3.6665094734266825`*^9}, {3.6665095349328804`*^9, 
   3.6665096933244467`*^9}, {3.666509939735081*^9, 3.666509955683997*^9}, {
   3.6665100032532773`*^9, 3.666510006325252*^9}, {3.6665117664561977`*^9, 
   3.6665118032677546`*^9}, 3.666514885048891*^9, {3.6665905893701*^9, 
   3.6665905906022277`*^9}, {3.6665906588227625`*^9, 
   3.6665907270128956`*^9}, {3.6670299012834663`*^9, 3.667029902080375*^9}, 
   3.667047500696209*^9, {3.6676394977976055`*^9, 3.6676395062801867`*^9}, 
   3.6676533474639626`*^9, 3.66765338973055*^9, {3.667821779671135*^9, 
   3.6678217812103558`*^9}, {3.6678219755868216`*^9, 3.66782209585775*^9}, 
   3.667823500593598*^9, 3.667827904881147*^9, {3.668401803256127*^9, 
   3.668401816316744*^9}, 3.6715454448814826`*^9, {3.6715457957585354`*^9, 
   3.6715457965669017`*^9}, 3.6715458423398924`*^9, 3.671687061378295*^9, {
   3.6716871152833643`*^9, 3.671687115924023*^9}, 3.671687158805562*^9, 
   3.6716873389115195`*^9, {3.6727457163413506`*^9, 3.6727457183805695`*^9}, {
   3.6727458396154623`*^9, 3.6727458748986835`*^9}, {3.6727459139443836`*^9, 
   3.6727459184909244`*^9}, 3.672745984509122*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "105"}],
  SequenceForm["ii=", 105],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66582997833436*^9, 3.6658309479064755`*^9, 3.665831006625276*^9, 
   3.6658312350311737`*^9, 3.665831276370129*^9, 3.6664211836371965`*^9, 
   3.666423797492416*^9, 3.6664417925385957`*^9, 3.6664421628492785`*^9, 
   3.666443127326795*^9, 3.666443589049753*^9, 3.6664436327264214`*^9, 
   3.6665096901482563`*^9, 3.666509966705723*^9, 3.6665100303017807`*^9, {
   3.666511790804469*^9, 3.666511805057684*^9}, {3.6665148980076685`*^9, 
   3.6665149047161193`*^9}, {3.66659075561583*^9, 3.666590776360248*^9}, 
   3.6665908557611227`*^9, 3.667134048113646*^9, 3.667639509539562*^9, 
   3.6676616976510468`*^9, 3.6678274626383944`*^9, 3.6678279128229694`*^9, 
   3.6727457214413214`*^9, 3.6727459744798555`*^9}],

Cell[BoxData["\<\"We have a dimer\"\>"], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66582997833436*^9, 3.6658309479064755`*^9, 3.665831006625276*^9, 
   3.6658312350311737`*^9, 3.665831276370129*^9, 3.6664211836371965`*^9, 
   3.666423797492416*^9, 3.6664417925385957`*^9, 3.6664421628492785`*^9, 
   3.666443127326795*^9, 3.666443589049753*^9, 3.6664436327264214`*^9, 
   3.6665096901482563`*^9, 3.666509966705723*^9, 3.6665100303017807`*^9, {
   3.666511790804469*^9, 3.666511805057684*^9}, {3.6665148980076685`*^9, 
   3.6665149047161193`*^9}, {3.66659075561583*^9, 3.666590776360248*^9}, 
   3.6665908557611227`*^9, 3.667134048113646*^9, 3.667639509539562*^9, 
   3.6676616976510468`*^9, 3.6678274626383944`*^9, 3.6678279128229694`*^9, 
   3.6727457214413214`*^9, 3.672745974495487*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "108"}],
  SequenceForm["ii=", 108],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66582997833436*^9, 3.6658309479064755`*^9, 3.665831006625276*^9, 
   3.6658312350311737`*^9, 3.665831276370129*^9, 3.6664211836371965`*^9, 
   3.666423797492416*^9, 3.6664417925385957`*^9, 3.6664421628492785`*^9, 
   3.666443127326795*^9, 3.666443589049753*^9, 3.6664436327264214`*^9, 
   3.6665096901482563`*^9, 3.666509966705723*^9, 3.6665100303017807`*^9, {
   3.666511790804469*^9, 3.666511805057684*^9}, {3.6665148980076685`*^9, 
   3.6665149047161193`*^9}, {3.66659075561583*^9, 3.666590776360248*^9}, 
   3.6665908557611227`*^9, 3.667134048113646*^9, 3.667639509539562*^9, 
   3.6676616976510468`*^9, 3.6678274626383944`*^9, 3.6678279128229694`*^9, 
   3.6727457214413214`*^9, 3.672745974495487*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    jj=\"\>", "\[InvisibleSpace]", "10"}],
  SequenceForm["    jj=", 10],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66582997833436*^9, 3.6658309479064755`*^9, 3.665831006625276*^9, 
   3.6658312350311737`*^9, 3.665831276370129*^9, 3.6664211836371965`*^9, 
   3.666423797492416*^9, 3.6664417925385957`*^9, 3.6664421628492785`*^9, 
   3.666443127326795*^9, 3.666443589049753*^9, 3.6664436327264214`*^9, 
   3.6665096901482563`*^9, 3.666509966705723*^9, 3.6665100303017807`*^9, {
   3.666511790804469*^9, 3.666511805057684*^9}, {3.6665148980076685`*^9, 
   3.6665149047161193`*^9}, {3.66659075561583*^9, 3.666590776360248*^9}, 
   3.6665908557611227`*^9, 3.667134048113646*^9, 3.667639509539562*^9, 
   3.6676616976510468`*^9, 3.6678274626383944`*^9, 3.6678279128229694`*^9, 
   3.6727457214413214`*^9, 3.6727459746582623`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "109"}],
  SequenceForm["ii=", 109],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66582997833436*^9, 3.6658309479064755`*^9, 3.665831006625276*^9, 
   3.6658312350311737`*^9, 3.665831276370129*^9, 3.6664211836371965`*^9, 
   3.666423797492416*^9, 3.6664417925385957`*^9, 3.6664421628492785`*^9, 
   3.666443127326795*^9, 3.666443589049753*^9, 3.6664436327264214`*^9, 
   3.6665096901482563`*^9, 3.666509966705723*^9, 3.6665100303017807`*^9, {
   3.666511790804469*^9, 3.666511805057684*^9}, {3.6665148980076685`*^9, 
   3.6665149047161193`*^9}, {3.66659075561583*^9, 3.666590776360248*^9}, 
   3.6665908557611227`*^9, 3.667134048113646*^9, 3.667639509539562*^9, 
   3.6676616976510468`*^9, 3.6678274626383944`*^9, 3.6678279128229694`*^9, 
   3.6727457214413214`*^9, 3.6727459747585363`*^9}],

Cell[BoxData["\<\"We have a dimer\"\>"], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66582997833436*^9, 3.6658309479064755`*^9, 3.665831006625276*^9, 
   3.6658312350311737`*^9, 3.665831276370129*^9, 3.6664211836371965`*^9, 
   3.666423797492416*^9, 3.6664417925385957`*^9, 3.6664421628492785`*^9, 
   3.666443127326795*^9, 3.666443589049753*^9, 3.6664436327264214`*^9, 
   3.6665096901482563`*^9, 3.666509966705723*^9, 3.6665100303017807`*^9, {
   3.666511790804469*^9, 3.666511805057684*^9}, {3.6665148980076685`*^9, 
   3.6665149047161193`*^9}, {3.66659075561583*^9, 3.666590776360248*^9}, 
   3.6665908557611227`*^9, 3.667134048113646*^9, 3.667639509539562*^9, 
   3.6676616976510468`*^9, 3.6678274626383944`*^9, 3.6678279128229694`*^9, 
   3.6727457214413214`*^9, 3.6727459747585363`*^9}]
}, Closed]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.665318117879394*^9, 3.665318118113784*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Here", " ", "we", " ", "check", " ", "dimensionGrassmannian"}], 
   ",", " ", 
   RowBox[{"reducibilityQ", "."}]}], "*)"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653194611906705`*^9, 3.665319470875516*^9}, 
   3.665319696162837*^9, 3.665319923129767*^9, {3.66532084581382*^9, 
   3.6653208558484077`*^9}, 3.66532141327155*^9, 3.665829906274736*^9, {
   3.665831295184313*^9, 3.6658313043666134`*^9}, {3.6665244849878807`*^9, 
   3.6665245508670397`*^9}, {3.6666127583425817`*^9, 3.666612758467588*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"formatrule", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["XX_", 
      RowBox[{"z1_", ",", "z2_"}]], "\[Rule]", 
     RowBox[{"XX", "[", 
      RowBox[{"z1", ",", "z2"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ii", "=", "1"}], ",", 
    RowBox[{"ii", "\[LessEqual]", "110"}], ",", 
    RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{"\"\<ii=\>\"", ",", "ii"}], "]"}], ";"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{"ii", ",", "10"}], "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<ii=\>\"", ",", "ii"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     SubscriptBox["bft", "ii"], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"a", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b", "=", 
      RowBox[{"b", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"c", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"d", "=", 
      RowBox[{"d", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", "b", "]"}], ",", "c"}], "]"}], "]"}], "=!=",
         "0"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "Print", "[", 
          "\"\<Doing moduli-space reduction then comparing dim(P) with dim(C)\
\>\"", "]"}], ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"reducibilityBFTedges", "[", 
             RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}], 
           "\[LessEqual]", "14"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"fullreduction", "=", 
            RowBox[{"reductionGraphBFT", "[", 
             RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "2"}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"fullreduction", "=!=", 
              RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], 
                "}"}], "=", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], "/.", 
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "\[Rule]", "0"}], "&"}], ",", 
                  RowBox[{"Last", "[", 
                   RowBox[{"reductionGraphBFT", "[", 
                    RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "2"}], 
                    "]"}], "]"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
             ",", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], 
                "}"}], "=", 
               RowBox[{"{", 
                RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}]}], ";"}]}],
             "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"dimensionPolytope", "[", 
               RowBox[{"matchingPolytope", "[", 
                RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], 
                "]"}], "]"}], "=!=", 
              RowBox[{"dimensionGrassmannian", "[", 
               RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], 
               "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<ii=\>\"", ",", "ii", ",", 
                "\"\< : There's a problem with dimensionGrassmannian! When a \
graph is reduced by looking at the moduli space, the master space should have \
the same dimension as the Grassmannian!\>\""}], "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ii", "\[NotEqual]", "104"}], "&&", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Position", "[", 
              RowBox[{
               RowBox[{"Transpose", "[", 
                RowBox[{"matroidPolytope", "[", 
                 RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}], 
               ",", 
               RowBox[{
                RowBox[{"Transpose", "[", 
                 RowBox[{"matroidPolytope", "[", 
                  RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}], 
                "[", 
                RowBox[{"[", 
                 RowBox[{"lowNumberLoopsPMpos", "[", 
                  RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}], 
                "]"}]}], "]"}], "]"}], "\[LessEqual]", "3"}]}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<Getting Grassmannian\>\"", "]"}], 
            ";"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Cmat", "=", 
            RowBox[{"pathMatrix", "[", 
             RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<Check independent entries\>\"", "]"}],
              ";"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"planar", "=", 
            RowBox[{"planarityQ", "[", 
             RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"entries", "=", 
            RowBox[{"DeleteCases", "[", 
             RowBox[{
              RowBox[{"Flatten", "[", "Cmat", "]"}], ",", 
              RowBox[{"0", "|", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"planar", "||", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Length", "[", "entries", "]"}], "\[LessEqual]", 
                "9"}], ")"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "we", " ", "are", " ", "not", " ", "on", " ", "a", " ", 
               "secret", " ", 
               RowBox[{"pole", ".", " ", "We"}], " ", "can", " ", "then", " ",
                "use", " ", "the", " ", "independent", " ", "plucker", " ", 
               "relations", " ", "to", " ", "determine", " ", "the", " ", 
               "dimension"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"Cases", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Minors", "[", 
                    RowBox[{"Cmat", ",", 
                    RowBox[{"Length", "[", "Cmat", "]"}]}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"Except", "[", "0", "]"}]}], "]"}], "]"}], "-", 
                  RowBox[{"Length", "[", 
                   RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"independentPluckerRelations", "[", 
                    RowBox[{
                    RowBox[{"Length", "[", "Cmat", "]"}], ",", 
                    RowBox[{
                    RowBox[{"Dimensions", "[", "Cmat", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "/.", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"HoldForm", "[", "minor", "]"}], "@@", "#"}], 
                    ")"}], "\[Rule]", "0"}], "&"}], ",", 
                    RowBox[{"Subsets", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"Dimensions", "[", "Cmat", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Length", "[", "Cmat", "]"}], "}"}]}], "]"}]}], 
                    "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Minors", "[", 
                    RowBox[{"Cmat", ",", 
                    RowBox[{"Length", "[", "Cmat", "]"}]}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "0", ",", "1"}], 
                    "]"}], "]"}], "]"}], "]"}]}], ",", "True"}], "]"}], "]"}],
                   "-", "1"}], "=!=", 
                 RowBox[{"dimensionGrassmannian", "[", 
                  RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                 "Print", "[", 
                  "\"\<The dimension of the Grassmannian should be equal to \
(# of Pluckers - # of indep Plucker relations - 1), when we are not on secret \
poles!\>\"", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{"(*", 
              RowBox[{
              "we", " ", "have", " ", "secret", " ", "relations", " ", 
               "among", " ", "the", " ", "pluckers"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", "entries", "]"}], "\[LessEqual]", 
                  "9"}], "&&", 
                 RowBox[{
                  RowBox[{"Length", "[", "entries", "]"}], "\[LessEqual]", 
                  RowBox[{"dimensionGrassmannian", "[", 
                   RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}]}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{
                  "\"\<ii=\>\"", ",", "ii", ",", 
                   "\"\< : There's a problem with dimensionGrassmannian! The \
dimension of the Grassmannian should be less than the number of non-trivial \
entries, when we are on secret poles!\>\""}], "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Print", "[", 
           "\"\<Checking moduli-space reducibility under gaugings 1 and \
2\>\"", "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"edges", "=", 
         RowBox[{"Variables", "[", 
          RowBox[{"joinupKasteleyn", "[", 
           RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"redgauging1", "=", 
         RowBox[{"reducibilityQ", "[", 
          RowBox[{
          "a", ",", "b", ",", "c", ",", "d", ",", "False", ",", "True", ",", 
           "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"redgauging2", "=", 
         RowBox[{"reducibilityQ", "[", 
          RowBox[{
          "a", ",", "b", ",", "c", ",", "d", ",", "False", ",", "True", ",", 
           "2"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"pmatrix", "=", 
         RowBox[{"matchingPolytope", "[", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"moduligauging1", "=", 
         RowBox[{"moduliSpaceBFT", "[", 
          RowBox[{
          "a", ",", "b", ",", "c", ",", "d", ",", "1", ",", "False", ",", 
           "True"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ii", "\[NotEqual]", "104"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{"redgauging1", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"MemberQ", "[", 
                 RowBox[{
                  RowBox[{"And", "@@", 
                   RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{"turnIntoPolytope", "[", 
                    RowBox[{"moduligauging1", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Position", "[", 
                    RowBox[{"#", ",", "0"}], "]"}], "]"}]}], "]"}], "]"}], 
                    "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "===", 
                    RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{"turnIntoPolytope", "[", "moduligauging1", "]"}], 
                    "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "&"}], ",", 
                    "pmatrix"}], "]"}]}], ",", "False"}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{
                  "\"\<ii=\>\"", ",", "ii", ",", 
                   "\"\< : There's a problem with reducibilityQ! The BFT \
graph is reducible but there are no edges I can remove without removing \
points in the moduli space!\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", 
               "]"}], ";"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"FreeQ", "[", 
                 RowBox[{
                  RowBox[{"And", "@@", 
                   RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{"turnIntoPolytope", "[", 
                    RowBox[{"moduligauging1", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Position", "[", 
                    RowBox[{"#", ",", "0"}], "]"}], "]"}]}], "]"}], "]"}], 
                    "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "===", 
                    RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{"turnIntoPolytope", "[", "moduligauging1", "]"}], 
                    "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "&"}], ",", 
                    "pmatrix"}], "]"}]}], ",", "False"}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{
                  "\"\<ii=\>\"", ",", "ii", ",", 
                   "\"\< : There's a problem with reducibilityQ! The BFT \
graph is not reducible but there are edges I can remove without removing \
points in the moduli space!\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", 
               "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"redgauging1", "=!=", "True"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<ii=\>\"", ",", "ii", ",", 
                "\"\< : There's a problem with reducibilityQ! This example \
should be reducible, though reducibilityQ does not return True\>\""}], "]"}], 
              ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ii", "\[NotEqual]", "104"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{"redgauging2", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Cases", "[", 
                  RowBox[{"edges", ",", 
                   RowBox[{"zz_", "/;", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{"turnIntoPolytope", "[", 
                    RowBox[{"moduliSpaceBFT", "[", 
                    RowBox[{
                    RowBox[{"a", "/.", 
                    RowBox[{"{", 
                    RowBox[{"zz", "\[Rule]", "0"}], "}"}]}], ",", 
                    RowBox[{"b", "/.", 
                    RowBox[{"{", 
                    RowBox[{"zz", "\[Rule]", "0"}], "}"}]}], ",", 
                    RowBox[{"c", "/.", 
                    RowBox[{"{", 
                    RowBox[{"zz", "\[Rule]", "0"}], "}"}]}], ",", "d", ",", 
                    "2"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "===", 
                    RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{"turnIntoPolytope", "[", 
                    RowBox[{"moduliSpaceBFT", "[", 
                    RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "2"}], 
                    "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}]}], "]"}], "===", 
                 RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{
                  "\"\<ii=\>\"", ",", "ii", ",", 
                   "\"\< : There's a problem with reducibilityQ! The BFT \
graph is reducible but there are no edges I can remove without removing \
points in the moduli space!\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", 
               "]"}], ";"}], ",", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Cases", "[", 
                  RowBox[{"edges", ",", 
                   RowBox[{"zz_", "/;", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{"turnIntoPolytope", "[", 
                    RowBox[{"moduliSpaceBFT", "[", 
                    RowBox[{
                    RowBox[{"a", "/.", 
                    RowBox[{"{", 
                    RowBox[{"zz", "\[Rule]", "0"}], "}"}]}], ",", 
                    RowBox[{"b", "/.", 
                    RowBox[{"{", 
                    RowBox[{"zz", "\[Rule]", "0"}], "}"}]}], ",", 
                    RowBox[{"c", "/.", 
                    RowBox[{"{", 
                    RowBox[{"zz", "\[Rule]", "0"}], "}"}]}], ",", "d", ",", 
                    "2"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "===", 
                    RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{"turnIntoPolytope", "[", 
                    RowBox[{"moduliSpaceBFT", "[", 
                    RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "2"}], 
                    "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}]}], "]"}], "=!=", 
                 RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{
                  "\"\<ii=\>\"", ",", "ii", ",", 
                   "\"\< : There's a problem with reducibilityQ! The BFT \
graph is not reducible but there are edges I can remove without removing \
points in the moduli space!\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", 
               "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"redgauging2", "=!=", "True"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<ii=\>\"", ",", "ii", ",", 
                "\"\< : There's a problem with reducibilityQ! This example \
should be reducible, though reducibilityQ does not return True\>\""}], "]"}], 
              ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ii", "\[NotEqual]", "104"}], "&&", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Position", "[", 
              RowBox[{
               RowBox[{"Transpose", "[", 
                RowBox[{"matroidPolytope", "[", 
                 RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}], 
               ",", 
               RowBox[{
                RowBox[{"Transpose", "[", 
                 RowBox[{"matroidPolytope", "[", 
                  RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}], 
                "[", 
                RowBox[{"[", 
                 RowBox[{"lowNumberLoopsPMpos", "[", 
                  RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}], 
                "]"}]}], "]"}], "]"}], "\[LessEqual]", "3"}]}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
            "Print", "[", 
             "\"\<Checking scattering amplitudes reducibility\>\"", "]"}], 
            ";"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"redscattering", "=", 
            RowBox[{"reducibilityQ", "[", 
             RowBox[{
             "a", ",", "b", ",", "c", ",", "d", ",", "False", ",", "False", 
              ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"numberofzerominors", "=", 
            RowBox[{"Length", "[", 
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Minors", "[", 
                 RowBox[{"Cmat", ",", 
                  RowBox[{"Length", "[", "Cmat", "]"}]}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "0"}], "]"}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"didyoukillpluckers", "=", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Function", "[", 
                 RowBox[{
                  RowBox[{"{", "edgeinput", "}"}], ",", 
                  RowBox[{"Block", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"smallgrass", ",", "numzerominors"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"Variables", "[", 
                    RowBox[{
                    RowBox[{"Join", "[", 
                    RowBox[{"b", ",", "c"}], "]"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"edgeinput", "\[Rule]", "0"}], "}"}]}], "]"}], 
                    "]"}], "\[GreaterEqual]", "2"}], ",", 
                    RowBox[{
                    RowBox[{"smallgrass", "=", 
                    RowBox[{"pathMatrix", "[", 
                    RowBox[{
                    RowBox[{"a", "/.", 
                    RowBox[{"{", 
                    RowBox[{"edgeinput", "\[Rule]", "0"}], "}"}]}], ",", 
                    RowBox[{"b", "/.", 
                    RowBox[{"{", 
                    RowBox[{"edgeinput", "\[Rule]", "0"}], "}"}]}], ",", 
                    RowBox[{"c", "/.", 
                    RowBox[{"{", 
                    RowBox[{"edgeinput", "\[Rule]", "0"}], "}"}]}], ",", 
                    "d"}], "]"}]}], ";", 
                    RowBox[{"numzerominors", "=", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Cases", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Minors", "[", 
                    RowBox[{"smallgrass", ",", 
                    RowBox[{"Length", "[", "smallgrass", "]"}]}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "0"}], "]"}], 
                    "]"}]}], ";"}], ",", 
                    RowBox[{
                    RowBox[{"numzerominors", "=", "0"}], ";"}]}], "]"}], ";", 
                    RowBox[{"numzerominors", ">", "numberofzerominors"}]}]}], 
                   "]"}]}], "]"}], "[", "#", "]"}], "&"}], ",", "edges"}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"planar", "\[Equal]", "False"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"originalorder3relations", "=", 
               RowBox[{"Expand", "[", 
                RowBox[{
                 RowBox[{"Map", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Times", "@@", "#"}], "&"}], ",", 
                   RowBox[{"Subsets", "[", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"HoldForm", "[", "minor", "]"}], "[", 
                    RowBox[{"Sequence", "@@", "#"}], "]"}], "&"}], ",", 
                    RowBox[{"Subsets", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"Dimensions", "[", "Cmat", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Length", "[", "Cmat", "]"}], "}"}]}], "]"}]}], 
                    "]"}], ",", 
                    RowBox[{"{", "3", "}"}]}], "]"}]}], "]"}], "/.", 
                 RowBox[{"MapThread", "[", 
                  RowBox[{"Rule", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"HoldForm", "[", "minor", "]"}], "[", 
                    RowBox[{"Sequence", "@@", "#"}], "]"}], "&"}], ",", 
                    RowBox[{"Subsets", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"Dimensions", "[", "Cmat", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Length", "[", "Cmat", "]"}], "}"}]}], "]"}]}], 
                    "]"}], ",", 
                    RowBox[{"(", 
                    RowBox[{"minorsAsPerfectMatchings", "[", 
                    RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], 
                    ")"}]}], "}"}]}], "]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"didyoukillpluckers", "[", 
                RowBox[{"[", 
                 RowBox[{"Flatten", "[", 
                  RowBox[{"Position", "[", 
                   RowBox[{"didyoukillpluckers", ",", "False"}], "]"}], "]"}],
                  "]"}], "]"}], "=", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"{", "inputedge", "}"}], ",", 
                    RowBox[{"Block", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"order3relations", ",", "outputTrueFalse"}], 
                    "}"}], ",", 
                    RowBox[{
                    RowBox[{"order3relations", "=", 
                    RowBox[{"Expand", "[", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Times", "@@", "#"}], "&"}], ",", 
                    RowBox[{"Subsets", "[", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"HoldForm", "[", "minor", "]"}], "[", 
                    RowBox[{"Sequence", "@@", "#"}], "]"}], "&"}], ",", 
                    RowBox[{"Subsets", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"Dimensions", "[", "Cmat", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Length", "[", "Cmat", "]"}], "}"}]}], "]"}]}], 
                    "]"}], ",", 
                    RowBox[{"{", "3", "}"}]}], "]"}]}], "]"}], "/.", 
                    RowBox[{"MapThread", "[", 
                    RowBox[{"Rule", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"HoldForm", "[", "minor", "]"}], "[", 
                    RowBox[{"Sequence", "@@", "#"}], "]"}], "&"}], ",", 
                    RowBox[{"Subsets", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"Dimensions", "[", "Cmat", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Length", "[", "Cmat", "]"}], "}"}]}], "]"}]}], 
                    "]"}], ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"minorsAsPerfectMatchings", "[", 
                    RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"inputedge", "\[Rule]", "0"}], "}"}]}], ")"}]}], 
                    "}"}]}], "]"}]}], "]"}]}], ";", 
                    RowBox[{"outputTrueFalse", "=", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Length", "[", "order3relations", "]"}], "-", 
                    RowBox[{"Length", "[", 
                    RowBox[{"DeleteDuplicates", "[", "order3relations", "]"}],
                     "]"}]}], ")"}], ">", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Length", "[", "originalorder3relations", "]"}], 
                    "-", 
                    RowBox[{"Length", "[", 
                    RowBox[{
                    "DeleteDuplicates", "[", "originalorder3relations", "]"}],
                     "]"}]}], ")"}]}]}], ";", "outputTrueFalse"}]}], "]"}]}], 
                    "]"}], "[", "#", "]"}], "&"}], ",", 
                 RowBox[{"edges", "[", 
                  RowBox[{"[", 
                   RowBox[{"Flatten", "[", 
                    RowBox[{"Position", "[", 
                    RowBox[{"didyoukillpluckers", ",", "False"}], "]"}], 
                    "]"}], "]"}], "]"}]}], "]"}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"didyoukillDOF", "=", "didyoukillpluckers"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{"redscattering", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"FreeQ", "[", 
                 RowBox[{"didyoukillDOF", ",", "False"}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{
                  "\"\<ii=\>\"", ",", "ii", ",", 
                   
                   "\"\< : There's a problem with reducibilityQ! The \
scattering graph is reducible, even though there are no edges which I can \
remove that keep the same number of elements in the Grassmannian \
matrix!\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"MemberQ", "[", 
                 RowBox[{"didyoukillDOF", ",", "False"}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{
                  "\"\<ii=\>\"", ",", "ii", ",", 
                   "\"\< : There's a problem with reducibilityQ! The \
scattering graph is not reducible, even though there are edges which I can \
remove that keep the same number of elements in the Grassmannian \
matrix!\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", ",", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<We have a dimer\>\"", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6665290513862414`*^9, 3.6665290516363416`*^9}, {
   3.6665299724770365`*^9, 3.6665300009116697`*^9}, {3.666530088819817*^9, 
   3.666530128316635*^9}, {3.6665302672504177`*^9, 3.6665302813892417`*^9}, 
   3.666530509483374*^9, {3.6665311832591496`*^9, 3.6665311836574163`*^9}, {
   3.666532935983368*^9, 3.666532937266738*^9}, {3.666590887530099*^9, 
   3.6665910480420675`*^9}, {3.666596246307023*^9, 3.666596247686492*^9}, {
   3.666596281871814*^9, 3.6665962982549906`*^9}, {3.666596328434821*^9, 
   3.6665963366269236`*^9}, {3.666596422926762*^9, 3.6665964241455774`*^9}, {
   3.6665965815178466`*^9, 3.666596582564776*^9}, {3.666596651807828*^9, 
   3.666596656294677*^9}, {3.66659672199334*^9, 3.666596820121982*^9}, {
   3.666596865312018*^9, 3.6665968751740265`*^9}, {3.6665981482872815`*^9, 
   3.6665982000836067`*^9}, 3.6666119841504183`*^9, {3.6666120887045393`*^9, 
   3.6666120933161173`*^9}, {3.6666121514101872`*^9, 3.6666121823580694`*^9}, 
   3.666612220076093*^9, {3.666612274900276*^9, 3.6666123117251263`*^9}, {
   3.6666123981157455`*^9, 3.666612413645131*^9}, {3.6666130173240137`*^9, 
   3.6666130189279222`*^9}, {3.666613422534994*^9, 3.666613437886575*^9}, 
   3.666614181831832*^9, {3.666614256617727*^9, 3.6666142615109653`*^9}, {
   3.6666154098308*^9, 3.666615444157339*^9}, {3.6666154880433855`*^9, 
   3.6666155004092445`*^9}, {3.666615531886362*^9, 3.6666155727227545`*^9}, {
   3.6666158966097136`*^9, 3.666615908554063*^9}, {3.666618823467035*^9, 
   3.6666188235920134`*^9}, {3.6666189235337534`*^9, 3.666618955772812*^9}, {
   3.66661901853673*^9, 3.6666190405281825`*^9}, {3.666632420106245*^9, 
   3.66663243238476*^9}, {3.6666324845601788`*^9, 3.666632542488106*^9}, {
   3.6666329600245743`*^9, 3.666633012275989*^9}, 3.667047503622698*^9, 
   3.667048814939345*^9, {3.667640261384919*^9, 3.6676402698411236`*^9}, {
   3.6678267808236313`*^9, 3.6678267825824013`*^9}, {3.667827338091591*^9, 
   3.667827402290561*^9}, 3.671543688767076*^9, {3.671545370913251*^9, 
   3.6715453713929257`*^9}, {3.671545445702312*^9, 3.671545451929431*^9}, {
   3.671545528851487*^9, 3.671545529554343*^9}, {3.6727462785353374`*^9, 
   3.672746280637918*^9}, 3.672746311095434*^9}],

Cell[BoxData["\<\"We have a dimer\"\>"], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.666529996283929*^9, 3.6665301762686467`*^9, 3.666530301096612*^9, 
   3.6665305143688154`*^9, 3.666532943937529*^9, 3.6665910557817907`*^9, 
   3.666591594045303*^9, 3.6665968782070646`*^9, 3.6665982131542377`*^9, 
   3.6666119852754683`*^9, 3.6666121759565725`*^9, {3.666612220076093*^9, 
   3.6666122222253466`*^9}, 3.6666123578059416`*^9, 3.666612414426423*^9, 
   3.6666127620011487`*^9, 3.666613021676014*^9, 3.6666134425136375`*^9, 
   3.6666141846007247`*^9, 3.66661428244468*^9, {3.6666155633616467`*^9, 
   3.6666155733009076`*^9}, 3.666615911068859*^9, 3.666619041246969*^9, {
   3.666632525494175*^9, 3.6666325449466453`*^9}, 3.6666330220823183`*^9, 
   3.667652981228255*^9, 3.6676742596334963`*^9, 3.671696670940753*^9, 
   3.6727462824561605`*^9}],

Cell[BoxData["\<\"We have a dimer\"\>"], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.666529996283929*^9, 3.6665301762686467`*^9, 3.666530301096612*^9, 
   3.6665305143688154`*^9, 3.666532943937529*^9, 3.6665910557817907`*^9, 
   3.666591594045303*^9, 3.6665968782070646`*^9, 3.6665982131542377`*^9, 
   3.6666119852754683`*^9, 3.6666121759565725`*^9, {3.666612220076093*^9, 
   3.6666122222253466`*^9}, 3.6666123578059416`*^9, 3.666612414426423*^9, 
   3.6666127620011487`*^9, 3.666613021676014*^9, 3.6666134425136375`*^9, 
   3.6666141846007247`*^9, 3.66661428244468*^9, {3.6666155633616467`*^9, 
   3.6666155733009076`*^9}, 3.666615911068859*^9, 3.666619041246969*^9, {
   3.666632525494175*^9, 3.6666325449466453`*^9}, 3.6666330220823183`*^9, 
   3.667652981228255*^9, 3.6676742596334963`*^9, 3.671696670940753*^9, 
   3.6727462990111713`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "110"}],
  SequenceForm["ii=", 110],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.666529996283929*^9, 3.6665301762686467`*^9, 3.666530301096612*^9, 
   3.6665305143688154`*^9, 3.666532943937529*^9, 3.6665910557817907`*^9, 
   3.666591594045303*^9, 3.6665968782070646`*^9, 3.6665982131542377`*^9, 
   3.6666119852754683`*^9, 3.6666121759565725`*^9, {3.666612220076093*^9, 
   3.6666122222253466`*^9}, 3.6666123578059416`*^9, 3.666612414426423*^9, 
   3.6666127620011487`*^9, 3.666613021676014*^9, 3.6666134425136375`*^9, 
   3.6666141846007247`*^9, 3.66661428244468*^9, {3.6666155633616467`*^9, 
   3.6666155733009076`*^9}, 3.666615911068859*^9, 3.666619041246969*^9, {
   3.666632525494175*^9, 3.6666325449466453`*^9}, 3.6666330220823183`*^9, 
   3.667652981228255*^9, 3.6676742596334963`*^9, 3.671696670940753*^9, 
   3.6727462990111713`*^9}]
}, Closed]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.665318117879394*^9, 3.665318118113784*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Here", " ", "we", " ", "check", " ", "reducibilityEdges"}], ",", 
   " ", "reductionGraph"}], "*)"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6666205791339865`*^9, 3.6666205896719713`*^9}, {
  3.666620737314131*^9, 3.66662075703893*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"formatrule", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["XX_", 
      RowBox[{"z1_", ",", "z2_"}]], "\[Rule]", 
     RowBox[{"XX", "[", 
      RowBox[{"z1", ",", "z2"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ii", "=", "1"}], ",", 
    RowBox[{"ii", "\[LessEqual]", "110"}], ",", 
    RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{"ii", ",", "10"}], "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<ii=\>\"", ",", "ii"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     SubscriptBox["bft", "ii"], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"a", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b", "=", 
      RowBox[{"b", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"c", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"d", "=", 
      RowBox[{"d", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", "b", "]"}], ",", "c"}], "]"}], "]"}], "=!=",
         "0"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ii", "\[Equal]", "104"}], "||", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Position", "[", 
              RowBox[{
               RowBox[{"Transpose", "[", 
                RowBox[{"matroidPolytope", "[", 
                 RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}], 
               ",", 
               RowBox[{
                RowBox[{"Transpose", "[", 
                 RowBox[{"matroidPolytope", "[", 
                  RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}], 
                "[", 
                RowBox[{"[", 
                 RowBox[{"lowNumberLoopsPMpos", "[", 
                  RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}], 
                "]"}]}], "]"}], "]"}], "\[LessEqual]", "3"}]}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"reducibilitygauging1", "=", 
            RowBox[{"reducibilityQ", "[", 
             RowBox[{
             "a", ",", "b", ",", "c", ",", "d", ",", "False", ",", "True", 
              ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"reducibilitygauging2", "=", 
            RowBox[{"reducibilityQ", "[", 
             RowBox[{
             "a", ",", "b", ",", "c", ",", "d", ",", "False", ",", "True", 
              ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"reducibilityscattering", "=", 
            RowBox[{"reducibilityQ", "[", 
             RowBox[{
             "a", ",", "b", ",", "c", ",", "d", ",", "False", ",", "False", 
              ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"rededgesgauging1", "=", 
            RowBox[{"reducibilityEdges", "[", 
             RowBox[{
             "a", ",", "b", ",", "c", ",", "d", ",", "False", ",", "True", 
              ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"rededgesgauging2", "=", 
            RowBox[{"reducibilityEdges", "[", 
             RowBox[{
             "a", ",", "b", ",", "c", ",", "d", ",", "False", ",", "True", 
              ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"rededgesscattering", "=", 
            RowBox[{"reducibilityEdges", "[", 
             RowBox[{
             "a", ",", "b", ",", "c", ",", "d", ",", "False", ",", "False", 
              ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"fullreductiongauging1", "=", 
            RowBox[{"reductionGraph", "[", 
             RowBox[{
             "a", ",", "b", ",", "c", ",", "d", ",", "False", ",", "True", 
              ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"fullreductiongauging2", "=", 
            RowBox[{"reductionGraph", "[", 
             RowBox[{
             "a", ",", "b", ",", "c", ",", "d", ",", "False", ",", "True", 
              ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"fullreductionscattering", "=", 
            RowBox[{"reductionGraph", "[", 
             RowBox[{
             "a", ",", "b", ",", "c", ",", "d", ",", "False", ",", "False", 
              ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{"reducibilitygauging1", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"rededgesgauging1", "\[Equal]", 
                 RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{
                  "\"\<ii=\>\"", ",", "ii", ",", 
                   "\"\< : There's a problem with reducibilityEdges under \
gauging 1! The graph is reducible and yet we may not remove any edges\>\""}], 
                  "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"rededgesgauging1", "=!=", 
                 RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{
                  "\"\<ii=\>\"", ",", "ii", ",", 
                   "\"\< : There's a problem with reducibilityEdges under \
gauging 1! The graph is not reducible and yet we may remove some edges\>\""}],
                   "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{"reducibilitygauging2", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"rededgesgauging2", "\[Equal]", 
                 RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{
                  "\"\<ii=\>\"", ",", "ii", ",", 
                   "\"\< : There's a problem with reducibilityEdges under \
gauging 2! The graph is reducible and yet we may not remove any edges\>\""}], 
                  "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"rededgesgauging2", "=!=", 
                 RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{
                  "\"\<ii=\>\"", ",", "ii", ",", 
                   "\"\< : There's a problem with reducibilityEdges under \
gauging 2! The graph is not reducible and yet we may remove some edges\>\""}],
                   "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{"reducibilityscattering", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"rededgesscattering", "\[Equal]", 
                 RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{
                  "\"\<ii=\>\"", ",", "ii", ",", 
                   "\"\< : There's a problem with reducibilityEdges for \
scattering! The graph is reducible and yet we may not remove any edges\>\""}],
                   "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"rededgesscattering", "=!=", 
                 RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{
                  "\"\<ii=\>\"", ",", "ii", ",", 
                   "\"\< : There's a problem with reducibilityEdges for \
scattering! The graph is not reducible and yet we may remove some \
edges\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"SubsetQ", "[", 
               RowBox[{"fullreductiongauging1", ",", 
                RowBox[{"DeleteDuplicates", "[", 
                 RowBox[{"Map", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"consistentEdgeRemoval", "[", 
                    RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "#"}], 
                    "]"}], "&"}], ",", 
                   RowBox[{"Transpose", "[", 
                    RowBox[{"{", "rededgesgauging1", "}"}], "]"}]}], "]"}], 
                 "]"}]}], "]"}], "=!=", "True"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<ii=\>\"", ",", "ii", ",", 
                "\"\< : There's a problem with reductionGraph under gauging \
1! It doesn't even contain the edges in reducibilityEdges\>\""}], "]"}], 
              ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"SubsetQ", "[", 
               RowBox[{"fullreductiongauging2", ",", 
                RowBox[{"DeleteDuplicates", "[", 
                 RowBox[{"Map", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"consistentEdgeRemoval", "[", 
                    RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "#"}], 
                    "]"}], "&"}], ",", 
                   RowBox[{"Transpose", "[", 
                    RowBox[{"{", "rededgesgauging2", "}"}], "]"}]}], "]"}], 
                 "]"}]}], "]"}], "=!=", "True"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<ii=\>\"", ",", "ii", ",", 
                "\"\< : There's a problem with reductionGraph under gauging \
2! It doesn't even contain the edges in reducibilityEdges\>\""}], "]"}], 
              ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"SubsetQ", "[", 
               RowBox[{"fullreductionscattering", ",", 
                RowBox[{"DeleteDuplicates", "[", 
                 RowBox[{"Map", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"consistentEdgeRemoval", "[", 
                    RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "#"}], 
                    "]"}], "&"}], ",", 
                   RowBox[{"Transpose", "[", 
                    RowBox[{"{", "rededgesscattering", "}"}], "]"}]}], "]"}], 
                 "]"}]}], "]"}], "=!=", "True"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<ii=\>\"", ",", "ii", ",", 
                "\"\< : There's a problem with reductionGraph for scattering! \
It doesn't even contain the edges in reducibilityEdges\>\""}], "]"}], ";"}]}],
             "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"fullreductiongauging1", "=!=", 
              RowBox[{"reductionGraphBFT", "[", 
               RowBox[{
               "a", ",", "b", ",", "c", ",", "d", ",", "1", ",", "False", ",",
                 "True"}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<ii=\>\"", ",", "ii", ",", 
                "\"\< : There's a problem with reductionGraph under gauging \
1! It does not correspond to reductionGraphBFT\>\""}], "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"fullreductiongauging2", "=!=", 
              RowBox[{"reductionGraphBFT", "[", 
               RowBox[{
               "a", ",", "b", ",", "c", ",", "d", ",", "2", ",", "False", ",",
                 "False"}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<ii=\>\"", ",", "ii", ",", 
                "\"\< : There's a problem with reductionGraph under gauging \
2! It does not correspond to reductionGraphBFT\>\""}], "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "fullreductionscattering", "]"}], 
              "\[LessEqual]", "100"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"DeleteDuplicates", "[", 
                   RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"dimensionGrassmannian", "[", 
                    RowBox[{
                    RowBox[{"a", "/.", "#"}], ",", 
                    RowBox[{"b", "/.", "#"}], ",", 
                    RowBox[{"c", "/.", "#"}], ",", "d"}], "]"}], "&"}], ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "\[Rule]", "0"}], "&"}], ",", 
                    "fullreductionscattering", ",", 
                    RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], "]"}], "=!=", 
                  RowBox[{"{", 
                   RowBox[{"dimensionGrassmannian", "[", 
                    RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], 
                   "}"}]}], "|", 
                 RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{
                  "\"\<ii=\>\"", ",", "ii", ",", 
                   "\"\< : There's a problem with reductionGraph for \
scattering! Not all reductions end up with a Grassmannian of the same \
dimension\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<(ii=\>\"", ",", "ii", ",", 
                "\"\< : Didn't check the dimension all the scattering \
reductions, since there are \>\"", ",", 
                RowBox[{"Length", "[", "fullreductionscattering", "]"}], ",", 
                "\"\< of them...)\>\""}], "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<We have a dimer\>\"", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66662075703893*^9, {3.6666208582557707`*^9, 3.666620897689205*^9}, 
   3.6670475050393143`*^9, {3.667049477760458*^9, 3.667049478785247*^9}, 
   3.6676416560794425`*^9, {3.6676421830013423`*^9, 3.6676421831041207`*^9}, {
   3.667828170977244*^9, 3.6678281731575575`*^9}, 3.6715455302309895`*^9, {
   3.672746348016121*^9, 3.6727463498047557`*^9}, 3.6727463970231504`*^9}],

Cell[BoxData["\<\"We have a dimer\"\>"], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66662075958747*^9, {3.66662085324349*^9, 3.6666208646123466`*^9}, 
   3.666620904663224*^9, 3.66767522778848*^9, 3.6716970055705023`*^9, 
   3.672746353877951*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"(ii=\"\>", "\[InvisibleSpace]", "108", 
   "\[InvisibleSpace]", "\<\" : Didn't check the dimension all the scattering \
reductions, since there are \"\>", "\[InvisibleSpace]", "898", 
   "\[InvisibleSpace]", "\<\" of them...)\"\>"}],
  SequenceForm[
  "(ii=", 108, 
   " : Didn't check the dimension all the scattering reductions, since there \
are ", 898, " of them...)"],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66662075958747*^9, {3.66662085324349*^9, 3.6666208646123466`*^9}, 
   3.666620904663224*^9, 3.66767522778848*^9, 3.6716970055705023`*^9, 
   3.6727463576129527`*^9}],

Cell[BoxData["\<\"We have a dimer\"\>"], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66662075958747*^9, {3.66662085324349*^9, 3.6666208646123466`*^9}, 
   3.666620904663224*^9, 3.66767522778848*^9, 3.6716970055705023`*^9, 
   3.6727463576129527`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "110"}],
  SequenceForm["ii=", 110],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66662075958747*^9, {3.66662085324349*^9, 3.6666208646123466`*^9}, 
   3.666620904663224*^9, 3.66767522778848*^9, 3.6716970055705023`*^9, 
   3.672746357628578*^9}]
}, Closed]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.666620541785821*^9, 3.666620543060554*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Here", " ", "we", " ", "check", " ", "nonPluckerPolesQ"}], 
  "*)"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6666205791339865`*^9, 3.6666205896719713`*^9}, {
   3.666620737314131*^9, 3.66662075703893*^9}, {3.6666920971612577`*^9, 
   3.6666920996951833`*^9}, 3.6666975883473616`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"formatrule", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["XX_", 
      RowBox[{"z1_", ",", "z2_"}]], "\[Rule]", 
     RowBox[{"XX", "[", 
      RowBox[{"z1", ",", "z2"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ii", "=", "1"}], ",", 
    RowBox[{"ii", "\[LessEqual]", "110"}], ",", 
    RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ii", "\[NotEqual]", "33"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "39"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "40"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "50"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "51"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "52"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<ii=\>\"", ",", "ii"}], "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Mod", "[", 
            RowBox[{"ii", ",", "10"}], "]"}], "\[Equal]", "0"}], ",", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"\"\<ii=\>\"", ",", "ii"}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        SubscriptBox["bft", "ii"], ";", "\[IndentingNewLine]", 
        RowBox[{"a", "=", 
         RowBox[{"a", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"b", "=", 
         RowBox[{"b", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"c", "=", 
         RowBox[{"c", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"d", "=", 
         RowBox[{"d", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ii", "\[NotEqual]", "104"}], "&&", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"Transpose", "[", "b", "]"}], ",", "c"}], "]"}], "]"}],
             "=!=", "0"}], "&&", 
           RowBox[{"ii", "\[NotEqual]", "106"}], "&&", 
           RowBox[{"ii", "\[NotEqual]", "107"}], "&&", 
           RowBox[{"ii", "\[NotEqual]", "110"}]}], ",", "\[IndentingNewLine]",
           "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"reducibilityQ", "[", 
              RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"thereduction", "=", 
               RowBox[{"reductionGraph", "[", 
                RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"anew", ",", "bnew", ",", "cnew", ",", "dnew"}], 
                "}"}], "=", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], "/.", 
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "\[Rule]", "0"}], "&"}], ",", 
                  RowBox[{"Last", "[", "thereduction", "]"}]}], "]"}]}]}], 
              ";"}], "\[IndentingNewLine]", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"anew", ",", "bnew", ",", "cnew", ",", "dnew"}], 
                "}"}], "=", 
               RowBox[{"{", 
                RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}]}], ";"}]}],
             "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"nonPluckerPolesQ", "[", 
              RowBox[{"anew", ",", "bnew", ",", "cnew", ",", "dnew"}], "]"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"planarityQ", "[", 
                 RowBox[{"anew", ",", "bnew", ",", "cnew", ",", "dnew"}], 
                 "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{
                  "\"\<ii=\>\"", ",", "ii", ",", 
                   "\"\< : There's a problem with nonPluckerPolesQ! It says \
there are nonstandard poles on a planar diagram\>\""}], "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"edges", "=", 
               RowBox[{"Variables", "[", 
                RowBox[{"joinupKasteleyn", "[", 
                 RowBox[{"anew", ",", "bnew", ",", "cnew", ",", "dnew"}], 
                 "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"zerominors", "=", 
               RowBox[{"Count", "[", 
                RowBox[{
                 RowBox[{"minorsAsPerfectMatchings", "[", 
                  RowBox[{"anew", ",", "bnew", ",", "cnew", ",", "dnew"}], 
                  "]"}], ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"MemberQ", "[", 
                  RowBox[{
                   RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Count", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"minorsAsPerfectMatchings", "[", 
                    RowBox[{"anew", ",", "bnew", ",", "cnew", ",", "dnew"}], 
                    "]"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"#", "\[Rule]", "0"}], "}"}]}], ",", "0"}], "]"}],
                     "\[Equal]", "zerominors"}], "&"}], ",", "edges"}], "]"}],
                    ",", "True"}], "]"}], "\[Equal]", "False"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{
                  "\"\<ii=\>\"", ",", "ii", ",", 
                   "\"\< : There's a problem with nonPluckerPolesQ! It says \
there are nonstandard poles but any edge we remove ends up killing a Plucker \
coordinate\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{
              RowBox[{"edges", "=", 
               RowBox[{"Variables", "[", 
                RowBox[{"joinupKasteleyn", "[", 
                 RowBox[{"anew", ",", "bnew", ",", "cnew", ",", "dnew"}], 
                 "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"zerominors", "=", 
               RowBox[{"Count", "[", 
                RowBox[{
                 RowBox[{"minorsAsPerfectMatchings", "[", 
                  RowBox[{"anew", ",", "bnew", ",", "cnew", ",", "dnew"}], 
                  "]"}], ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"MemberQ", "[", 
                 RowBox[{
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Count", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"minorsAsPerfectMatchings", "[", 
                    RowBox[{"anew", ",", "bnew", ",", "cnew", ",", "dnew"}], 
                    "]"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"#", "\[Rule]", "0"}], "}"}]}], ",", "0"}], "]"}],
                     "\[Equal]", "zerominors"}], "&"}], ",", "edges"}], "]"}],
                   ",", "True"}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{
                  "\"\<ii=\>\"", ",", "ii", ",", 
                   "\"\< : There's a problem with nonPluckerPolesQ! It says \
there are no nonstandard poles, but there are edges which when removed don't \
kill any Pluckers\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
              ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66662075703893*^9, {3.6666208582557707`*^9, 3.666620897689205*^9}, {
   3.6666920533092704`*^9, 3.666692078122525*^9}, {3.666692114525406*^9, 
   3.6666921304430313`*^9}, {3.6666921831079865`*^9, 3.666692348479227*^9}, {
   3.6666924978218117`*^9, 3.6666925353524475`*^9}, {3.6666975821627035`*^9, 
   3.6666975932658253`*^9}, {3.666699243648012*^9, 3.6666992468380365`*^9}, {
   3.6666994231253595`*^9, 3.666699442762484*^9}, {3.6667007790291295`*^9, 
   3.6667008114350595`*^9}, 3.667047506398746*^9, {3.667642124967566*^9, 
   3.6676421318618937`*^9}, {3.667642193775833*^9, 3.6676421938761015`*^9}, {
   3.6727464084522915`*^9, 3.6727464261553774`*^9}, {3.6727499095025187`*^9, 
   3.67274995364657*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "10"}],
  SequenceForm["ii=", 10],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66662075958747*^9, {3.66662085324349*^9, 3.6666208646123466`*^9}, 
   3.666620904663224*^9, 3.6666921021106834`*^9, 3.6666921327646804`*^9, 
   3.666692237544532*^9, {3.666692276244027*^9, 3.6666922857498455`*^9}, 
   3.666692350394322*^9, {3.6666925217266893`*^9, 3.6666925376742315`*^9}, 
   3.666697604891224*^9, 3.6666992471661744`*^9, {3.6666994254780664`*^9, 
   3.666699443309391*^9}, {3.666700784915292*^9, 3.666700811841332*^9}, 
   3.6676756783150635`*^9, 3.6727464220152407`*^9, {3.6727499383068132`*^9, 
   3.67274995715357*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "20"}],
  SequenceForm["ii=", 20],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66662075958747*^9, {3.66662085324349*^9, 3.6666208646123466`*^9}, 
   3.666620904663224*^9, 3.6666921021106834`*^9, 3.6666921327646804`*^9, 
   3.666692237544532*^9, {3.666692276244027*^9, 3.6666922857498455`*^9}, 
   3.666692350394322*^9, {3.6666925217266893`*^9, 3.6666925376742315`*^9}, 
   3.666697604891224*^9, 3.6666992471661744`*^9, {3.6666994254780664`*^9, 
   3.666699443309391*^9}, {3.666700784915292*^9, 3.666700811841332*^9}, 
   3.6676756783150635`*^9, 3.6727464220152407`*^9, {3.6727499383068132`*^9, 
   3.6727499572986*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "30"}],
  SequenceForm["ii=", 30],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66662075958747*^9, {3.66662085324349*^9, 3.6666208646123466`*^9}, 
   3.666620904663224*^9, 3.6666921021106834`*^9, 3.6666921327646804`*^9, 
   3.666692237544532*^9, {3.666692276244027*^9, 3.6666922857498455`*^9}, 
   3.666692350394322*^9, {3.6666925217266893`*^9, 3.6666925376742315`*^9}, 
   3.666697604891224*^9, 3.6666992471661744`*^9, {3.6666994254780664`*^9, 
   3.666699443309391*^9}, {3.666700784915292*^9, 3.666700811841332*^9}, 
   3.6676756783150635`*^9, 3.6727464220152407`*^9, {3.6727499383068132`*^9, 
   3.672749966992206*^9}}]
}, Closed]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.666620541785821*^9, 3.666620543060554*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Here", " ", "we", " ", "check", " ", 
   RowBox[{"removableEdges", "."}]}], "*)"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6666205791339865`*^9, 3.6666205896719713`*^9}, {
   3.666620737314131*^9, 3.66662075703893*^9}, {3.6666920971612577`*^9, 
   3.6666920996951833`*^9}, 3.6666975883473616`*^9, 3.6666978762548094`*^9, {
   3.666864886025631*^9, 3.6668649209609833`*^9}, {3.6668793906987658`*^9, 
   3.666879416059349*^9}, {3.6668804960007524`*^9, 3.666880532802664*^9}, {
   3.6676537664044547`*^9, 3.6676537675521917`*^9}, {3.667828334143371*^9, 
   3.667828334299629*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"formatrule", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["XX_", 
      RowBox[{"z1_", ",", "z2_"}]], "\[Rule]", 
     RowBox[{"XX", "[", 
      RowBox[{"z1", ",", "z2"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ii", "=", "1"}], ",", 
    RowBox[{"ii", "\[LessEqual]", "110"}], ",", 
    RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ii", "\[NotEqual]", "33"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "39"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "40"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "50"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "51"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "52"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "106"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "107"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "110"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<ii=\>\"", ",", "ii"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{"ii", ",", "10"}], "]"}], "\[Equal]", "0"}], ",", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{"\"\<ii=\>\"", ",", "ii"}], "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
        SubscriptBox["bft", "ii"], ";", "\[IndentingNewLine]", 
        RowBox[{"a", "=", 
         RowBox[{"a", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"b", "=", 
         RowBox[{"b", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"c", "=", 
         RowBox[{"c", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"d", "=", 
         RowBox[{"d", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ii", "\[NotEqual]", "104"}], "&&", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"Transpose", "[", "b", "]"}], ",", "c"}], "]"}], "]"}],
             "=!=", "0"}]}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"reducibilityQ", "[", 
              RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"thereduction", "=", 
               RowBox[{"reductionGraph", "[", 
                RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"anew", ",", "bnew", ",", "cnew", ",", "dnew"}], 
                "}"}], "=", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], "/.", 
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "\[Rule]", "0"}], "&"}], ",", 
                  RowBox[{"Last", "[", "thereduction", "]"}]}], "]"}]}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"hadtoreduce", "=", "True"}], ";"}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"anew", ",", "bnew", ",", "cnew", ",", "dnew"}], 
                "}"}], "=", 
               RowBox[{"{", 
                RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"hadtoreduce", "=", "False"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"removablesscattering", "=", 
            RowBox[{"removableEdges", "[", 
             RowBox[{
             "anew", ",", "bnew", ",", "cnew", ",", "dnew", ",", "False", ",",
               "False", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"hadtoreduce", "\[Equal]", "False"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"removablesgauging1", "=", 
               RowBox[{"removableEdges", "[", 
                RowBox[{
                "anew", ",", "bnew", ",", "cnew", ",", "dnew", ",", "False", 
                 ",", "True", ",", "1"}], "]"}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"removablesgauging2", "=", 
            RowBox[{"removableEdges", "[", 
             RowBox[{
             "anew", ",", "bnew", ",", "cnew", ",", "dnew", ",", "False", ",",
               "True", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"numsources", "=", 
            RowBox[{"Length", "[", 
             RowBox[{"getSourceNodes", "[", 
              RowBox[{"anew", ",", "bnew", ",", "cnew", ",", "dnew", ",", 
               RowBox[{
                RowBox[{"perfectMatchings", "[", 
                 RowBox[{"anew", ",", "bnew", ",", "cnew", ",", "dnew"}], 
                 "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"numexternalnodes", "=", 
            RowBox[{
             RowBox[{"Length", "[", "cnew", "]"}], "+", 
             RowBox[{"Length", "[", 
              RowBox[{"Transpose", "[", "bnew", "]"}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"maxpossibledimension", "=", 
            RowBox[{"numsources", 
             RowBox[{"(", 
              RowBox[{"numexternalnodes", "-", "numsources"}], ")"}]}]}], ";",
            "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"planarityQ", "[", 
               RowBox[{"anew", ",", "bnew", ",", "cnew", ",", "dnew"}], "]"}],
               "&&", 
              RowBox[{
               RowBox[{"dimensionPolytope", "[", 
                RowBox[{"matchingPolytope", "[", 
                 RowBox[{"anew", ",", "bnew", ",", "cnew", ",", "dnew"}], 
                 "]"}], "]"}], "\[Equal]", "maxpossibledimension"}], "&&", 
              RowBox[{"maxpossibledimension", "\[NotEqual]", "0"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "removablesscattering", "]"}], "=!=", 
                 RowBox[{
                  RowBox[{"Length", "[", "cnew", "]"}], "+", 
                  RowBox[{"Length", "[", 
                   RowBox[{"Transpose", "[", "bnew", "]"}], "]"}]}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{
                  "\"\<ii=\>\"", ",", "ii", ",", 
                   "\"\< : There's a problem with removableEdges! For a \
planar diagram there should be as many edges as external nodes\>\""}], "]"}], 
                 ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"edges", "=", 
            RowBox[{"Variables", "[", 
             RowBox[{"joinupKasteleyn", "[", 
              RowBox[{"anew", ",", "bnew", ",", "cnew", ",", "dnew"}], "]"}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"currentdim", "=", 
            RowBox[{"dimensionPolytope", "[", 
             RowBox[{"matchingPolytope", "[", 
              RowBox[{"anew", ",", "bnew", ",", "cnew", ",", "dnew"}], "]"}], 
             "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Sort", "[", 
               RowBox[{
                RowBox[{"Cases", "[", 
                 RowBox[{
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", "\[Rule]", "0"}], "&"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"DeleteDuplicates", "[", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"consistentEdgeRemoval", "[", 
                    RowBox[{
                    "anew", ",", "bnew", ",", "cnew", ",", "dnew", ",", 
                    RowBox[{"{", "#", "}"}], ",", "False", ",", "True"}], 
                    "]"}], "&"}], ",", "edges"}], "]"}], "]"}], ",", 
                    "edges"}], "]"}], ",", 
                    RowBox[{"{", "2", "}"}]}], "]"}], ",", 
                  RowBox[{"zz_", "/;", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"reducibilityBFTQ", "[", 
                    RowBox[{
                    RowBox[{"anew", "/.", "zz"}], ",", 
                    RowBox[{"bnew", "/.", "zz"}], ",", 
                    RowBox[{"cnew", "/.", "zz"}], ",", "dnew"}], "]"}], 
                    "\[Equal]", "False"}], "&&", 
                    RowBox[{
                    RowBox[{"dimensionPolytope", "[", 
                    RowBox[{"matchingPolytope", "[", 
                    RowBox[{
                    RowBox[{"anew", "/.", "zz"}], ",", 
                    RowBox[{"bnew", "/.", "zz"}], ",", 
                    RowBox[{"cnew", "/.", "zz"}], ",", "dnew"}], "]"}], "]"}],
                     "\[Equal]", 
                    RowBox[{"currentdim", "-", "1"}]}]}]}]}], "]"}], "/.", 
                RowBox[{"Rule", "\[Rule]", "Plus"}]}], "]"}], "=!=", 
              RowBox[{"Sort", "[", "removablesgauging2", "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<ii=\>\"", ",", "ii", ",", 
                "\"\< : There's a problem with removableEdges under gauging \
2! For a BFT it should be possible to simply use reducibilityBFTQ\>\""}], 
               "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"dimscattering", "=", 
            RowBox[{"dimensionGrassmannian", "[", 
             RowBox[{"anew", ",", "bnew", ",", "cnew", ",", "dnew"}], "]"}]}],
            ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Sort", "[", 
               RowBox[{
                RowBox[{"Cases", "[", 
                 RowBox[{
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", "\[Rule]", "0"}], "&"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"DeleteDuplicates", "[", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"consistentEdgeRemoval", "[", 
                    RowBox[{
                    "anew", ",", "bnew", ",", "cnew", ",", "dnew", ",", 
                    RowBox[{"{", "#", "}"}], ",", "False", ",", "True"}], 
                    "]"}], "&"}], ",", "edges"}], "]"}], "]"}], ",", 
                    "edges"}], "]"}], ",", 
                    RowBox[{"{", "2", "}"}]}], "]"}], ",", 
                  RowBox[{"zz_", "/;", 
                   RowBox[{
                    RowBox[{"dimensionGrassmannian", "[", 
                    RowBox[{
                    RowBox[{"anew", "/.", "zz"}], ",", 
                    RowBox[{"bnew", "/.", "zz"}], ",", 
                    RowBox[{"cnew", "/.", "zz"}], ",", "dnew"}], "]"}], "===", 
                    RowBox[{"dimscattering", "-", "1"}]}]}]}], "]"}], "/.", 
                RowBox[{"Rule", "\[Rule]", "Plus"}]}], "]"}], "=!=", 
              RowBox[{"Sort", "[", "removablesscattering", "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<ii=\>\"", ",", "ii", ",", 
                "\"\< : There's a problem with removableEdges for scattering! \
The edges don't correspond to those edges which, when removed, reduce the \
dimension of the Grassmannian by one!\>\""}], "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66662075703893*^9, {3.6666208582557707`*^9, 3.666620897689205*^9}, {
   3.6666920533092704`*^9, 3.666692078122525*^9}, {3.666692114525406*^9, 
   3.6666921304430313`*^9}, {3.6666921831079865`*^9, 3.666692348479227*^9}, {
   3.6666924978218117`*^9, 3.6666925353524475`*^9}, {3.6666975821627035`*^9, 
   3.6666975932658253`*^9}, 3.666697871017874*^9, 3.6667024244115257`*^9, {
   3.6667030287722664`*^9, 3.666703056943325*^9}, 3.6667031442369413`*^9, {
   3.666703774576811*^9, 3.666703892928037*^9}, {3.666704399609929*^9, 
   3.6667044193676043`*^9}, {3.666705010708971*^9, 3.666705119307267*^9}, {
   3.666861934997572*^9, 3.6668619733012595`*^9}, {3.666862005622819*^9, 
   3.6668621465921803`*^9}, 3.666862710300701*^9, 3.6668627517386365`*^9, {
   3.6668628140126047`*^9, 3.666862814043851*^9}, {3.666866194234109*^9, 
   3.666866199329012*^9}, 3.6668663560356865`*^9, {3.6668666175836654`*^9, 
   3.666866623079791*^9}, {3.666877718624195*^9, 3.666877720085561*^9}, {
   3.666879834490289*^9, 3.666879841854731*^9}, 3.667047507533617*^9, {
   3.6676434655032377`*^9, 3.6676435066699653`*^9}, 3.667653348349451*^9, {
   3.667654721529787*^9, 3.667654768856902*^9}, 3.667654909942992*^9, {
   3.671543689707492*^9, 3.671543691848425*^9}, {3.671545372113166*^9, 
   3.6715453734131565`*^9}, 3.671687116543148*^9, {3.6727464319652743`*^9, 
   3.672746481446023*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "105"}],
  SequenceForm["ii=", 105],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66662075958747*^9, {3.66662085324349*^9, 3.6666208646123466`*^9}, 
   3.666620904663224*^9, 3.6666921021106834`*^9, 3.6666921327646804`*^9, 
   3.666692237544532*^9, {3.666692276244027*^9, 3.6666922857498455`*^9}, 
   3.666692350394322*^9, {3.6666925217266893`*^9, 3.6666925376742315`*^9}, 
   3.666697604891224*^9, 3.6667022468492184`*^9, 3.666702425545759*^9, {
   3.666703043474188*^9, 3.666703057380848*^9}, 3.666703145605444*^9, 
   3.666703834120264*^9, {3.666703874393976*^9, 3.6667038936088514`*^9}, 
   3.666704426252884*^9, {3.6668619737231445`*^9, 3.6668619956578846`*^9}, 
   3.666862712150075*^9, 3.6668627537479153`*^9, {3.666862785340173*^9, 
   3.666862814918895*^9}, 3.6668646336064777`*^9, 3.666864878141569*^9, 
   3.6668663588264627`*^9, 3.6668666238923244`*^9, 3.6668777101670923`*^9, {
   3.6668777719848948`*^9, 3.6668777875714664`*^9}, 3.666879203673935*^9, 
   3.666879843692078*^9, 3.6676537573722153`*^9, 3.667654734133375*^9, 
   3.6676547816712847`*^9, 3.667654912535324*^9, 3.667675880824212*^9, 
   3.672746436788821*^9, 3.6727464771544275`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "108"}],
  SequenceForm["ii=", 108],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66662075958747*^9, {3.66662085324349*^9, 3.6666208646123466`*^9}, 
   3.666620904663224*^9, 3.6666921021106834`*^9, 3.6666921327646804`*^9, 
   3.666692237544532*^9, {3.666692276244027*^9, 3.6666922857498455`*^9}, 
   3.666692350394322*^9, {3.6666925217266893`*^9, 3.6666925376742315`*^9}, 
   3.666697604891224*^9, 3.6667022468492184`*^9, 3.666702425545759*^9, {
   3.666703043474188*^9, 3.666703057380848*^9}, 3.666703145605444*^9, 
   3.666703834120264*^9, {3.666703874393976*^9, 3.6667038936088514`*^9}, 
   3.666704426252884*^9, {3.6668619737231445`*^9, 3.6668619956578846`*^9}, 
   3.666862712150075*^9, 3.6668627537479153`*^9, {3.666862785340173*^9, 
   3.666862814918895*^9}, 3.6668646336064777`*^9, 3.666864878141569*^9, 
   3.6668663588264627`*^9, 3.6668666238923244`*^9, 3.6668777101670923`*^9, {
   3.6668777719848948`*^9, 3.6668777875714664`*^9}, 3.666879203673935*^9, 
   3.666879843692078*^9, 3.6676537573722153`*^9, 3.667654734133375*^9, 
   3.6676547816712847`*^9, 3.667654912535324*^9, 3.667675880824212*^9, 
   3.672746436788821*^9, 3.6727464771544275`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "109"}],
  SequenceForm["ii=", 109],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66662075958747*^9, {3.66662085324349*^9, 3.6666208646123466`*^9}, 
   3.666620904663224*^9, 3.6666921021106834`*^9, 3.6666921327646804`*^9, 
   3.666692237544532*^9, {3.666692276244027*^9, 3.6666922857498455`*^9}, 
   3.666692350394322*^9, {3.6666925217266893`*^9, 3.6666925376742315`*^9}, 
   3.666697604891224*^9, 3.6667022468492184`*^9, 3.666702425545759*^9, {
   3.666703043474188*^9, 3.666703057380848*^9}, 3.666703145605444*^9, 
   3.666703834120264*^9, {3.666703874393976*^9, 3.6667038936088514`*^9}, 
   3.666704426252884*^9, {3.6668619737231445`*^9, 3.6668619956578846`*^9}, 
   3.666862712150075*^9, 3.6668627537479153`*^9, {3.666862785340173*^9, 
   3.666862814918895*^9}, 3.6668646336064777`*^9, 3.666864878141569*^9, 
   3.6668663588264627`*^9, 3.6668666238923244`*^9, 3.6668777101670923`*^9, {
   3.6668777719848948`*^9, 3.6668777875714664`*^9}, 3.666879203673935*^9, 
   3.666879843692078*^9, 3.6676537573722153`*^9, 3.667654734133375*^9, 
   3.6676547816712847`*^9, 3.667654912535324*^9, 3.667675880824212*^9, 
   3.672746436788821*^9, 3.6727464783268695`*^9}]
}, Closed]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6669351868194647`*^9, 3.6669351870069733`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Here", " ", "we", " ", "check", " ", "matroidQ", " ", "and", " ", 
   "implicitely", " ", "matroidViolationCheck"}], "*)"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6666205791339865`*^9, 3.6666205896719713`*^9}, {
   3.666620737314131*^9, 3.66662075703893*^9}, {3.6666920971612577`*^9, 
   3.6666920996951833`*^9}, 3.6666975883473616`*^9, 3.6668834787232137`*^9, {
   3.6668835563363457`*^9, 3.666883558828355*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"nn", "=", "2"}], ",", 
    RowBox[{"nn", "\[LessEqual]", "5"}], ",", 
    RowBox[{"nn", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<nn=\>\"", ",", "nn"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"kk", "=", "1"}], ",", 
       RowBox[{"kk", "\[LessEqual]", 
        RowBox[{"nn", "-", "1"}]}], ",", 
       RowBox[{"kk", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<    kk=\>\"", ",", "kk"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"thematroid", "=", 
         RowBox[{"Subsets", "[", 
          RowBox[{
           RowBox[{"Range", "[", "nn", "]"}], ",", 
           RowBox[{"{", "kk", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"matroidQ", "[", 
            RowBox[{"thematroid", ",", "True"}], "]"}], "=!=", "True"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", "\"\<PROBLEM\>\"", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"pluckrels", "=", 
         RowBox[{"pluckerRelations", "[", 
          RowBox[{"kk", ",", "nn"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"todeleteminors", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"HoldForm", "[", "minor", "]"}], "@@", "#"}], "\[Rule]",
              "0"}], "&"}], ",", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{
             RowBox[{"Subsets", "[", "thematroid", "]"}], ",", 
             RowBox[{"{", "}"}]}], "]"}], ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"oks", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"ParallelMap", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Function", "[", 
                 RowBox[{
                  RowBox[{"{", "inputequations", "}"}], ",", 
                  RowBox[{"Block", "[", 
                   RowBox[{
                    RowBox[{"{", "compatible", "}"}], ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"inputequations", "===", "True"}], ",", 
                    RowBox[{
                    RowBox[{"compatible", "=", "True"}], ";"}], ",", 
                    RowBox[{
                    RowBox[{"compatible", "=", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"Solve", "[", "inputequations", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"___", ",", 
                    RowBox[{"zz_", "\[Rule]", "0"}], ",", "___"}], "}"}]}], 
                    "]"}], "]"}], ">", "0"}], ")"}]}], ";"}]}], "]"}], ";", 
                    "compatible"}]}], "]"}]}], "]"}], "[", "#", "]"}], "&"}], 
              ",", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"And", "@@", "pluckrels"}], "/.", "#"}], "&"}], ",",
                 "todeleteminors"}], "]"}]}], "]"}], ",", "True"}], "]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"notoks", "=", 
         RowBox[{"Complement", "[", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{"Length", "[", "todeleteminors", "]"}], "]"}], ",", 
           "oks"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"And", "@@", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"matroidQ", "[", 
                 RowBox[{
                  RowBox[{"Complement", "[", 
                   RowBox[{"thematroid", ",", "#"}], "]"}], ",", "True"}], 
                 "]"}], "&"}], ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"todeleteminors", "[", 
                   RowBox[{"[", "oks", "]"}], "]"}], "/.", 
                  RowBox[{"Rule", "\[Rule]", "Plus"}]}], ")"}], "/.", 
                RowBox[{
                 RowBox[{"HoldForm", "[", "minor", "]"}], "\[Rule]", 
                 "List"}]}]}], "]"}]}], ")"}], "=!=", "True"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<kk=\>\"", ",", "kk", ",", "\"\< and nn=\>\"", ",", "nn", 
             ",", "\"\< : matroidQ says that some of the examples that should \
be matroids are in fact not matroids\>\""}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Or", "@@", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"matroidQ", "[", 
                 RowBox[{
                  RowBox[{"Complement", "[", 
                   RowBox[{"thematroid", ",", "#"}], "]"}], ",", "True"}], 
                 "]"}], "&"}], ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"todeleteminors", "[", 
                   RowBox[{"[", "notoks", "]"}], "]"}], "/.", 
                  RowBox[{"Rule", "\[Rule]", "Plus"}]}], ")"}], "/.", 
                RowBox[{
                 RowBox[{"HoldForm", "[", "minor", "]"}], "\[Rule]", 
                 "List"}]}]}], "]"}]}], ")"}], "=!=", "False"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<kk=\>\"", ",", "kk", ",", "\"\< and nn=\>\"", ",", "nn", 
             ",", "\"\< : matroidQ says that some of the examples that should \
not be matroids are in fact matroids\>\""}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.6668649655729575`*^9, {3.6668650586219583`*^9, 3.6668652517447762`*^9}, {
   3.666865294141585*^9, 3.6668653655985365`*^9}, {3.66688298949339*^9, 
   3.6668831773089314`*^9}, {3.666883340074496*^9, 3.666883423637555*^9}, {
   3.6668836339292855`*^9, 3.6668836598087487`*^9}, {3.6668838920611844`*^9, 
   3.666883893147648*^9}, 3.666885700284238*^9, 3.6669396850056543`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"nn=\"\>", "\[InvisibleSpace]", "2"}],
  SequenceForm["nn=", 2],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.6668834951269436`*^9, 3.666883897498828*^9, 
  3.666885700284238*^9, 3.6669366696982436`*^9, 3.6669396873587885`*^9, 
  3.6669493568992586`*^9, 3.6676763966323195`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    kk=\"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["    kk=", 1],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.6668834951269436`*^9, 3.666883897498828*^9, 
  3.666885700284238*^9, 3.6669366696982436`*^9, 3.6669396873587885`*^9, 
  3.6669493568992586`*^9, 3.6676763966323195`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"nn=\"\>", "\[InvisibleSpace]", "3"}],
  SequenceForm["nn=", 3],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.6668834951269436`*^9, 3.666883897498828*^9, 
  3.666885700284238*^9, 3.6669366696982436`*^9, 3.6669396873587885`*^9, 
  3.6669493568992586`*^9, 3.667676396679199*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    kk=\"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["    kk=", 1],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.6668834951269436`*^9, 3.666883897498828*^9, 
  3.666885700284238*^9, 3.6669366696982436`*^9, 3.6669396873587885`*^9, 
  3.6669493568992586`*^9, 3.667676396679199*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    kk=\"\>", "\[InvisibleSpace]", "2"}],
  SequenceForm["    kk=", 2],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.6668834951269436`*^9, 3.666883897498828*^9, 
  3.666885700284238*^9, 3.6669366696982436`*^9, 3.6669396873587885`*^9, 
  3.6669493568992586`*^9, 3.6676763966948214`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"nn=\"\>", "\[InvisibleSpace]", "4"}],
  SequenceForm["nn=", 4],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.6668834951269436`*^9, 3.666883897498828*^9, 
  3.666885700284238*^9, 3.6669366696982436`*^9, 3.6669396873587885`*^9, 
  3.6669493568992586`*^9, 3.6676763967104473`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    kk=\"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["    kk=", 1],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.6668834951269436`*^9, 3.666883897498828*^9, 
  3.666885700284238*^9, 3.6669366696982436`*^9, 3.6669396873587885`*^9, 
  3.6669493568992586`*^9, 3.6676763967104473`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    kk=\"\>", "\[InvisibleSpace]", "2"}],
  SequenceForm["    kk=", 2],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.6668834951269436`*^9, 3.666883897498828*^9, 
  3.666885700284238*^9, 3.6669366696982436`*^9, 3.6669396873587885`*^9, 
  3.6669493568992586`*^9, 3.6676763967260723`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    kk=\"\>", "\[InvisibleSpace]", "3"}],
  SequenceForm["    kk=", 3],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.6668834951269436`*^9, 3.666883897498828*^9, 
  3.666885700284238*^9, 3.6669366696982436`*^9, 3.6669396873587885`*^9, 
  3.6669493568992586`*^9, 3.667676397047619*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"nn=\"\>", "\[InvisibleSpace]", "5"}],
  SequenceForm["nn=", 5],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.6668834951269436`*^9, 3.666883897498828*^9, 
  3.666885700284238*^9, 3.6669366696982436`*^9, 3.6669396873587885`*^9, 
  3.6669493568992586`*^9, 3.6676763970944967`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    kk=\"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["    kk=", 1],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.6668834951269436`*^9, 3.666883897498828*^9, 
  3.666885700284238*^9, 3.6669366696982436`*^9, 3.6669396873587885`*^9, 
  3.6669493568992586`*^9, 3.6676763970944967`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    kk=\"\>", "\[InvisibleSpace]", "2"}],
  SequenceForm["    kk=", 2],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.6668834951269436`*^9, 3.666883897498828*^9, 
  3.666885700284238*^9, 3.6669366696982436`*^9, 3.6669396873587885`*^9, 
  3.6669493568992586`*^9, 3.66767639712575*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    kk=\"\>", "\[InvisibleSpace]", "3"}],
  SequenceForm["    kk=", 3],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.6668834951269436`*^9, 3.666883897498828*^9, 
  3.666885700284238*^9, 3.6669366696982436`*^9, 3.6669396873587885`*^9, 
  3.6669493568992586`*^9, 3.667676410477889*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    kk=\"\>", "\[InvisibleSpace]", "4"}],
  SequenceForm["    kk=", 4],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.6668834951269436`*^9, 3.666883897498828*^9, 
  3.666885700284238*^9, 3.6669366696982436`*^9, 3.6669396873587885`*^9, 
  3.6669493568992586`*^9, 3.667676426410344*^9}]
}, Closed]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.666883462582383*^9, 3.666883463029821*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Here", " ", "we", " ", "check", " ", "pluckerRelations"}], ",", 
   " ", "independentPluckerRelations"}], "*)"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6666205791339865`*^9, 3.6666205896719713`*^9}, {
   3.666620737314131*^9, 3.66662075703893*^9}, {3.6666920971612577`*^9, 
   3.6666920996951833`*^9}, 3.6666975883473616`*^9, 3.6668834787232137`*^9, {
   3.6668835563363457`*^9, 3.666883558828355*^9}, {3.6669393459325657`*^9, 
   3.666939356086322*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"nn", "=", "2"}], ",", 
    RowBox[{"nn", "\[LessEqual]", "7"}], ",", 
    RowBox[{"nn", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<nn=\>\"", ",", "nn"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"kk", "=", "1"}], ",", 
       RowBox[{"kk", "\[LessEqual]", 
        RowBox[{"nn", "-", "1"}]}], ",", 
       RowBox[{"kk", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<    kk=\>\"", ",", "kk"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"thematroid", "=", 
         RowBox[{"Subsets", "[", 
          RowBox[{
           RowBox[{"Range", "[", "nn", "]"}], ",", 
           RowBox[{"{", "kk", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"pluckrels", "=", 
         RowBox[{"pluckerRelations", "[", 
          RowBox[{"kk", ",", "nn"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"indeppluckrels", "=", 
         RowBox[{"independentPluckerRelations", "[", 
          RowBox[{"kk", ",", "nn"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"indeppluckrels", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], "=!=", 
           RowBox[{
            RowBox[{"Binomial", "[", 
             RowBox[{"nn", ",", "kk"}], "]"}], "-", 
            RowBox[{"kk", 
             RowBox[{"(", 
              RowBox[{"nn", "-", "kk"}], ")"}]}], "-", "1"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<kk=\>\"", ",", "kk", ",", "\"\< and nn=\>\"", ",", "nn", 
             ",", 
             "\"\< : There is the wrong number of independent Plucker \
relations!\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"And", "@@", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Head", "[", "#", "]"}], "===", 
                 RowBox[{"HoldForm", "[", "minor", "]"}]}], "&"}], ",", 
               RowBox[{"Variables", "[", 
                RowBox[{"pluckrels", "/.", 
                 RowBox[{"Equal", "\[Rule]", "List"}]}], "]"}]}], "]"}]}], 
            ")"}], "=!=", "True"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<kk=\>\"", ",", "kk", ",", "\"\< and nn=\>\"", ",", "nn", 
             ",", "\"\< : Some variables do not seem to be of the type \
HoldForm[minor]\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"And", "@@", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", 
                  RowBox[{"DeleteDuplicates", "[", 
                   RowBox[{"List", "@@", "#"}], "]"}], "]"}], "===", "kk"}], 
                "&"}], ",", 
               RowBox[{"Variables", "[", 
                RowBox[{"pluckrels", "/.", 
                 RowBox[{"Equal", "\[Rule]", "List"}]}], "]"}]}], "]"}]}], 
            ")"}], "=!=", "True"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<kk=\>\"", ",", "kk", ",", "\"\< and nn=\>\"", ",", "nn", 
             ",", 
             "\"\< : Some minors do not have kk independent indices!\>\""}], 
            "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"And", "@@", 
             RowBox[{"Simplify", "[", 
              RowBox[{
               RowBox[{"indeppluckrels", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "/.", 
               RowBox[{"indeppluckrels", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ")"}], "=!=", 
           "True"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<kk=\>\"", ",", "kk", ",", "\"\< and nn=\>\"", ",", "nn", 
             ",", "\"\< : The solution to independentPluckerRelations does \
not trivialize its plucker relations!\>\""}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"And", "@@", 
             RowBox[{"Simplify", "[", 
              RowBox[{"pluckrels", "/.", 
               RowBox[{"indeppluckrels", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ")"}], "=!=", 
           "True"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<kk=\>\"", ",", "kk", ",", "\"\< and nn=\>\"", ",", "nn", 
             ",", "\"\< : The solution to independentPluckerRelations does \
not trivialize ALL plucker relations!\>\""}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"minorstomatrixelements", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Rule", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"HoldForm", "[", "minor", "]"}], "@@", "#"}], "&"}], 
               ",", "thematroid"}], "]"}], ",", 
             RowBox[{
              RowBox[{"Minors", "[", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  SubscriptBox["entry", 
                   RowBox[{"iii", ",", "jjj"}]], ",", 
                  RowBox[{"{", 
                   RowBox[{"iii", ",", "kk"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"jjj", ",", "nn"}], "}"}]}], "]"}], ",", "kk"}], 
               "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"And", "@@", 
             RowBox[{"Simplify", "[", 
              RowBox[{"pluckrels", "/.", "minorstomatrixelements"}], "]"}]}], 
            ")"}], "=!=", "True"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<kk=\>\"", ",", "kk", ",", "\"\< and nn=\>\"", ",", "nn", 
             ",", "\"\< : Some plucker relations are not right! They do not \
trivialize when applied to minors of an arbitrary kk by nn matrix\>\""}], 
            "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.666936761318286*^9, 3.666936770232819*^9}, {
   3.666936832405964*^9, 3.6669369139121976`*^9}, {3.666937188618357*^9, 
   3.6669372074870777`*^9}, 3.666937286669895*^9, {3.6669373477874546`*^9, 
   3.6669373726844826`*^9}, {3.6669376020894527`*^9, 
   3.6669376600084705`*^9}, {3.6669392205970306`*^9, 3.666939287317583*^9}, 
   3.6669396652203484`*^9, 3.666939777974944*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"nn=\"\>", "\[InvisibleSpace]", "2"}],
  SequenceForm["nn=", 2],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66693677370691*^9, 3.6669369145997343`*^9, 3.6669374469423475`*^9, {
   3.666937643682262*^9, 3.666937662361491*^9}, 3.666939290409111*^9, 
   3.666939724493492*^9, 3.666939777974944*^9, 3.6676764266603575`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    kk=\"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["    kk=", 1],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66693677370691*^9, 3.6669369145997343`*^9, 3.6669374469423475`*^9, {
   3.666937643682262*^9, 3.666937662361491*^9}, 3.666939290409111*^9, 
   3.666939724493492*^9, 3.666939777974944*^9, 3.6676764266759834`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"nn=\"\>", "\[InvisibleSpace]", "3"}],
  SequenceForm["nn=", 3],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66693677370691*^9, 3.6669369145997343`*^9, 3.6669374469423475`*^9, {
   3.666937643682262*^9, 3.666937662361491*^9}, 3.666939290409111*^9, 
   3.666939724493492*^9, 3.666939777974944*^9, 3.6676764266759834`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    kk=\"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["    kk=", 1],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66693677370691*^9, 3.6669369145997343`*^9, 3.6669374469423475`*^9, {
   3.666937643682262*^9, 3.666937662361491*^9}, 3.666939290409111*^9, 
   3.666939724493492*^9, 3.666939777974944*^9, 3.6676764266916094`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    kk=\"\>", "\[InvisibleSpace]", "2"}],
  SequenceForm["    kk=", 2],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66693677370691*^9, 3.6669369145997343`*^9, 3.6669374469423475`*^9, {
   3.666937643682262*^9, 3.666937662361491*^9}, 3.666939290409111*^9, 
   3.666939724493492*^9, 3.666939777974944*^9, 3.6676764266916094`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"nn=\"\>", "\[InvisibleSpace]", "4"}],
  SequenceForm["nn=", 4],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66693677370691*^9, 3.6669369145997343`*^9, 3.6669374469423475`*^9, {
   3.666937643682262*^9, 3.666937662361491*^9}, 3.666939290409111*^9, 
   3.666939724493492*^9, 3.666939777974944*^9, 3.6676764267072372`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    kk=\"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["    kk=", 1],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66693677370691*^9, 3.6669369145997343`*^9, 3.6669374469423475`*^9, {
   3.666937643682262*^9, 3.666937662361491*^9}, 3.666939290409111*^9, 
   3.666939724493492*^9, 3.666939777974944*^9, 3.6676764267072372`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    kk=\"\>", "\[InvisibleSpace]", "2"}],
  SequenceForm["    kk=", 2],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66693677370691*^9, 3.6669369145997343`*^9, 3.6669374469423475`*^9, {
   3.666937643682262*^9, 3.666937662361491*^9}, 3.666939290409111*^9, 
   3.666939724493492*^9, 3.666939777974944*^9, 3.6676764267228637`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    kk=\"\>", "\[InvisibleSpace]", "3"}],
  SequenceForm["    kk=", 3],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66693677370691*^9, 3.6669369145997343`*^9, 3.6669374469423475`*^9, {
   3.666937643682262*^9, 3.666937662361491*^9}, 3.666939290409111*^9, 
   3.666939724493492*^9, 3.666939777974944*^9, 3.6676764267384863`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"nn=\"\>", "\[InvisibleSpace]", "5"}],
  SequenceForm["nn=", 5],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66693677370691*^9, 3.6669369145997343`*^9, 3.6669374469423475`*^9, {
   3.666937643682262*^9, 3.666937662361491*^9}, 3.666939290409111*^9, 
   3.666939724493492*^9, 3.666939777974944*^9, 3.6676764267384863`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    kk=\"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["    kk=", 1],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66693677370691*^9, 3.6669369145997343`*^9, 3.6669374469423475`*^9, {
   3.666937643682262*^9, 3.666937662361491*^9}, 3.666939290409111*^9, 
   3.666939724493492*^9, 3.666939777974944*^9, 3.6676764267541127`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    kk=\"\>", "\[InvisibleSpace]", "2"}],
  SequenceForm["    kk=", 2],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66693677370691*^9, 3.6669369145997343`*^9, 3.6669374469423475`*^9, {
   3.666937643682262*^9, 3.666937662361491*^9}, 3.666939290409111*^9, 
   3.666939724493492*^9, 3.666939777974944*^9, 3.6676764267541127`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    kk=\"\>", "\[InvisibleSpace]", "3"}],
  SequenceForm["    kk=", 3],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66693677370691*^9, 3.6669369145997343`*^9, 3.6669374469423475`*^9, {
   3.666937643682262*^9, 3.666937662361491*^9}, 3.666939290409111*^9, 
   3.666939724493492*^9, 3.666939777974944*^9, 3.667676426816617*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    kk=\"\>", "\[InvisibleSpace]", "4"}],
  SequenceForm["    kk=", 4],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66693677370691*^9, 3.6669369145997343`*^9, 3.6669374469423475`*^9, {
   3.666937643682262*^9, 3.666937662361491*^9}, 3.666939290409111*^9, 
   3.666939724493492*^9, 3.666939777974944*^9, 3.66767642693051*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"nn=\"\>", "\[InvisibleSpace]", "6"}],
  SequenceForm["nn=", 6],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66693677370691*^9, 3.6669369145997343`*^9, 3.6669374469423475`*^9, {
   3.666937643682262*^9, 3.666937662361491*^9}, 3.666939290409111*^9, 
   3.666939724493492*^9, 3.666939777974944*^9, 3.667676426947649*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    kk=\"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["    kk=", 1],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66693677370691*^9, 3.6669369145997343`*^9, 3.6669374469423475`*^9, {
   3.666937643682262*^9, 3.666937662361491*^9}, 3.666939290409111*^9, 
   3.666939724493492*^9, 3.666939777974944*^9, 3.6676764269506564`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    kk=\"\>", "\[InvisibleSpace]", "2"}],
  SequenceForm["    kk=", 2],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66693677370691*^9, 3.6669369145997343`*^9, 3.6669374469423475`*^9, {
   3.666937643682262*^9, 3.666937662361491*^9}, 3.666939290409111*^9, 
   3.666939724493492*^9, 3.666939777974944*^9, 3.6676764269506564`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    kk=\"\>", "\[InvisibleSpace]", "3"}],
  SequenceForm["    kk=", 3],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66693677370691*^9, 3.6669369145997343`*^9, 3.6669374469423475`*^9, {
   3.666937643682262*^9, 3.666937662361491*^9}, 3.666939290409111*^9, 
   3.666939724493492*^9, 3.666939777974944*^9, 3.6676764271381655`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    kk=\"\>", "\[InvisibleSpace]", "4"}],
  SequenceForm["    kk=", 4],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66693677370691*^9, 3.6669369145997343`*^9, 3.6669374469423475`*^9, {
   3.666937643682262*^9, 3.666937662361491*^9}, 3.666939290409111*^9, 
   3.666939724493492*^9, 3.666939777974944*^9, 3.6676764276225634`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    kk=\"\>", "\[InvisibleSpace]", "5"}],
  SequenceForm["    kk=", 5],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66693677370691*^9, 3.6669369145997343`*^9, 3.6669374469423475`*^9, {
   3.666937643682262*^9, 3.666937662361491*^9}, 3.666939290409111*^9, 
   3.666939724493492*^9, 3.666939777974944*^9, 3.6676764280757084`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"nn=\"\>", "\[InvisibleSpace]", "7"}],
  SequenceForm["nn=", 7],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66693677370691*^9, 3.6669369145997343`*^9, 3.6669374469423475`*^9, {
   3.666937643682262*^9, 3.666937662361491*^9}, 3.666939290409111*^9, 
   3.666939724493492*^9, 3.666939777974944*^9, 3.6676764281069613`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    kk=\"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["    kk=", 1],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66693677370691*^9, 3.6669369145997343`*^9, 3.6669374469423475`*^9, {
   3.666937643682262*^9, 3.666937662361491*^9}, 3.666939290409111*^9, 
   3.666939724493492*^9, 3.666939777974944*^9, 3.667676428122591*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    kk=\"\>", "\[InvisibleSpace]", "2"}],
  SequenceForm["    kk=", 2],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66693677370691*^9, 3.6669369145997343`*^9, 3.6669374469423475`*^9, {
   3.666937643682262*^9, 3.666937662361491*^9}, 3.666939290409111*^9, 
   3.666939724493492*^9, 3.666939777974944*^9, 3.667676428122591*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    kk=\"\>", "\[InvisibleSpace]", "3"}],
  SequenceForm["    kk=", 3],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66693677370691*^9, 3.6669369145997343`*^9, 3.6669374469423475`*^9, {
   3.666937643682262*^9, 3.666937662361491*^9}, 3.666939290409111*^9, 
   3.666939724493492*^9, 3.666939777974944*^9, 3.6676764284663544`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    kk=\"\>", "\[InvisibleSpace]", "4"}],
  SequenceForm["    kk=", 4],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66693677370691*^9, 3.6669369145997343`*^9, 3.6669374469423475`*^9, {
   3.666937643682262*^9, 3.666937662361491*^9}, 3.666939290409111*^9, 
   3.666939724493492*^9, 3.666939777974944*^9, 3.667676430396657*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    kk=\"\>", "\[InvisibleSpace]", "5"}],
  SequenceForm["    kk=", 5],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66693677370691*^9, 3.6669369145997343`*^9, 3.6669374469423475`*^9, {
   3.666937643682262*^9, 3.666937662361491*^9}, 3.666939290409111*^9, 
   3.666939724493492*^9, 3.666939777974944*^9, 3.667676435579177*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    kk=\"\>", "\[InvisibleSpace]", "6"}],
  SequenceForm["    kk=", 6],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.66693677370691*^9, 3.6669369145997343`*^9, 3.6669374469423475`*^9, {
   3.666937643682262*^9, 3.666937662361491*^9}, 3.666939290409111*^9, 
   3.666939724493492*^9, 3.666939777974944*^9, 3.6676764498918977`*^9}]
}, Closed]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.66693930786345*^9, 3.6669393080822144`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Here", " ", "we", " ", "check", " ", "rotateExternalVertices"}], 
  "*)"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.665315733970289*^9, 3.6653157470007343`*^9}, 
   3.665315981081725*^9, {3.6666337161716323`*^9, 3.6666337171716833`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"input1", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{"{", 
         RowBox[{"0.", ",", "0."}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", 
        RowBox[{"{", 
         RowBox[{"6.", ",", "4."}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", 
        RowBox[{"{", 
         RowBox[{"0.", ",", "5."}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", 
        RowBox[{"{", 
         RowBox[{"0.4", ",", 
          RowBox[{"-", "0.25"}]}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"5", ",", 
        RowBox[{"{", 
         RowBox[{"6.", ",", "0."}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"6", ",", 
        RowBox[{"{", 
         RowBox[{"6.", ",", 
          RowBox[{"-", "0.5"}]}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"7", ",", 
        RowBox[{"{", 
         RowBox[{"1.114892969810759`", ",", "0.`"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"8", ",", 
        RowBox[{"{", 
         RowBox[{"0.", ",", 
          RowBox[{"-", "0.75"}]}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"9", ",", 
        RowBox[{"{", 
         RowBox[{"6.", ",", 
          RowBox[{"-", "0.75"}]}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"10", ",", 
        RowBox[{"{", 
         RowBox[{"0.", ",", 
          RowBox[{"-", "0.5"}]}], "}"}]}], "}"}]}], "}"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"input2", "=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"input1", "[", 
          RowBox[{"[", 
           RowBox[{"#", ",", "2"}], "]"}], "]"}], ",", 
         RowBox[{"UndirectedEdge", "@@", "#"}]}], "}"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "7"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "10"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "5"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"4", ",", "7"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"5", ",", "6"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"5", ",", "7"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"6", ",", "9"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"6", ",", "10"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"8", ",", "10"}], "}"}]}], "}"}]}], "]"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"input3", "=", 
    RowBox[{"{", 
     RowBox[{"2", ",", "3", ",", "4", ",", "8", ",", "9"}], "}"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"rotateExternalVertices", "[", 
       RowBox[{"input1", ",", "input2", ",", "input3"}], "]"}], "=!=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"{", 
             RowBox[{"0.`", ",", "0.`"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"2", ",", 
            RowBox[{"{", 
             RowBox[{"2.012330665067488`", ",", "0.3138363829113791`"}], 
             "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"3", ",", 
            RowBox[{"{", 
             RowBox[{"0.`", ",", "5.`"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"4", ",", 
            RowBox[{"{", 
             RowBox[{"0.35765476859377754`", ",", 
              RowBox[{"-", "0.012738324164385306`"}]}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"5", ",", 
            RowBox[{"{", 
             RowBox[{"6.`", ",", "0.`"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"6", ",", 
            RowBox[{"{", 
             RowBox[{"6.`", ",", 
              RowBox[{"-", "0.5`"}]}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"7", ",", 
            RowBox[{"{", 
             RowBox[{"1.114892969810759`", ",", "0.`"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"8", ",", 
            RowBox[{"{", 
             RowBox[{"0.`", ",", 
              RowBox[{"-", "0.75`"}]}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"9", ",", 
            RowBox[{"{", 
             RowBox[{"6.`", ",", 
              RowBox[{"-", "0.75`"}]}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"10", ",", 
            RowBox[{"{", 
             RowBox[{"0.`", ",", 
              RowBox[{"-", "0.5`"}]}], "}"}]}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0.`", ",", "0.`"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0.`", ",", "5.`"}], "}"}]}], "}"}], ",", 
            RowBox[{"1", "\[UndirectedEdge]", "3"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0.`", ",", "0.`"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1.114892969810759`", ",", "0.`"}], "}"}]}], "}"}], 
            ",", 
            RowBox[{"1", "\[UndirectedEdge]", "7"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0.`", ",", "0.`"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0.`", ",", 
                RowBox[{"-", "0.5`"}]}], "}"}]}], "}"}], ",", 
            RowBox[{"1", "\[UndirectedEdge]", "10"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"2.012330665067488`", ",", "0.3138363829113791`"}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"6.`", ",", "0.`"}], "}"}]}], "}"}], ",", 
            RowBox[{"2", "\[UndirectedEdge]", "5"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0.35765476859377754`", ",", 
                RowBox[{"-", "0.012738324164385306`"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1.114892969810759`", ",", "0.`"}], "}"}]}], "}"}], 
            ",", 
            RowBox[{"4", "\[UndirectedEdge]", "7"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"6.`", ",", "0.`"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"6.`", ",", 
                RowBox[{"-", "0.5`"}]}], "}"}]}], "}"}], ",", 
            RowBox[{"5", "\[UndirectedEdge]", "6"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"6.`", ",", "0.`"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1.114892969810759`", ",", "0.`"}], "}"}]}], "}"}], 
            ",", 
            RowBox[{"5", "\[UndirectedEdge]", "7"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"6.`", ",", 
                RowBox[{"-", "0.5`"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"6.`", ",", 
                RowBox[{"-", "0.75`"}]}], "}"}]}], "}"}], ",", 
            RowBox[{"6", "\[UndirectedEdge]", "9"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"6.`", ",", 
                RowBox[{"-", "0.5`"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0.`", ",", 
                RowBox[{"-", "0.5`"}]}], "}"}]}], "}"}], ",", 
            RowBox[{"6", "\[UndirectedEdge]", "10"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0.`", ",", 
                RowBox[{"-", "0.75`"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0.`", ",", 
                RowBox[{"-", "0.5`"}]}], "}"}]}], "}"}], ",", 
            RowBox[{"8", "\[UndirectedEdge]", "10"}]}], "}"}]}], "}"}]}], 
       "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<There is a problem with rotateExternalVertices! When it rotates a \
vertex it should recalculate the ordering and see if anything else needs \
rotating, then do it. Something went wrong in this process.\>\"", "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
   RowBox[{"input1", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{"{", 
         RowBox[{"0.", ",", "0."}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", 
        RowBox[{"{", 
         RowBox[{"1.", ",", "6."}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", 
        RowBox[{"{", 
         RowBox[{"0.", ",", 
          RowBox[{"-", "1."}]}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", 
        RowBox[{"{", 
         RowBox[{"1.", ",", 
          RowBox[{"-", "2."}]}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"5", ",", 
        RowBox[{"{", 
         RowBox[{"0.", ",", "6."}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"6", ",", 
        RowBox[{"{", 
         RowBox[{"1.", ",", "0."}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"7", ",", 
        RowBox[{"{", 
         RowBox[{"1.", ",", 
          RowBox[{"-", "1."}]}], "}"}]}], "}"}]}], "}"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"input2", "=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"input1", "[", 
          RowBox[{"[", 
           RowBox[{"#", ",", "2"}], "]"}], "]"}], ",", 
         RowBox[{"UndirectedEdge", "@@", "#"}]}], "}"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "5"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "6"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "6"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "7"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"4", ",", "7"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"6", ",", "7"}], "}"}]}], "}"}]}], "]"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"input3", "=", 
    RowBox[{"{", 
     RowBox[{"2", ",", "4", ",", "5"}], "}"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"rotateExternalVertices", "[", 
       RowBox[{"input1", ",", "input2", ",", "input3"}], "]"}], "=!=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"{", 
             RowBox[{"0.`", ",", "0.`"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"2", ",", 
            RowBox[{"{", 
             RowBox[{"0.01791025239610855`", ",", "5.919079297293738`"}], 
             "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"3", ",", 
            RowBox[{"{", 
             RowBox[{"0.`", ",", 
              RowBox[{"-", "1.`"}]}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"4", ",", 
            RowBox[{"{", 
             RowBox[{"1.`", ",", 
              RowBox[{"-", "2.`"}]}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"5", ",", 
            RowBox[{"{", 
             RowBox[{"0.`", ",", "6.`"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"6", ",", 
            RowBox[{"{", 
             RowBox[{"1.`", ",", "0.`"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"7", ",", 
            RowBox[{"{", 
             RowBox[{"1.`", ",", 
              RowBox[{"-", "1.`"}]}], "}"}]}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0.`", ",", "0.`"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0.`", ",", 
                RowBox[{"-", "1.`"}]}], "}"}]}], "}"}], ",", 
            RowBox[{"1", "\[UndirectedEdge]", "3"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0.`", ",", "0.`"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0.`", ",", "6.`"}], "}"}]}], "}"}], ",", 
            RowBox[{"1", "\[UndirectedEdge]", "5"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0.`", ",", "0.`"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1.`", ",", "0.`"}], "}"}]}], "}"}], ",", 
            RowBox[{"1", "\[UndirectedEdge]", "6"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0.01791025239610855`", ",", "5.919079297293738`"}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1.`", ",", "0.`"}], "}"}]}], "}"}], ",", 
            RowBox[{"2", "\[UndirectedEdge]", "6"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0.`", ",", 
                RowBox[{"-", "1.`"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1.`", ",", 
                RowBox[{"-", "1.`"}]}], "}"}]}], "}"}], ",", 
            RowBox[{"3", "\[UndirectedEdge]", "7"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1.`", ",", 
                RowBox[{"-", "2.`"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1.`", ",", 
                RowBox[{"-", "1.`"}]}], "}"}]}], "}"}], ",", 
            RowBox[{"4", "\[UndirectedEdge]", "7"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1.`", ",", "0.`"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1.`", ",", 
                RowBox[{"-", "1.`"}]}], "}"}]}], "}"}], ",", 
            RowBox[{"6", "\[UndirectedEdge]", "7"}]}], "}"}]}], "}"}]}], 
       "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<There is a problem with rotateExternalVertices! A vertex should \
be rotated as much as posisble without crossing any edges. This iterative \
process or rotating less and less has failed.\>\"", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}], ";"}], "*)"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6653157400435576`*^9, 3.665315825784913*^9}, {
   3.665315872814883*^9, 3.665315981081725*^9}, 3.6701285274302015`*^9}]
}, Closed]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6669494248698206`*^9, 3.6669494250010924`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Here", " ", "we", " ", "check", " ", "grassmannianMatrix"}], 
  "*)"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6647894413002005`*^9, 3.664789445380827*^9}, 
   3.6652318758749685`*^9, {3.666519531695671*^9, 3.6665195424604073`*^9}, {
   3.666957685274396*^9, 3.666957689288158*^9}, 3.6716875471572943`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"formatrule", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["XX_", 
      RowBox[{"z1_", ",", "z2_"}]], "\[Rule]", 
     RowBox[{"XX", "[", 
      RowBox[{"z1", ",", "z2"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ii", "=", "1"}], ",", 
    RowBox[{"ii", "\[LessEqual]", "110"}], ",", 
    RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<ii=\>\"", ",", "ii"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Mod", "[", 
           RowBox[{"ii", ",", "10"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<ii=\>\"", ",", "ii"}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
     SubscriptBox["bft", "ii"], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"a", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b", "=", 
      RowBox[{"b", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"c", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"d", "=", 
      RowBox[{"d", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", "b", "]"}], ",", "c"}], "]"}], "]"}], "=!=",
         "0"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"perfs", "=", 
         RowBox[{"perfectMatchings", "[", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"srcs", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"getSourceNodes", "[", 
             RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "#"}], "]"}], 
            "&"}], ",", "perfs"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"snks", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"getSinkNodes", "[", 
             RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "#"}], "]"}], 
            "&"}], ",", "perfs"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"multiplic", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Tally", "[", "srcs", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"#", ",", "2"}], "]"}], "]"}], "&"}], ",", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Position", "[", 
                RowBox[{
                 RowBox[{"Tally", "[", "srcs", "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"#", ",", "_"}], "}"}]}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], "&"}], ",", "srcs"}], 
            "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"jj", "=", "1"}], ",", 
          RowBox[{"jj", "\[LessEqual]", 
           RowBox[{"Length", "[", "perfs", "]"}]}], ",", 
          RowBox[{"jj", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"ii", "\[NotEqual]", "30"}], "||", 
              RowBox[{"jj", "\[Equal]", 
               RowBox[{"lowNumberLoopsPMpos", "[", 
                RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Mod", "[", 
                  RowBox[{"jj", ",", "10"}], "]"}], "\[Equal]", "0"}], ",", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{"\"\<    jj=\>\"", ",", "jj"}], "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{"(*", 
                RowBox[{"jj", "\[Equal]", 
                 RowBox[{"lowNumberLoopsPMpos", "[", 
                  RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
                "*)"}], 
               RowBox[{
                RowBox[{
                 RowBox[{"multiplic", "[", 
                  RowBox[{"[", "jj", "]"}], "]"}], "\[LessEqual]", "3"}], ",",
                 "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Cmatrix", "=", 
                  RowBox[{"grassmannianMatrix", "[", 
                   RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", 
                    RowBox[{"perfs", "[", 
                    RowBox[{"[", "jj", "]"}], "]"}]}], "]"}]}], ";", 
                 "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"Cmatrix", "=!=", "Null"}], ",", 
                   "\[IndentingNewLine]", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"sources", "=", 
                    RowBox[{"srcs", "[", 
                    RowBox[{"[", "jj", "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"sinks", "=", 
                    RowBox[{"snks", "[", 
                    RowBox[{"[", "jj", "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Dimensions", "[", "Cmatrix", "]"}], "=!=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Length", "[", "sources", "]"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Join", "[", 
                    RowBox[{"sources", ",", "sinks"}], "]"}], "]"}]}], 
                    "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<ii=\>\"", ",", "ii", ",", 
                    "\"\< : There's a problem with the Grassmannian matrix! \
Its size is not correct!\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
                     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"variablesmatrix", "=", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"Variables", "[", "#", "]"}], ",", 
                    RowBox[{"Variables", "[", 
                    RowBox[{"Join", "[", 
                    RowBox[{"b", ",", "c"}], "]"}], "]"}]}], "]"}], "&"}], 
                    ",", "Cmatrix", ",", 
                    RowBox[{"{", "2", "}"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"sourceedges", "=", 
                    RowBox[{"getSourceEdges", "[", 
                    RowBox[{"b", ",", "c", ",", 
                    RowBox[{"perfs", "[", 
                    RowBox[{"[", "jj", "]"}], "]"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"sinkedges", "=", 
                    RowBox[{"getSinkEdges", "[", 
                    RowBox[{"b", ",", "c", ",", 
                    RowBox[{"perfs", "[", 
                    RowBox[{"[", "jj", "]"}], "]"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sort", "[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"DeleteDuplicates", "[", 
                    RowBox[{"Join", "@@", "#"}], "]"}], "&"}], ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Intersection", "[", 
                    RowBox[{"#", ",", "sourceedges"}], "]"}], "&"}], ",", 
                    "variablesmatrix", ",", 
                    RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], "]"}], "]"}], "===", 
                    RowBox[{"Sort", "[", "sourceedges", "]"}]}], ")"}], "&&", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Sort", "[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"DeleteDuplicates", "[", 
                    RowBox[{"Join", "@@", "#"}], "]"}], "&"}], ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Intersection", "[", 
                    RowBox[{"#", ",", "sinkedges"}], "]"}], "&"}], ",", 
                    RowBox[{"Transpose", "[", "variablesmatrix", "]"}], ",", 
                    RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], "]"}], "]"}], "===", 
                    RowBox[{"Sort", "[", "sinkedges", "]"}]}], ")"}]}], ")"}],
                     "=!=", "True"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<ii=\>\"", ",", "ii", ",", 
                    "\"\< : There's a problem with the Grassmannian matrix! \
It doesn't seem to be going from sources to sinks\>\""}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"minors", "=", 
                    RowBox[{"Expand", "[", 
                    RowBox[{"Simplify", "[", 
                    RowBox[{
                    RowBox[{"Minors", "[", 
                    RowBox[{"Cmatrix", ",", 
                    RowBox[{"Length", "[", "Cmatrix", "]"}]}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{"minors", ",", 
                    RowBox[{
                    RowBox[{"Power", "[", 
                    RowBox[{"___", ",", "2"}], "]"}], "|", 
                    RowBox[{"Power", "[", 
                    RowBox[{"___", ",", "3"}], "]"}], "|", 
                    RowBox[{"Power", "[", 
                    RowBox[{"___", ",", "4"}], "]"}], "|", 
                    RowBox[{"Times", "[", 
                    RowBox[{"2", ",", "___"}], "]"}], "|", 
                    RowBox[{"Times", "[", 
                    RowBox[{"3", ",", "___"}], "]"}], "|", 
                    RowBox[{"Times", "[", 
                    RowBox[{"4", ",", "___"}], "]"}]}]}], "]"}], "=!=", 
                    RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<ii=\>\"", ",", "ii", ",", 
                    "\"\< : There's a problem with the Grassmannian matrix! \
Its minors do not simplify\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", 
                    "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"numberofdenomintaorterms", "=", 
                    RowBox[{"Sort", "[", 
                    RowBox[{"DeleteDuplicates", "[", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"{", "denom", "}"}], ",", 
                    RowBox[{"Block", "[", 
                    RowBox[{
                    RowBox[{"{", "output", "}"}], ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Head", "[", "denom", "]"}], "===", "Plus"}], ",", 
                    RowBox[{
                    RowBox[{"output", "=", 
                    RowBox[{"Length", "[", "denom", "]"}]}], ";"}], ",", 
                    RowBox[{
                    RowBox[{"output", "=", "1"}], ";"}]}], "]"}], ";", 
                    "output"}]}], "]"}]}], "]"}], "[", "#", "]"}], "&"}], ",", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"{", "terms", "}"}], ",", 
                    RowBox[{"Block", "[", 
                    RowBox[{
                    RowBox[{"{", "output", "}"}], ",", 
                    RowBox[{
                    RowBox[{"output", "=", 
                    RowBox[{"Expand", "[", "terms", "]"}]}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Head", "[", "output", "]"}], "===", "Plus"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"output", "=", 
                    RowBox[{"List", "@@", "output"}]}], ";"}], ",", 
                    RowBox[{
                    RowBox[{"output", "=", 
                    RowBox[{"{", "output", "}"}]}], ";"}]}], "]"}], ";", 
                    RowBox[{"output", "=", 
                    RowBox[{"Map", "[", 
                    RowBox[{"Expand", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{"Denominator", ",", "output"}], "]"}]}], "]"}]}], 
                    ";", "output"}]}], "]"}]}], "]"}], "[", "#", "]"}], "&"}],
                     ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", "Cmatrix", "]"}], ",", 
                    RowBox[{"0", "|", "1"}]}], "]"}]}], "]"}], "]"}]}], "]"}],
                     "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"numberofdenomintaorterms", "=!=", 
                    RowBox[{"{", 
                    RowBox[{"multiplic", "[", 
                    RowBox[{"[", "jj", "]"}], "]"}], "}"}]}], "&&", 
                    RowBox[{"numberofdenomintaorterms", "=!=", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"multiplic", "[", 
                    RowBox[{"[", "jj", "]"}], "]"}]}], "}"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<ii=\>\"", ",", "ii", ",", 
                    
                    "\"\< : There's a problem with the Grassmannian matrix! \
The denominators do not all have the right number of terms\>\""}], "]"}], 
                    ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"expecteddenominatorloops", "=", 
                    RowBox[{
                    RowBox[{"perfs", "[", 
                    RowBox[{"[", "jj", "]"}], "]"}], "+", 
                    RowBox[{"Total", "[", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"perfs", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "&"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cases", "[", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{"matroidPolytope", "[", 
                    RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}],
                     ",", "#"}], "]"}], "]"}], "&"}], ",", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"turnIntoPolytope", "[", 
                    RowBox[{"matroidPolytope", "[", 
                    RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}],
                     "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"___", ",", "jj", ",", "___"}], "}"}]}], "]"}], 
                    "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "jj"}], "]"}]}], 
                    "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "NB", " ", "expecteddenominatorloops", " ", "SOMETIMES", 
                    " ", "HAS", " ", "POSITIVE", " ", "TERMS", " ", "AS", " ", 
                    RowBox[{"WELL", "!"}], " ", "This", " ", "only", " ", 
                    "works", " ", "for", " ", "small", " ", "numbers", " ", 
                    "of", " ", "loops", " ", "and", " ", 
                    RowBox[{"won", "'"}], "t", " ", "work", " ", "in", " ", 
                    RowBox[{
                    RowBox[{"general", "!!"}], "!"}]}], "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"niceminors", "=", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Expand", "[", 
                    RowBox[{"Simplify", "[", 
                    RowBox[{"minors", " ", "expecteddenominatorloops"}], 
                    "]"}], "]"}], "/.", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"perfs", "[", 
                    RowBox[{"[", "iii", "]"}], "]"}], "\[Rule]", 
                    RowBox[{"pp", "[", "iii", "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"iii", ",", 
                    RowBox[{"Length", "[", "perfs", "]"}]}], "}"}]}], "]"}]}],
                     ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"theperfsinminors", "=", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"{", "mino", "}"}], ",", 
                    RowBox[{"Block", "[", 
                    RowBox[{
                    RowBox[{"{", "output", "}"}], ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Head", "[", "mino", "]"}], "===", "Plus"}], ",", 
                    RowBox[{
                    RowBox[{"output", "=", 
                    RowBox[{"List", "@@", "mino"}]}], ";"}], ",", 
                    RowBox[{
                    RowBox[{"output", "=", 
                    RowBox[{"{", "mino", "}"}]}], ";"}]}], "]"}], ";", 
                    "output"}]}], "]"}]}], "]"}], "[", "#", "]"}], "&"}], ",",
                     "niceminors"}], "]"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"pp", "[", "zz_", "]"}]}], "\[Rule]", 
                    RowBox[{"pp", "[", "zz", "]"}]}], "}"}]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"And", "@@", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Head", "[", "#", "]"}], "===", "pp"}], "&"}], 
                    ",", 
                    RowBox[{"Flatten", "[", "theperfsinminors", "]"}]}], 
                    "]"}]}], ")"}], "\[Equal]", "False"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<ii=\>\"", ",", "ii", ",", 
                    "\"\< : There's a problem with the path matrix! Its \
minors are not equal to sums of perfect matchings\>\""}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sort", "[", 
                    RowBox[{"Map", "[", 
                    RowBox[{"DeleteDuplicates", ",", 
                    RowBox[{"theperfsinminors", "/.", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"pp", "[", "iii", "]"}], "\[Rule]", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Sort", ",", 
                    RowBox[{"srcs", "/.", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"getOrderingExternalNodesGrassmannian", "[", 
                    RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "[", 
                    RowBox[{"[", "jjj", "]"}], "]"}], "\[Rule]", "jjj"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"jjj", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"getOrderingExternalNodesDefault", "[", 
                    RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], 
                    "]"}]}], "}"}]}], "]"}]}]}], "]"}], "[", 
                    RowBox[{"[", "iii", "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"iii", ",", 
                    RowBox[{"Length", "[", "perfs", "]"}]}], "}"}]}], 
                    "]"}]}]}], "]"}], "]"}], "=!=", 
                    RowBox[{"Delete", "[", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{"Subsets", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"Dimensions", "[", "Cmatrix", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Length", "[", "Cmatrix", "]"}], "}"}]}], "]"}], 
                    "}"}], "]"}], ",", 
                    RowBox[{"Position", "[", 
                    RowBox[{"minors", ",", "0"}], "]"}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<ii=\>\"", ",", "ii", ",", 
                    "\"\< : There's a problem with the path matrix! The \
perfect matchings contributing to each minor do not have the correct source \
sets\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sort", "[", "theperfsinminors", "]"}], "=!=", 
                    RowBox[{"Sort", "[", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"{", "mino", "}"}], ",", 
                    RowBox[{"Block", "[", 
                    RowBox[{
                    RowBox[{"{", "output", "}"}], ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Head", "[", "mino", "]"}], "===", "Plus"}], ",", 
                    RowBox[{
                    RowBox[{"output", "=", 
                    RowBox[{"List", "@@", "mino"}]}], ";"}], ",", 
                    RowBox[{
                    RowBox[{"output", "=", 
                    RowBox[{"{", "mino", "}"}]}], ";"}]}], "]"}], ";", 
                    "output"}]}], "]"}]}], "]"}], "[", "#", "]"}], "&"}], ",", 
                    RowBox[{
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"minorsAsPerfectMatchings", "[", 
                    RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], ",", 
                    "0"}], "]"}], "/.", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"perfs", "[", 
                    RowBox[{"[", "iii", "]"}], "]"}], "\[Rule]", 
                    RowBox[{"pp", "[", "iii", "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"iii", ",", 
                    RowBox[{"Length", "[", "perfs", "]"}]}], "}"}]}], 
                    "]"}]}]}], "]"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"pp", "[", "zz_", "]"}]}], "\[Rule]", 
                    RowBox[{"pp", "[", "zz", "]"}]}], "}"}]}], ")"}], "]"}]}],
                     ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<ii=\>\"", ",", "ii", ",", 
                    "\"\< : There's a problem with minorsAsPerfectMatchings! \
The perfect matchings contributing to each minor do not correspond to the \
calculation done directly by the path matrix\>\""}], "]"}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                  "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], 
                 ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<We have a dimer\>\"", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6669398846368275`*^9, 3.6669399158114004`*^9}, {
   3.6669403762509184`*^9, 3.6669404278140607`*^9}, 3.666941183100424*^9, {
   3.666941836837825*^9, 3.666941858519998*^9}, {3.666953127066536*^9, 
   3.6669531329281073`*^9}, 3.666957585172649*^9, {3.6669687180655794`*^9, 
   3.6669687887342176`*^9}, 3.667047515649984*^9, 3.667644116423692*^9, {
   3.667644147829994*^9, 3.667644171409754*^9}, 3.6676533496965895`*^9, 
   3.6676533921153593`*^9, {3.6678284518339653`*^9, 3.6678284569851265`*^9}, 
   3.671545452891776*^9, {3.6715455313073893`*^9, 3.6715455321534944`*^9}, 
   3.67154579735863*^9, 3.6715458429488707`*^9, 3.671687062066106*^9, 
   3.671687117215062*^9, 3.6716871593680925`*^9, 3.6716875478813376`*^9, 
   3.6716878733884077`*^9, {3.6727465178864703`*^9, 3.672746535739395*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["ii=", 1],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6669418620133643`*^9, 3.666941876713729*^9}, 
   3.666949455771314*^9, 3.6669531374880805`*^9, 3.666957589603718*^9, 
   3.6669621065510907`*^9, {3.6669687736456175`*^9, 3.666968790519017*^9}, 
   3.667676450391924*^9, 3.6727465265345163`*^9, 3.679984090204872*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "2"}],
  SequenceForm["ii=", 2],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6669418620133643`*^9, 3.666941876713729*^9}, 
   3.666949455771314*^9, 3.6669531374880805`*^9, 3.666957589603718*^9, 
   3.6669621065510907`*^9, {3.6669687736456175`*^9, 3.666968790519017*^9}, 
   3.667676450391924*^9, 3.6727465265345163`*^9, 3.67998409084575*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "3"}],
  SequenceForm["ii=", 3],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6669418620133643`*^9, 3.666941876713729*^9}, 
   3.666949455771314*^9, 3.6669531374880805`*^9, 3.666957589603718*^9, 
   3.6669621065510907`*^9, {3.6669687736456175`*^9, 3.666968790519017*^9}, 
   3.667676450391924*^9, 3.6727465265345163`*^9, 3.679984091455155*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    jj=\"\>", "\[InvisibleSpace]", "10"}],
  SequenceForm["    jj=", 10],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6669418620133643`*^9, 3.666941876713729*^9}, 
   3.666949455771314*^9, 3.6669531374880805`*^9, 3.666957589603718*^9, 
   3.6669621065510907`*^9, {3.6669687736456175`*^9, 3.666968790519017*^9}, 
   3.667676450391924*^9, 3.6727465265345163`*^9, 3.6799840930890474`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "4"}],
  SequenceForm["ii=", 4],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6669418620133643`*^9, 3.666941876713729*^9}, 
   3.666949455771314*^9, 3.6669531374880805`*^9, 3.666957589603718*^9, 
   3.6669621065510907`*^9, {3.6669687736456175`*^9, 3.666968790519017*^9}, 
   3.667676450391924*^9, 3.6727465265345163`*^9, 3.679984093276554*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "5"}],
  SequenceForm["ii=", 5],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6669418620133643`*^9, 3.666941876713729*^9}, 
   3.666949455771314*^9, 3.6669531374880805`*^9, 3.666957589603718*^9, 
   3.6669621065510907`*^9, {3.6669687736456175`*^9, 3.666968790519017*^9}, 
   3.667676450391924*^9, 3.6727465265345163`*^9, 3.6799840940978103`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "6"}],
  SequenceForm["ii=", 6],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6669418620133643`*^9, 3.666941876713729*^9}, 
   3.666949455771314*^9, 3.6669531374880805`*^9, 3.666957589603718*^9, 
   3.6669621065510907`*^9, {3.6669687736456175`*^9, 3.666968790519017*^9}, 
   3.667676450391924*^9, 3.6727465265345163`*^9, 3.6799840951291957`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    jj=\"\>", "\[InvisibleSpace]", "10"}],
  SequenceForm["    jj=", 10],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6669418620133643`*^9, 3.666941876713729*^9}, 
   3.666949455771314*^9, 3.6669531374880805`*^9, 3.666957589603718*^9, 
   3.6669621065510907`*^9, {3.6669687736456175`*^9, 3.666968790519017*^9}, 
   3.667676450391924*^9, 3.6727465265345163`*^9, 3.679984100155071*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "7"}],
  SequenceForm["ii=", 7],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6669418620133643`*^9, 3.666941876713729*^9}, 
   3.666949455771314*^9, 3.6669531374880805`*^9, 3.666957589603718*^9, 
   3.6669621065510907`*^9, {3.6669687736456175`*^9, 3.666968790519017*^9}, 
   3.667676450391924*^9, 3.6727465265345163`*^9, 3.679984102976596*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "8"}],
  SequenceForm["ii=", 8],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6669418620133643`*^9, 3.666941876713729*^9}, 
   3.666949455771314*^9, 3.6669531374880805`*^9, 3.666957589603718*^9, 
   3.6669621065510907`*^9, {3.6669687736456175`*^9, 3.666968790519017*^9}, 
   3.667676450391924*^9, 3.6727465265345163`*^9, 3.6799841030547285`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "9"}],
  SequenceForm["ii=", 9],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6669418620133643`*^9, 3.666941876713729*^9}, 
   3.666949455771314*^9, 3.6669531374880805`*^9, 3.666957589603718*^9, 
   3.6669621065510907`*^9, {3.6669687736456175`*^9, 3.666968790519017*^9}, 
   3.667676450391924*^9, 3.6727465265345163`*^9, 3.679984103304737*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    jj=\"\>", "\[InvisibleSpace]", "10"}],
  SequenceForm["    jj=", 10],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6669418620133643`*^9, 3.666941876713729*^9}, 
   3.666949455771314*^9, 3.6669531374880805`*^9, 3.666957589603718*^9, 
   3.6669621065510907`*^9, {3.6669687736456175`*^9, 3.666968790519017*^9}, 
   3.667676450391924*^9, 3.6727465265345163`*^9, 3.6799841248554096`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    jj=\"\>", "\[InvisibleSpace]", "20"}],
  SequenceForm["    jj=", 20],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6669418620133643`*^9, 3.666941876713729*^9}, 
   3.666949455771314*^9, 3.6669531374880805`*^9, 3.666957589603718*^9, 
   3.6669621065510907`*^9, {3.6669687736456175`*^9, 3.666968790519017*^9}, 
   3.667676450391924*^9, 3.6727465265345163`*^9, 3.6799841493219643`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "10"}],
  SequenceForm["ii=", 10],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6669418620133643`*^9, 3.666941876713729*^9}, 
   3.666949455771314*^9, 3.6669531374880805`*^9, 3.666957589603718*^9, 
   3.6669621065510907`*^9, {3.6669687736456175`*^9, 3.666968790519017*^9}, 
   3.667676450391924*^9, 3.6727465265345163`*^9, 3.679984160359366*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    jj=\"\>", "\[InvisibleSpace]", "10"}],
  SequenceForm["    jj=", 10],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6669418620133643`*^9, 3.666941876713729*^9}, 
   3.666949455771314*^9, 3.6669531374880805`*^9, 3.666957589603718*^9, 
   3.6669621065510907`*^9, {3.6669687736456175`*^9, 3.666968790519017*^9}, 
   3.667676450391924*^9, 3.6727465265345163`*^9, 3.6799842094218764`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    jj=\"\>", "\[InvisibleSpace]", "20"}],
  SequenceForm["    jj=", 20],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6669418620133643`*^9, 3.666941876713729*^9}, 
   3.666949455771314*^9, 3.6669531374880805`*^9, 3.666957589603718*^9, 
   3.6669621065510907`*^9, {3.6669687736456175`*^9, 3.666968790519017*^9}, 
   3.667676450391924*^9, 3.6727465265345163`*^9, 3.6799842589372096`*^9}]
}, Closed]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.666935707896011*^9, 3.6669357080369663`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Here", " ", "we", " ", "check", " ", "pluckerCoordinates"}], 
  "*)"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.665298952647045*^9, 3.6652989561955156`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"formatrule", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["XX_", 
      RowBox[{"z1_", ",", "z2_"}]], "\[Rule]", 
     RowBox[{"XX", "[", 
      RowBox[{"z1", ",", "z2"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ii", "=", "1"}], ",", 
    RowBox[{"ii", "\[LessEqual]", "110"}], ",", 
    RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<ii=\>\"", ",", "ii"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Mod", "[", 
           RowBox[{"ii", ",", "10"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<ii=\>\"", ",", "ii"}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
     SubscriptBox["bft", "ii"], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"a", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b", "=", 
      RowBox[{"b", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"c", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"d", "=", 
      RowBox[{"d", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", "b", "]"}], ",", "c"}], "]"}], "]"}], "=!=",
         "0"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"perfs", "=", 
         RowBox[{"perfectMatchings", "[", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"srcs", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"getSourceNodes", "[", 
             RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "#"}], "]"}], 
            "&"}], ",", "perfs"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"multiplic", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Tally", "[", "srcs", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"#", ",", "2"}], "]"}], "]"}], "&"}], ",", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Position", "[", 
                RowBox[{
                 RowBox[{"Tally", "[", "srcs", "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"#", ",", "_"}], "}"}]}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], "&"}], ",", "srcs"}], 
            "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"jj", "=", "1"}], ",", 
          RowBox[{"jj", "\[LessEqual]", 
           RowBox[{"Length", "[", "perfs", "]"}]}], ",", 
          RowBox[{"jj", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Mod", "[", 
               RowBox[{"jj", ",", "10"}], "]"}], "\[Equal]", "0"}], ",", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{"\"\<    jj=\>\"", ",", "jj"}], "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"multiplic", "[", 
               RowBox[{"[", "jj", "]"}], "]"}], "\[LessEqual]", "3"}], ",", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"pluckers", "=", 
               RowBox[{"pluckerCoordinates", "[", 
                RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", 
                 RowBox[{"perfs", "[", 
                  RowBox[{"[", "jj", "]"}], "]"}], ",", "True"}], "]"}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"pathmatpluckers", "=", 
               RowBox[{"pluckerCoordinates", "[", 
                RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", 
                 RowBox[{"perfs", "[", 
                  RowBox[{"[", "jj", "]"}], "]"}], ",", "False"}], "]"}]}], 
              ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"pluckers", ",", 
                   RowBox[{
                    RowBox[{"Power", "[", 
                    RowBox[{"___", ",", "2"}], "]"}], "|", 
                    RowBox[{"Power", "[", 
                    RowBox[{"___", ",", "3"}], "]"}], "|", 
                    RowBox[{"Power", "[", 
                    RowBox[{"___", ",", "4"}], "]"}], "|", 
                    RowBox[{"Times", "[", 
                    RowBox[{"2", ",", "___"}], "]"}], "|", 
                    RowBox[{"Times", "[", 
                    RowBox[{"3", ",", "___"}], "]"}], "|", 
                    RowBox[{"Times", "[", 
                    RowBox[{"4", ",", "___"}], "]"}]}]}], "]"}], "=!=", 
                 RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{
                  "\"\<ii=\>\"", ",", "ii", ",", 
                   "\"\< : There's a problem with the Pluckers! The minors \
did not simplify\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"pathmatloopdenom", "=", 
               RowBox[{"Expand", "[", 
                RowBox[{"1", "/", 
                 RowBox[{"Expand", "[", 
                  RowBox[{"Simplify", "[", 
                   RowBox[{"Det", "[", 
                    RowBox[{"connectivityMatrix", "[", 
                    RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", 
                    RowBox[{"perfs", "[", 
                    RowBox[{"[", "jj", "]"}], "]"}]}], "]"}], "]"}], "]"}], 
                  "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"loopdenom", "=", 
               RowBox[{"pathmatloopdenom", "/.", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Times", "[", 
                   RowBox[{
                    RowBox[{"-", "1"}], ",", "zz_"}], "]"}], "\[Rule]", 
                  RowBox[{"Times", "[", 
                   RowBox[{"1", ",", "zz"}], "]"}]}], "}"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"truemappluckertoperfmatch", "=", 
               RowBox[{"Expand", "[", 
                RowBox[{"Simplify", "[", 
                 RowBox[{"pluckers", " ", "loopdenom", " ", 
                  RowBox[{"perfs", "[", 
                   RowBox[{"[", "jj", "]"}], "]"}]}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"sourcesets", "=", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"getSourceNodes", "[", 
                   RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "#"}], 
                   "]"}], "&"}], ",", 
                 RowBox[{"Map", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"{", "terms", "}"}], ",", 
                    RowBox[{"Block", "[", 
                    RowBox[{
                    RowBox[{"{", "return", "}"}], ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Head", "[", "terms", "]"}], "===", "Plus"}], ",", 
                    RowBox[{
                    RowBox[{"return", "=", 
                    RowBox[{"List", "@@", "terms"}]}], ";"}], ",", 
                    RowBox[{
                    RowBox[{"return", "=", 
                    RowBox[{"{", "terms", "}"}]}], ";"}]}], "]"}], ";", 
                    "return"}]}], "]"}]}], "]"}], "[", "#", "]"}], "&"}], ",",
                    "truemappluckertoperfmatch"}], "]"}], ",", 
                 RowBox[{"{", "2", "}"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"correctsourcesets", "=", 
               RowBox[{"Subsets", "[", 
                RowBox[{
                 RowBox[{"getOrderingExternalNodesGrassmannian", "[", 
                  RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"Length", "[", 
                   RowBox[{"srcs", "[", 
                    RowBox[{"[", "jj", "]"}], "]"}], "]"}], "}"}]}], "]"}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"everythingOK", "=", 
               RowBox[{"And", "@@", 
                RowBox[{"Flatten", "[", 
                 RowBox[{"MapThread", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sort", "[", "#", "]"}], "===", 
                    RowBox[{"Sort", "[", "#1", "]"}]}], "&"}], ",", "#2"}], 
                    "]"}], "&"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"correctsourcesets", ",", "sourcesets"}], "}"}]}],
                   "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"everythingOK", "=!=", "True"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{
                  "\"\<ii=\>\"", ",", "ii", ",", 
                   "\"\< : There's a problem with the Pluckers! Some perfect \
matchings don't have the set dictated by the Plucker coordinate in which \
they're in!\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"pathmat", "=", 
               RowBox[{"pathMatrix", "[", 
                RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", 
                 RowBox[{"perfs", "[", 
                  RowBox[{"[", "jj", "]"}], "]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Simplify", "[", 
                  RowBox[{
                   RowBox[{"Simplify", "[", 
                    RowBox[{
                    RowBox[{"Minors", "[", 
                    RowBox[{"pathmat", ",", 
                    RowBox[{"Length", "[", "pathmat", "]"}]}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[Equal]", 
                   RowBox[{"pluckerCoordinates", "[", 
                    RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", 
                    RowBox[{"perfs", "[", 
                    RowBox[{"[", "jj", "]"}], "]"}], ",", "False"}], "]"}]}], 
                  "]"}], "=!=", "True"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{
                  "\"\<ii=\>\"", ",", "ii", ",", 
                   "\"\< : There's a problem with the Pluckers! When the \
final argument is set to False, its perfect matchings are not equal to those \
of pathMatrix\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Cmat", "=", 
               RowBox[{"grassmannianMatrix", "[", 
                RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", 
                 RowBox[{"perfs", "[", 
                  RowBox[{"[", "jj", "]"}], "]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Simplify", "[", 
                  RowBox[{
                   RowBox[{"Simplify", "[", 
                    RowBox[{
                    RowBox[{"Minors", "[", 
                    RowBox[{"Cmat", ",", 
                    RowBox[{"Length", "[", "Cmat", "]"}]}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[Equal]", 
                   RowBox[{"pluckerCoordinates", "[", 
                    RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", 
                    RowBox[{"perfs", "[", 
                    RowBox[{"[", "jj", "]"}], "]"}], ",", "True"}], "]"}]}], 
                  "]"}], "=!=", "True"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{
                  "\"\<ii=\>\"", ",", "ii", ",", 
                   "\"\< : There's a problem with the Pluckers! Its perfect \
matchings are not equal to those of grassmannianMatrix\>\""}], "]"}], ";"}]}],
                "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
            RowBox[{
            "(*", "\[IndentingNewLine]", "\[IndentingNewLine]", "*)"}], 
            "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<We have a dimer\>\"", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6652963913102765`*^9, 3.6652964111634235`*^9}, {
   3.6652964831092114`*^9, 3.6652966023124757`*^9}, {3.66529664190277*^9, 
   3.6652966537280664`*^9}, {3.665298600809763*^9, 3.665298603897441*^9}, 
   3.6652989561955156`*^9, {3.665312629329031*^9, 3.665312630447682*^9}, 
   3.665312701908943*^9, {3.6653131784809265`*^9, 3.665313184273444*^9}, {
   3.6653132144386053`*^9, 3.66531323782003*^9}, 3.666958676173853*^9, 
   3.6670475189929314`*^9, {3.667644926793663*^9, 3.6676449310397143`*^9}, {
   3.6678285134000173`*^9, 3.6678285181529455`*^9}, {3.671687117824498*^9, 
   3.671687118547721*^9}, {3.671687548490757*^9, 3.6716875493192406`*^9}, 
   3.6716878742841043`*^9, {3.6727466945904927`*^9, 3.6727467311971207`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "105"}],
  SequenceForm["ii=", 105],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.6652966546121216`*^9, 3.6652989561955156`*^9, 3.6653126352947063`*^9, {
   3.66531319596066*^9, 3.6653132393918023`*^9}, 3.666975663759903*^9, 
   3.6677191540327377`*^9, 3.6727467230809298`*^9}],

Cell[BoxData["\<\"We have a dimer\"\>"], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.6652966546121216`*^9, 3.6652989561955156`*^9, 3.6653126352947063`*^9, {
   3.66531319596066*^9, 3.6653132393918023`*^9}, 3.666975663759903*^9, 
   3.6677191540327377`*^9, 3.6727467230879345`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "106"}],
  SequenceForm["ii=", 106],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.6652966546121216`*^9, 3.6652989561955156`*^9, 3.6653126352947063`*^9, {
   3.66531319596066*^9, 3.6653132393918023`*^9}, 3.666975663759903*^9, 
   3.6677191540327377`*^9, 3.67274672309544*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "107"}],
  SequenceForm["ii=", 107],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.6652966546121216`*^9, 3.6652989561955156`*^9, 3.6653126352947063`*^9, {
   3.66531319596066*^9, 3.6653132393918023`*^9}, 3.666975663759903*^9, 
   3.6677191540327377`*^9, 3.6727467231029463`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "108"}],
  SequenceForm["ii=", 108],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.6652966546121216`*^9, 3.6652989561955156`*^9, 3.6653126352947063`*^9, {
   3.66531319596066*^9, 3.6653132393918023`*^9}, 3.666975663759903*^9, 
   3.6677191540327377`*^9, 3.6727467231094494`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    jj=\"\>", "\[InvisibleSpace]", "10"}],
  SequenceForm["    jj=", 10],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.6652966546121216`*^9, 3.6652989561955156`*^9, 3.6653126352947063`*^9, {
   3.66531319596066*^9, 3.6653132393918023`*^9}, 3.666975663759903*^9, 
   3.6677191540327377`*^9, 3.672746723579606*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "109"}],
  SequenceForm["ii=", 109],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.6652966546121216`*^9, 3.6652989561955156`*^9, 3.6653126352947063`*^9, {
   3.66531319596066*^9, 3.6653132393918023`*^9}, 3.666975663759903*^9, 
   3.6677191540327377`*^9, 3.672746724703507*^9}],

Cell[BoxData["\<\"We have a dimer\"\>"], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.6652966546121216`*^9, 3.6652989561955156`*^9, 3.6653126352947063`*^9, {
   3.66531319596066*^9, 3.6653132393918023`*^9}, 3.666975663759903*^9, 
   3.6677191540327377`*^9, 3.672746724710014*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "110"}],
  SequenceForm["ii=", 110],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.6652966546121216`*^9, 3.6652989561955156`*^9, 3.6653126352947063`*^9, {
   3.66531319596066*^9, 3.6653132393918023`*^9}, 3.666975663759903*^9, 
   3.6677191540327377`*^9, 3.6727467247175174`*^9}]
}, Closed]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6653075979929705`*^9, 3.665307598180479*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Here", " ", "we", " ", "check", " ", 
   "getOrderingExternalEdgesGrassmannian"}], "*)"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.6653076030813026`*^9, 3.6653083280341244`*^9, 
  3.6676535795146055`*^9, 3.671687818410305*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"formatrule", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["XX_", 
      RowBox[{"z1_", ",", "z2_"}]], "\[Rule]", 
     RowBox[{"XX", "[", 
      RowBox[{"z1", ",", "z2"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ii", "=", "100"}], ",", 
    RowBox[{"ii", "\[LessEqual]", "110"}], ",", 
    RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<ii=\>\"", ",", "ii"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Mod", "[", 
           RowBox[{"ii", ",", "10"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<ii=\>\"", ",", "ii"}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
     SubscriptBox["bft", "ii"], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"a", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b", "=", 
      RowBox[{"b", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"c", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"d", "=", 
      RowBox[{"d", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", "b", "]"}], ",", "c"}], "]"}], "]"}], "=!=",
         "0"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"perfs", "=", 
         RowBox[{"perfectMatchings", "[", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"srcs", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"getSourceNodes", "[", 
             RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "#"}], "]"}], 
            "&"}], ",", "perfs"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"snks", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"getSinkNodes", "[", 
             RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "#"}], "]"}], 
            "&"}], ",", "perfs"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"multiplic", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Tally", "[", "srcs", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"#", ",", "2"}], "]"}], "]"}], "&"}], ",", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Position", "[", 
                RowBox[{
                 RowBox[{"Tally", "[", "srcs", "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"#", ",", "_"}], "}"}]}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], "&"}], ",", "srcs"}], 
            "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"jj", "=", "1"}], ",", 
          RowBox[{"jj", "\[LessEqual]", 
           RowBox[{"Length", "[", "perfs", "]"}]}], ",", 
          RowBox[{"jj", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Mod", "[", 
               RowBox[{"jj", ",", "10"}], "]"}], "\[Equal]", "0"}], ",", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{"\"\<    jj=\>\"", ",", "jj"}], "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"multiplic", "[", 
               RowBox[{"[", "jj", "]"}], "]"}], "\[LessEqual]", "3"}], ",", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Cmatrix", "=", 
               RowBox[{"grassmannianMatrix", "[", 
                RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", 
                 RowBox[{"perfs", "[", 
                  RowBox[{"[", "jj", "]"}], "]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"Cmatrix", "=!=", "Null"}], ",", 
                "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"variablesmatrix", "=", 
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"Variables", "[", "#", "]"}], ",", 
                    RowBox[{"Variables", "[", 
                    RowBox[{"Join", "[", 
                    RowBox[{"b", ",", "c"}], "]"}], "]"}]}], "]"}], "&"}], 
                    ",", "Cmatrix", ",", 
                    RowBox[{"{", "2", "}"}]}], "]"}]}], ";", 
                 "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"And", "@@", 
                    RowBox[{"MapThread", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"#1", "===", 
                    RowBox[{"{", "}"}]}], "||", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"#1", ",", "#2"}], "]"}]}], "&"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"{", "input", "}"}], ",", 
                    RowBox[{"Block", "[", 
                    RowBox[{
                    RowBox[{"{", "output", "}"}], ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"input", "===", 
                    RowBox[{"{", "}"}]}], ",", 
                    RowBox[{
                    RowBox[{"output", "=", 
                    RowBox[{"{", "}"}]}], ";"}], ",", 
                    RowBox[{
                    RowBox[{"output", "=", 
                    RowBox[{"Intersection", "@@", "input"}]}], ";"}]}], "]"}],
                     ";", "output"}]}], "]"}]}], "]"}], "[", "#", "]"}], 
                    "&"}], ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", "}"}]}], "]"}], "&"}], ",", 
                    "variablesmatrix"}], "]"}]}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"Transpose", "[", "Cmatrix", "]"}], ",", 
                    RowBox[{"Alternatives", "@@", 
                    RowBox[{"IdentityMatrix", "[", 
                    RowBox[{"Length", "[", "Cmatrix", "]"}], "]"}]}]}], "]"}],
                     "]"}], "/.", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "\[Rule]", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "&"}], ",", 
                    RowBox[{"getOrderingExternalEdgesGrassmannian", "[", 
                    RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
                    "]"}]}]}], "}"}]}], "]"}]}], ")"}], "=!=", "True"}], "||", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"And", "@@", 
                    RowBox[{"MapThread", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"#1", "===", 
                    RowBox[{"{", "}"}]}], "||", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"#1", ",", "#2"}], "]"}]}], "&"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Intersection", "@@", "#"}], "&"}], ",", 
                    RowBox[{"Transpose", "[", "variablesmatrix", "]"}]}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"Dimensions", "[", "Cmatrix", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "/.", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "\[Rule]", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "&"}], ",", 
                    RowBox[{"getOrderingExternalEdgesGrassmannian", "[", 
                    RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
                    "]"}]}]}], "}"}]}], "]"}]}], ")"}], "=!=", "True"}]}], 
                   ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<jj=\>\"", ",", "jj", ",", 
                    "\"\< : There's a problem with the \
getOrderingExternalEdgesGrassmannian! It doesn't correspond to what the \
Grassmannian matrix has\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", 
                  "\[IndentingNewLine]", "]"}], ";"}]}], 
               "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6669587504692273`*^9, 3.666958784986063*^9}, {
   3.666958837936663*^9, 3.6669588572667584`*^9}, {3.666962590390283*^9, 
   3.666962722153494*^9}, {3.6669627707156515`*^9, 3.6669627738141737`*^9}, {
   3.6669629764667597`*^9, 3.6669629833508577`*^9}, 3.666963347713131*^9, 
   3.6669634268317456`*^9, {3.6669638504130955`*^9, 3.6669638573315744`*^9}, 
   3.6669651475331545`*^9, 3.667047520044245*^9, 3.6676467264196525`*^9, {
   3.6676481688675056`*^9, 3.667648181511022*^9}, {3.6676510766689444`*^9, 
   3.667651082276092*^9}, {3.667653581432604*^9, 3.667653583087921*^9}, {
   3.6678285685113344`*^9, 3.6678285708952513`*^9}, 3.671687119235262*^9, 
   3.6716871599775324`*^9, 3.671687550026947*^9, {3.6716878214152174`*^9, 
   3.671687823997912*^9}, {3.6727467395087614`*^9, 3.672746747290453*^9}, {
   3.679984533235066*^9, 3.6799845333600883`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "105"}],
  SequenceForm["ii=", 105],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.6677268410461216`*^9, 3.6677297771686864`*^9, 
  3.672746743087799*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "106"}],
  SequenceForm["ii=", 106],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.6677268410461216`*^9, 3.6677297771686864`*^9, 
  3.672746743094804*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "107"}],
  SequenceForm["ii=", 107],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.6677268410461216`*^9, 3.6677297771686864`*^9, 
  3.6727467431008167`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "108"}],
  SequenceForm["ii=", 108],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.6677268410461216`*^9, 3.6677297771686864`*^9, 
  3.672746743107318*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    jj=\"\>", "\[InvisibleSpace]", "10"}],
  SequenceForm["    jj=", 10],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.6677268410461216`*^9, 3.6677297771686864`*^9, 
  3.672746743110322*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "109"}],
  SequenceForm["ii=", 109],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.6677268410461216`*^9, 3.6677297771686864`*^9, 
  3.67274674315784*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "110"}],
  SequenceForm["ii=", 110],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.6677268410461216`*^9, 3.6677297771686864`*^9, 
  3.6727467431658444`*^9}]
}, Closed]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6672045061003823`*^9, 3.6672045062659173`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Here", " ", "we", " ", "check", " ", 
   "getOrderingExternalNodesGrassmannians"}], "*)"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.6653076030813026`*^9, 3.6653083280341244`*^9, {3.6672045128408937`*^9, 
   3.6672045182377415`*^9}, 3.6716878750185156`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"formatrule", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["XX_", 
      RowBox[{"z1_", ",", "z2_"}]], "\[Rule]", 
     RowBox[{"XX", "[", 
      RowBox[{"z1", ",", "z2"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ii", "=", "1"}], ",", 
    RowBox[{"ii", "\[LessEqual]", "110"}], ",", 
    RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<ii=\>\"", ",", "ii"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Mod", "[", 
           RowBox[{"ii", ",", "10"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<ii=\>\"", ",", "ii"}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
     SubscriptBox["bft", "ii"], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"a", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b", "=", 
      RowBox[{"b", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"c", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"d", "=", 
      RowBox[{"d", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", "b", "]"}], ",", "c"}], "]"}], "]"}], "=!=",
         "0"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"perfs", "=", 
         RowBox[{"perfectMatchings", "[", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"srcs", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"getSourceNodes", "[", 
             RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "#"}], "]"}], 
            "&"}], ",", "perfs"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"snks", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"getSinkNodes", "[", 
             RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "#"}], "]"}], 
            "&"}], ",", "perfs"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"multiplic", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Tally", "[", "srcs", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"#", ",", "2"}], "]"}], "]"}], "&"}], ",", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Position", "[", 
                RowBox[{
                 RowBox[{"Tally", "[", "srcs", "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"#", ",", "_"}], "}"}]}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], "&"}], ",", "srcs"}], 
            "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"jj", "=", "1"}], ",", 
          RowBox[{"jj", "\[LessEqual]", 
           RowBox[{"Length", "[", "perfs", "]"}]}], ",", 
          RowBox[{"jj", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Mod", "[", 
               RowBox[{"jj", ",", "10"}], "]"}], "\[Equal]", "0"}], ",", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{"\"\<    jj=\>\"", ",", "jj"}], "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"multiplic", "[", 
               RowBox[{"[", "jj", "]"}], "]"}], "\[LessEqual]", "3"}], ",", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Cmatrix", "=", 
               RowBox[{"grassmannianMatrix", "[", 
                RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", 
                 RowBox[{"perfs", "[", 
                  RowBox[{"[", "jj", "]"}], "]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"Cmatrix", "=!=", "Null"}], ",", 
                "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Sort", "[", 
                    RowBox[{
                    RowBox[{"getOrderingExternalNodesGrassmannian", "[", 
                    RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"Transpose", "[", "Cmatrix", "]"}], ",", 
                    RowBox[{"Alternatives", "@@", 
                    RowBox[{"IdentityMatrix", "[", 
                    RowBox[{"Length", "[", "Cmatrix", "]"}], "]"}]}]}], "]"}],
                     "]"}], "]"}], "]"}], "]"}], "=!=", 
                    RowBox[{"srcs", "[", 
                    RowBox[{"[", "jj", "]"}], "]"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<jj=\>\"", ",", "jj", ",", 
                    "\"\< : There's a problem with the \
getOrderingExternalNodesGrassmannian! It doesn't correspond with the source \
set of the Grassmannian\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
                 ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 RowBox[{"variablesmatrix", "=", 
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"Variables", "[", "#", "]"}], ",", 
                    RowBox[{"Variables", "[", 
                    RowBox[{"Join", "[", 
                    RowBox[{"b", ",", "c"}], "]"}], "]"}]}], "]"}], "&"}], 
                    ",", "Cmatrix", ",", 
                    RowBox[{"{", "2", "}"}]}], "]"}]}], ";", 
                 "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"And", "@@", 
                    RowBox[{"MapThread", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"#1", "===", 
                    RowBox[{"{", "}"}]}], "||", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"#1", ",", "#2"}], "]"}]}], "&"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"{", "input", "}"}], ",", 
                    RowBox[{"Block", "[", 
                    RowBox[{
                    RowBox[{"{", "output", "}"}], ",", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"input", "===", 
                    RowBox[{"{", "}"}]}], ",", 
                    RowBox[{
                    RowBox[{"output", "=", 
                    RowBox[{"{", "}"}]}], ";"}], ",", 
                    RowBox[{
                    RowBox[{"output", "=", 
                    RowBox[{"Intersection", "@@", "input"}]}], ";"}]}], "]"}],
                     ";", "output"}]}], "]"}]}], "]"}], "[", "#", "]"}], 
                    "&"}], ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", "}"}]}], "]"}], "&"}], ",", 
                    "variablesmatrix"}], "]"}]}], "]"}], "/.", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "\[Rule]", 
                    RowBox[{
                    RowBox[{"getExternalEdgeNodeNumbers", "[", 
                    RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", 
                    RowBox[{"{", "#", "}"}]}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "&"}], ",", 
                    RowBox[{"Variables", "[", 
                    RowBox[{"Join", "[", 
                    RowBox[{"b", ",", "c"}], "]"}], "]"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"getOrderingExternalNodesGrassmannian", "[", 
                    RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"Transpose", "[", "Cmatrix", "]"}], ",", 
                    RowBox[{"Alternatives", "@@", 
                    RowBox[{"IdentityMatrix", "[", 
                    RowBox[{"Length", "[", "Cmatrix", "]"}], "]"}]}]}], "]"}],
                     "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ")"}], "=!=", 
                    "True"}], "||", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"And", "@@", 
                    RowBox[{"MapThread", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"#1", "===", 
                    RowBox[{"{", "}"}]}], "||", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"#1", ",", "#2"}], "]"}]}], "&"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Intersection", "@@", "#"}], "&"}], ",", 
                    RowBox[{"Transpose", "[", "variablesmatrix", "]"}]}], 
                    "]"}], "/.", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "\[Rule]", 
                    RowBox[{
                    RowBox[{"getExternalEdgeNodeNumbers", "[", 
                    RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", 
                    RowBox[{"{", "#", "}"}]}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "&"}], ",", 
                    RowBox[{"Variables", "[", 
                    RowBox[{"Join", "[", 
                    RowBox[{"b", ",", "c"}], "]"}], "]"}]}], "]"}]}], ",", 
                    RowBox[{"getOrderingExternalNodesGrassmannian", "[", 
                    RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], 
                    "}"}]}], "]"}]}], ")"}], "=!=", "True"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<jj=\>\"", ",", "jj", ",", 
                    "\"\< : There's a problem with the \
getOrderingExternalEdgesGrassmannian! It doesn't correspond to what the \
Grassmannian matrix has\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", 
                  "\[IndentingNewLine]", "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6669587504692273`*^9, 3.666958784986063*^9}, {
   3.666958837936663*^9, 3.6669588572667584`*^9}, {3.666962590390283*^9, 
   3.666962722153494*^9}, {3.6669627707156515`*^9, 3.6669627738141737`*^9}, {
   3.6669629764667597`*^9, 3.6669629833508577`*^9}, 3.666963347713131*^9, 
   3.6669634268317456`*^9, {3.6669638504130955`*^9, 3.6669638573315744`*^9}, 
   3.6669651475331545`*^9, 3.667047520044245*^9, {3.667204214351387*^9, 
   3.6672042546640077`*^9}, 3.667204335626052*^9, {3.667204440776396*^9, 
   3.6672044754824395`*^9}, {3.667649607431472*^9, 3.667649613900576*^9}, {
   3.667651417474597*^9, 3.667651425607109*^9}, 3.667651468330411*^9, 
   3.667653583652979*^9, {3.6678286408996043`*^9, 3.6678286445597863`*^9}, 
   3.671687119797823*^9, 3.6716871604977655`*^9, {3.671687257008606*^9, 
   3.6716872577430525`*^9}, 3.6716875506101017`*^9, 3.671687824883033*^9, {
   3.671687875690426*^9, 3.671687877648266*^9}, {3.6727467555929065`*^9, 
   3.6727467724795427`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "105"}],
  SequenceForm["ii=", 105],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.6672042553446617`*^9, {3.667204477007663*^9, 3.6672045242003765`*^9}, 
   3.6677279472159185`*^9, 3.672746762610692*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "106"}],
  SequenceForm["ii=", 106],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.6672042553446617`*^9, {3.667204477007663*^9, 3.6672045242003765`*^9}, 
   3.6677279472159185`*^9, 3.672746762616696*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "107"}],
  SequenceForm["ii=", 107],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.6672042553446617`*^9, {3.667204477007663*^9, 3.6672045242003765`*^9}, 
   3.6677279472159185`*^9, 3.6727467626232*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "108"}],
  SequenceForm["ii=", 108],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.6672042553446617`*^9, {3.667204477007663*^9, 3.6672045242003765`*^9}, 
   3.6677279472159185`*^9, 3.672746762628704*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    jj=\"\>", "\[InvisibleSpace]", "10"}],
  SequenceForm["    jj=", 10],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.6672042553446617`*^9, {3.667204477007663*^9, 3.6672045242003765`*^9}, 
   3.6677279472159185`*^9, 3.672746762634708*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "109"}],
  SequenceForm["ii=", 109],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.6672042553446617`*^9, {3.667204477007663*^9, 3.6672045242003765`*^9}, 
   3.6677279472159185`*^9, 3.672746762669739*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "110"}],
  SequenceForm["ii=", 110],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.6672042553446617`*^9, {3.667204477007663*^9, 3.6672045242003765`*^9}, 
   3.6677279472159185`*^9, 3.672746762688298*^9}]
}, Closed]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.669623448419531*^9, 3.669623448616665*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Here", " ", "we", " ", "check", " ", "stratificationBoundaries"}],
    ",", " ", "stratificationNumbers", ",", " ", "stratificationEulerNumber", 
   ",", " ", 
   RowBox[{
    RowBox[{
    "stratificationGraph", ".", " ", "N", ".", "B", ".", " ", "THIS"}], " ", 
    "CELL", " ", "NEEDS", " ", "A", " ", "LOT", " ", "OF", " ", 
    RowBox[{
     RowBox[{"MEMORY", "!!"}], "!"}], " ", "YOU", " ", "WILL", " ", "ALSO", 
    " ", "NEED", " ", "MULTIPLE", " ", 
    RowBox[{"(", "FAST", ")"}], " ", "PROCESSORS"}], ",", " ", 
   RowBox[{
   "OTHERWISE", " ", "IT", " ", "WILL", " ", "TAKE", " ", "EVEN", " ", "A", 
    " ", "FULL", " ", "DAY", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"OR", " ", "MORE"}], ")"}], "."}]}]}], "*)"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.6653076030813026`*^9, 3.6653083280341244`*^9, 3.6676535795146055`*^9, {
   3.669623478197051*^9, 3.669623503511433*^9}, {3.6696236225555973`*^9, 
   3.6696237460838375`*^9}, 3.6716879859831944`*^9, 3.671688113306757*^9, 
   3.6716881635703287`*^9, 3.671688421670931*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CloseKernels", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LaunchKernels", "[", "4", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"formatrule", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["XX_", 
      RowBox[{"z1_", ",", "z2_"}]], "\[Rule]", 
     RowBox[{"XX", "[", 
      RowBox[{"z1", ",", "z2"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"allbfts", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"ii", "=", "1"}], ",", 
     RowBox[{"ii", "\[LessEqual]", "110"}], ",", 
     RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<ii=\>\"", ",", "ii"}], "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Mod", "[", 
           RowBox[{"ii", ",", "10"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<ii=\>\"", ",", "ii"}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["bft", "ii"], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"a", "=", 
       RowBox[{"a", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"b", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"c", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"d", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"allbfts", "=", 
       RowBox[{"Append", "[", 
        RowBox[{"allbfts", ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}]}], "]"}]}], 
      ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"testscattering", "[", 
     RowBox[{"{", 
      RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "}"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "dimP", ",", "iinum", ",", "scatteringstratification", ",", 
        "bft2stratification", ",", "bft1stratification", ",", 
        "scatteringnums", ",", "bft2nums", ",", "bft1nums", ",", 
        "scatteringeuler", ",", "bft2euler", ",", "bft1euler", ",", 
        "substratposscatter", ",", "substratposbft2", ",", "substratposbft1", 
        ",", "nodeorder", ",", "planarity", ",", "toZero", ",", "ilev", ",", 
        "shouldbelevel", ",", "levelshift", ",", "shouldbestratification", 
        ",", "checkStrats", ",", "scattersubstrats", ",", 
        "scatteringstratgraph", ",", "bft2stratgraph", ",", "bft1stratgraph", 
        ",", "scatteringadjmat", ",", "howmanydaughtersscattering", ",", 
        "fullsubstratposbft2", ",", "fullbft2substrats", ",", 
        "howmanydaughtersbft2", ",", "bft2adjmat", ",", "bft1substrats", ",", 
        "howmanydaughtersbft1", ",", "bft1adjmat", ",", "parentposscatter", 
        ",", "scatterparents", ",", "howmanyparentsscattering", ",", 
        "parentposbft2", ",", "bft2parents", ",", "howmanyparentsbft2", ",", 
        "parentposbft1", ",", "bft1parents", ",", "howmanyparentsbft1"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"iinum", "=", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"allbfts", ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}]}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Starting ii=\>\"", ",", "iinum"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"dimP", "=", 
        RowBox[{"dimensionPolytope", "[", 
         RowBox[{"matchingPolytope", "[", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"scatteringstratification", "=", 
        RowBox[{"stratificationBoundaries", "[", 
         RowBox[{
         "a", ",", "b", ",", "c", ",", "d", ",", "True", ",", "False", ",", 
          "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"bft2stratification", "=", 
        RowBox[{"stratificationBoundaries", "[", 
         RowBox[{
         "a", ",", "b", ",", "c", ",", "d", ",", "True", ",", "True", ",", 
          "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"bft1stratification", "=", 
        RowBox[{"stratificationBoundaries", "[", 
         RowBox[{
         "a", ",", "b", ",", "c", ",", "d", ",", "True", ",", "True", ",", 
          "1"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"scatteringnums", "=", 
        RowBox[{"stratificationNumbers", "[", 
         RowBox[{
         "a", ",", "b", ",", "c", ",", "d", ",", "True", ",", "False", ",", 
          "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"bft2nums", "=", 
        RowBox[{"stratificationNumbers", "[", 
         RowBox[{
         "a", ",", "b", ",", "c", ",", "d", ",", "True", ",", "True", ",", 
          "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"bft1nums", "=", 
        RowBox[{"stratificationNumbers", "[", 
         RowBox[{
         "a", ",", "b", ",", "c", ",", "d", ",", "True", ",", "True", ",", 
          "1"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"scatteringeuler", "=", 
        RowBox[{"stratificationEulerNumber", "[", 
         RowBox[{
         "a", ",", "b", ",", "c", ",", "d", ",", "True", ",", "False", ",", 
          "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"bft2euler", "=", 
        RowBox[{"stratificationEulerNumber", "[", 
         RowBox[{
         "a", ",", "b", ",", "c", ",", "d", ",", "True", ",", "True", ",", 
          "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"bft1euler", "=", 
        RowBox[{"stratificationEulerNumber", "[", 
         RowBox[{
         "a", ",", "b", ",", "c", ",", "d", ",", "True", ",", "True", ",", 
          "1"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", "scatteringstratification", "]"}], "=!=", 
           "List"}], "||", 
          RowBox[{"(", 
           RowBox[{"Or", "@@", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Head", "[", "#", "]"}], "=!=", "List"}], "&"}], ",", 
              "scatteringstratification"}], "]"}]}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<ii=\>\"", ",", "iinum", ",", 
            "\"\< : There's a problem with the scattering stratification! It \
doesn't output a list of lists\>\"", ",", "scatteringstratification"}], "]"}],
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", "bft2stratification", "]"}], "=!=", "List"}], 
          "||", 
          RowBox[{"(", 
           RowBox[{"Or", "@@", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Head", "[", "#", "]"}], "=!=", "List"}], "&"}], ",", 
              "bft2stratification"}], "]"}]}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<ii=\>\"", ",", "iinum", ",", 
            "\"\< : There's a problem with the gauging 2 stratification! It \
doesn't output a list of lists\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", "bft1stratification", "]"}], "=!=", "List"}], 
          "||", 
          RowBox[{"(", 
           RowBox[{"Or", "@@", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Head", "[", "#", "]"}], "=!=", "List"}], "&"}], ",", 
              "bft1stratification"}], "]"}]}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<ii=\>\"", ",", "iinum", ",", 
            "\"\< : There's a problem with the gauging 1 stratification! It \
doesn't output a list of lists\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{"Length", ",", "scatteringstratification"}], "]"}], "=!=",
            "scatteringnums"}], "||", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"-", "1"}], ")"}], 
               RowBox[{"ijk", "+", "1"}]], 
              RowBox[{"scatteringnums", "[", 
               RowBox[{"[", 
                RowBox[{"-", "ijk"}], "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"ijk", ",", 
               RowBox[{"Length", "[", "scatteringnums", "]"}]}], "}"}]}], 
            "]"}], "=!=", "scatteringeuler"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<ii=\>\"", ",", "iinum", ",", 
            "\"\< : There's a problem with the scattering stratification \
numbers! They aren't equal to the length of the stratification lists, or they \
don't give the expected Euler number.\>\""}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"Map", "[", 
            RowBox[{"Length", ",", "scatteringstratification"}], "]"}], "]"}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", "scatteringnums", "]"}]}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{"Length", ",", "bft2stratification"}], "]"}], "=!=", 
           "bft2nums"}], "||", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"-", "1"}], ")"}], 
               RowBox[{"ijk", "+", "1"}]], 
              RowBox[{"bft2nums", "[", 
               RowBox[{"[", 
                RowBox[{"-", "ijk"}], "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"ijk", ",", 
               RowBox[{"Length", "[", "bft2nums", "]"}]}], "}"}]}], "]"}], "=!=",
            "bft2euler"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<ii=\>\"", ",", "iinum", ",", 
            "\"\< : There's a problem with the gauging 2 stratification \
numbers! They aren't equal to the length of the stratification lists, or they \
don't give the expected Euler number.\>\""}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{"Length", ",", "bft1stratification"}], "]"}], "=!=", 
           "bft1nums"}], "||", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"-", "1"}], ")"}], 
               RowBox[{"ijk", "+", "1"}]], 
              RowBox[{"bft1nums", "[", 
               RowBox[{"[", 
                RowBox[{"-", "ijk"}], "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"ijk", ",", 
               RowBox[{"Length", "[", "bft1nums", "]"}]}], "}"}]}], "]"}], "=!=",
            "bft1euler"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<ii=\>\"", ",", "iinum", ",", 
            "\"\< : There's a problem with the scattering stratification \
numbers! They aren't equal to the length of the stratification lists, or they \
don't give the expected Euler number.\>\""}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"iinum", "\[NotEqual]", "104"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "scatteringstratification", "]"}], "=!=", 
             RowBox[{"dimP", "+", "1"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{
              "\"\<ii=\>\"", ",", "iinum", ",", 
               "\"\< : There's a problem with the scattering stratification! \
Its length is not equal to dim(P)+1\>\""}], "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "bft2stratification", "]"}], "=!=", 
             RowBox[{"dimP", "+", "1"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{
              "\"\<ii=\>\"", ",", "iinum", ",", 
               "\"\< : There's a problem with the gauging 2 stratification! \
Its length is not equal to dim(P)+1\>\""}], "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "bft1stratification", "]"}], "=!=", 
             RowBox[{"dimP", "+", "1"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{
              "\"\<ii=\>\"", ",", "iinum", ",", 
               "\"\< : There's a problem with the gauging 1 stratification! \
Its length is not equal to dim(P)+1\>\""}], "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"And", "@@", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Head", "[", "#", "]"}], "===", "Integer"}], "&&", 
                RowBox[{"#", "=!=", "0"}]}], ")"}], "&"}], ",", 
             RowBox[{"scatteringnums", "[", 
              RowBox[{"[", 
               RowBox[{"Flatten", "[", 
                RowBox[{"Position", "[", 
                 RowBox[{"scatteringnums", ",", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "\[NotEqual]", "0"}], "&"}], ")"}]}], ",", 
                  "1", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}], "]"}]}], "=!=",
           "True"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<ii=\>\"", ",", "iinum", ",", 
            "\"\< : There's a problem with the scattering stratification \
numbers! After initial zeroes, there should be a nonzero number\>\""}], "]"}],
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"And", "@@", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Head", "[", "#", "]"}], "===", "Integer"}], "&&", 
                RowBox[{"#", "=!=", "0"}]}], ")"}], "&"}], ",", 
             RowBox[{"bft2nums", "[", 
              RowBox[{"[", 
               RowBox[{"Flatten", "[", 
                RowBox[{"Position", "[", 
                 RowBox[{"bft2nums", ",", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "\[NotEqual]", "0"}], "&"}], ")"}]}], ",", 
                  "1", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}], "]"}]}], "=!=",
           "True"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<ii=\>\"", ",", "iinum", ",", 
            "\"\< : There's a problem with the scattering stratification \
numbers! After initial zeroes, there should be a nonzero number\>\""}], "]"}],
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"And", "@@", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Head", "[", "#", "]"}], "===", "Integer"}], "&&", 
                RowBox[{"#", "=!=", "0"}]}], ")"}], "&"}], ",", 
             RowBox[{"bft1nums", "[", 
              RowBox[{"[", 
               RowBox[{"Flatten", "[", 
                RowBox[{"Position", "[", 
                 RowBox[{"bft1nums", ",", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "\[NotEqual]", "0"}], "&"}], ")"}]}], ",", 
                  "1", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}], "]"}]}], "=!=",
           "True"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<ii=\>\"", ",", "iinum", ",", 
            "\"\< : There's a problem with the scattering stratification \
numbers! After initial zeroes, there should be a nonzero number\>\""}], "]"}],
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"substratposscatter", "=", 
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", "configuration", "}"}], ",", 
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Or", "@@", "#"}], "&"}], ",", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"SubsetQ", "[", 
                  RowBox[{"configuration", ",", "#"}], "]"}], "&"}], ",", 
                "scatteringstratification", ",", 
                RowBox[{"{", "3", "}"}]}], "]"}], ",", 
              RowBox[{"{", "2", "}"}]}], "]"}], ",", "True"}], "]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"nodeorder", "=", 
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", "configuration", "}"}], ",", 
          RowBox[{"getOrderingExternalNodesGrassmannian", "[", 
           RowBox[{
            RowBox[{"a", "/.", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "\[Rule]", "0"}], "&"}], ",", 
               RowBox[{"Complement", "[", 
                RowBox[{
                 RowBox[{"Variables", "[", 
                  RowBox[{"Join", "[", 
                   RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}], 
                 ",", "configuration"}], "]"}]}], "]"}]}], ",", 
            RowBox[{"b", "/.", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "\[Rule]", "0"}], "&"}], ",", 
               RowBox[{"Complement", "[", 
                RowBox[{
                 RowBox[{"Variables", "[", 
                  RowBox[{"Join", "[", 
                   RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}], 
                 ",", "configuration"}], "]"}]}], "]"}]}], ",", 
            RowBox[{"c", "/.", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "\[Rule]", "0"}], "&"}], ",", 
               RowBox[{"Complement", "[", 
                RowBox[{
                 RowBox[{"Variables", "[", 
                  RowBox[{"Join", "[", 
                   RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}], 
                 ",", "configuration"}], "]"}]}], "]"}]}], ",", "d"}], 
           "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"substratposbft2", "=", 
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", "configuration", "}"}], ",", 
          RowBox[{"Block", "[", 
           RowBox[{
            RowBox[{"{", "outtputt", "}"}], ",", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"planarityQ", "[", 
                RowBox[{
                 RowBox[{"a", "/.", 
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", "\[Rule]", "0"}], "&"}], ",", 
                    RowBox[{"Complement", "[", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    RowBox[{"Join", "[", 
                    RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}],
                     ",", "configuration"}], "]"}]}], "]"}]}], ",", 
                 RowBox[{"b", "/.", 
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", "\[Rule]", "0"}], "&"}], ",", 
                    RowBox[{"Complement", "[", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    RowBox[{"Join", "[", 
                    RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}],
                     ",", "configuration"}], "]"}]}], "]"}]}], ",", 
                 RowBox[{"c", "/.", 
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"#", "\[Rule]", "0"}], "&"}], ",", 
                    RowBox[{"Complement", "[", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    RowBox[{"Join", "[", 
                    RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}],
                     ",", "configuration"}], "]"}]}], "]"}]}], ",", "d"}], 
                "]"}], ",", 
               RowBox[{
                RowBox[{"outtputt", "=", 
                 RowBox[{"Position", "[", 
                  RowBox[{
                   RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Or", "@@", "#"}], "&"}], ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"SubsetQ", "[", 
                    RowBox[{"configuration", ",", "#"}], "]"}], "&"}], ",", 
                    "bft2stratification", ",", 
                    RowBox[{"{", "3", "}"}]}], "]"}], ",", 
                    RowBox[{"{", "2", "}"}]}], "]"}], ",", "True"}], "]"}]}], 
                ";"}], ",", 
               RowBox[{
                RowBox[{"outtputt", "=", 
                 RowBox[{"{", "I", "}"}]}], ";"}]}], "]"}], ";", 
             "outtputt"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"substratposbft1", "=", 
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", "configuration", "}"}], ",", 
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Or", "@@", "#"}], "&"}], ",", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"SubsetQ", "[", 
                  RowBox[{"configuration", ",", "#"}], "]"}], "&"}], ",", 
                "bft1stratification", ",", 
                RowBox[{"{", "3", "}"}]}], "]"}], ",", 
              RowBox[{"{", "2", "}"}]}], "]"}], ",", "True"}], "]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"scattersubstrats", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"substratposscatter", "[", "#", "]"}], "&"}], ",", 
          "scatteringstratification", ",", 
          RowBox[{"{", "3", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"And", "@@", 
            RowBox[{"Flatten", "[", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Equal", "@@", "#"}], "&"}], ",", "scattersubstrats", 
               ",", 
               RowBox[{"{", "2", "}"}]}], "]"}], "]"}]}], ")"}], "=!=", 
          "True"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<ii=\>\"", ",", "iinum", ",", 
            "\"\< : There's a problem with the scattering stratification! \
Move-equivalent boundaries should have the same subboundaries at all levels\>\
\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"For", " ", 
         SubscriptBox["BFT", "2"], " ", "we", " ", "can", " ", "only", " ", 
         "attempt", " ", "to", " ", "identify", " ", "according", " ", "to", 
         " ", "the", " ", "moduli", " ", "space", " ", "if", " ", "their", 
         " ", "external", " ", "nodes", " ", "can", " ", "be", " ", "placed", 
         " ", "in", " ", "the", " ", "same", " ", "order"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"And", "@@", 
            RowBox[{"Flatten", "[", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Equal", "@@", "#"}], "&"}], ",", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"substratposbft2", "[", "#", "]"}], "&"}], ",", 
                 RowBox[{"Map", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"GatherBy", "[", 
                    RowBox[{"#", ",", "nodeorder"}], "]"}], "&"}], ",", 
                   "bft2stratification", ",", 
                   RowBox[{"{", "2", "}"}]}], "]"}], ",", 
                 RowBox[{"{", "4", "}"}]}], "]"}], ",", 
               RowBox[{"{", "3", "}"}]}], "]"}], "]"}]}], ")"}], "=!=", 
          "True"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<ii=\>\"", ",", "iinum", ",", 
            "\"\< : There's a problem with the gauging 2 stratification! \
Move-equivalent boundaries should have the same subboundaries at all levels\>\
\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"planarity", "=", 
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", "configuration", "}"}], ",", 
          RowBox[{"planarityQ", "[", 
           RowBox[{
            RowBox[{"a", "/.", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "\[Rule]", "0"}], "&"}], ",", 
               RowBox[{"Complement", "[", 
                RowBox[{
                 RowBox[{"Variables", "[", 
                  RowBox[{"Join", "[", 
                   RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}], 
                 ",", "configuration"}], "]"}]}], "]"}]}], ",", 
            RowBox[{"b", "/.", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "\[Rule]", "0"}], "&"}], ",", 
               RowBox[{"Complement", "[", 
                RowBox[{
                 RowBox[{"Variables", "[", 
                  RowBox[{"Join", "[", 
                   RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}], 
                 ",", "configuration"}], "]"}]}], "]"}]}], ",", 
            RowBox[{"c", "/.", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "\[Rule]", "0"}], "&"}], ",", 
               RowBox[{"Complement", "[", 
                RowBox[{
                 RowBox[{"Variables", "[", 
                  RowBox[{"Join", "[", 
                   RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}], 
                 ",", "configuration"}], "]"}]}], "]"}]}], ",", "d"}], 
           "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Sum", "[", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], 
                    RowBox[{"kjk", "+", "1"}]], 
                   RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "kjk"}], "]"}], "]"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"kjk", ",", 
                    RowBox[{"Length", "[", "#", "]"}]}], "}"}]}], "]"}], 
                "&"}], ",", 
               RowBox[{"Map", "[", 
                RowBox[{"Length", ",", 
                 RowBox[{"Map", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"GatherBy", "[", 
                    RowBox[{
                    RowBox[{"substratposscatter", "[", "#", "]"}], ",", 
                    "First"}], "]"}], "&"}], ",", "scatteringstratification", 
                   ",", 
                   RowBox[{"{", "3", "}"}]}], "]"}], ",", 
                 RowBox[{"{", "4", "}"}]}], "]"}], ",", 
               RowBox[{"{", "3", "}"}]}], "]"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"Position", "[", 
               RowBox[{
                RowBox[{"Flatten", "[", 
                 RowBox[{"Map", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"planarity", "[", "#", "]"}], "&"}], ",", 
                   "scatteringstratification", ",", 
                   RowBox[{"{", "3", "}"}]}], "]"}], "]"}], ",", "True"}], 
               "]"}], "]"}], "]"}], "]"}], ",", 
           RowBox[{"zz_", "/;", 
            RowBox[{"zz", "=!=", "1"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<ii=\>\"", ",", "iinum", ",", 
            "\"\< : There's a problem with planarity! Some elements in the \
stratification are declared to be planar but do not have an Eulerian \
substratification!\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"iinum", "\[NotEqual]", "104"}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"toZero", "=", 
           RowBox[{"Function", "[", 
            RowBox[{
             RowBox[{"{", "listofedges", "}"}], ",", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "\[Rule]", "0"}], "&"}], ",", "listofedges"}], 
              "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"ilev", "=", "0"}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"shouldbelevel", "[", "ilev", "]"}], "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Sequence", "@@", "#"}], "&"}], ",", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Complement", "[", 
                 RowBox[{
                  RowBox[{"Variables", "[", 
                   RowBox[{"Join", "[", 
                    RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}],
                   ",", "#"}], "]"}], "&"}], ",", 
               RowBox[{
                RowBox[{"Cases", "[", 
                 RowBox[{"scatteringstratification", ",", 
                  RowBox[{"Except", "[", 
                   RowBox[{"{", "}"}], "]"}]}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"levelshift", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Position", "[", 
              RowBox[{"scatteringstratification", ",", 
               RowBox[{"_", "?", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"#", "\[NotEqual]", 
                   RowBox[{"{", "}"}]}], "&"}], ")"}]}], ",", "1", ",", "1"}],
               "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], "-", "1"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"ilev", "=", "1"}], ",", 
            RowBox[{"ilev", "\[LessEqual]", 
             RowBox[{"dimP", "-", "levelshift"}]}], ",", 
            RowBox[{"ilev", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"shouldbelevel", "[", "ilev", "]"}], "=", 
              RowBox[{"DeleteDuplicates", "[", 
               RowBox[{"MapThread", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"list1", ",", "list2"}], "}"}], ",", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sort", "[", 
                    RowBox[{"Join", "[", 
                    RowBox[{"#", ",", "list2"}], "]"}], "]"}], "&"}], ",", 
                    "list1"}], "]"}]}]}], "]"}], "[", 
                   RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"removableEdges", "[", 
                    RowBox[{
                    RowBox[{"a", "/.", 
                    RowBox[{"toZero", "[", "#", "]"}]}], ",", 
                    RowBox[{"b", "/.", 
                    RowBox[{"toZero", "[", "#", "]"}]}], ",", 
                    RowBox[{"c", "/.", 
                    RowBox[{"toZero", "[", "#", "]"}]}], ",", "d", ",", 
                    "True", ",", "False", ",", "2"}], "]"}], "&"}], ",", 
                    RowBox[{"shouldbelevel", "[", 
                    RowBox[{"ilev", "-", "1"}], "]"}]}], "]"}], ",", 
                   RowBox[{"shouldbelevel", "[", 
                    RowBox[{"ilev", "-", "1"}], "]"}]}], "}"}]}], "]"}], 
               "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"shouldbestratification", "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Complement", "[", 
               RowBox[{
                RowBox[{"Variables", "[", 
                 RowBox[{"Join", "[", 
                  RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}], 
                ",", "#"}], "]"}], "&"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"shouldbelevel", "[", "jjj", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"jjj", ",", "0", ",", 
                 RowBox[{"dimP", "-", "levelshift"}]}], "}"}]}], "]"}], ",", 
             RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"checkStrats", "=", 
           RowBox[{"Function", "[", 
            RowBox[{
             RowBox[{"{", "levelnumtocheck", "}"}], ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"And", "@@", 
                 RowBox[{"Map", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sequence", "@@", "#"}], "&"}], ",", 
                    RowBox[{"scatteringstratification", "[", 
                    RowBox[{"[", 
                    RowBox[{"levelnumtocheck", "+", "levelshift"}], "]"}], 
                    "]"}]}], "]"}], ",", "#"}], "]"}], "&"}], ",", 
                   RowBox[{"shouldbestratification", "[", 
                    RowBox[{"[", "levelnumtocheck", "]"}], "]"}]}], "]"}]}], 
                ")"}], "&&", 
               RowBox[{"(", 
                RowBox[{"And", "@@", 
                 RowBox[{"Map", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"shouldbestratification", "[", 
                    RowBox[{"[", "levelnumtocheck", "]"}], "]"}], ",", 
                    RowBox[{"Alternatives", "@@", "#"}]}], "]"}], "&"}], ",", 
                   RowBox[{"scatteringstratification", "[", 
                    RowBox[{"[", 
                    RowBox[{"levelnumtocheck", "+", "levelshift"}], "]"}], 
                    "]"}]}], "]"}]}], ")"}]}], ")"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"And", "@@", 
               RowBox[{"Map", "[", 
                RowBox[{"checkStrats", ",", 
                 RowBox[{"Range", "[", 
                  RowBox[{"dimP", "-", "levelshift", "+", "1"}], "]"}]}], 
                "]"}]}], ")"}], "=!=", "True"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{
              "\"\<ii=\>\"", ",", "iinum", ",", 
               "\"\< : There's a problem with the scattering stratification! \
It doesn't correspond to the stratification obtained by removing removable \
edges\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"scatteringstratgraph", "=", 
        RowBox[{"stratificationGraph", "[", 
         RowBox[{
         "a", ",", "b", ",", "c", ",", "d", ",", "True", ",", "False", ",", 
          "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"bft2stratgraph", "=", 
        RowBox[{"stratificationGraph", "[", 
         RowBox[{
         "a", ",", "b", ",", "c", ",", "d", ",", "True", ",", "True", ",", 
          "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"bft1stratgraph", "=", 
        RowBox[{"stratificationGraph", "[", 
         RowBox[{
         "a", ",", "b", ",", "c", ",", "d", ",", "True", ",", "True", ",", 
          "1"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"iinum", "\[NotEqual]", "104"}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"scatteringadjmat", "=", 
           RowBox[{"Normal", "[", 
            RowBox[{"AdjacencyMatrix", "[", "scatteringstratgraph", "]"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"howmanydaughtersscattering", "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"Cases", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", "1"}], ",", 
                   "_"}], "}"}]}], "]"}], "]"}], "&"}], ",", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Union", "@@", "#"}], "&"}], ",", "scattersubstrats", 
               ",", 
               RowBox[{"{", "2", "}"}]}], "]"}], ",", 
             RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Flatten", "[", "howmanydaughtersscattering", "]"}], "=!=", 
             RowBox[{"Map", "[", 
              RowBox[{"Total", ",", "scatteringadjmat"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{
              "\"\<ii=\>\"", ",", "iinum", ",", 
               "\"\< : There's a problem with the scattering stratification \
graph! The numbers of daughters of elements in the stratification doesn't \
match those using SubsetQ\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"fullsubstratposbft2", "=", 
           RowBox[{"Function", "[", 
            RowBox[{
             RowBox[{"{", "configuration", "}"}], ",", 
             RowBox[{"Position", "[", 
              RowBox[{
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Or", "@@", "#"}], "&"}], ",", 
                 RowBox[{"Map", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"SubsetQ", "[", 
                    RowBox[{"configuration", ",", "#"}], "]"}], "&"}], ",", 
                   "bft2stratification", ",", 
                   RowBox[{"{", "3", "}"}]}], "]"}], ",", 
                 RowBox[{"{", "2", "}"}]}], "]"}], ",", "True"}], "]"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"fullbft2substrats", "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"fullsubstratposbft2", "[", "#", "]"}], "&"}], ",", 
             "bft2stratification", ",", 
             RowBox[{"{", "3", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"howmanydaughtersbft2", "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"Cases", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", "1"}], ",", 
                   "_"}], "}"}]}], "]"}], "]"}], "&"}], ",", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Union", "@@", "#"}], "&"}], ",", "fullbft2substrats",
                ",", 
               RowBox[{"{", "2", "}"}]}], "]"}], ",", 
             RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"bft2adjmat", "=", 
           RowBox[{"Normal", "[", 
            RowBox[{"AdjacencyMatrix", "[", "bft2stratgraph", "]"}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Flatten", "[", "howmanydaughtersbft2", "]"}], "=!=", 
             RowBox[{"Map", "[", 
              RowBox[{"Total", ",", "bft2adjmat"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{
              "\"\<ii=\>\"", ",", "iinum", ",", 
               
               "\"\< : There's a problem with the gauging 2 stratification \
graph! The numbers of daughters of elements in the stratification doesn't \
match those using SubsetQ\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"bft1substrats", "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"substratposbft1", "[", "#", "]"}], "&"}], ",", 
             "bft1stratification", ",", 
             RowBox[{"{", "3", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"howmanydaughtersbft1", "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"Cases", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", "1"}], ",", 
                   "_"}], "}"}]}], "]"}], "]"}], "&"}], ",", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Union", "@@", "#"}], "&"}], ",", "bft1substrats", 
               ",", 
               RowBox[{"{", "2", "}"}]}], "]"}], ",", 
             RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"bft1adjmat", "=", 
           RowBox[{"Normal", "[", 
            RowBox[{"AdjacencyMatrix", "[", "bft1stratgraph", "]"}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Flatten", "[", "howmanydaughtersbft1", "]"}], "=!=", 
             RowBox[{"Map", "[", 
              RowBox[{"Total", ",", "bft1adjmat"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{
              "\"\<ii=\>\"", ",", "iinum", ",", 
               "\"\< : There's a problem with the gauging 1 stratification \
graph! The numbers of daughters of elements in the stratification doesn't \
match those using SubsetQ\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"parentposscatter", "=", 
           RowBox[{"Function", "[", 
            RowBox[{
             RowBox[{"{", "configuration", "}"}], ",", 
             RowBox[{"Position", "[", 
              RowBox[{
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Or", "@@", "#"}], "&"}], ",", 
                 RowBox[{"Map", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"SubsetQ", "[", 
                    RowBox[{"#", ",", "configuration"}], "]"}], "&"}], ",", 
                   "scatteringstratification", ",", 
                   RowBox[{"{", "3", "}"}]}], "]"}], ",", 
                 RowBox[{"{", "2", "}"}]}], "]"}], ",", "True"}], "]"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"scatterparents", "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"parentposscatter", "[", "#", "]"}], "&"}], ",", 
             "scatteringstratification", ",", 
             RowBox[{"{", "3", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"howmanyparentsscattering", "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"Cases", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"Last", "[", "#", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", "1"}], ",", "_"}], 
                  "}"}]}], "]"}], "]"}], "&"}], ",", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Union", "@@", "#"}], "&"}], ",", "scatterparents", 
               ",", 
               RowBox[{"{", "2", "}"}]}], "]"}], ",", 
             RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Flatten", "[", "howmanyparentsscattering", "]"}], "=!=", 
             RowBox[{"Map", "[", 
              RowBox[{"Total", ",", 
               RowBox[{"Transpose", "[", "scatteringadjmat", "]"}]}], "]"}]}],
             ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{
              "\"\<ii=\>\"", ",", "iinum", ",", 
               "\"\< : There's a problem with the scattering stratification \
graph! The numbers of parents of elements in the stratification doesn't match \
those using SubsetQ\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"parentposbft2", "=", 
           RowBox[{"Function", "[", 
            RowBox[{
             RowBox[{"{", "configuration", "}"}], ",", 
             RowBox[{"Position", "[", 
              RowBox[{
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Or", "@@", "#"}], "&"}], ",", 
                 RowBox[{"Map", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"SubsetQ", "[", 
                    RowBox[{"#", ",", "configuration"}], "]"}], "&"}], ",", 
                   "bft2stratification", ",", 
                   RowBox[{"{", "3", "}"}]}], "]"}], ",", 
                 RowBox[{"{", "2", "}"}]}], "]"}], ",", "True"}], "]"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"bft2parents", "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"parentposbft2", "[", "#", "]"}], "&"}], ",", 
             "bft2stratification", ",", 
             RowBox[{"{", "3", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"howmanyparentsbft2", "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"Cases", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"Last", "[", "#", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", "1"}], ",", "_"}], 
                  "}"}]}], "]"}], "]"}], "&"}], ",", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Union", "@@", "#"}], "&"}], ",", "bft2parents", ",", 
               RowBox[{"{", "2", "}"}]}], "]"}], ",", 
             RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Flatten", "[", "howmanyparentsbft2", "]"}], "=!=", 
             RowBox[{"Map", "[", 
              RowBox[{"Total", ",", 
               RowBox[{"Transpose", "[", "bft2adjmat", "]"}]}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{
              "\"\<ii=\>\"", ",", "iinum", ",", 
               "\"\< : There's a problem with the gauging 2 stratification \
graph! The numbers of parents of elements in the stratification doesn't match \
those using SubsetQ\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"parentposbft1", "=", 
           RowBox[{"Function", "[", 
            RowBox[{
             RowBox[{"{", "configuration", "}"}], ",", 
             RowBox[{"Position", "[", 
              RowBox[{
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Or", "@@", "#"}], "&"}], ",", 
                 RowBox[{"Map", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"SubsetQ", "[", 
                    RowBox[{"#", ",", "configuration"}], "]"}], "&"}], ",", 
                   "bft1stratification", ",", 
                   RowBox[{"{", "3", "}"}]}], "]"}], ",", 
                 RowBox[{"{", "2", "}"}]}], "]"}], ",", "True"}], "]"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"bft1parents", "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"parentposbft1", "[", "#", "]"}], "&"}], ",", 
             "bft1stratification", ",", 
             RowBox[{"{", "3", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"howmanyparentsbft1", "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"Cases", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"Last", "[", "#", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", "1"}], ",", "_"}], 
                  "}"}]}], "]"}], "]"}], "&"}], ",", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Union", "@@", "#"}], "&"}], ",", "bft1parents", ",", 
               RowBox[{"{", "2", "}"}]}], "]"}], ",", 
             RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Flatten", "[", "howmanyparentsbft1", "]"}], "=!=", 
             RowBox[{"Map", "[", 
              RowBox[{"Total", ",", 
               RowBox[{"Transpose", "[", "bft1adjmat", "]"}]}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{
              "\"\<ii=\>\"", ",", "iinum", ",", 
               "\"\< : There's a problem with the gauging 2 stratification \
graph! The numbers of parents of elements in the stratification doesn't match \
those using SubsetQ\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
          ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<ii=\>\"", ",", "iinum", ",", "\"\<: Complete\>\""}], 
        "]"}], ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}],
    ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DistributeDefinitions", "[", "allbfts", "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"DistributeDefinitions", "[", 
     RowBox[{
     "stratificationBoundaries", ",", "stratificationNumbers", ",", 
      "stratificationEulerNumber", ",", "dimensionPolytope", ",", 
      "matchingPolytope", ",", "getOrderingExternalNodesGrassmannian", ",", 
      "planarityQ", ",", "removableEdges", ",", "matchingPolytopeBoundaries", 
      ",", "stratificationGraph", ",", "matchingPolytopeBoundariesGraph"}], 
     "]"}], ";"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ParallelNeeds", "[", "\"\<bipartiteSUSY`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DistributeDefinitions", "[", "testscattering", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dontdothese", "=", 
   RowBox[{"{", 
    RowBox[{
    "26", ",", "33", ",", "50", ",", "51", ",", "79", ",", "106", ",", "107", 
     ",", "110"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"longtimers", "=", 
   RowBox[{"{", 
    RowBox[{
    "30", ",", "32", ",", "39", ",", "40", ",", "52", ",", "53", ",", "61", 
     ",", "94"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fornowdontdothese", "=", 
   RowBox[{"{", 
    RowBox[{"13", ",", "44", ",", "46", ",", "74", ",", "80", ",", "92"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dothese", "=", 
   RowBox[{"Complement", "[", 
    RowBox[{
     RowBox[{"Range", "[", "110", "]"}], ",", "dontdothese", ",", 
     "longtimers", ",", "fornowdontdothese"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ParallelMap", "[", 
   RowBox[{"testscattering", ",", 
    RowBox[{"allbfts", "[", 
     RowBox[{"[", "dothese", "]"}], "]"}]}], "]"}], ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.6696235746380396`*^9, {3.669623610098814*^9, 3.6696236195405407`*^9}, 
   3.669623753127334*^9, {3.669624024457741*^9, 3.66962405078391*^9}, {
   3.669624089402275*^9, 3.6696241247859883`*^9}, 3.670128948154625*^9, {
   3.671354490317777*^9, 3.6713545334757743`*^9}, {3.671543692885229*^9, 
   3.671543695724641*^9}, {3.6715453740500803`*^9, 3.671545374954458*^9}, {
   3.6716878784813905`*^9, 3.67168787932522*^9}, {3.671687991043371*^9, 
   3.6716880013068056`*^9}, {3.671688114244274*^9, 3.6716881160510674`*^9}, {
   3.6716881646328835`*^9, 3.671688168115918*^9}, 3.6716882269304934`*^9, 
   3.671688372664858*^9, {3.6716884225399275`*^9, 3.671688424845953*^9}, {
   3.6727469921053867`*^9, 3.672747005897662*^9}, {3.6727470472858286`*^9, 
   3.6727470607872653`*^9}, {3.672747101083252*^9, 3.672747103626311*^9}, {
   3.6727473781301117`*^9, 3.6727473785439763`*^9}}]
}, Closed]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6696240634972453`*^9, 3.6696240637414074`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Here", " ", "we", " ", "check", " ", "matchingPolytopeBoundaries", " ", 
   "and", " ", 
   RowBox[{
   "matchingPolytopeBoundariesGraph", ".", " ", "N", ".", "B", ".", " ", 
    "THIS"}], " ", "CELL", " ", "NEEDS", " ", "A", " ", "LOT", " ", "OF", " ", 
   RowBox[{
    RowBox[{"MEMORY", "!!"}], "!"}], " ", "YOU", " ", "WILL", " ", "ALSO", 
   " ", "NEED", " ", "MULTIPLE", " ", 
   RowBox[{"(", "FAST", ")"}], " ", "PROCESSORS", " ", "OTHERWISE", " ", "IT",
    " ", "WILL", " ", "TAKE", " ", "EVEN", " ", "A", " ", "FULL", " ", "DAY", 
   " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"OR", " ", "MORE"}], ")"}], "."}]}], "*)"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.6653076030813026`*^9, 3.6653083280341244`*^9, 3.6676535795146055`*^9, {
   3.669623478197051*^9, 3.669623503511433*^9}, {3.6696236225555973`*^9, 
   3.6696237460838375`*^9}, 3.671688005707094*^9, 3.6716881168167305`*^9, 
   3.671688168881587*^9, 3.671688425995242*^9, {3.672747206025862*^9, 
   3.672747262564996*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CloseKernels", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LaunchKernels", "[", "4", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"formatrule", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["XX_", 
      RowBox[{"z1_", ",", "z2_"}]], "\[Rule]", 
     RowBox[{"XX", "[", 
      RowBox[{"z1", ",", "z2"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"allbfts", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"ii", "=", "1"}], ",", 
     RowBox[{"ii", "\[LessEqual]", "110"}], ",", 
     RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<ii=\>\"", ",", "ii"}], "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Mod", "[", 
           RowBox[{"ii", ",", "10"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<ii=\>\"", ",", "ii"}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["bft", "ii"], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"a", "=", 
       RowBox[{"a", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"b", "=", 
       RowBox[{"b", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"c", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"d", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"allbfts", "=", 
       RowBox[{"Append", "[", 
        RowBox[{"allbfts", ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}]}], "]"}]}], 
      ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"testfacelatt", "[", 
     RowBox[{"{", 
      RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "}"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "iinum", ",", "scatteringfacelatt", ",", "bftfacelatt", ",", "allvars",
         ",", "allthedimensions", ",", "areyouEulerian", ",", 
        "facelattgraphscatter", ",", "facelattgraphbft", ",", 
        "scatteringadjmat", ",", "findFaceLattsubstrats", ",", 
        "facelattsubstrats", ",", "howmanydaughters", ",", 
        "findFaceLattparents", ",", "facelattparents", ",", 
        "howmanyparents"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"iinum", "=", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"allbfts", ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}]}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Starting ii=\>\"", ",", "iinum"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"scatteringfacelatt", "=", 
        RowBox[{"matchingPolytopeBoundaries", "[", 
         RowBox[{
         "a", ",", "b", ",", "c", ",", "d", ",", "True", ",", "False"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"bftfacelatt", "=", 
        RowBox[{"matchingPolytopeBoundaries", "[", 
         RowBox[{
         "a", ",", "b", ",", "c", ",", "d", ",", "True", ",", "True"}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"allvars", "=", 
        RowBox[{"Variables", "[", 
         RowBox[{"Join", "[", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"scatteringfacelatt", "=!=", "bftfacelatt"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<ii=\>\"", ",", "iinum", ",", 
            "\"\< : There's a problem with the face lattice! It's not \
identical for BFT and scattering!\>\""}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"allthedimensions", "=", 
        RowBox[{"Map", "[", 
         RowBox[{"DeleteDuplicates", ",", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"dimensionPolytope", "[", 
              RowBox[{"matchingPolytope", "[", 
               RowBox[{
                RowBox[{"a", "/.", "#"}], ",", 
                RowBox[{"b", "/.", "#"}], ",", 
                RowBox[{"c", "/.", "#"}], ",", "d"}], "]"}], "]"}], "&"}], 
            ",", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "\[Rule]", "0"}], "&"}], ",", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Complement", "[", 
                  RowBox[{"allvars", ",", "#"}], "]"}], "&"}], ",", 
                "scatteringfacelatt", ",", 
                RowBox[{"{", "2", "}"}]}], "]"}], ",", 
              RowBox[{"{", "3", "}"}]}], "]"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"allthedimensions", "=!=", 
          RowBox[{"Reverse", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", "iii", "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"iii", ",", "0", ",", 
               RowBox[{"dimensionPolytope", "[", 
                RowBox[{"matchingPolytope", "[", 
                 RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}]}], 
              "}"}]}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<ii=\>\"", ",", "iinum", ",", 
            "\"\< : There's a problem with the face lattice! The dimensions \
of all the boundaries are not all correct!\>\""}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"areyouEulerian", "=", 
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", "configuration", "}"}], ",", 
          RowBox[{"Block", "[", 
           RowBox[{
            RowBox[{"{", "thestratnums", "}"}], ",", 
            RowBox[{
             RowBox[{"thestratnums", "=", 
              RowBox[{"Map", "[", 
               RowBox[{"Length", ",", 
                RowBox[{"GatherBy", "[", 
                 RowBox[{
                  RowBox[{"Position", "[", 
                   RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"SubsetQ", "[", 
                    RowBox[{"configuration", ",", "#"}], "]"}], "&"}], ",", 
                    "scatteringfacelatt", ",", 
                    RowBox[{"{", "2", "}"}]}], "]"}], ",", "True"}], "]"}], 
                  ",", "First"}], "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Sum", "[", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], 
                   RowBox[{"kji", "+", "1"}]], 
                  RowBox[{"thestratnums", "[", 
                   RowBox[{"[", 
                    RowBox[{"-", "kji"}], "]"}], "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"kji", ",", 
                   RowBox[{"Length", "[", "thestratnums", "]"}]}], "}"}]}], 
                "]"}], "===", "1"}], ")"}]}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"And", "@@", 
            RowBox[{"Flatten", "[", 
             RowBox[{"Map", "[", 
              RowBox[{"areyouEulerian", ",", "scatteringfacelatt", ",", 
               RowBox[{"{", "2", "}"}]}], "]"}], "]"}]}], ")"}], "=!=", 
          "True"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<ii=\>\"", ",", "iinum", ",", 
            "\"\< : There's a problem with the face lattice! There are \
elements in the stratification which do not have an Eulerian \
substratification\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"facelattgraphscatter", "=", 
        RowBox[{"matchingPolytopeBoundariesGraph", "[", 
         RowBox[{
         "a", ",", "b", ",", "c", ",", "d", ",", "True", ",", "False"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"facelattgraphbft", "=", 
        RowBox[{"matchingPolytopeBoundariesGraph", "[", 
         RowBox[{
         "a", ",", "b", ",", "c", ",", "d", ",", "True", ",", "True"}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"facelattgraphscatter", "=!=", "facelattgraphbft"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<ii=\>\"", ",", "iinum", ",", 
            "\"\< : There's a problem with the face lattice graphs! They are \
not identical for BFT and scattering!\>\""}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"iinum", "\[NotEqual]", "104"}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"scatteringadjmat", "=", 
           RowBox[{"Normal", "[", 
            RowBox[{"AdjacencyMatrix", "[", "facelattgraphscatter", "]"}], 
            "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"findFaceLattsubstrats", "=", 
           RowBox[{"Function", "[", 
            RowBox[{
             RowBox[{"{", "configuration", "}"}], ",", 
             RowBox[{"Position", "[", 
              RowBox[{
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"SubsetQ", "[", 
                   RowBox[{"configuration", ",", "#"}], "]"}], "&"}], ",", 
                 "scatteringfacelatt", ",", 
                 RowBox[{"{", "2", "}"}]}], "]"}], ",", "True"}], "]"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"facelattsubstrats", "=", 
           RowBox[{"Map", "[", 
            RowBox[{"findFaceLattsubstrats", ",", "scatteringfacelatt", ",", 
             RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"howmanydaughters", "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"Cases", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "+", "1"}], ",", 
                   "_"}], "}"}]}], "]"}], "]"}], "&"}], ",", 
             "facelattsubstrats", ",", 
             RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Flatten", "[", "howmanydaughters", "]"}], "=!=", 
             RowBox[{"Map", "[", 
              RowBox[{"Total", ",", "scatteringadjmat"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{
              "\"\<ii=\>\"", ",", "iinum", ",", 
               "\"\< : There's a problem with the face lattice graph! The \
numbers of daughters of elements in the stratification doesn't match those \
using SubsetQ\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"findFaceLattparents", "=", 
           RowBox[{"Function", "[", 
            RowBox[{
             RowBox[{"{", "configuration", "}"}], ",", 
             RowBox[{"Position", "[", 
              RowBox[{
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"SubsetQ", "[", 
                   RowBox[{"#", ",", "configuration"}], "]"}], "&"}], ",", 
                 "scatteringfacelatt", ",", 
                 RowBox[{"{", "2", "}"}]}], "]"}], ",", "True"}], "]"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"facelattparents", "=", 
           RowBox[{"Map", "[", 
            RowBox[{"findFaceLattparents", ",", "scatteringfacelatt", ",", 
             RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"howmanyparents", "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"Cases", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"Last", "[", "#", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", "1"}], ",", "_"}], 
                  "}"}]}], "]"}], "]"}], "&"}], ",", "facelattparents", ",", 
             RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Flatten", "[", "howmanyparents", "]"}], "=!=", 
             RowBox[{"Map", "[", 
              RowBox[{"Total", ",", 
               RowBox[{"Transpose", "[", "scatteringadjmat", "]"}]}], "]"}]}],
             ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{
              "\"\<ii=\>\"", ",", "iinum", ",", 
               "\"\< : There's a problem with the face lattice graph! The \
numbers of parents of elements in the stratification doesn't match those \
using SubsetQ\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<ii=\>\"", ",", "iinum", ",", "\"\<: Complete\>\""}], 
        "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DistributeDefinitions", "[", "allbfts", "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"DistributeDefinitions", "[", 
     RowBox[{
     "stratificationBoundaries", ",", "stratificationNumbers", ",", 
      "stratificationEulerNumber", ",", "dimensionPolytope", ",", 
      "matchingPolytope", ",", "getOrderingExternalNodesGrassmannian", ",", 
      "planarityQ", ",", "removableEdges", ",", "matchingPolytopeBoundaries", 
      ",", "stratificationGraph", ",", "matchingPolytopeBoundariesGraph"}], 
     "]"}], ";"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ParallelNeeds", "[", "\"\<bipartiteSUSY`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DistributeDefinitions", "[", "testfacelatt", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dontdothese", "=", 
   RowBox[{"{", 
    RowBox[{"26", ",", "33", ",", "50", ",", "51", ",", "79"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"longtimers", "=", 
   RowBox[{"{", 
    RowBox[{
    "30", ",", "32", ",", "39", ",", "40", ",", "52", ",", "53", ",", "61", 
     ",", "94"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fornowdontdothese", "=", 
   RowBox[{"{", 
    RowBox[{
    "10", ",", "12", ",", "13", ",", "25", ",", "28", ",", "29", ",", "38", 
     ",", "43", ",", "44", ",", "45", ",", "46", ",", "47", ",", "62", ",", 
     "74", ",", "75", ",", "76", ",", "80", ",", "84", ",", "85", ",", "86", 
     ",", "90", ",", "92", ",", "93", ",", "95"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dothese", "=", 
   RowBox[{"Complement", "[", 
    RowBox[{
     RowBox[{"Range", "[", "110", "]"}], ",", "dontdothese", ",", 
     "longtimers", ",", "fornowdontdothese"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ParallelMap", "[", 
   RowBox[{"testfacelatt", ",", 
    RowBox[{"allbfts", "[", 
     RowBox[{"[", "dothese", "]"}], "]"}]}], "]"}], ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.6696235746380396`*^9, {3.669623610098814*^9, 3.6696236195405407`*^9}, 
   3.669623753127334*^9, {3.669624024457741*^9, 3.66962405078391*^9}, {
   3.669624089402275*^9, 3.669624196840247*^9}, 3.670128952783026*^9, {
   3.6713545531510944`*^9, 3.671354554129074*^9}, {3.671543696440907*^9, 
   3.6715436981667433`*^9}, {3.671545375573363*^9, 3.6715453769101715`*^9}, 
   3.6716878799033804`*^9, 3.6716880122924223`*^9, 3.6716881174930162`*^9, 
   3.671688169808852*^9, {3.6716882300801964`*^9, 3.6716882341328135`*^9}, {
   3.6716883736336694`*^9, 3.67168837583547*^9}, 3.671688426859222*^9, {
   3.6727471228866405`*^9, 3.672747160332713*^9}, {3.6727472759149194`*^9, 
   3.672747283495224*^9}, {3.672747357274368*^9, 3.6727473616076565`*^9}}]
}, Closed]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6697024289667234`*^9, 3.669702429154849*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Here", " ", "we", " ", "check", " ", "nonTrivialPoles"}], 
  "*)"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.6653076030813026`*^9, 3.6653083280341244`*^9, {3.6672045128408937`*^9, 
   3.6672045182377415`*^9}, {3.669702432603629*^9, 3.6697024522585335`*^9}, {
   3.669988787058058*^9, 3.669988787417477*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CloseKernels", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LaunchKernels", "[", "4", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DistributeDefinitions", "[", 
   RowBox[{
   "pathMatrix", ",", "pluckerRelations", ",", "nonPluckerPolesQ", ",", 
    "planarityQ"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DistributeDefinitions", "[", "nonTrivialPoles", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"formatrule", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["XX_", 
      RowBox[{"z1_", ",", "z2_"}]], "\[Rule]", 
     RowBox[{"XX", "[", 
      RowBox[{"z1", ",", "z2"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ii", "=", "1"}], ",", 
    RowBox[{"ii", "\[LessEqual]", "110"}], ",", 
    RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<ii=\>\"", ",", "ii"}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ii", "\[NotEqual]", "13"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "26"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "30"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "32"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "33"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "39"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "40"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "44"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "46"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "50"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "51"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "52"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "53"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "61"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "74"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "79"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "80"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "92"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "94"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "106"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "107"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "110"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        SubscriptBox["bft", "ii"], ";", "\[IndentingNewLine]", 
        RowBox[{"a", "=", 
         RowBox[{"a", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"b", "=", 
         RowBox[{"b", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"c", "=", 
         RowBox[{"c", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"d", "=", 
         RowBox[{"d", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"topleft", "=", "a"}], ";", "\[IndentingNewLine]", 
        RowBox[{"topright", "=", "b"}], ";", "\[IndentingNewLine]", 
        RowBox[{"bottomleft", "=", "c"}], ";", "\[IndentingNewLine]", 
        RowBox[{"bottomright", "=", "d"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "c", "]"}], "+", 
            RowBox[{
             RowBox[{"Dimensions", "[", "b", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ">", "0"}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"stratification", "=", 
            RowBox[{"stratificationBoundaries", "[", 
             RowBox[{
             "topleft", ",", "topright", ",", "bottomleft", ",", 
              "bottomright"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"allvars", "=", 
            RowBox[{"Variables", "[", 
             RowBox[{"Join", "[", 
              RowBox[{
              "topleft", ",", "topright", ",", "bottomleft", ",", 
               "bottomright"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"tozerostratification", "=", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "\[Rule]", "0"}], "&"}], ",", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Complement", "[", 
                  RowBox[{"allvars", ",", "#"}], "]"}], "&"}], ",", 
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", 
                  "stratification", ",", 
                  RowBox[{"{", "2", "}"}]}], "]"}], ",", 
                RowBox[{"{", "2", "}"}]}], "]"}], ",", 
              RowBox[{"{", "3", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
           "DistributeDefinitions", "[", "tozerostratification", "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"maxrelationsize", "=", "3"}], ";", "\[IndentingNewLine]", 
           RowBox[{"secretrelationstratification", "=", 
            RowBox[{"ParallelMap", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"nonTrivialPoles", "[", 
                RowBox[{
                 RowBox[{"topleft", "/.", "#"}], ",", 
                 RowBox[{"topright", "/.", "#"}], ",", 
                 RowBox[{"bottomleft", "/.", "#"}], ",", "bottomright", ",", 
                 "maxrelationsize"}], "]"}], "&"}], ",", 
              "tozerostratification", ",", 
              RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"nonpluckerpoles", "=", 
            RowBox[{"ParallelMap", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"nonPluckerPolesQ", "[", 
                RowBox[{
                 RowBox[{"topleft", "/.", "#"}], ",", 
                 RowBox[{"topright", "/.", "#"}], ",", 
                 RowBox[{"bottomleft", "/.", "#"}], ",", "bottomright"}], 
                "]"}], "&"}], ",", "tozerostratification", ",", 
              RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"areyourparentsOK", "=", 
            RowBox[{"Function", "[", 
             RowBox[{
              RowBox[{"{", "positiontocheck", "}"}], ",", 
              RowBox[{"And", "@@", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"secretrelationstratification", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"positiontocheck", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", "1"}], ",", "#"}], 
                    "]"}], "]"}], "=!=", 
                    RowBox[{"{", 
                    RowBox[{"{", "}"}], "}"}]}], "||", 
                   RowBox[{"nonpluckerpoles", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"positiontocheck", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", "1"}], ",", "#"}], 
                    "]"}], "]"}]}], "&"}], ",", 
                 RowBox[{"Map", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", 
                   RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"stratification", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"positiontocheck", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", "1"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"Alternatives", "@@", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Riffle", "[", 
                    RowBox[{"#", ",", "___", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}], ",", "2"}], "}"}]}], "]"}], "&"}], 
                    ",", 
                    RowBox[{"stratification", "[", 
                    RowBox[{"[", 
                    RowBox[{"Sequence", "@@", "positiontocheck"}], "]"}], 
                    "]"}]}], "]"}]}]}], "]"}]}], "]"}]}], "]"}]}]}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"And", "@@", 
                RowBox[{"Map", "[", 
                 RowBox[{"areyourparentsOK", ",", 
                  RowBox[{"DeleteCases", "[", 
                   RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{"secretrelationstratification", ",", 
                    RowBox[{"Except", "[", 
                    RowBox[{"{", 
                    RowBox[{"{", "}"}], "}"}], "]"}], ",", "2"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"_", ",", "0"}], "}"}], "|", 
                    RowBox[{"{", "_", "}"}]}]}], "]"}]}], "]"}]}], ")"}], "=!=",
               "True"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<ii=\>\"", ",", "ii", ",", 
                "\"\< : There's a problem with nonTrivialPoles! Some \
boundaries with nonTrivial relations seem have arisen from higher-dim parents \
that do not have non-trivial relations, and do not have a \
nonPluckerPole.\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"ii", "\[NotEqual]", "104"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"currentK", "=", 
               RowBox[{"Length", "[", 
                RowBox[{"getSourceNodes", "[", 
                 RowBox[{
                 "topleft", ",", "topright", ",", "bottomleft", ",", 
                  "bottomright", ",", 
                  RowBox[{
                   RowBox[{"perfectMatchings", "[", 
                    RowBox[{
                    "topleft", ",", "topright", ",", "bottomleft", ",", 
                    "bottomright"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"currentN", "=", 
               RowBox[{
                RowBox[{"Length", "[", "bottomleft", "]"}], "+", 
                RowBox[{
                 RowBox[{"Dimensions", "[", "topright", "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"allminors", "=", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"HoldForm", "[", "minor", "]"}], "[", 
                   RowBox[{"Sequence", "@@", "#"}], "]"}], "&"}], ",", 
                 RowBox[{"Subsets", "[", 
                  RowBox[{
                   RowBox[{"Range", "[", "currentN", "]"}], ",", 
                   RowBox[{"{", "currentK", "}"}]}], "]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"topdimminorstoexpressions", "=", 
               RowBox[{"MapThread", "[", 
                RowBox[{"Rule", ",", 
                 RowBox[{"{", 
                  RowBox[{"allminors", ",", 
                   RowBox[{"minorsAsPerfectMatchings", "[", 
                    RowBox[{
                    "topleft", ",", "topright", ",", "bottomleft", ",", 
                    "bottomright"}], "]"}]}], "}"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"secretrelationstratification", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "=!=", 
                 RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"topdimsecretrelations", "=", 
                  RowBox[{"secretrelationstratification", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}], 
                "\[IndentingNewLine]", ",", 
                RowBox[{
                 RowBox[{"topdimsecretrelations", "=", 
                  RowBox[{"{", 
                   RowBox[{"{", "}"}], "}"}]}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"istherelationAccurate", "=", 
               RowBox[{"Function", "[", 
                RowBox[{
                 RowBox[{"{", "positiontocheck", "}"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Block", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    "alltherelationstocheck", ",", 
                    "currentminorstoexpressions", ",", "return"}], "}"}], ",",
                    "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"alltherelationstocheck", "=", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"Alternatives", "@@", 
                    RowBox[{
                    "Flatten", "[", "topdimsecretrelations", "]"}]}]}], "]"}],
                     "&"}], ",", 
                    RowBox[{"secretrelationstratification", "[", 
                    RowBox[{"[", 
                    RowBox[{"Sequence", "@@", "positiontocheck"}], "]"}], 
                    "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"currentminorstoexpressions", "=", 
                    RowBox[{"MapThread", "[", 
                    RowBox[{"Rule", ",", 
                    RowBox[{"{", 
                    RowBox[{"allminors", ",", 
                    RowBox[{"minorsAsPerfectMatchings", "[", 
                    RowBox[{
                    RowBox[{"topleft", "/.", 
                    RowBox[{"tozerostratification", "[", 
                    RowBox[{"[", 
                    RowBox[{"Sequence", "@@", "positiontocheck"}], "]"}], 
                    "]"}]}], ",", 
                    RowBox[{"topright", "/.", 
                    RowBox[{"tozerostratification", "[", 
                    RowBox[{"[", 
                    RowBox[{"Sequence", "@@", "positiontocheck"}], "]"}], 
                    "]"}]}], ",", 
                    RowBox[{"bottomleft", "/.", 
                    RowBox[{"tozerostratification", "[", 
                    RowBox[{"[", 
                    RowBox[{"Sequence", "@@", "positiontocheck"}], "]"}], 
                    "]"}]}], ",", "bottomright"}], "]"}]}], "}"}]}], "]"}]}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"return", "=", 
                    RowBox[{"And", "@@", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Simplify", "[", 
                    RowBox[{"#", "/.", "topdimminorstoexpressions"}], "]"}], "=!=",
                     "True"}], "&&", 
                    RowBox[{
                    RowBox[{"Simplify", "[", 
                    RowBox[{"#", "/.", "currentminorstoexpressions"}], "]"}], 
                    "===", "True"}]}], "&"}], ",", "alltherelationstocheck"}],
                     "]"}]}]}], ";", "\[IndentingNewLine]", "return"}]}], 
                  "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"And", "@@", 
                   RowBox[{"Map", "[", 
                    RowBox[{"istherelationAccurate", ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{"secretrelationstratification", ",", 
                    RowBox[{"Except", "[", 
                    RowBox[{"{", 
                    RowBox[{"{", "}"}], "}"}], "]"}], ",", "2"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"_", ",", "0"}], "}"}], "|", 
                    RowBox[{"{", "_", "}"}], "|", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "_"}], "}"}]}]}], "]"}]}], "]"}]}], 
                  ")"}], "=!=", "True"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{
                  "\"\<ii=\>\"", ",", "ii", ",", 
                   "\"\< : There's a problem with nonTrivialPoles! The new \
relations that have arisen when taking the boundary seem to either not be \
true (when plugging in minorsAsPerfectMatchings), or seem to also be obeyed \
by the top-dimensional element, even though they aren't listed there.\>\""}], 
                  "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"areyouIndepOfPluckerRels", "=", 
            RowBox[{"Function", "[", 
             RowBox[{
              RowBox[{"{", "positiontocheck", "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Block", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "alltherelationstocheck", ",", "zerominors", ",", 
                  "genericmatrix", ",", "nonzerominor", ",", "thesols", ",", 
                  "solutiontoshuttingoffminors", ",", "genericminors", ",", 
                  "currentminorrule", ",", "return"}], "}"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"alltherelationstocheck", "=", 
                  RowBox[{"Flatten", "[", 
                   RowBox[{"secretrelationstratification", "[", 
                    RowBox[{"[", 
                    RowBox[{"Sequence", "@@", "positiontocheck"}], "]"}], 
                    "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"zerominors", "=", 
                  RowBox[{"Flatten", "[", 
                   RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"minorsAsPerfectMatchings", "[", 
                    RowBox[{
                    RowBox[{"topleft", "/.", 
                    RowBox[{"tozerostratification", "[", 
                    RowBox[{"[", 
                    RowBox[{"Sequence", "@@", "positiontocheck"}], "]"}], 
                    "]"}]}], ",", 
                    RowBox[{"topright", "/.", 
                    RowBox[{"tozerostratification", "[", 
                    RowBox[{"[", 
                    RowBox[{"Sequence", "@@", "positiontocheck"}], "]"}], 
                    "]"}]}], ",", 
                    RowBox[{"bottomleft", "/.", 
                    RowBox[{"tozerostratification", "[", 
                    RowBox[{"[", 
                    RowBox[{"Sequence", "@@", "positiontocheck"}], "]"}], 
                    "]"}]}], ",", "bottomright"}], "]"}], ",", "0"}], "]"}], 
                   "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"genericmatrix", "=", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    SubscriptBox["entry", 
                    RowBox[{"iii", ",", "jjj"}]], ",", 
                    RowBox[{"{", 
                    RowBox[{"iii", ",", "currentK"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"jjj", ",", "currentN"}], "}"}]}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"nonzerominor", "=", 
                  RowBox[{"List", "@@", 
                   RowBox[{"allminors", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Complement", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "[", "allminors", "]"}], "]"}], ",", 
                    "zerominors"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"genericmatrix", "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "nonzerominor"}], "]"}], "]"}], "=", 
                  RowBox[{"IdentityMatrix", "[", "currentK", "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"thesols", "=", 
                  RowBox[{"Solve", "[", 
                   RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "\[Equal]", "0"}], "&"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Minors", "[", 
                    RowBox[{"genericmatrix", ",", "currentK"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "zerominors", "]"}], "]"}]}], "]"}], "]"}]}],
                  ";", "\[IndentingNewLine]", 
                 RowBox[{"solutiontoshuttingoffminors", "=", 
                  RowBox[{
                   RowBox[{"Cases", "[", 
                    RowBox[{"thesols", ",", 
                    RowBox[{"zz_", "/;", 
                    RowBox[{
                    RowBox[{"Length", "[", "zz", "]"}], "\[Equal]", 
                    RowBox[{"Min", "[", 
                    RowBox[{"Map", "[", 
                    RowBox[{"Length", ",", "thesols"}], "]"}], "]"}]}]}]}], 
                    "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"genericminors", "=", 
                  RowBox[{"Simplify", "[", 
                   RowBox[{
                    RowBox[{"Minors", "[", 
                    RowBox[{
                    RowBox[{
                    "genericmatrix", "/.", "solutiontoshuttingoffminors"}], 
                    ",", "currentK"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"currentminorrule", "=", 
                  RowBox[{"MapThread", "[", 
                   RowBox[{"Rule", ",", 
                    RowBox[{"{", 
                    RowBox[{"allminors", ",", "genericminors"}], "}"}]}], 
                   "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"return", "=", 
                  RowBox[{"And", "@@", 
                   RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Simplify", "[", 
                    RowBox[{"#", "/.", "currentminorrule"}], "]"}], "=!=", 
                    "True"}], "&"}], ",", "alltherelationstocheck"}], 
                    "]"}]}]}], ";", "\[IndentingNewLine]", "return"}]}], 
               "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"And", "@@", 
                RowBox[{"Map", "[", 
                 RowBox[{"areyouIndepOfPluckerRels", ",", 
                  RowBox[{"DeleteCases", "[", 
                   RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{"secretrelationstratification", ",", 
                    RowBox[{"Except", "[", 
                    RowBox[{"{", 
                    RowBox[{"{", "}"}], "}"}], "]"}], ",", "2"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"_", ",", "0"}], "}"}], "|", 
                    RowBox[{"{", "_", "}"}]}]}], "]"}]}], "]"}]}], ")"}], "=!=",
               "True"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<ii=\>\"", ",", "ii", ",", 
                "\"\< : There's a problem with nonTrivialPoles! For some \
boundaries, the nonPlucker relations in reality follow from the Plucker \
relations!\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6669587504692273`*^9, 3.666958784986063*^9}, {
   3.666958837936663*^9, 3.6669588572667584`*^9}, {3.666962590390283*^9, 
   3.666962722153494*^9}, {3.6669627707156515`*^9, 3.6669627738141737`*^9}, {
   3.6669629764667597`*^9, 3.6669629833508577`*^9}, 3.666963347713131*^9, 
   3.6669634268317456`*^9, {3.6669638504130955`*^9, 3.6669638573315744`*^9}, 
   3.6669651475331545`*^9, 3.667047520044245*^9, {3.667204214351387*^9, 
   3.6672042546640077`*^9}, 3.667204335626052*^9, {3.667204440776396*^9, 
   3.6672044754824395`*^9}, {3.667649607431472*^9, 3.667649613900576*^9}, {
   3.667651417474597*^9, 3.667651425607109*^9}, 3.667651468330411*^9, 
   3.667653583652979*^9, {3.6678286408996043`*^9, 3.6678286445597863`*^9}, {
   3.669702466905157*^9, 3.669702704679533*^9}, {3.6697027396856337`*^9, 
   3.6697028824256625`*^9}, {3.669970155630158*^9, 3.6699703133001523`*^9}, {
   3.6699706134668484`*^9, 3.6699706150382566`*^9}, {3.6699709717834496`*^9, 
   3.6699709981789527`*^9}, {3.669971073460086*^9, 3.6699711216941786`*^9}, 
   3.671687120490718*^9, 3.671688017091853*^9, {3.6727468016299295`*^9, 
   3.672746803878687*^9}, {3.6727468874582*^9, 3.672746898675997*^9}, 
   3.6727469809682875`*^9, {3.6727474034142246`*^9, 3.672747403500537*^9}, 
   3.672747574546322*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "105"}],
  SequenceForm["ii=", 105],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.6672042553446617`*^9, {3.667204477007663*^9, 3.6672045242003765`*^9}, 
   3.6677279472159185`*^9, 3.6699710890426807`*^9, 3.669971149340295*^9, 
   3.6727468258415546`*^9, 3.6727469172135296`*^9, 3.672747423085863*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "106"}],
  SequenceForm["ii=", 106],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.6672042553446617`*^9, {3.667204477007663*^9, 3.6672045242003765`*^9}, 
   3.6677279472159185`*^9, 3.6699710890426807`*^9, 3.669971149340295*^9, 
   3.6727468258415546`*^9, 3.6727469172135296`*^9, 3.6727474231049967`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "107"}],
  SequenceForm["ii=", 107],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.6672042553446617`*^9, {3.667204477007663*^9, 3.6672045242003765`*^9}, 
   3.6677279472159185`*^9, 3.6699710890426807`*^9, 3.669971149340295*^9, 
   3.6727468258415546`*^9, 3.6727469172135296`*^9, 3.6727474231075025`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "108"}],
  SequenceForm["ii=", 108],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.6672042553446617`*^9, {3.667204477007663*^9, 3.6672045242003765`*^9}, 
   3.6677279472159185`*^9, 3.6699710890426807`*^9, 3.669971149340295*^9, 
   3.6727468258415546`*^9, 3.6727469172135296`*^9, 3.6727474231075025`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "109"}],
  SequenceForm["ii=", 109],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.6672042553446617`*^9, {3.667204477007663*^9, 3.6672045242003765`*^9}, 
   3.6677279472159185`*^9, 3.6699710890426807`*^9, 3.669971149340295*^9, 
   3.6727468258415546`*^9, 3.6727469172135296`*^9, 3.6727474254729843`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "110"}],
  SequenceForm["ii=", 110],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.6672042553446617`*^9, {3.667204477007663*^9, 3.6672045242003765`*^9}, 
   3.6677279472159185`*^9, 3.6699710890426807`*^9, 3.669971149340295*^9, 
   3.6727468258415546`*^9, 3.6727469172135296`*^9, 3.6727474254779863`*^9}]
}, Closed]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.669623448419531*^9, 3.669623448616665*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Here", " ", "we", " ", "check", " ", "collapseBivalentNodes"}], 
  "*)"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6647893950303826`*^9, 3.6647894076633363`*^9}, {
   3.667049585039831*^9, 3.667049586467121*^9}, {3.67023348873209*^9, 
   3.67023349002195*^9}, 3.67091001914213*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"collapseWhiteNodesInternalInternalNEW", "=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "inputtopleft", ",", "inputtopright", ",", "inputbottomleft", ",", 
       "inputbottomright"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "kasteleyn", ",", "reducedkasteleyn", ",", "outputtopleft", ",", 
         "outputtopright", ",", "outputbottomleft", ",", "outputbottomright", 
         ",", "bottomrightrownum", ",", "bottomrightcolnum"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "outputtopleft", ",", "outputtopright", ",", "outputbottomleft", 
           ",", "outputbottomright"}], "}"}], "=", 
         RowBox[{"{", 
          RowBox[{
          "inputtopleft", ",", "inputtopright", ",", "inputbottomleft", ",", 
           "inputbottomright"}], "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "outputtopleft", "]"}], ">", "0"}], "||", 
           RowBox[{
            RowBox[{"Length", "[", "outputtopright", "]"}], ">", "0"}]}], ",", 
          RowBox[{"(*", 
           RowBox[{
           "we", " ", "have", " ", "internal", " ", "white", " ", "nodes", 
            " ", 
            RowBox[{"(", 
             RowBox[{
             "which", " ", "could", " ", "potentially", " ", "be", " ", 
              "bivalent"}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"kasteleyn", "=", 
            RowBox[{"joinupKasteleyn", "[", 
             RowBox[{
             "inputtopleft", ",", "inputtopright", ",", "inputbottomleft", 
              ",", "inputbottomright"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"reducedkasteleyn", "=", 
            RowBox[{"(", 
             RowBox[{"kasteleyn", "//.", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"rowsbefore___", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"firstzeros", ":", 
                    RowBox[{"0", "..."}]}], ",", 
                   RowBox[{"Except", "[", 
                    RowBox[{
                    RowBox[{"0", "|", 
                    RowBox[{"somedge1_", "+", "anotheredge1_", "+", "___"}]}],
                     ",", "firstedge_"}], "]"}], ",", 
                   RowBox[{"secondzeros", ":", 
                    RowBox[{"0", "..."}]}], ",", 
                   RowBox[{"Except", "[", 
                    RowBox[{
                    RowBox[{"0", "|", 
                    RowBox[{"somedge2_", "+", "anotheredge2_", "+", "___"}]}],
                     ",", "secondedge_"}], "]"}], ",", 
                   RowBox[{"thirdzeros", ":", 
                    RowBox[{"0", "..."}]}], ",", 
                   RowBox[{"Sequence", "@@", 
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{
                    RowBox[{"Dimensions", "[", "inputtopright", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}], "}"}], ",", 
                 "rowsafter___"}], "}"}], "\[RuleDelayed]", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"rowsbefore", ",", "rowsafter"}], "}"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "[", 
                    RowBox[{"{", "firstzeros", "}"}], "]"}], "]"}], ",", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"{", "firstzeros", "}"}], "]"}], "+", "2"}], ",", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"{", 
                    RowBox[{"firstzeros", ",", "secondzeros"}], "}"}], "]"}], 
                    "+", "1"}]}], "]"}], ",", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"{", 
                    RowBox[{"firstzeros", ",", "secondzeros"}], "}"}], "]"}], 
                    "+", "3"}], ",", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "firstzeros", ",", "secondzeros", ",", "thirdzeros"}], 
                    "}"}], "]"}], "+", "2"}]}], "]"}]}], "]"}]}], "]"}], 
                  "]"}], ",", 
                 RowBox[{"Map", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Total", "[", "#", "]"}], "}"}], "&"}], ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"rowsbefore", ",", "rowsafter"}], "}"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"{", "firstzeros", "}"}], "]"}], "+", "1"}], ",", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"{", 
                    RowBox[{"firstzeros", ",", "secondzeros"}], "}"}], "]"}], 
                    "+", "2"}]}], "}"}]}], "]"}], "]"}]}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"rowsbefore", ",", "rowsafter"}], "}"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "firstzeros", ",", "secondzeros", ",", "thirdzeros"}], 
                    "}"}], "]"}], "+", "3"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"rowsbefore", ",", "rowsafter"}], "}"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}], "]"}], 
                  "]"}], ",", "2"}], "]"}]}]}], ")"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"bottomrightrownum", "=", 
            RowBox[{"Length", "[", "inputbottomright", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"bottomrightcolnum", "=", 
            RowBox[{
             RowBox[{"Dimensions", "[", 
              RowBox[{"Join", "[", 
               RowBox[{"inputtopright", ",", "inputbottomright"}], "]"}], 
              "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"outputtopleft", "=", 
            RowBox[{"reducedkasteleyn", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{";;", 
                RowBox[{"-", 
                 RowBox[{"(", 
                  RowBox[{"bottomrightrownum", "+", "1"}], ")"}]}]}], ",", 
               RowBox[{";;", 
                RowBox[{"-", 
                 RowBox[{"(", 
                  RowBox[{"bottomrightcolnum", "+", "1"}], ")"}]}]}]}], "]"}],
              "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"outputtopright", "=", 
            RowBox[{"reducedkasteleyn", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{";;", 
                RowBox[{"-", 
                 RowBox[{"(", 
                  RowBox[{"bottomrightrownum", "+", "1"}], ")"}]}]}], ",", 
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"(", "bottomrightcolnum", ")"}]}], ";;"}]}], "]"}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"outputbottomleft", "=", 
            RowBox[{"reducedkasteleyn", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"(", "bottomrightrownum", ")"}]}], ";;"}], ",", 
               RowBox[{";;", 
                RowBox[{"-", 
                 RowBox[{"(", 
                  RowBox[{"bottomrightcolnum", "+", "1"}], ")"}]}]}]}], "]"}],
              "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"outputbottomright", "=", 
            RowBox[{"reducedkasteleyn", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"(", "bottomrightrownum", ")"}]}], ";;"}], ",", 
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"(", "bottomrightcolnum", ")"}]}], ";;"}]}], "]"}], 
             "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
         "outputtopleft", ",", "outputtopright", ",", "outputbottomleft", ",",
           "outputbottomright"}], "}"}]}]}], "]"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"collapseBlackNodesInternalInternalNEW", "=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "inputtopleft", ",", "inputtopright", ",", "inputbottomleft", ",", 
       "inputbottomright"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "transposekasteleyn", ",", "reducedkasteleyn", ",", "outputtopleft", 
         ",", "outputtopright", ",", "outputbottomleft", ",", 
         "outputbottomright", ",", "bottomrightrownum", ",", 
         "bottomrightcolnum"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "outputtopleft", ",", "outputtopright", ",", "outputbottomleft", 
           ",", "outputbottomright"}], "}"}], "=", 
         RowBox[{"{", 
          RowBox[{
          "inputtopleft", ",", "inputtopright", ",", "inputbottomleft", ",", 
           "inputbottomright"}], "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Dimensions", "[", 
             RowBox[{"Join", "[", 
              RowBox[{"inputtopleft", ",", "inputbottomleft"}], "]"}], "]"}], 
            "[", 
            RowBox[{"[", "2", "]"}], "]"}], ">", "0"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"transposekasteleyn", "=", 
            RowBox[{"Transpose", "[", 
             RowBox[{"joinupKasteleyn", "[", 
              RowBox[{
              "inputtopleft", ",", "inputtopright", ",", "inputbottomleft", 
               ",", "inputbottomright"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"reducedkasteleyn", "=", 
            RowBox[{"(", 
             RowBox[{"transposekasteleyn", "//.", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"rowsbefore___", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"firstzeros", ":", 
                    RowBox[{"0", "..."}]}], ",", 
                   RowBox[{"Except", "[", 
                    RowBox[{
                    RowBox[{"0", "|", 
                    RowBox[{"somedge1_", "+", "anotheredge1_", "+", "___"}]}],
                     ",", "firstedge_"}], "]"}], ",", 
                   RowBox[{"secondzeros", ":", 
                    RowBox[{"0", "..."}]}], ",", 
                   RowBox[{"Except", "[", 
                    RowBox[{
                    RowBox[{"0", "|", 
                    RowBox[{"somedge2_", "+", "anotheredge2_", "+", "___"}]}],
                     ",", "secondedge_"}], "]"}], ",", 
                   RowBox[{"thirdzeros", ":", 
                    RowBox[{"0", "..."}]}], ",", 
                   RowBox[{"Sequence", "@@", 
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{"Length", "[", "inputbottomleft", "]"}]}], 
                    "]"}]}]}], "}"}], ",", "rowsafter___"}], "}"}], 
               "\[RuleDelayed]", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"rowsbefore", ",", "rowsafter"}], "}"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "[", 
                    RowBox[{"{", "firstzeros", "}"}], "]"}], "]"}], ",", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"{", "firstzeros", "}"}], "]"}], "+", "2"}], ",", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"{", 
                    RowBox[{"firstzeros", ",", "secondzeros"}], "}"}], "]"}], 
                    "+", "1"}]}], "]"}], ",", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"{", 
                    RowBox[{"firstzeros", ",", "secondzeros"}], "}"}], "]"}], 
                    "+", "3"}], ",", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "firstzeros", ",", "secondzeros", ",", "thirdzeros"}], 
                    "}"}], "]"}], "+", "2"}]}], "]"}]}], "]"}]}], "]"}], 
                  "]"}], ",", 
                 RowBox[{"Map", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Total", "[", "#", "]"}], "}"}], "&"}], ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"rowsbefore", ",", "rowsafter"}], "}"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"{", "firstzeros", "}"}], "]"}], "+", "1"}], ",", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"{", 
                    RowBox[{"firstzeros", ",", "secondzeros"}], "}"}], "]"}], 
                    "+", "2"}]}], "}"}]}], "]"}], "]"}]}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"rowsbefore", ",", "rowsafter"}], "}"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "firstzeros", ",", "secondzeros", ",", "thirdzeros"}], 
                    "}"}], "]"}], "+", "3"}], ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"rowsbefore", ",", "rowsafter"}], "}"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}], "]"}], 
                  "]"}], ",", "2"}], "]"}]}]}], ")"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"reducedkasteleyn", "=", 
            RowBox[{"Transpose", "[", "reducedkasteleyn", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"bottomrightrownum", "=", 
            RowBox[{"Length", "[", "inputbottomright", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"bottomrightcolnum", "=", 
            RowBox[{
             RowBox[{"Dimensions", "[", 
              RowBox[{"Join", "[", 
               RowBox[{"inputtopright", ",", "inputbottomright"}], "]"}], 
              "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"outputtopleft", "=", 
            RowBox[{"reducedkasteleyn", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{";;", 
                RowBox[{"-", 
                 RowBox[{"(", 
                  RowBox[{"bottomrightrownum", "+", "1"}], ")"}]}]}], ",", 
               RowBox[{";;", 
                RowBox[{"-", 
                 RowBox[{"(", 
                  RowBox[{"bottomrightcolnum", "+", "1"}], ")"}]}]}]}], "]"}],
              "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"outputtopright", "=", 
            RowBox[{"reducedkasteleyn", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{";;", 
                RowBox[{"-", 
                 RowBox[{"(", 
                  RowBox[{"bottomrightrownum", "+", "1"}], ")"}]}]}], ",", 
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"(", "bottomrightcolnum", ")"}]}], ";;"}]}], "]"}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"outputbottomleft", "=", 
            RowBox[{"reducedkasteleyn", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"(", "bottomrightrownum", ")"}]}], ";;"}], ",", 
               RowBox[{";;", 
                RowBox[{"-", 
                 RowBox[{"(", 
                  RowBox[{"bottomrightcolnum", "+", "1"}], ")"}]}]}]}], "]"}],
              "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"outputbottomright", "=", 
            RowBox[{"reducedkasteleyn", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"(", "bottomrightrownum", ")"}]}], ";;"}], ",", 
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"(", "bottomrightcolnum", ")"}]}], ";;"}]}], "]"}], 
             "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
         "outputtopleft", ",", "outputtopright", ",", "outputbottomleft", ",",
           "outputbottomright"}], "}"}]}]}], "]"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"collapseBlackNodesInternalExternal", "[", 
     RowBox[{
     "inputtopleft_", ",", "inputtopright_", ",", "inputbottomleft_", ",", 
      "inputbottomright_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "outputtopleft", ",", "outputtopright", ",", "outputbottomleft", ",", 
        "outputbottomright", ",", "transposekasteleyn", ",", 
        "bivalentblacknodes", ",", "somedge", ",", "anotheredge", ",", 
        "kasteleyn", ",", "todeleterows", ",", "bottomrightrownum", ",", 
        "bottomrightcolnum"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Here", " ", "we", " ", "want", " ", "to", " ", "remove", " ", 
        "bivalent", " ", "nodes", " ", "connected", " ", "to", " ", "an", " ",
         "internal", " ", "node", " ", "and", " ", "an", " ", "external", " ", 
        RowBox[{"node", ".", " ", "The"}], " ", "way", " ", "to", " ", "do", 
        " ", "this", " ", "is", " ", "to", " ", "throw", " ", "away", " ", 
        "the", " ", "external", " ", "node", " ", "and", " ", "turn", " ", 
        "the", " ", "bivalent", " ", "node", " ", "into", " ", "the", " ", 
        "external", " ", "node"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "outputtopleft", ",", "outputtopright", ",", "outputbottomleft", ",",
           "outputbottomright"}], "}"}], "=", 
        RowBox[{"{", 
         RowBox[{
         "inputtopleft", ",", "inputtopright", ",", "inputbottomleft", ",", 
          "inputbottomright"}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Dimensions", "[", 
            RowBox[{"Join", "[", 
             RowBox[{"inputtopleft", ",", "inputbottomleft"}], "]"}], "]"}], 
           "[", 
           RowBox[{"[", "2", "]"}], "]"}], ">", "0"}], ",", 
         RowBox[{"(*", 
          RowBox[{
          "we", " ", "have", " ", "internal", " ", "black", " ", "nodes", " ", 
           RowBox[{"(", 
            RowBox[{
            "which", " ", "could", " ", "potentially", " ", "be", " ", 
             "bivalent"}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"transposekasteleyn", "=", 
           RowBox[{"Transpose", "[", 
            RowBox[{"joinupKasteleyn", "[", 
             RowBox[{
             "inputtopleft", ",", "inputtopright", ",", "inputbottomleft", 
              ",", "inputbottomright"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"bivalentblacknodes", "=", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{"transposekasteleyn", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"0", "..."}], ",", 
                 RowBox[{"Except", "[", 
                  RowBox[{"0", "|", 
                   RowBox[{"somedge_", "+", "anotheredge_", "+", "___"}]}], 
                  "]"}], ",", 
                 RowBox[{"0", "..."}], ",", 
                 RowBox[{"Except", "[", 
                  RowBox[{"0", "|", 
                   RowBox[{"somedge_", "+", "anotheredge_", "+", "___"}]}], 
                  "]"}], ",", 
                 RowBox[{"0", "..."}]}], "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Sequence", "@@", 
                RowBox[{"ConstantArray", "[", 
                 RowBox[{"0", ",", 
                  RowBox[{"Length", "[", "inputtopleft", "]"}]}], "]"}]}], 
               ",", 
               RowBox[{"Sequence", "@@", 
                RowBox[{"ConstantArray", "[", 
                 RowBox[{"_", ",", 
                  RowBox[{"Length", "[", "inputbottomleft", "]"}]}], 
                 "]"}]}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
             RowBox[{
             "we", " ", "found", " ", "the", " ", "bivalent", " ", "nodes", 
              " ", 
              RowBox[{"we", "'"}], "re", " ", "looking", " ", 
              RowBox[{"for", ".", " ", "We"}], " ", "now", " ", "need", " ", 
              "to", " ", "move", " ", "these", " ", "columns", " ", "into", 
              " ", "the", " ", "top"}], "-", 
             RowBox[{
             "right", " ", "part", " ", "of", " ", "the", " ", 
              "kasteleyn"}]}], ",", " ", 
            RowBox[{
            "and", " ", "remove", " ", "the", " ", "rows", " ", "associated", 
             " ", "to", " ", "the", " ", "external", " ", "nodes", " ", 
             RowBox[{"we", "'"}], "re", " ", "throwing", " ", 
             RowBox[{"away", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"bivalentblacknodes", "=!=", 
             RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"kasteleyn", "=", 
              RowBox[{"Transpose", "[", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"Cases", "[", 
                  RowBox[{"transposekasteleyn", ",", 
                   RowBox[{"Except", "[", 
                    RowBox[{"Alternatives", "@@", "bivalentblacknodes"}], 
                    "]"}]}], "]"}], ",", "bivalentblacknodes"}], "]"}], 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"todeleterows", "=", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"DeleteCases", "[", 
                   RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"Except", "[", "0", "]"}], ",", "1"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"___", ",", "0", ",", "___"}], "}"}]}], "]"}], 
                  "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "1"}], "]"}], "]"}], "&"}], ",", 
                "bivalentblacknodes"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"kasteleyn", "=", 
              RowBox[{"Delete", "[", 
               RowBox[{"kasteleyn", ",", "todeleterows"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{
               "now", " ", "we", " ", "have", " ", "the", " ", "kasteleyn"}], 
               ",", " ", 
               RowBox[{
                RowBox[{"let", "'"}], "s", " ", "break", " ", "it", " ", "up",
                 " ", "into", " ", "its", " ", "four", " ", "components"}]}], 
              "*)"}], "\[IndentingNewLine]", 
             RowBox[{"bottomrightrownum", "=", 
              RowBox[{
               RowBox[{"Length", "[", "inputbottomright", "]"}], "-", 
               RowBox[{"Length", "[", "todeleterows", "]"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"bottomrightcolnum", "=", 
              RowBox[{
               RowBox[{
                RowBox[{"Dimensions", "[", 
                 RowBox[{"Join", "[", 
                  RowBox[{"inputtopright", ",", "inputbottomright"}], "]"}], 
                 "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], "+", 
               RowBox[{"Length", "[", "bivalentblacknodes", "]"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"outputtopleft", "=", 
              RowBox[{"kasteleyn", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{";;", 
                  RowBox[{"-", 
                   RowBox[{"(", 
                    RowBox[{"bottomrightrownum", "+", "1"}], ")"}]}]}], ",", 
                 RowBox[{";;", 
                  RowBox[{"-", 
                   RowBox[{"(", 
                    RowBox[{"bottomrightcolnum", "+", "1"}], ")"}]}]}]}], 
                "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"outputtopright", "=", 
              RowBox[{"kasteleyn", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{";;", 
                  RowBox[{"-", 
                   RowBox[{"(", 
                    RowBox[{"bottomrightrownum", "+", "1"}], ")"}]}]}], ",", 
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"(", "bottomrightcolnum", ")"}]}], ";;"}]}], "]"}],
                "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"outputbottomleft", "=", 
              RowBox[{"kasteleyn", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"(", "bottomrightrownum", ")"}]}], ";;"}], ",", 
                 RowBox[{";;", 
                  RowBox[{"-", 
                   RowBox[{"(", 
                    RowBox[{"bottomrightcolnum", "+", "1"}], ")"}]}]}]}], 
                "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"outputbottomright", "=", 
              RowBox[{"kasteleyn", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"(", "bottomrightrownum", ")"}]}], ";;"}], ",", 
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"(", "bottomrightcolnum", ")"}]}], ";;"}]}], "]"}],
                "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "outputtopleft", ",", "outputtopright", ",", "outputbottomleft", ",", 
         "outputbottomright"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"collapseWhiteNodesInternalExternal", "[", 
    RowBox[{
    "inputtopleft_", ",", "inputtopright_", ",", "inputbottomleft_", ",", 
     "inputbottomright_"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "outputtopleft", ",", "outputtopright", ",", "outputbottomleft", ",", 
       "outputbottomright", ",", "kasteleyn", ",", "bivalentwhitenodes", ",", 
       "somedge", ",", "anotheredge", ",", "todeletecolumns", ",", 
       "bottomrightrownum", ",", "bottomrightcolnum"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "outputtopleft", ",", "outputtopright", ",", "outputbottomleft", ",", 
         "outputbottomright"}], "}"}], "=", 
       RowBox[{"{", 
        RowBox[{
        "inputtopleft", ",", "inputtopright", ",", "inputbottomleft", ",", 
         "inputbottomright"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "outputtopleft", "]"}], ">", "0"}], "||", 
         RowBox[{
          RowBox[{"Length", "[", "outputtopright", "]"}], ">", "0"}]}], ",", 
        RowBox[{"(*", 
         RowBox[{
         "we", " ", "have", " ", "internal", " ", "white", " ", "nodes", " ", 
          RowBox[{"(", 
           RowBox[{
           "which", " ", "could", " ", "potentially", " ", "be", " ", 
            "bivalent"}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"kasteleyn", "=", 
          RowBox[{"joinupKasteleyn", "[", 
           RowBox[{
           "inputtopleft", ",", "inputtopright", ",", "inputbottomleft", ",", 
            "inputbottomright"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"bivalentwhitenodes", "=", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{"kasteleyn", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"0", "..."}], ",", 
                RowBox[{"Except", "[", 
                 RowBox[{"0", "|", 
                  RowBox[{"somedge_", "+", "anotheredge_", "+", "___"}]}], 
                 "]"}], ",", 
                RowBox[{"0", "..."}], ",", 
                RowBox[{"Except", "[", 
                 RowBox[{"0", "|", 
                  RowBox[{"somedge_", "+", "anotheredge_", "+", "___"}]}], 
                 "]"}], ",", 
                RowBox[{"0", "..."}]}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Sequence", "@@", 
               RowBox[{"ConstantArray", "[", 
                RowBox[{"0", ",", 
                 RowBox[{
                  RowBox[{"Dimensions", "[", "inputtopleft", "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ",", 
              RowBox[{"Sequence", "@@", 
               RowBox[{"ConstantArray", "[", 
                RowBox[{"_", ",", 
                 RowBox[{
                  RowBox[{"Dimensions", "[", "inputtopright", "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}], "}"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
            RowBox[{
            "we", " ", "found", " ", "the", " ", "bivalent", " ", "nodes", 
             " ", 
             RowBox[{"we", "'"}], "re", " ", "looking", " ", 
             RowBox[{"for", ".", " ", "We"}], " ", "now", " ", "need", " ", 
             "to", " ", "move", " ", "these", " ", "rows", " ", "into", " ", 
             "the", " ", "bottom"}], "-", 
            RowBox[{
            "left", " ", "part", " ", "of", " ", "the", " ", "kasteleyn"}]}], 
           ",", " ", 
           RowBox[{
           "and", " ", "remove", " ", "the", " ", "columns", " ", 
            "associated", " ", "to", " ", "the", " ", "external", " ", 
            "nodes", " ", 
            RowBox[{"we", "'"}], "re", " ", "throwing", " ", 
            RowBox[{"away", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"bivalentwhitenodes", "=!=", 
            RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"kasteleyn", "=", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"Cases", "[", 
                RowBox[{"kasteleyn", ",", 
                 RowBox[{"Except", "[", 
                  RowBox[{"Alternatives", "@@", "bivalentwhitenodes"}], 
                  "]"}]}], "]"}], ",", "bivalentwhitenodes"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"todeletecolumns", "=", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"DeleteCases", "[", 
                  RowBox[{
                   RowBox[{"Position", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"Except", "[", "0", "]"}], ",", "1"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"___", ",", "0", ",", "___"}], "}"}]}], "]"}], 
                 "[", 
                 RowBox[{"[", 
                  RowBox[{"-", "1"}], "]"}], "]"}], "&"}], ",", 
               "bivalentwhitenodes"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"kasteleyn", "=", 
             RowBox[{"Transpose", "[", 
              RowBox[{"Delete", "[", 
               RowBox[{
                RowBox[{"Transpose", "[", "kasteleyn", "]"}], ",", 
                "todeletecolumns"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{
              "now", " ", "we", " ", "have", " ", "the", " ", "kasteleyn"}], 
              ",", " ", 
              RowBox[{
               RowBox[{"let", "'"}], "s", " ", "break", " ", "it", " ", "up", 
               " ", "into", " ", "its", " ", "four", " ", "components"}]}], 
             "*)"}], "\[IndentingNewLine]", 
            RowBox[{"bottomrightrownum", "=", 
             RowBox[{
              RowBox[{"Length", "[", "inputbottomright", "]"}], "+", 
              RowBox[{"Length", "[", "bivalentwhitenodes", "]"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"bottomrightcolnum", "=", 
             RowBox[{
              RowBox[{
               RowBox[{"Dimensions", "[", 
                RowBox[{"Join", "[", 
                 RowBox[{"inputtopright", ",", "inputbottomright"}], "]"}], 
                "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", 
              RowBox[{"Length", "[", "todeletecolumns", "]"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"outputtopleft", "=", 
             RowBox[{"kasteleyn", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{";;", 
                 RowBox[{"-", 
                  RowBox[{"(", 
                   RowBox[{"bottomrightrownum", "+", "1"}], ")"}]}]}], ",", 
                RowBox[{";;", 
                 RowBox[{"-", 
                  RowBox[{"(", 
                   RowBox[{"bottomrightcolnum", "+", "1"}], ")"}]}]}]}], 
               "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"outputtopright", "=", 
             RowBox[{"kasteleyn", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{";;", 
                 RowBox[{"-", 
                  RowBox[{"(", 
                   RowBox[{"bottomrightrownum", "+", "1"}], ")"}]}]}], ",", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"(", "bottomrightcolnum", ")"}]}], ";;"}]}], "]"}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"outputbottomleft", "=", 
             RowBox[{"kasteleyn", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"(", "bottomrightrownum", ")"}]}], ";;"}], ",", 
                RowBox[{";;", 
                 RowBox[{"-", 
                  RowBox[{"(", 
                   RowBox[{"bottomrightcolnum", "+", "1"}], ")"}]}]}]}], 
               "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"outputbottomright", "=", 
             RowBox[{"kasteleyn", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"(", "bottomrightrownum", ")"}]}], ";;"}], ",", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"(", "bottomrightcolnum", ")"}]}], ";;"}]}], "]"}], 
              "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "outputtopleft", ",", "outputtopright", ",", "outputbottomleft", ",", 
        "outputbottomright"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"collapseBivalentNodesNEW", "[", 
     RowBox[{
     "topleft_", ",", "topright_", ",", "bottomleft_", ",", "bottomright_"}], 
     "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "previoustopleft", ",", "previoustopright", ",", "previousbottomleft", 
        ",", "previousbottomright", ",", "newtopleft", ",", "newtopright", 
        ",", "newbottomleft", ",", "newbottomright"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Need", " ", "to", " ", "do", " ", "the", " ", "replacements", " ", 
        "on", " ", "repeat", " ", "until", " ", "the", " ", "Kasteleyn", " ", 
        "stops", " ", 
        RowBox[{"changing", ".", " ", 
         RowBox[{"We", "'"}]}], "ll", " ", "start", " ", "by", " ", 
        "collapsing", " ", "bivalnt", " ", "nodes", " ", "that", " ", 
        "connect", " ", "to", " ", "two", " ", "internal", " ", 
        RowBox[{"nodes", "."}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "previoustopleft", ",", "previoustopright", ",", 
          "previousbottomleft", ",", "previousbottomright"}], "}"}], "=", 
        RowBox[{"{", 
         RowBox[{
         "topleft", ",", "topright", ",", "bottomleft", ",", "bottomright"}], 
         "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "newtopleft", ",", "newtopright", ",", "newbottomleft", ",", 
          "newbottomright"}], "}"}], "=", 
        RowBox[{"collapseWhiteNodesInternalInternalNEW", "[", 
         RowBox[{"Sequence", "@@", 
          RowBox[{"collapseBlackNodesInternalInternalNEW", "[", 
           RowBox[{
           "previoustopleft", ",", "previoustopright", ",", 
            "previousbottomleft", ",", "previousbottomright"}], "]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "previoustopleft", ",", "previoustopright", ",", 
            "previousbottomleft", ",", "previousbottomright"}], "}"}], "=!=", 
          RowBox[{"{", 
           RowBox[{
           "newtopleft", ",", "newtopright", ",", "newbottomleft", ",", 
            "newbottomright"}], "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "previoustopleft", ",", "previoustopright", ",", 
             "previousbottomleft", ",", "previousbottomright"}], "}"}], "=", 
           RowBox[{"{", 
            RowBox[{
            "newtopleft", ",", "newtopright", ",", "newbottomleft", ",", 
             "newbottomright"}], "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "newtopleft", ",", "newtopright", ",", "newbottomleft", ",", 
             "newbottomright"}], "}"}], "=", 
           RowBox[{"collapseWhiteNodesInternalInternalNEW", "[", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"collapseBlackNodesInternalInternalNEW", "[", 
              RowBox[{
              "previoustopleft", ",", "previoustopright", ",", 
               "previousbottomleft", ",", "previousbottomright"}], "]"}]}], 
            "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "newtopleft", ",", "newtopright", ",", "newbottomleft", ",", 
          "newbottomright"}], "}"}], "=", 
        RowBox[{"collapseWhiteNodesInternalExternal", "[", 
         RowBox[{"Sequence", "@@", 
          RowBox[{"collapseBlackNodesInternalExternal", "[", 
           RowBox[{
           "previoustopleft", ",", "previoustopright", ",", 
            "previousbottomleft", ",", "previousbottomright"}], "]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "previoustopleft", ",", "previoustopright", ",", 
            "previousbottomleft", ",", "previousbottomright"}], "}"}], "=!=", 
          RowBox[{"{", 
           RowBox[{
           "newtopleft", ",", "newtopright", ",", "newbottomleft", ",", 
            "newbottomright"}], "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "previoustopleft", ",", "previoustopright", ",", 
             "previousbottomleft", ",", "previousbottomright"}], "}"}], "=", 
           RowBox[{"{", 
            RowBox[{
            "newtopleft", ",", "newtopright", ",", "newbottomleft", ",", 
             "newbottomright"}], "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "newtopleft", ",", "newtopright", ",", "newbottomleft", ",", 
             "newbottomright"}], "}"}], "=", 
           RowBox[{"collapseWhiteNodesInternalExternal", "[", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"collapseBlackNodesInternalExternal", "[", 
              RowBox[{
              "previoustopleft", ",", "previoustopright", ",", 
               "previousbottomleft", ",", "previousbottomright"}], "]"}]}], 
            "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "newtopleft", ",", "newtopright", ",", "newbottomleft", ",", 
         "newbottomright"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a", "=", 
   RowBox[{
    RowBox[{"Normal", "[", 
     RowBox[{"SparseArray", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "33"}], "}"}], "\[Rule]", 
          RowBox[{"X", "[", 
           RowBox[{"1", ",", "10"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "24"}], "}"}], "\[Rule]", 
          RowBox[{"X", "[", 
           RowBox[{"10", ",", "7"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "28"}], "}"}], "\[Rule]", 
          RowBox[{"X", "[", 
           RowBox[{"7", ",", "1"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"2", ",", "19"}], "}"}], "\[Rule]", 
          RowBox[{"X", "[", 
           RowBox[{"3", ",", "1"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"2", ",", "28"}], "}"}], "\[Rule]", 
          RowBox[{"X", "[", 
           RowBox[{"1", ",", "3"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"3", ",", "19"}], "}"}], "\[Rule]", 
          RowBox[{"Y", "[", 
           RowBox[{"1", ",", "3"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"3", ",", "20"}], "}"}], "\[Rule]", 
          RowBox[{"X", "[", 
           RowBox[{"3", ",", "2"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"3", ",", "21"}], "}"}], "\[Rule]", 
          RowBox[{"X", "[", 
           RowBox[{"2", ",", "1"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"4", ",", "23"}], "}"}], "\[Rule]", 
          RowBox[{"Y", "[", 
           RowBox[{"7", ",", "10"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"4", ",", "25"}], "}"}], "\[Rule]", 
          RowBox[{"X", "[", 
           RowBox[{"10", ",", "3"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"4", ",", "28"}], "}"}], "\[Rule]", 
          RowBox[{"X", "[", 
           RowBox[{"3", ",", "7"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"5", ",", "27"}], "}"}], "\[Rule]", 
          RowBox[{"Y", "[", 
           RowBox[{"6", ",", "9"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"5", ",", "34"}], "}"}], "\[Rule]", 
          RowBox[{
           RowBox[{"X", "[", 
            RowBox[{"9", ",", "8"}], "]"}], "+", 
           RowBox[{"X", "[", 
            RowBox[{"8", ",", "6"}], "]"}]}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"6", ",", "20"}], "}"}], "\[Rule]", 
          RowBox[{"X", "[", 
           RowBox[{"6", ",", "3"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"6", ",", "25"}], "}"}], "\[Rule]", 
          RowBox[{"X", "[", 
           RowBox[{"3", ",", "10"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"6", ",", "26"}], "}"}], "\[Rule]", 
          RowBox[{"X", "[", 
           RowBox[{"10", ",", "9"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"6", ",", "27"}], "}"}], "\[Rule]", 
          RowBox[{"X", "[", 
           RowBox[{"9", ",", "6"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"7", ",", "29"}], "}"}], "\[Rule]", 
          RowBox[{"X", "[", 
           RowBox[{"9", ",", "4"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"7", ",", "30"}], "}"}], "\[Rule]", 
          RowBox[{"X", "[", 
           RowBox[{"4", ",", "5"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"7", ",", "32"}], "}"}], "\[Rule]", 
          RowBox[{"X", "[", 
           RowBox[{"5", ",", "6"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"7", ",", "34"}], "}"}], "\[Rule]", 
          RowBox[{"X", "[", 
           RowBox[{"6", ",", "9"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"8", ",", "29"}], "}"}], "\[Rule]", 
          RowBox[{"X", "[", 
           RowBox[{"4", ",", "9"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"8", ",", "31"}], "}"}], "\[Rule]", 
          RowBox[{"Y", "[", 
           RowBox[{"9", ",", "4"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"9", ",", "20"}], "}"}], "\[Rule]", 
          RowBox[{"X", "[", 
           RowBox[{"2", ",", "6"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"9", ",", "21"}], "}"}], "\[Rule]", 
          RowBox[{"X", "[", 
           RowBox[{"5", ",", "2"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"9", ",", "32"}], "}"}], "\[Rule]", 
          RowBox[{"X", "[", 
           RowBox[{"6", ",", "5"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"10", ",", "21"}], "}"}], "\[Rule]", 
          RowBox[{"X", "[", 
           RowBox[{"1", ",", "5"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"10", ",", "22"}], "}"}], "\[Rule]", 
          RowBox[{"X", "[", 
           RowBox[{"5", ",", "1"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"11", ",", "22"}], "}"}], "\[Rule]", 
          RowBox[{"X", "[", 
           RowBox[{"1", ",", "11"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"11", ",", "33"}], "}"}], "\[Rule]", 
          RowBox[{"X", "[", 
           RowBox[{"11", ",", "1"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"12", ",", "22"}], "}"}], "\[Rule]", 
          RowBox[{"X", "[", 
           RowBox[{"11", ",", "5"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"12", ",", "30"}], "}"}], "\[Rule]", 
          RowBox[{"X", "[", 
           RowBox[{"5", ",", "11"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"13", ",", "30"}], "}"}], "\[Rule]", 
          RowBox[{"Z", "[", 
           RowBox[{"9", ",", "4"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"13", ",", "31"}], "}"}], "\[Rule]", 
          RowBox[{"Y", "[", 
           RowBox[{"4", ",", "9"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"14", ",", "23"}], "}"}], "\[Rule]", 
          RowBox[{"Y", "[", 
           RowBox[{"10", ",", "7"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"14", ",", "24"}], "}"}], "\[Rule]", 
          RowBox[{"X", "[", 
           RowBox[{"7", ",", "10"}], "]"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"14", ",", "34"}], "}"}]}], "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{"19", ";;"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"14", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c", "=", 
   RowBox[{
    RowBox[{"Normal", "[", 
     RowBox[{"SparseArray", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"15", ",", "26"}], "}"}], "\[Rule]", 
          RowBox[{"X", "[", 
           RowBox[{"9", ",", "10"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"17", ",", "33"}], "}"}], "\[Rule]", 
          RowBox[{"X", "[", 
           RowBox[{"10", ",", "11"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"18", ",", "30"}], "}"}], "\[Rule]", 
          RowBox[{"X", "[", 
           RowBox[{"11", ",", "9"}], "]"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"18", ",", "34"}], "}"}]}], "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"15", ";;"}], ",", 
      RowBox[{"19", ";;"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"d", "=", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"0", ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "2"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], "}"}], "=", 
    RowBox[{"collapseBivalentNodes", "[", 
     RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], "}"}], "=!=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"X", "[", 
              RowBox[{"1", ",", "10"}], "]"}], ",", 
             RowBox[{"X", "[", 
              RowBox[{"6", ",", "3"}], "]"}], ",", 
             RowBox[{
              RowBox[{"X", "[", 
               RowBox[{"3", ",", "7"}], "]"}], "+", 
              RowBox[{"X", "[", 
               RowBox[{"7", ",", "1"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"X", "[", 
               RowBox[{"8", ",", "6"}], "]"}], "+", 
              RowBox[{"X", "[", 
               RowBox[{"9", ",", "8"}], "]"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"X", "[", 
               RowBox[{"4", ",", "5"}], "]"}], "+", 
              RowBox[{"X", "[", 
               RowBox[{"5", ",", "2"}], "]"}], "+", 
              RowBox[{"Z", "[", 
               RowBox[{"9", ",", "4"}], "]"}]}], ",", 
             RowBox[{"X", "[", 
              RowBox[{"2", ",", "6"}], "]"}], ",", "0", ",", 
             RowBox[{"X", "[", 
              RowBox[{"6", ",", "9"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"X", "[", 
              RowBox[{"2", ",", "1"}], "]"}], ",", 
             RowBox[{"X", "[", 
              RowBox[{"3", ",", "2"}], "]"}], ",", 
             RowBox[{"X", "[", 
              RowBox[{"1", ",", "3"}], "]"}], ",", "0"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{"X", "[", 
              RowBox[{"10", ",", "9"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"X", "[", 
              RowBox[{"10", ",", "11"}], "]"}], ",", "0", ",", "0", ",", 
             "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"X", "[", 
              RowBox[{"11", ",", "9"}], "]"}], ",", "0", ",", "0", ",", "0"}],
             "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "}"}]}], "&&", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], "}"}], "=!=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"X", "[", 
              RowBox[{"3", ",", "2"}], "]"}], ",", 
             RowBox[{"X", "[", 
              RowBox[{"1", ",", "3"}], "]"}], ",", "0", ",", 
             RowBox[{"X", "[", 
              RowBox[{"2", ",", "1"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"X", "[", 
              RowBox[{"6", ",", "3"}], "]"}], ",", 
             RowBox[{
              RowBox[{"X", "[", 
               RowBox[{"3", ",", "7"}], "]"}], "+", 
              RowBox[{"X", "[", 
               RowBox[{"7", ",", "1"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"X", "[", 
               RowBox[{"8", ",", "6"}], "]"}], "+", 
              RowBox[{"X", "[", 
               RowBox[{"9", ",", "8"}], "]"}]}], ",", 
             RowBox[{"X", "[", 
              RowBox[{"1", ",", "10"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"X", "[", 
              RowBox[{"2", ",", "6"}], "]"}], ",", "0", ",", 
             RowBox[{"X", "[", 
              RowBox[{"6", ",", "9"}], "]"}], ",", 
             RowBox[{
              RowBox[{"X", "[", 
               RowBox[{"4", ",", "5"}], "]"}], "+", 
              RowBox[{"X", "[", 
               RowBox[{"5", ",", "2"}], "]"}], "+", 
              RowBox[{"Z", "[", 
               RowBox[{"9", ",", "4"}], "]"}]}]}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{"X", "[", 
              RowBox[{"10", ",", "9"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", 
             RowBox[{"X", "[", 
              RowBox[{"10", ",", "11"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", 
             RowBox[{"X", "[", 
              RowBox[{"11", ",", "9"}], "]"}]}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "}"}]}]}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<Starting example: The result after collapsing the nodes doesn't \
give the same result as when I first created the function!\>\"", "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Map", "[", 
       RowBox[{"Dimensions", ",", 
        RowBox[{"collapseBivalentNodesNEW", "[", 
         RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], "]"}], "=!=", 
      RowBox[{"Map", "[", 
       RowBox[{"Dimensions", ",", 
        RowBox[{"{", 
         RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], "}"}]}], 
       "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<Starting example: my alternative function for collapsing bivalent \
nodes doesn't yield Kasteleyn-components of the same dimension!\>\"", "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Sort", "[", 
       RowBox[{"Map", "[", 
        RowBox[{"Sort", ",", 
         RowBox[{"joinupKasteleyn", "@@", 
          RowBox[{"collapseBivalentNodesNEW", "[", 
           RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}]}], "]"}], 
       "]"}], "=!=", 
      RowBox[{"Sort", "[", 
       RowBox[{"Map", "[", 
        RowBox[{"Sort", ",", 
         RowBox[{"joinupKasteleyn", "@@", 
          RowBox[{"{", 
           RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], "}"}]}]}],
         "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<Starting example: my alternative function for collapsing bivalent \
nodes gives a different Kasteleyn!\>\"", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"IsomorphicGraphQ", "[", 
       RowBox[{
        RowBox[{"AdjacencyGraph", "[", 
         RowBox[{
          RowBox[{"turnIntoAdjacencyMatrix", "[", 
           RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"zz_", "/;", 
             RowBox[{"(", 
              RowBox[{"zz", ">", "1"}], ")"}]}], "\[Rule]", "1"}], "}"}]}], 
         "]"}], ",", 
        RowBox[{"AdjacencyGraph", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"turnIntoAdjacencyMatrix", "@@", 
            RowBox[{"collapseBivalentNodesNEW", "[", 
             RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ")"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"zz_", "/;", 
             RowBox[{"(", 
              RowBox[{"zz", ">", "1"}], ")"}]}], "\[Rule]", "1"}], "}"}]}], 
         "]"}]}], "]"}], "=!=", "True"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<Starting example: my alternative function for collapsing bivalent \
nodes gives a graph!\>\"", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"getKasteleynCheckQ", "[", 
      RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "True"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"getKasteleynCheckQ", "[", 
          RowBox[{
          "newa", ",", "newb", ",", "newc", ",", "newd", ",", "True"}], "]"}],
          "=!=", "True"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Print", "[", 
          "\"\<Starting example: Somehow collapsing the nodes hasn't \
preserved the index structure of BFTs!\>\"", "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"getNumberFaces", "[", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "=!=", 
         RowBox[{"getNumberFaces", "[", 
          RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], "]"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Print", "[", 
          "\"\<Starting example: We have somehow lost some faces when \
collapsing the bivalent nodes!\>\"", "]"}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"MemberQ", "[", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"Variables", "[", "#", "]"}], "]"}], "&"}], ",", 
          RowBox[{"joinupKasteleyn", "[", 
           RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], "]"}]}], 
         "]"}], ",", "2"}], "]"}], "||", 
      RowBox[{"MemberQ", "[", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"Variables", "[", "#", "]"}], "]"}], "&"}], ",", 
          RowBox[{"Transpose", "[", 
           RowBox[{"joinupKasteleyn", "[", 
            RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], "]"}], 
           "]"}]}], "]"}], ",", "2"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<Starting example: There seem to be bivalent nodes that haven't \
been collapsed yet!\>\"", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"Normal", "[", 
        RowBox[{"EdgeCycleMatrix", "[", 
         RowBox[{"AdjacencyGraph", "[", 
          RowBox[{"turnIntoAdjacencyMatrix", "[", 
           RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}], "]"}], 
        "]"}], "]"}], "=!=", 
      RowBox[{"Length", "[", 
       RowBox[{"Normal", "[", 
        RowBox[{"EdgeCycleMatrix", "[", 
         RowBox[{"AdjacencyGraph", "[", 
          RowBox[{"turnIntoAdjacencyMatrix", "[", 
           RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], "]"}], 
          "]"}], "]"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<Starting example: There is a different number of cycles in the \
graph before and after the collapse of bivalent nodes!\>\"", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], "=", 
    RowBox[{"Map", "[", 
     RowBox[{"Transpose", ",", 
      RowBox[{"{", 
       RowBox[{"a", ",", "c", ",", "b", ",", "d"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], "}"}], "=", 
    RowBox[{"collapseBivalentNodes", "[", 
     RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], "}"}], "=!=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"X", "[", 
              RowBox[{"1", ",", "10"}], "]"}], ",", 
             RowBox[{
              RowBox[{"X", "[", 
               RowBox[{"4", ",", "5"}], "]"}], "+", 
              RowBox[{"X", "[", 
               RowBox[{"5", ",", "2"}], "]"}], "+", 
              RowBox[{"X", "[", 
               RowBox[{"9", ",", "4"}], "]"}]}], ",", 
             RowBox[{"X", "[", 
              RowBox[{"2", ",", "1"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"X", "[", 
               RowBox[{"3", ",", "7"}], "]"}], "+", 
              RowBox[{"X", "[", 
               RowBox[{"7", ",", "1"}], "]"}]}], ",", "0", ",", 
             RowBox[{"Y", "[", 
              RowBox[{"1", ",", "3"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"X", "[", 
              RowBox[{"6", ",", "3"}], "]"}], ",", 
             RowBox[{"X", "[", 
              RowBox[{"2", ",", "6"}], "]"}], ",", 
             RowBox[{"X", "[", 
              RowBox[{"3", ",", "2"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"X", "[", 
               RowBox[{"8", ",", "6"}], "]"}], "+", 
              RowBox[{"X", "[", 
               RowBox[{"9", ",", "8"}], "]"}]}], ",", 
             RowBox[{"X", "[", 
              RowBox[{"6", ",", "9"}], "]"}], ",", "0"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"X", "[", 
              RowBox[{"10", ",", "11"}], "]"}], ",", 
             RowBox[{"X", "[", 
              RowBox[{"11", ",", "9"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"X", "[", 
              RowBox[{"10", ",", "9"}], "]"}], ",", "0", ",", "0"}], "}"}]}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "}"}]}], "&&", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], "}"}], "=!=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"X", "[", 
              RowBox[{"3", ",", "2"}], "]"}], ",", 
             RowBox[{"X", "[", 
              RowBox[{"2", ",", "6"}], "]"}], ",", 
             RowBox[{"X", "[", 
              RowBox[{"6", ",", "3"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"X", "[", 
              RowBox[{"6", ",", "9"}], "]"}], ",", 
             RowBox[{
              RowBox[{"X", "[", 
               RowBox[{"8", ",", "6"}], "]"}], "+", 
              RowBox[{"X", "[", 
               RowBox[{"9", ",", "8"}], "]"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Y", "[", 
              RowBox[{"1", ",", "3"}], "]"}], ",", "0", ",", 
             RowBox[{
              RowBox[{"X", "[", 
               RowBox[{"3", ",", "7"}], "]"}], "+", 
              RowBox[{"X", "[", 
               RowBox[{"7", ",", "1"}], "]"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"X", "[", 
              RowBox[{"2", ",", "1"}], "]"}], ",", 
             RowBox[{
              RowBox[{"X", "[", 
               RowBox[{"4", ",", "5"}], "]"}], "+", 
              RowBox[{"X", "[", 
               RowBox[{"5", ",", "2"}], "]"}], "+", 
              RowBox[{"X", "[", 
               RowBox[{"9", ",", "4"}], "]"}]}], ",", 
             RowBox[{"X", "[", 
              RowBox[{"1", ",", "10"}], "]"}]}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"X", "[", 
              RowBox[{"10", ",", "11"}], "]"}], ",", 
             RowBox[{"X", "[", 
              RowBox[{"11", ",", "9"}], "]"}]}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{"X", "[", 
              RowBox[{"10", ",", "9"}], "]"}]}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "}"}]}]}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<Starting example: The result after collapsing the nodes doesn't \
give the same result as when I first created the function!\>\"", "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Map", "[", 
       RowBox[{"Dimensions", ",", 
        RowBox[{"collapseBivalentNodesNEW", "[", 
         RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], "]"}], "=!=", 
      RowBox[{"Map", "[", 
       RowBox[{"Dimensions", ",", 
        RowBox[{"{", 
         RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], "}"}]}], 
       "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<Starting example: my alternative function for collapsing bivalent \
nodes doesn't yield Kasteleyn-components of the same dimension!\>\"", "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Sort", "[", 
       RowBox[{"Map", "[", 
        RowBox[{"Sort", ",", 
         RowBox[{"joinupKasteleyn", "@@", 
          RowBox[{"collapseBivalentNodesNEW", "[", 
           RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}]}], "]"}], 
       "]"}], "=!=", 
      RowBox[{"Sort", "[", 
       RowBox[{"Map", "[", 
        RowBox[{"Sort", ",", 
         RowBox[{"joinupKasteleyn", "@@", 
          RowBox[{"{", 
           RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], "}"}]}]}],
         "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<Starting example: my alternative function for collapsing bivalent \
nodes gives a different Kasteleyn!\>\"", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"IsomorphicGraphQ", "[", 
       RowBox[{
        RowBox[{"AdjacencyGraph", "[", 
         RowBox[{
          RowBox[{"turnIntoAdjacencyMatrix", "[", 
           RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"zz_", "/;", 
             RowBox[{"(", 
              RowBox[{"zz", ">", "1"}], ")"}]}], "\[Rule]", "1"}], "}"}]}], 
         "]"}], ",", 
        RowBox[{"AdjacencyGraph", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"turnIntoAdjacencyMatrix", "@@", 
            RowBox[{"collapseBivalentNodesNEW", "[", 
             RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ")"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"zz_", "/;", 
             RowBox[{"(", 
              RowBox[{"zz", ">", "1"}], ")"}]}], "\[Rule]", "1"}], "}"}]}], 
         "]"}]}], "]"}], "=!=", "True"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<Starting example: my alternative function for collapsing bivalent \
nodes gives a graph!\>\"", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"getKasteleynCheckQ", "[", 
      RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "True"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"getKasteleynCheckQ", "[", 
          RowBox[{
          "newa", ",", "newb", ",", "newc", ",", "newd", ",", "True"}], "]"}],
          "=!=", "True"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Print", "[", 
          "\"\<Starting example: Somehow collapsing the nodes hasn't \
preserved the index structure of BFTs!\>\"", "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"getNumberFaces", "[", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "=!=", 
         RowBox[{"getNumberFaces", "[", 
          RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], "]"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Print", "[", 
          "\"\<Starting example: We have somehow lost some faces when \
collapsing the bivalent nodes!\>\"", "]"}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"MemberQ", "[", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"Variables", "[", "#", "]"}], "]"}], "&"}], ",", 
          RowBox[{"joinupKasteleyn", "[", 
           RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], "]"}]}], 
         "]"}], ",", "2"}], "]"}], "||", 
      RowBox[{"MemberQ", "[", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"Variables", "[", "#", "]"}], "]"}], "&"}], ",", 
          RowBox[{"Transpose", "[", 
           RowBox[{"joinupKasteleyn", "[", 
            RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], "]"}], 
           "]"}]}], "]"}], ",", "2"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<Starting example: There seem to be bivalent nodes that haven't \
been collapsed yet!\>\"", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"Normal", "[", 
        RowBox[{"EdgeCycleMatrix", "[", 
         RowBox[{"AdjacencyGraph", "[", 
          RowBox[{"turnIntoAdjacencyMatrix", "[", 
           RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}], "]"}], 
        "]"}], "]"}], "=!=", 
      RowBox[{"Length", "[", 
       RowBox[{"Normal", "[", 
        RowBox[{"EdgeCycleMatrix", "[", 
         RowBox[{"AdjacencyGraph", "[", 
          RowBox[{"turnIntoAdjacencyMatrix", "[", 
           RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], "]"}], 
          "]"}], "]"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<Starting example: There is a different number of cycles in the \
graph before and after the collapse of bivalent nodes!\>\"", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a", "=", 
   RowBox[{
    RowBox[{"Normal", "[", 
     RowBox[{"SparseArray", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "33"}], "}"}], "\[Rule]", 
          RowBox[{"X", "[", 
           RowBox[{"1", ",", "10"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "24"}], "}"}], "\[Rule]", 
          RowBox[{"X", "[", 
           RowBox[{"10", ",", "7"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "28"}], "}"}], "\[Rule]", 
          RowBox[{"X", "[", 
           RowBox[{"7", ",", "1"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"2", ",", "19"}], "}"}], "\[Rule]", 
          RowBox[{"X", "[", 
           RowBox[{"3", ",", "1"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"2", ",", "28"}], "}"}], "\[Rule]", 
          RowBox[{"X", "[", 
           RowBox[{"1", ",", "3"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"3", ",", "19"}], "}"}], "\[Rule]", 
          RowBox[{"Y", "[", 
           RowBox[{"1", ",", "3"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"3", ",", "20"}], "}"}], "\[Rule]", 
          RowBox[{"X", "[", 
           RowBox[{"3", ",", "2"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"3", ",", "21"}], "}"}], "\[Rule]", 
          RowBox[{"X", "[", 
           RowBox[{"2", ",", "1"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"4", ",", "23"}], "}"}], "\[Rule]", 
          RowBox[{"Y", "[", 
           RowBox[{"7", ",", "10"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"4", ",", "25"}], "}"}], "\[Rule]", 
          RowBox[{"X", "[", 
           RowBox[{"10", ",", "3"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"4", ",", "28"}], "}"}], "\[Rule]", 
          RowBox[{"X", "[", 
           RowBox[{"3", ",", "7"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"5", ",", "27"}], "}"}], "\[Rule]", 
          RowBox[{"Y", "[", 
           RowBox[{"6", ",", "9"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"5", ",", "34"}], "}"}], "\[Rule]", 
          RowBox[{
           RowBox[{"X", "[", 
            RowBox[{"9", ",", "8"}], "]"}], "+", 
           RowBox[{"X", "[", 
            RowBox[{"8", ",", "6"}], "]"}]}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"6", ",", "20"}], "}"}], "\[Rule]", 
          RowBox[{"X", "[", 
           RowBox[{"6", ",", "3"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"6", ",", "25"}], "}"}], "\[Rule]", 
          RowBox[{"X", "[", 
           RowBox[{"3", ",", "10"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"6", ",", "26"}], "}"}], "\[Rule]", 
          RowBox[{"X", "[", 
           RowBox[{"10", ",", "9"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"6", ",", "27"}], "}"}], "\[Rule]", 
          RowBox[{"X", "[", 
           RowBox[{"9", ",", "6"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"7", ",", "29"}], "}"}], "\[Rule]", 
          RowBox[{"X", "[", 
           RowBox[{"9", ",", "4"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"7", ",", "30"}], "}"}], "\[Rule]", 
          RowBox[{"X", "[", 
           RowBox[{"4", ",", "5"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"7", ",", "32"}], "}"}], "\[Rule]", 
          RowBox[{"X", "[", 
           RowBox[{"5", ",", "6"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"7", ",", "34"}], "}"}], "\[Rule]", 
          RowBox[{"X", "[", 
           RowBox[{"6", ",", "9"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"8", ",", "29"}], "}"}], "\[Rule]", 
          RowBox[{"X", "[", 
           RowBox[{"4", ",", "9"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"8", ",", "31"}], "}"}], "\[Rule]", 
          RowBox[{"Y", "[", 
           RowBox[{"9", ",", "4"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"9", ",", "20"}], "}"}], "\[Rule]", 
          RowBox[{"X", "[", 
           RowBox[{"2", ",", "6"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"9", ",", "21"}], "}"}], "\[Rule]", 
          RowBox[{"X", "[", 
           RowBox[{"5", ",", "2"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"9", ",", "32"}], "}"}], "\[Rule]", 
          RowBox[{"X", "[", 
           RowBox[{"6", ",", "5"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"10", ",", "21"}], "}"}], "\[Rule]", 
          RowBox[{"X", "[", 
           RowBox[{"1", ",", "5"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"10", ",", "22"}], "}"}], "\[Rule]", 
          RowBox[{"X", "[", 
           RowBox[{"5", ",", "1"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"11", ",", "22"}], "}"}], "\[Rule]", 
          RowBox[{"X", "[", 
           RowBox[{"1", ",", "11"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"11", ",", "33"}], "}"}], "\[Rule]", 
          RowBox[{"X", "[", 
           RowBox[{"11", ",", "1"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"12", ",", "22"}], "}"}], "\[Rule]", 
          RowBox[{"X", "[", 
           RowBox[{"11", ",", "5"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"12", ",", "30"}], "}"}], "\[Rule]", 
          RowBox[{"X", "[", 
           RowBox[{"5", ",", "11"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"13", ",", "30"}], "}"}], "\[Rule]", 
          RowBox[{"Z", "[", 
           RowBox[{"9", ",", "4"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"13", ",", "31"}], "}"}], "\[Rule]", 
          RowBox[{"Y", "[", 
           RowBox[{"4", ",", "9"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"14", ",", "23"}], "}"}], "\[Rule]", 
          RowBox[{"Y", "[", 
           RowBox[{"10", ",", "7"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"14", ",", "24"}], "}"}], "\[Rule]", 
          RowBox[{"X", "[", 
           RowBox[{"7", ",", "10"}], "]"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"14", ",", "34"}], "}"}]}], "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{"19", ";;"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"14", ",", "0"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c", "=", 
   RowBox[{
    RowBox[{"Normal", "[", 
     RowBox[{"SparseArray", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"15", ",", "26"}], "}"}], "\[Rule]", 
          RowBox[{"X", "[", 
           RowBox[{"9", ",", "10"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"17", ",", "33"}], "}"}], "\[Rule]", 
          RowBox[{"X", "[", 
           RowBox[{"10", ",", "11"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"18", ",", "30"}], "}"}], "\[Rule]", 
          RowBox[{"X", "[", 
           RowBox[{"11", ",", "9"}], "]"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"18", ",", "34"}], "}"}]}], "]"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"15", ";;"}], ",", 
      RowBox[{"19", ";;"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"d", "=", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"0", ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "0"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], "}"}], "=", 
    RowBox[{"collapseBivalentNodes", "[", 
     RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], "}"}], "=!=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"X", "[", 
              RowBox[{"1", ",", "10"}], "]"}], ",", 
             RowBox[{"X", "[", 
              RowBox[{"6", ",", "3"}], "]"}], ",", 
             RowBox[{
              RowBox[{"X", "[", 
               RowBox[{"3", ",", "7"}], "]"}], "+", 
              RowBox[{"X", "[", 
               RowBox[{"7", ",", "1"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"X", "[", 
               RowBox[{"8", ",", "6"}], "]"}], "+", 
              RowBox[{"X", "[", 
               RowBox[{"9", ",", "8"}], "]"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"X", "[", 
               RowBox[{"4", ",", "5"}], "]"}], "+", 
              RowBox[{"X", "[", 
               RowBox[{"5", ",", "2"}], "]"}], "+", 
              RowBox[{"Z", "[", 
               RowBox[{"9", ",", "4"}], "]"}]}], ",", 
             RowBox[{"X", "[", 
              RowBox[{"2", ",", "6"}], "]"}], ",", "0", ",", 
             RowBox[{"X", "[", 
              RowBox[{"6", ",", "9"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"X", "[", 
              RowBox[{"2", ",", "1"}], "]"}], ",", 
             RowBox[{"X", "[", 
              RowBox[{"3", ",", "2"}], "]"}], ",", 
             RowBox[{"X", "[", 
              RowBox[{"1", ",", "3"}], "]"}], ",", "0"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"X", "[", 
             RowBox[{"10", ",", "9"}], "]"}], "}"}], ",", 
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "0", "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"X", "[", 
              RowBox[{"10", ",", "11"}], "]"}], ",", "0", ",", "0", ",", 
             "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"X", "[", 
              RowBox[{"11", ",", "9"}], "]"}], ",", "0", ",", "0", ",", "0"}],
             "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "0", "}"}]}], "}"}]}], "}"}]}], "&&", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], "}"}], "=!=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"X", "[", 
              RowBox[{"3", ",", "2"}], "]"}], ",", 
             RowBox[{"X", "[", 
              RowBox[{"1", ",", "3"}], "]"}], ",", "0", ",", 
             RowBox[{"X", "[", 
              RowBox[{"2", ",", "1"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"X", "[", 
              RowBox[{"6", ",", "3"}], "]"}], ",", 
             RowBox[{
              RowBox[{"X", "[", 
               RowBox[{"3", ",", "7"}], "]"}], "+", 
              RowBox[{"X", "[", 
               RowBox[{"7", ",", "1"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"X", "[", 
               RowBox[{"8", ",", "6"}], "]"}], "+", 
              RowBox[{"X", "[", 
               RowBox[{"9", ",", "8"}], "]"}]}], ",", 
             RowBox[{"X", "[", 
              RowBox[{"1", ",", "10"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"X", "[", 
              RowBox[{"2", ",", "6"}], "]"}], ",", "0", ",", 
             RowBox[{"X", "[", 
              RowBox[{"6", ",", "9"}], "]"}], ",", 
             RowBox[{
              RowBox[{"X", "[", 
               RowBox[{"4", ",", "5"}], "]"}], "+", 
              RowBox[{"X", "[", 
               RowBox[{"5", ",", "2"}], "]"}], "+", 
              RowBox[{"Z", "[", 
               RowBox[{"9", ",", "4"}], "]"}]}]}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"X", "[", 
             RowBox[{"10", ",", "9"}], "]"}], "}"}], ",", 
           RowBox[{"{", "0", "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", 
             RowBox[{"X", "[", 
              RowBox[{"10", ",", "11"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", 
             RowBox[{"X", "[", 
              RowBox[{"11", ",", "9"}], "]"}]}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "0", "}"}]}], "}"}]}], "}"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<Starting example: The result after collapsing the nodes doesn't \
give the same result as when I first created the function!\>\"", "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Map", "[", 
       RowBox[{"Dimensions", ",", 
        RowBox[{"collapseBivalentNodesNEW", "[", 
         RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], "]"}], "=!=", 
      RowBox[{"Map", "[", 
       RowBox[{"Dimensions", ",", 
        RowBox[{"{", 
         RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], "}"}]}], 
       "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<Starting example: my alternative function for collapsing bivalent \
nodes doesn't yield Kasteleyn-components of the same dimension!\>\"", "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Sort", "[", 
       RowBox[{"Map", "[", 
        RowBox[{"Sort", ",", 
         RowBox[{"joinupKasteleyn", "@@", 
          RowBox[{"collapseBivalentNodesNEW", "[", 
           RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}]}], "]"}], 
       "]"}], "=!=", 
      RowBox[{"Sort", "[", 
       RowBox[{"Map", "[", 
        RowBox[{"Sort", ",", 
         RowBox[{"joinupKasteleyn", "@@", 
          RowBox[{"{", 
           RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], "}"}]}]}],
         "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<Starting example: my alternative function for collapsing bivalent \
nodes gives a different Kasteleyn!\>\"", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"IsomorphicGraphQ", "[", 
       RowBox[{
        RowBox[{"AdjacencyGraph", "[", 
         RowBox[{
          RowBox[{"turnIntoAdjacencyMatrix", "[", 
           RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"zz_", "/;", 
             RowBox[{"(", 
              RowBox[{"zz", ">", "1"}], ")"}]}], "\[Rule]", "1"}], "}"}]}], 
         "]"}], ",", 
        RowBox[{"AdjacencyGraph", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"turnIntoAdjacencyMatrix", "@@", 
            RowBox[{"collapseBivalentNodesNEW", "[", 
             RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ")"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"zz_", "/;", 
             RowBox[{"(", 
              RowBox[{"zz", ">", "1"}], ")"}]}], "\[Rule]", "1"}], "}"}]}], 
         "]"}]}], "]"}], "=!=", "True"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<Starting example: my alternative function for collapsing bivalent \
nodes gives a graph!\>\"", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"getKasteleynCheckQ", "[", 
      RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "True"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"getKasteleynCheckQ", "[", 
          RowBox[{
          "newa", ",", "newb", ",", "newc", ",", "newd", ",", "True"}], "]"}],
          "=!=", "True"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Print", "[", 
          "\"\<Starting example: Somehow collapsing the nodes hasn't \
preserved the index structure of BFTs!\>\"", "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"getNumberFaces", "[", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "=!=", 
         RowBox[{"getNumberFaces", "[", 
          RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], "]"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Print", "[", 
          "\"\<Starting example: We have somehow lost some faces when \
collapsing the bivalent nodes!\>\"", "]"}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"Normal", "[", 
        RowBox[{"EdgeCycleMatrix", "[", 
         RowBox[{"AdjacencyGraph", "[", 
          RowBox[{"turnIntoAdjacencyMatrix", "[", 
           RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}], "]"}], 
        "]"}], "]"}], "=!=", 
      RowBox[{"Length", "[", 
       RowBox[{"Normal", "[", 
        RowBox[{"EdgeCycleMatrix", "[", 
         RowBox[{"AdjacencyGraph", "[", 
          RowBox[{"turnIntoAdjacencyMatrix", "[", 
           RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], "]"}], 
          "]"}], "]"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<Starting example: There is a different number of cycles in the \
graph before and after the collapse of bivalent nodes!\>\"", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Transpose", ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "c", ",", "b", ",", "d"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], "}"}], "=", 
    RowBox[{"collapseBivalentNodes", "[", 
     RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], "}"}], "=!=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"X", "[", 
              RowBox[{"1", ",", "10"}], "]"}], ",", 
             RowBox[{
              RowBox[{"X", "[", 
               RowBox[{"4", ",", "5"}], "]"}], "+", 
              RowBox[{"X", "[", 
               RowBox[{"5", ",", "2"}], "]"}], "+", 
              RowBox[{"X", "[", 
               RowBox[{"9", ",", "4"}], "]"}]}], ",", 
             RowBox[{"X", "[", 
              RowBox[{"2", ",", "1"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"X", "[", 
               RowBox[{"3", ",", "7"}], "]"}], "+", 
              RowBox[{"X", "[", 
               RowBox[{"7", ",", "1"}], "]"}]}], ",", "0", ",", 
             RowBox[{"Y", "[", 
              RowBox[{"1", ",", "3"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"X", "[", 
              RowBox[{"6", ",", "3"}], "]"}], ",", 
             RowBox[{"X", "[", 
              RowBox[{"2", ",", "6"}], "]"}], ",", 
             RowBox[{"X", "[", 
              RowBox[{"3", ",", "2"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"X", "[", 
               RowBox[{"8", ",", "6"}], "]"}], "+", 
              RowBox[{"X", "[", 
               RowBox[{"9", ",", "8"}], "]"}]}], ",", 
             RowBox[{"X", "[", 
              RowBox[{"6", ",", "9"}], "]"}], ",", "0"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"X", "[", 
              RowBox[{"10", ",", "11"}], "]"}], ",", 
             RowBox[{"X", "[", 
              RowBox[{"11", ",", "9"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"X", "[", 
             RowBox[{"10", ",", "9"}], "]"}], ",", "0", ",", "0"}], "}"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0"}], "}"}], "}"}]}], "}"}]}], "&&", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], "}"}], "=!=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"X", "[", 
              RowBox[{"3", ",", "2"}], "]"}], ",", 
             RowBox[{"X", "[", 
              RowBox[{"2", ",", "6"}], "]"}], ",", 
             RowBox[{"X", "[", 
              RowBox[{"6", ",", "3"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"X", "[", 
              RowBox[{"6", ",", "9"}], "]"}], ",", 
             RowBox[{
              RowBox[{"X", "[", 
               RowBox[{"8", ",", "6"}], "]"}], "+", 
              RowBox[{"X", "[", 
               RowBox[{"9", ",", "8"}], "]"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Y", "[", 
              RowBox[{"1", ",", "3"}], "]"}], ",", "0", ",", 
             RowBox[{
              RowBox[{"X", "[", 
               RowBox[{"3", ",", "7"}], "]"}], "+", 
              RowBox[{"X", "[", 
               RowBox[{"7", ",", "1"}], "]"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"X", "[", 
              RowBox[{"2", ",", "1"}], "]"}], ",", 
             RowBox[{
              RowBox[{"X", "[", 
               RowBox[{"4", ",", "5"}], "]"}], "+", 
              RowBox[{"X", "[", 
               RowBox[{"5", ",", "2"}], "]"}], "+", 
              RowBox[{"X", "[", 
               RowBox[{"9", ",", "4"}], "]"}]}], ",", 
             RowBox[{"X", "[", 
              RowBox[{"1", ",", "10"}], "]"}]}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"X", "[", 
              RowBox[{"10", ",", "11"}], "]"}], ",", 
             RowBox[{"X", "[", 
              RowBox[{"11", ",", "9"}], "]"}]}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", 
            RowBox[{"X", "[", 
             RowBox[{"10", ",", "9"}], "]"}]}], "}"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0"}], "}"}], "}"}]}], "}"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<Starting example: The result after collapsing the nodes doesn't \
give the same result as when I first created the function!\>\"", "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Map", "[", 
       RowBox[{"Dimensions", ",", 
        RowBox[{"collapseBivalentNodesNEW", "[", 
         RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], "]"}], "=!=", 
      RowBox[{"Map", "[", 
       RowBox[{"Dimensions", ",", 
        RowBox[{"{", 
         RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], "}"}]}], 
       "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<Starting example: my alternative function for collapsing bivalent \
nodes doesn't yield Kasteleyn-components of the same dimension!\>\"", "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Sort", "[", 
       RowBox[{"Map", "[", 
        RowBox[{"Sort", ",", 
         RowBox[{"joinupKasteleyn", "@@", 
          RowBox[{"collapseBivalentNodesNEW", "[", 
           RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}]}], "]"}], 
       "]"}], "=!=", 
      RowBox[{"Sort", "[", 
       RowBox[{"Map", "[", 
        RowBox[{"Sort", ",", 
         RowBox[{"joinupKasteleyn", "@@", 
          RowBox[{"{", 
           RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], "}"}]}]}],
         "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<Starting example: my alternative function for collapsing bivalent \
nodes gives a different Kasteleyn!\>\"", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"IsomorphicGraphQ", "[", 
       RowBox[{
        RowBox[{"AdjacencyGraph", "[", 
         RowBox[{
          RowBox[{"turnIntoAdjacencyMatrix", "[", 
           RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"zz_", "/;", 
             RowBox[{"(", 
              RowBox[{"zz", ">", "1"}], ")"}]}], "\[Rule]", "1"}], "}"}]}], 
         "]"}], ",", 
        RowBox[{"AdjacencyGraph", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"turnIntoAdjacencyMatrix", "@@", 
            RowBox[{"collapseBivalentNodesNEW", "[", 
             RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ")"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"zz_", "/;", 
             RowBox[{"(", 
              RowBox[{"zz", ">", "1"}], ")"}]}], "\[Rule]", "1"}], "}"}]}], 
         "]"}]}], "]"}], "=!=", "True"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<Starting example: my alternative function for collapsing bivalent \
nodes gives a graph!\>\"", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"getKasteleynCheckQ", "[", 
      RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "True"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"getKasteleynCheckQ", "[", 
          RowBox[{
          "newa", ",", "newb", ",", "newc", ",", "newd", ",", "True"}], "]"}],
          "=!=", "True"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Print", "[", 
          "\"\<Starting example: Somehow collapsing the nodes hasn't \
preserved the index structure of BFTs!\>\"", "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"getNumberFaces", "[", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "=!=", 
         RowBox[{"getNumberFaces", "[", 
          RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], "]"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "Print", "[", 
          "\"\<Starting example: We have somehow lost some faces when \
collapsing the bivalent nodes!\>\"", "]"}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"Normal", "[", 
        RowBox[{"EdgeCycleMatrix", "[", 
         RowBox[{"AdjacencyGraph", "[", 
          RowBox[{"turnIntoAdjacencyMatrix", "[", 
           RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}], "]"}], 
        "]"}], "]"}], "=!=", 
      RowBox[{"Length", "[", 
       RowBox[{"Normal", "[", 
        RowBox[{"EdgeCycleMatrix", "[", 
         RowBox[{"AdjacencyGraph", "[", 
          RowBox[{"turnIntoAdjacencyMatrix", "[", 
           RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], "]"}], 
          "]"}], "]"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<Starting example: There is a different number of cycles in the \
graph before and after the collapse of bivalent nodes!\>\"", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"formatrule", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["XX_", 
      RowBox[{"z1_", ",", "z2_"}]], "\[Rule]", 
     RowBox[{"XX", "[", 
      RowBox[{"z1", ",", "z2"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ii", "=", "1"}], ",", 
    RowBox[{"ii", "\[LessEqual]", "110"}], ",", 
    RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{"ii", ",", "10"}], "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<ii=\>\"", ",", "ii"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     SubscriptBox["bft", "ii"], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"a", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b", "=", 
      RowBox[{"b", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"c", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"d", "=", 
      RowBox[{"d", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"allcasestotryout", "=", 
      RowBox[{"Subsets", "[", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", "0"}], "&"}], ",", 
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{"Variables", "[", 
            RowBox[{"Join", "[", 
             RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}], ",", 
           "5"}], "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"jj", "=", "1"}], ",", 
       RowBox[{"jj", "\[LessEqual]", 
        RowBox[{"Length", "[", "allcasestotryout", "]"}]}], ",", 
       RowBox[{"jj", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        SubscriptBox["bft", "ii"], ";", "\[IndentingNewLine]", 
        RowBox[{"a", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"a", "/.", "formatrule"}], ")"}], "/.", 
          RowBox[{"allcasestotryout", "[", 
           RowBox[{"[", "jj", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"b", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"b", "/.", "formatrule"}], ")"}], "/.", 
          RowBox[{"allcasestotryout", "[", 
           RowBox[{"[", "jj", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"c", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"c", "/.", "formatrule"}], ")"}], "/.", 
          RowBox[{"allcasestotryout", "[", 
           RowBox[{"[", "jj", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"d", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"d", "/.", "formatrule"}], ")"}], "/.", 
          RowBox[{"allcasestotryout", "[", 
           RowBox[{"[", "jj", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], "}"}], "=", 
         RowBox[{"collapseBivalentNodes", "[", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{"Dimensions", ",", 
             RowBox[{"collapseBivalentNodesNEW", "[", 
              RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], "]"}], "=!=", 
           RowBox[{"Map", "[", 
            RowBox[{"Dimensions", ",", 
             RowBox[{"{", 
              RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], 
              "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<ii=\>\"", ",", "ii", ",", 
             "\"\< : my alternative function for collapsing bivalent nodes \
doesn't yield Kasteleyn-components of the same dimension!\>\""}], "]"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Sort", "[", 
            RowBox[{"Map", "[", 
             RowBox[{"Sort", ",", 
              RowBox[{"joinupKasteleyn", "@@", 
               RowBox[{"collapseBivalentNodesNEW", "[", 
                RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}]}], "]"}],
             "]"}], "=!=", 
           RowBox[{"Sort", "[", 
            RowBox[{"Map", "[", 
             RowBox[{"Sort", ",", 
              RowBox[{"joinupKasteleyn", "@@", 
               RowBox[{"{", 
                RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], 
                "}"}]}]}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<ii=\>\"", ",", "ii", ",", 
             "\"\< : my alternative function for collapsing bivalent nodes \
gives a different Kasteleyn!\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"IsomorphicGraphQ", "[", 
            RowBox[{
             RowBox[{"AdjacencyGraph", "[", 
              RowBox[{
               RowBox[{"turnIntoAdjacencyMatrix", "[", 
                RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], 
                "]"}], "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"zz_", "/;", 
                  RowBox[{"(", 
                   RowBox[{"zz", ">", "1"}], ")"}]}], "\[Rule]", "1"}], 
                "}"}]}], "]"}], ",", 
             RowBox[{"AdjacencyGraph", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"turnIntoAdjacencyMatrix", "@@", 
                 RowBox[{"collapseBivalentNodesNEW", "[", 
                  RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ")"}],
                "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"zz_", "/;", 
                  RowBox[{"(", 
                   RowBox[{"zz", ">", "1"}], ")"}]}], "\[Rule]", "1"}], 
                "}"}]}], "]"}]}], "]"}], "=!=", "True"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<ii=\>\"", ",", "ii", ",", 
             "\"\< : my alternative function for collapsing bivalent nodes \
gives a graph!\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"getDuplicateEdges", "[", 
             RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "\[Equal]", 
            RowBox[{"{", "}"}]}], "&&", 
           RowBox[{"getEdgesBFTformQ", "[", 
            RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "&&", 
           RowBox[{
            RowBox[{"getKasteleynConsistencyViolation", "[", 
             RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "===", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "}"}]}], "}"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"getKasteleynCheckQ", "[", 
               RowBox[{
               "newa", ",", "newb", ",", "newc", ",", "newd", ",", "True"}], 
               "]"}], "=!=", "True"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<ii=\>\"", ",", "ii", ",", 
                "\"\< : Somehow collapsing the nodes hasn't preserved the \
index structure of BFTs!\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"getNumberFaces", "[", 
               RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "=!=", 
              RowBox[{"getNumberFaces", "[", 
               RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], 
               "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<ii=\>\"", ",", "ii", ",", 
                "\"\< : We have somehow lost some faces when collapsing the \
bivalent nodes!\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}],
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"Normal", "[", 
             RowBox[{"EdgeCycleMatrix", "[", 
              RowBox[{"AdjacencyGraph", "[", 
               RowBox[{"turnIntoAdjacencyMatrix", "[", 
                RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}], 
              "]"}], "]"}], "]"}], "=!=", 
           RowBox[{"Length", "[", 
            RowBox[{"Normal", "[", 
             RowBox[{"EdgeCycleMatrix", "[", 
              RowBox[{"AdjacencyGraph", "[", 
               RowBox[{"turnIntoAdjacencyMatrix", "[", 
                RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], 
                "]"}], "]"}], "]"}], "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<ii=\>\"", ",", "ii", ",", 
             "\"\< : There is a different number of cycles in the graph \
before and after the collapse of bivalent nodes!\>\""}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], 
  ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.664781819710851*^9, 3.66478198207829*^9}, {
   3.6647820277729077`*^9, 3.6647820661125183`*^9}, 3.6647822947623367`*^9, {
   3.664782367011778*^9, 3.664782405137395*^9}, {3.66478245916627*^9, 
   3.664782540993922*^9}, 3.6647827017368417`*^9, {3.6647828039884424`*^9, 
   3.664782898580064*^9}, {3.6647829297236333`*^9, 3.6647829520229616`*^9}, 
   3.664782983955406*^9, {3.66478439381633*^9, 3.664784454309479*^9}, {
   3.6647844865795813`*^9, 3.6647845167036495`*^9}, {3.664784914565*^9, 
   3.6647849834988747`*^9}, {3.6647893830056033`*^9, 
   3.6647894076633363`*^9}, {3.6670474671026745`*^9, 3.6670474672901683`*^9}, 
   3.667048782777152*^9, {3.667571624499669*^9, 3.6675716441876526`*^9}, {
   3.670244519128513*^9, 3.670244528314185*^9}, {3.6709104200095353`*^9, 
   3.670910483539136*^9}, {3.6709105173352757`*^9, 3.670910613249056*^9}, {
   3.670910645574507*^9, 3.670910653288369*^9}, {3.6709108673310013`*^9, 
   3.6709108674290533`*^9}, {3.670910901148337*^9, 3.670910924499362*^9}, {
   3.670910989695868*^9, 3.670911033859152*^9}, {3.670911071219535*^9, 
   3.670911220682269*^9}, {3.670911351397422*^9, 3.6709115290810776`*^9}, {
   3.6709115996768923`*^9, 3.670911613455324*^9}, {3.670911838108729*^9, 
   3.670911846025834*^9}, {3.6709118944544783`*^9, 3.670911949940152*^9}, {
   3.670911997766349*^9, 3.6709120297574253`*^9}, {3.6709120710165014`*^9, 
   3.6709121598355923`*^9}, {3.67091219189585*^9, 3.6709122194937067`*^9}, 
   3.6709122877527046`*^9, {3.6709123503578634`*^9, 3.670912371447871*^9}, {
   3.6709124124790955`*^9, 3.6709124139626703`*^9}, {3.6709125427631283`*^9, 
   3.6709125441335583`*^9}, {3.670912586473938*^9, 3.670912601782899*^9}, {
   3.670912657824276*^9, 3.6709126827225056`*^9}, {3.6709127131691833`*^9, 
   3.6709127158601255`*^9}, {3.670912816691945*^9, 3.6709128320409822`*^9}, {
   3.670912881185275*^9, 3.670912948379197*^9}, {3.6709130383202834`*^9, 
   3.6709130411598625`*^9}, 3.6709134828250136`*^9, {3.6709136558342714`*^9, 
   3.6709137235961*^9}, {3.670914085817363*^9, 3.6709141326870584`*^9}, {
   3.6709142326146603`*^9, 3.6709143133373947`*^9}, {3.670915304877978*^9, 
   3.6709153330098486`*^9}, {3.6709199720758567`*^9, 3.670920000122165*^9}, {
   3.6709201894332714`*^9, 3.6709202033904867`*^9}, {3.670920242872819*^9, 
   3.6709202845685506`*^9}, 3.670920371625329*^9, {3.671464302064674*^9, 
   3.6714643173337812`*^9}, {3.6715195348011627`*^9, 3.671519541782634*^9}, {
   3.6715375736640205`*^9, 3.671537601135741*^9}, {3.6715377239359136`*^9, 
   3.671537781839789*^9}, {3.67153794444967*^9, 3.671537960916589*^9}, {
   3.6715380167244787`*^9, 3.6715380328897924`*^9}, {3.671538112649024*^9, 
   3.671538121834077*^9}, {3.67154377442666*^9, 3.671543782986151*^9}, {
   3.6715443407002096`*^9, 3.6715443559713306`*^9}, 3.671545014505333*^9, 
   3.671545067505432*^9, 3.6715451617551527`*^9, {3.6715452862933564`*^9, 
   3.671545291233541*^9}, {3.672747592219042*^9, 3.672747606510509*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "110"}],
  SequenceForm["ii=", 110],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6709203946771207`*^9, 3.670920400806918*^9}, 
   3.6712613562170506`*^9, 3.671519565146993*^9, 3.6715288401757812`*^9, 
   3.671530291776558*^9, 3.6715382250261064`*^9, 3.6715382654026856`*^9, 
   3.6727476027464094`*^9}]
}, Closed]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6709203864459443`*^9, 3.670920386626472*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Here", " ", "we", " ", "check", " ", "bubblesQ"}], ",", " ", 
   "removeBubbles"}], "*)"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6647893950303826`*^9, 3.6647894076633363`*^9}, {
   3.667049585039831*^9, 3.667049586467121*^9}, {3.67023348873209*^9, 
   3.67023349002195*^9}, 3.67091001914213*^9, {3.670920880609946*^9, 
   3.6709208862418547`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"formatrule", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["XX_", 
      RowBox[{"z1_", ",", "z2_"}]], "\[Rule]", 
     RowBox[{"XX", "[", 
      RowBox[{"z1", ",", "z2"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ii", "=", "1"}], ",", 
    RowBox[{"ii", "\[LessEqual]", "110"}], ",", 
    RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{"ii", ",", "10"}], "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<ii=\>\"", ",", "ii"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     SubscriptBox["bft", "ii"], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"a", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b", "=", 
      RowBox[{"b", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"c", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"d", "=", 
      RowBox[{"d", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"allcasestotryout", "=", 
      RowBox[{"Subsets", "[", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", "0"}], "&"}], ",", 
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{"Variables", "[", 
            RowBox[{"Join", "[", 
             RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}], ",", 
           "5"}], "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"jj", "=", "1"}], ",", 
       RowBox[{"jj", "\[LessEqual]", 
        RowBox[{"Length", "[", "allcasestotryout", "]"}]}], ",", 
       RowBox[{"jj", "++"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        SubscriptBox["bft", "ii"], ";", "\[IndentingNewLine]", 
        RowBox[{"a", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"a", "/.", "formatrule"}], ")"}], "/.", 
          RowBox[{"allcasestotryout", "[", 
           RowBox[{"[", "jj", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"b", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"b", "/.", "formatrule"}], ")"}], "/.", 
          RowBox[{"allcasestotryout", "[", 
           RowBox[{"[", "jj", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"c", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"c", "/.", "formatrule"}], ")"}], "/.", 
          RowBox[{"allcasestotryout", "[", 
           RowBox[{"[", "jj", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"d", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"d", "/.", "formatrule"}], ")"}], "/.", 
          RowBox[{"allcasestotryout", "[", 
           RowBox[{"[", "jj", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], "}"}], "=", 
         RowBox[{"collapseBivalentNodes", "[", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"scatteringbubbles", "=", 
         RowBox[{"bubblesQ", "[", 
          RowBox[{
          "newa", ",", "newb", ",", "newc", ",", "newd", ",", "False"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"bft2bubbles", "=", 
         RowBox[{"bubblesQ", "[", 
          RowBox[{
          "newa", ",", "newb", ",", "newc", ",", "newd", ",", "True", ",", 
           "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"bft1bubbles", "=", 
         RowBox[{"bubblesQ", "[", 
          RowBox[{
          "newa", ",", "newb", ",", "newc", ",", "newd", ",", "True", ",", 
           "1"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"scatteringbubbles", "=!=", "bft2bubbles"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<ii=\>\"", ",", "ii", ",", 
             "\"\< : The scattering graph doesn't seem to see the same \
bubbles as the BFT graph under gauging 2!\>\""}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ii", "\[NotEqual]", "106"}], "&&", 
           RowBox[{"ii", "\[NotEqual]", "107"}], "&&", 
           RowBox[{"ii", "\[NotEqual]", "110"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{"scatteringbubbles", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"reducibilityQ", "[", 
                  RowBox[{
                  "a", ",", "b", ",", "c", ",", "d", ",", "False", ",", 
                   "False"}], "]"}], "=!=", "True"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{
                  "\"\<ii=\>\"", ",", "ii", ",", 
                   "\"\< : The scattering graph has bubbles but is declared \
to not be reducible!\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
              ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ii", "\[NotEqual]", "106"}], "&&", 
           RowBox[{"ii", "\[NotEqual]", "107"}], "&&", 
           RowBox[{"ii", "\[NotEqual]", "110"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{"bft2bubbles", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"reducibilityQ", "[", 
                  RowBox[{
                  "a", ",", "b", ",", "c", ",", "d", ",", "False", ",", 
                   "True", ",", "2"}], "]"}], "=!=", "True"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{
                  "\"\<ii=\>\"", ",", "ii", ",", 
                   "\"\< : The BFT graph (gauging 2) has bubbles but is \
declared to not be reducible!\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", 
               "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"getDuplicateEdges", "[", 
             RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "\[Equal]", 
            RowBox[{"{", "}"}]}], "&&", 
           RowBox[{"getEdgesBFTformQ", "[", 
            RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "&&", 
           RowBox[{
            RowBox[{"getKasteleynConsistencyViolation", "[", 
             RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "===", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "}"}]}], "}"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"ii", "\[NotEqual]", "106"}], "&&", 
              RowBox[{"ii", "\[NotEqual]", "107"}], "&&", 
              RowBox[{"ii", "\[NotEqual]", "110"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{"bft1bubbles", ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"reducibilityQ", "[", 
                    RowBox[{
                    "a", ",", "b", ",", "c", ",", "d", ",", "False", ",", 
                    "True", ",", "1"}], "]"}], "=!=", "True"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<ii=\>\"", ",", "ii", ",", 
                    "\"\< : The BFT graph (gauging 1) has bubbles but is \
declared to not be reducible!\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", 
                  "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"bft2bubbles", "&&", 
              RowBox[{"bft1bubbles", "\[Equal]", "False"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"Or", "@@", 
                  RowBox[{"Flatten", "[", 
                   RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Count", "[", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    RowBox[{"joinupKasteleyn", "[", 
                    RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], 
                    "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"_", "[", 
                    RowBox[{"#", ",", "_"}], "]"}], "|", 
                    RowBox[{"_", "[", 
                    RowBox[{"_", ",", "#"}], "]"}]}]}], "]"}], "\[Equal]", 
                    "2"}], "&"}], ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Intersection", "@@", 
                    RowBox[{"(", 
                    RowBox[{"List", "@@@", 
                    RowBox[{"Variables", "[", "#", "]"}]}], ")"}]}], "&"}], 
                    ",", 
                    RowBox[{"Cases", "[", 
                    RowBox[{
                    RowBox[{"joinupKasteleyn", "[", 
                    RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], 
                    "]"}], ",", 
                    RowBox[{"firstedge_", "+", "secondedge_"}], ",", "2"}], 
                    "]"}]}], "]"}], ",", 
                    RowBox[{"{", "2", "}"}]}], "]"}], "]"}]}], ")"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{
                  "\"\<ii=\>\"", ",", "ii", ",", 
                   "\"\< : The BFT graph has bubbles under gauging 2, but not \
under gauging 1, even though the bubble-edges have shared which only appear \
exactly in these two edges, which is the requirement for a gauging 1 bubble\>\
\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"adjmat", "=", 
         RowBox[{"turnIntoAdjacencyMatrix", "[", 
          RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], "]"}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"adjmat", ",", 
             RowBox[{"zz_", "/;", 
              RowBox[{"zz", ">", "1"}]}], ",", "2"}], "]"}], "=!=", 
           "bft2bubbles"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<ii=\>\"", ",", "ii", ",", 
             "\"\< : bubbblesQ doesn't agree with the adjacency matrix having \
entries greater than 1 \>\"", ",", "bft2bubbles"}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "killbubbblesAscattering", ",", "killbubbblesBscattering", ",", 
           "killbubbblesCscattering", ",", "killbubbblesDscattering"}], "}"}],
          "=", 
         RowBox[{"removeBubbles", "[", 
          RowBox[{
          "newa", ",", "newb", ",", "newc", ",", "newd", ",", "False"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "killbubbblesAbft2", ",", "killbubbblesBbft2", ",", 
           "killbubbblesCbft2", ",", "killbubbblesDbft2"}], "}"}], "=", 
         RowBox[{"removeBubbles", "[", 
          RowBox[{
          "newa", ",", "newb", ",", "newc", ",", "newd", ",", "True", ",", 
           "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "killbubbblesAbft1", ",", "killbubbblesBbft1", ",", 
           "killbubbblesCbft1", ",", "killbubbblesDbft1"}], "}"}], "=", 
         RowBox[{"removeBubbles", "[", 
          RowBox[{
          "newa", ",", "newb", ",", "newc", ",", "newd", ",", "True", ",", 
           "1"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "killbubbblesAscattering", ",", "killbubbblesBscattering", ",", 
             "killbubbblesCscattering", ",", "killbubbblesDscattering"}], 
            "}"}], "=!=", 
           RowBox[{"{", 
            RowBox[{
            "killbubbblesAbft2", ",", "killbubbblesBbft2", ",", 
             "killbubbblesCbft2", ",", "killbubbblesDbft2"}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<ii=\>\"", ",", "ii", ",", 
             "\"\< : The removal of bubbles is acting differently for \
scattering and BFT (gauging 2) graphs!\>\""}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "killbubbblesAbft2", ",", "killbubbblesBbft2", ",", 
               "killbubbblesCbft2", ",", "killbubbblesDbft2"}], "}"}], "===", 
             RowBox[{"{", 
              RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], 
              "}"}]}], ")"}], "=!=", 
           RowBox[{"(", 
            RowBox[{"bft2bubbles", "=!=", "True"}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<ii=\>\"", ",", "ii", ",", 
             "\"\< : For gauging 2, the action of removeBubbles is at odds \
with what bubblesQ says (either it has bubbles but the graph doesn't change, \
or the graph removed bubbles even though bubblesQ says there aren't \
any)\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "killbubbblesAbft1", ",", "killbubbblesBbft1", ",", 
               "killbubbblesCbft1", ",", "killbubbblesDbft1"}], "}"}], "===", 
             RowBox[{"{", 
              RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], 
              "}"}]}], ")"}], "=!=", 
           RowBox[{"(", 
            RowBox[{"bft1bubbles", "=!=", "True"}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<ii=\>\"", ",", "ii", ",", 
             "\"\< : For gauging 1, the action of removeBubbles is at odds \
with what bubblesQ says (either it has bubbles but the graph doesn't change, \
or the graph removed bubbles even though bubblesQ says there aren't \
any)\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"getDuplicateEdges", "[", 
            RowBox[{
            "killbubbblesAbft1", ",", "killbubbblesBbft1", ",", 
             "killbubbblesCbft1", ",", "killbubbblesDbft1"}], "]"}], "=!=", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<ii=\>\"", ",", "ii", ",", 
             "\"\< : The removal of bubbles caused duplicate edges to appear \
in the Kasteleyn for BFT under gauging 1!\>\""}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"getDuplicateEdges", "[", 
            RowBox[{
            "killbubbblesAbft2", ",", "killbubbblesBbft2", ",", 
             "killbubbblesCbft2", ",", "killbubbblesDbft2"}], "]"}], "=!=", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<ii=\>\"", ",", "ii", ",", 
             "\"\< : The removal of bubbles caused duplicate edges to appear \
in the Kasteleyn for BFT under gauging 2!\>\""}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"getDuplicateEdges", "[", 
             RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], "]"}], 
            "\[Equal]", 
            RowBox[{"{", "}"}]}], "&&", 
           RowBox[{"getEdgesBFTformQ", "[", 
            RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], "]"}], "&&", 
           RowBox[{
            RowBox[{"getKasteleynConsistencyViolation", "[", 
             RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], "]"}], "===", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "}"}]}], "}"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"getKasteleynCheckQ", "[", 
               RowBox[{
               "killbubbblesAbft1", ",", "killbubbblesBbft1", ",", 
                "killbubbblesCbft1", ",", "killbubbblesDbft1", ",", "True"}], 
               "]"}], "=!=", "True"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<ii=\>\"", ",", "ii", ",", 
                "\"\< : Somehow removing bubbles hasn't preserved the index \
structure of BFTs!\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"turnIntoAdjacencyMatrix", "[", 
            RowBox[{
            "killbubbblesAbft2", ",", "killbubbblesBbft2", ",", 
             "killbubbblesCbft2", ",", "killbubbblesDbft2"}], "]"}], "=!=", 
           RowBox[{"(", 
            RowBox[{"adjmat", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"zz_", "/;", 
                RowBox[{"(", 
                 RowBox[{"zz", ">", "1"}], ")"}]}], "\[Rule]", "1"}], "}"}]}],
             ")"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<ii=\>\"", ",", "ii", ",", 
             "\"\< : For BFT graphs under gauging 2, removeBubbles doesn't \
seem to have produced the result in the adjacency matrix of turning to 1 \
entries which were greater than one!\>\""}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.664781819710851*^9, 3.66478198207829*^9}, {
   3.6647820277729077`*^9, 3.6647820661125183`*^9}, 3.6647822947623367`*^9, {
   3.664782367011778*^9, 3.664782405137395*^9}, {3.66478245916627*^9, 
   3.664782540993922*^9}, 3.6647827017368417`*^9, {3.6647828039884424`*^9, 
   3.664782898580064*^9}, {3.6647829297236333`*^9, 3.6647829520229616`*^9}, 
   3.664782983955406*^9, {3.66478439381633*^9, 3.664784454309479*^9}, {
   3.6647844865795813`*^9, 3.6647845167036495`*^9}, {3.664784914565*^9, 
   3.6647849834988747`*^9}, {3.6647893830056033`*^9, 
   3.6647894076633363`*^9}, {3.6670474671026745`*^9, 3.6670474672901683`*^9}, 
   3.667048782777152*^9, {3.667571624499669*^9, 3.6675716441876526`*^9}, {
   3.670244519128513*^9, 3.670244528314185*^9}, {3.6709104200095353`*^9, 
   3.670910483539136*^9}, {3.6709105173352757`*^9, 3.670910613249056*^9}, {
   3.670910645574507*^9, 3.670910653288369*^9}, {3.6709108673310013`*^9, 
   3.6709108674290533`*^9}, {3.670910901148337*^9, 3.670910924499362*^9}, {
   3.670910989695868*^9, 3.670911033859152*^9}, {3.670911071219535*^9, 
   3.670911220682269*^9}, {3.670911351397422*^9, 3.6709115290810776`*^9}, {
   3.6709115996768923`*^9, 3.670911613455324*^9}, {3.670911838108729*^9, 
   3.670911846025834*^9}, {3.6709118944544783`*^9, 3.670911949940152*^9}, {
   3.670911997766349*^9, 3.6709120297574253`*^9}, {3.6709120710165014`*^9, 
   3.6709121598355923`*^9}, {3.67091219189585*^9, 3.6709122194937067`*^9}, 
   3.6709122877527046`*^9, {3.6709123503578634`*^9, 3.670912371447871*^9}, {
   3.6709124124790955`*^9, 3.6709124139626703`*^9}, {3.6709125427631283`*^9, 
   3.6709125441335583`*^9}, {3.670912586473938*^9, 3.670912601782899*^9}, {
   3.670912657824276*^9, 3.6709126827225056`*^9}, {3.6709127131691833`*^9, 
   3.6709127158601255`*^9}, {3.670912816691945*^9, 3.6709128320409822`*^9}, {
   3.670912881185275*^9, 3.670912948379197*^9}, {3.6709130383202834`*^9, 
   3.6709130411598625`*^9}, 3.6709134828250136`*^9, {3.6709136558342714`*^9, 
   3.6709137235961*^9}, {3.670914085817363*^9, 3.6709141326870584`*^9}, {
   3.6709142326146603`*^9, 3.6709143133373947`*^9}, {3.670915304877978*^9, 
   3.6709153330098486`*^9}, {3.6709199720758567`*^9, 3.670920000122165*^9}, {
   3.6709201894332714`*^9, 3.6709202033904867`*^9}, {3.670920242872819*^9, 
   3.6709202845685506`*^9}, 3.670920371625329*^9, {3.67092094500834*^9, 
   3.6709210050490236`*^9}, {3.670921181539347*^9, 3.670921347036747*^9}, {
   3.670921581602537*^9, 3.670921583846383*^9}, {3.670921668755324*^9, 
   3.6709216696992855`*^9}, {3.670921701038556*^9, 3.6709217092945414`*^9}, {
   3.670921951057428*^9, 3.6709219736569033`*^9}, {3.670923557860277*^9, 
   3.670923740702423*^9}, {3.6711806272308908`*^9, 3.6711806291505103`*^9}, {
   3.671180770792122*^9, 3.671180776920453*^9}, {3.6711850605534196`*^9, 
   3.671185107856476*^9}, {3.6711856353217745`*^9, 3.6711856664678745`*^9}, {
   3.671185940099115*^9, 3.6711859589609222`*^9}, {3.6711860621969643`*^9, 
   3.671186078877637*^9}, {3.671186137117034*^9, 3.6711861962369795`*^9}, {
   3.671186229913108*^9, 3.6711862596264524`*^9}, {3.6711864166326313`*^9, 
   3.671186482704314*^9}, {3.671186561754046*^9, 3.671186565992087*^9}, {
   3.6711866136144*^9, 3.6711866222941666`*^9}, {3.671186975113619*^9, 
   3.671186989984462*^9}, {3.6711870218638*^9, 3.6711870272972755`*^9}, 
   3.671187263770239*^9, {3.6711873717966604`*^9, 3.671187377601221*^9}, 
   3.671188081312666*^9, {3.6711886770722337`*^9, 3.6711886880917587`*^9}, {
   3.671188720581915*^9, 3.6711887209436607`*^9}, {3.671191095241579*^9, 
   3.6711910953728*^9}, {3.6711911440062494`*^9, 3.671191195964123*^9}, {
   3.6711914673556395`*^9, 3.671191538574589*^9}, {3.6711915915923185`*^9, 
   3.6711916635904813`*^9}, {3.6711918077105265`*^9, 
   3.6711918973765507`*^9}, {3.6711919982763977`*^9, 
   3.6711920142937403`*^9}, {3.6711920654310446`*^9, 3.671192138288003*^9}, {
   3.6711921750304976`*^9, 3.671192210005745*^9}, {3.6711922536057405`*^9, 
   3.671192255424406*^9}, {3.6711924535783424`*^9, 3.6711924763186398`*^9}, {
   3.6711925669231076`*^9, 3.671192601549764*^9}, {3.6711927168449135`*^9, 
   3.6711927416194983`*^9}, {3.6711928936644382`*^9, 3.671192943266226*^9}, {
   3.671193003271166*^9, 3.6711930217250357`*^9}, 3.671193072263878*^9, 
   3.6711931174707413`*^9, {3.671193166927243*^9, 3.671193167364518*^9}, {
   3.671193228584111*^9, 3.6711932289848137`*^9}, {3.6711946047091045`*^9, 
   3.671194611212427*^9}, {3.671194689892874*^9, 3.6711947353024483`*^9}, {
   3.67119482850189*^9, 3.671194918448003*^9}, {3.671194979206033*^9, 
   3.671195019714262*^9}, {3.671195109244729*^9, 3.67119511112999*^9}, {
   3.6715443570415144`*^9, 3.6715443732618895`*^9}, {3.671545015125963*^9, 
   3.6715450168357124`*^9}, {3.6715450683153877`*^9, 3.671545069089739*^9}, {
   3.671545162473369*^9, 3.6715451633495407`*^9}, 3.6715452920603304`*^9, {
   3.6727476165995913`*^9, 3.6727476185994043`*^9}, {3.6727485270274935`*^9, 
   3.672748593167012*^9}, 3.672748627441293*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "110"}],
  SequenceForm["ii=", 110],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.670921280066521*^9, {3.670921312577161*^9, 3.670921347392189*^9}, 
   3.6709219747798557`*^9, 3.6709237419986277`*^9, {3.671180615936412*^9, 
   3.671180629570834*^9}, 3.671180782698709*^9, 3.6711850304537597`*^9, {
   3.6711850990862103`*^9, 3.6711851082783737`*^9}, 3.6711856669733686`*^9, 
   3.6711859597113695`*^9, 3.6711862008126955`*^9, 3.671186484200265*^9, 
   3.671186566463196*^9, 3.671186623593872*^9, {3.6711869788579297`*^9, 
   3.6711869903080463`*^9}, 3.6711870277372656`*^9, 3.6711872641079435`*^9, 
   3.6711873781486855`*^9, 3.6711880817504306`*^9, 3.6711886778999863`*^9, {
   3.6711887122521915`*^9, 3.671188750588504*^9}, 3.6711907947156873`*^9, {
   3.671191181899227*^9, 3.671191196448194*^9}, {3.6711915130979447`*^9, 
   3.6711915392909727`*^9}, 3.671191656028266*^9, 3.671191898341058*^9, 
   3.6711920198553457`*^9, 3.6711921012663984`*^9, 3.6711921416563015`*^9, {
   3.671192210625723*^9, 3.6711922566314707`*^9}, 3.6711924979179587`*^9, 
   3.6711926030267153`*^9, {3.6711927301757603`*^9, 3.6711927545517435`*^9}, {
   3.6711929549598074`*^9, 3.6711929609391327`*^9}, 3.6711930223429685`*^9, {
   3.671193072964629*^9, 3.671193118208332*^9}, 3.671193956495117*^9, 
   3.671194613115265*^9, 3.6711946964929276`*^9, 3.67119474502979*^9, 
   3.671194919718176*^9, 3.6711950214482317`*^9, 3.671195165839884*^9, 
   3.6712609882575407`*^9, {3.671464364431492*^9, 3.6714643872890167`*^9}, 
   3.671464653996627*^9, 3.672747638352152*^9, 3.6727479990062037`*^9, {
   3.672748062879276*^9, 3.6727480742697277`*^9}, 3.672748620902563*^9}]
}, Closed]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6709203864459443`*^9, 3.670920386626472*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Here", " ", "we", " ", "check", " ", "squareMove"}], 
  "*)"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6647893950303826`*^9, 3.6647894076633363`*^9}, {
   3.667049585039831*^9, 3.667049586467121*^9}, {3.67023348873209*^9, 
   3.67023349002195*^9}, 3.67091001914213*^9, {3.670920880609946*^9, 
   3.6709208862418547`*^9}, {3.671261025522729*^9, 3.671261040436485*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CloseKernels", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LaunchKernels", "[", "4", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ParallelNeeds", "[", "\"\<bipartiteSUSY`\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"formatrule", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["XX_", 
      RowBox[{"z1_", ",", "z2_"}]], "\[Rule]", 
     RowBox[{"XX", "[", 
      RowBox[{"z1", ",", "z2"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ii", "=", "1"}], ",", 
    RowBox[{"ii", "\[LessEqual]", "110"}], ",", 
    RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ii", "\[NotEqual]", "26"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "33"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "79"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Mod", "[", 
             RowBox[{"ii", ",", "10"}], "]"}], "\[Equal]", "0"}], ",", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"\"\<ii=\>\"", ",", "ii"}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<ii=\>\"", ",", "ii"}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        SubscriptBox["bft", "ii"], ";", "\[IndentingNewLine]", 
        RowBox[{"a", "=", 
         RowBox[{"a", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"b", "=", 
         RowBox[{"b", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"c", "=", 
         RowBox[{"c", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"d", "=", 
         RowBox[{"d", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], "}"}], "=", 
         RowBox[{"collapseBivalentNodes", "[", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "First", " ", "do", " ", "the", " ", "square", " ", "moves", " ", 
          "for", " ", "BFTs"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"squarefaces", "=", 
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"getInternalFaceLabels", "[", 
              RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], "]"}], 
             ",", 
             RowBox[{"zz_", "/;", 
              RowBox[{
               RowBox[{"Count", "[", 
                RowBox[{
                 RowBox[{"Variables", "[", 
                  RowBox[{"Join", "[", 
                   RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], 
                   "]"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"_", "[", 
                   RowBox[{"zz", ",", "_"}], "]"}], "|", 
                  RowBox[{"_", "[", 
                   RowBox[{"_", ",", "zz"}], "]"}]}]}], "]"}], "\[Equal]", 
               "4"}]}]}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"squarefaces", "=", 
         RowBox[{"Cases", "[", 
          RowBox[{
           RowBox[{"getInternalFaceLabels", "[", 
            RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], "]"}], 
           ",", 
           RowBox[{"zz_", "/;", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Count", "[", 
                RowBox[{
                 RowBox[{"Variables", "[", 
                  RowBox[{"Join", "[", 
                   RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], 
                   "]"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"_", "[", 
                   RowBox[{"zz", ",", "_"}], "]"}], "|", 
                  RowBox[{"_", "[", 
                   RowBox[{"_", ",", "zz"}], "]"}]}]}], "]"}], "\[Equal]", 
               "4"}], "&&", 
              RowBox[{"MemberQ", "[", 
               RowBox[{
                RowBox[{"ConnectedComponents", "[", 
                 RowBox[{"AdjacencyGraph", "[", 
                  RowBox[{"turnIntoAdjacencyMatrix", "[", 
                   RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], 
                   "]"}], "]"}], "]"}], ",", 
                RowBox[{"Riffle", "[", 
                 RowBox[{
                  RowBox[{"Union", "[", 
                   RowBox[{"Flatten", "[", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}], "]"}], "]"}], "+", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "newa", "]"}], "+", 
                    RowBox[{"Length", "[", "newc", "]"}]}]}], "}"}]}], "&"}], 
                    ",", 
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"joinupKasteleyn", "[", 
                    RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"_", "[", 
                    RowBox[{"zz", ",", "_"}], "]"}], "|", 
                    RowBox[{"_", "[", 
                    RowBox[{"_", ",", "zz"}], "]"}]}]}], "]"}]}], "]"}], 
                    "]"}], "]"}], ",", "___", ",", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"-", "1"}], ",", "2"}], "}"}]}], "]"}]}], "]"}]}],
              ")"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Let", "'"}], "s", " ", "do", " ", "two", " ", "square", 
          " ", "moves", " ", "on", " ", "the", " ", "same", " ", "face", " ", 
          "and", " ", "see", " ", "if", " ", "we", " ", "return", " ", "to", 
          " ", "the", " ", "original", " ", "graph"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"doublesquaremoves", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"collapseBivalentNodes", "@@", 
             RowBox[{"squareMove", "[", 
              RowBox[{
               RowBox[{"Sequence", "@@", 
                RowBox[{"(", 
                 RowBox[{"collapseBivalentNodes", "@@", 
                  RowBox[{"squareMove", "[", 
                   RowBox[{
                   "newa", ",", "newb", ",", "newc", ",", "newd", ",", "#", 
                    ",", "True", ",", "True"}], "]"}]}], ")"}]}], ",", "#", 
               ",", "True", ",", "True"}], "]"}]}], "&"}], ",", 
           "squarefaces"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"areYouEqualToBefore", "=", 
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "thea", ",", "theb", ",", "thec", ",", "thed", ",", 
             "doublesquaremoveexample"}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Block", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "newa", ",", "newb", ",", "newc", ",", "newd", ",", 
               "doublesquaremovesguy", ",", "newkasteleyn", ",", 
               "oldkasteleyn", ",", "genericEDGE", ",", "cleanupvariablesnew",
                ",", "cleanupvariablesold", ",", "roworderingresult", ",", 
               "roworderingold", ",", "columnorderingresult", ",", 
               "columnorderingold", ",", "areyouequal"}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], 
                "}"}], "=", 
               RowBox[{"{", 
                RowBox[{"thea", ",", "theb", ",", "thec", ",", "thed"}], 
                "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{
              "doublesquaremovesguy", "=", "doublesquaremoveexample"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"newkasteleyn", "=", 
               RowBox[{"joinupKasteleyn", "@@", "doublesquaremovesguy"}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"oldkasteleyn", "=", 
               RowBox[{"joinupKasteleyn", "[", 
                RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], 
                "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"cleanupvariablesnew", "=", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "\[Rule]", 
                   RowBox[{"(", 
                    RowBox[{"genericEDGE", "@@", "#"}], ")"}]}], "&"}], ",", 
                 RowBox[{"Variables", "[", "newkasteleyn", "]"}]}], "]"}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"cleanupvariablesold", "=", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "\[Rule]", 
                   RowBox[{"(", 
                    RowBox[{"genericEDGE", "@@", "#"}], ")"}]}], "&"}], ",", 
                 RowBox[{"Variables", "[", "oldkasteleyn", "]"}]}], "]"}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"newkasteleyn", "=", 
               RowBox[{"newkasteleyn", "/.", "cleanupvariablesnew"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"oldkasteleyn", "=", 
               RowBox[{"oldkasteleyn", "/.", "cleanupvariablesold"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"doublesquaremovesguy", "=", 
               RowBox[{
               "doublesquaremovesguy", "/.", "cleanupvariablesnew"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], 
                "}"}], "=", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], 
                 "}"}], "/.", "cleanupvariablesold"}]}], ";", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"roworderingresult", "=", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"doublesquaremovesguy", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "#"}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "&"}], ",", 
                 RowBox[{"Variables", "[", 
                  RowBox[{"doublesquaremovesguy", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"roworderingresult", "=", 
               RowBox[{"Join", "[", 
                RowBox[{"roworderingresult", ",", 
                 RowBox[{
                  RowBox[{"Complement", "[", 
                   RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "[", 
                    RowBox[{"doublesquaremovesguy", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
                    "roworderingresult"}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"Ordering", "[", 
                    RowBox[{"Map", "[", 
                    RowBox[{"Variables", ",", 
                    RowBox[{"newkasteleyn", "[", 
                    RowBox[{"[", 
                    RowBox[{"Complement", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "[", 
                    RowBox[{"doublesquaremovesguy", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
                    "roworderingresult"}], "]"}], "]"}], "]"}]}], "]"}], 
                    "]"}], "]"}], "]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"roworderingresult", "=", 
               RowBox[{"Join", "[", 
                RowBox[{"roworderingresult", ",", 
                 RowBox[{
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"doublesquaremovesguy", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "#"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "&"}], ",", 
                    RowBox[{"Variables", "[", 
                    RowBox[{"doublesquaremovesguy", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "]"}], "+", 
                  RowBox[{"Length", "[", "roworderingresult", "]"}]}]}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"roworderingold", "=", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Position", "[", 
                    RowBox[{"newb", ",", "#"}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "&"}], ",", 
                 RowBox[{"Variables", "[", "newb", "]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"roworderingold", "=", 
               RowBox[{"Join", "[", 
                RowBox[{"roworderingold", ",", 
                 RowBox[{
                  RowBox[{"Complement", "[", 
                   RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "[", "newa", "]"}], "]"}], ",", 
                    "roworderingold"}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"Ordering", "[", 
                    RowBox[{"Map", "[", 
                    RowBox[{"Variables", ",", 
                    RowBox[{"oldkasteleyn", "[", 
                    RowBox[{"[", 
                    RowBox[{"Complement", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "[", "newa", "]"}], "]"}], ",", 
                    "roworderingold"}], "]"}], "]"}], "]"}]}], "]"}], "]"}], 
                   "]"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"roworderingold", "=", 
               RowBox[{"Join", "[", 
                RowBox[{"roworderingold", ",", 
                 RowBox[{
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{"newc", ",", "#"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "&"}], ",", 
                    RowBox[{"Variables", "[", "newc", "]"}]}], "]"}], "+", 
                  RowBox[{"Length", "[", "roworderingold", "]"}]}]}], "]"}]}],
               ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"columnorderingresult", "=", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"doublesquaremovesguy", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", "#"}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], "&"}], ",", 
                 RowBox[{"Variables", "[", 
                  RowBox[{"doublesquaremovesguy", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"columnorderingresult", "=", 
               RowBox[{"Join", "[", 
                RowBox[{"columnorderingresult", ",", 
                 RowBox[{
                  RowBox[{"Complement", "[", 
                   RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"Dimensions", "[", 
                    RowBox[{"doublesquaremovesguy", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
                    "columnorderingresult"}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"Ordering", "[", 
                    RowBox[{"Map", "[", 
                    RowBox[{"Variables", ",", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{"newkasteleyn", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"Complement", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"Dimensions", "[", 
                    RowBox[{"doublesquaremovesguy", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
                    "columnorderingresult"}], "]"}]}], "]"}], "]"}], "]"}]}], 
                    "]"}], "]"}], "]"}], "]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"columnorderingresult", "=", 
               RowBox[{"Join", "[", 
                RowBox[{"columnorderingresult", ",", 
                 RowBox[{
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"doublesquaremovesguy", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "#"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], "&"}], ",", 
                    RowBox[{"Variables", "[", 
                    RowBox[{"doublesquaremovesguy", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}], "+", 
                  RowBox[{"Length", "[", "columnorderingresult", "]"}]}]}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"columnorderingold", "=", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Position", "[", 
                    RowBox[{"newc", ",", "#"}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], "&"}], ",", 
                 RowBox[{"Variables", "[", "newc", "]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"columnorderingold", "=", 
               RowBox[{"Join", "[", 
                RowBox[{"columnorderingold", ",", 
                 RowBox[{
                  RowBox[{"Complement", "[", 
                   RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"Dimensions", "[", "newa", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
                    "columnorderingold"}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{"Ordering", "[", 
                    RowBox[{"Map", "[", 
                    RowBox[{"Variables", ",", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{"oldkasteleyn", "[", 
                    RowBox[{"[", 
                    RowBox[{"All", ",", 
                    RowBox[{"Complement", "[", 
                    RowBox[{
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"Dimensions", "[", "newa", "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
                    "columnorderingold"}], "]"}]}], "]"}], "]"}], "]"}]}], 
                    "]"}], "]"}], "]"}], "]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"columnorderingold", "=", 
               RowBox[{"Join", "[", 
                RowBox[{"columnorderingold", ",", 
                 RowBox[{
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{"newb", ",", "#"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}], "&"}], ",", 
                    RowBox[{"Variables", "[", "newb", "]"}]}], "]"}], "+", 
                  RowBox[{"Length", "[", "columnorderingold", "]"}]}]}], 
                "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"areyouequal", "=", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"oldkasteleyn", "[", 
                    RowBox[{"[", 
                    RowBox[{"roworderingold", ",", "columnorderingold"}], 
                    "]"}], "]"}], "/.", "cleanupvariablesold"}], ")"}], "===", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"newkasteleyn", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    "roworderingresult", ",", "columnorderingresult"}], "]"}],
                     "]"}], "/.", "cleanupvariablesnew"}], ")"}]}], ")"}]}], 
              ";", "\[IndentingNewLine]", "areyouequal"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"And", "@@", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"areYouEqualToBefore", "[", 
                 RowBox[{
                 "newa", ",", "newb", ",", "newc", ",", "newd", ",", "#"}], 
                 "]"}], "&"}], ",", "doublesquaremoves"}], "]"}]}], ")"}], "=!=",
            "True"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<ii=\>\"", ",", "ii", ",", 
             "\"\< : Doing two square moves on a face of a BFT doesn't seem \
to bring you back to the original graph!\>\""}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Now", " ", "do", " ", "the", " ", "square", " ", "moves", " ", 
           "for", " ", "BFTs"}], ",", " ", 
          RowBox[{"using", " ", "face", " ", "numbers"}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"areThesePhasesEqual", "=", 
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"firstphase", ",", "secondphase"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Block", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "areyouequal", ",", "adjfirstphase", ",", "adjsecondphase", ",",
                "graphfirstphase", ",", "graphsecondphase"}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Map", "[", 
                  RowBox[{"Dimensions", ",", "firstphase"}], "]"}], "=!=", 
                 RowBox[{"Map", "[", 
                  RowBox[{"Dimensions", ",", "secondphase"}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"areyouequal", "=", "False"}], ";"}], 
                "\[IndentingNewLine]", ",", 
                RowBox[{
                 RowBox[{"adjfirstphase", "=", 
                  RowBox[{"turnIntoAdjacencyMatrix", "@@", "firstphase"}]}], 
                 ";", "\[IndentingNewLine]", 
                 RowBox[{"adjsecondphase", "=", 
                  RowBox[{"turnIntoAdjacencyMatrix", "@@", "secondphase"}]}], 
                 ";", "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Sort", "[", 
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "adjfirstphase"}], "]"}], "]"}], "=!=", 
                    RowBox[{"Sort", "[", 
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "adjsecondphase"}], "]"}], "]"}]}], 
                   ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"areyouequal", "=", "False"}], ";"}], 
                   "\[IndentingNewLine]", ",", 
                   RowBox[{
                    RowBox[{"graphfirstphase", "=", 
                    RowBox[{"AdjacencyGraph", "[", 
                    RowBox[{"adjfirstphase", "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"zz_", "/;", 
                    RowBox[{"(", 
                    RowBox[{"zz", ">", "1"}], ")"}]}], "\[Rule]", "1"}], 
                    "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"graphsecondphase", "=", 
                    RowBox[{"AdjacencyGraph", "[", 
                    RowBox[{"adjsecondphase", "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"zz_", "/;", 
                    RowBox[{"(", 
                    RowBox[{"zz", ">", "1"}], ")"}]}], "\[Rule]", "1"}], 
                    "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"areyouequal", "=", 
                    RowBox[{"(", 
                    RowBox[{"Or", "@@", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"adjsecondphase", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"List", "@@", "#"}], ",", 
                    RowBox[{"List", "@@", "#"}]}], "]"}], "]"}], "===", 
                    "adjfirstphase"}], "&"}], ",", 
                    RowBox[{"FindGraphIsomorphism", "[", 
                    RowBox[{
                    "graphfirstphase", ",", "graphsecondphase", ",", "All"}], 
                    "]"}]}], "]"}]}], ")"}]}], ";"}]}], "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{
                    RowBox[{"areyouequal", "=", 
                    RowBox[{"areYouEqualToBefore", "[", 
                    RowBox[{
                    RowBox[{"firstphase", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"firstphase", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"firstphase", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"firstphase", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], ",", "secondphase"}], 
                    "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", "]"}], 
                 ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
              "\[IndentingNewLine]", "areyouequal"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"spawnNewPhasesBFTfaces", "=", 
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"thea", ",", "theb", ",", "thec", ",", "thed"}], "}"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"Block", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "thesquarefaces", ",", "squaremovedphases", ",", 
               "positionnewphases", ",", "newphases"}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"thesquarefaces", "=", 
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{"getInternalFaceLabels", "[", 
                  RowBox[{"thea", ",", "theb", ",", "thec", ",", "thed"}], 
                  "]"}], ",", 
                 RowBox[{"zz_", "/;", 
                  RowBox[{
                   RowBox[{"Count", "[", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    RowBox[{"Join", "[", 
                    RowBox[{"thea", ",", "theb", ",", "thec", ",", "thed"}], 
                    "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"_", "[", 
                    RowBox[{"zz", ",", "_"}], "]"}], "|", 
                    RowBox[{"_", "[", 
                    RowBox[{"_", ",", "zz"}], "]"}]}]}], "]"}], "\[Equal]", 
                   "4"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"squaremovedphases", "=", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"collapseBivalentNodes", "@@", 
                   RowBox[{"squareMove", "[", 
                    RowBox[{
                    "thea", ",", "theb", ",", "thec", ",", "thed", ",", "#", 
                    ",", "True", ",", "True"}], "]"}]}], "&"}], ",", 
                 "thesquarefaces"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"positionnewphases", "=", 
               RowBox[{"Flatten", "[", 
                RowBox[{"Position", "[", 
                 RowBox[{
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Or", "@@", "#"}], "&"}], ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"areThesePhasesEqual", "[", 
                    RowBox[{
                    RowBox[{"squaremovedphases", "[", 
                    RowBox[{"[", "iii", "]"}], "]"}], ",", 
                    RowBox[{"allphasesbft", "[", 
                    RowBox[{"[", "jjj", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"iii", ",", 
                    RowBox[{"Length", "[", "squaremovedphases", "]"}]}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"jjj", ",", 
                    RowBox[{"Length", "[", "allphasesbft", "]"}]}], "}"}]}], 
                    "]"}]}], "]"}], ",", "False"}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"newphases", "=", 
               RowBox[{"squaremovedphases", "[", 
                RowBox[{"[", "positionnewphases", "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", "newphases"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"allphasesbft", "=", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], "}"}], 
          "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"newphasesbft", "=", "allphasesbft"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"afterlength", "=", "2"}], ";", "\[IndentingNewLine]", 
        RowBox[{"beforelength", "=", "1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"newphasesbft", "=!=", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"beforelength", "=", 
            RowBox[{"Length", "[", "allphasesbft", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"pi", "=", "1"}], ",", 
             RowBox[{"pi", "\[LessEqual]", 
              RowBox[{"Length", "[", "newphasesbft", "]"}]}], ",", 
             RowBox[{"pi", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"phasestoadd", "=", 
               RowBox[{"spawnNewPhasesBFTfaces", "[", 
                RowBox[{"Sequence", "@@", 
                 RowBox[{"newphasesbft", "[", 
                  RowBox[{"[", "pi", "]"}], "]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"allphasesbft", "=", 
               RowBox[{"Join", "[", 
                RowBox[{"allphasesbft", ",", "phasestoadd"}], "]"}]}], 
              ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"afterlength", "=", 
            RowBox[{"Length", "[", "allphasesbft", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"newphasesbft", "=", 
            RowBox[{"allphasesbft", "[", 
             RowBox[{"[", 
              RowBox[{"Range", "[", 
               RowBox[{
                RowBox[{"beforelength", "+", "1"}], ",", "afterlength"}], 
               "]"}], "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"allphasesbft", "=", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{"allphasesbft", ",", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"collapseBivalentNodes", "@@", 
                 RowBox[{"squareMove", "[", 
                  RowBox[{
                  "newa", ",", "newb", ",", "newc", ",", "newd", ",", "#", 
                   ",", "True", ",", "True"}], "]"}]}], ")"}], "&"}], ",", 
              "squarefaces"}], "]"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"Length", "[", "allphasesbft", "]"}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Now", " ", "do", " ", "the", " ", "square", " ", "moves", " ", 
          "for", " ", "BFTs", " ", "but", " ", "using", " ", "nodes", " ", 
          "instead", " ", "of", " ", "faces"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"squaremovenodes", "=", 
           RowBox[{"Map", "[", 
            RowBox[{"Union", ",", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Sequence", "@@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}], "]"}], "]"}], "+", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "newa", "]"}], "+", 
                    RowBox[{"Length", "[", "newc", "]"}]}]}], "}"}]}], 
                  ")"}]}], "&"}], ",", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Position", "[", 
                   RowBox[{
                    RowBox[{"joinupKasteleyn", "[", 
                    RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"_", "[", 
                    RowBox[{"_", ",", "#"}], "]"}], "|", 
                    RowBox[{"_", "[", 
                    RowBox[{"#", ",", "_"}], "]"}]}]}], "]"}], "&"}], ",", 
                 "squarefaces"}], "]"}], ",", 
               RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}]}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"squaremovenodes", "=", 
         RowBox[{"Map", "[", 
          RowBox[{"Flatten", ",", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"PadRight", "[", 
               RowBox[{
                RowBox[{"Union", "[", "#", "]"}], ",", "2", ",", 
                RowBox[{
                 RowBox[{"Union", "[", "#", "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "&"}], ",", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Transpose", "[", "#", "]"}], "&"}], ",", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}], "]"}], "]"}], "+", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "newa", "]"}], "+", 
                    RowBox[{"Length", "[", "newc", "]"}]}]}], "}"}]}], ")"}], 
                  "&"}], ",", 
                 RowBox[{"Map", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"joinupKasteleyn", "[", 
                    RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"_", "[", 
                    RowBox[{"_", ",", "#"}], "]"}], "|", 
                    RowBox[{"_", "[", 
                    RowBox[{"#", ",", "_"}], "]"}]}]}], "]"}], "&"}], ",", 
                   "squarefaces"}], "]"}], ",", 
                 RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], ",", 
             RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"squaremovenodes", "=", 
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Union", "[", "#", "]"}], "&"}], ",", 
               RowBox[{
                RowBox[{"FindCycle", "[", 
                 RowBox[{
                  RowBox[{"AdjacencyGraph", "[", 
                   RowBox[{"turnIntoAdjacencyMatrix", "[", 
                    RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], 
                    "]"}], "]"}], ",", 
                  RowBox[{"{", "4", "}"}], ",", "All"}], "]"}], "/.", 
                RowBox[{"UndirectedEdge", "\[Rule]", "Sequence"}]}]}], "]"}], 
             ",", 
             RowBox[{
             "Alternatives", "@@", "squarefacesturnedintonodenumbers"}]}], 
            "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"spawnNewPhasesBFTnodes", "=", 
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"thea", ",", "theb", ",", "thec", ",", "thed"}], "}"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"Block", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "thesquarefaces", ",", "thesquarefacesturnedintonodenumbers", 
               ",", "thesquaremovenodes", ",", "squaremovedphases", ",", 
               "positionnewphases", ",", "newphases"}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"thesquarefaces", "=", 
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{"getInternalFaceLabels", "[", 
                  RowBox[{"thea", ",", "theb", ",", "thec", ",", "thed"}], 
                  "]"}], ",", 
                 RowBox[{"zz_", "/;", 
                  RowBox[{
                   RowBox[{"Count", "[", 
                    RowBox[{
                    RowBox[{"Variables", "[", 
                    RowBox[{"Join", "[", 
                    RowBox[{"thea", ",", "theb", ",", "thec", ",", "thed"}], 
                    "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"_", "[", 
                    RowBox[{"zz", ",", "_"}], "]"}], "|", 
                    RowBox[{"_", "[", 
                    RowBox[{"_", ",", "zz"}], "]"}]}]}], "]"}], "\[Equal]", 
                   "4"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"thesquaremovenodes", "=", 
                 RowBox[{"Map", "[", 
                  RowBox[{"Union", ",", 
                   RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}], "]"}], "]"}], "+", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "thea", "]"}], "+", 
                    RowBox[{"Length", "[", "thec", "]"}]}]}], "}"}]}], 
                    ")"}]}], "&"}], ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"joinupKasteleyn", "[", 
                    RowBox[{"thea", ",", "theb", ",", "thec", ",", "thed"}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"_", "[", 
                    RowBox[{"_", ",", "#"}], "]"}], "|", 
                    RowBox[{"_", "[", 
                    RowBox[{"#", ",", "_"}], "]"}]}]}], "]"}], "&"}], ",", 
                    "thesquarefaces"}], "]"}], ",", 
                    RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}]}], ";"}], 
               "*)"}], "\[IndentingNewLine]", 
              RowBox[{"thesquaremovenodes", "=", 
               RowBox[{"Map", "[", 
                RowBox[{"Flatten", ",", 
                 RowBox[{"Map", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"PadRight", "[", 
                    RowBox[{
                    RowBox[{"Union", "[", "#", "]"}], ",", "2", ",", 
                    RowBox[{
                    RowBox[{"Union", "[", "#", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "&"}], ",", 
                   RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Transpose", "[", "#", "]"}], "&"}], ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}], "]"}], "]"}], "+", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "thea", "]"}], "+", 
                    RowBox[{"Length", "[", "thec", "]"}]}]}], "}"}]}], ")"}], 
                    "&"}], ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"joinupKasteleyn", "[", 
                    RowBox[{"thea", ",", "theb", ",", "thec", ",", "thed"}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"_", "[", 
                    RowBox[{"_", ",", "#"}], "]"}], "|", 
                    RowBox[{"_", "[", 
                    RowBox[{"#", ",", "_"}], "]"}]}]}], "]"}], "&"}], ",", 
                    "thesquarefaces"}], "]"}], ",", 
                    RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}], ",", 
                   RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"thesquaremovenodes", "=", 
                 RowBox[{"Cases", "[", 
                  RowBox[{
                   RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Union", "[", "#", "]"}], "&"}], ",", 
                    RowBox[{
                    RowBox[{"FindCycle", "[", 
                    RowBox[{
                    RowBox[{"AdjacencyGraph", "[", 
                    RowBox[{"turnIntoAdjacencyMatrix", "[", 
                    RowBox[{"thea", ",", "theb", ",", "thec", ",", "thed"}], 
                    "]"}], "]"}], ",", 
                    RowBox[{"{", "4", "}"}], ",", "All"}], "]"}], "/.", 
                    RowBox[{"UndirectedEdge", "\[Rule]", "Sequence"}]}]}], 
                    "]"}], ",", 
                   RowBox[{
                   "Alternatives", "@@", 
                    "thesquarefacesturnedintonodenumbers"}]}], "]"}]}], ";"}],
                "*)"}], "\[IndentingNewLine]", 
              RowBox[{"squaremovedphases", "=", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"collapseBivalentNodes", "@@", 
                   RowBox[{"squareMove", "[", 
                    RowBox[{
                    "thea", ",", "theb", ",", "thec", ",", "thed", ",", "#", 
                    ",", "True", ",", "True"}], "]"}]}], "&"}], ",", 
                 "thesquaremovenodes"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"positionnewphases", "=", 
               RowBox[{"Flatten", "[", 
                RowBox[{"Position", "[", 
                 RowBox[{
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Or", "@@", "#"}], "&"}], ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"areThesePhasesEqual", "[", 
                    RowBox[{
                    RowBox[{"squaremovedphases", "[", 
                    RowBox[{"[", "iii", "]"}], "]"}], ",", 
                    RowBox[{"allphasesbftnodes", "[", 
                    RowBox[{"[", "jjj", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"iii", ",", 
                    RowBox[{"Length", "[", "squaremovedphases", "]"}]}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"jjj", ",", 
                    RowBox[{"Length", "[", "allphasesbftnodes", "]"}]}], 
                    "}"}]}], "]"}]}], "]"}], ",", "False"}], "]"}], "]"}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"newphases", "=", 
               RowBox[{"squaremovedphases", "[", 
                RowBox[{"[", "positionnewphases", "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", "newphases"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"allphasesbftnodes", "=", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], "}"}], 
          "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"newphasesbftnodes", "=", "allphasesbftnodes"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"afterlength", "=", "2"}], ";", "\[IndentingNewLine]", 
        RowBox[{"beforelength", "=", "1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"newphasesbftnodes", "=!=", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"beforelength", "=", 
            RowBox[{"Length", "[", "allphasesbftnodes", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"pi", "=", "1"}], ",", 
             RowBox[{"pi", "\[LessEqual]", 
              RowBox[{"Length", "[", "newphasesbftnodes", "]"}]}], ",", 
             RowBox[{"pi", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"phasestoadd", "=", 
               RowBox[{"spawnNewPhasesBFTnodes", "[", 
                RowBox[{"Sequence", "@@", 
                 RowBox[{"newphasesbftnodes", "[", 
                  RowBox[{"[", "pi", "]"}], "]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"allphasesbftnodes", "=", 
               RowBox[{"Join", "[", 
                RowBox[{"allphasesbftnodes", ",", "phasestoadd"}], "]"}]}], 
              ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"afterlength", "=", 
            RowBox[{"Length", "[", "allphasesbftnodes", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"newphasesbftnodes", "=", 
            RowBox[{"allphasesbftnodes", "[", 
             RowBox[{"[", 
              RowBox[{"Range", "[", 
               RowBox[{
                RowBox[{"beforelength", "+", "1"}], ",", "afterlength"}], 
               "]"}], "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"allphasesbftnodes", "=", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{"allphasesbftnodes", ",", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"collapseBivalentNodes", "@@", 
                 RowBox[{"squareMove", "[", 
                  RowBox[{
                  "newa", ",", "newb", ",", "newc", ",", "newd", ",", "#", 
                   ",", "True", ",", "True"}], "]"}]}], ")"}], "&"}], ",", 
              "squaremovenodes"}], "]"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"Length", "[", "allphasesbftnodes", "]"}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Now", " ", "do", " ", "the", " ", "square", " ", "moves", " ", 
          "for", " ", "scattering", " ", "amplitudes"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"squaremovenodesscattering", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Union", "[", "#", "]"}], "&"}], ",", 
           RowBox[{
            RowBox[{"FindCycle", "[", 
             RowBox[{
              RowBox[{"AdjacencyGraph", "[", 
               RowBox[{"turnIntoAdjacencyMatrix", "[", 
                RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], 
                "]"}], "]"}], ",", 
              RowBox[{"{", "4", "}"}], ",", "All"}], "]"}], "/.", 
            RowBox[{"UndirectedEdge", "\[Rule]", "Sequence"}]}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"spawnNewPhasesScattering", "=", 
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"thea", ",", "theb", ",", "thec", ",", "thed"}], "}"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"Block", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "squaremovenodesscattering", ",", "squaremovedphases", ",", 
               "positionnewphases", ",", "newphases"}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"squaremovenodesscattering", "=", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Union", "[", "#", "]"}], "&"}], ",", 
                 RowBox[{
                  RowBox[{"FindCycle", "[", 
                   RowBox[{
                    RowBox[{"AdjacencyGraph", "[", 
                    RowBox[{"turnIntoAdjacencyMatrix", "[", 
                    RowBox[{"thea", ",", "theb", ",", "thec", ",", "thed"}], 
                    "]"}], "]"}], ",", 
                    RowBox[{"{", "4", "}"}], ",", "All"}], "]"}], "/.", 
                  RowBox[{"UndirectedEdge", "\[Rule]", "Sequence"}]}]}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"squaremovedphases", "=", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"collapseBivalentNodes", "@@", 
                   RowBox[{"squareMove", "[", 
                    RowBox[{
                    "thea", ",", "theb", ",", "thec", ",", "thed", ",", "#", 
                    ",", "False"}], "]"}]}], "&"}], ",", 
                 "squaremovenodesscattering"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"positionnewphases", "=", 
               RowBox[{"Flatten", "[", 
                RowBox[{"Position", "[", 
                 RowBox[{
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Or", "@@", "#"}], "&"}], ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"areThesePhasesEqual", "[", 
                    RowBox[{
                    RowBox[{"squaremovedphases", "[", 
                    RowBox[{"[", "iii", "]"}], "]"}], ",", 
                    RowBox[{"allphasesscattering", "[", 
                    RowBox[{"[", "jjj", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"iii", ",", 
                    RowBox[{"Length", "[", "squaremovedphases", "]"}]}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"jjj", ",", 
                    RowBox[{"Length", "[", "allphasesscattering", "]"}]}], 
                    "}"}]}], "]"}]}], "]"}], ",", "False"}], "]"}], "]"}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"newphases", "=", 
               RowBox[{"squaremovedphases", "[", 
                RowBox[{"[", "positionnewphases", "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", "newphases"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"allphasesscattering", "=", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], "}"}], 
          "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"newphasesscattering", "=", "allphasesscattering"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"afterlength", "=", "2"}], ";", "\[IndentingNewLine]", 
        RowBox[{"beforelength", "=", "1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"newphasesscattering", "=!=", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"beforelength", "=", 
            RowBox[{"Length", "[", "allphasesscattering", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"pi", "=", "1"}], ",", 
             RowBox[{"pi", "\[LessEqual]", 
              RowBox[{"Length", "[", "newphasesscattering", "]"}]}], ",", 
             RowBox[{"pi", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"phasestoadd", "=", 
               RowBox[{"spawnNewPhasesScattering", "[", 
                RowBox[{"Sequence", "@@", 
                 RowBox[{"newphasesscattering", "[", 
                  RowBox[{"[", "pi", "]"}], "]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"allphasesscattering", "=", 
               RowBox[{"Join", "[", 
                RowBox[{"allphasesscattering", ",", "phasestoadd"}], "]"}]}], 
              ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"afterlength", "=", 
            RowBox[{"Length", "[", "allphasesscattering", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"newphasesscattering", "=", 
            RowBox[{"allphasesscattering", "[", 
             RowBox[{"[", 
              RowBox[{"Range", "[", 
               RowBox[{
                RowBox[{"beforelength", "+", "1"}], ",", "afterlength"}], 
               "]"}], "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"allphasesscattering", "=", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Join", "[", 
           RowBox[{"allphasesscattering", ",", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"collapseBivalentNodes", "@@", 
                 RowBox[{"squareMove", "[", 
                  RowBox[{
                  "newa", ",", "newb", ",", "newc", ",", "newd", ",", "#", 
                   ",", "False"}], "]"}]}], ")"}], "&"}], ",", 
              "squaremovenodesscattering"}], "]"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"Length", "[", "allphasesscattering", "]"}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Now", " ", "we", " ", "can", " ", "finally", " ", "do", " ", "our",
            " ", "tests", " ", "on", " ", "the", " ", "move"}], "-", 
          RowBox[{"equivalent", " ", 
           RowBox[{"phases", "!"}]}]}], "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"getDuplicateEdges", "[", 
             RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], "]"}], 
            "\[Equal]", 
            RowBox[{"{", "}"}]}], "&&", 
           RowBox[{"getEdgesBFTformQ", "[", 
            RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], "]"}], "&&", 
           RowBox[{
            RowBox[{"getKasteleynConsistencyViolation", "[", 
             RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], "]"}], "===", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "}"}]}], "}"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"And", "@@", 
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"getKasteleynCheckQ", "[", 
                    RowBox[{
                    RowBox[{"Sequence", "@@", "#"}], ",", "True"}], "]"}], 
                   "&"}], ",", "allphasesbft"}], "]"}]}], ")"}], "=!=", 
              "True"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<ii=\>\"", ",", "ii", ",", 
                "\"\< : Somehow doing square moves (using faces) hasn't \
preserved the index structure of BFTs for some \\\"move-equivalent\\\" \
phases!\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"And", "@@", 
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"getKasteleynCheckQ", "[", 
                    RowBox[{
                    RowBox[{"Sequence", "@@", "#"}], ",", "True"}], "]"}], 
                   "&"}], ",", "allphasesbftnodes"}], "]"}]}], ")"}], "=!=", 
              "True"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<ii=\>\"", ",", "ii", ",", 
                "\"\< : Somehow doing square moves (using nodes) hasn't \
preserved the index structure of BFTs for some \\\"move-equivalent\\\" \
phases!\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"getDuplicateEdges", "[", 
             RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], "]"}], 
            "\[Equal]", 
            RowBox[{"{", "}"}]}], "&&", 
           RowBox[{"getEdgesBFTformQ", "[", 
            RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], "]"}], "&&", 
           RowBox[{
            RowBox[{"getKasteleynConsistencyViolation", "[", 
             RowBox[{"newa", ",", "newb", ",", "newc", ",", "newd"}], "]"}], "===", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "}"}]}], "}"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Equal", "@@", 
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"getNumberInternalFaces", "@@", "#"}], ")"}], 
                   "&"}], ",", "allphasesbft"}], "]"}]}], ")"}], "=!=", 
              "True"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<ii=\>\"", ",", "ii", ",", 
                "\"\< : Different phases of the square moves (using faces) \
have different numbers of faces!\>\""}], "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Equal", "@@", 
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"getNumberInternalFaces", "@@", "#"}], ")"}], 
                   "&"}], ",", "allphasesbftnodes"}], "]"}]}], ")"}], "=!=", 
              "True"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<ii=\>\"", ",", "ii", ",", 
                "\"\< : Different phases of the square moves (using nodes) \
have different numbers of faces!\>\""}], "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Equal", "@", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{"Normal", "[", 
                  RowBox[{"EdgeCycleMatrix", "[", 
                   RowBox[{"AdjacencyGraph", "[", 
                    RowBox[{"turnIntoAdjacencyMatrix", "[", 
                    RowBox[{"Sequence", "@@", "#"}], "]"}], "]"}], "]"}], 
                  "]"}], "]"}], "&"}], ",", "allphasesbft"}], "]"}]}], ")"}], 
           "=!=", "True"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<ii=\>\"", ",", "ii", ",", 
             "\"\< : Different phases of the square moves for BFTs (using \
faces) have different numbers of loops!\>\""}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Equal", "@", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{"Normal", "[", 
                  RowBox[{"EdgeCycleMatrix", "[", 
                   RowBox[{"AdjacencyGraph", "[", 
                    RowBox[{"turnIntoAdjacencyMatrix", "[", 
                    RowBox[{"Sequence", "@@", "#"}], "]"}], "]"}], "]"}], 
                  "]"}], "]"}], "&"}], ",", "allphasesbftnodes"}], "]"}]}], 
            ")"}], "=!=", "True"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<ii=\>\"", ",", "ii", ",", 
             "\"\< : Different phases of the square moves for BFTs (using \
faces) have different numbers of loops!\>\""}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Equal", "@", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{"Normal", "[", 
                  RowBox[{"EdgeCycleMatrix", "[", 
                   RowBox[{"AdjacencyGraph", "[", 
                    RowBox[{"turnIntoAdjacencyMatrix", "[", 
                    RowBox[{"Sequence", "@@", "#"}], "]"}], "]"}], "]"}], 
                  "]"}], "]"}], "&"}], ",", "allphasesscattering"}], "]"}]}], 
            ")"}], "=!=", "True"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<ii=\>\"", ",", "ii", ",", 
             "\"\< : Different phases of the square moves for scattering have \
different numbers of loops!\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ii", "\[NotEqual]", "24"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"ii", "\[NotEqual]", "25"}], "&&", 
              RowBox[{"ii", "\[NotEqual]", "34"}], "&&", 
              RowBox[{"ii", "\[NotEqual]", "37"}], "&&", 
              RowBox[{"ii", "\[NotEqual]", "38"}], "&&", 
              RowBox[{"ii", "\[NotEqual]", "39"}], "&&", 
              RowBox[{"ii", "\[NotEqual]", "41"}], "&&", 
              RowBox[{"ii", "\[NotEqual]", "43"}], "&&", 
              RowBox[{"ii", "\[NotEqual]", "47"}], "&&", 
              RowBox[{"ii", "\[NotEqual]", "50"}], "&&", 
              RowBox[{"ii", "\[NotEqual]", "51"}], "&&", 
              RowBox[{"ii", "\[NotEqual]", "53"}], "&&", 
              RowBox[{"ii", "\[NotEqual]", "54"}], "&&", 
              RowBox[{"ii", "\[NotEqual]", "61"}], "&&", 
              RowBox[{"ii", "\[NotEqual]", "63"}], "&&", 
              RowBox[{"ii", "\[NotEqual]", "90"}], "&&", 
              RowBox[{"ii", "\[NotEqual]", "93"}], "&&", 
              RowBox[{"ii", "\[NotEqual]", "97"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Sort", "[", "allphasesbft", "]"}], "=!=", 
                 RowBox[{"Sort", "[", "allphasesbftnodes", "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{
                  "\"\<ii=\>\"", ",", "ii", ",", 
                   "\"\< : Doing square moves for BFTs using faces gives a \
different result than doing it with four nodes!\>\""}], "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";"}], "\[IndentingNewLine]", ",", 
          RowBox[{"(*", 
           RowBox[{"in", " ", 
            SubscriptBox["bft", "24"], " ", "we", " ", "have", " ", "a", " ", 
            "situation", " ", "where", " ", "it", " ", "is", " ", "possible", 
            " ", "that", " ", "specifying", " ", "four", " ", "nodes", " ", 
            RowBox[{"isn", "'"}], "t", " ", 
            RowBox[{"enough", ":", " ", 
             RowBox[{
              RowBox[{
              "there", " ", "are", " ", "actually", " ", "two", " ", 
               "different", " ", "faces", " ", "that", " ", "can", " ", "be", 
               " ", "square"}], "-", 
              RowBox[{
              "moved", " ", "when", " ", "specifying", " ", "the", " ", 
               "nodes", " ", 
               RowBox[{"{", 
                RowBox[{"1", ",", "2", ",", "5", ",", "6"}], "}"}]}]}]}]}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Sort", "[", 
               RowBox[{"DeleteCases", "[", 
                RowBox[{"allphasesbft", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", 
                    RowBox[{"1", ",", "4"}], "]"}], ",", "0", ",", 
                    RowBox[{"XXX", "[", 
                    RowBox[{"5", ",", "1"}], "]"}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"X", "[", 
                    RowBox[{"1", ",", "6"}], "]"}], ",", "0", ",", 
                    RowBox[{"XXX", "[", 
                    RowBox[{"3", ",", "1"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"XX", "[", 
                    RowBox[{"5", ",", "1"}], "]"}], ",", "0", ",", 
                    RowBox[{"X", "[", 
                    RowBox[{"2", ",", "5"}], "]"}], ",", 
                    RowBox[{"Y", "[", 
                    RowBox[{"1", ",", "2"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"XX", "[", 
                    RowBox[{"3", ",", "1"}], "]"}], ",", 
                    RowBox[{"X", "[", 
                    RowBox[{"1", ",", "2"}], "]"}], ",", 
                    RowBox[{"X", "[", 
                    RowBox[{"2", ",", "3"}], "]"}]}], "}"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"X", "[", 
                    RowBox[{"4", ",", "5"}], "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"X", "[", 
                    RowBox[{"6", ",", "3"}], "]"}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"Y", "[", 
                    RowBox[{"6", ",", "3"}], "]"}], ",", "0", ",", "0"}], 
                    "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Y", "[", 
                    RowBox[{"4", ",", "5"}], "]"}], ",", "0", ",", "0", ",", 
                    "0"}], "}"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "}"}]}], "]"}],
                "]"}], "=!=", 
              RowBox[{"Sort", "[", "allphasesbftnodes", "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<ii=\>\"", ",", "ii", ",", 
                "\"\< : Doing square moves for BFTs using faces gives a \
different result than doing it with four nodes!\>\""}], "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ii", "\[NotEqual]", "39"}], "&&", 
           RowBox[{"ii", "\[NotEqual]", "50"}], "&&", 
           RowBox[{"ii", "\[NotEqual]", "51"}], "&&", 
           RowBox[{"ii", "\[NotEqual]", "61"}], "&&", 
           RowBox[{"ii", "\[NotEqual]", "106"}], "&&", 
           RowBox[{"ii", "\[NotEqual]", "107"}], "&&", 
           RowBox[{"ii", "\[NotEqual]", "110"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"bftfacesstratifications", "=", 
            RowBox[{"ParallelMap", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"stratificationNumbers", "[", 
                  RowBox[{
                   RowBox[{"Sequence", "@@", "#"}], ",", "False", ",", 
                   "False", ",", "2"}], "]"}], ",", 
                 RowBox[{"stratificationNumbers", "[", 
                  RowBox[{
                   RowBox[{"Sequence", "@@", "#"}], ",", "False", ",", "True",
                    ",", "1"}], "]"}], ",", 
                 RowBox[{"stratificationNumbers", "[", 
                  RowBox[{
                   RowBox[{"Sequence", "@@", "#"}], ",", "False", ",", "True",
                    ",", "2"}], "]"}]}], "}"}], "&"}], ",", "allphasesbft"}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"bftnodesstratifications", "=", 
            RowBox[{"ParallelMap", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"stratificationNumbers", "[", 
                  RowBox[{
                   RowBox[{"Sequence", "@@", "#"}], ",", "False", ",", 
                   "False", ",", "2"}], "]"}], ",", 
                 RowBox[{"stratificationNumbers", "[", 
                  RowBox[{
                   RowBox[{"Sequence", "@@", "#"}], ",", "False", ",", "True",
                    ",", "1"}], "]"}], ",", 
                 RowBox[{"stratificationNumbers", "[", 
                  RowBox[{
                   RowBox[{"Sequence", "@@", "#"}], ",", "False", ",", "True",
                    ",", "2"}], "]"}]}], "}"}], "&"}], ",", 
              "allphasesbftnodes"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"scatteringstratifications", "=", 
            RowBox[{"ParallelMap", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"stratificationNumbers", "[", 
                 RowBox[{
                  RowBox[{"Sequence", "@@", "#"}], ",", "False", ",", "True", 
                  ",", "2"}], "]"}], "}"}], "&"}], ",", 
              "allphasesscattering"}], "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Equal", "@@", "bftfacesstratifications"}], "=!=", 
              "True"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<ii=\>\"", ",", "ii", ",", 
                "\"\< : Move-equivalent configurations for BFTs (using faces) \
have different stratification numbers!\>\""}], "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Equal", "@@", "bftnodesstratifications"}], "=!=", 
              "True"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<ii=\>\"", ",", "ii", ",", 
                "\"\< : Move-equivalent configurations for BFTs (using nodes) \
have different stratification numbers!\>\""}], "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Equal", "@@", "scatteringstratifications"}], "=!=", 
              "True"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<ii=\>\"", ",", "ii", ",", 
                "\"\< : Move-equivalent configurations for scattering have \
different stratification numbers!\>\""}], "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], 
     ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.664781819710851*^9, 3.66478198207829*^9}, {
   3.6647820277729077`*^9, 3.6647820661125183`*^9}, 3.6647822947623367`*^9, {
   3.664782367011778*^9, 3.664782405137395*^9}, {3.66478245916627*^9, 
   3.664782540993922*^9}, 3.6647827017368417`*^9, {3.6647828039884424`*^9, 
   3.664782898580064*^9}, {3.6647829297236333`*^9, 3.6647829520229616`*^9}, 
   3.664782983955406*^9, {3.66478439381633*^9, 3.664784454309479*^9}, {
   3.6647844865795813`*^9, 3.6647845167036495`*^9}, {3.664784914565*^9, 
   3.6647849834988747`*^9}, {3.6647893830056033`*^9, 
   3.6647894076633363`*^9}, {3.6670474671026745`*^9, 3.6670474672901683`*^9}, 
   3.667048782777152*^9, {3.667571624499669*^9, 3.6675716441876526`*^9}, {
   3.670244519128513*^9, 3.670244528314185*^9}, {3.6709104200095353`*^9, 
   3.670910483539136*^9}, {3.6709105173352757`*^9, 3.670910613249056*^9}, {
   3.670910645574507*^9, 3.670910653288369*^9}, {3.6709108673310013`*^9, 
   3.6709108674290533`*^9}, {3.670910901148337*^9, 3.670910924499362*^9}, {
   3.670910989695868*^9, 3.670911033859152*^9}, {3.670911071219535*^9, 
   3.670911220682269*^9}, {3.670911351397422*^9, 3.6709115290810776`*^9}, {
   3.6709115996768923`*^9, 3.670911613455324*^9}, {3.670911838108729*^9, 
   3.670911846025834*^9}, {3.6709118944544783`*^9, 3.670911949940152*^9}, {
   3.670911997766349*^9, 3.6709120297574253`*^9}, {3.6709120710165014`*^9, 
   3.6709121598355923`*^9}, {3.67091219189585*^9, 3.6709122194937067`*^9}, 
   3.6709122877527046`*^9, {3.6709123503578634`*^9, 3.670912371447871*^9}, {
   3.6709124124790955`*^9, 3.6709124139626703`*^9}, {3.6709125427631283`*^9, 
   3.6709125441335583`*^9}, {3.670912586473938*^9, 3.670912601782899*^9}, {
   3.670912657824276*^9, 3.6709126827225056`*^9}, {3.6709127131691833`*^9, 
   3.6709127158601255`*^9}, {3.670912816691945*^9, 3.6709128320409822`*^9}, {
   3.670912881185275*^9, 3.670912948379197*^9}, {3.6709130383202834`*^9, 
   3.6709130411598625`*^9}, 3.6709134828250136`*^9, {3.6709136558342714`*^9, 
   3.6709137235961*^9}, {3.670914085817363*^9, 3.6709141326870584`*^9}, {
   3.6709142326146603`*^9, 3.6709143133373947`*^9}, {3.670915304877978*^9, 
   3.6709153330098486`*^9}, {3.6709199720758567`*^9, 3.670920000122165*^9}, {
   3.6709201894332714`*^9, 3.6709202033904867`*^9}, {3.670920242872819*^9, 
   3.6709202845685506`*^9}, 3.670920371625329*^9, {3.67092094500834*^9, 
   3.6709210050490236`*^9}, {3.670921181539347*^9, 3.670921347036747*^9}, {
   3.670921581602537*^9, 3.670921583846383*^9}, {3.670921668755324*^9, 
   3.6709216696992855`*^9}, {3.670921701038556*^9, 3.6709217092945414`*^9}, {
   3.670921951057428*^9, 3.6709219736569033`*^9}, {3.670923557860277*^9, 
   3.670923740702423*^9}, {3.6711806272308908`*^9, 3.6711806291505103`*^9}, {
   3.671180770792122*^9, 3.671180776920453*^9}, {3.6711850605534196`*^9, 
   3.671185107856476*^9}, {3.6711856353217745`*^9, 3.6711856664678745`*^9}, {
   3.671185940099115*^9, 3.6711859589609222`*^9}, {3.6711860621969643`*^9, 
   3.671186078877637*^9}, {3.671186137117034*^9, 3.6711861962369795`*^9}, {
   3.671186229913108*^9, 3.6711862596264524`*^9}, {3.6711864166326313`*^9, 
   3.671186482704314*^9}, {3.671186561754046*^9, 3.671186565992087*^9}, {
   3.6711866136144*^9, 3.6711866222941666`*^9}, {3.671186975113619*^9, 
   3.671186989984462*^9}, {3.6711870218638*^9, 3.6711870272972755`*^9}, 
   3.671187263770239*^9, {3.6711873717966604`*^9, 3.671187377601221*^9}, 
   3.671188081312666*^9, {3.6711886770722337`*^9, 3.6711886880917587`*^9}, {
   3.671188720581915*^9, 3.6711887209436607`*^9}, {3.671191095241579*^9, 
   3.6711910953728*^9}, {3.6711911440062494`*^9, 3.671191195964123*^9}, {
   3.6711914673556395`*^9, 3.671191538574589*^9}, {3.6711915915923185`*^9, 
   3.6711916635904813`*^9}, {3.6711918077105265`*^9, 
   3.6711918973765507`*^9}, {3.6711919982763977`*^9, 
   3.6711920142937403`*^9}, {3.6711920654310446`*^9, 3.671192138288003*^9}, {
   3.6711921750304976`*^9, 3.671192210005745*^9}, {3.6711922536057405`*^9, 
   3.671192255424406*^9}, {3.6711924535783424`*^9, 3.6711924763186398`*^9}, {
   3.6711925669231076`*^9, 3.671192601549764*^9}, {3.6711927168449135`*^9, 
   3.6711927416194983`*^9}, {3.6711928936644382`*^9, 3.671192943266226*^9}, {
   3.671193003271166*^9, 3.6711930217250357`*^9}, 3.671193072263878*^9, 
   3.6711931174707413`*^9, {3.671193166927243*^9, 3.671193167364518*^9}, {
   3.671193228584111*^9, 3.6711932289848137`*^9}, {3.6711946047091045`*^9, 
   3.671194611212427*^9}, {3.671194689892874*^9, 3.6711947353024483`*^9}, {
   3.67119482850189*^9, 3.671194918448003*^9}, {3.671194979206033*^9, 
   3.671195019714262*^9}, {3.671195109244729*^9, 3.67119511112999*^9}, {
   3.6712730188540773`*^9, 3.6712730706584754`*^9}, {3.67127802269307*^9, 
   3.671278064567593*^9}, {3.6712788091102934`*^9, 3.6712788389039736`*^9}, {
   3.671368050488973*^9, 3.671368050817107*^9}, {3.671425543202236*^9, 
   3.6714255763957376`*^9}, {3.671426155595744*^9, 3.6714261880270233`*^9}, 
   3.6714282356341543`*^9, {3.671428577592679*^9, 3.6714286451381645`*^9}, {
   3.6714334305868626`*^9, 3.6714335119715896`*^9}, 3.67143731004537*^9, {
   3.6714375315687785`*^9, 3.671437531769021*^9}, {3.671439002880684*^9, 
   3.6714390151865444`*^9}, {3.6714393265407543`*^9, 3.67143939270599*^9}, {
   3.6714398089494348`*^9, 3.6714398585894847`*^9}, {3.6714399216501255`*^9, 
   3.6714399394678082`*^9}, {3.671441440079903*^9, 3.6714415099084873`*^9}, {
   3.6714416532412577`*^9, 3.671441727920885*^9}, {3.6714420735570664`*^9, 
   3.671442075398585*^9}, {3.67144229988265*^9, 3.6714424775228043`*^9}, {
   3.6714425076724634`*^9, 3.6714425513042693`*^9}, {3.6714440536782265`*^9, 
   3.671444067292127*^9}, {3.6714441320743217`*^9, 3.6714442660812855`*^9}, {
   3.671444446399582*^9, 3.6714444952723727`*^9}, {3.6714466519839473`*^9, 
   3.6714467200464635`*^9}, 3.671447017630552*^9, {3.671447053916916*^9, 
   3.6714471281811204`*^9}, {3.6714472087086153`*^9, 3.671447214206172*^9}, {
   3.6714475338423157`*^9, 3.671447626088956*^9}, {3.6714477138576393`*^9, 
   3.6714477224350357`*^9}, {3.6714478680567894`*^9, 3.671447889159058*^9}, {
   3.671449613638344*^9, 3.6714496241936293`*^9}, {3.671449898477844*^9, 
   3.671449900739956*^9}, {3.67144997397748*^9, 3.6714499933043175`*^9}, {
   3.6714507382903633`*^9, 3.671450751608225*^9}, {3.6714518795711803`*^9, 
   3.6714519521616077`*^9}, {3.671453452980751*^9, 3.6714534549046745`*^9}, {
   3.6714535415982347`*^9, 3.6714535448855357`*^9}, {3.6714535775108*^9, 
   3.6714536151310472`*^9}, {3.671463738585285*^9, 3.6714637559587708`*^9}, {
   3.6714639619032044`*^9, 3.6714639735163155`*^9}, {3.671464688397129*^9, 
   3.67146468908327*^9}, {3.671513654012539*^9, 3.6715136550532455`*^9}, {
   3.6715153696002665`*^9, 3.6715154602835073`*^9}, {3.6715155533835707`*^9, 
   3.671515560771036*^9}, {3.671515646275035*^9, 3.671515699756398*^9}, 
   3.6715164008459015`*^9, {3.671519499580912*^9, 3.6715195009187984`*^9}, {
   3.67153885061821*^9, 3.671538851524764*^9}, {3.6715439260812283`*^9, 
   3.671543930345441*^9}, {3.6715441172038736`*^9, 3.6715441198735666`*^9}, {
   3.6715443744013977`*^9, 3.671544382550761*^9}, {3.6715450174827404`*^9, 
   3.671545018051359*^9}, {3.6715450710154686`*^9, 3.671545074805319*^9}, {
   3.671545164122321*^9, 3.671545164951691*^9}, {3.671545293099631*^9, 
   3.6715452938436623`*^9}, {3.6716881185555735`*^9, 
   3.6716881235705557`*^9}, {3.672748635535839*^9, 3.6727486376845136`*^9}, {
   3.672748867528655*^9, 3.6727488810418453`*^9}, 3.6727489524679837`*^9, {
   3.6805046035359125`*^9, 3.6805046073887897`*^9}, {3.6805141353489094`*^9, 
   3.6805141383628283`*^9}, {3.6805153178500633`*^9, 
   3.6805153266642427`*^9}, {3.6805169056283894`*^9, 3.680516909048488*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "105"}],
  SequenceForm["ii=", 105],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6712730729577208`*^9, 3.671273086927863*^9}, {
   3.6712780242410192`*^9, 3.6712780653843822`*^9}, {3.6712788303214025`*^9, 
   3.6712788398983183`*^9}, 3.671340160893304*^9, 3.6713405788577957`*^9, 
   3.6713679711271095`*^9, {3.6714255246552486`*^9, 3.671425577482798*^9}, 
   3.6714261938657446`*^9, 3.6714282490140953`*^9, 3.6714286472234287`*^9, 
   3.6714293553135495`*^9, 3.671433437362511*^9, 3.671433475781865*^9, 
   3.671433513972904*^9, 3.6714373122437706`*^9, 3.6714375346111946`*^9, 
   3.6714390200038385`*^9, 3.6714393643667912`*^9, {3.671439831195343*^9, 
   3.67143985934064*^9}, 3.6714399412279434`*^9, 3.6714414788827744`*^9, 
   3.671441511315852*^9, 3.671441730064537*^9, 3.6714420797379293`*^9, 
   3.671442551905306*^9, 3.671444271357292*^9, 3.671444321715108*^9, 
   3.671444463112733*^9, 3.6714444967594953`*^9, 3.671447025311639*^9, 
   3.67144713021282*^9, 3.671447643943407*^9, 3.6714477262349806`*^9, 
   3.6714479008824716`*^9, 3.6714500000254464`*^9, 3.6714507540500784`*^9, {
   3.671451901752502*^9, 3.6714519558641634`*^9}, 3.67146370731653*^9, 
   3.6714648424912195`*^9, 3.671513672968769*^9, 3.671515386402877*^9, 
   3.6715154523780403`*^9, 3.6715155050242968`*^9, 3.671515705917068*^9, 
   3.6715164066731157`*^9, 3.671538870046317*^9, 3.671538966336405*^9, 
   3.671539030792556*^9, 3.6727487602739964`*^9, 3.6727489052919474`*^9}],

Cell[BoxData["3"], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6712730729577208`*^9, 3.671273086927863*^9}, {
   3.6712780242410192`*^9, 3.6712780653843822`*^9}, {3.6712788303214025`*^9, 
   3.6712788398983183`*^9}, 3.671340160893304*^9, 3.6713405788577957`*^9, 
   3.6713679711271095`*^9, {3.6714255246552486`*^9, 3.671425577482798*^9}, 
   3.6714261938657446`*^9, 3.6714282490140953`*^9, 3.6714286472234287`*^9, 
   3.6714293553135495`*^9, 3.671433437362511*^9, 3.671433475781865*^9, 
   3.671433513972904*^9, 3.6714373122437706`*^9, 3.6714375346111946`*^9, 
   3.6714390200038385`*^9, 3.6714393643667912`*^9, {3.671439831195343*^9, 
   3.67143985934064*^9}, 3.6714399412279434`*^9, 3.6714414788827744`*^9, 
   3.671441511315852*^9, 3.671441730064537*^9, 3.6714420797379293`*^9, 
   3.671442551905306*^9, 3.671444271357292*^9, 3.671444321715108*^9, 
   3.671444463112733*^9, 3.6714444967594953`*^9, 3.671447025311639*^9, 
   3.67144713021282*^9, 3.671447643943407*^9, 3.6714477262349806`*^9, 
   3.6714479008824716`*^9, 3.6714500000254464`*^9, 3.6714507540500784`*^9, {
   3.671451901752502*^9, 3.6714519558641634`*^9}, 3.67146370731653*^9, 
   3.6714648424912195`*^9, 3.671513672968769*^9, 3.671515386402877*^9, 
   3.6715154523780403`*^9, 3.6715155050242968`*^9, 3.671515705917068*^9, 
   3.6715164066731157`*^9, 3.671538870046317*^9, 3.671538966336405*^9, 
   3.671539030792556*^9, 3.6727487602739964`*^9, 3.672748905425276*^9}],

Cell[BoxData["3"], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6712730729577208`*^9, 3.671273086927863*^9}, {
   3.6712780242410192`*^9, 3.6712780653843822`*^9}, {3.6712788303214025`*^9, 
   3.6712788398983183`*^9}, 3.671340160893304*^9, 3.6713405788577957`*^9, 
   3.6713679711271095`*^9, {3.6714255246552486`*^9, 3.671425577482798*^9}, 
   3.6714261938657446`*^9, 3.6714282490140953`*^9, 3.6714286472234287`*^9, 
   3.6714293553135495`*^9, 3.671433437362511*^9, 3.671433475781865*^9, 
   3.671433513972904*^9, 3.6714373122437706`*^9, 3.6714375346111946`*^9, 
   3.6714390200038385`*^9, 3.6714393643667912`*^9, {3.671439831195343*^9, 
   3.67143985934064*^9}, 3.6714399412279434`*^9, 3.6714414788827744`*^9, 
   3.671441511315852*^9, 3.671441730064537*^9, 3.6714420797379293`*^9, 
   3.671442551905306*^9, 3.671444271357292*^9, 3.671444321715108*^9, 
   3.671444463112733*^9, 3.6714444967594953`*^9, 3.671447025311639*^9, 
   3.67144713021282*^9, 3.671447643943407*^9, 3.6714477262349806`*^9, 
   3.6714479008824716`*^9, 3.6714500000254464`*^9, 3.6714507540500784`*^9, {
   3.671451901752502*^9, 3.6714519558641634`*^9}, 3.67146370731653*^9, 
   3.6714648424912195`*^9, 3.671513672968769*^9, 3.671515386402877*^9, 
   3.6715154523780403`*^9, 3.6715155050242968`*^9, 3.671515705917068*^9, 
   3.6715164066731157`*^9, 3.671538870046317*^9, 3.671538966336405*^9, 
   3.671539030792556*^9, 3.6727487602739964`*^9, 3.672748905525545*^9}],

Cell[BoxData["5"], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6712730729577208`*^9, 3.671273086927863*^9}, {
   3.6712780242410192`*^9, 3.6712780653843822`*^9}, {3.6712788303214025`*^9, 
   3.6712788398983183`*^9}, 3.671340160893304*^9, 3.6713405788577957`*^9, 
   3.6713679711271095`*^9, {3.6714255246552486`*^9, 3.671425577482798*^9}, 
   3.6714261938657446`*^9, 3.6714282490140953`*^9, 3.6714286472234287`*^9, 
   3.6714293553135495`*^9, 3.671433437362511*^9, 3.671433475781865*^9, 
   3.671433513972904*^9, 3.6714373122437706`*^9, 3.6714375346111946`*^9, 
   3.6714390200038385`*^9, 3.6714393643667912`*^9, {3.671439831195343*^9, 
   3.67143985934064*^9}, 3.6714399412279434`*^9, 3.6714414788827744`*^9, 
   3.671441511315852*^9, 3.671441730064537*^9, 3.6714420797379293`*^9, 
   3.671442551905306*^9, 3.671444271357292*^9, 3.671444321715108*^9, 
   3.671444463112733*^9, 3.6714444967594953`*^9, 3.671447025311639*^9, 
   3.67144713021282*^9, 3.671447643943407*^9, 3.6714477262349806`*^9, 
   3.6714479008824716`*^9, 3.6714500000254464`*^9, 3.6714507540500784`*^9, {
   3.671451901752502*^9, 3.6714519558641634`*^9}, 3.67146370731653*^9, 
   3.6714648424912195`*^9, 3.671513672968769*^9, 3.671515386402877*^9, 
   3.6715154523780403`*^9, 3.6715155050242968`*^9, 3.671515705917068*^9, 
   3.6715164066731157`*^9, 3.671538870046317*^9, 3.671538966336405*^9, 
   3.671539030792556*^9, 3.6727487602739964`*^9, 3.672748905841981*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "106"}],
  SequenceForm["ii=", 106],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6712730729577208`*^9, 3.671273086927863*^9}, {
   3.6712780242410192`*^9, 3.6712780653843822`*^9}, {3.6712788303214025`*^9, 
   3.6712788398983183`*^9}, 3.671340160893304*^9, 3.6713405788577957`*^9, 
   3.6713679711271095`*^9, {3.6714255246552486`*^9, 3.671425577482798*^9}, 
   3.6714261938657446`*^9, 3.6714282490140953`*^9, 3.6714286472234287`*^9, 
   3.6714293553135495`*^9, 3.671433437362511*^9, 3.671433475781865*^9, 
   3.671433513972904*^9, 3.6714373122437706`*^9, 3.6714375346111946`*^9, 
   3.6714390200038385`*^9, 3.6714393643667912`*^9, {3.671439831195343*^9, 
   3.67143985934064*^9}, 3.6714399412279434`*^9, 3.6714414788827744`*^9, 
   3.671441511315852*^9, 3.671441730064537*^9, 3.6714420797379293`*^9, 
   3.671442551905306*^9, 3.671444271357292*^9, 3.671444321715108*^9, 
   3.671444463112733*^9, 3.6714444967594953`*^9, 3.671447025311639*^9, 
   3.67144713021282*^9, 3.671447643943407*^9, 3.6714477262349806`*^9, 
   3.6714479008824716`*^9, 3.6714500000254464`*^9, 3.6714507540500784`*^9, {
   3.671451901752502*^9, 3.6714519558641634`*^9}, 3.67146370731653*^9, 
   3.6714648424912195`*^9, 3.671513672968769*^9, 3.671515386402877*^9, 
   3.6715154523780403`*^9, 3.6715155050242968`*^9, 3.671515705917068*^9, 
   3.6715164066731157`*^9, 3.671538870046317*^9, 3.671538966336405*^9, 
   3.671539030792556*^9, 3.6727487602739964`*^9, 3.672748906775359*^9}],

Cell[BoxData["3"], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6712730729577208`*^9, 3.671273086927863*^9}, {
   3.6712780242410192`*^9, 3.6712780653843822`*^9}, {3.6712788303214025`*^9, 
   3.6712788398983183`*^9}, 3.671340160893304*^9, 3.6713405788577957`*^9, 
   3.6713679711271095`*^9, {3.6714255246552486`*^9, 3.671425577482798*^9}, 
   3.6714261938657446`*^9, 3.6714282490140953`*^9, 3.6714286472234287`*^9, 
   3.6714293553135495`*^9, 3.671433437362511*^9, 3.671433475781865*^9, 
   3.671433513972904*^9, 3.6714373122437706`*^9, 3.6714375346111946`*^9, 
   3.6714390200038385`*^9, 3.6714393643667912`*^9, {3.671439831195343*^9, 
   3.67143985934064*^9}, 3.6714399412279434`*^9, 3.6714414788827744`*^9, 
   3.671441511315852*^9, 3.671441730064537*^9, 3.6714420797379293`*^9, 
   3.671442551905306*^9, 3.671444271357292*^9, 3.671444321715108*^9, 
   3.671444463112733*^9, 3.6714444967594953`*^9, 3.671447025311639*^9, 
   3.67144713021282*^9, 3.671447643943407*^9, 3.6714477262349806`*^9, 
   3.6714479008824716`*^9, 3.6714500000254464`*^9, 3.6714507540500784`*^9, {
   3.671451901752502*^9, 3.6714519558641634`*^9}, 3.67146370731653*^9, 
   3.6714648424912195`*^9, 3.671513672968769*^9, 3.671515386402877*^9, 
   3.6715154523780403`*^9, 3.6715155050242968`*^9, 3.671515705917068*^9, 
   3.6715164066731157`*^9, 3.671538870046317*^9, 3.671538966336405*^9, 
   3.671539030792556*^9, 3.6727487602739964`*^9, 3.6727489068932447`*^9}],

Cell[BoxData["3"], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6712730729577208`*^9, 3.671273086927863*^9}, {
   3.6712780242410192`*^9, 3.6712780653843822`*^9}, {3.6712788303214025`*^9, 
   3.6712788398983183`*^9}, 3.671340160893304*^9, 3.6713405788577957`*^9, 
   3.6713679711271095`*^9, {3.6714255246552486`*^9, 3.671425577482798*^9}, 
   3.6714261938657446`*^9, 3.6714282490140953`*^9, 3.6714286472234287`*^9, 
   3.6714293553135495`*^9, 3.671433437362511*^9, 3.671433475781865*^9, 
   3.671433513972904*^9, 3.6714373122437706`*^9, 3.6714375346111946`*^9, 
   3.6714390200038385`*^9, 3.6714393643667912`*^9, {3.671439831195343*^9, 
   3.67143985934064*^9}, 3.6714399412279434`*^9, 3.6714414788827744`*^9, 
   3.671441511315852*^9, 3.671441730064537*^9, 3.6714420797379293`*^9, 
   3.671442551905306*^9, 3.671444271357292*^9, 3.671444321715108*^9, 
   3.671444463112733*^9, 3.6714444967594953`*^9, 3.671447025311639*^9, 
   3.67144713021282*^9, 3.671447643943407*^9, 3.6714477262349806`*^9, 
   3.6714479008824716`*^9, 3.6714500000254464`*^9, 3.6714507540500784`*^9, {
   3.671451901752502*^9, 3.6714519558641634`*^9}, 3.67146370731653*^9, 
   3.6714648424912195`*^9, 3.671513672968769*^9, 3.671515386402877*^9, 
   3.6715154523780403`*^9, 3.6715155050242968`*^9, 3.671515705917068*^9, 
   3.6715164066731157`*^9, 3.671538870046317*^9, 3.671538966336405*^9, 
   3.671539030792556*^9, 3.6727487602739964`*^9, 3.6727489069601*^9}],

Cell[BoxData["10"], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6712730729577208`*^9, 3.671273086927863*^9}, {
   3.6712780242410192`*^9, 3.6712780653843822`*^9}, {3.6712788303214025`*^9, 
   3.6712788398983183`*^9}, 3.671340160893304*^9, 3.6713405788577957`*^9, 
   3.6713679711271095`*^9, {3.6714255246552486`*^9, 3.671425577482798*^9}, 
   3.6714261938657446`*^9, 3.6714282490140953`*^9, 3.6714286472234287`*^9, 
   3.6714293553135495`*^9, 3.671433437362511*^9, 3.671433475781865*^9, 
   3.671433513972904*^9, 3.6714373122437706`*^9, 3.6714375346111946`*^9, 
   3.6714390200038385`*^9, 3.6714393643667912`*^9, {3.671439831195343*^9, 
   3.67143985934064*^9}, 3.6714399412279434`*^9, 3.6714414788827744`*^9, 
   3.671441511315852*^9, 3.671441730064537*^9, 3.6714420797379293`*^9, 
   3.671442551905306*^9, 3.671444271357292*^9, 3.671444321715108*^9, 
   3.671444463112733*^9, 3.6714444967594953`*^9, 3.671447025311639*^9, 
   3.67144713021282*^9, 3.671447643943407*^9, 3.6714477262349806`*^9, 
   3.6714479008824716`*^9, 3.6714500000254464`*^9, 3.6714507540500784`*^9, {
   3.671451901752502*^9, 3.6714519558641634`*^9}, 3.67146370731653*^9, 
   3.6714648424912195`*^9, 3.671513672968769*^9, 3.671515386402877*^9, 
   3.6715154523780403`*^9, 3.6715155050242968`*^9, 3.671515705917068*^9, 
   3.6715164066731157`*^9, 3.671538870046317*^9, 3.671538966336405*^9, 
   3.671539030792556*^9, 3.6727487602739964`*^9, 3.6727489073768053`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "107"}],
  SequenceForm["ii=", 107],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6712730729577208`*^9, 3.671273086927863*^9}, {
   3.6712780242410192`*^9, 3.6712780653843822`*^9}, {3.6712788303214025`*^9, 
   3.6712788398983183`*^9}, 3.671340160893304*^9, 3.6713405788577957`*^9, 
   3.6713679711271095`*^9, {3.6714255246552486`*^9, 3.671425577482798*^9}, 
   3.6714261938657446`*^9, 3.6714282490140953`*^9, 3.6714286472234287`*^9, 
   3.6714293553135495`*^9, 3.671433437362511*^9, 3.671433475781865*^9, 
   3.671433513972904*^9, 3.6714373122437706`*^9, 3.6714375346111946`*^9, 
   3.6714390200038385`*^9, 3.6714393643667912`*^9, {3.671439831195343*^9, 
   3.67143985934064*^9}, 3.6714399412279434`*^9, 3.6714414788827744`*^9, 
   3.671441511315852*^9, 3.671441730064537*^9, 3.6714420797379293`*^9, 
   3.671442551905306*^9, 3.671444271357292*^9, 3.671444321715108*^9, 
   3.671444463112733*^9, 3.6714444967594953`*^9, 3.671447025311639*^9, 
   3.67144713021282*^9, 3.671447643943407*^9, 3.6714477262349806`*^9, 
   3.6714479008824716`*^9, 3.6714500000254464`*^9, 3.6714507540500784`*^9, {
   3.671451901752502*^9, 3.6714519558641634`*^9}, 3.67146370731653*^9, 
   3.6714648424912195`*^9, 3.671513672968769*^9, 3.671515386402877*^9, 
   3.6715154523780403`*^9, 3.6715155050242968`*^9, 3.671515705917068*^9, 
   3.6715164066731157`*^9, 3.671538870046317*^9, 3.671538966336405*^9, 
   3.671539030792556*^9, 3.6727487602739964`*^9, 3.672748907430196*^9}],

Cell[BoxData["3"], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6712730729577208`*^9, 3.671273086927863*^9}, {
   3.6712780242410192`*^9, 3.6712780653843822`*^9}, {3.6712788303214025`*^9, 
   3.6712788398983183`*^9}, 3.671340160893304*^9, 3.6713405788577957`*^9, 
   3.6713679711271095`*^9, {3.6714255246552486`*^9, 3.671425577482798*^9}, 
   3.6714261938657446`*^9, 3.6714282490140953`*^9, 3.6714286472234287`*^9, 
   3.6714293553135495`*^9, 3.671433437362511*^9, 3.671433475781865*^9, 
   3.671433513972904*^9, 3.6714373122437706`*^9, 3.6714375346111946`*^9, 
   3.6714390200038385`*^9, 3.6714393643667912`*^9, {3.671439831195343*^9, 
   3.67143985934064*^9}, 3.6714399412279434`*^9, 3.6714414788827744`*^9, 
   3.671441511315852*^9, 3.671441730064537*^9, 3.6714420797379293`*^9, 
   3.671442551905306*^9, 3.671444271357292*^9, 3.671444321715108*^9, 
   3.671444463112733*^9, 3.6714444967594953`*^9, 3.671447025311639*^9, 
   3.67144713021282*^9, 3.671447643943407*^9, 3.6714477262349806`*^9, 
   3.6714479008824716`*^9, 3.6714500000254464`*^9, 3.6714507540500784`*^9, {
   3.671451901752502*^9, 3.6714519558641634`*^9}, 3.67146370731653*^9, 
   3.6714648424912195`*^9, 3.671513672968769*^9, 3.671515386402877*^9, 
   3.6715154523780403`*^9, 3.6715155050242968`*^9, 3.671515705917068*^9, 
   3.6715164066731157`*^9, 3.671538870046317*^9, 3.671538966336405*^9, 
   3.671539030792556*^9, 3.6727487602739964`*^9, 3.67274890754609*^9}],

Cell[BoxData["3"], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6712730729577208`*^9, 3.671273086927863*^9}, {
   3.6712780242410192`*^9, 3.6712780653843822`*^9}, {3.6712788303214025`*^9, 
   3.6712788398983183`*^9}, 3.671340160893304*^9, 3.6713405788577957`*^9, 
   3.6713679711271095`*^9, {3.6714255246552486`*^9, 3.671425577482798*^9}, 
   3.6714261938657446`*^9, 3.6714282490140953`*^9, 3.6714286472234287`*^9, 
   3.6714293553135495`*^9, 3.671433437362511*^9, 3.671433475781865*^9, 
   3.671433513972904*^9, 3.6714373122437706`*^9, 3.6714375346111946`*^9, 
   3.6714390200038385`*^9, 3.6714393643667912`*^9, {3.671439831195343*^9, 
   3.67143985934064*^9}, 3.6714399412279434`*^9, 3.6714414788827744`*^9, 
   3.671441511315852*^9, 3.671441730064537*^9, 3.6714420797379293`*^9, 
   3.671442551905306*^9, 3.671444271357292*^9, 3.671444321715108*^9, 
   3.671444463112733*^9, 3.6714444967594953`*^9, 3.671447025311639*^9, 
   3.67144713021282*^9, 3.671447643943407*^9, 3.6714477262349806`*^9, 
   3.6714479008824716`*^9, 3.6714500000254464`*^9, 3.6714507540500784`*^9, {
   3.671451901752502*^9, 3.6714519558641634`*^9}, 3.67146370731653*^9, 
   3.6714648424912195`*^9, 3.671513672968769*^9, 3.671515386402877*^9, 
   3.6715154523780403`*^9, 3.6715155050242968`*^9, 3.671515705917068*^9, 
   3.6715164066731157`*^9, 3.671538870046317*^9, 3.671538966336405*^9, 
   3.671539030792556*^9, 3.6727487602739964`*^9, 3.672748907646368*^9}],

Cell[BoxData["10"], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6712730729577208`*^9, 3.671273086927863*^9}, {
   3.6712780242410192`*^9, 3.6712780653843822`*^9}, {3.6712788303214025`*^9, 
   3.6712788398983183`*^9}, 3.671340160893304*^9, 3.6713405788577957`*^9, 
   3.6713679711271095`*^9, {3.6714255246552486`*^9, 3.671425577482798*^9}, 
   3.6714261938657446`*^9, 3.6714282490140953`*^9, 3.6714286472234287`*^9, 
   3.6714293553135495`*^9, 3.671433437362511*^9, 3.671433475781865*^9, 
   3.671433513972904*^9, 3.6714373122437706`*^9, 3.6714375346111946`*^9, 
   3.6714390200038385`*^9, 3.6714393643667912`*^9, {3.671439831195343*^9, 
   3.67143985934064*^9}, 3.6714399412279434`*^9, 3.6714414788827744`*^9, 
   3.671441511315852*^9, 3.671441730064537*^9, 3.6714420797379293`*^9, 
   3.671442551905306*^9, 3.671444271357292*^9, 3.671444321715108*^9, 
   3.671444463112733*^9, 3.6714444967594953`*^9, 3.671447025311639*^9, 
   3.67144713021282*^9, 3.671447643943407*^9, 3.6714477262349806`*^9, 
   3.6714479008824716`*^9, 3.6714500000254464`*^9, 3.6714507540500784`*^9, {
   3.671451901752502*^9, 3.6714519558641634`*^9}, 3.67146370731653*^9, 
   3.6714648424912195`*^9, 3.671513672968769*^9, 3.671515386402877*^9, 
   3.6715154523780403`*^9, 3.6715155050242968`*^9, 3.671515705917068*^9, 
   3.6715164066731157`*^9, 3.671538870046317*^9, 3.671538966336405*^9, 
   3.671539030792556*^9, 3.6727487602739964`*^9, 3.672748908163003*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "108"}],
  SequenceForm["ii=", 108],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6712730729577208`*^9, 3.671273086927863*^9}, {
   3.6712780242410192`*^9, 3.6712780653843822`*^9}, {3.6712788303214025`*^9, 
   3.6712788398983183`*^9}, 3.671340160893304*^9, 3.6713405788577957`*^9, 
   3.6713679711271095`*^9, {3.6714255246552486`*^9, 3.671425577482798*^9}, 
   3.6714261938657446`*^9, 3.6714282490140953`*^9, 3.6714286472234287`*^9, 
   3.6714293553135495`*^9, 3.671433437362511*^9, 3.671433475781865*^9, 
   3.671433513972904*^9, 3.6714373122437706`*^9, 3.6714375346111946`*^9, 
   3.6714390200038385`*^9, 3.6714393643667912`*^9, {3.671439831195343*^9, 
   3.67143985934064*^9}, 3.6714399412279434`*^9, 3.6714414788827744`*^9, 
   3.671441511315852*^9, 3.671441730064537*^9, 3.6714420797379293`*^9, 
   3.671442551905306*^9, 3.671444271357292*^9, 3.671444321715108*^9, 
   3.671444463112733*^9, 3.6714444967594953`*^9, 3.671447025311639*^9, 
   3.67144713021282*^9, 3.671447643943407*^9, 3.6714477262349806`*^9, 
   3.6714479008824716`*^9, 3.6714500000254464`*^9, 3.6714507540500784`*^9, {
   3.671451901752502*^9, 3.6714519558641634`*^9}, 3.67146370731653*^9, 
   3.6714648424912195`*^9, 3.671513672968769*^9, 3.671515386402877*^9, 
   3.6715154523780403`*^9, 3.6715155050242968`*^9, 3.671515705917068*^9, 
   3.6715164066731157`*^9, 3.671538870046317*^9, 3.671538966336405*^9, 
   3.671539030792556*^9, 3.6727487602739964`*^9, 3.672748908216339*^9}],

Cell[BoxData["3"], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6712730729577208`*^9, 3.671273086927863*^9}, {
   3.6712780242410192`*^9, 3.6712780653843822`*^9}, {3.6712788303214025`*^9, 
   3.6712788398983183`*^9}, 3.671340160893304*^9, 3.6713405788577957`*^9, 
   3.6713679711271095`*^9, {3.6714255246552486`*^9, 3.671425577482798*^9}, 
   3.6714261938657446`*^9, 3.6714282490140953`*^9, 3.6714286472234287`*^9, 
   3.6714293553135495`*^9, 3.671433437362511*^9, 3.671433475781865*^9, 
   3.671433513972904*^9, 3.6714373122437706`*^9, 3.6714375346111946`*^9, 
   3.6714390200038385`*^9, 3.6714393643667912`*^9, {3.671439831195343*^9, 
   3.67143985934064*^9}, 3.6714399412279434`*^9, 3.6714414788827744`*^9, 
   3.671441511315852*^9, 3.671441730064537*^9, 3.6714420797379293`*^9, 
   3.671442551905306*^9, 3.671444271357292*^9, 3.671444321715108*^9, 
   3.671444463112733*^9, 3.6714444967594953`*^9, 3.671447025311639*^9, 
   3.67144713021282*^9, 3.671447643943407*^9, 3.6714477262349806`*^9, 
   3.6714479008824716`*^9, 3.6714500000254464`*^9, 3.6714507540500784`*^9, {
   3.671451901752502*^9, 3.6714519558641634`*^9}, 3.67146370731653*^9, 
   3.6714648424912195`*^9, 3.671513672968769*^9, 3.671515386402877*^9, 
   3.6715154523780403`*^9, 3.6715155050242968`*^9, 3.671515705917068*^9, 
   3.6715164066731157`*^9, 3.671538870046317*^9, 3.671538966336405*^9, 
   3.671539030792556*^9, 3.6727487602739964`*^9, 3.6727489083478627`*^9}],

Cell[BoxData["3"], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6712730729577208`*^9, 3.671273086927863*^9}, {
   3.6712780242410192`*^9, 3.6712780653843822`*^9}, {3.6712788303214025`*^9, 
   3.6712788398983183`*^9}, 3.671340160893304*^9, 3.6713405788577957`*^9, 
   3.6713679711271095`*^9, {3.6714255246552486`*^9, 3.671425577482798*^9}, 
   3.6714261938657446`*^9, 3.6714282490140953`*^9, 3.6714286472234287`*^9, 
   3.6714293553135495`*^9, 3.671433437362511*^9, 3.671433475781865*^9, 
   3.671433513972904*^9, 3.6714373122437706`*^9, 3.6714375346111946`*^9, 
   3.6714390200038385`*^9, 3.6714393643667912`*^9, {3.671439831195343*^9, 
   3.67143985934064*^9}, 3.6714399412279434`*^9, 3.6714414788827744`*^9, 
   3.671441511315852*^9, 3.671441730064537*^9, 3.6714420797379293`*^9, 
   3.671442551905306*^9, 3.671444271357292*^9, 3.671444321715108*^9, 
   3.671444463112733*^9, 3.6714444967594953`*^9, 3.671447025311639*^9, 
   3.67144713021282*^9, 3.671447643943407*^9, 3.6714477262349806`*^9, 
   3.6714479008824716`*^9, 3.6714500000254464`*^9, 3.6714507540500784`*^9, {
   3.671451901752502*^9, 3.6714519558641634`*^9}, 3.67146370731653*^9, 
   3.6714648424912195`*^9, 3.671513672968769*^9, 3.671515386402877*^9, 
   3.6715154523780403`*^9, 3.6715155050242968`*^9, 3.671515705917068*^9, 
   3.6715164066731157`*^9, 3.671538870046317*^9, 3.671538966336405*^9, 
   3.671539030792556*^9, 3.6727487602739964`*^9, 3.672748908435587*^9}],

Cell[BoxData["38"], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6712730729577208`*^9, 3.671273086927863*^9}, {
   3.6712780242410192`*^9, 3.6712780653843822`*^9}, {3.6712788303214025`*^9, 
   3.6712788398983183`*^9}, 3.671340160893304*^9, 3.6713405788577957`*^9, 
   3.6713679711271095`*^9, {3.6714255246552486`*^9, 3.671425577482798*^9}, 
   3.6714261938657446`*^9, 3.6714282490140953`*^9, 3.6714286472234287`*^9, 
   3.6714293553135495`*^9, 3.671433437362511*^9, 3.671433475781865*^9, 
   3.671433513972904*^9, 3.6714373122437706`*^9, 3.6714375346111946`*^9, 
   3.6714390200038385`*^9, 3.6714393643667912`*^9, {3.671439831195343*^9, 
   3.67143985934064*^9}, 3.6714399412279434`*^9, 3.6714414788827744`*^9, 
   3.671441511315852*^9, 3.671441730064537*^9, 3.6714420797379293`*^9, 
   3.671442551905306*^9, 3.671444271357292*^9, 3.671444321715108*^9, 
   3.671444463112733*^9, 3.6714444967594953`*^9, 3.671447025311639*^9, 
   3.67144713021282*^9, 3.671447643943407*^9, 3.6714477262349806`*^9, 
   3.6714479008824716`*^9, 3.6714500000254464`*^9, 3.6714507540500784`*^9, {
   3.671451901752502*^9, 3.6714519558641634`*^9}, 3.67146370731653*^9, 
   3.6714648424912195`*^9, 3.671513672968769*^9, 3.671515386402877*^9, 
   3.6715154523780403`*^9, 3.6715155050242968`*^9, 3.671515705917068*^9, 
   3.6715164066731157`*^9, 3.671538870046317*^9, 3.671538966336405*^9, 
   3.671539030792556*^9, 3.6727487602739964`*^9, 3.6727489119992604`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "109"}],
  SequenceForm["ii=", 109],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6712730729577208`*^9, 3.671273086927863*^9}, {
   3.6712780242410192`*^9, 3.6712780653843822`*^9}, {3.6712788303214025`*^9, 
   3.6712788398983183`*^9}, 3.671340160893304*^9, 3.6713405788577957`*^9, 
   3.6713679711271095`*^9, {3.6714255246552486`*^9, 3.671425577482798*^9}, 
   3.6714261938657446`*^9, 3.6714282490140953`*^9, 3.6714286472234287`*^9, 
   3.6714293553135495`*^9, 3.671433437362511*^9, 3.671433475781865*^9, 
   3.671433513972904*^9, 3.6714373122437706`*^9, 3.6714375346111946`*^9, 
   3.6714390200038385`*^9, 3.6714393643667912`*^9, {3.671439831195343*^9, 
   3.67143985934064*^9}, 3.6714399412279434`*^9, 3.6714414788827744`*^9, 
   3.671441511315852*^9, 3.671441730064537*^9, 3.6714420797379293`*^9, 
   3.671442551905306*^9, 3.671444271357292*^9, 3.671444321715108*^9, 
   3.671444463112733*^9, 3.6714444967594953`*^9, 3.671447025311639*^9, 
   3.67144713021282*^9, 3.671447643943407*^9, 3.6714477262349806`*^9, 
   3.6714479008824716`*^9, 3.6714500000254464`*^9, 3.6714507540500784`*^9, {
   3.671451901752502*^9, 3.6714519558641634`*^9}, 3.67146370731653*^9, 
   3.6714648424912195`*^9, 3.671513672968769*^9, 3.671515386402877*^9, 
   3.6715154523780403`*^9, 3.6715155050242968`*^9, 3.671515705917068*^9, 
   3.6715164066731157`*^9, 3.671538870046317*^9, 3.671538966336405*^9, 
   3.671539030792556*^9, 3.6727487602739964`*^9, 3.672748927926013*^9}],

Cell[BoxData["1"], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6712730729577208`*^9, 3.671273086927863*^9}, {
   3.6712780242410192`*^9, 3.6712780653843822`*^9}, {3.6712788303214025`*^9, 
   3.6712788398983183`*^9}, 3.671340160893304*^9, 3.6713405788577957`*^9, 
   3.6713679711271095`*^9, {3.6714255246552486`*^9, 3.671425577482798*^9}, 
   3.6714261938657446`*^9, 3.6714282490140953`*^9, 3.6714286472234287`*^9, 
   3.6714293553135495`*^9, 3.671433437362511*^9, 3.671433475781865*^9, 
   3.671433513972904*^9, 3.6714373122437706`*^9, 3.6714375346111946`*^9, 
   3.6714390200038385`*^9, 3.6714393643667912`*^9, {3.671439831195343*^9, 
   3.67143985934064*^9}, 3.6714399412279434`*^9, 3.6714414788827744`*^9, 
   3.671441511315852*^9, 3.671441730064537*^9, 3.6714420797379293`*^9, 
   3.671442551905306*^9, 3.671444271357292*^9, 3.671444321715108*^9, 
   3.671444463112733*^9, 3.6714444967594953`*^9, 3.671447025311639*^9, 
   3.67144713021282*^9, 3.671447643943407*^9, 3.6714477262349806`*^9, 
   3.6714479008824716`*^9, 3.6714500000254464`*^9, 3.6714507540500784`*^9, {
   3.671451901752502*^9, 3.6714519558641634`*^9}, 3.67146370731653*^9, 
   3.6714648424912195`*^9, 3.671513672968769*^9, 3.671515386402877*^9, 
   3.6715154523780403`*^9, 3.6715155050242968`*^9, 3.671515705917068*^9, 
   3.6715164066731157`*^9, 3.671538870046317*^9, 3.671538966336405*^9, 
   3.671539030792556*^9, 3.6727487602739964`*^9, 3.672748927926013*^9}],

Cell[BoxData["1"], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6712730729577208`*^9, 3.671273086927863*^9}, {
   3.6712780242410192`*^9, 3.6712780653843822`*^9}, {3.6712788303214025`*^9, 
   3.6712788398983183`*^9}, 3.671340160893304*^9, 3.6713405788577957`*^9, 
   3.6713679711271095`*^9, {3.6714255246552486`*^9, 3.671425577482798*^9}, 
   3.6714261938657446`*^9, 3.6714282490140953`*^9, 3.6714286472234287`*^9, 
   3.6714293553135495`*^9, 3.671433437362511*^9, 3.671433475781865*^9, 
   3.671433513972904*^9, 3.6714373122437706`*^9, 3.6714375346111946`*^9, 
   3.6714390200038385`*^9, 3.6714393643667912`*^9, {3.671439831195343*^9, 
   3.67143985934064*^9}, 3.6714399412279434`*^9, 3.6714414788827744`*^9, 
   3.671441511315852*^9, 3.671441730064537*^9, 3.6714420797379293`*^9, 
   3.671442551905306*^9, 3.671444271357292*^9, 3.671444321715108*^9, 
   3.671444463112733*^9, 3.6714444967594953`*^9, 3.671447025311639*^9, 
   3.67144713021282*^9, 3.671447643943407*^9, 3.6714477262349806`*^9, 
   3.6714479008824716`*^9, 3.6714500000254464`*^9, 3.6714507540500784`*^9, {
   3.671451901752502*^9, 3.6714519558641634`*^9}, 3.67146370731653*^9, 
   3.6714648424912195`*^9, 3.671513672968769*^9, 3.671515386402877*^9, 
   3.6715154523780403`*^9, 3.6715155050242968`*^9, 3.671515705917068*^9, 
   3.6715164066731157`*^9, 3.671538870046317*^9, 3.671538966336405*^9, 
   3.671539030792556*^9, 3.6727487602739964`*^9, 3.6727489279471474`*^9}],

Cell[BoxData["2"], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6712730729577208`*^9, 3.671273086927863*^9}, {
   3.6712780242410192`*^9, 3.6712780653843822`*^9}, {3.6712788303214025`*^9, 
   3.6712788398983183`*^9}, 3.671340160893304*^9, 3.6713405788577957`*^9, 
   3.6713679711271095`*^9, {3.6714255246552486`*^9, 3.671425577482798*^9}, 
   3.6714261938657446`*^9, 3.6714282490140953`*^9, 3.6714286472234287`*^9, 
   3.6714293553135495`*^9, 3.671433437362511*^9, 3.671433475781865*^9, 
   3.671433513972904*^9, 3.6714373122437706`*^9, 3.6714375346111946`*^9, 
   3.6714390200038385`*^9, 3.6714393643667912`*^9, {3.671439831195343*^9, 
   3.67143985934064*^9}, 3.6714399412279434`*^9, 3.6714414788827744`*^9, 
   3.671441511315852*^9, 3.671441730064537*^9, 3.6714420797379293`*^9, 
   3.671442551905306*^9, 3.671444271357292*^9, 3.671444321715108*^9, 
   3.671444463112733*^9, 3.6714444967594953`*^9, 3.671447025311639*^9, 
   3.67144713021282*^9, 3.671447643943407*^9, 3.6714477262349806`*^9, 
   3.6714479008824716`*^9, 3.6714500000254464`*^9, 3.6714507540500784`*^9, {
   3.671451901752502*^9, 3.6714519558641634`*^9}, 3.67146370731653*^9, 
   3.6714648424912195`*^9, 3.671513672968769*^9, 3.671515386402877*^9, 
   3.6715154523780403`*^9, 3.6715155050242968`*^9, 3.671515705917068*^9, 
   3.6715164066731157`*^9, 3.671538870046317*^9, 3.671538966336405*^9, 
   3.671539030792556*^9, 3.6727487602739964`*^9, 3.6727489279637804`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "110"}],
  SequenceForm["ii=", 110],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6712730729577208`*^9, 3.671273086927863*^9}, {
   3.6712780242410192`*^9, 3.6712780653843822`*^9}, {3.6712788303214025`*^9, 
   3.6712788398983183`*^9}, 3.671340160893304*^9, 3.6713405788577957`*^9, 
   3.6713679711271095`*^9, {3.6714255246552486`*^9, 3.671425577482798*^9}, 
   3.6714261938657446`*^9, 3.6714282490140953`*^9, 3.6714286472234287`*^9, 
   3.6714293553135495`*^9, 3.671433437362511*^9, 3.671433475781865*^9, 
   3.671433513972904*^9, 3.6714373122437706`*^9, 3.6714375346111946`*^9, 
   3.6714390200038385`*^9, 3.6714393643667912`*^9, {3.671439831195343*^9, 
   3.67143985934064*^9}, 3.6714399412279434`*^9, 3.6714414788827744`*^9, 
   3.671441511315852*^9, 3.671441730064537*^9, 3.6714420797379293`*^9, 
   3.671442551905306*^9, 3.671444271357292*^9, 3.671444321715108*^9, 
   3.671444463112733*^9, 3.6714444967594953`*^9, 3.671447025311639*^9, 
   3.67144713021282*^9, 3.671447643943407*^9, 3.6714477262349806`*^9, 
   3.6714479008824716`*^9, 3.6714500000254464`*^9, 3.6714507540500784`*^9, {
   3.671451901752502*^9, 3.6714519558641634`*^9}, 3.67146370731653*^9, 
   3.6714648424912195`*^9, 3.671513672968769*^9, 3.671515386402877*^9, 
   3.6715154523780403`*^9, 3.6715155050242968`*^9, 3.671515705917068*^9, 
   3.6715164066731157`*^9, 3.671538870046317*^9, 3.671538966336405*^9, 
   3.671539030792556*^9, 3.6727487602739964`*^9, 3.6727489281794715`*^9}],

Cell[BoxData["1"], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6712730729577208`*^9, 3.671273086927863*^9}, {
   3.6712780242410192`*^9, 3.6712780653843822`*^9}, {3.6712788303214025`*^9, 
   3.6712788398983183`*^9}, 3.671340160893304*^9, 3.6713405788577957`*^9, 
   3.6713679711271095`*^9, {3.6714255246552486`*^9, 3.671425577482798*^9}, 
   3.6714261938657446`*^9, 3.6714282490140953`*^9, 3.6714286472234287`*^9, 
   3.6714293553135495`*^9, 3.671433437362511*^9, 3.671433475781865*^9, 
   3.671433513972904*^9, 3.6714373122437706`*^9, 3.6714375346111946`*^9, 
   3.6714390200038385`*^9, 3.6714393643667912`*^9, {3.671439831195343*^9, 
   3.67143985934064*^9}, 3.6714399412279434`*^9, 3.6714414788827744`*^9, 
   3.671441511315852*^9, 3.671441730064537*^9, 3.6714420797379293`*^9, 
   3.671442551905306*^9, 3.671444271357292*^9, 3.671444321715108*^9, 
   3.671444463112733*^9, 3.6714444967594953`*^9, 3.671447025311639*^9, 
   3.67144713021282*^9, 3.671447643943407*^9, 3.6714477262349806`*^9, 
   3.6714479008824716`*^9, 3.6714500000254464`*^9, 3.6714507540500784`*^9, {
   3.671451901752502*^9, 3.6714519558641634`*^9}, 3.67146370731653*^9, 
   3.6714648424912195`*^9, 3.671513672968769*^9, 3.671515386402877*^9, 
   3.6715154523780403`*^9, 3.6715155050242968`*^9, 3.671515705917068*^9, 
   3.6715164066731157`*^9, 3.671538870046317*^9, 3.671538966336405*^9, 
   3.671539030792556*^9, 3.6727487602739964`*^9, 3.6727489281794715`*^9}],

Cell[BoxData["1"], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6712730729577208`*^9, 3.671273086927863*^9}, {
   3.6712780242410192`*^9, 3.6712780653843822`*^9}, {3.6712788303214025`*^9, 
   3.6712788398983183`*^9}, 3.671340160893304*^9, 3.6713405788577957`*^9, 
   3.6713679711271095`*^9, {3.6714255246552486`*^9, 3.671425577482798*^9}, 
   3.6714261938657446`*^9, 3.6714282490140953`*^9, 3.6714286472234287`*^9, 
   3.6714293553135495`*^9, 3.671433437362511*^9, 3.671433475781865*^9, 
   3.671433513972904*^9, 3.6714373122437706`*^9, 3.6714375346111946`*^9, 
   3.6714390200038385`*^9, 3.6714393643667912`*^9, {3.671439831195343*^9, 
   3.67143985934064*^9}, 3.6714399412279434`*^9, 3.6714414788827744`*^9, 
   3.671441511315852*^9, 3.671441730064537*^9, 3.6714420797379293`*^9, 
   3.671442551905306*^9, 3.671444271357292*^9, 3.671444321715108*^9, 
   3.671444463112733*^9, 3.6714444967594953`*^9, 3.671447025311639*^9, 
   3.67144713021282*^9, 3.671447643943407*^9, 3.6714477262349806`*^9, 
   3.6714479008824716`*^9, 3.6714500000254464`*^9, 3.6714507540500784`*^9, {
   3.671451901752502*^9, 3.6714519558641634`*^9}, 3.67146370731653*^9, 
   3.6714648424912195`*^9, 3.671513672968769*^9, 3.671515386402877*^9, 
   3.6715154523780403`*^9, 3.6715155050242968`*^9, 3.671515705917068*^9, 
   3.6715164066731157`*^9, 3.671538870046317*^9, 3.671538966336405*^9, 
   3.671539030792556*^9, 3.6727487602739964`*^9, 3.672748928195093*^9}],

Cell[BoxData["2"], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6712730729577208`*^9, 3.671273086927863*^9}, {
   3.6712780242410192`*^9, 3.6712780653843822`*^9}, {3.6712788303214025`*^9, 
   3.6712788398983183`*^9}, 3.671340160893304*^9, 3.6713405788577957`*^9, 
   3.6713679711271095`*^9, {3.6714255246552486`*^9, 3.671425577482798*^9}, 
   3.6714261938657446`*^9, 3.6714282490140953`*^9, 3.6714286472234287`*^9, 
   3.6714293553135495`*^9, 3.671433437362511*^9, 3.671433475781865*^9, 
   3.671433513972904*^9, 3.6714373122437706`*^9, 3.6714375346111946`*^9, 
   3.6714390200038385`*^9, 3.6714393643667912`*^9, {3.671439831195343*^9, 
   3.67143985934064*^9}, 3.6714399412279434`*^9, 3.6714414788827744`*^9, 
   3.671441511315852*^9, 3.671441730064537*^9, 3.6714420797379293`*^9, 
   3.671442551905306*^9, 3.671444271357292*^9, 3.671444321715108*^9, 
   3.671444463112733*^9, 3.6714444967594953`*^9, 3.671447025311639*^9, 
   3.67144713021282*^9, 3.671447643943407*^9, 3.6714477262349806`*^9, 
   3.6714479008824716`*^9, 3.6714500000254464`*^9, 3.6714507540500784`*^9, {
   3.671451901752502*^9, 3.6714519558641634`*^9}, 3.67146370731653*^9, 
   3.6714648424912195`*^9, 3.671513672968769*^9, 3.671515386402877*^9, 
   3.6715154523780403`*^9, 3.6715155050242968`*^9, 3.671515705917068*^9, 
   3.6715164066731157`*^9, 3.671538870046317*^9, 3.671538966336405*^9, 
   3.671539030792556*^9, 3.6727487602739964`*^9, 3.67274892821072*^9}]
}, Closed]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6709203864459443`*^9, 3.670920386626472*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Here", " ", "we", " ", "check", " ", "higgsEdgesBFT"}], 
  "*)"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6647893950303826`*^9, 3.6647894076633363`*^9}, {
   3.667049585039831*^9, 3.667049586467121*^9}, {3.67023348873209*^9, 
   3.67023349002195*^9}, 3.67091001914213*^9, {3.670920880609946*^9, 
   3.6709208862418547`*^9}, {3.671261025522729*^9, 3.671261040436485*^9}, 
   3.6717741748985643`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Off", "[", 
   RowBox[{"Subsets", "::", "take"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"formatrule", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["XX_", 
      RowBox[{"z1_", ",", "z2_"}]], "\[Rule]", 
     RowBox[{"XX", "[", 
      RowBox[{"z1", ",", "z2"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ii", "=", "1"}], ",", 
    RowBox[{"ii", "\[LessEqual]", "110"}], ",", 
    RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<ii=\>\"", ",", "ii"}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     SubscriptBox["bft", "ii"], ";", "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"a", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b", "=", 
      RowBox[{"b", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"c", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"d", "=", 
      RowBox[{"d", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"alledges", "=", 
      RowBox[{"Variables", "[", 
       RowBox[{"Join", "[", 
        RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Let", "'"}], "s", " ", "mix", " ", "them", " ", "up", " ", 
       "a", " ", "bit", " ", "to", " ", "give", " ", "a", " ", "wider", " ", 
       "variety", " ", "of", " ", "scenarios"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"alledges", "=", 
      RowBox[{"Riffle", "[", 
       RowBox[{
        RowBox[{"alledges", "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", 
           RowBox[{"-", "1"}], ";;", "2"}], "]"}], "]"}], ",", 
        RowBox[{"Reverse", "[", 
         RowBox[{"alledges", "[", 
          RowBox[{"[", 
           RowBox[{"2", ";;", 
            RowBox[{"-", "1"}], ";;", "2"}], "]"}], "]"}], "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"turnoffcombinations", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Subsets", "[", 
         RowBox[{"alledges", ",", 
          RowBox[{"{", "0", "}"}]}], "]"}], ",", 
        RowBox[{"Subsets", "[", 
         RowBox[{"alledges", ",", 
          RowBox[{"{", "1", "}"}]}], "]"}], ",", 
        RowBox[{"Subsets", "[", 
         RowBox[{"alledges", ",", 
          RowBox[{"{", "2", "}"}]}], "]"}], ",", 
        RowBox[{"Join", "@@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Subsets", "[", 
            RowBox[{"alledges", ",", 
             RowBox[{"{", "iii", "}"}], ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Round", "[", 
                RowBox[{"2000", "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Length", "[", "alledges", "]"}], "-", "5"}], 
                  ")"}]}], "]"}], "/.", 
               RowBox[{"{", 
                RowBox[{"0", "\[Rule]", "1"}], "}"}]}], ")"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"iii", ",", "3", ",", 
             RowBox[{
              RowBox[{"Length", "[", "alledges", "]"}], "-", "3"}]}], "}"}]}],
           "]"}]}], ",", 
        RowBox[{"Subsets", "[", 
         RowBox[{"alledges", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Length", "[", "alledges", "]"}], "-", "2"}], "}"}]}], 
         "]"}], ",", 
        RowBox[{"Subsets", "[", 
         RowBox[{"alledges", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Length", "[", "alledges", "]"}], "-", "1"}], "}"}]}], 
         "]"}], ",", 
        RowBox[{"Subsets", "[", 
         RowBox[{"alledges", ",", 
          RowBox[{"{", 
           RowBox[{"Length", "[", "alledges", "]"}], "}"}]}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"higgsedkasteleyns", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"higgsEdgesBFT", "[", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "#"}], "]"}], "&"}],
         ",", "turnoffcombinations"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"And", "@@", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"getDuplicateEdges", "[", 
                 RowBox[{"Sequence", "@@", "#"}], "]"}], "\[Equal]", 
                RowBox[{"{", "}"}]}], "&&", 
               RowBox[{"getEdgesBFTformQ", "[", 
                RowBox[{"Sequence", "@@", "#"}], "]"}], "&&", 
               RowBox[{
                RowBox[{"getKasteleynConsistencyViolation", "[", 
                 RowBox[{"Sequence", "@@", "#"}], "]"}], "===", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", "}"}], ",", 
                  RowBox[{"{", "}"}]}], "}"}]}]}], ")"}], "&"}], ",", 
            "higgsedkasteleyns"}], "]"}]}], ")"}], "=!=", "True"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<ii=\>\"", ",", "ii", ",", 
          "\"\< : The index structure of BFTs wasn't preserved after the \
higgsing!\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"And", "@@", 
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "alledges", "]"}], "-", 
               RowBox[{"Length", "[", 
                RowBox[{"Variables", "[", "#1", "]"}], "]"}]}], "\[Equal]", 
              RowBox[{"Length", "[", 
               RowBox[{"consistentEdgeRemoval", "[", 
                RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "#2"}], "]"}],
                "]"}]}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{"higgsedkasteleyns", ",", "turnoffcombinations"}], 
             "}"}]}], "]"}]}], ")"}], "=!=", "True"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<ii=\>\"", ",", "ii", ",", 
          "\"\< : The higgsing hasn't removed the correct number of \
edges!\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"On", "[", 
   RowBox[{"Subsets", "::", "take"}], "]"}], ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.664781819710851*^9, 3.66478198207829*^9}, {
   3.6647820277729077`*^9, 3.6647820661125183`*^9}, 3.6647822947623367`*^9, {
   3.664782367011778*^9, 3.664782405137395*^9}, {3.66478245916627*^9, 
   3.664782540993922*^9}, 3.6647827017368417`*^9, {3.6647828039884424`*^9, 
   3.664782898580064*^9}, {3.6647829297236333`*^9, 3.6647829520229616`*^9}, 
   3.664782983955406*^9, {3.66478439381633*^9, 3.664784454309479*^9}, {
   3.6647844865795813`*^9, 3.6647845167036495`*^9}, {3.664784914565*^9, 
   3.6647849834988747`*^9}, {3.6647893830056033`*^9, 
   3.6647894076633363`*^9}, {3.6670474671026745`*^9, 3.6670474672901683`*^9}, 
   3.667048782777152*^9, {3.667571624499669*^9, 3.6675716441876526`*^9}, {
   3.670244519128513*^9, 3.670244528314185*^9}, {3.6709104200095353`*^9, 
   3.670910483539136*^9}, {3.6709105173352757`*^9, 3.670910613249056*^9}, {
   3.670910645574507*^9, 3.670910653288369*^9}, {3.6709108673310013`*^9, 
   3.6709108674290533`*^9}, {3.670910901148337*^9, 3.670910924499362*^9}, {
   3.670910989695868*^9, 3.670911033859152*^9}, {3.670911071219535*^9, 
   3.670911220682269*^9}, {3.670911351397422*^9, 3.6709115290810776`*^9}, {
   3.6709115996768923`*^9, 3.670911613455324*^9}, {3.670911838108729*^9, 
   3.670911846025834*^9}, {3.6709118944544783`*^9, 3.670911949940152*^9}, {
   3.670911997766349*^9, 3.6709120297574253`*^9}, {3.6709120710165014`*^9, 
   3.6709121598355923`*^9}, {3.67091219189585*^9, 3.6709122194937067`*^9}, 
   3.6709122877527046`*^9, {3.6709123503578634`*^9, 3.670912371447871*^9}, {
   3.6709124124790955`*^9, 3.6709124139626703`*^9}, {3.6709125427631283`*^9, 
   3.6709125441335583`*^9}, {3.670912586473938*^9, 3.670912601782899*^9}, {
   3.670912657824276*^9, 3.6709126827225056`*^9}, {3.6709127131691833`*^9, 
   3.6709127158601255`*^9}, {3.670912816691945*^9, 3.6709128320409822`*^9}, {
   3.670912881185275*^9, 3.670912948379197*^9}, {3.6709130383202834`*^9, 
   3.6709130411598625`*^9}, 3.6709134828250136`*^9, {3.6709136558342714`*^9, 
   3.6709137235961*^9}, {3.670914085817363*^9, 3.6709141326870584`*^9}, {
   3.6709142326146603`*^9, 3.6709143133373947`*^9}, {3.670915304877978*^9, 
   3.6709153330098486`*^9}, {3.6709199720758567`*^9, 3.670920000122165*^9}, {
   3.6709201894332714`*^9, 3.6709202033904867`*^9}, {3.670920242872819*^9, 
   3.6709202845685506`*^9}, 3.670920371625329*^9, {3.67092094500834*^9, 
   3.6709210050490236`*^9}, {3.670921181539347*^9, 3.670921347036747*^9}, {
   3.670921581602537*^9, 3.670921583846383*^9}, {3.670921668755324*^9, 
   3.6709216696992855`*^9}, {3.670921701038556*^9, 3.6709217092945414`*^9}, {
   3.670921951057428*^9, 3.6709219736569033`*^9}, {3.670923557860277*^9, 
   3.670923740702423*^9}, {3.6711806272308908`*^9, 3.6711806291505103`*^9}, {
   3.671180770792122*^9, 3.671180776920453*^9}, {3.6711850605534196`*^9, 
   3.671185107856476*^9}, {3.6711856353217745`*^9, 3.6711856664678745`*^9}, {
   3.671185940099115*^9, 3.6711859589609222`*^9}, {3.6711860621969643`*^9, 
   3.671186078877637*^9}, {3.671186137117034*^9, 3.6711861962369795`*^9}, {
   3.671186229913108*^9, 3.6711862596264524`*^9}, {3.6711864166326313`*^9, 
   3.671186482704314*^9}, {3.671186561754046*^9, 3.671186565992087*^9}, {
   3.6711866136144*^9, 3.6711866222941666`*^9}, {3.671186975113619*^9, 
   3.671186989984462*^9}, {3.6711870218638*^9, 3.6711870272972755`*^9}, 
   3.671187263770239*^9, {3.6711873717966604`*^9, 3.671187377601221*^9}, 
   3.671188081312666*^9, {3.6711886770722337`*^9, 3.6711886880917587`*^9}, {
   3.671188720581915*^9, 3.6711887209436607`*^9}, {3.671191095241579*^9, 
   3.6711910953728*^9}, {3.6711911440062494`*^9, 3.671191195964123*^9}, {
   3.6711914673556395`*^9, 3.671191538574589*^9}, {3.6711915915923185`*^9, 
   3.6711916635904813`*^9}, {3.6711918077105265`*^9, 
   3.6711918973765507`*^9}, {3.6711919982763977`*^9, 
   3.6711920142937403`*^9}, {3.6711920654310446`*^9, 3.671192138288003*^9}, {
   3.6711921750304976`*^9, 3.671192210005745*^9}, {3.6711922536057405`*^9, 
   3.671192255424406*^9}, {3.6711924535783424`*^9, 3.6711924763186398`*^9}, {
   3.6711925669231076`*^9, 3.671192601549764*^9}, {3.6711927168449135`*^9, 
   3.6711927416194983`*^9}, {3.6711928936644382`*^9, 3.671192943266226*^9}, {
   3.671193003271166*^9, 3.6711930217250357`*^9}, 3.671193072263878*^9, 
   3.6711931174707413`*^9, {3.671193166927243*^9, 3.671193167364518*^9}, {
   3.671193228584111*^9, 3.6711932289848137`*^9}, {3.6711946047091045`*^9, 
   3.671194611212427*^9}, {3.671194689892874*^9, 3.6711947353024483`*^9}, {
   3.67119482850189*^9, 3.671194918448003*^9}, {3.671194979206033*^9, 
   3.671195019714262*^9}, {3.671195109244729*^9, 3.67119511112999*^9}, {
   3.6712730188540773`*^9, 3.6712730706584754`*^9}, {3.67127802269307*^9, 
   3.671278064567593*^9}, {3.6712788091102934`*^9, 3.6712788389039736`*^9}, {
   3.671368050488973*^9, 3.671368050817107*^9}, {3.671425543202236*^9, 
   3.6714255763957376`*^9}, {3.671426155595744*^9, 3.6714261880270233`*^9}, 
   3.6714282356341543`*^9, {3.671428577592679*^9, 3.6714286451381645`*^9}, {
   3.6714334305868626`*^9, 3.6714335119715896`*^9}, 3.67143731004537*^9, {
   3.6714375315687785`*^9, 3.671437531769021*^9}, {3.671439002880684*^9, 
   3.6714390151865444`*^9}, {3.6714393265407543`*^9, 3.67143939270599*^9}, {
   3.6714398089494348`*^9, 3.6714398585894847`*^9}, {3.6714399216501255`*^9, 
   3.6714399394678082`*^9}, {3.671441440079903*^9, 3.6714415099084873`*^9}, {
   3.6714416532412577`*^9, 3.671441727920885*^9}, {3.6714420735570664`*^9, 
   3.671442075398585*^9}, {3.67144229988265*^9, 3.6714424775228043`*^9}, {
   3.6714425076724634`*^9, 3.6714425513042693`*^9}, {3.6714440536782265`*^9, 
   3.671444067292127*^9}, {3.6714441320743217`*^9, 3.6714442660812855`*^9}, {
   3.671444446399582*^9, 3.6714444952723727`*^9}, {3.6714466519839473`*^9, 
   3.6714467200464635`*^9}, 3.671447017630552*^9, {3.671447053916916*^9, 
   3.6714471281811204`*^9}, {3.6714472087086153`*^9, 3.671447214206172*^9}, {
   3.6714475338423157`*^9, 3.671447626088956*^9}, {3.6714477138576393`*^9, 
   3.6714477224350357`*^9}, {3.6714478680567894`*^9, 3.671447889159058*^9}, {
   3.671449613638344*^9, 3.6714496241936293`*^9}, {3.671449898477844*^9, 
   3.671449900739956*^9}, {3.67144997397748*^9, 3.6714499933043175`*^9}, {
   3.6714507382903633`*^9, 3.671450751608225*^9}, {3.6714518795711803`*^9, 
   3.6714519521616077`*^9}, {3.671453452980751*^9, 3.6714534549046745`*^9}, {
   3.6714535415982347`*^9, 3.6714535448855357`*^9}, {3.6714535775108*^9, 
   3.6714536151310472`*^9}, {3.671463738585285*^9, 3.6714637559587708`*^9}, {
   3.6714639619032044`*^9, 3.6714639735163155`*^9}, {3.671464688397129*^9, 
   3.67146468908327*^9}, {3.671513654012539*^9, 3.6715136550532455`*^9}, {
   3.6715153696002665`*^9, 3.6715154602835073`*^9}, {3.6715155533835707`*^9, 
   3.671515560771036*^9}, {3.671515646275035*^9, 3.671515699756398*^9}, 
   3.6715164008459015`*^9, {3.671519499580912*^9, 3.6715195009187984`*^9}, {
   3.67153885061821*^9, 3.671538851524764*^9}, {3.6715439260812283`*^9, 
   3.671543930345441*^9}, {3.6715441172038736`*^9, 3.6715441198735666`*^9}, {
   3.6715443744013977`*^9, 3.671544382550761*^9}, {3.6715450174827404`*^9, 
   3.671545018051359*^9}, {3.6715450710154686`*^9, 3.671545074805319*^9}, {
   3.671545164122321*^9, 3.671545164951691*^9}, {3.671545293099631*^9, 
   3.6715452938436623`*^9}, {3.6716881185555735`*^9, 
   3.6716881235705557`*^9}, {3.671774179312095*^9, 3.6717742084993916`*^9}, {
   3.6717742621362057`*^9, 3.6717743566581507`*^9}, {3.671774391803801*^9, 
   3.671774485578947*^9}, {3.6727489907726054`*^9, 3.6727489927584114`*^9}, 
   3.6727490319013834`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "105"}],
  SequenceForm["ii=", 105],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6712730729577208`*^9, 3.671273086927863*^9}, {
   3.6712780242410192`*^9, 3.6712780653843822`*^9}, {3.6712788303214025`*^9, 
   3.6712788398983183`*^9}, 3.671340160893304*^9, 3.6713405788577957`*^9, 
   3.6713679711271095`*^9, {3.6714255246552486`*^9, 3.671425577482798*^9}, 
   3.6714261938657446`*^9, 3.6714282490140953`*^9, 3.6714286472234287`*^9, 
   3.6714293553135495`*^9, 3.671433437362511*^9, 3.671433475781865*^9, 
   3.671433513972904*^9, 3.6714373122437706`*^9, 3.6714375346111946`*^9, 
   3.6714390200038385`*^9, 3.6714393643667912`*^9, {3.671439831195343*^9, 
   3.67143985934064*^9}, 3.6714399412279434`*^9, 3.6714414788827744`*^9, 
   3.671441511315852*^9, 3.671441730064537*^9, 3.6714420797379293`*^9, 
   3.671442551905306*^9, 3.671444271357292*^9, 3.671444321715108*^9, 
   3.671444463112733*^9, 3.6714444967594953`*^9, 3.671447025311639*^9, 
   3.67144713021282*^9, 3.671447643943407*^9, 3.6714477262349806`*^9, 
   3.6714479008824716`*^9, 3.6714500000254464`*^9, 3.6714507540500784`*^9, {
   3.671451901752502*^9, 3.6714519558641634`*^9}, 3.67146370731653*^9, 
   3.6714648424912195`*^9, 3.671513672968769*^9, 3.671515386402877*^9, 
   3.6715154523780403`*^9, 3.6715155050242968`*^9, 3.671515705917068*^9, 
   3.6715164066731157`*^9, 3.671538870046317*^9, 3.671538966336405*^9, 
   3.671539030792556*^9, {3.671774211263186*^9, 3.6717742359104233`*^9}, {
   3.671774298179055*^9, 3.6717743233451896`*^9}, 3.671774358527082*^9, 
   3.671774433915724*^9, 3.6717744876542177`*^9, 3.671775638085752*^9, 
   3.67178263467992*^9, 3.6717841942955856`*^9, 3.6717843722509117`*^9, 
   3.672749002525978*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "106"}],
  SequenceForm["ii=", 106],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6712730729577208`*^9, 3.671273086927863*^9}, {
   3.6712780242410192`*^9, 3.6712780653843822`*^9}, {3.6712788303214025`*^9, 
   3.6712788398983183`*^9}, 3.671340160893304*^9, 3.6713405788577957`*^9, 
   3.6713679711271095`*^9, {3.6714255246552486`*^9, 3.671425577482798*^9}, 
   3.6714261938657446`*^9, 3.6714282490140953`*^9, 3.6714286472234287`*^9, 
   3.6714293553135495`*^9, 3.671433437362511*^9, 3.671433475781865*^9, 
   3.671433513972904*^9, 3.6714373122437706`*^9, 3.6714375346111946`*^9, 
   3.6714390200038385`*^9, 3.6714393643667912`*^9, {3.671439831195343*^9, 
   3.67143985934064*^9}, 3.6714399412279434`*^9, 3.6714414788827744`*^9, 
   3.671441511315852*^9, 3.671441730064537*^9, 3.6714420797379293`*^9, 
   3.671442551905306*^9, 3.671444271357292*^9, 3.671444321715108*^9, 
   3.671444463112733*^9, 3.6714444967594953`*^9, 3.671447025311639*^9, 
   3.67144713021282*^9, 3.671447643943407*^9, 3.6714477262349806`*^9, 
   3.6714479008824716`*^9, 3.6714500000254464`*^9, 3.6714507540500784`*^9, {
   3.671451901752502*^9, 3.6714519558641634`*^9}, 3.67146370731653*^9, 
   3.6714648424912195`*^9, 3.671513672968769*^9, 3.671515386402877*^9, 
   3.6715154523780403`*^9, 3.6715155050242968`*^9, 3.671515705917068*^9, 
   3.6715164066731157`*^9, 3.671538870046317*^9, 3.671538966336405*^9, 
   3.671539030792556*^9, {3.671774211263186*^9, 3.6717742359104233`*^9}, {
   3.671774298179055*^9, 3.6717743233451896`*^9}, 3.671774358527082*^9, 
   3.671774433915724*^9, 3.6717744876542177`*^9, 3.671775638085752*^9, 
   3.67178263467992*^9, 3.6717841942955856`*^9, 3.6717843722509117`*^9, 
   3.6727490071509914`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "107"}],
  SequenceForm["ii=", 107],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6712730729577208`*^9, 3.671273086927863*^9}, {
   3.6712780242410192`*^9, 3.6712780653843822`*^9}, {3.6712788303214025`*^9, 
   3.6712788398983183`*^9}, 3.671340160893304*^9, 3.6713405788577957`*^9, 
   3.6713679711271095`*^9, {3.6714255246552486`*^9, 3.671425577482798*^9}, 
   3.6714261938657446`*^9, 3.6714282490140953`*^9, 3.6714286472234287`*^9, 
   3.6714293553135495`*^9, 3.671433437362511*^9, 3.671433475781865*^9, 
   3.671433513972904*^9, 3.6714373122437706`*^9, 3.6714375346111946`*^9, 
   3.6714390200038385`*^9, 3.6714393643667912`*^9, {3.671439831195343*^9, 
   3.67143985934064*^9}, 3.6714399412279434`*^9, 3.6714414788827744`*^9, 
   3.671441511315852*^9, 3.671441730064537*^9, 3.6714420797379293`*^9, 
   3.671442551905306*^9, 3.671444271357292*^9, 3.671444321715108*^9, 
   3.671444463112733*^9, 3.6714444967594953`*^9, 3.671447025311639*^9, 
   3.67144713021282*^9, 3.671447643943407*^9, 3.6714477262349806`*^9, 
   3.6714479008824716`*^9, 3.6714500000254464`*^9, 3.6714507540500784`*^9, {
   3.671451901752502*^9, 3.6714519558641634`*^9}, 3.67146370731653*^9, 
   3.6714648424912195`*^9, 3.671513672968769*^9, 3.671515386402877*^9, 
   3.6715154523780403`*^9, 3.6715155050242968`*^9, 3.671515705917068*^9, 
   3.6715164066731157`*^9, 3.671538870046317*^9, 3.671538966336405*^9, 
   3.671539030792556*^9, {3.671774211263186*^9, 3.6717742359104233`*^9}, {
   3.671774298179055*^9, 3.6717743233451896`*^9}, 3.671774358527082*^9, 
   3.671774433915724*^9, 3.6717744876542177`*^9, 3.671775638085752*^9, 
   3.67178263467992*^9, 3.6717841942955856`*^9, 3.6717843722509117`*^9, 
   3.672749012579711*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "108"}],
  SequenceForm["ii=", 108],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6712730729577208`*^9, 3.671273086927863*^9}, {
   3.6712780242410192`*^9, 3.6712780653843822`*^9}, {3.6712788303214025`*^9, 
   3.6712788398983183`*^9}, 3.671340160893304*^9, 3.6713405788577957`*^9, 
   3.6713679711271095`*^9, {3.6714255246552486`*^9, 3.671425577482798*^9}, 
   3.6714261938657446`*^9, 3.6714282490140953`*^9, 3.6714286472234287`*^9, 
   3.6714293553135495`*^9, 3.671433437362511*^9, 3.671433475781865*^9, 
   3.671433513972904*^9, 3.6714373122437706`*^9, 3.6714375346111946`*^9, 
   3.6714390200038385`*^9, 3.6714393643667912`*^9, {3.671439831195343*^9, 
   3.67143985934064*^9}, 3.6714399412279434`*^9, 3.6714414788827744`*^9, 
   3.671441511315852*^9, 3.671441730064537*^9, 3.6714420797379293`*^9, 
   3.671442551905306*^9, 3.671444271357292*^9, 3.671444321715108*^9, 
   3.671444463112733*^9, 3.6714444967594953`*^9, 3.671447025311639*^9, 
   3.67144713021282*^9, 3.671447643943407*^9, 3.6714477262349806`*^9, 
   3.6714479008824716`*^9, 3.6714500000254464`*^9, 3.6714507540500784`*^9, {
   3.671451901752502*^9, 3.6714519558641634`*^9}, 3.67146370731653*^9, 
   3.6714648424912195`*^9, 3.671513672968769*^9, 3.671515386402877*^9, 
   3.6715154523780403`*^9, 3.6715155050242968`*^9, 3.671515705917068*^9, 
   3.6715164066731157`*^9, 3.671538870046317*^9, 3.671538966336405*^9, 
   3.671539030792556*^9, {3.671774211263186*^9, 3.6717742359104233`*^9}, {
   3.671774298179055*^9, 3.6717743233451896`*^9}, 3.671774358527082*^9, 
   3.671774433915724*^9, 3.6717744876542177`*^9, 3.671775638085752*^9, 
   3.67178263467992*^9, 3.6717841942955856`*^9, 3.6717843722509117`*^9, 
   3.672749018809076*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "109"}],
  SequenceForm["ii=", 109],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6712730729577208`*^9, 3.671273086927863*^9}, {
   3.6712780242410192`*^9, 3.6712780653843822`*^9}, {3.6712788303214025`*^9, 
   3.6712788398983183`*^9}, 3.671340160893304*^9, 3.6713405788577957`*^9, 
   3.6713679711271095`*^9, {3.6714255246552486`*^9, 3.671425577482798*^9}, 
   3.6714261938657446`*^9, 3.6714282490140953`*^9, 3.6714286472234287`*^9, 
   3.6714293553135495`*^9, 3.671433437362511*^9, 3.671433475781865*^9, 
   3.671433513972904*^9, 3.6714373122437706`*^9, 3.6714375346111946`*^9, 
   3.6714390200038385`*^9, 3.6714393643667912`*^9, {3.671439831195343*^9, 
   3.67143985934064*^9}, 3.6714399412279434`*^9, 3.6714414788827744`*^9, 
   3.671441511315852*^9, 3.671441730064537*^9, 3.6714420797379293`*^9, 
   3.671442551905306*^9, 3.671444271357292*^9, 3.671444321715108*^9, 
   3.671444463112733*^9, 3.6714444967594953`*^9, 3.671447025311639*^9, 
   3.67144713021282*^9, 3.671447643943407*^9, 3.6714477262349806`*^9, 
   3.6714479008824716`*^9, 3.6714500000254464`*^9, 3.6714507540500784`*^9, {
   3.671451901752502*^9, 3.6714519558641634`*^9}, 3.67146370731653*^9, 
   3.6714648424912195`*^9, 3.671513672968769*^9, 3.671515386402877*^9, 
   3.6715154523780403`*^9, 3.6715155050242968`*^9, 3.671515705917068*^9, 
   3.6715164066731157`*^9, 3.671538870046317*^9, 3.671538966336405*^9, 
   3.671539030792556*^9, {3.671774211263186*^9, 3.6717742359104233`*^9}, {
   3.671774298179055*^9, 3.6717743233451896`*^9}, 3.671774358527082*^9, 
   3.671774433915724*^9, 3.6717744876542177`*^9, 3.671775638085752*^9, 
   3.67178263467992*^9, 3.6717841942955856`*^9, 3.6717843722509117`*^9, 
   3.6727490261125484`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "110"}],
  SequenceForm["ii=", 110],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6712730729577208`*^9, 3.671273086927863*^9}, {
   3.6712780242410192`*^9, 3.6712780653843822`*^9}, {3.6712788303214025`*^9, 
   3.6712788398983183`*^9}, 3.671340160893304*^9, 3.6713405788577957`*^9, 
   3.6713679711271095`*^9, {3.6714255246552486`*^9, 3.671425577482798*^9}, 
   3.6714261938657446`*^9, 3.6714282490140953`*^9, 3.6714286472234287`*^9, 
   3.6714293553135495`*^9, 3.671433437362511*^9, 3.671433475781865*^9, 
   3.671433513972904*^9, 3.6714373122437706`*^9, 3.6714375346111946`*^9, 
   3.6714390200038385`*^9, 3.6714393643667912`*^9, {3.671439831195343*^9, 
   3.67143985934064*^9}, 3.6714399412279434`*^9, 3.6714414788827744`*^9, 
   3.671441511315852*^9, 3.671441730064537*^9, 3.6714420797379293`*^9, 
   3.671442551905306*^9, 3.671444271357292*^9, 3.671444321715108*^9, 
   3.671444463112733*^9, 3.6714444967594953`*^9, 3.671447025311639*^9, 
   3.67144713021282*^9, 3.671447643943407*^9, 3.6714477262349806`*^9, 
   3.6714479008824716`*^9, 3.6714500000254464`*^9, 3.6714507540500784`*^9, {
   3.671451901752502*^9, 3.6714519558641634`*^9}, 3.67146370731653*^9, 
   3.6714648424912195`*^9, 3.671513672968769*^9, 3.671515386402877*^9, 
   3.6715154523780403`*^9, 3.6715155050242968`*^9, 3.671515705917068*^9, 
   3.6715164066731157`*^9, 3.671538870046317*^9, 3.671538966336405*^9, 
   3.671539030792556*^9, {3.671774211263186*^9, 3.6717742359104233`*^9}, {
   3.671774298179055*^9, 3.6717743233451896`*^9}, 3.671774358527082*^9, 
   3.671774433915724*^9, 3.6717744876542177`*^9, 3.671775638085752*^9, 
   3.67178263467992*^9, 3.6717841942955856`*^9, 3.6717843722509117`*^9, 
   3.6727490262660437`*^9}]
}, Closed]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6709203864459443`*^9, 3.670920386626472*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Here", " ", "we", " ", "check", " ", "getK", " ", "and", " ", "getN"}], 
  "*)"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6647893950303826`*^9, 3.6647894076633363`*^9}, {
   3.667049585039831*^9, 3.667049586467121*^9}, {3.67023348873209*^9, 
   3.67023349002195*^9}, 3.67091001914213*^9, {3.670920880609946*^9, 
   3.6709208862418547`*^9}, {3.671261025522729*^9, 3.671261040436485*^9}, 
   3.6717741748985643`*^9, {3.679829405127978*^9, 3.679829407364276*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"formatrule", "=", 
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["XX_", 
      RowBox[{"z1_", ",", "z2_"}]], "\[Rule]", 
     RowBox[{"XX", "[", 
      RowBox[{"z1", ",", "z2"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ii", "=", "1"}], ",", 
    RowBox[{"ii", "\[LessEqual]", "110"}], ",", 
    RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<ii=\>\"", ",", "ii"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Mod", "[", 
           RowBox[{"ii", ",", "10"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<ii=\>\"", ",", "ii"}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
     SubscriptBox["bft", "ii"], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"a", "=", 
      RowBox[{"a", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b", "=", 
      RowBox[{"b", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"c", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"d", "=", 
      RowBox[{"d", "/.", "formatrule"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ii", "\[NotEqual]", "26"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "33"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "50"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "51"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "79"}], "&&", 
        RowBox[{"ii", "\[NotEqual]", "94"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"fullstrat", "=", 
         RowBox[{"stratificationBoundaries", "[", 
          RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"allkastsinstratification", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], "/.", 
              "#"}], ")"}], "&"}], ",", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "\[Rule]", "0"}], "&"}], ",", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Complement", "[", 
                 RowBox[{
                  RowBox[{"Variables", "[", 
                   RowBox[{"Join", "[", 
                    RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}],
                   ",", "#"}], "]"}], "&"}], ",", "fullstrat", ",", 
               RowBox[{"{", "3", "}"}]}], "]"}], ",", 
             RowBox[{"{", "4", "}"}]}], "]"}], ",", 
           RowBox[{"{", "3", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"allsourcesets", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"getSourceNodes", "[", 
              RowBox[{
               RowBox[{"Sequence", "@@", "#"}], ",", 
               RowBox[{
                RowBox[{"perfectMatchings", "[", 
                 RowBox[{"Sequence", "@@", "#"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "&"}], ",", 
           "allkastsinstratification", ",", 
           RowBox[{"{", "3", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ii", "\[NotEqual]", "104"}], "&&", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"DeleteDuplicates", "[", 
              RowBox[{"Flatten", "[", "allsourcesets", "]"}], "]"}], "]"}], "=!=",
             "1"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<ii=\>\"", ",", "ii", ",", 
             "\"\< : not every element of the stratification has the same \
number of sources!\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"listofkasteleyns", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Sequence", "@@", "#"}], "&"}], ",", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Sequence", "@@", "#"}], "&"}], ",", 
             "allkastsinstratification", ",", 
             RowBox[{"{", "2", "}"}]}], "]"}], ",", 
           RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"jj", "=", "1"}], ",", 
          RowBox[{"jj", "\[LessEqual]", 
           RowBox[{"Length", "[", "listofkasteleyns", "]"}]}], ",", 
          RowBox[{"jj", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], "=", 
            RowBox[{"listofkasteleyns", "[", 
             RowBox[{"[", "jj", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"perfectMatchings", "[", 
                RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}], "=!=",
               "0"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", 
                  RowBox[{"getSourceNodes", "[", 
                   RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", 
                    RowBox[{
                    RowBox[{"perfectMatchings", "[", 
                    RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "=!=", 
                 RowBox[{"getK", "[", 
                  RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{
                  "\"\<ii=\>\"", ",", "ii", ",", 
                   "\"\< : getK is not returning the correct number\>\""}], 
                  "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"getOrderingExternalNodesDefault", "[", 
                RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}], "=!=", 
              RowBox[{"getN", "[", 
               RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<ii=\>\"", ",", "ii", ",", 
                "\"\< : getN is not returning the correct number\>\""}], 
               "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"perfectMatchings", "[", 
             RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}], "=!=",
            "0"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"getSourceNodes", "[", 
                RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", 
                 RowBox[{
                  RowBox[{"perfectMatchings", "[", 
                   RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "=!=", 
              RowBox[{"getK", "[", 
               RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<ii=\>\"", ",", "ii", ",", 
                "\"\< : getK is not returning the correct number\>\""}], 
               "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"getOrderingExternalNodesDefault", "[", 
             RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "]"}], "=!=", 
           RowBox[{"getN", "[", 
            RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<ii=\>\"", ",", "ii", ",", 
             "\"\< : getN is not returning the correct number\>\""}], "]"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.679829402680938*^9, 3.679829532442113*^9}, 
   3.6798362519936323`*^9, {3.679836291540639*^9, 3.6798364008079405`*^9}, {
   3.6798364427877707`*^9, 3.67983644561865*^9}, {3.679837858100666*^9, 
   3.679837887528977*^9}, {3.6798381666093965`*^9, 3.6798381968855114`*^9}, {
   3.6798382402488413`*^9, 3.6798383105641193`*^9}, {3.6798390454788404`*^9, 
   3.679839136861803*^9}, {3.6798393886836014`*^9, 3.679839489023943*^9}, {
   3.679839788248348*^9, 3.6798397948824186`*^9}, {3.6798400579456778`*^9, 
   3.679840058042777*^9}, {3.679840590347843*^9, 3.6798405904415817`*^9}, {
   3.679917299636047*^9, 3.6799173167657423`*^9}, 3.6799842591403437`*^9, 
   3.679984358274426*^9, {3.679993892011117*^9, 3.6799938940356708`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["ii=", 1],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6799939435822425`*^9, 3.679993949546114*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "2"}],
  SequenceForm["ii=", 2],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6799939437228775`*^9, 3.679993949546114*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "3"}],
  SequenceForm["ii=", 3],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6799939438322573`*^9, 3.679993949546114*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "4"}],
  SequenceForm["ii=", 4],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6799939440822663`*^9, 3.679993949546114*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "5"}],
  SequenceForm["ii=", 5],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.679993944238524*^9, 3.679993949546114*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "6"}],
  SequenceForm["ii=", 6],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6799939444416604`*^9, 3.679993949546114*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "7"}],
  SequenceForm["ii=", 7],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6799939456067667`*^9, 3.679993949546114*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "8"}],
  SequenceForm["ii=", 8],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6799939456223907`*^9, 3.679993949546114*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ii=\"\>", "\[InvisibleSpace]", "9"}],
  SequenceForm["ii=", 9],
  Editable->False]], "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6799939456692705`*^9, 3.679993949546114*^9}}]
}, Closed]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6799843716169367`*^9, 3.6799843718200717`*^9}}]
},
Evaluator->"Local2",
WindowSize->{1366, 685},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"10.2 for Microsoft Windows (64-bit) (July 7, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 358, 8, 52, "Input"],
Cell[919, 30, 835, 25, 31, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[CellGroupData[{
Cell[1779, 59, 826, 24, 31, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.}],
Cell[2608, 85, 376374, 10727, 20848, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.}]
}, Closed]],
Cell[378997, 10815, 94, 1, 25, "Input"],
Cell[CellGroupData[{
Cell[379116, 10820, 776, 13, 52, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[379895, 10835, 4570, 103, 455, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[384468, 10940, 538, 11, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[385009, 10953, 540, 11, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[385552, 10966, 538, 11, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[386093, 10979, 540, 11, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[386636, 10992, 540, 11, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[387179, 11005, 538, 11, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[387720, 11018, 540, 11, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[388263, 11031, 540, 11, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[388806, 11044, 538, 11, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[389347, 11057, 542, 11, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[389892, 11070, 542, 11, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]],
Cell[390449, 11084, 96, 1, 25, "Input"],
Cell[CellGroupData[{
Cell[390570, 11089, 714, 13, 31, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[391287, 11104, 9314, 213, 795, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[400604, 11319, 817, 14, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]],
Cell[401436, 11336, 92, 1, 25, "Input"],
Cell[CellGroupData[{
Cell[401553, 11341, 733, 12, 31, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[402289, 11355, 14637, 338, 1335, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[416929, 11695, 1061, 17, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]],
Cell[418005, 11715, 92, 1, 25, "Input"],
Cell[CellGroupData[{
Cell[418122, 11720, 764, 13, 31, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[418889, 11735, 17778, 393, 1635, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[436670, 12130, 1630, 25, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[438303, 12157, 1630, 25, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[439936, 12184, 1630, 25, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[441569, 12211, 1628, 25, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[443200, 12238, 1630, 25, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[444833, 12265, 1627, 25, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[446463, 12292, 1630, 25, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[448096, 12319, 1630, 25, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[449729, 12346, 1630, 25, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[451362, 12373, 1632, 25, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[452997, 12400, 1632, 25, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]],
Cell[454644, 12428, 92, 1, 25, "Input"],
Cell[CellGroupData[{
Cell[454761, 12433, 676, 11, 31, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[455440, 12446, 7201, 154, 556, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[462644, 12602, 1527, 23, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[464174, 12627, 1525, 23, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[465702, 12652, 1525, 23, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[467230, 12677, 1525, 23, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[468758, 12702, 1527, 23, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[470288, 12727, 1525, 23, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]],
Cell[471828, 12753, 92, 1, 25, "Input"],
Cell[CellGroupData[{
Cell[471945, 12758, 1009, 16, 31, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[472957, 12776, 18683, 405, 1635, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[491643, 13183, 1975, 29, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[493621, 13214, 1975, 29, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[495599, 13245, 1973, 29, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[497575, 13276, 1973, 29, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[499551, 13307, 1975, 29, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[501529, 13338, 1973, 29, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[503505, 13369, 1973, 29, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[505481, 13400, 1975, 29, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[507459, 13431, 1975, 29, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[509437, 13462, 1977, 29, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[511417, 13493, 1975, 29, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]],
Cell[513407, 13525, 92, 1, 25, "Input"],
Cell[CellGroupData[{
Cell[513524, 13530, 894, 14, 31, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[514421, 13546, 13584, 289, 1155, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[528008, 13837, 1925, 29, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]],
Cell[529948, 13869, 92, 1, 25, "Input"],
Cell[CellGroupData[{
Cell[530065, 13874, 904, 14, 31, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[530972, 13890, 8892, 190, 555, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[539867, 14082, 1968, 29, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[541838, 14113, 1968, 29, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[543809, 14144, 1968, 29, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[545780, 14175, 1970, 29, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[547753, 14206, 1967, 29, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[549723, 14237, 1968, 29, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]],
Cell[551706, 14269, 92, 1, 25, "Input"],
Cell[CellGroupData[{
Cell[551823, 14274, 1128, 17, 31, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[552954, 14293, 13691, 280, 1255, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[566648, 14575, 2373, 35, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]],
Cell[569036, 14613, 92, 1, 25, "Input"],
Cell[CellGroupData[{
Cell[569153, 14618, 1434, 24, 31, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[570590, 14644, 19697, 431, 1094, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[590290, 15077, 2268, 33, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[592561, 15112, 2268, 33, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[594832, 15147, 2270, 33, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[597105, 15182, 2267, 33, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[599375, 15217, 2270, 33, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[601648, 15252, 2270, 33, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[603921, 15287, 2268, 33, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[606192, 15322, 2268, 33, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[608463, 15357, 2267, 33, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[610733, 15392, 2272, 33, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[613008, 15427, 2272, 33, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]],
Cell[615295, 15463, 94, 1, 25, "Input"],
Cell[CellGroupData[{
Cell[615414, 15468, 1721, 28, 52, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[617138, 15498, 38589, 908, 2416, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[655730, 16408, 265, 6, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[655998, 16416, 265, 6, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[656266, 16424, 290, 7, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[656559, 16433, 288, 7, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[656850, 16442, 286, 7, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[657139, 16451, 288, 7, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[657430, 16460, 286, 7, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[657719, 16469, 288, 7, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[658010, 16478, 288, 7, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[658301, 16487, 288, 7, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[658592, 16496, 292, 7, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]],
Cell[658899, 16506, 94, 1, 25, "Input"],
Cell[CellGroupData[{
Cell[659018, 16511, 319, 6, 31, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[659340, 16519, 6507, 145, 695, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[665850, 16666, 1205, 20, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[667058, 16688, 1203, 20, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[668264, 16710, 1203, 20, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[669470, 16732, 1205, 20, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[670678, 16754, 1203, 20, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[671884, 16776, 1205, 20, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[673092, 16798, 1205, 20, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[674300, 16820, 1205, 20, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[675508, 16842, 1203, 20, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[676714, 16864, 1207, 20, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[677924, 16886, 1204, 20, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]],
Cell[679143, 16909, 94, 1, 25, "Input"],
Cell[CellGroupData[{
Cell[679262, 16914, 347, 7, 31, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[679612, 16923, 13503, 305, 1355, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[693118, 17230, 846, 15, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]],
Cell[693979, 17248, 94, 1, 25, "Input"],
Cell[CellGroupData[{
Cell[694098, 17253, 355, 7, 31, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[694456, 17262, 5558, 104, 436, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[700017, 17368, 884, 15, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[700904, 17385, 884, 15, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[701791, 17402, 884, 15, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[702678, 17419, 884, 15, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[703565, 17436, 884, 15, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[704452, 17453, 882, 15, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[705337, 17470, 882, 15, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[706222, 17487, 884, 15, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[707109, 17504, 884, 15, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[707996, 17521, 886, 15, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[708885, 17538, 886, 15, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]],
Cell[709786, 17556, 92, 1, 25, "Input"],
Cell[CellGroupData[{
Cell[709903, 17561, 738, 13, 31, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[710644, 17576, 9418, 219, 775, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[720065, 17797, 510, 10, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]],
Cell[720590, 17810, 92, 1, 25, "Input"],
Cell[CellGroupData[{
Cell[720707, 17815, 695, 12, 31, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[721405, 17829, 8569, 198, 675, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[729977, 18029, 667, 12, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]],
Cell[730659, 18044, 94, 1, 25, "Input"],
Cell[CellGroupData[{
Cell[730778, 18049, 609, 11, 31, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[731390, 18062, 19751, 448, 1452, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[751144, 18512, 7789, 167, 687, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[758936, 18681, 559, 11, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[759498, 18694, 559, 11, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[760060, 18707, 561, 11, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[760624, 18720, 561, 11, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[761188, 18733, 567, 11, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[761758, 18746, 561, 11, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[762322, 18759, 561, 11, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]],
Cell[762898, 18773, 92, 1, 25, "Input"],
Cell[CellGroupData[{
Cell[763015, 18778, 541, 9, 31, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[763559, 18789, 19749, 448, 1452, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[783311, 19239, 8315, 182, 723, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[791629, 19423, 487, 10, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[792119, 19435, 487, 10, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[792609, 19447, 489, 10, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[793101, 19459, 489, 10, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[793593, 19471, 493, 10, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[794089, 19483, 489, 10, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[794581, 19495, 487, 10, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]],
Cell[795083, 19508, 92, 1, 25, "Input"],
Cell[CellGroupData[{
Cell[795200, 19513, 661, 11, 31, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[795864, 19526, 7531, 165, 603, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[803398, 19693, 481, 9, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]],
Cell[803894, 19705, 92, 1, 25, "Input"],
Cell[CellGroupData[{
Cell[804011, 19710, 747, 13, 31, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[804761, 19725, 29773, 707, 2132, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[834537, 20434, 38653, 793, 2615, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[873193, 21229, 932, 16, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[874128, 21247, 833, 12, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[874964, 21261, 930, 16, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[875897, 21279, 938, 16, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[876838, 21297, 932, 16, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[877773, 21315, 835, 12, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]],
Cell[878623, 21330, 92, 1, 25, "Input"],
Cell[CellGroupData[{
Cell[878740, 21335, 603, 11, 31, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[879346, 21348, 37088, 812, 3035, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[916437, 22162, 888, 13, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[917328, 22177, 888, 13, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[918219, 22192, 985, 17, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]],
Cell[919219, 22212, 92, 1, 25, "Input"],
Cell[CellGroupData[{
Cell[919336, 22217, 335, 7, 31, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[919674, 22226, 16630, 360, 1695, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[936307, 22588, 290, 5, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[936600, 22595, 695, 15, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[937298, 22612, 292, 5, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[937593, 22619, 387, 9, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]],
Cell[937995, 22631, 92, 1, 25, "Input"],
Cell[CellGroupData[{
Cell[938112, 22636, 370, 7, 31, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[938485, 22645, 9352, 207, 855, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[947840, 22854, 763, 14, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[948606, 22870, 762, 14, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[949371, 22886, 764, 14, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]],
Cell[950150, 22903, 92, 1, 25, "Input"],
Cell[CellGroupData[{
Cell[950267, 22908, 664, 11, 31, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[950934, 22921, 14518, 309, 1235, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[965455, 23232, 1300, 21, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[966758, 23255, 1300, 21, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[968061, 23278, 1300, 21, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]],
Cell[969376, 23302, 96, 1, 25, "Input"],
Cell[CellGroupData[{
Cell[969497, 23307, 504, 9, 31, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[970004, 23318, 7000, 166, 572, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[977007, 23486, 385, 8, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[977395, 23496, 393, 8, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[977791, 23506, 383, 8, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[978177, 23516, 391, 8, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[978571, 23526, 393, 8, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[978967, 23536, 385, 8, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[979355, 23546, 393, 8, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[979751, 23556, 393, 8, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[980147, 23566, 391, 8, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[980541, 23576, 385, 8, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[980929, 23586, 393, 8, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[981325, 23596, 390, 8, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[981718, 23606, 391, 8, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[982112, 23616, 391, 8, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]],
Cell[982518, 23627, 92, 1, 25, "Input"],
Cell[CellGroupData[{
Cell[982635, 23632, 554, 10, 31, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[983192, 23644, 7937, 187, 784, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[991132, 23833, 431, 9, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[991566, 23844, 439, 9, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[992008, 23855, 431, 9, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[992442, 23866, 439, 9, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[992884, 23877, 439, 9, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[993326, 23888, 431, 9, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[993760, 23899, 439, 9, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[994202, 23910, 439, 9, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[994644, 23921, 439, 9, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[995086, 23932, 431, 9, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[995520, 23943, 439, 9, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[995962, 23954, 439, 9, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[996404, 23965, 437, 9, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[996844, 23976, 436, 9, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[997283, 23987, 429, 9, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[997715, 23998, 439, 9, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[998157, 24009, 439, 9, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[998599, 24020, 439, 9, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[999041, 24031, 439, 9, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[999483, 24042, 439, 9, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[999925, 24053, 431, 9, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1000359, 24064, 437, 9, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1000799, 24075, 437, 9, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1001239, 24086, 439, 9, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1001681, 24097, 437, 9, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1002121, 24108, 437, 9, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1002561, 24119, 439, 9, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]],
Cell[1003015, 24131, 93, 1, 25, "Input"],
Cell[CellGroupData[{
Cell[1003133, 24136, 323, 6, 31, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1003459, 24144, 15701, 445, 532, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]],
Cell[1019175, 24592, 96, 1, 25, "Input"],
Cell[CellGroupData[{
Cell[1019296, 24597, 393, 7, 31, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1019692, 24606, 28227, 607, 1895, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1047922, 25215, 483, 9, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1048408, 25226, 482, 9, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1048893, 25237, 483, 9, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1049379, 25248, 495, 9, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1049877, 25259, 483, 9, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1050363, 25270, 485, 9, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1050851, 25281, 485, 9, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1051339, 25292, 493, 9, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1051835, 25303, 483, 9, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1052321, 25314, 485, 9, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1052809, 25325, 483, 9, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1053295, 25336, 495, 9, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1053793, 25347, 495, 9, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1054291, 25358, 485, 9, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1054779, 25369, 495, 9, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1055277, 25380, 495, 9, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]],
Cell[1055787, 25392, 94, 1, 25, "Input"],
Cell[CellGroupData[{
Cell[1055906, 25397, 243, 5, 31, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1056152, 25404, 14592, 318, 1215, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1070747, 25724, 419, 9, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1071169, 25735, 322, 5, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1071494, 25742, 416, 9, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1071913, 25753, 419, 9, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1072335, 25764, 419, 9, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1072757, 25775, 423, 9, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1073183, 25786, 417, 9, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1073603, 25797, 320, 5, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1073926, 25804, 419, 9, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]],
Cell[1074360, 25816, 94, 1, 25, "Input"],
Cell[CellGroupData[{
Cell[1074479, 25821, 314, 7, 31, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1074796, 25830, 11489, 261, 895, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1086288, 26093, 292, 7, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1086583, 26102, 292, 7, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1086878, 26111, 294, 7, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1087175, 26120, 292, 7, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1087470, 26129, 298, 7, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1087771, 26138, 291, 7, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1088065, 26147, 294, 7, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]],
Cell[1088374, 26157, 96, 1, 25, "Input"],
Cell[CellGroupData[{
Cell[1088495, 26162, 347, 8, 31, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1088845, 26172, 13308, 296, 995, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1102156, 26470, 344, 8, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1102503, 26480, 344, 8, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1102850, 26490, 342, 8, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1103195, 26500, 344, 8, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1103542, 26510, 350, 8, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1103895, 26520, 344, 8, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1104242, 26530, 344, 8, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]],
Cell[1104601, 26541, 92, 1, 25, "Input"],
Cell[CellGroupData[{
Cell[1104718, 26546, 1149, 25, 72, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1105870, 26573, 58294, 1357, 4510, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]],
Cell[1164179, 27933, 96, 1, 25, "Input"],
Cell[CellGroupData[{
Cell[1164300, 27938, 1086, 23, 52, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1165389, 27963, 17891, 419, 1869, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]],
Cell[1183295, 28385, 94, 1, 25, "Input"],
Cell[CellGroupData[{
Cell[1183414, 28390, 395, 8, 31, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1183812, 28400, 26378, 559, 1943, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1210193, 28961, 442, 9, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1210638, 28972, 444, 9, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1211085, 28983, 444, 9, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1211532, 28994, 444, 9, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1211979, 29005, 444, 9, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1212426, 29016, 444, 9, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]],
Cell[1212885, 29028, 92, 1, 25, "Input"],
Cell[CellGroupData[{
Cell[1213002, 29033, 367, 7, 31, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1213372, 29042, 122346, 3091, 7296, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1335721, 32135, 443, 9, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]],
Cell[1336179, 32147, 94, 1, 25, "Input"],
Cell[CellGroupData[{
Cell[1336298, 32152, 448, 9, 31, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1336749, 32163, 25712, 548, 2355, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1362464, 32713, 1785, 27, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]],
Cell[1364264, 32743, 94, 1, 25, "Input"],
Cell[CellGroupData[{
Cell[1364383, 32748, 454, 8, 31, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1364840, 32758, 84980, 1813, 5456, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1449823, 34573, 1594, 24, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1451420, 34599, 1473, 20, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1452896, 34621, 1473, 20, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1454372, 34643, 1473, 20, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1455848, 34665, 1592, 24, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1457443, 34691, 1475, 20, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1458921, 34713, 1471, 20, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1460395, 34735, 1476, 20, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1461874, 34757, 1592, 24, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1463469, 34783, 1472, 20, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1464944, 34805, 1473, 20, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1466420, 34827, 1474, 20, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1467897, 34849, 1592, 24, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1469492, 34875, 1475, 20, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1470970, 34897, 1473, 20, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1472446, 34919, 1476, 20, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1473925, 34941, 1592, 24, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1475520, 34967, 1473, 20, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1476996, 34989, 1475, 20, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1478474, 35011, 1475, 20, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1479952, 35033, 1594, 24, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1481549, 35059, 1475, 20, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1483027, 35081, 1473, 20, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1484503, 35103, 1472, 20, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]],
Cell[1485990, 35126, 94, 1, 25, "Input"],
Cell[CellGroupData[{
Cell[1486109, 35131, 485, 9, 31, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1486597, 35142, 14550, 282, 676, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1501150, 35426, 1839, 28, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1502992, 35456, 1841, 28, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1504836, 35486, 1839, 28, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1506678, 35516, 1839, 28, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1508520, 35546, 1841, 28, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1510364, 35576, 1841, 28, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]],
Cell[1512220, 35607, 94, 1, 25, "Input"],
Cell[CellGroupData[{
Cell[1512339, 35612, 550, 10, 31, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1512892, 35624, 10319, 235, 935, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1523214, 35861, 263, 6, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1523480, 35869, 263, 6, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1523746, 35877, 263, 6, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1524012, 35885, 263, 6, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1524278, 35893, 261, 6, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1524542, 35901, 263, 6, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1524808, 35909, 263, 6, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1525074, 35917, 263, 6, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1525340, 35925, 263, 6, 23, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]],
Cell[1525618, 35934, 96, 1, 25, "Input"]
}
]
*)

(* End of internal cache information *)
